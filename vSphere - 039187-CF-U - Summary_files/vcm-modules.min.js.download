function datacenterService(e,t){var i="com.vmware.vsphere.client.datacenter.DatacenterInfo";this.createDatacenter=function(r,n){var o={name:r,parent:t.getManagedObjectReference(n)};e.add(i,o)}}function folderService(e,t){var i="com.vmware.vsphere.client.folder.FolderInfo",r="com.vmware.vsphere.client.folder.FolderRemovalSpec";this.createFolder=function(r,n,o){var a={name:r,parent:t.getManagedObjectReference(n),folderType:o};e.add(i,a)},this.removeFolder=function(t){var i={deleteFromDisk:!1};e.remove(t,r,i)}}h5=h5||{},h5.folder={angularModule:angular.module("com.vmware.vsphere.client.folder",["com.vmware.vsphere.client.licenseLibUi"])},angular.module("com.vmware.vsphere.client.folder").run(["actionDialogService","clarityModalService","dataService","i18nService","assignLicenseService","vscExportWizardLauncherService","moveFolderService",function(e,t,i,r,n,o,a){h5.actions["vsphere.core.datacenter.actions.addDatacenter"]=function(e,i){var n={title:r.getString("DatacenterUi","createDatacenterDialog.title"),contentTemplate:"folder-ui/resources/folder/views/datacenter/addDatacenter.html",defaultButton:"submit",dialogData:{objectId:i[0]}};t.openOkCancelModal(n)},h5.actions["vsphere.core.vcenter.actions.addFolder"]=function(e,i){t.openModal(e,i,{objectId:i[0],title:r.getString("FolderUi","actionCreateFolderLabel")},"folder-ui/resources/folder/views/folder/addFolder.html")},h5.actions["vsphere.core.vcenter.actions.removeFolder"]=function(e,i){t.openModal(e,i,null,"folder-ui/resources/folder/views/folder/removeFolder.html")},h5.actions["vsphere.core.vc.assignLicenseKeyAction"]=function(e,t){_.isEmpty(t)||n.showAssignLicenseForm(t)},h5.actions["vsphere.core.folder.exportLogsAction"]=function(e,t){_.isEmpty(t)||o.showSystemLogExportDialog(t)},h5.actions["vsphere.core.folder.actions.moveFolder"]=function(e,t,i){t&&t.length&&a.openMoveToDialog(t)},h5.actions["vsphere.core.network.actions.moveNetworkToDropTarget"]=function(e,t,i){t&&t.length&&i&&a.move(t,i.dropTarget)},h5.actions["vsphere.core.datacenter.actions.move"]=function(e,t){t&&t.length&&a.openMoveToDialog(t)},h5.actions["vsphere.core.datacenter.actions.editDefaultHwVersionAction"]=function(e,i){var n={title:r.getString("HostUi","defaultVmCompatibilityDialog.title"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/EditDefaultVmCompatibility.html",dialogData:{availableTargets:i}};t.openOkCancelModal(n)},h5.actions["vsphere.core.datacenter.actions.dragAndDropToFolder"]=function(e,t,i){t&&t.length&&i&&a.move(t,i.dropTarget)}}]);var folder_ui;!function(e){var t=com.vmware.vsphere.client.mixed.ManagedEntityMoveSpec,i=function(){function e(e,t,i,r){this.clarityModalService=e,this.i18nService=t,this.mutationService=i,this.defaultUriSchemeUtil=r}return e.prototype.openMoveToDialog=function(e){var t=this,i={title:this.i18nService.getString("FolderUi","moveto.dialog.title"),defaultButton:"submit",dialogData:{objectIds:e},contentTemplate:"folder-ui/resources/folder/views/folder/move/moveFolderDialog.html"};1===e.length&&(i.subTitle={objectId:e[0]}),i.onSubmit=function(){return t.move(i.dialogData.objectIds,i.dialogData.targetEntity),!0},this.clarityModalService.openOkCancelModal(i)},e.prototype.move=function(e,i){var r=this,n=e.map(function(e){return r.defaultUriSchemeUtil.getManagedObjectReference(e)}),o=new t;o.entities=n,this.mutationService.apply(i,o._type,o).then(function(){})},e.$inject=["clarityModalService","i18nService","mutationService","defaultUriSchemeUtil"],e}();e.MoveFolderService=i,angular.module("com.vmware.vsphere.client.folder").service("moveFolderService",i)}(folder_ui||(folder_ui={})),function(){function e(e,t,i){function r(){t.createDatacenter(n.name,n.moRef),e.closeModal()}var n=this;n.loading=!0,e.modalOptions.submitDisabled=!0,n.moRef=e.modalOptions.dialogData.objectId,n.icon=e.modalOptions.iconClass,e.modalOptions.onSubmit=r,i.getProperties(n.moRef,["name","primaryIconId","newUniqueDatacenterName"]).then(function(t){n.name=t.newUniqueDatacenterName,n.location=t.name,n.parentIconClass=t.primaryIconId,n.loading=!1,e.modalOptions.submitDisabled=!1})}angular.module("com.vmware.vsphere.client.folder").controller("addDatacenterController",e),e.$inject=["$scope","datacenterService","dataService"]}(),angular.module("com.vmware.vsphere.client.folder").service("datacenterService",datacenterService),datacenterService.$inject=["mutationService","defaultUriSchemeUtil"],function(){function e(e,t,i){function r(){var t,i=e.modalOptions.actionEval.action.uid;return/Vm/.test(i)?t="VirtualMachineFolder":/Host/.test(i)?t="HostFolder":/Storage/.test(i)?t="DatastoreFolder":/Network/.test(i)&&(t="NetworkFolder"),t}function n(){var e=o.name.length<=o.FOLDER_MAX_LENGTH;return e?null:o.i18n("VmUi","NameValidator.nameTooLongSpecialChars")}var o=this;o.name="",o.moRef=e.modalOptions.dialogData.objectId,o.FOLDER_MAX_LENGTH=80,this.$onInit=function(){o.i18n=i.getString},o.closeModal=function(){e.closeModal()},o.createFolder=function(){if(o.compatibilityMessage=n(),null===o.compatibilityMessage){var i=r();i?t.createFolder(o.name,o.moRef,i):t.createFolder(o.name,o.moRef),e.closeModal()}}}angular.module("com.vmware.vsphere.client.folder").controller("addFolderController",e),e.$inject=["$scope","folderService","i18nService"]}(),angular.module("com.vmware.vsphere.client.folder").service("folderService",folderService),folderService.$inject=["mutationService","defaultUriSchemeUtil"];var folder_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="folder-ui/resources/folder/views/folder/move/moveFolderComponentTemplate.html"}return e}();e.MoveFolderComponent=t;var i=function(){function e(e,t){this.defaultUriSchemeUtil=e,this.managedEntityConstants=t,this.isDatacenterFolder=!1,this.isNetworkFolder=!1,this.isHostFolder=!1,this.isVmFolder=!1,this.isDatastoreFolder=!1}return e.prototype.$onInit=function(){var e=this;this.folderId=this.getFolderId(),this.updateFolderType(),this.onLocationSelected=function(t){e.model.targetEntity=t}},e.prototype.updateFolderType=function(){this.isDcFolder(this.folderId)?this.isDatacenterFolder=!0:this.folderId.indexOf(e.VM_FOLDER_VALUE)>0?this.isVmFolder=!0:this.folderId.indexOf(e.NETWORK_FOLDER_VALUE)>0?this.isNetworkFolder=!0:this.folderId.indexOf(e.HOST_FOLDER_VALUE)>0?this.isHostFolder=!0:this.folderId.indexOf(e.DATASTORE_FOLDER_VALUE)>0&&(this.isDatastoreFolder=!0)},e.prototype.getFolderId=function(){var e=this.model.objectIds[0],t=this.defaultUriSchemeUtil.getManagedObjectReference(e);return t.type!==this.managedEntityConstants.FOLDER||this.isDcFolder(e)?this.defaultUriSchemeUtil.getRootFolder(t.serverGuid):e},e.prototype.isDcFolder=function(t){var i=this.defaultUriSchemeUtil.getManagedObjectReference(t);return 0===i.value.indexOf(e.DATACENTER_FOLDER_VALUE)},e.$inject=["defaultUriSchemeUtil","managedEntityConstants"],e.DATACENTER_FOLDER_VALUE="group-d",e.VM_FOLDER_VALUE="group-v",e.NETWORK_FOLDER_VALUE="group-n",e.HOST_FOLDER_VALUE="group-h",e.DATASTORE_FOLDER_VALUE="group-s",e}();angular.module("com.vmware.vsphere.client.folder").component("moveFolderComponent",new t)}(folder_ui||(folder_ui={})),function(){function e(e,t){var i=this,r=t.modalOptions.availableTargets[0];i.closeModal=function(){t.closeModal()},i.removeFolder=function(){e.removeFolder(r),t.closeModal()}}angular.module("com.vmware.vsphere.client.folder").controller("removeFolderController",e),e.$inject=["folderService","$scope"]}(),function(){"use strict";function e(e,t){var i=this,r=e._route.objectId,n={title:t.getString("FolderUi","advancedSettings.view.title"),actions:[],objectId:r},o={propertyName:"vcServerSettings.advancedSettings",objectId:r};i.headerOptions=n,i.settingsViewOptions=o}angular.module("com.vmware.vsphere.client.folder").controller("VcAdvancedSettingsController",e),e.$inject=["$scope","i18nService"]}(),function(){"use strict";function e(e,t,i){e.portlet.footerLinks=[{label:t.getString("FolderUi","vcha.portlet.footer.settings"),onClick:function(){i.navigate("vsphere.core.folder.manage.settings.vchaView",i.getObjectId())},enabled:!0}]}angular.module("com.vmware.vsphere.client.folder").controller("VchaPortletController",e),e.$inject=["$scope","i18nService","navigation"]}();var spbm_ui;!function(e){h5=h5||{},h5.spbm={angularModule:angular.module("com.vmware.vsphere.client.spbm",["ngCookies"])},angular.module("com.vmware.vsphere.client.spbm").run(["columnRenderersRegistry","i18nService",function(e,t){e.registerColumnRenderers({"storage-policy-vc-name":function(t,i){var r=e.getColumnRenderer("icon-text");return r(["vcIcon","vcName"],{vcIcon:"vsphere-icon-vcenter",vcName:i[t[0]]})}}),e.registerColumnRenderers({"spbm-localized-line-of-service":function(i,r){var n="";if(r[i[0]]){var o="lineOfService."+r[i[0]];n=t.getString("SpbmUi",o),n&&n!==o||(n=r[i[0]])}var a=e.getColumnRenderer("text");return a(["localizedLineOfService"],{localizedLineOfService:n})}}),e.registerColumnRenderers({"storage-policy-compliance-status":function(i,r){var n=r[i[0]],o="",a="";switch(n){case"compliant":a="complianceStatus.compliant",o="vsphere-icon-status-ok";break;case"nonCompliant":a="complianceStatus.nonCompliant",o="vsphere-icon-status-error";break;case"outOfDate":a="complianceStatus.outOfDate",o="vsphere-icon-status-error";break;case"unknown":a="complianceStatus.unknown",o="vui-icon-datagrid-status-unknown";break;case"notApplicable":a="complianceStatus.notApplicable",o="vui-icon-datagrid-status-notApplicable"}var s=""===a?a:t.getString("SpbmUi",a),c=e.getColumnRenderer("icon-text");return c(["complianceStatusIcon","complianceStatusText"],{complianceStatusIcon:o,complianceStatusText:s})}}),e.registerColumnRenderers({"spbm-compliance-vm-name":function(t,i){var r=e.getColumnRenderer("object-name"),n={navigatable:!0,extensionName:"vsphere.core.vm.manage.settings.spbmPolicies"};return r(t,i,n)}})}]).run(["checkVmRollupComplianceService","i18nService",function(e,t){h5.actions["vsphere.core.vm.actions.checkVmRollupComplianceAction"]=function(t,i){i&&i.length&&e.invokeAction(i)}}]).run(["spbmManageVmStorageProfilesActionService",function(e){h5.actions["vsphere.core.pbm.storage.manageVmStorageProfilesAction"]=function(t,i){i&&i.length&&e.openDialog(i)}}]).run(["spbmReapplyStoragePolicyActionService",function(e){h5.actions["vsphere.core.pbm.storage.reapplyProfileForVms"]=function(t,i){i&&i.length&&e.openDialogForVm(i)}}]).run(["spbmReapplyStoragePolicyActionService",function(e){h5.actions["vsphere.core.pbm.storage.reapplyProfile"]=function(t,i,r){i&&i.length&&r&&r.length&&e.openDialogForProfile(r[0])}}]).run(["drpEditPolicyModalService",function(e){h5.actions["vsphere.core.datastore.drp.edit"]=function(t,i){i&&i.length&&e.openModal(i[0])}}]).run(["spbmFcdProfileService",function(e){h5.actions["vsphere.core.datastore.fcdNamespaceProfile.edit"]=function(t,i){i&&i.length&&e.updateFcdNamespaceProfile(i[0])}}]).run(["spbmProfileCheckComplianceActionService",function(e){h5.actions["vsphere.core.pbm.storage.checkProfileComplianceActionPrivate"]=function(t,i,r){r&&r.length&&e.checkProfilesCompliance(r)}}]).run(["spbmRemoveProfileActionService",function(e){h5.actions["vsphere.core.pbm.storage.removeProfileAction"]=function(t,i,r){r&&r.length&&e.removeStoragePolicies(r)}}]).run(["spbmCreateProfileActionService",function(e){h5.actions["vsphere.core.pbm.storage.createStorageProfileAction"]=function(t,i,r){e.createProfile()},h5.actions["vsphere.core.pbm.storage.editProfileAction"]=function(t,i,r){r&&e.editProfile(r)},h5.actions["vsphere.core.pbm.storage.cloneProfileAction"]=function(t,i,r){r&&e.cloneProfile(r)}}]).run(["spbmDspActionService",function(e){h5.actions["vsphere.core.pbm.storage.createDspAction"]=function(t,i,r){e.createProfile()},h5.actions["vsphere.core.pbm.storage.editDspAction"]=function(t,i,r){r&&1===r.length&&e.editProfile(r[0])},h5.actions["vsphere.core.pbm.storage.cloneDspAction"]=function(t,i,r){r&&1===r.length&&e.cloneProfile(r[0])},h5.actions["vsphere.core.pbm.storage.removeDspAction"]=function(t,i,r){e.removeProfiles(r)}}]).run(["spbmResetDefaultVsanProfileActionService",function(e){h5.actions["vsphere.core.pbm.storage.resetVsanDefaultProfileAction"]=function(t,i,r){r&&e.resetDefaultVsanProfile(r)}}])}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.navigation=e,this.datastoreId=this.navigation.getRoute().objectId}return e.$inject=["navigation"],e}();e.CapabilityProfilesCapacityPortletViewController=t,angular.module("com.vmware.vsphere.client.spbm").controller("CapabilityProfilesCapacityPortletViewController",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("SpbmUi","h5.profile.details.rules"),templateUrl:"spbm-ui/resources/spbm/views/profile/details/StorageProfileGeneralTab.html",uid:"profile.generalTab"},{name:this.i18nService.getString("SpbmUi","dataservice.tabs.usedInTitle"),templateUrl:"spbm-ui/resources/spbm/views/dsp/details/UsedInTab.html",uid:"profile.usedInTab"}])}}return e.$inject=["i18nService","$q"],e}();angular.module("com.vmware.vsphere.client.spbm").controller("DspViewController",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i){var r=this;this.$scope=e,this.commonActionBarService=t,this.vuiConstants=i,this.ACTION_BAR_ACTIONS="actions",this.$scope.onSelectionChanged=function(t,i){t!==i&&(r.selectedProfiles=t,e.masterDetailsViewContext.selectedItems=t,r.updateActionBar())},this.actionBarOptions={actions:[]},this.updateActionBar()}return e.prototype.updateActionBar=function(){var t=this;this.actionBarOptions&&this.actionBarOptions.actions&&this.actionBarOptions.actions.length&&this.actionBarOptions.actions.forEach(function(t){t.actionId&&t.actionId!==e.CREATE_DSP_ACTION&&(t.enabled=!1)});var i={actions:[]};this.commonActionBarService.updateActionBar(i,this.ACTION_BAR_ACTIONS,this.getProfilesIds(),this.getActions()).then(function(){t.actionBarOptions=i})},e.prototype.getProfilesIds=function(){return _.pluck(this.selectedProfiles,"id")},e.prototype.getActions=function(){var t=this,i=[];return i.push({actionId:e.CREATE_DSP_ACTION}),i.push(this.vuiConstants.actions.SEPARATOR),i.push({actionId:e.EDIT_DSP_ACTION,getActionInvocationContext:function(){return t.getProfilesIds()},isActionVisible:function(e){return t.selectedProfiles&&1===t.selectedProfiles.length&&e&&e.available}}),i.push({actionId:e.CLONE_DSP_ACTION,getActionInvocationContext:function(){return t.getProfilesIds()},isActionVisible:function(e){return t.selectedProfiles&&1===t.selectedProfiles.length&&e&&e.available}}),i.push({actionId:e.REMOVE_DSP_ACTION,getActionInvocationContext:function(){return t.getProfilesIds()},isActionVisible:function(e){return t.selectedProfiles&&t.selectedProfiles.length&&e&&e.available}}),i},e.CREATE_DSP_ACTION="vsphere.core.pbm.storage.createDspAction",e.REMOVE_DSP_ACTION="vsphere.core.pbm.storage.removeDspAction",e.EDIT_DSP_ACTION="vsphere.core.pbm.storage.editDspAction",e.CLONE_DSP_ACTION="vsphere.core.pbm.storage.cloneDspAction",e.$inject=["$scope","commonActionBarService","vuiConstants"],e}();e.DspListViewController=t,angular.module("com.vmware.vsphere.client.spbm").controller("DspListViewController",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcsSpbmCreateProfileActionService",{get:function(){return this._vcsSpbmCreateProfileActionService||(this._vcsSpbmCreateProfileActionService=this.$injector.get("vcsSpbmCreateProfileActionService")),this._vcsSpbmCreateProfileActionService},enumerable:!0,configurable:!0}),e.prototype.createProfile=function(){return this.vcsSpbmCreateProfileActionService.createProfile()},e.prototype.editProfile=function(e){return this.vcsSpbmCreateProfileActionService.editProfile(e)},e.prototype.cloneProfile=function(e){return this.vcsSpbmCreateProfileActionService.cloneProfile(e)},e.$inject=["$injector"],e}();e.SpbmCreateProfileActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmCreateProfileActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcsSpbmDspActionService",{get:function(){return this._vcsSpbmDspActionService||(this._vcsSpbmDspActionService=this.$injector.get("vcsSpbmDspActionService")),this._vcsSpbmDspActionService},enumerable:!0,configurable:!0}),e.prototype.createProfile=function(){this.vcsSpbmDspActionService.createProfile()},e.prototype.editProfile=function(e){this.vcsSpbmDspActionService.editProfile(e)},e.prototype.cloneProfile=function(e){this.vcsSpbmDspActionService.cloneProfile(e)},e.prototype.removeProfiles=function(e){this.vcsSpbmDspActionService.removeProfiles(e)},e.$inject=["$injector"],e}();e.SpbmDspActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmDspActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcSpbmProfileCheckComplianceActionService",{get:function(){return this._vcSpbmProfileCheckComplianceActionService||(this._vcSpbmProfileCheckComplianceActionService=this.$injector.get("vcSpbmProfileCheckComplianceActionService")),this._vcSpbmProfileCheckComplianceActionService},enumerable:!0,configurable:!0}),e.prototype.checkProfilesCompliance=function(e){return this.vcSpbmProfileCheckComplianceActionService.checkProfilesCompliance(e)},e.$inject=["$injector"],e}();e.SpbmProfileCheckComplianceActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmProfileCheckComplianceActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcSpbmRemoveProfileActionService",{get:function(){return this._vcSpbmRemoveProfileActionService||(this._vcSpbmRemoveProfileActionService=this.$injector.get("vcSpbmRemoveProfileActionService")),this._vcSpbmRemoveProfileActionService},enumerable:!0,configurable:!0}),e.prototype.removeStoragePolicies=function(e){return this.vcSpbmRemoveProfileActionService.removeStoragePolicies(e)},e.$inject=["$injector"],e}();e.SpbmRemoveProfileActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmRemoveProfileActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcSpbmResetDefaultVsanProfileActionService",{get:function(){return this._vcSpbmResetDefaultVsanProfileActionService||(this._vcSpbmResetDefaultVsanProfileActionService=this.$injector.get("vcSpbmResetDefaultVsanProfileActionService")),this._vcSpbmResetDefaultVsanProfileActionService},enumerable:!0,configurable:!0}),e.prototype.resetDefaultVsanProfile=function(e){return this.vcSpbmResetDefaultVsanProfileActionService.resetDefaultVsanProfile(e)},e.$inject=["$injector"],e}();e.SpbmResetDefaultVsanProfileActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmResetDefaultVsanProfileActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=com.vmware.vsphere.client.spbm.spec.AssignDrpSpec,i=com.vmware.vsphere.client.common.spbm.spec.QueryDrpSpec,r=function(){function e(e,t,i,r,n,o,a){this.clarityModalService=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.dataService=r,this.clarityConstants=n,this.mutationService=o,this.$q=a,this.AVAILABLE_DRP_PROPERTY="availableDefaultResourceProfiles",this.DEFAULT_PROFILE_PROPERTY="datastore:defaultRequirementProfileName"}return e.prototype.openModal=function(e){var i=this,r=this.defaultUriSchemeUtil.getManagedObjectReference(e),n=this.defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(e),o=this;this.modalOptions={title:this.i18nService.getString("SpbmUi","h5.drp.defaultProfileDialog.title"),contentTemplate:"spbm-ui/resources/spbm/views/profile/edit/EditDefaultStoragePolicy.html",defaultButton:"submit",size:"lg",subTitle:{objectId:e},dialogData:{policies:[],selectedPolicy:null},onSubmit:function(){if(!this.dialogData.selectedPolicy)return this.alerts=[{text:o.i18nService.getString("CommonUi","objectSelectorDialog.noSelection"),type:o.clarityConstants.notifications.type.ERROR}],!1;var e=new t;return e.datastores=[r],e.defaultProfile=this.dialogData.selectedPolicy.profileId,o.mutationService.apply(n,e._type,e),!0},alerts:[]},this.modalOptions.dialogData.isLoading=!0;var a=this.loadData(r,n),s=this.getCurrentProfile(e);this.$q.all([a,s]).then(function(e){var t=e[0],r=e[1],n=t[i.AVAILABLE_DRP_PROPERTY],o=r[i.DEFAULT_PROFILE_PROPERTY][0],a=_.find(n,function(e){return e.name===o.value});a&&(i.modalOptions.dialogData.defaultSelectedPolicy=a),i.modalOptions.dialogData.isLoading=!1,i.modalOptions.dialogData.policies=n})["catch"](function(){i.modalOptions.dialogData.isLoading=!1,i.modalOptions.alerts=[{text:i.i18nService.getString("SpbmUi","h5.drp.serviceUnavailable"),type:i.clarityConstants.notifications.type.ERROR}],i.modalOptions.dialogData.policies=[]}),this.clarityModalService.openOkCancelModal(this.modalOptions)},e.prototype.getCurrentProfile=function(e){return this.dataService.getProperties(e,this.DEFAULT_PROFILE_PROPERTY)},e.prototype.loadData=function(e,t){var r=new i;r.datastores=[e];var n=[{propertyName:this.AVAILABLE_DRP_PROPERTY,parameterType:r._type,parameter:r}];return this.dataService.getProperties(t,this.AVAILABLE_DRP_PROPERTY,{propertyParams:n})},e.$inject=["clarityModalService","i18nService","defaultUriSchemeUtil","dataService","clarityConstants","mutationService","$q"],e}();e.DrpEditPolicyModalService=r,angular.module("com.vmware.vsphere.client.spbm").service("drpEditPolicyModalService",r)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i){var r=this;this.i18nService=e,this.dataService=t,this.vuiConstants=i,this.preselectComparator=function(e){return r.defaultSelectedPolicy&&e.name===r.defaultSelectedPolicy.name},this.initDatagrid(),this.message=this.i18nService.getString("SpbmUi","drp.defaultProfileDialog.infoSingle")}return e.prototype.$onChanges=function(){this.policies&&this.policies.length&&(this.datagridOptions.data=this.policies)},e.prototype.initDatagrid=function(){var e=this;this.datagridOptions={resizable:!0,height:"100%",columnDefs:this.getColumnDefs(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.policies,onChange:function(){e.selectedPolicy=e.datagridOptions.selectedItems[0]}}},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("SpbmUi","drp.defaultProfileDialog.policyColumn"),field:"name",template:"#:name#"},{displayName:this.i18nService.getString("SpbmUi","drp.defaultProfileDialog.descriptionColumn"),field:"description",template:"#:description#"}]},e.$inject=["i18nService","dataService","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.spbm").component("editDefaultStoragePolicyComponent",{controller:t,templateUrl:"spbm-ui/resources/spbm/views/profile/edit/EditDefaultStoragePolicyComponent.html",bindings:{policies:"<",defaultSelectedPolicy:"<",selectedPolicy:"=",isLoading:"<"}})}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vscSpbmFcdProfileActionService",{get:function(){return this._vsdSpbmFcdProfileService||(this._vsdSpbmFcdProfileService=this.$injector.get("vscSpbmFcdProfileService")),this._vsdSpbmFcdProfileService},enumerable:!0,configurable:!0}),e.prototype.updateFcdNamespaceProfile=function(e){return this.vscSpbmFcdProfileActionService.updateFcdNamespaceProfile(e)},e.$inject=["$injector"],e}();e.SpbmFcdProfileService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmFcdProfileService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.commonActionBarService=t,this.defaultUriSchemeUtil=i,this.dataService=r,this.vuiConstants=n,this.userSessionService=o,this.isCreateActionAvailable=!1,this.GRANTED_PRIVILEGES="grantedPrivileges",this.SPBM_UPDATE_PRIVILEGE="StorageProfile.Update",this.STORAGE_PROFILE_VIEW_PRIVILEGE="StorageProfile.View",this.CHECK_COMPLIANCE_ACTION="vsphere.core.pbm.storage.checkProfileComplianceActionPrivate",this.REAPPLY_PROFILE_ACTION="vsphere.core.pbm.storage.reapplyProfile",this.REMOVE_STORAGE_POLICY="vsphere.core.pbm.storage.removeProfileAction",this.EDIT_STORAGE_POLICY="vsphere.core.pbm.storage.editProfileAction",this.CLONE_STORAGE_POLICY="vsphere.core.pbm.storage.cloneProfileAction",this.CREATE_PROFILE_ACTION="vsphere.core.pbm.storage.createStorageProfileAction",this.REVERT_DEFAULT_VSAN_POLICY_ACTION="vsphere.core.pbm.storage.resetVsanDefaultProfileAction",this.ACTION_BAR_ACTIONS="actions",this.$scope.onSelectionChanged=function(t,i){if(e.masterDetailsViewContext.selectedItems=t,a.selectedProfiles=t,a.hasWritePrivilegeOnAllVcs=!1,a.selectedProfiles&&a.selectedProfiles.length)var r=a.lastDsRequest=a.dataService.getPropertiesForObjects(a.getDistinctVCs(),[a.GRANTED_PRIVILEGES]).then(function(e){r===a.lastDsRequest&&(a.hasWritePrivilegeOnAllVcs=_.every(e,function(e){return _.contains(e.grantedPrivileges,a.SPBM_UPDATE_PRIVILEGE)}))})["finally"](function(){r===a.lastDsRequest&&a.updateActionBar()});else a.updateActionBar()},this.actionBarOptions={actions:[]},this.getCreateActionAvailability(),this.updateActionBar()}return e.prototype.updateActionBar=function(){var e=this;this.actionBarOptions&&this.actionBarOptions.actions&&this.actionBarOptions.actions.length&&this.actionBarOptions.actions.forEach(function(t){t.actionId&&t.actionId!==e.CREATE_PROFILE_ACTION&&(t.enabled=!1)});var t={actions:[]};this.commonActionBarService.updateActionBar(t,this.ACTION_BAR_ACTIONS,this.getProfilesIds(),this.getActions()).then(function(){e.actionBarOptions=t})},e.prototype.getActions=function(){var e=this,t=[];return t.push({actionId:this.CREATE_PROFILE_ACTION,isActionAvailable:function(t){return e.isCreateActionAvailable&&t}}),t.push(this.vuiConstants.actions.SEPARATOR),t.push({actionId:this.EDIT_STORAGE_POLICY,getActionInvocationContext:function(){return e.getProfilesIds()[0]},isActionVisible:function(t){return e.selectedProfiles&&1===e.selectedProfiles.length&&t&&t.available&&e.hasWritePrivilegeOnAllVcs}},{actionId:this.CLONE_STORAGE_POLICY,getActionInvocationContext:function(){return e.getProfilesIds()[0]},isActionVisible:function(t){return e.selectedProfiles&&1===e.selectedProfiles.length&&t&&t.available&&e.hasWritePrivilegeOnAllVcs}},{actionId:this.CHECK_COMPLIANCE_ACTION,getActionInvocationContext:function(){return e.getProfilesIds()},isActionVisible:function(t){return e.selectedProfiles&&e.selectedProfiles.length&&t&&t.available&&e.hasWritePrivilegeOnAllVcs}},{actionId:this.REAPPLY_PROFILE_ACTION,getActionInvocationContext:function(){return e.getProfilesIds()},isActionVisible:function(t){return e.selectedProfiles&&e.selectedProfiles.length&&t&&t.available&&e.hasWritePrivilegeOnAllVcs}},{actionId:this.REMOVE_STORAGE_POLICY,getActionInvocationContext:function(){return e.getProfilesIds()},isActionVisible:function(t){return e.selectedProfiles&&e.selectedProfiles.length&&t&&t.available&&e.hasWritePrivilegeOnAllVcs}}),t.push({actionId:this.REVERT_DEFAULT_VSAN_POLICY_ACTION,getActionInvocationContext:function(){return e.getProfilesIds()[0]},isActionVisible:function(t){return e.selectedProfiles&&1===e.selectedProfiles.length&&t&&t.available&&e.hasWritePrivilegeOnAllVcs}}),t},e.prototype.getDistinctVCs=function(){var e=this,t=_.map(this.selectedProfiles,function(t){return e.defaultUriSchemeUtil.getUriIdSegments(t.id)[2]}),i=_.map(t,function(t){return e.defaultUriSchemeUtil.getRootFolder(t)});return _.uniq(i)},e.prototype.getProfilesIds=function(){return _.pluck(this.selectedProfiles,"id")},e.prototype.getCreateActionAvailability=function(){var e=this;this.isCreateActionAvailable=!1,this.getServersInfo().then(function(t){if(t.length){var i=_.map(t,function(t){return e.defaultUriSchemeUtil.getRootFolder(t.serviceGuid)});e.dataService.getPropertiesForObjects(i,[e.GRANTED_PRIVILEGES]).then(function(t){e.isCreateActionAvailable=_.some(t,function(t){return _.contains(t.grantedPrivileges,e.SPBM_UPDATE_PRIVILEGE)&&_.contains(t.grantedPrivileges,e.STORAGE_PROFILE_VIEW_PRIVILEGE)}),e.updateActionBar()})}else e.updateActionBar()})},e.prototype.getServersInfo=function(){var e=this;return this.userSessionService.getAllServersInfo().then(function(t){var i=[];return t&&t.serversInfo&&t.serversInfo.forEach(function(t){t.errorCode&&t.errorCode!==e.userSessionService.VC_NO_ERROR_CODE||i.push(t)}),i})},e.$inject=["$scope","commonActionBarService","defaultUriSchemeUtil","dataService","vuiConstants","userSessionService"],e}();e.StorageProfilesListViewController=t,angular.module("com.vmware.vsphere.client.spbm").controller("StorageProfilesListViewController",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("SpbmUi","h5.profile.details.rules"),templateUrl:"spbm-ui/resources/spbm/views/profile/details/StorageProfileGeneralTab.html",uid:"profile.generalTab"},{name:this.i18nService.getString("SpbmUi","h5.profile.details.vmCompliance"),templateUrl:"spbm-ui/resources/spbm/views/profile/details/VmComplianceTab.html",uid:"profile.vmComplianceTab"},{name:this.i18nService.getString("Common","typeResource.vmTemplate"),templateUrl:"spbm-ui/resources/spbm/views/profile/details/VmTemplatesTab.html",uid:"profile.vmTemplatesTab"},{name:this.i18nService.getString("SpbmUi","h5.profile.details.storageCompatibility"),templateUrl:"spbm-ui/resources/spbm/views/profile/details/StorageCompatibilityTab.html",uid:"profile.storageCompatibilityTab"}])}}return e.$inject=["i18nService","$q"],e}();angular.module("com.vmware.vsphere.client.spbm").controller("StorageProfilesViewController",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vscSpbmManageVmStorageProfilesActionService",{get:function(){return this._vscSpbmManageVmStorageProfilesActionService||(this._vscSpbmManageVmStorageProfilesActionService=this.$injector.get("vscSpbmManageVmStorageProfilesModalService")),this._vscSpbmManageVmStorageProfilesActionService},enumerable:!0,configurable:!0}),e.prototype.openDialog=function(e){this.vscSpbmManageVmStorageProfilesActionService.openDialog(e)},e.$inject=["$injector"],e}();e.SpbmManageVmStorageProfilesActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmManageVmStorageProfilesActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcSpbmReapplyStoragePolicyActionService",{get:function(){return this._vcSpbmReapplyStoragePolicyActionService||(this._vcSpbmReapplyStoragePolicyActionService=this.$injector.get("vcReapplyVmStoragePolicyService")),this._vcSpbmReapplyStoragePolicyActionService},enumerable:!0,configurable:!0}),e.prototype.openDialogForVm=function(e){this.vcSpbmReapplyStoragePolicyActionService.openDialogForVm(e)},e.prototype.openDialogForProfile=function(e){this.vcSpbmReapplyStoragePolicyActionService.openDialogForProfile(e)},e.$inject=["$injector"],e}();e.SpbmReapplyStoragePolicyActionService=t,angular.module("com.vmware.vsphere.client.spbm").service("spbmReapplyStoragePolicyActionService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.mutationService=t,this.dataService=i,this.clarityModalService=r}return e.prototype.invokeAction=function(e){var t=this;if(e.length>1)return void this.makeMutationCall(e);var i="areVmProfilesOutdated";this.dataService.getProperties(e[0],[i]).then(function(r){
r[i]?t.showWarning():t.makeMutationCall(e)})},e.prototype.showWarning=function(){var e={title:this.i18nService.getString("SpbmUi","checkCompliance.warning.title"),hideCancelButton:!0,message:this.i18nService.getString("SpbmUi","checkCompliance.warning.text"),icon:"icon-warning-32",submit:function(){return!0},preserveNewlines:!0};this.clarityModalService.openConfirmationModal(e)},e.prototype.makeMutationCall=function(e){var t={_type:"com.vmware.vsphere.client.spbm.spec.CheckVmRollupComplianceSpec"};this.mutationService.applyOnMultiEntity(e,t._type,t,this.i18nService.getString("SpbmUi","checkVmRollupComplianceAction.label"))},e.$inject=["i18nService","mutationService","dataService","clarityModalService"],e}();e.CheckVmRollupComplianceService=t,angular.module("com.vmware.vsphere.client.spbm").service("checkVmRollupComplianceService",t)}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){angular.module("com.vmware.vsphere.client.spbm").constant("VmStoragePoliciesConstants",{device:{type:{VM_HOME:"vmHome",VM_DISK:"vmDisk"}}})}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.timeFormatterService=r,this.$q=n,this.datagridActionBarService=o,this.listUtil=a,this.VmStoragePoliciesConstants=s,this.$scope=c,this.preselectComparator=function(e){return!!l.itemToSelect&&l.itemToSelect.name===e.name},this.updateActionBar=function(){return l.datagridActionBarService.updateActionBar(l.datagridOptions,[l.vmId],[{actionId:l.ACTIONS.CHECK_VM_COMPLIANCE},{actionId:l.ACTIONS.REAPPLY_VM_STORAGE_POLICY}])},this.i18n=e.getString,this.ACTIONS={CHECK_VM_COMPLIANCE:"vsphere.core.vm.actions.checkVmRollupComplianceAction",REAPPLY_VM_STORAGE_POLICY:"vsphere.core.pbm.storage.reapplyProfileForVms"}}return e.prototype.$onInit=function(){var e=this;this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],resizable:!0,selectedItems:[],actionBarOptions:{actions:[]}},this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t!==i&&e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=t)})},e.prototype.$onChanges=function(){var e=this;if(this.policyAssignments){var t=[];_.forEach(this.policyAssignments,function(i){var r=i.lastChecked?i.lastChecked:"";t.push(e.timeFormatterService.formatDate(r)),i._complianceFailures=i.complianceFailures;var n=e.formatComplianceItem(i.complianceStatus);i.complianceStatus=n.complianceStatusText,i.complianceStatusIcon=n.complianceStatusIcon}),this.$q.all(t).then(function(t){_.forEach(t,function(t,i){e.policyAssignments[i].formatedDate=t}),e.masterDetailsViewContext&&e.masterDetailsViewContext.selectedItems&&1===e.masterDetailsViewContext.selectedItems.length?e.itemToSelect=e.masterDetailsViewContext.selectedItems[0]:e.itemToSelect=null,e.datagridOptions.data=e.policyAssignments,e.updateActionBar()})}},e.prototype.getColumnDefinitions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("icon-text"),i=(this.columnRenderersRegistry.getColumnRenderer("storage-policy-compliance-status"),this.listUtil.compareNumericValues);return[{displayName:this.i18nService.getString("SpbmUi","nameColumnHeader"),field:"name",template:function(i){var r=i.type===e.VmStoragePoliciesConstants.device.type.VM_HOME?"vx-icon-virtualMachineFolder":"vx-icon-vmDisk",n={name:i.name,icon:r};return t(["icon","name"],n)}},{displayName:this.i18nService.getString("SpbmUi","manageVmReplicationGroupsForm.profileColumn"),field:"storagePolicy",template:function(i){var r={storagePolicy:i.storagePolicy,icon:""};return r.storagePolicy?r.icon="spbm-ui-icon-storage-profile":r.storagePolicy=e.i18nService.getString("SpbmUi","viewVmProfileAssignments.noneProfileLabel"),t(["icon","storagePolicy"],r)}},{displayName:this.i18nService.getString("SpbmUi","complianceStatusColumnHeader"),field:"complianceStatus",template:function(e){var i={complianceStatusIcon:e.complianceStatusIcon,complianceStatusText:e.complianceStatus};return t(["complianceStatusIcon","complianceStatusText"],i)}},{displayName:this.i18nService.getString("SpbmUi","lastCheckedColumnHeader"),field:"lastChecked",template:function(e){return e.formatedDate},sortable:function(e,t){return i(e,t,"lastChecked")}}]},e.prototype.formatComplianceItem=function(e){var t="",i="";switch(e){case"compliant":i="complianceStatus.compliant",t="vsphere-icon-status-ok";break;case"nonCompliant":i="complianceStatus.nonCompliant",t="vsphere-icon-status-error";break;case"outOfDate":i="complianceStatus.outOfDate",t="vsphere-icon-status-error";break;case"unknown":i="complianceStatus.unknown",t="vui-icon-datagrid-status-unknown";break;case"notApplicable":i="complianceStatus.notApplicable",t="vui-icon-datagrid-status-notApplicable"}var r=""===i?i:this.i18nService.getString("SpbmUi",i);return{complianceStatusIcon:t,complianceStatusText:r}},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry","timeFormatterService","$q","datagridActionBarService","listUtil","VmStoragePoliciesConstants","$scope"],e}();e.VmStoragePoliciesListController=t,angular.module("com.vmware.vsphere.client.spbm").component("vmStoragePoliciesList",{templateUrl:"spbm-ui/resources/spbm/views/vm/configurePolicies/VmStoragePoliciesList.html",bindings:{policyAssignments:"<",vmId:"<",masterDetailsViewContext:"<"},controller:t})}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.navigation=e,this.dataService=t,this.i18nService=i,this.$q=r,this.loading=!1,this.refresh=function(){n.loading=!0,n.dataService.getProperties(n.vmId,["storagePoliciesData"]).then(function(e){n.hasSpbmViewPrivilege=e.storagePoliciesData.hasSpbmViewPrivilege,n.storagePolicies=e.storagePoliciesData.profilesDataList,n.masterDetailsViewContext.storagePolicies=n.storagePolicies})["finally"](function(){n.loading=!1})},this.vmId=this.navigation.getRoute().objectId,this.watchedObjects=[this.vmId],this.i18n=this.i18nService.getString,this.headerOptions={objectId:this.vmId,actions:[{actionUid:"vsphere.core.pbm.storage.manageVmStorageProfilesAction",customLabel:this.i18nService.getString("SpbmUi","manageVmProfiles.dialogTitle")}]},this.masterDetailsViewContext={},this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("SpbmUi","h5.complianceFailuresList.complianceFailures"),templateUrl:"spbm-ui/resources/spbm/views/vm/configurePolicies/VmComplianceFailuresView.html",uid:"complianceFailures"}])}}return e.prototype.$onInit=function(){this.refresh()},e.$inject=["navigation","dataService","i18nService","$q"],e}();e.VmStoragePoliciesViewController=t,angular.module("com.vmware.vsphere.client.spbm").component("vmStoragePolicies",{templateUrl:"spbm-ui/resources/spbm/views/vm/configurePolicies/VmStoragePoliciesView.html",controller:t})}(spbm_ui||(spbm_ui={}));var spbm_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.i18nService=e,this.dataService=t,this.navigation=i,this.timeFormatterService=r,this.$scope=n,this.actionsService=o,this.PROPERTY="vmComplianceSummary",this.ACTION_ID="vsphere.core.vm.actions.checkVmRollupComplianceAction",this.loadData=function(){a.dataService.getProperties(a.watchedObjects[0],[a.PROPERTY]).then(a.render)},this.render=function(e){var t=e.vmComplianceSummary;if(!t||!t.hasSpbmViewPrivilege)return a.complianceStatus=null,a.associatedProfiles=null,void(a.lastCheckedDate=null);t.oldestCheckTime&&a.timeFormatterService.formatDate(t.oldestCheckTime).then(function(e){a.lastCheckedDate=e});var i=t.storagePolicyNames;a.associatedProfiles=_.map(i,function(e){return{text:e,iconClass:"spbm-ui-icon-storage-profile"}}),a.associatedReplicationGroups=t.replicationGroupNames,t.complianceStatus&&(a.complianceStatus=a.formatComplianceStatus(t.complianceStatus))},this.watchedObjects=[this.navigation.getRoute().objectId],this.EMPTY={text:e.getString("SpbmUi","string.na"),iconClass:""}}return e.prototype.$onInit=function(){this.loadData(),this.initPortletFooterLink()},e.prototype.initPortletFooterLink=function(){var e=this,t=this.i18nService.getString("SpbmUi","storageProfile.actions.checkCompliance");this.actionsService.getActions(this.watchedObjects,[this.ACTION_ID]).then(function(i){var r=i[0];e.portletConfigObject.footerLinks=[{enabled:r&&r.available,label:t,ariaLabel:e.i18nService.getString("SpbmUi","checkVmRollupComplianceAction.label"),onClick:function(){e.actionsService.invokeAction(r)}}]})},e.prototype.formatComplianceStatus=function(e){var t,i="complianceStatus."+e;switch(e){case"compliant":t="vx-icon-statusCompliant";break;case"nonCompliant":t="vx-icon-statusNotCompliant";break;case"outOfDate":t="vx-icon-statusNotCompliant";break;case"notApplicable":t="vx-icon-statusNotApplicable";break;default:t="vsphere-icon-status-unknown"}return{text:this.i18nService.getString("SpbmUi",i),iconClass:t}},e.$inject=["i18nService","dataService","navigation","timeFormatterService","$scope","actionsService"],e}();e.VmStoragePoliciesPortletController=t,angular.module("com.vmware.vsphere.client.spbm").component("vmStoragePoliciesPortlet",{templateUrl:"spbm-ui/resources/spbm/views/vm/VmStoragePoliciesPortlet.html",controller:t,bindings:{portletConfigObject:"="}})}(spbm_ui||(spbm_ui={}));var h5_vapp;!function(e){h5=h5||{},h5.vapp={angularModule:angular.module("com.vmware.vsphere.client.vapp",["com.vmware.platform.ui"])},angular.module("com.vmware.vsphere.client.vapp").run(["clarityModalService","mutationService","i18nService","$injector","vAppDragAndDropService","dragAndDropStockExpressionsService","moveVAppService","vappRemovalService",function(e,t,i,r,n,o,a,s){h5.actions["vsphere.core.vApp.actions.editNotes"]=function(i,r){var n=function(e,i,r){var n="com.vmware.vim.binding.vim.vApp.VAppConfigSpec",o={_type:n,annotation:i};return t.apply(e,n,o,r),!0},o={notesPropName:"vAppConfig.annotation",onUpdateNotesCallback:n};e.openModal(i,r,o,"common-module-ui/resources/common-module/views/notes/NotesDialog.html")},h5.actions["vsphere.core.vApp.actions.edit"]=function(e,t){r.get("vcVappEditActionService").editVapp(t[0])},h5.actions["vsphere.core.vApp.actions.create"]=function(e,t){r.get("vcVappCreateActionService").createVapp(e,t)},h5.actions["vsphere.core.vApp.powerOnAction"]=function(e,t){r.get("vcVappPoweropsService").powerOn(t[0])},h5.actions["vsphere.core.vApp.powerOffAction"]=function(e,t){r.get("vcVappPoweropsService").powerOff(t[0])},h5.actions["vsphere.core.vApp.shutdownAction"]=function(e,t){r.get("vcVappPoweropsService").shutdown(t[0])},h5.actions["vsphere.core.vApp.suspendAction"]=function(e,t){r.get("vcVappPoweropsService").suspend(t[0])},h5.actions["vsphere.core.vApp.cloneAction"]=function(e,t){r.get("vcVappCreateActionService").cloneVapp(e,t)},h5.actions["vsphere.core.vApp.actions.exportAsOVF"]=function(e,t){if(0!==t.length){var i=t[0],n=r.get("vscExportOvfModalService");n.openExportOvfDialog(i)}},h5.actions["vsphere.core.vApp.actions.moveVapp"]=function(e,t){a.moveVApps(t)},h5.actions["vsphere.core.vApp.actions.dragAndDrop"]=function(e,t,i){n.dragAndDropVapp(t,i,e)},h5.actions["vsphere.core.vApp.actions.unregisterAction"]=function(e,t){s.unregisterVapps(t)},h5.actions["vsphere.core.vApp.actions.deleteAction"]=function(e,t){s.deleteVapps(t)},h5.dragAndDropValidationMethods.isVappWithinSameStandaloneAccessibleHost=function(e,t){return!!o.isTargetAccessible(e)&&o.isWithinSameStandaloneHost(e,t)}}])}(h5_vapp||(h5_vapp={}));var h5_vapp;!function(e){var t=com.vmware.vsphere.client.mixed.ManagedEntityMoveSpec,i=com.vmware.vsphere.client.h5.vapp.data.ValidateMoveVappSpec,r=function(){function e(e,t,i,r,n,o,a,s){this.PROPERTY_OWNER="owner",this.PROPERTY_DATACENTER="dc",this.PROPERTY_HOST="host",this.PROPERTY_RESOURCE_POOL="resourcePool",this._mutationService=e,this._defaultUriSchemeUtil=t,this._i18nService=i,this._q=r,this._nameAndFolderValidatorService=n,this._managedEntityConstants=o,this._clarityModalService=a,this._dataService=s}return e.prototype.moveVApps=function(e,t){var i=this;return t&&t.dropTarget?void this.applyMove(e,t.dropTarget):void this.requestProperties(e).then(function(t){i.showDialog(e,t)})},e.prototype.buildMoveSpec=function(e){var i=this._defaultUriSchemeUtil.getManagedObjectReferences(e),r=new t;return r.entities=i,r},e.prototype.applyMove=function(e,t){var i=this,r=this.buildMoveSpec(e),n=this._defaultUriSchemeUtil.getEntityType(t);n===this._managedEntityConstants.HOST||n===this._managedEntityConstants.CLUSTER?this._dataService.getPropertiesForObjects([t],[this.PROPERTY_RESOURCE_POOL]).then(function(e){t=i._defaultUriSchemeUtil.getVsphereObjectId(e[t][i.PROPERTY_RESOURCE_POOL]),i._mutationService.apply(t,r._type,r)}):n===this._managedEntityConstants.DATACENTER?this._dataService.getProperties(t,["vmFolder"]).then(function(e){t=i._defaultUriSchemeUtil.getVsphereObjectId(e.vmFolder),i._mutationService.apply(t,r._type,r)}):this._mutationService.apply(t,r._type,r)},e.prototype.validateMove=function(e,t){var i=this._defaultUriSchemeUtil.getEntityType(t);switch(i){case this._managedEntityConstants.FOLDER:if(this._nameAndFolderValidatorService.isVmFolder(t))return this.retrieveValidationMessage(e,t);break;case this._managedEntityConstants.DATACENTER:case this._managedEntityConstants.CLUSTER:case this._managedEntityConstants.HOST:case this._managedEntityConstants.RESOURCE_POOL:case this._managedEntityConstants.V_APP:return this.retrieveValidationMessage(e,t)}return this._q.when(this._i18nService.getString("Common","moveTo.incorrectTargetTypeError"))},e.prototype.retrieveValidationMessage=function(e,t){var r=this._defaultUriSchemeUtil.getManagedObjectReferences(e),n=new i;return n.entities=r,e.indexOf(t)!==-1?this._q.when(this._i18nService.getString("Common","moveTo.targetValidationError")):this._mutationService.validate(t,n._type,n).then(function(e){return e.error?e.error:e.result})},e.prototype.showDialog=function(e,t){var i=this.buildSubtitle(e),r={title:this._i18nService.getString("VAppUi","moveVappDialog.Title"),subTitle:i,defaultButton:"submit",dialogData:{objectIds:e,datacenter:this._defaultUriSchemeUtil.getVsphereObjectId(t.datacenter),rpOwner:this._defaultUriSchemeUtil.getVsphereObjectId(t.owner)},contentTemplate:"vapp-ui/resources/vapp/views/moveVapp/moveVappDialog.html"};this._clarityModalService.openOkCancelModal(r)},e.prototype.buildSubtitle=function(e){var t={};return 1===e.length?(t.objectId=e[0],t):(t.text=this._i18nService.getString("Common","contextMenu.title.nObjects",e.length),t)},e.prototype.requestProperties=function(e){var t=this,i=this._q.defer(),r={};return this._dataService.getPropertiesForObjects(e,[this.PROPERTY_OWNER,this.PROPERTY_DATACENTER,this.PROPERTY_HOST]).then(function(n){r.datacenter=n[e[0]][t.PROPERTY_DATACENTER];var o=t._defaultUriSchemeUtil.getVsphereObjectId(n[e[0]][t.PROPERTY_OWNER]),a=_.every(n,function(e){return o===t._defaultUriSchemeUtil.getVsphereObjectId(e[t.PROPERTY_OWNER])});if(a){var s=n[e[0]][t.PROPERTY_OWNER].type;s===t._managedEntityConstants.COMPUTE_RESOURCE?r.owner=n[e[0]][t.PROPERTY_HOST]:r.owner=n[e[0]][t.PROPERTY_OWNER]}else r.owner=null;i.resolve(r)}),i.promise},e.$inject=["mutationService","defaultUriSchemeUtil","i18nService","$q","nameAndFolderValidatorService","managedEntityConstants","clarityModalService","dataService"],e}();e.MoveVAppService=r,angular.module("com.vmware.vsphere.client.vapp").service("moveVAppService",r)}(h5_vapp||(h5_vapp={}));var h5_vapp;!function(e){var t=function(){function e(e,t,i,r,n){this._defaultUriSchemeUtil=e,this._i18nService=t,this._actionConfirmationService=i,this._moveVAppService=r}return e.prototype.dragAndDropVapp=function(e,t,i){var r=this;this._moveVAppService.validateMove(e,t.dropTarget).then(function(n){n?r.displayWarning(i.action,n):r._moveVAppService.moveVApps(e,t)})},e.prototype.displayWarning=function(e,t){void 0===e&&(e={}),void 0===t&&(t="");var i=e.confirmationTitle?e.confirmationTitle:e.label,r={title:i,message:t};this._actionConfirmationService.showWarningDialog(r)},e.$inject=["defaultUriSchemeUtil","i18nService","actionConfirmationService","moveVAppService"],e}();e.VAppDragAndDropService=t,angular.module("com.vmware.vsphere.client.vapp").service("vAppDragAndDropService",t)}(h5_vapp||(h5_vapp={}));var h5_vapp;!function(e){var t=com.vmware.vsphere.client.vapp.VAppRemovalSpec,i=function(){function e(e){this.mutationService=e}return e.prototype.unregisterVapps=function(t){var i=e.buildRemovalSpec(!1);this.mutationService.removeOnMultiEntity(t,i._type,i)},e.prototype.deleteVapps=function(t){var i=e.buildRemovalSpec(!0);this.mutationService.removeOnMultiEntity(t,i._type,i)},e.buildRemovalSpec=function(e){var i=new t;return i.deleteFromDisk=e,i},e.$inject=["mutationService"],e}();e.VappRemovalService=i,angular.module("com.vmware.vsphere.client.vapp").service("vappRemovalService",i)}(h5_vapp||(h5_vapp={}));var h5_vapp;!function(e){var t=function(){function e(){}return e}();angular.module("com.vmware.vsphere.client.vapp").component("legacyVappEulaPageView",{bindings:{vappId:"<"},controller:t,template:'\n            <vapp-eula-page-view\n               class="eula-flex-fill-parent"\n               [vapp-id]="$ctrl.vappId"\n            >\n            </vapp-eula-page-view>\n      '})}(h5_vapp||(h5_vapp={}));var h5_vapp;!function(e){var t=function(){function e(){this.bindings={objectIds:"<",datacenter:"<",owner:"<",onSubmit:"=",submitDisabled:"=",alerts:"=",closeModal:"<"},this.controller=i,this.templateUrl="vapp-ui/resources/vapp/views/moveVapp/moveVappViewComponent.html"}return e}();e.MoveVappViewComponent=t;var i=function(){function e(e,t,i,r,n,o){this.$element=n,this.$timeout=o,this.loading=!1,this._scope=e,this._moveVappService=t,this._i18nService=i,this._vuiConstants=r,this._targetId={},this.selectedTabUrl="vapp_host_and_cluster_tree.html",this.submitDisabled=!0,this.actionMoveInstruction=this._i18nService.getString("VAppUi","actionMoveInstruction"),this.loadingLabel=this._i18nService.getString("CommonUi","wizard.loading"),this._scope.tabOptions={tabType:this._vuiConstants.tabs.type.PRIMARY,tabs:this.getTabs()}}return e.prototype.$onInit=function(){var e=this;this.submitDisabled=!0,this.onSubmit=function(){e.submitDisabled=!0,e.loading=!0;var t=e._targetId[e.selectedTabUrl];e._moveVappService.validateMove(e.objectIds,t).then(function(i){if(i){var r={type:e._vuiConstants.validationBanner.type.ERROR,text:i};e.alerts=[r]}else e._moveVappService.applyMove(e.objectIds,t),e.closeModal();e.loading=!1,e.submitDisabled=!1})},this.onTabSelected=function(t){var i=e.getTabs();e.selectedTabUrl=i[t].contentUrl},this.$timeout(function(){var t=e.$element[0].querySelector("button");t&&t.focus()},0)},e.prototype.onLocationSelected=function(e,t){this.submitDisabled=!1,this._targetId[t]=e},e.prototype.getTabs=function(){var e={iconClass:"vsphere-icon-cluster-24x",tooltipText:this._i18nService.getString("VAppUi","actionMoveHostInventoryFolder"),contentUrl:"vapp_host_and_cluster_tree.html"},t={iconClass:"vsphere-icon-vm-templates-24x",tooltipText:this._i18nService.getString("VAppUi","actionMoveVmInventoryFolder"),contentUrl:"vapp_folders_in_datacenter_tree.html"};return[e,t]},e.$inject=["$scope","moveVAppService","i18nService","vuiConstants","$element","$timeout"],e}();e.MoveVappController=i,angular.module("com.vmware.vsphere.client.vapp").component("moveVappView",new t)}(h5_vapp||(h5_vapp={}));var h5_vapp;!function(e){var t=function(){function e(e){this.vcH5ConstantsService=e,this.version=-1,this.watchObjects=[],this.liveProperties=["config.vAppConfig.property"],this.refreshEventTypes=[],this.refreshEventTypes.push(e.DATA_REFRESH_INVOCATION_EVENT),this.refreshEventTypes.push(e.OBJECT_DETAILS_CHANGED_EVENT)}return e.prototype.$onInit=function(){this.watchObjects=[this.vappId]},e.prototype.onRefresh=function(){this.version++},e.$inject=["vcH5ConstantsService"],e}();angular.module("com.vmware.vsphere.client.vapp").component("legacyVappPropertiesView",{bindings:{vappId:"<"},controller:t,template:'\n         <div vx-refreshable\n            watch-objects="{{$ctrl.watchObjects}}"\n            refresh="$ctrl.onRefresh()"\n            live-refresh-properties="$ctrl.liveProperties"\n            refresh-event-types="{{$ctrl.refreshEventTypes}}"\n            class="vapp-properties-view-legacy-page-component"\n         >\n            <vapp-properties-view-component\n               [vapp-id]="$ctrl.vappId"\n               [version]="$ctrl.version"\n            >\n            </vapp-properties-view-component>\n         </div>'})}(h5_vapp||(h5_vapp={})),angular.module("com.vmware.vsphere.client.vapp").controller("VAppStatusController",["$scope","$controller","i18nService","entityStatusService",function(e,t,i,r){function n(t){var r,n,o=t.data.powerState,a=e.data.isSuspended,s=e.data.products;if("started"===o)r=_.isEmpty(s)?null:s[0].appUrl,n=r?"VAppStatusView.available":"VAppStatusView.running";else if("stopped"===o)n=a?"VAppStatusView.suspended":"VAppStatusView.stopped";else if("stopping"===o)n=a?"VAppStatusView.suspending":"VAppStatusView.stopping";else{if("starting"!==o)return void(e.data.state=null);n=a?"VAppStatusView.resuming":"VAppStatusView.starting"}e.data.state=i.getString("VAppUi",n),e.data.appUrl=r}angular.extend(this,t("GenericPortletController",{$scope:e})),e.$watch("data",function(t){if(!_.isEmpty(t)){var i=r.statusProperties(t.overallStatus);e.data.statusLabel=i.label,e.data.statusClass=i.iconClass,n(e)}})}]),h5=h5||{},h5.dvs={angularModule:angular.module("com.vmware.vsphere.client.dvs",[])},angular.module("com.vmware.vsphere.client.dvs").run(["dvsAddHostWizardService","exportDvsDialogService","dvsImportWizardService","dvsEditSettingsDialogService","dvsCreateWizardService","dvpgCreateWizardService","dvpgCreateWizardConstants","mutationService","dataService","clarityModalService","dvsEditPvlanDialogService","dvsEditNetFlowDialogService","dvpgManageWizardService","dvsAddSpanSessionWizardService","dvsPortMirroringRemoveSessionService","networkUiConstants","editDvPortgroupDialogService","dvsEditSpanSessionDialogService","dvsUpgradeWizardService","dvsUpgradeNiocWizardService","dvsUpgradeLacpWizardService","defaultUriSchemeUtil","dvsOutOfSyncHostService","removeDvsDialogService","dvsRectifyHostsOutOfSyncService","dvpgTrafficFilterService","dvsPortTrafficFilterService","dvsPortEditDialogService","dvsHealthCheckManageDialogService","moveDvsToService",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D,w,b,I,_,T,E,V){function M(t,i,r){if(r&&r.selectedSwitch&&r.selectedSwitch.dvsRef){var n=C.getVsphereObjectId(r.selectedSwitch.dvsRef);e.show(n,i[0])}else e.show(i[0])}function O(e,i){t.show(i[0])}function A(e,t){i.show(t[0],!1,!1)}function k(e,t){i.show(t[0],!1,!0)}function R(e,t){r.show(t[0])}function N(e,t){o.show(t[0])}function U(e,t){n.show(t[0])}function L(e,t){1===t.length&&s.remove(t[0])}function F(e,t){v.show(t[0])}function x(e,t,i){var r=null;i.selectedSession.isDvPortMirrorSession?r="dvPortMirror":i.selectedSession.isRemoteDestinationSession?r="remoteMirrorDest":i.selectedSession.isRemoteSourceSession?r="remoteMirrorSource":i.selectedSession.isEncapsulatedSession&&(r="encapsulatedRemoteMirrorSource"),r&&f.show(t[0],i.selectedSession.key,r)}function $(e,t,i){m.removeSpanSession(t,i)}function z(e,t){p.show(t[0])}function H(e,t){1===t.length?s.remove(t[0]):t.length>1&&s.removeOnMultiEntity(t)}function B(e,t){var i=t[0];c.getProperties(i,["config.name"]).then(function(r){var n=r["config.name"].replace(/%25/g,"%").replace(/%2f/g,"/").replace(/%5c/g,"\\");l.openModal(e,t,{objectId:i,existingObjectName:n},"common-module-ui/resources/common-module/views/rename/renameObject.html")})}function G(e,t){u.show(t[0])}function j(e,t){d.show(t[0])}function W(e,t){E.show(t[0])}function Y(e,t){S.show(t[0])}function q(e,t){y.show(t[0])}function K(e,t){P.show(t[0])}function X(e,t){h.show(t[0],e)}function Q(e,i){t.show(i[0])}function Z(e,t){i.show(t[0],!0,!1)}function J(e,t){i.show(t[0],!0,!0)}function ee(e,t){var i=t[0];c.getProperties(i,["config.name"]).then(function(r){var n=r["config.name"],o=n.replace(/%25/g,"%").replace(/%2f/g,"/").replace(/%5c/g,"\\");l.openModal(e,t,{objectId:i,existingObjectName:o},"common-module-ui/resources/common-module/views/rename/renameObject.html")})}function te(e,t,i){I.showEditTrafficFilterDialog(t[0])}function ie(e,t,i){I.showCloneTrafficFilterDialog(t[0])}function re(e,t,i){_.showPortEditTrafficFilterDialog(t[0],i.isPortGroupContext,i.selectedPort)}function ne(e,t,i){D.showDetails(i.details.hostOutOfSync,i.description,i.entityId)}function oe(e,t,i){i.selectedSwitch.isGhost||i.selectedSwitch.isDvsDetached?w.removeGhostDvs(t[0],i.selectedSwitch.name,i.selectedSwitch.dvsUuid):w.removeDvs(t[0],i.selectedSwitch.name,C.getVsphereObjectId(i.selectedSwitch.dvsRef))}function ae(e,t,i){b.show(i.entityId)}function se(e,t,i){T.show(t[0],i.selectedPort,i.isPortGroupContext,i.dSwitchUri)}function ce(e,t,i){V.openMoveToDialog(t)}function le(e,t,i){t&&t.length&&i&&V.moveDvsTo(t,i.dropTarget)}h5.actions["vsphere.core.dvs.manageHostOnDvsAction"]=M,h5.actions["vsphere.core.dvs.migrateHostNetworkingAction"]=M,h5.actions["vsphere.core.dvs.exportConfigAction"]=O,h5.actions["vsphere.core.dvs.importDvsAction"]=A,h5.actions["vsphere.core.dvs.restoreConfigAction"]=k,h5.actions["vsphere.core.dvs.editSettings"]=R,h5.actions["vsphere.core.dvs.createDvs"]=U,h5.actions["vsphere.core.dvs.deleteDvs"]=L,h5.actions["vsphere.core.dvs.spanSession.addAction"]=F,h5.actions["vsphere.core.dvs.spanSession.editAction"]=x,h5.actions["vsphere.core.dvs.spanSession.removeAction"]=$,h5.actions["vsphere.core.dvs.createPortgroup"]=N,h5.actions["vsphere.core.dvs.managePortgroups"]=z,h5.actions["vsphere.core.dvPortgroup.deletePortgroupAction"]=H,h5.actions["vsphere.core.dvs.actions.renameAction"]=B,h5.actions["vsphere.core.dvs.editNetFlow"]=G,h5.actions["vsphere.core.dvs.editHealthCheckSettings"]=W,h5.actions["vsphere.core.dvs.editPvlan"]=j,h5.actions["vsphere.core.dvs.upgradeNioc"]=q,h5.actions["vsphere.core.dvs.upgradeLacp"]=K,h5.actions["vsphere.core.dvs.upgradeDvs"]=Y,h5.actions[g.actions.EDIT_DVPG]=X,h5.actions[g.actions.EXPORT_DVPG]=Q,h5.actions[g.actions.IMPORT_DVPG]=Z,h5.actions[g.actions.RESTORE_DVPG]=J,h5.actions[g.actions.RENAME_DV_PORTGROUP]=ee,h5.actions["vsphere.core.dvs.trafficFilters.editRulesAction"]=te,h5.actions["vsphere.core.dvs.trafficFilters.cloneRulesAction"]=ie,h5.actions["vsphere.core.dvs.trafficFilters.editPortRulesAction"]=re,h5.actions[g.actions.HOST_OF_SYNC_DVS_HOST]=ne,h5.actions[g.actions.REMOVE_DVS]=oe,h5.actions[g.actions.RECTIFY_HOSTS_OUT_OF_SYNC_DVS]=ae,h5.actions[g.actions.EDIT_DVPORT]=se,h5.actions[g.actions.DVS_MOVE_TO_ACTION]=ce,h5.actions[g.actions.DVS_MOVE_TO_DRAG_AND_DROP_ACTION]=le}]);var dvs_ui;!function(e){var t=function(){function e(){this.bindings={config:"<"},this.controller=n,this.templateUrl="dvs-ui/resources/dvs/addhost/components/assignUplink/assignUplinkTemplate.html"}return e}();e.AssignUplinkComponent=t;var i=function(){function e(){}return e}();e.AssignUplinkComponentConfig=i;var r=function(){function e(){}return e}();e.ApplyToAllSignPostConfig=r;var n=function(){function t(e,t,i){var r=this;this.vuiConstants=e,this.i18nService=t,this.columnRenderersRegistry=i,this.preselectComparator=function(e){return r.uplinkSelectedByDefault===e}}return t.prototype.$onInit=function(){var e=this,t=[];this.datagridOptions={height:"100%",pageConfig:{hidePager:!1},columnDefs:this.buildColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:this.getData(),get selectedItems(){return t},set selectedItems(i){t=i,t&&1===t.length?e.config.selectedUplink=t[0][0]:e.config.selectedUplink=void 0},resizable:!0},this.assignDefaults()},t.prototype.getData=function(){var t=[];return t.push.apply(t,this.config.uplinkMappings),t.push([e.DvsAddHostWizardConstants.AUTO_ASSIGN,void 0]),t},t.prototype.assignDefaults=function(){var e=this;void 0===this.config.selectedUplinkPortgroup&&(this.config.selectedUplinkPortgroup=this.config.uplinkPortgroups[0]),void 0!==this.config.selectedUplink?this.uplinkSelectedByDefault=_.find(this.datagridOptions.data,function(t){return t[0]===e.config.selectedUplink}):this.uplinkSelectedByDefault=_.find(this.datagridOptions.data,function(e){return void 0===e[1]})},t.prototype.buildColumnDefinitions=function(){var t=this,i=this.columnRenderersRegistry.getColumnRenderer("text"),r=this.columnRenderersRegistry.getColumnRenderer("icon-text"),n=function(i){var r=i[0],n=i[1];r===e.DvsAddHostWizardConstants.AUTO_ASSIGN?(r=t.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.autoAssign"),n=""):void 0===n&&(n=t.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.noUplink"));var o={uplink:i[0],uplinkDisplayValue:r,pnicDisplayValue:n,icon:"vui-icon"};return o};return[{displayName:this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.uplinkNameHeader"),width:"150px",template:function(e){var t=e[2];if(t)return r(["icon","uplinkDisplayValue"],n(e));if(""===e[1]){var o=n(e);return"<span class='dvs-assign-uplink-dialog-lag-group'>"+o.uplinkDisplayValue+"</span>"}return i(["uplinkDisplayValue"],n(e))}},{displayName:this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.assignedAdapterHeader"),width:"150px",template:function(e){return i(["pnicDisplayValue"],n(e))}}]},t.$inject=["vuiConstants","i18nService","columnRenderersRegistry"],t}();angular.module("com.vmware.vsphere.client.dvs").component("assignUplink",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={onHostsChange:"&",hostsRetriever:"&",showVdsStateColumn:"<",allowAnySelection:"<",addedHosts:"<",showIncompatibleHostsButton:"<",dvsId:"<",addActionLabel:"@",addDialogTitle:"@",hostColumnFormat:"@"},this.controller=i,this.template='<div class="fill-parent flexbox flex-grow-auto">\n                  <div ng-if="$ctrl.datagridOptions"\n                       vui-datagrid="$ctrl.datagridOptions"\n                       vx-stretch-grid\n                       autofocus tabindex="-1"\n                       aria-label="{{$ctrl.gridDescription}}"\n                       class="flex-grid"\n                       id="selectedHostsGrid"/>\n               </div>'}return e}();e.DvsHostListComponent=t;var i=function(){function e(e,t,i,r){this.vuiConstants=e,this.i18nService=t,this.selectHostsDialogService=i,this.defaultUriSchemeUtil=r}return e.prototype.$onInit=function(){this.hostColumnFormat=this.hostColumnFormat||"{0}";var e=[],t=this;this.gridDescription=this.i18nService.getString("DvsUi","DvsHostSelector.selectedHostsList.description"),this.datagridOptions={height:"100%",pageConfig:{hidePager:!1},columnDefs:this.buildColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,data:this.addedHosts,get selectedItems(){return e},set selectedItems(e){t.selectedHostItems=t.mapGridItemsToHostListItems(e),t.updateRemoveActionEnabledState()},resizable:!0,actionBarOptions:this.createActionBarOptions()},this.updateRemoveActionEnabledState()},e.prototype.createActionBarOptions=function(){return{actions:[{id:"add-action",label:this.addActionLabel,enabled:!0,iconClass:"network-lib-ui-icon-add",onClick:this.onAddClicked.bind(this)},{id:"remove-action",label:this.i18nService.getString("DvsUi","DvsHostSelector.removeHostsButton.title"),iconClass:"network-lib-ui-icon-deleteIcon",onClick:this.onRemoveClicked.bind(this)}]}},e.prototype.updateRemoveActionEnabledState=function(){this.datagridOptions.actionBarOptions.actions[1].enabled=this.selectedHostItems&&0!==this.selectedHostItems.length},e.prototype.mapGridItemsToHostListItems=function(e){return _.filter(this.addedHosts,function(t){return _.findWhere(e,{hostName:t.hostName})})},e.prototype.onAddClicked=function(){var e=this,t=this.hostsRetriever().then(function(t){return e.hostItemsDifference(t,e.addedHosts);
});this.showDialog(t)},e.prototype.onRemoveClicked=function(){this.selectedHostItems.length>0&&this.updateData(this.hostItemsDifference(this.addedHosts,this.selectedHostItems))},e.prototype.buildColumnDefinitions=function(){var e=this;return[{displayName:this.i18nService.getString("DvsUi","DvsHostSelector.selectedHostsList.hostNameColumn.title"),field:"hostName",width:"180px",template:function(t){return e.buildCellHtml(e.i18nService.interpolate(e.hostColumnFormat,[t.hostName]),t.hostIconId)}},{displayName:this.i18nService.getString("DvsUi","DvsHostSelector.selectedHostsList.hostStatusColumn.title"),field:"connectionState",width:"150px",template:function(t){return e.buildCellHtml(t.connectionStateLabel)}}]},e.prototype.buildCellHtml=function(e,t){void 0===t&&(t="");var i="<div>%icon%text</div>";return i.replace("%icon","<span class='"+t+"'></span>").replace("%text","<span class='vertical-align-cell'>"+e+"</span>")},e.prototype.updateData=function(e){this.addedHosts=e,this.datagridOptions.data=e,this.onHostsChange({hosts:e})},e.prototype.showDialog=function(e){var t=this;this.selectHostsDialogService.show(e,function(e){t.updateData(t.addedHosts.concat(e))},this.addDialogTitle,this.showVdsStateColumn,this.showIncompatibleHostsButton,this.allowAnySelection,this.dvsId)},e.prototype.hostItemsDifference=function(e,t){var i=this;return _.filter(e,function(e){return!_.some(t,function(t){return i.defaultUriSchemeUtil.getVsphereObjectId(t.hostRef)===i.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef)})})},e.$inject=["vuiConstants","i18nService","selectHostsDialogService","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHostList",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={hosts:"<",allowAnySelection:"<",showVdsStateColumn:"<",showIncompatibleHostsButton:"<",onSelectedHostsChange:"&",selectAllConnectedHosts:"<?"},this.controller=i,this.template='<div class="fill-parent dvs-select-hosts">\n                  <button ng-if="$ctrl.showIncompatibleHostsButton"\n                          type="submit"\n                          class="btn btn-sm btn-link"\n                          ng-click="$ctrl.onShowIncompatibleHostsButtonClicked()"\n                  >{{$ctrl.showIncompatibleHostsButtonLabel}}</button>\n                  <div class="filter-input pull-right">\n                     <span class="nav-icon fa fa-filter"/>\n                     <input type="text"\n                            ng-model="$ctrl.searchTerm"\n                            ng-model-options="{ getterSetter: true }"\n                            ng-trim="true"\n                            aria-label="{{$ctrl.i18nService.getString(\'Common\', \'filter.label\')}}"\n                            placeholder="{{$ctrl.i18nService.getString(\'Common\', \'filter.label\')}}"/>\n                  </div>\n                  <div class="flex-grid"\n                       ng-if="$ctrl.datagridOptions"\n                       vx-stretch-grid\n                       autofocus tabindex="-1"\n                       aria-label="{{$ctrl.gridDescription}}"\n                       vui-datagrid="$ctrl.datagridOptions"></div>\n               </div>'}return e}();e.SelectHostsComponent=t;var i=function(){function t(e,t,i,r){this.vuiConstants=e,this.i18nService=t,this.columnRenderersRegistry=i,this.defaultUriSchemeUtil=r,this.selectMasterCheckbox=!1,this.areIncompatibleHostsShown=!1}return Object.defineProperty(t.prototype,"searchTerm",{get:function(){return this._searchTerm},set:function(e){this._searchTerm=e,this.datagridOptions.data=this.getDatagridData()},enumerable:!0,configurable:!0}),t.prototype.$onInit=function(){this.gridDescription=this.i18nService.getString("DvsUi","DvsHostSelector.selectedHostsList.description"),void 0===this.allowAnySelection&&(this.allowAnySelection=!1),void 0===this.showIncompatibleHostsButton&&(this.showIncompatibleHostsButton=!1),void 0===this.showVdsStateColumn&&(this.showVdsStateColumn=!1),this.showIncompatibleHostsButtonLabel=this.getShowIncompatibleHostsButtonLabel(),this.datagridOptions=this.createDatagridOptions(),this.selectAllConnectedHosts&&this.notifySelectionChange()},t.prototype.onShowIncompatibleHostsButtonClicked=function(){this.areIncompatibleHostsShown=!this.areIncompatibleHostsShown,this.showIncompatibleHostsButtonLabel=this.getShowIncompatibleHostsButtonLabel(),this.datagridOptions.data=this.getDatagridData()},t.prototype.getShowIncompatibleHostsButtonLabel=function(){var e;return e=this.areIncompatibleHostsShown?this.i18nService.getString("DvsUi","SelectHostsComponent.showIncompatibleHostsButtonLabel.hide"):this.i18nService.getString("DvsUi","SelectHostsComponent.showIncompatibleHostsButtonLabel.show")},t.prototype.buildResult=function(){var e=this,t=_.filter(this.datagridOptions.data,function(t){return e.datagridOptions.selectedHosts[t.hostName]&&!e.isHostItemSelectionDisabled(t)});return _.filter(this.hosts,function(e){return _.some(t,function(t){return t.hostName===e.hostName})})},t.prototype.createDatagridOptions=function(){var e=this,t=this;return{height:"300",pageConfig:{hidePager:!1},columnDefs:this.buildColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.NONE,data:this.getDatagridData(),resizable:!0,actionBarOptions:{actions:[]},isItemDisabledCallback:function(e){return t.isHostItemSelectionDisabled(e)},onMasterCheckboxClick:function(e){var i=e.currentTarget.checked;for(var r in t.datagridOptions.selectedHosts)t.isHostVisible(r)&&(t.datagridOptions.selectedHosts[r]=i);t.notifySelectionChange()},onItemCheckboxClick:function(){t.notifySelectionChange()},selectedHosts:function(){var i={};return _.forEach(t.hosts,function(t){i[t.hostName]=!!e.selectAllConnectedHosts}),i}()}},t.prototype.notifySelectionChange=function(){this.onSelectedHostsChange({selectedHostItems:this.buildResult()})},t.prototype.getDatagridData=function(){var e=this,t=this.hosts;return this.areIncompatibleHostsShown||(t=_.filter(t,function(t){return e.isHostCompatible(t)})),this._searchTerm&&(t=_.filter(t,function(t){return e.isItemMatchingSearchTerm(t)})),t},t.prototype.isHostCompatible=function(e){return 0===e.compatibilityErrors.length},t.prototype.isItemMatchingSearchTerm=function(e){var t=this,i=_.pluck(this.datagridOptions.columnDefs,"field");return _.some(i,function(i){return t.isSubstringIgnoreCase(e[i],t._searchTerm)})},t.prototype.isHostVisible=function(e){return this.datagridOptions.data.some(function(t){return t.hostName===e})},t.prototype.isSubstringIgnoreCase=function(e,t){return!!e&&(!t||e.toLowerCase().indexOf(t.toLowerCase())!==-1)},t.prototype.isHostItemSelectionDisabled=function(t){return!this.allowAnySelection&&(t.connectionState===e.DvsAddHostWizardConstants.hostConnectionState.DISCONNECTED||t.connectionState===e.DvsAddHostWizardConstants.hostConnectionState.NOT_RESPONDING)||!this.isHostCompatible(t)},t.prototype.buildColumnDefinitions=function(){var e=this,t=this,i=[];this.selectMasterCheckbox=!!this.selectAllConnectedHosts&&!_.every(this.hosts,function(t){return e.isHostItemSelectionDisabled(t)});var r='<input data-test-id="selectHostsMasterCheckBox" type="checkbox" class="select-hosts-master-checkbox" \n                       ng-checked='+this.selectMasterCheckbox+'\n                       ng-click="datagridOptions.onMasterCheckboxClick($event)"/>';return i.push({filterable:!1,sortable:!1,groupable:!1,searchable:!1,width:"25px",headerTemplate:r,field:"selected",template:function(e){var i='datagridOptions.selectedHosts["'+e.hostName+'"]';return t.isHostItemSelectionDisabled(e)?'<input type="checkbox" disabled/>':'<input type="checkbox" %checked %model\n                                     ng-change="datagridOptions.onItemCheckboxClick($event)"/>'.replace("%checked","ng-checked="+i).replace("%model","ng-model="+i)}}),i.push({searchable:!1,displayName:t.i18nService.getString("DvsUi","DvsSelectHostsDialog.columnHostName.title"),field:"hostName",width:"150px",template:function(e){return t.buildCellHtml(e.hostName,e.hostIconId,t.isHostItemSelectionDisabled(e))}}),i.push({searchable:!1,displayName:t.i18nService.getString("DvsUi","DvsSelectHostsDialog.columnHostState.title"),field:"connectionStateLabel",width:"150px",template:t.getHostConnectionStateColumnRenderer()}),this.showVdsStateColumn&&i.push({searchable:!1,displayName:t.i18nService.getString("DvsUi","DvsSelectHostsDialog.columnDvsState.title"),field:"vdsState",width:"150px",template:t.getVdsStateColumnRenderer()}),i.push({searchable:!1,displayName:t.i18nService.getString("DvsUi","DvsSelectHostsDialog.columnClusters.title"),field:"clusterName",width:"150px",template:t.getClusterColumnRenderer()}),this.showIncompatibleHostsButton&&i.push({searchable:!1,displayName:t.i18nService.getString("DvsUi","SelectHostsComponent.compatibilityColumnHeader"),width:"150px",template:t.getCompatibilityColumnRenderer()}),i},t.prototype.getIncompatibleHostTooltip=function(e){var t="";return e.compatibilityErrors&&e.compatibilityErrors.length>0&&_.forEach(e.compatibilityErrors,function(e){t+="<span>"+e+"</span>"}),t},t.prototype.getCompatibilityColumnRenderer=function(){var e=this;return function(t){return e.isHostCompatible(t)?e.buildCellHtml(e.i18nService.getString("DvsUi","HostsCompatibilityList.compatibleText"),"vsphere-icon-status-ok",e.isHostItemSelectionDisabled(t)):e.buildIncompatibleHostCell(t)}},t.prototype.getClusterColumnRenderer=function(){var e=this;return function(t){return t.clusterName?e.buildCellHtml(t.clusterName,"vsphere-icon-cluster",e.isHostItemSelectionDisabled(t)):e.buildCellHtml(e.i18nService.getString("DvsUi","DvsSelectHostsDialog.na"),"",e.isHostItemSelectionDisabled(t))}},t.prototype.getHostConnectionStateColumnRenderer=function(){var e=this;return function(t){return e.buildCellHtml(t.connectionStateLabel,"",e.isHostItemSelectionDisabled(t))}},t.prototype.getVdsStateColumnRenderer=function(){var e=this,i=this;return function(r){return i.buildCellHtml(r.vdsState,t.ICON_PREFIX+r.vdsStateIcon,e.isHostItemSelectionDisabled(r))}},t.prototype.buildCellHtml=function(e,t,i){var r='<div class="no-tooltip-cell %disabled">%icon%text</div>';return r.replace("%icon","<span class='"+t+"'></span>").replace("%text","<span ng-non-bindable class='vertical-align-cell'>"+e+"</span>").replace("%disabled",i?"disabled-cell":"")},t.prototype.buildIncompatibleHostCell=function(e){var t=this.getIncompatibleHostTooltip(e),i=this.i18nService.getString("DvsUi","HostsCompatibilityList.incompatibleText"),r=this.isHostItemSelectionDisabled(e)?"class='element-disabled'":"",n='\n            <span class="vertical-align-cell">\n               <a role="tooltip" aria-haspopup="true" class="tooltip tooltip-md tooltip-top-left">\n                  <clr-icon shape="error" size="24" class="is-error"></clr-icon>\n                  <span class="tooltip-content">'+t+"</span>\n               </a>\n               <span "+r+"><span class='vertical-align-cell'>"+i+"</span></span>\n            </span>\n         ";return n},t.$inject=["vuiConstants","i18nService","columnRenderersRegistry","defaultUriSchemeUtil"],t.ICON_PREFIX="network-lib-ui-icon-",t}();angular.module("com.vmware.vsphere.client.dvs").component("selectHosts",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={dialogData:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/addhost/components/unassignUplink/unassignUplinkDialogTemplate.html"}return e}();e.UnassignUplinkDialogComponent=t;var i=function(){function e(e){this.i18nService=e}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("unassignUplink",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={vmRef:"<",nicKey:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/addhost/components/vmVnicSettings/vmVnicSettingsTemplate.html"}return e}();e.VmVnicSettingsComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.dataService=t,this.defaultUriSchemeUtil=i,this.vxPropertyViewService=r,this.loadingData=!1}return e.prototype.$onInit=function(){this.requestData()},e.prototype.requestData=function(){var t=this;this.loadingData=!0;var i={};void 0!==this.nicKey&&(i.propertyParams=[{propertyName:e.VM_VNIC_SETTINGS_PROPERTY,parameterType:"java.lang.Integer",parameter:this.nicKey}]),this.dataService.getProperties(this.defaultUriSchemeUtil.getVsphereObjectId(this.vmRef),[e.VM_VNIC_SETTINGS_PROPERTY],i).then(function(i){i&&t.buildPropertyViewData(i[e.VM_VNIC_SETTINGS_PROPERTY])})["finally"](function(){t.loadingData=!1})},e.prototype.buildPropertyViewData=function(e){var t=this,i=this.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("default");_.each(e,function(e){var i=r.section(e.key.toString()).title(e.adapterName);i.property(t.i18nService.getString("DvsUi","VmVnicPropertiesView.macAddress"),e.macAddress),e.adapterType&&i.property(t.i18nService.getString("DvsUi","VmVnicPropertiesView.adapterType"),e.adapterType),e.portgroupName&&i.property(t.i18nService.getString("DvsUi","VmVnicPropertiesView.portGroup"),e.portgroupName),e.sriovInfo&&(i.property(t.i18nService.getString("DvsUi","VmVnicPropertiesView.virtualFunctionId"),e.sriovInfo.virtualFunctionId?e.sriovInfo.virtualFunctionId:t.i18nService.getString("DvsUi","VmVnicPropertiesView.noData")),i.property(t.i18nService.getString("DvsUi","VmVnicPropertiesView.physicalFunctionId"),t.i18nService.getString("DvsUi","VmVnicPropertiesView.physicalFunctionFormat",e.sriovInfo.physicalFunctionId,e.sriovInfo.physicalFunctionDeviceId)),i.property(t.i18nService.getString("DvsUi","VmVnicPropertiesView.gosMtu"),e.sriovInfo.allowGuestOsMtuChange?t.i18nService.getString("DvsUi","VmVnicPropertiesView.gosMtu.allowed"):t.i18nService.getString("DvsUi","VmVnicPropertiesView.gosMtu.disallowed")))}),this.propertyViewData=i.build()},e.$inject=["i18nService","dataService","defaultUriSchemeUtil","vxPropertyViewService"],e.VM_VNIC_SETTINGS_PROPERTY="dvsAddHost:vmVnicSettingsData",e}();angular.module("com.vmware.vsphere.client.dvs").component("vmVnicSettings",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.targetType={DVS_RECONFIGURE_COMMAND_SPEC_TYPE:"com.vmware.vsphere.client.dvs.specs.DvsReconfigureCommandSpec",DVS_HOST_MEMBER_CONFIG_SPEC_TYPE:"com.vmware.vim.binding.vim.dvs.HostMember$ConfigSpec"},e.page={DVS_SELECT_WORKFLOW_PAGE:"selectWorkflowPage",DVS_SELECT_HOSTS_PAGE:"selectHostsPage",DVS_SELECT_HOSTS_TO_REMOVE_PAGE:"selectHostsToRemovePage",DVS_SELECT_HOSTS_TO_MANAGE_PAGE:"selectHostsToManagePage",DVS_SELECT_PHYSICAL_ADAPTERS_PAGE:"selectPhysicalAdaptersPage",DVS_SELECT_VIRTUAL_ADAPTERS_PAGE:"selectVirtualAdaptersPage",DVS_SELECT_VIRTUAL_MACHINES_PAGE:"selectVirtualMachinesPage",DVS_READY_TO_COMPLETE_PAGE:"dvsAddHostReadyToCompletePage"},e.nicListItemType={PNIC_TYPE:"DvsAddHostHierarchicalListPnicItem",GROUPING_TYPE:"DvsAddHostHierarchicalListGroupingItem",HOST_TYPE:"DvsAddHostHierarchicalListHostItem",VNIC_TYPE:"DvsAddHostHierarchicalListVnicItem",VM_TYPE:"DvsAddHostHierarchicalListVmItem",VM_VNIC_TYPE:"DvsAddHostHierarchicalListVmVnicItem"},e.operationType={ADD_HOST:"addHostOperation",REMOVE_HOST:"removeHostOperation",MANAGE_HOST:"manageHostOperation",MIGRATE_NETWORKING:"migrateNetworkingOperation"},e.AUTO_ASSIGN="",e.hostConnectionState={CONNECTED:"connected",DISCONNECTED:"disconnected",NOT_RESPONDING:"notResponding"},e}();e.DvsAddHostWizardConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.pageStateManagementService=e,this.vuiConstants=t}return t.prototype.init=function(e){var t=this;this.pages=e.wizardConfig.pages,this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e),e.$watchGroup(["model.selectOperationPageModel.selectedOperationType"],function(e){t.updatePagesVisibility.apply(t,e)})},t.prototype.updatePagesVisibility=function(t){var i=t===e.DvsAddHostWizardConstants.operationType.ADD_HOST,r=t===e.DvsAddHostWizardConstants.operationType.REMOVE_HOST,n=t===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST,o=t===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING;this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_WORKFLOW_PAGE,i||r||n),this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_HOSTS_PAGE,i),this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_PHYSICAL_ADAPTERS_PAGE,i||n||o),this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_VIRTUAL_ADAPTERS_PAGE,i||n||o),this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_VIRTUAL_MACHINES_PAGE,i||n||o),this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_HOSTS_TO_MANAGE_PAGE,n),this.togglePageVisibility(e.DvsAddHostWizardConstants.page.DVS_SELECT_HOSTS_TO_REMOVE_PAGE,r)},t.prototype.togglePageVisibility=function(e,t){var i=_.findWhere(this.pages,{id:e});t?i.state===this.vuiConstants.wizard.pageState.SKIPPED&&(i.state=this.vuiConstants.wizard.pageState.DISABLED):i&&(i.state=this.vuiConstants.wizard.pageState.SKIPPED)},t.$inject=["pageStateManagementService","vuiConstants"],t}();e.DvsAddHostWizardFlowManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddHostWizardFlowManager",t)}(dvs_ui||(dvs_ui={}));var DvsAddHostWizardPages=dvs_ui.DvsAddHostWizardPages,dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o){this.i18nService=e,this.dvsSelectHostsPageValidator=t,this.dvsSelectPhysicalAdaptersPageValidator=i,this.dvsSelectVirtualAdaptersPageValidator=r,this.dvsSelectVirtualMachinesPageValidator=n,this.vuiConstants=o}return t.prototype.createPages=function(t){var i=this,r={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_WORKFLOW_PAGE,title:this.i18nService.getString("DvsUi","SelectOperationPage.title"),description:this.i18nService.getString("DvsUi","SelectOperationPage.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/selectOperationPage.html",validationFunction:function(){return[]}},n={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_HOSTS_PAGE,title:this.i18nService.getString("DvsUi","SelectHostsPage.title"),description:this.i18nService.getString("DvsUi","SelectHostsPage.addhosts.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsSelectHostsPage.html",validationFunction:function(){return i.dvsSelectHostsPageValidator.getValidationError(t.model.selectHostsPageModel.hosts)},validationParams:["model.selectHostsPageModel.hosts"]},o={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_HOSTS_TO_REMOVE_PAGE,title:this.i18nService.getString("DvsUi","SelectHostsPage.title"),description:this.i18nService.getString("DvsUi","SelectHostsPage.removeHosts.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsSelectHostsToRemovePage.html",validationFunction:function(){return i.dvsSelectHostsPageValidator.getValidationError(t.model.selectHostsToRemovePageModel.hosts)},validationParams:["model.selectHostsToRemovePageModel.hosts"]},a={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_HOSTS_TO_MANAGE_PAGE,title:this.i18nService.getString("DvsUi","SelectHostsPage.title"),description:this.i18nService.getString("DvsUi","SelectHostsPage.managehosts.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsSelectHostsToManagePage.html",validationFunction:function(){return i.dvsSelectHostsPageValidator.getValidationError(t.model.selectHostsToManagePageModel.hosts)},validationParams:["model.selectHostsToManagePageModel.hosts"]},s={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_PHYSICAL_ADAPTERS_PAGE,title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.title.default"),description:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsSelectPhysicalAdaptersPage.html",validationParams:["model.selectPhysicalAdaptersPageModel.generationNumber"],onCommit:function(){return i.dvsSelectPhysicalAdaptersPageValidator.validate(t.model.selectPhysicalAdaptersPageModel).then(function(e){return t.wizardConfig.currentPage.state=e?i.vuiConstants.wizard.pageState.COMPLETED:i.vuiConstants.wizard.pageState.INCOMPLETE,e})}},c={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_VIRTUAL_ADAPTERS_PAGE,title:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.title.default"),description:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsSelectVirtualAdaptersPage.html",validationFunction:function(){return i.dvsSelectVirtualAdaptersPageValidator.getValidationError(t.model.selectVirtualAdaptersPageModel.hosts,t.model.selectPhysicalAdaptersPageModel.hosts,t.model.selectVirtualAdaptersPageModel.hosts)}},l={id:e.DvsAddHostWizardConstants.page.DVS_SELECT_VIRTUAL_MACHINES_PAGE,title:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.title"),description:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsSelectVirtualMachinesPage.html",validationFunction:function(){return i.dvsSelectVirtualMachinesPageValidator.getValidationError(t.model.selectVirtualMachinesPageModel)}},d={id:e.DvsAddHostWizardConstants.page.DVS_READY_TO_COMPLETE_PAGE,title:this.i18nService.getString("DvsUi","AddHostWizard.readyToCompletePage.title"),description:this.i18nService.getString("DvsUi","AddHostWizard.readyToCompletePage.description"),contentUrl:"dvs-ui/resources/dvs/addhost/views/dvsAddHostReadyToCompletePage.html",onCommit:function(){return!0}},u=[r,n,o,a,s,c,l,d];return t.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING&&u.splice(0,4),u},t.$inject=["i18nService","dvsSelectHostsPageValidator","dvsSelectPhysicalAdaptersPageValidator","dvsSelectVirtualAdaptersPageValidator","dvsSelectVirtualMachinesPageValidator","vuiConstants"],t}();e.DvsAddHostWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddHostWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l,d,u){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.dvsAddHostWizardSpecFactory=r,this.mutationService=n,this.dvsAddHostWizardFlowManager=o,this.dvsAddHostWizardPages=a,this.dataService=s,this.wizardValidationService=c,this.defaultUriSchemeUtil=l,this.$q=d,this.vimEntityEscapingService=u}return t.prototype.show=function(t,i){var r=this,n=this.$rootScope.$new();n.model=new e.DvsAddHostWizardModel,n.model.dvsId=t;var o=void 0!==i;if(o){n.model.selectOperationPageModel.selectedOperationType=e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING;var a=new HostListItemData;a.hostRef=this.defaultUriSchemeUtil.getManagedObjectReference(i),n.model.selectHostsToManagePageModel.hosts=[a]}var s=new e.WizardConfig;s.title=o?this.i18nService.getString("DvsUi","actionMigrateHostNetworkingOnDvsTitle"):this.i18nService.getString("DvsUi","actionManageHostOnDvsTitle"),s.loadingMessage=this.i18nService.getString("CommonUi","wizard.loading"),s.cssClass="dvs-add-host-wizard",s.onFinish=function(){var t=n.model.selectOperationPageModel.selectedOperationType;if(t===e.DvsAddHostWizardConstants.operationType.ADD_HOST||t===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST||t===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING){var i=r.dvsAddHostWizardSpecFactory.buildSpec(n.model);r.mutationService.apply(n.model.dvsId,i._type,i)}else if(t===e.DvsAddHostWizardConstants.operationType.REMOVE_HOST){var i=r.dvsAddHostWizardSpecFactory.buildRemoveSpec(n.model);r.mutationService.apply(n.model.dvsId,i._type,i)}return!0},s.pages=this.dvsAddHostWizardPages.createPages(n),n.wizardConfig=s,this.wizardValidationService.initWizardValidation(n),this.dvsAddHostWizardFlowManager.init(n),this.vuiWizardService({scope:n,configObjectName:"wizardConfig"}).show();var c,l,d="config.configVersion",u="config.name",p="name",v=[];c=this.dataService.getProperties(n.model.dvsId,[u,d]),v.push(c),o&&(l=this.dataService.getProperties(i,[p]),v.push(l)),this.$q.all(v).then(function(e){if(e&&e.length>0){var t=e[0],i=e[1],a=void 0,c=void 0;t&&(t[d]&&(n.model.dvsConfigVersion=t[d]),t[u]&&(a=r.vimEntityEscapingService.unescapeSpecialCharacters(t[u]))),i&&i[p]&&(c=r.vimEntityEscapingService.unescapeSpecialCharacters(i[p])),o?a&&c&&(s.title=r.i18nService.getString("DvsUi","actionMigrateHostNetworkingOnDvsTitleWithNames",c,a)):a&&(s.title=r.i18nService.getString("DvsUi","actionManageHostOnDvsTitleWithName",a))}}),n.$watchCollection(function(){return n.model.selectedHosts},function(){n.model.selectPhysicalAdaptersPageModel.isInitialized=!1,n.model.selectVirtualAdaptersPageModel.isInitialized=!1,n.model.selectVirtualMachinesPageModel.isInitialized=!1,n.model.selectVirtualMachinesPageModel.isMigrateVirtualMachineNetworkingEnabled=!1})},t.$inject=["$rootScope","i18nService","vuiWizardService","dvsAddHostWizardSpecFactory","mutationService","dvsAddHostWizardFlowManager","dvsAddHostWizardPages","dataService","wizardValidationService","defaultUriSchemeUtil","$q","vimEntityEscapingService"],t}();e.DvsAddHostWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddHostWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.addhost.model.DvsAddAndManageHostsSpec,i=com.vmware.vsphere.client.h5.network.dvs.addhost.model.PnicAssignmentSpec,r=com.vmware.vsphere.client.dvs.api.spec.DvsHostRemoveSpec,n=com.vmware.vsphere.client.h5.network.dvs.addhost.model.VnicAssignmentSpec,o=com.vmware.vsphere.client.h5.network.dvs.addhost.model.VmVnicAssignmentSpec,a=function(){function a(e,t,i,r){this.dvsSelectPhysicalAdaptersPageService=e,this.dvsSelectVirtualAdaptersPageService=t,this.dvsSelectVirtualMachinesPageService=i,this.defaultUriSchemeUtil=r}return a.prototype.buildSpec=function(r){var a=this,s=_.map(r.selectedHosts,function(e){return e.hostRef}),c=r.selectPhysicalAdaptersPageModel.hosts,l=r.selectVirtualAdaptersPageModel.hosts,d=this.getHostsToMutate(c,l),u=_.filter(c,function(t){if(t.type!==e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE)return!1;var i=t,r=a.defaultUriSchemeUtil.getVsphereObjectId(i.hostRef);return(a.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(i)||a.dvsSelectPhysicalAdaptersPageService.isPnicUnassigned(t))&&void 0!==d[r]}),p=_.map(u,function(t){var r=t,n=r,o=new i;return o.host=n.hostRef,o.pnicDevice=n.device,o.uplinkPortgroupKey=n.uplinkPortgroup.key,n.uplink!==e.DvsAddHostWizardConstants.AUTO_ASSIGN&&(o.uplink=n.uplink),o.isPnicReassigned=a.dvsSelectPhysicalAdaptersPageService.isPnicOriginallyOnThisSwitch(n)&&a.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(n),o}),v=_.filter(l,function(t){if(t.type!==e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE)return!1;var i=t,r=a.defaultUriSchemeUtil.getVsphereObjectId(i.hostRef),n=a.dvsSelectVirtualAdaptersPageService.isVnicModified(t)&&void 0!==d[r];return n}),m=_.map(v,function(e){var t=new n;return t.host=e.hostRef,t.vnicDevice=e.device,e.isStandardPortgroup&&(t.standardPortgroupName=e.sourcePortgroup),t.distributedPortgroupRef=e.portgroupRef,t}),g=[];if(r.selectVirtualMachinesPageModel.isMigrateVirtualMachineNetworkingEnabled){var h=r.selectVirtualMachinesPageModel.hosts,f=_.filter(h,function(t){return t&&t.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE&&a.dvsSelectVirtualMachinesPageService.isVnicModified(t)});g=_.map(f,function(e){var t=new o;return t.host=e.hostRef,t.vm=e.vmRef,t.key=e.key,t.distributedPortgroupRef=e.destinationPortgroupRef,t.changeVersion=e.changeVersion,t})}var S=new t;return S.dvsConfigVersion=r.dvsConfigVersion,S.hosts=s,S.hostsToMutate=_.values(d),S.pnicAssignmentSpecs=p,S.vnicAssignmentSpecs=m,S.vmVnicAssignmentSpecs=g,S.areMemberHosts=r.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST||r.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING,S},a.prototype.buildRemoveSpec=function(e){var t=new r;return t.hosts=_.map(e.selectHostsToRemovePageModel.hosts,function(e){return e.hostRef}),t},a.prototype.getHostsToMutate=function(t,i){var r=this,n={},o=_.filter(t,function(t){return t&&t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE&&r.dvsSelectPhysicalAdaptersPageService.isPnicModified(t)});_.each(o,function(e){var t=e,i=t;n[r.defaultUriSchemeUtil.getVsphereObjectId(i.hostRef)]=i.hostRef});var a=_.filter(i,function(t){return t&&t.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE&&r.dvsSelectVirtualAdaptersPageService.isVnicModified(t)});return _.each(a,function(e){var t=e,i=t;n[r.defaultUriSchemeUtil.getVsphereObjectId(i.hostRef)]=i.hostRef}),n},a.$inject=["dvsSelectPhysicalAdaptersPageService","dvsSelectVirtualAdaptersPageService","dvsSelectVirtualMachinesPageService","defaultUriSchemeUtil"],a}();e.DvsAddHostWizardSpecFactory=a,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddHostWizardSpecFactory",a)}(dvs_ui||(dvs_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListItem,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.DvsAddHostTreeListItemWrapper=i}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.operationTypes=e.DvsAddHostWizardConstants.operationType,this.selectOperationPageModel=new e.SelectOperationPageModel,this.selectHostsPageModel=new e.DvsSelectHostsPageModel,this.selectHostsToManagePageModel=new e.DvsSelectHostsPageModel,this.selectHostsToRemovePageModel=new e.DvsSelectHostsPageModel,this.selectPhysicalAdaptersPageModel=new e.DvsSelectPhysicalAdaptersPageModel,this.selectVirtualAdaptersPageModel=new e.DvsSelectVirtualAdaptersPageModel,this.selectVirtualMachinesPageModel=new e.DvsSelectVirtualMachinesPageModel}return Object.defineProperty(t.prototype,"selectedHosts",{get:function(){var t=[];switch(this.selectOperationPageModel.selectedOperationType){case e.DvsAddHostWizardConstants.operationType.ADD_HOST:t=this.selectHostsPageModel.hosts;break;case e.DvsAddHostWizardConstants.operationType.MANAGE_HOST:t=this.selectHostsToManagePageModel.hosts;break;case e.DvsAddHostWizardConstants.operationType.REMOVE_HOST:t=this.selectHostsToRemovePageModel.hosts;break;case e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING:t=this.selectHostsToManagePageModel.hosts}return t},enumerable:!0,configurable:!0}),t}();e.DvsAddHostWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.hosts=[]}return e}();e.DvsSelectHostsPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.isInitialized=!1,this.generationNumber=0}return e}();e.DvsSelectPhysicalAdaptersPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.isInitialized=!1}return e}();e.DvsSelectVirtualAdaptersPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.isMigrateVirtualMachineNetworkingEnabled=!1,this.isInitialized=!1}return e}();e.DvsSelectVirtualMachinesPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.selectedOperationType=e.DvsAddHostWizardConstants.operationType.ADD_HOST}return t}();e.SelectOperationPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i}return e.prototype.show=function(e,t,i,r,n){var o=this,a={assignUplinkComponentConfig:t,applyToAll:!1,applyToAllLabel:this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.applyToAllLabel"),
isBatchAssignmentEnabled:i,signPostConfig:r};this.modalOptions={title:this.i18nService.getString("DvsUi","assignUplinkDialogService.title"),subTitle:{text:e},defaultButton:"submit",alerts:[],dialogData:a,contentTemplate:"dvs-ui/resources/dvs/addhost/components/assignUplink/assignUplinkDialog.html",onSubmit:function(){return void 0===a.assignUplinkComponentConfig.selectedUplink||_.contains(a.assignUplinkComponentConfig.lagNames,a.assignUplinkComponentConfig.selectedUplink)?(o.modalOptions.alerts=[{text:o.i18nService.getString("DvsUi","assignUplinkDialogService.noUplinkSelected"),type:o.clarityConstants.notifications.type.ERROR}],!1):(n(t,a.applyToAll),!0)}},this.clarityModalService.openOkCancelModal(this.modalOptions)},e.$inject=["i18nService","clarityModalService","clarityConstants"],e}();e.AssingUplinkDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("assingUplinkDialogService",t)}(dvs_ui||(dvs_ui={}));var DvsSelectPhysicalAdaptersPageService=dvs_ui.DvsSelectPhysicalAdaptersPageService,dvs_ui;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i}return t.prototype.getActionBarOptions=function(e,i,r){var n={actions:[]};return n.actions.push({id:t.actionId.ASSIGN_UPLINK,label:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.assignUplinkButtonTitle"),tooltipText:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.assignUplinkButtonTooltip"),enabled:!1,iconClass:"network-lib-ui-icon-dvsUplinks",onClick:e}),r&&n.actions.push({id:t.actionId.UNASSIGN_UPLINK,label:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.unAssignUplinkButtonLabel"),tooltipText:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.unAssignUplinkButtonTooltip"),enabled:!1,iconClass:"network-lib-ui-icon-deleteIcon",onClick:r}),n.actions.push({id:t.actionId.VIEW_SETTINGS,label:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.showSelectedPnicDetailsButton"),tooltipText:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.showSelectedPnicDetailsToolTipButton"),enabled:!1,iconClass:"network-lib-ui-icon-info",onClick:i}),n},t.prototype.getColumnDefs=function(){var e=this.columnRenderersRegistry.getColumnRenderer("icon-text"),t=this.columnRenderersRegistry.getColumnRenderer("text"),i=this.itemToDisplayItem.bind(this);return[{field:"label",title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.hostPhysicalNic"),width:"260px",template:function(t){return e(["icon","label"],{icon:t.iconClass,label:t.label})}},{field:"inUseBySwitch",title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.inUseBySwitch"),width:"150px",template:function(e){return t(["inUseBySwitch"],e,!0)}},{field:"uplink",title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.uplinkColumnTitle"),width:"102px",template:function(e){return t(["uplink"],i(e),!0)}},{field:"uplinkPortgroup",title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.dvUplinkPortgroup"),template:function(e){return t(["uplinkPortgroup"],i(e),!0)}}]},t.prototype.itemToDisplayItem=function(t){var i={};return t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE&&(i.uplink=t.uplink,i.uplinkPortgroup=t.uplinkPortgroup.name),i.uplink===e.DvsAddHostWizardConstants.AUTO_ASSIGN&&(i.uplink=this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.autoAssign")),i},t.prototype.getTreeListSchema=function(){return{model:{id:"id",expanded:!0}}},t.prototype.isPnicOnThisSwitch=function(e){return e.parentId===e.onThisSwitchItemId},t.prototype.isPnicOriginallyOnThisSwitch=function(e){var t=e.originalItem;return t.parentId===t.onThisSwitchItemId},t.prototype.isPnicAssigned=function(e){var t=e.originalItem,i=e,r=i;return this.isPnicOnThisSwitch(r)&&t.parentId!==r.parentId},t.prototype.isPnicModified=function(e){var t=e.originalItem,i=e,r=i;return t.parentId!==r.parentId||t.uplink!==r.uplink||t.uplinkPortgroup.key!==r.uplinkPortgroup.key},t.prototype.isPnicUnassigned=function(e){var t=e.originalItem,i=t,r=e,n=r;return i.parentId===i.onThisSwitchItemId&&n.parentId===i.onOtherSwitchesItemId},t.prototype.getNumberOfUpdatedPhysicalAdapters=function(t){var i=this,r=_.filter(t,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE&&i.isPnicModified(t)});return r.length},t.$inject=["i18nService","vuiConstants","columnRenderersRegistry"],t.actionId={ASSIGN_UPLINK:"assign-uplink-action",UNASSIGN_UPLINK:"unassign-uplink-action",VIEW_SETTINGS:"view-settings-action"},t}();e.DvsSelectPhysicalAdaptersPageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectPhysicalAdaptersPageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.i18nService=e,this.columnRenderersRegistry=t}return t.prototype.getActionBarOptions=function(e,t,i){return{actions:[{id:"assign-portgroup-action",label:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.assignPortGroupButtonLabel"),tooltipText:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.assignPortGroupButtonToolTipLabel"),enabled:!1,iconClass:"network-lib-ui-icon-dvPortGroup",onClick:e},{id:"reset-changes-action",label:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.revertVmkernelButtonLabel"),tooltipText:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.revertVmkernelButtonTooltipLabel"),enabled:!1,iconClass:"network-lib-ui-icon-undo",onClick:t},{id:"view-settings-action",label:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.viewSelectedVnicDetailsButtonLabel"),tooltipText:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.viewSelectedVnicDetailsButtonToolTipLabel"),enabled:!1,iconClass:"network-lib-ui-icon-info",onClick:i}]}},t.prototype.getColumnDefs=function(){var e=this.columnRenderersRegistry.getColumnRenderer("icon-text"),t=this.columnRenderersRegistry.getColumnRenderer("text");return[{field:"label",title:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.hostColumnHeader"),width:"260px",template:function(t){return e(["icon","label"],{icon:t.iconClass,label:t.label})}},{field:"inUseBySwitch",title:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.switchColumnHeader"),width:"114px",template:function(e){return t(["inUseBySwitch"],e,!0)}},{field:"sourcePortgroup",title:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.sourcePortgroupColumnHeader"),width:"140px",template:function(e){return t(["sourcePortgroup"],e,!0)}},{field:"destinationPortgroup",title:this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.destPortgroupColumnHeader"),template:function(e){return t(["destinationPortgroup"],e,!0)}}]},t.prototype.getTreeListSchema=function(){return{model:{id:"id",expanded:!0}}},t.prototype.isVnicAssigned=function(e){var t=e;return t&&t.parentId===t.onThisSwitchItemId},t.prototype.isVnicModified=function(e){var t=e.originalItem,i=e,r=i;return t.parentId!==r.parentId||t.label!==r.label},t.prototype.getNumberOfUpdatedVirtualAdapters=function(t){var i=this,r=_.filter(t,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE&&i.isVnicModified(t)});return r.length},t.$inject=["i18nService","columnRenderersRegistry"],t}();e.DvsSelectVirtualAdaptersPageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectVirtualAdaptersPageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.i18nService=e,this.columnRenderersRegistry=t}return t.prototype.getActionBarOptions=function(e,t,i){return{actions:[{id:"assign-portgroup-action",label:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.assignPortGroupButton.title"),tooltipText:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.assignPortGroupButton.tooltip"),enabled:!1,iconClass:"network-lib-ui-icon-dvPortGroup",onClick:e},{id:"reset-changes-action",label:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.unassignPortGroupButton.title"),tooltipText:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.unassignPortGroupButton.tooltip"),enabled:!1,iconClass:"network-lib-ui-icon-undo",onClick:t},{id:"view-settings-action",label:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.viewSelectedVnicDetailsButton.title"),enabled:!1,iconClass:"network-lib-ui-icon-info",onClick:i}]}},t.prototype.getColumnDefs=function(){var t=this,i=this.columnRenderersRegistry.getColumnRenderer("icon-text"),r=this.columnRenderersRegistry.getColumnRenderer("text");return[{field:"label",title:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.hostVmVnic"),width:"260px",template:function(e){return i(["icon","label"],{icon:e.iconClass,label:e.label})}},{field:"nicCount",title:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.nicCount"),width:"84px",template:function(e){return r(["nicCount"],e)}},{field:"sourcePortgroup",title:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.sourcePortgroup"),width:"142px",template:function(e){return r(["sourcePortgroup"],e)}},{field:"destinationPortgroup",title:this.i18nService.getString("DvsUi","SelectVirtualMachinesPage.destPortgroup"),template:function(i){if(i.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE){var n=i.isReassigned?t.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.virtualMachineState.reassigned"):"";return $("<span/>").attr("ng-non-bindable","").addClass("dvs-add-host-vm-reassigned-column").text(n)[0].outerHTML}return r(["destinationPortgroup"],i)}}]},t.prototype.getTreeListSchema=function(){return{model:{id:"id",expanded:!1}}},t.prototype.isVnicModified=function(e){var t=e.originalItem,i=e,r=i;return t.destinationPortgroupRef!==r.destinationPortgroupRef},t.prototype.getNumberOfUpdatedVirtualMachineAdapters=function(t){var i=this,r=_.filter(t,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE&&i.isVnicModified(t)});return r.length},t.prototype.expandHostItems=function(e,t){var i=!1;return t&&e?(_.forEach(t.rootNodes(),function(t){if(null===t.parentId){var r=e.itemFor(t);r&&!r.expanded&&(e.expand(r),i=!0)}}),i):i},t.$inject=["i18nService","columnRenderersRegistry"],t}();e.DvsSelectVirtualMachinesPageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectVirtualMachinesPageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.clarityModalService=t}return e.prototype.show=function(e,t,i){var r="dvs-ui/resources/dvs/addhost/services/pnicSettingsDialog.html",n=this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.pnicPopupTitle",t,i),o={title:n,hostId:e,pnicDevice:t};this.clarityModalService.openModal(void 0,[],o,r)},e.$inject=["i18nService","clarityModalService"],e}();e.PnicSettingsDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("pnicSettingsDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n){this.i18nService=e,this.clarityModalService=t,this.authorizationService=i,this.defaultUriSchemeUtil=r,this.clarityConstants=n}return t.prototype.show=function(t,i,r,n,o,a,s){var c=this,l=[],d={onSelectedHostsChange:function(e){l=e},showVdsStateColumn:n,allowAnySelection:a,showIncompatibleHostsButton:o,loading:!0},u={title:r,defaultButton:"submit",size:"lg",alerts:[],dialogData:d,contentTemplate:"dvs-ui/resources/dvs/addhost/components/selectHosts/selectHostsDialog.html",modalClass:"dvs-select-hosts-modal",subTitle:{objectId:s}},p=function(t){var i=_.filter(_.pairs(t),function(t){return!t[1][e.Privileges.HOST_CONFIG_NETWORK]});return _.map(i,function(e){var t=_.find(l,function(t){return e[0]===c.defaultUriSchemeUtil.getVsphereObjectId(t.hostRef)});return t.hostName})};u.onSubmit=function(){var t=c.defaultUriSchemeUtil.getVsphereObjectIds(_.map(l,function(e){return e.hostRef}));return c.authorizationService.checkPrivilegesForMultipleObjects(t,[e.Privileges.HOST_CONFIG_NETWORK]).then(p).then(function(e){return e.length>0?(u.alerts=[{text:c.i18nService.getString("DvsUi","DvsSelectHostsDialog.noPrivileges",e.join(", ")),type:c.clarityConstants.notifications.type.ERROR}],!1):(i(l),!0)})},t.then(function(e){d.hosts=e,d.loading=!1}),this.clarityModalService.openOkCancelModal(u)},t.$inject=["i18nService","clarityModalService","authorizationService","defaultUriSchemeUtil","clarityConstants"],t}();e.SelectHostsDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("selectHostsDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.clarityModalService=t}return e.prototype.show=function(e,t){var i={applyToAll:!1,applyToAllLabel:this.i18nService.getString("DvsUi","unassignUplinkDialog.applyToAllLabel"),pnicName:e};this.modalOptions={title:this.i18nService.getString("DvsUi","unassignUplinkDialog.title"),subTitle:{text:e},defaultButton:"submit",saveButtonLabel:this.i18nService.getString("DvsUi","unassignUplinkDialog.unassignBtn"),alerts:[],dialogData:i,contentTemplate:"dvs-ui/resources/dvs/addhost/components/unassignUplink/unassignUplinkDialog.html",submit:function(){return t(i.applyToAll),!0}},this.clarityModalService.openConfirmationModal(this.modalOptions)},e.$inject=["i18nService","clarityModalService"],e}();e.UnassingUplinkDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("unassingUplinkDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.clarityModalService=e}return e.prototype.show=function(e,t,i){var r="dvs-ui/resources/dvs/addhost/services/vmVnicSettingsDialog.html",n={title:e,vmVnicKey:i,vmRef:t};this.clarityModalService.openModal(void 0,[],n,r)},e.$inject=["clarityModalService"],e}();e.VmVnicSettingsDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("vmVnicSettingsDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.clarityModalService=t}return e.prototype.show=function(e,t,i){var r="dvs-ui/resources/dvs/addhost/services/vnicSettingsDialog.html",n=this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.vnicPopupTitle",t,i),o={title:n,hostId:e,vnicDevice:t};this.clarityModalService.openModal(void 0,[],o,r)},e.$inject=["i18nService","clarityModalService"],e}();e.VnicSettingsDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("vnicSettingsDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.getValidationError=function(e){var t=[];return 0===e.length&&t.push(this.i18nService.getString("DvsUi","SelectHostsPage.validator.noHostsSelected")),t},e.$inject=["i18nService"],e}();e.DvsSelectHostsPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectHostsPageValidator",t)}(dvs_ui||(dvs_ui={}));var DvsSelectPhysicalAdaptersPageValidator=dvs_ui.DvsSelectPhysicalAdaptersPageValidator,DvsSelectPhysicalAdaptersPageModel=dvs_ui.DvsSelectPhysicalAdaptersPageModel,DvsAddHostHierarchicalListGroupingItem=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListGroupingItem,DvsAddHostHierarchicalListItem=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListItem,dvs_ui;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.clarityModalService=t,this.$q=i}return t.prototype.validate=function(t){var i=0;t&&t.uplinkNames&&(i+=t.uplinkNames.length);var r=_.filter(t.hosts,function(t){if(t&&t.type===e.DvsAddHostWizardConstants.nicListItemType.GROUPING_TYPE){var i=t,r=i;return r.isOnThisSwitch}return!1}),n={};_.each(r,function(e){n[e.id]=0}),_.each(t.hosts,function(t){t&&t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE&&n[t.parentId]++});var o=this.$q.defer();return _.some(_.values(n),function(e){return e>i})?this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.error"),message:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.uplinkError"),clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"},saveButtonLabel:this.i18nService.getString("Common","alert.ok"),hideCancelButton:!0,submit:function(){o.resolve(!1)}}):_.some(_.values(n),function(e){return 0===e})?this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.warning"),message:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.noPnicsSelected"),clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0,submit:function(){o.resolve(!0)},onCancel:function(){o.resolve(!1)}}):o.resolve(!0),o.promise},t.$inject=["i18nService","clarityModalService","$q"],t}();e.DvsSelectPhysicalAdaptersPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectPhysicalAdaptersPageValidator",t)}(dvs_ui||(dvs_ui={}));var HostListItemData=com.vmware.vsphere.client.dvs.api.host.HostListItemData,DvsAddHostHierarchicalListHostItem=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListHostItem,DvsAddHostHierarchicalListPnicItem=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListPnicItem,DvsAddHostHierarchicalListVnicItem=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListVnicItem,dvs_ui;!function(e){var t=function(){function e(){this.pnics=[],this.vnics=[]}return e}(),i=function(){function e(){}return e}(),r=function(){function r(e,t,i,r){this.i18nService=e,this.dvsSelectPhysicalAdaptersPageService=t,this.dvsSelectVirtualAdaptersPageService=i,this.defaultUriSchemeUtil=r,this.THIS_SWITCH_NAME=""}return r.prototype.getValidationError=function(t,i,r){t=_.filter(t,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE}),i=_.filter(i,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE});var n={};this.addHosts(n,t),this.addPnics(n,i),this.addVnics(n,r);var o=_.find(_.values(n),function(e){var t=_.find(_.values(e.standardSwitches).concat(_.values(e.distributedSwitches)),function(e){return e.vnics&&e.vnics.length>0&&e.pnics&&e.pnics.length>0});return!t&&!e.isManagementOnOpaqueSwitch}),a=[];return o&&a.push(this.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.errorForNetworkConnectivityLoss",o.name)),a},r.prototype.getVnicsWithConnectivityWarning=function(t,i,r){var n=this;t=_.filter(t,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE}),i=_.filter(i,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE});var o={};this.addHosts(o,t),this.addPnics(o,i);var a={};this.addHosts(a,t),this.addOriginalPnics(a,i);var s=_.filter(r,function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE&&!n.dvsSelectVirtualAdaptersPageService.isVnicAssigned(t)});return _.filter(s,function(e){var t=e,i=t,r=n.getSwitchConfigForVnic(o,i),s=n.getSwitchConfigForVnic(a,i);return 0===r.pnics.length&&s.pnics.length>0})},r.prototype.addHosts=function(e,t){var r=this;_.each(t,function(t){var n=t,o=n,a=new i;a.name=o.label,a.standardSwitches={},a.distributedSwitches={},e[r.defaultUriSchemeUtil.getVsphereObjectId(o.hostRef)]=a})},r.prototype.addOriginalPnics=function(e,t){var i=this;_.each(_.map(t,function(e){return e.originalItem}),function(t){return i.addPnicItem(e,t)})},r.prototype.addPnics=function(e,t){var i=this,r=_.filter(t,function(e){return!i.dvsSelectPhysicalAdaptersPageService.isPnicUnassigned(e)});_.each(r,function(t){return i.addPnicItem(e,t)})},r.prototype.addPnicItem=function(e,t){var i=t,r=e[this.defaultUriSchemeUtil.getVsphereObjectId(i.hostRef)],n=this.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(i)||!i.isStandardSwitch?r.distributedSwitches:r.standardSwitches,o=null;if(this.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(i)?o=this.THIS_SWITCH_NAME:i.isAssigned&&(o=i.inUseBySwitch),null!==o){var a=this.getOrCreateSwitchConfig(n,o);a.pnics.push(i.device)}},r.prototype.addVnics=function(t,i){var r=this;_.each(i,function(i){if(i.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE){var n=i;if(n.isOnManagementStack)if(n.isOpaqueSwitch){var o=t[r.defaultUriSchemeUtil.getVsphereObjectId(n.hostRef)];o.isManagementOnOpaqueSwitch=!0}else{var a=r.getSwitchConfigForVnic(t,n);a.vnics.push(n.device)}}})},r.prototype.getSwitchConfigForVnic=function(e,t){var i,r=e[this.defaultUriSchemeUtil.getVsphereObjectId(t.hostRef)],n=this.dvsSelectVirtualAdaptersPageService.isVnicAssigned(t)||!t.isStandardSwitch?r.distributedSwitches:r.standardSwitches;return i=this.dvsSelectVirtualAdaptersPageService.isVnicAssigned(t)?this.THIS_SWITCH_NAME:t.inUseBySwitch,this.getOrCreateSwitchConfig(n,i)},r.prototype.getOrCreateSwitchConfig=function(e,i){var r=e[i];return r||(r=new t,e[i]=r),r},r.$inject=["i18nService","dvsSelectPhysicalAdaptersPageService","dvsSelectVirtualAdaptersPageService","defaultUriSchemeUtil"],r}();e.DvsSelectVirtualAdaptersPageValidator=r,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectVirtualAdaptersPageValidator",r)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n){this.i18nService=e,this.authorizationService=t,this.$q=i,this.dvsSelectVirtualMachinesPageService=r,this.defaultUriSchemeUtil=n}return t.prototype.getValidationError=function(t){var i=this,r=this.$q.defer();if(!t||!t.isMigrateVirtualMachineNetworkingEnabled||!t.hosts||0===t.hosts.length)return r.resolve([]),r.promise;var n="VirtualMachine.Config.EditDevice",o=[];return _.each(t.hosts,function(t){if(t&&t.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE&&i.dvsSelectVirtualMachinesPageService.isVnicModified(t)){var r=t,n=r;o.push(i.defaultUriSchemeUtil.getVsphereObjectId(n.vmRef))}}),o&&0!==o.length?(this.authorizationService.checkPrivilegesForMultipleObjects(o,[n]).then(function(e){var o=[];Object.keys(e).forEach(function(r){if(e[r][n]===!1){var a=i.getVmName(r,t.hosts);o.push(i.i18nService.getString("DvsUi","SelectVirtualMachinesPage.errorNoPermissionForVm",a))}}),r.resolve(o)}),r.promise):(r.resolve([]),r.promise)},t.prototype.getVmName=function(t,i){var r=this,n=_.find(i,function(i){if(i&&i.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE){var n=i,o=n;return t===r.defaultUriSchemeUtil.getVsphereObjectId(o.vmRef)}return!1});return n?n.label:""},t.$inject=["i18nService","authorizationService","$q","dvsSelectVirtualMachinesPageService","defaultUriSchemeUtil"],t}();e.DvsSelectVirtualMachinesPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSelectVirtualMachinesPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(t,i,r,n,o,a){this.$scope=t,this.i18nService=i,this.vxPropertyViewService=r,this.dvsSelectPhysicalAdaptersPageService=n,this.dvsSelectVirtualAdaptersPageService=o,this.dvsSelectVirtualMachinesPageService=a;var s=t.model.selectOperationPageModel.selectedOperationType,c=r.createPropertyViewBuilder(),l=c.category("general"),d=l.section("generalSection");s===e.DvsAddHostWizardConstants.operationType.ADD_HOST?(d.title(i.getString("DvsUi","ManageHostsSummayPage.heading.hostsForUpdate")),d.property(i.getString("DvsUi","ManageHostsSummayPage.property.hostsToAddCount"),t.model.selectHostsPageModel.hosts.length)):s===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST?(d.title(this.i18nService.getString("DvsUi","ManageHostsSummayPage.heading.hostsForUpdate")),d.property(i.getString("DvsUi","ManageHostsSummayPage.property.hostsToUpdateCount"),t.model.selectHostsToManagePageModel.hosts.length)):s===e.DvsAddHostWizardConstants.operationType.REMOVE_HOST&&d.property(i.getString("DvsUi","ManageHostsSummayPage.property.hostsToRemoveCount"),t.model.selectHostsToRemovePageModel.hosts.length);var u=this.dvsSelectPhysicalAdaptersPageService.getNumberOfUpdatedPhysicalAdapters(t.model.selectPhysicalAdaptersPageModel.hosts),p=this.dvsSelectVirtualAdaptersPageService.getNumberOfUpdatedVirtualAdapters(t.model.selectVirtualAdaptersPageModel.hosts),v=t.model.selectVirtualMachinesPageModel.isMigrateVirtualMachineNetworkingEnabled?this.dvsSelectVirtualMachinesPageService.getNumberOfUpdatedVirtualMachineAdapters(t.model.selectVirtualMachinesPageModel.hosts):0;if(s!==e.DvsAddHostWizardConstants.operationType.REMOVE_HOST&&(u>0||p>0||v>0)){var m=l.section("networkAdapters").title(i.getString("DvsUi","ManageHostsSummayPage.heading.adaptersForUpdate"));u>0&&m.property(i.getString("DvsUi","ManageHostsSummayPage.property.pNicsCount"),u),p>0&&m.property(i.getString("DvsUi","ManageHostsSummayPage.property.vNicsReassignedCount"),p),v>0&&m.property(this.i18nService.getString("DvsUi","ManageHostsSummayPage.property.vmNicsCount"),v)}this.$scope.model.summaryData=c.build()}return t.$inject=["$scope","i18nService","vxPropertyViewService","dvsSelectPhysicalAdaptersPageService","dvsSelectVirtualAdaptersPageService","dvsSelectVirtualMachinesPageService"],t}();angular.module("com.vmware.vsphere.client.dvs").controller("DvsAddHostReadyToCompletePageController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.dataService=t,this.$q=i}return e.prototype.onHostsChanged=function(e){this.$scope.model.selectHostsPageModel.hosts=e},e.prototype.requestHosts=function(){var t=this;return this.allHosts?this.$q.when(this.allHosts):this.dataService.getProperties(this.$scope.model.dvsId,[e.NEW_HOSTS_DATA_PROP]).then(function(i){var r=i[e.NEW_HOSTS_DATA_PROP];return r?t.allHosts=r.hosts:t.allHosts=[],t.allHosts})},e.NEW_HOSTS_DATA_PROP="dvs:newHostsData",e.$inject=["$scope","dataService","$q"],e}();e.DvsSelectHostsPageController=t,angular.module("com.vmware.vsphere.client.dvs").controller("DvsSelectHostsPageController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.dataService=t,this.$q=i}return e.prototype.onHostsChanged=function(e){this.$scope.model.selectHostsToManagePageModel.hosts=e},e.prototype.requestHosts=function(){var t=this;return this.allHosts?this.$q.when(this.allHosts):this.dataService.getProperties(this.$scope.model.dvsId,[e.DVS_HOSTS_DATA_PROP]).then(function(i){var r=i[e.DVS_HOSTS_DATA_PROP];return r?t.allHosts=r.dvsHosts:t.allHosts=[],t.allHosts})},e.DVS_HOSTS_DATA_PROP="dvs:dvsHostsData",e.$inject=["$scope","dataService","$q"],e}();e.DvsSelectHostsToManagePageController=t,angular.module("com.vmware.vsphere.client.dvs").controller("DvsSelectHostsToManagePageController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.dataService=t,this.$q=i}return e.prototype.onHostsChanged=function(e){this.$scope.model.selectHostsToRemovePageModel.hosts=e},e.prototype.requestHosts=function(){var t=this;return this.allHosts?this.$q.when(this.allHosts):this.dataService.getProperties(this.$scope.model.dvsId,[e.DVS_HOSTS_DATA_PROP]).then(function(i){var r=i[e.DVS_HOSTS_DATA_PROP];return r?t.allHosts=r.dvsHosts:t.allHosts=[],t.allHosts})},e.DVS_HOSTS_DATA_PROP="dvs:dvsHostsData",e.$inject=["$scope","dataService","$q"],e}();e.DvsSelectHostsToRemovePageController=t,angular.module("com.vmware.vsphere.client.dvs").controller("DvsSelectHostsToRemovePageController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListItem,i=com.vmware.vsphere.client.h5.network.dvs.addhost.model.DvsHostsSpec,r=com.vmware.vsphere.client.h5.network.dvs.addhost.model.DvPortgroupModel,n=function(){function n(e,t,i,r,n,o,a,s,c,l,d){this.$q=e,this.$wizardScope=t,this.i18nService=i,this.dataService=r,this.dvsSelectPhysicalAdaptersPageService=n,this.assingUplinkDialogService=o,this.unassingUplinkDialogService=a,this.clarityModalService=s,this.pnicSettingsDialogService=c,this.defaultUriSchemeUtil=l,this.networkUtil=d,this._actionsMap=new Object,this.treeListWidget=null,this.actionBarOptions=this.dvsSelectPhysicalAdaptersPageService.getActionBarOptions(this.onAssignUplinkClicked.bind(this),this.onViewSettingsClicked.bind(this),this.onUnassignUplinkClicked.bind(this)),this.initActionsMap(this.actionBarOptions.actions,this._actionsMap),this.$wizardScope.model.selectPhysicalAdaptersPageModel.isInitialized?this.initializePhysicalAdaptersTreeList(this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts):(this.initializePhysicalAdaptersTreeList([]),this.requestPageData()),this.$wizardScope.$on("$destroy",function(){kendo.destroy($(".dvs-add-host-adapters-tree-list"))})}return n.prototype.updateToolbar=function(){if(null!==this.treeListWidget){var t=this.treeListWidget.select(),i=this.treeListWidget.dataItem(t);if(this._selectedItem=i,i||_.each(this.actionBarOptions.actions,function(e){e.enabled=!1}),i&&i.type){var r=this._actionsMap[e.DvsSelectPhysicalAdaptersPageService.actionId.ASSIGN_UPLINK],n=this._actionsMap[e.DvsSelectPhysicalAdaptersPageService.actionId.UNASSIGN_UPLINK],o=this._actionsMap[e.DvsSelectPhysicalAdaptersPageService.actionId.VIEW_SETTINGS];r.enabled=i.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE,o.enabled=i.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE,n&&(n.enabled=i.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE&&this.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(i))}}},n.prototype.onDataBound=function(){if(this._selectedItem){var e=this.treeListWidget.itemFor(this._selectedItem);this.treeListWidget.select(e)}},n.prototype.containsModifications=function(t){if(!t)return!1;if(t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE)return this.dvsSelectPhysicalAdaptersPageService.isPnicModified(t);if(t.type===e.DvsAddHostWizardConstants.nicListItemType.GROUPING_TYPE){var i=this.treeListDataSource.childNodes(t);return _.some(i,this.dvsSelectPhysicalAdaptersPageService.isPnicModified)}if(t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE){var r=this.treeListDataSource.childNodes(t),n=this.treeListDataSource.childNodes(r[0]),o=this.treeListDataSource.childNodes(r[1]);return _.some(n,this.dvsSelectPhysicalAdaptersPageService.isPnicModified)||_.some(o,this.dvsSelectPhysicalAdaptersPageService.isPnicModified)}throw new Error("Unknown item type: "+t.type)},n.prototype.initActionsMap=function(e,t){_.each(e,function(e){e&&e.id&&(t[e.id]=e)})},n.prototype.markPageDirty=function(){this.$wizardScope.model.selectPhysicalAdaptersPageModel.generationNumber++},n.prototype.requestPageData=function(){var e=this;this.$wizardScope.wizardConfig.loading=!0;var t=this.requestPhysicalAdapters(),i=this.requestUplinkData();this.$q.all([t,i]).then(function(t){e.createHostPnicTreeModel(t[0]);var i=t[1][n.UPLINK_DATA_PROPERTY];e.$wizardScope.model.selectPhysicalAdaptersPageModel.lags=[],e.$wizardScope.model.selectPhysicalAdaptersPageModel.uplinkNames=e.getAllUplinkNames(i.uplinkNames,i.lacpGroupConfigs,e.$wizardScope.model.selectPhysicalAdaptersPageModel.lags),e.$wizardScope.model.selectPhysicalAdaptersPageModel.uplinkPortgroups=i.uplinkPortgroups,e.$wizardScope.wizardConfig.loading=!1},function(t){e.$wizardScope.wizardConfig.loading=!1})},n.prototype.getAllUplinkNames=function(e,t,i){var r=this,n=_.map(e,function(e){return[e,!1]}),o={};t&&t.length>0&&_.forEach(t,function(e){e.name&&e.uplinkName&&e.uplinkName.length>0&&_.forEach(e.uplinkName,function(t){o[e.name]||(o[e.name]=[]),o[e.name].push(t)})});var a=_.keys(o);return a.length>0&&(a.sort(),_.each(a,function(e){var t=o[e];if(t&&t.length>0){var a=r.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.lacpCategory",e);n.push([a,!1]),i.push(a),t.sort(),_.each(t,function(e){n.push([e,!0])})}})),n},n.prototype.onAssignUplinkClicked=function(){if(this.$wizardScope.model.selectPhysicalAdaptersPageModel.uplinkPortgroups&&this.$wizardScope.model.selectPhysicalAdaptersPageModel.uplinkPortgroups.length>0){
var t=new e.AssignUplinkComponentConfig;t.uplinkPortgroups=this.$wizardScope.model.selectPhysicalAdaptersPageModel.uplinkPortgroups;var i=this.asPnicItem(this._selectedItem);t.uplinkMappings=this.getUplinkMappings(i),t.lagNames=this.$wizardScope.model.selectPhysicalAdaptersPageModel.lags,this.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(i)&&(t.selectedUplink=i.uplink,t.selectedUplinkPortgroup=_.find(t.uplinkPortgroups,function(e){return e.name===i.uplinkPortgroup.name}));var r=this.hostItems().length>1,n=new e.ApplyToAllSignPostConfig;n.applyToAllSignPostTitle=this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.applyToAll.signPostTitle");var o=this.asPnicItem(this._selectedItem).device,a=this.getHostItemsWithoutPnicDevice(o);if(a.length>0){var s=a.map(function(e){return e.label});n.applyToAllSingPostMessage=a.length>3?this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.applyToAll.warnMessageManyHosts",o,s.slice(0,3).join(", ")):this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.applyToAll.warnMessage",o,s.join(", ")),n.applyToAllSignPostIcon="exclamation-triangle"}else n.applyToAllSingPostMessage=this.i18nService.getString("DvsUi","UplinkPortMappingAssignDialog.applyToAll.infoMessage",o),n.applyToAllSignPostIcon="info-circle";this.assingUplinkDialogService.show(i.device,t,r,n,this.onUplinkAssigned.bind(this))}else this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.error"),message:this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.noUplinkPortgroupsError"),clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"},saveButtonLabel:this.i18nService.getString("Common","alert.ok"),hideCancelButton:!0,submit:function(){return!0}})},n.prototype.onUnassignUplinkClicked=function(){var e=this.asPnicItem(this._selectedItem),t=this.getPnicItemsWithName(e.device),i=t.indexOf(e);t.splice(i,1);for(var r=!1,n=this.$wizardScope.model.selectedHosts.length>1,o=0,a=t;o<a.length;o++){var s=a[o];r="--"!==s.uplink&&n}var c;c=this.dvsSelectPhysicalAdaptersPageService.isPnicAssigned(this._selectedItem)?this.onUnassignClicked.bind(this):this.onUnclaimAdapter.bind(this),r?this.unassingUplinkDialogService.show(e.device,c.bind(this)):c(!1)},n.prototype.onViewSettingsClicked=function(){var e=this._selectedItem,t=e,i=this.treeListDataSource.parentNode(t),r=this.treeListDataSource.parentNode(i);this.pnicSettingsDialogService.show(this.defaultUriSchemeUtil.getVsphereObjectId(t.hostRef),t.device,r.label)},n.prototype.getUplinkMappings=function(e){var t=this,i=this.getPnicItemsInTheSameHost(e);return _.map(this.$wizardScope.model.selectPhysicalAdaptersPageModel.uplinkNames,function(e){var r=_.find(i,function(t){return t.uplink===e[0]}),n=void 0;return r?n=r.device:_.contains(t.$wizardScope.model.selectPhysicalAdaptersPageModel.lags,e[0])&&(n=""),[e[0],n,e[1]]})},n.prototype.onUplinkAssigned=function(e,t){if(void 0!==e.selectedUplink&&void 0!==e.selectedUplinkPortgroup){var i=e.selectedUplink,r=e.selectedUplinkPortgroup,n=this.asPnicItem(this._selectedItem);t?this.assignUplinkToPnics(i,r,this.getPnicItemsWithName(n.device)):this.assignUplinkToPnics(i,r,[n])}},n.prototype.getPnicItemsWithName=function(e){return this.pnicItems().filter(function(t){return t.device===e})},n.prototype.getHostItemsWithoutPnicDevice=function(e){var t=this.getPnicItemsWithName(e).map(function(e){return e.hostRef}),i=this.hostItems().filter(function(e){return!_.some(t,function(t){return _.isEqual(t.value,e.hostRef.value)})});return i},n.prototype.hostItems=function(){return this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts.filter(function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE}).map(function(e){return e})},n.prototype.pnicItems=function(){return this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts.filter(function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE}).map(function(e){return e})},n.prototype.freeUpUplink=function(t,i){var r=_.find(this.getPnicItemsInTheSameHost(i),function(e){return e.uplink===t});r&&r!==i&&this.updatePnicItem(r,e.DvsAddHostWizardConstants.AUTO_ASSIGN,r.uplinkPortgroup)},n.prototype.assignUplinkToPnics=function(e,t,i){var r=this;_.each(i,function(i){r.freeUpUplink(e,i),r.updatePnicItem(i,e,t)}),this.updateDataSource(i),this.markPageDirty(),this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts=this.treeListDataSource.data()},n.prototype.updateListOfItems=function(t){for(var i=angular.copy(this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts,[]),r=function(e){var t=_.findIndex(i,function(t){return t.id===e.id});t>=0&&i.splice(t,1)},n=0,o=t;n<o.length;n++){var a=o[n];r(a)}for(var s=0,c=t;s<c.length;s++){for(var a=c[s],l=!1,d=0;d<i.length;d++){var u=i[d];if(u.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE){var p=this.asPnicItem(u);if(p.hostRef.value===a.hostRef.value&&p.orderInList>a.orderInList){i.splice(d,0,this.asWrapper(a)),l=!0;break}}}l||i.push(this.asWrapper(a))}return i},n.prototype.updatePnicItem=function(e,t,i){var r=this.asWrapper(e).originalItem,n="SelectPhysicalAdaptersPage.adapterState.assigned";if(this.dvsSelectPhysicalAdaptersPageService.isPnicOnThisSwitch(r)){if(t===r.uplink&&i.name===r.uplinkPortgroup.name)return void this.unassignAdapter(this.asWrapper(e));n="SelectPhysicalAdaptersPage.adapterState.reassigned"}e.label=this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.displayName.formatter",r.label,this.i18nService.getString("DvsUi",n)),e.parentId=e.onThisSwitchItemId,e.uplinkPortgroup.key=i.key,e.uplinkPortgroup.name=i.name,e.uplink=t},n.prototype.onUnassignClicked=function(t){var i=this;if(this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE){var r=[],n=this.asPnicItem(this._selectedItem);if(t){var o=this.getPnicItemsWithName(n.device);_.each(o,function(e){i.unassignAdapter(i.asWrapper(e)),r.push(e)})}else this.unassignAdapter(this._selectedItem),r.push(n);this.updateDataSource(r)}this.markPageDirty(),this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts=this.treeListDataSource.data()},n.prototype.unassignAdapter=function(e){if(this.dvsSelectPhysicalAdaptersPageService.isPnicModified(e)){var t=e.originalItem,i=e,r=i;this.dvsSelectPhysicalAdaptersPageService.isPnicOriginallyOnThisSwitch(e)&&this.freeUpUplink(t.uplink,r),r.parentId=t.parentId,r.label=t.label,r.uplink=t.uplink,r.uplinkPortgroup.key=t.uplinkPortgroup.key,r.uplinkPortgroup.name=t.uplinkPortgroup.name}},n.prototype.onUnclaimAdapter=function(e){var t=this,i=[],r=this.asPnicItem(this._selectedItem);if(e){var n=this.getPnicItemsWithName(r.device);_.each(n,function(e){var r=t.asWrapper(e),n=r.originalItem;t.unclaimAdapter(n,e),i.push(e)})}else{var o=this._selectedItem.originalItem,a=this.asPnicItem(this._selectedItem);this.unclaimAdapter(o,a),i.push(a)}this.updateDataSource(i),this.markPageDirty(),this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts=this.treeListDataSource.data()},n.prototype.unclaimAdapter=function(e,t){t.parentId=e.onOtherSwitchesItemId,t.label=this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.displayName.formatter",e.label,this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.adapterState.unassigned")),t.uplink=this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.noUplink"),t.uplinkPortgroup=new r,t.uplinkPortgroup.name=this.i18nService.getString("DvsUi","SelectPhysicalAdaptersPage.noUplinkPortgroupLabel")},n.prototype.updateDataSource=function(e){var t=this._selectedItem.id,i=this.updateListOfItems(e);this.treeListDataSource=new kendo.data.TreeListDataSource({data:i,schema:this.dvsSelectPhysicalAdaptersPageService.getTreeListSchema()}),this.treeListDataSource.read(),this._selectedItem=_.filter(i,function(e){return e.id===t})[0]},n.prototype.requestUplinkData=function(){return this.dataService.getProperties(this.$wizardScope.model.dvsId,n.UPLINK_DATA_PROPERTY)},n.prototype.requestPhysicalAdapters=function(){var t=_.pluck(this.$wizardScope.model.selectedHosts,"hostRef"),r=new i;r.hosts=t,r.areMemberHosts=this.$wizardScope.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST||this.$wizardScope.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING;var o={propertyParams:[{propertyName:n.PHYSICAL_ADAPTERS_PROPERTY,parameterType:r._type,parameter:r}]},a=this.dataService.getProperties(this.$wizardScope.model.dvsId,[n.PHYSICAL_ADAPTERS_PROPERTY],o);return a},n.prototype.createHostPnicTreeModel=function(e){if(e){var t=e[n.PHYSICAL_ADAPTERS_PROPERTY],i=_.map(t,this.mapListItemToWrapper);this.initializePhysicalAdaptersTreeList(i),this.$wizardScope.model.selectPhysicalAdaptersPageModel.isInitialized=!0}},n.prototype.mapListItemToWrapper=function(e){var i=e;i.originalItem=angular.copy(e,new t);var n=e,o=angular.copy(n.uplinkPortgroup,new r),a=i.originalItem;return a.uplinkPortgroup=o,i},n.prototype.initializePhysicalAdaptersTreeList=function(e){this.treeListDataSource=new kendo.data.TreeListDataSource({data:e,schema:this.dvsSelectPhysicalAdaptersPageService.getTreeListSchema()}),this.treeListDataSource.read(),this.treeListColumns=this.dvsSelectPhysicalAdaptersPageService.getColumnDefs(),this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts=this.treeListDataSource.data()},n.prototype.getPnicItemsInTheSameHost=function(t){var i=function(i){return i.type===e.DvsAddHostWizardConstants.nicListItemType.PNIC_TYPE&&_.isEqual(t.hostRef.value,i.hostRef.value)};return _.filter(this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts,i)},n.prototype.asPnicItem=function(e){var t=e;return t},n.prototype.asWrapper=function(e){return e},n.$inject=["$q","$scope","i18nService","dataService","dvsSelectPhysicalAdaptersPageService","assingUplinkDialogService","unassingUplinkDialogService","clarityModalService","pnicSettingsDialogService","defaultUriSchemeUtil","networkUtil"],n.UPLINK_DATA_PROPERTY="dvsAddHost:uplinkData",n.PHYSICAL_ADAPTERS_PROPERTY="dvsAddHost:hostPnicData",n}();angular.module("com.vmware.vsphere.client.dvs").controller("DvsSelectPhysicalAdaptersPageController",n)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListItem,i=com.vmware.vsphere.client.h5.network.dvs.addhost.model.DvsHostsSpec,r=function(){function r(e,t,i,r,n,o,a,s,c){this.$q=e,this.$wizardScope=t,this.i18nService=i,this.dataService=r,this.defaultUriSchemeUtil=n,this.networkSelectorDialogService=o,this.dvsSelectVirtualAdaptersPageService=a,this.vnicSettingsDialogService=s,this.dvsSelectVirtualAdaptersPageValidator=c,this.treeListWidget=null,this.actionBarOptions=this.dvsSelectVirtualAdaptersPageService.getActionBarOptions(this.onAssignPortgroupClicked.bind(this),this.onResetChangesClicked.bind(this),this.onViewSettingsClicked.bind(this)),this.$wizardScope.model.selectVirtualAdaptersPageModel.isInitialized?this.initializeVirtualAdaptersTreeList(this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts):(this.initializeVirtualAdaptersTreeList([]),this.requestPageData()),this.$wizardScope.$on("$destroy",function(){kendo.destroy($(".dvs-add-host-adapters-tree-list"))})}return r.prototype.onDataBound=function(){if(this._selectedItem){var e=this.treeListWidget.itemFor(this._selectedItem);this.treeListWidget.select(e)}},r.prototype.requestPageData=function(){var e=this;this.$wizardScope.wizardConfig.loading=!0;var t=this.requestVirtualAdapters();t.then(function(t,i){e.createHostVnicTreeModel(t),e.$wizardScope.wizardConfig.loading=!1})},r.prototype.onNetworkSelectorClosed=function(e,t){if(e&&e.length>0){var i=e[0],r=i.name,n=i.networkRef,o=void 0;o=t?this.getVnicItemsWithName(this.asVnicItem(this._selectedItem).device):[this._selectedItem];var a=this._selectedItem.id,s=this.assignVnics(o,r,n);this.treeListDataSource=new kendo.data.TreeListDataSource({data:s,schema:this.dvsSelectVirtualAdaptersPageService.getTreeListSchema()}),this.treeListDataSource.read(),this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts=this.treeListDataSource.data(),this._selectedItem=_.filter(s,function(e){return e.id===a})[0]}},r.prototype.assignVnics=function(e,t,i){var r=this;return e.forEach(function(e){var n=r.asVnicItem(r.asWrapper(e).originalItem);e.parentId=n.onThisSwitchItemId,e.label=r.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.displayName.formatter",n.label,r.i18nService.getString("DvsUi","SelectVirtualAdaptersPage.virtualAdapterState.reassigned")),e.destinationPortgroup=t,e.portgroupRef=i}),this.checkVnicsForConnectivityLoss(this.treeListDataSource.data()),this.updateListOfItems(e)},r.prototype.checkVnicsForConnectivityLoss=function(t){var i=this;t&&t.length>0&&(this.vnicsWithoutBackingPnic=this.dvsSelectVirtualAdaptersPageValidator.getVnicsWithConnectivityWarning(t,this.$wizardScope.model.selectPhysicalAdaptersPageModel.hosts,t),_.each(t,function(t){if(t.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE){var r=t;_.contains(i.vnicsWithoutBackingPnic,t)?r.iconClass="network-lib-ui-icon-virtualAdapterWarning":r.iconClass="network-lib-ui-icon-virtualAdapter"}}))},r.prototype.updateListOfItems=function(t){for(var i=angular.copy(this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts,[]),r=function(e){var t=_.findIndex(i,function(t){return t.id===e.id});t>=0&&i.splice(t,1)},n=0,o=t;n<o.length;n++){var a=o[n];r(a)}for(var s=0,c=t;s<c.length;s++){for(var a=c[s],l=!1,d=0;d<i.length;d++){var u=i[d];if(u.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE){var p=this.asVnicItem(u);if(p.hostRef.value===a.hostRef.value&&p.orderInList>a.orderInList){i.splice(d,0,this.asWrapper(a)),l=!0;break}}}l||i.push(this.asWrapper(a))}return i},r.prototype.onAssignPortgroupClicked=function(){var e=this.networkSelectorDialogService.createNetworkSelectorDialogSpec(["Network.Assign"]);if(e.isBatchAssignmentRelevant=!1,this.hostItems().length>1){e.isBatchAssignmentRelevant=!0;var t=this.asVnicItem(this._selectedItem).device,i=this.getHostsWithoutVnic(t);e.isBatchAssignmentEnabled=!i.length,e.isBatchAssignmentEnabled?e.applyToAllSingPostMessage=this.i18nService.getString("Common","NetworkSelectorDialog.applyToAll.infoMessage",t):e.applyToAllSingPostMessage=i.length>3?this.i18nService.getString("Common","NetworkSelectorDialog.applyToAll.warnMessageManyHosts",t,i.slice(0,3).join(", ")):this.i18nService.getString("Common","NetworkSelectorDialog.applyToAll.warnMessage",t,i.join(", "))}this.networkSelectorDialogService.openNetworkSelectorDialog(this.$wizardScope.model.dvsId,this.networkSelectorDialogService.createNetworkSelectorFilterSpec(!1,!1,!0,!1,!1),e,this.onNetworkSelectorClosed.bind(this))},r.prototype.onResetChangesClicked=function(){this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE?this.resetChangesForVnic(this._selectedItem):this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.GROUPING_TYPE?this.resetChangesForGroupingItem(this._selectedItem):this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE&&this.resetChangesForHostItem(this._selectedItem),this.updateToolbar(),this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts=this.treeListDataSource.data()},r.prototype.onViewSettingsClicked=function(){var e=this._selectedItem,t=this.treeListDataSource.parentNode(e),i=this.treeListDataSource.parentNode(t);this.vnicSettingsDialogService.show(this.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef),e.device,i.label)},r.prototype.resetChangesForHostItem=function(e){var t=this.treeListDataSource.childNodes(e);if(t&&2===t.length){var i=t[0],r=t[1];this.resetChangesForGroupingItem(i),this.resetChangesForGroupingItem(r)}},r.prototype.resetChangesForGroupingItem=function(e){var t=this,i=this.treeListDataSource.childNodes(e);_.each(i,function(e){t.resetChangesForVnic(e)})},r.prototype.resetChangesForVnic=function(e){if(this.dvsSelectVirtualAdaptersPageService.isVnicModified(e)){var t=e.originalItem,i=e,r=i;r.parentId=t.parentId,r.label=t.label,r.destinationPortgroup=t.destinationPortgroup,r.portgroupRef=t.portgroupRef,this.checkVnicsForConnectivityLoss(this.treeListDataSource.data()),this.treeListDataSource.pushUpdate(r)}},r.prototype.updateToolbar=function(){if(null!==this.treeListWidget){var t=this.treeListWidget.select(),i=this.treeListWidget.dataItem(t);if(this._selectedItem=i,i||_.each(this.actionBarOptions.actions,function(e){e.enabled=!1}),i&&i.type){var r=this.actionBarOptions.actions[0],n=this.actionBarOptions.actions[1],o=this.actionBarOptions.actions[2];r.enabled=i.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE,n.enabled=this.containsModifications(this._selectedItem),o.enabled=i.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE}}},r.prototype.containsModifications=function(t){if(!t)return!1;if(t.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE)return this.dvsSelectVirtualAdaptersPageService.isVnicModified(t);if(t.type===e.DvsAddHostWizardConstants.nicListItemType.GROUPING_TYPE){var i=this.treeListDataSource.childNodes(t);return _.some(i,this.dvsSelectVirtualAdaptersPageService.isVnicModified)}if(t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE){var r=this.treeListDataSource.childNodes(t),n=this.treeListDataSource.childNodes(r[0]),o=this.treeListDataSource.childNodes(r[1]);return _.some(n,this.dvsSelectVirtualAdaptersPageService.isVnicModified)||_.some(o,this.dvsSelectVirtualAdaptersPageService.isVnicModified)}throw new Error("Unknown item type: "+t.type)},r.prototype.requestVirtualAdapters=function(){var t=_.map(this.$wizardScope.model.selectedHosts,function(e){return e.hostRef}),n=new i;n.hosts=t,n.areMemberHosts=this.$wizardScope.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST||this.$wizardScope.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING;var o={propertyParams:[{propertyName:r.VIRTUAL_ADAPTERS_PROPERTY,parameterType:n._type,parameter:n}]};return this.dataService.getProperties(this.$wizardScope.model.dvsId,[r.VIRTUAL_ADAPTERS_PROPERTY],o)},r.prototype.createHostVnicTreeModel=function(e){if(e){var i=e[r.VIRTUAL_ADAPTERS_PROPERTY];null===i&&(i=[]);var n=_.map(i,function(e){var i=e;return i.originalItem=angular.copy(e,new t),i});this.initializeVirtualAdaptersTreeList(n),this.$wizardScope.model.selectVirtualAdaptersPageModel.isInitialized=!0}},r.prototype.initializeVirtualAdaptersTreeList=function(e){this.checkVnicsForConnectivityLoss(e),this.treeListDataSource=new kendo.data.TreeListDataSource({data:e,schema:this.dvsSelectVirtualAdaptersPageService.getTreeListSchema()}),this.treeListDataSource.read(),this.treeListColumns=this.dvsSelectVirtualAdaptersPageService.getColumnDefs(),this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts=this.treeListDataSource.data()},r.prototype.hostItems=function(){return this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts.filter(function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE}).map(function(e){return e})},r.prototype.vnicItems=function(){return this.$wizardScope.model.selectVirtualAdaptersPageModel.hosts.filter(function(t){return t.type===e.DvsAddHostWizardConstants.nicListItemType.VNIC_TYPE}).map(function(e){return e})},r.prototype.asVnicItem=function(e){var t=e;return t},r.prototype.asWrapper=function(e){return e},r.prototype.getHostsWithoutVnic=function(e){var t=this.getVnicItemsWithName(e);return this.hostItems().filter(function(e){return!t.some(function(t){return t.hostRef.value===e.hostRef.value})}).map(function(e){return e.label})},r.prototype.getVnicItemsWithName=function(e){return this.vnicItems().filter(function(t){return t.device===e})},r.VIRTUAL_ADAPTERS_PROPERTY="dvsAddHost:hostVnicData",r.$inject=["$q","$scope","i18nService","dataService","defaultUriSchemeUtil","networkSelectorDialogService","dvsSelectVirtualAdaptersPageService","vnicSettingsDialogService","dvsSelectVirtualAdaptersPageValidator"],r}();angular.module("com.vmware.vsphere.client.dvs").controller("DvsSelectVirtualAdaptersPageController",r)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.addhost.hierarchicalList.DvsAddHostHierarchicalListItem,i=function(){function i(e,t,i,r,n,o,a,s,c){this.$q=e,this.$wizardScope=t,this.i18nService=i,this.dataService=r,this.defaultUriSchemeUtil=n,this.networkSelectorDialogService=o,this.dvsSelectVirtualMachinesPageService=a,this.vmVnicSettingsDialogService=s,this.$timeout=c,this.treeListWidget=null,this.treeListItemExpanded=!1,this.actionBarOptions=this.dvsSelectVirtualMachinesPageService.getActionBarOptions(this.onAssignPortgroupClicked.bind(this),this.onResetChangesClicked.bind(this),this.onViewSettingsClicked.bind(this)),this.$wizardScope.model.selectVirtualMachinesPageModel.isMigrateVirtualMachineNetworkingEnabled?this.loadVmData():this.initializeVirtualMachinesTreeList([]),this.$wizardScope.$on("$destroy",function(){kendo.destroy($(".dvs-add-host-adapters-tree-list"))})}return i.prototype.loadVmData=function(){this.$wizardScope.model.selectVirtualMachinesPageModel.isInitialized?(this.treeListItemExpanded=!0,this.initializeVirtualMachinesTreeList(this.$wizardScope.model.selectVirtualMachinesPageModel.hosts)):(this.initializeVirtualMachinesTreeList([]),this.requestPageData())},i.prototype.hideOrShowListData=function(){this.$wizardScope.model.selectVirtualMachinesPageModel.isMigrateVirtualMachineNetworkingEnabled?this.loadVmData():(this.initializeVirtualMachinesTreeList([]),this.disableAllActions())},i.prototype.requestPageData=function(){var e=this;this.$wizardScope.wizardConfig.loading=!0;var t=this.requestVirtualMachines();t.then(function(t,i){e.createVmVnicTreeModel(t),e.$wizardScope.wizardConfig.loading=!1})},i.prototype.onNetworkSelectorClosed=function(t){var i=this;if(t&&t.length>0){var r=t[0],n=r.name,o=r.networkRef;if(this._selectedItem)if(this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE)this.assignVnic(this._selectedItem,n,o);else if(this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE){var a=this.treeListDataSource.childNodes(this._selectedItem);_.each(a,function(e){i.assignVnic(e,n,o)})}this.updateToolbar(),this.updateReassignedLabels(),this.$wizardScope.model.selectVirtualMachinesPageModel.hosts=this.treeListDataSource.data()}},i.prototype.assignVnic=function(e,t,i){var r=e,n=r;n.destinationPortgroup=t,n.destinationPortgroupRef=i,this.treeListDataSource.pushUpdate(n)},i.prototype.onAssignPortgroupClicked=function(){this.networkSelectorDialogService.openNetworkSelectorDialog(this.$wizardScope.model.dvsId,this.networkSelectorDialogService.createNetworkSelectorFilterSpec(!1,!1,!0,!1,!1),this.networkSelectorDialogService.createNetworkSelectorDialogSpec(["Network.Assign"]),this.onNetworkSelectorClosed.bind(this))},i.prototype.onViewSettingsClicked=function(){var t,i,r=this._selectedItem;if(r.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE){var n=r;i=n.key,t=this.treeListDataSource.parentNode(n)}else{if(r.type!==e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE)throw Error("View settings action is invoked for item different than vm or vm vnic");t=r}this.vmVnicSettingsDialogService.show(t.label,t.vmRef,i)},i.prototype.onResetChangesClicked=function(){this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE?this.resetChangesForVnic(this._selectedItem):this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE?this.resetChangesForVm(this._selectedItem):this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE&&this.resetChangesForHostItem(this._selectedItem),this.updateToolbar(),this.updateReassignedLabels(),this.$wizardScope.model.selectVirtualMachinesPageModel.hosts=this.treeListDataSource.data()},i.prototype.resetChangesForHostItem=function(e){var t=this.treeListDataSource.childNodes(e);t&&t.length>0&&_.each(t,this.resetChangesForVm.bind(this))},i.prototype.resetChangesForVm=function(e){var t=this,i=this.treeListDataSource.childNodes(e);_.each(i,function(e){t.resetChangesForVnic(e)})},i.prototype.resetChangesForVnic=function(e){if(this.dvsSelectVirtualMachinesPageService.isVnicModified(e)){var t=e.originalItem,i=e,r=i;r.destinationPortgroup=t.destinationPortgroup,r.destinationPortgroupRef=t.destinationPortgroupRef,this.treeListDataSource.pushUpdate(r)}},i.prototype.updateReassignedLabelForVm=function(e){var t=this.treeListDataSource.childNodes(e),i=e,r=i;r.isReassigned=_.some(t,this.dvsSelectVirtualMachinesPageService.isVnicModified),this.treeListDataSource.pushUpdate(r)},i.prototype.updateReassignedLabels=function(){var t=this;if(this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE){var i=this.treeListDataSource.parentNode(this._selectedItem);this.updateReassignedLabelForVm(i)}else if(this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE)this.updateReassignedLabelForVm(this._selectedItem);else if(this._selectedItem.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE){var r=this.treeListDataSource.childNodes(this._selectedItem);_.each(r,function(e){t.updateReassignedLabelForVm(e)})}},i.prototype.onTreeListDataBound=function(){var e=this;this.treeListItemExpanded||this.$timeout(function(){!e.treeListItemExpanded&&e.treeListWidget&&(e.treeListItemExpanded=e.dvsSelectVirtualMachinesPageService.expandHostItems(e.treeListWidget,e.treeListDataSource))},0)},i.prototype.disableAllActions=function(){_.each(this.actionBarOptions.actions,function(e){e.enabled=!1})},i.prototype.updateToolbar=function(){if(null!==this.treeListWidget){var t=this.treeListWidget.select(),i=this.treeListWidget.dataItem(t);if(this._selectedItem=i,i||this.disableAllActions(),i&&i.type){var r=this.actionBarOptions.actions[0],n=this.actionBarOptions.actions[1];r.enabled=!i.isOrphaned&&(i.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE||i.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE),n.enabled=!i.isOrphaned&&this.containsModifications(this._selectedItem);var o=this.actionBarOptions.actions[2];o.enabled=i.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE||i.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE}}},i.prototype.containsModifications=function(t){if(!t)return!1;if(t.type===e.DvsAddHostWizardConstants.nicListItemType.VM_VNIC_TYPE)return this.dvsSelectVirtualMachinesPageService.isVnicModified(t);if(t.type===e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE)return this.containsModificationsVm(t);if(t.type===e.DvsAddHostWizardConstants.nicListItemType.HOST_TYPE){var i=this.treeListDataSource.childNodes(t);return _.some(i,this.containsModificationsVm.bind(this))}throw new Error("Unknown item type: "+t.type)},i.prototype.containsModificationsVm=function(t){if(!t||t.type!==e.DvsAddHostWizardConstants.nicListItemType.VM_TYPE)return!1;var i=this.treeListDataSource.childNodes(t);return _.some(i,this.dvsSelectVirtualMachinesPageService.isVnicModified)},i.prototype.requestVirtualMachines=function(){var t=_.pluck(this.$wizardScope.model.selectedHosts,"hostRef"),r="com.vmware.vsphere.client.h5.network.dvs.addhost.model.DvsHostsSpec",n=this.$wizardScope.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MANAGE_HOST||this.$wizardScope.model.selectOperationPageModel.selectedOperationType===e.DvsAddHostWizardConstants.operationType.MIGRATE_NETWORKING,o={propertyParams:[{propertyName:i.VIRTUAL_MACHINES_PROPERTY,parameterType:r,parameter:{_type:r,hosts:t,areMemberHosts:n}}]},a=this.dataService.getProperties(this.$wizardScope.model.dvsId,[i.VIRTUAL_MACHINES_PROPERTY],o);return a},i.prototype.createVmVnicTreeModel=function(e){if(e){var r=e[i.VIRTUAL_MACHINES_PROPERTY];null===r&&(r=[]);var n=_.map(r,function(e){var i=e;return i.originalItem=angular.copy(e,new t),i});this.initializeVirtualMachinesTreeList(n),this.$wizardScope.model.selectVirtualMachinesPageModel.isInitialized=!0}},i.prototype.initializeVirtualMachinesTreeList=function(e){this.treeListDataSource=new kendo.data.TreeListDataSource({data:e,schema:this.dvsSelectVirtualMachinesPageService.getTreeListSchema()}),this.treeListDataSource.read(),this.treeListColumns=this.dvsSelectVirtualMachinesPageService.getColumnDefs(),e.length>0&&(this.$wizardScope.model.selectVirtualMachinesPageModel.hosts=this.treeListDataSource.data()),this.updateWarningState()},i.prototype.updateWarningState=function(){this.$wizardScope.model.selectVirtualMachinesPageModel.hosts&&this.$wizardScope.model.selectVirtualMachinesPageModel.isMigrateVirtualMachineNetworkingEnabled&&(this.showWarning=_.some(this.$wizardScope.model.selectVirtualMachinesPageModel.hosts,function(e){return e.showWarning}))},i.$inject=["$q","$scope","i18nService","dataService","defaultUriSchemeUtil","networkSelectorDialogService","dvsSelectVirtualMachinesPageService","vmVnicSettingsDialogService","$timeout"],i.VIRTUAL_MACHINES_PROPERTY="dvsAddHost:hostVmData",i}();angular.module("com.vmware.vsphere.client.dvs").controller("DvsSelectVirtualMachinesPageController",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={feature:"<",objectId:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/common/component/dvsOverviewPageComponentTemplate.html"}return e}();e.DvsOverviewPageComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$scope=t,this.dvsUpgradeWizardConstants=i,this.$sce=r,this.exportDvsDialogService=n}return e.prototype.$onInit=function(){var e=this;switch(this.feature){case this.dvsUpgradeWizardConstants.features.LACP:this.featureHeading=this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.overview.changesHeading"),this.featureContent=this.$sce.trustAsHtml(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.overview.changesContent")),this.warningHint=this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.backup.hint"),this.exportLabel=this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.backup.name"),this.exportDvsLinkClicked=function(){e.exportDvsDialogService.show(e.objectId)};break;case this.dvsUpgradeWizardConstants.features.NIOC:this.featureHeading=this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.overview.changesHeading"),this.featureContent=this.$sce.trustAsHtml(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.overview.changesContent"))}},e.$inject=["i18nService","$scope","dvsUpgradeWizardConstants","$sce","exportDvsDialogService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsOverviewPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={prerequisitesValidationData:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/common/component/dvsPrerequisitesPageComponentTemplate.html"}return e}();e.DvsPrerequisitesPageComponent=t;var i=function(){function e(e,t,i,r,n){this.vuiConstants=e,this.i18nService=t,this.columnRenderersRegistry=i,this.dvsPrerequisitesValidationService=r,this.dvsUpgradeLacpWizardConstants=n,this.gridDescription=this.i18nService.getString("DvsUi","PrerequisitesPage.description"),this.datagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.buildColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,data:[],actionBarOptions:{actions:[]},onChange:this.onSelectionChange.bind(this)},this.prerequisiteCheckDetailsHeader=this.i18nService.getString("DvsUi","PrerequisitesPage.validationDetails")}return e.prototype.$onInit=function(){this.setOverallValidationStatus(),this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{size:"65%",min:"120px"
},{size:"35%",min:"50px"}]},this.iconTextRenderer=this.columnRenderersRegistry.getColumnRenderer("icon-text")},e.prototype.$onChanges=function(){this.datagridOptions.data=this.prerequisitesValidationData?this.prerequisitesValidationData:[]},e.prototype.setOverallValidationStatus=function(){this.prerequisiteCheckDetails=this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.label"),this.overallCheckStatus=this.dvsPrerequisitesValidationService.getPrerequisitesOverallStatus(this.prerequisitesValidationData),this.showOverallStatusWarning=this.overallCheckStatus===this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.warn"),this.showOverallStatusFail=this.overallCheckStatus===this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.fail"),this.checkAffectedEntities=[],this.showOverallStatus=!0},e.prototype.buildColumnDefinitions=function(){var e=this;return[{displayName:this.i18nService.getString("DvsUi","PrerequisitesPage.checkNameColumn"),field:"checkName",width:"310px"},{displayName:this.i18nService.getString("DvsUi","PrerequisitesPage.checkResultColumn"),width:"100%",template:function(t){var i;switch(t.type){case e.dvsUpgradeLacpWizardConstants.validationResult.FAIL:return i=e.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.fail"),"<span><clr-icon shape='error' size='24' class='is-error dvs-upgrade-prerequisites-error'></clr-icon>"+("<span class='vertical-align-cell'>"+i+"</span></span>");case e.dvsUpgradeLacpWizardConstants.validationResult.WARNING:return i=e.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.warn"),"<span><span class='vsphere-icon-status-warning'></span>"+("<span class='vertical-align-cell'>"+i+"</span></span>");default:return i=e.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.pass"),"<span><span class='vsphere-icon-status-ok'></span>"+("<span class='vertical-align-cell'>"+i+"</span></span>")}}}]},e.prototype.onSelectionChange=function(e){if(e&&e.length>0){var t=e[0];this.prerequisiteCheckDetails=t.message,this.checkAffectedEntities=t.affectedEntities,this.showOverallStatus=!1}else this.setOverallValidationStatus()},e.$inject=["vuiConstants","i18nService","columnRenderersRegistry","dvsPrerequisitesValidationService","dvsUpgradeLacpWizardConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPrerequisitesPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/common/component/dvsVersionPageComponentTemplate.html"}return e}();e.DvsVersionPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.$scope=t,this.wizardConstants=i,this.esxVersionByDvs={"5.0.0":"5.0","5.1.0":"5.1","5.5.0":"5.5","6.0.0":"6.0","6.5.0":"6.5","6.6.0":"6.7"},this.$scope.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){var e=this;this.$scope.$watch("$ctrl.wizardModel.supportedVersions",function(){e.initComponent()}),this.initComponent()},e.prototype.initComponent=function(){var e=this;this.versions=_.map(this.wizardModel.supportedVersions,function(t){return{dvs:t,esx:e.esxVersionByDvs[t]}}),this.initDescriptions(),this.buildSignpostItems()},e.prototype.getVersionDescriptions=function(e){return this._descriptionsByVersion[e]||this._descriptionsByVersion[this.wizardConstants.versions._unknown]},e.prototype.initDescriptions=function(){this._descriptionsByVersion={},this._descriptionsByVersion[this.wizardConstants.versions._66]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.6_6_0")],this._descriptionsByVersion[this.wizardConstants.versions._65]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.6_5_0")],this._descriptionsByVersion[this.wizardConstants.versions._60]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.6_0_0.nioc"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.6_0_0.igmp")],this._descriptionsByVersion[this.wizardConstants.versions._55]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_5_0.filtering"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_5_0.lacp")],this._descriptionsByVersion[this.wizardConstants.versions._51]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_1_0.rollback"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_1_0.healthcheck"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_1_0.portmirroring"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_1_0.lacp")],this._descriptionsByVersion[this.wizardConstants.versions._50]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_0_0.nioc"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_0_0.netflow"),this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.5_0_0.portmirroring")],this._descriptionsByVersion[this.wizardConstants.versions._unknown]=[this.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.unknown")]},e.prototype.buildSignpostItems=function(){var e=this,t="";_.forEach(this.wizardModel.supportedVersions,function(i){var r="<b>%title%</b><br/>".replace("%title%",e.i18nService.getString("DvsUi","DvsVersionPage.supportedVersion.descriptionItem.tltleTemplate",i)),n="",o=e.getVersionDescriptions(i);_.forEach(o,function(e){var t="<div class='horizontal-flex-container'><span class='new-dvs-version-description-bullet'></span><span class='new-dvs-version-description-item'>%description%</span><br/></div>";n+=t.replace("%description%",e)});var a=r+n,s="<div data-test-id='dvs-version-section-%version%'>%content%<br/></div>";t+=s.replace("%version%",i).replace("%content%",a)}),this.signPostConfig={message:"<div class='new-dvs-version-signpost-content'>%content%</div>".replace("%content%",t)}},e.$inject=["i18nService","$scope","dvsVersionPageConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsVersionPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvsVersionPageConstants",{versions:{_66:"6.6.0",_65:"6.5.0",_60:"6.0.0",_55:"5.5.0",_51:"5.1.0",_50:"5.0.0",_unknown:"unknown"}})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.wizardConstants=e,this.i18nService=t}return e.prototype.getPrerequisitesOverallStatus=function(e){var t=this;if(!e||0===e.length)return this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.pass");var i=_.find(e,function(e){return e.type===t.wizardConstants.validationResult.FAIL});if(void 0!==i)return this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.fail");var r=_.find(e,function(e){return e.type===t.wizardConstants.validationResult.WARNING});return void 0!==r?this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.warn"):this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.pass")},e.$inject=["dvsUpgradeLacpWizardConstants","i18nService"],e}();e.DvsPrerequisitesValidationService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPrerequisitesValidationService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.mutationService=t}return e.prototype.getNameError=function(t){var i=t.trim(),r=i.replace(/%/g,"%25").replace(/\//g,"%2f").replace(/\\/g,"%5c");return 0===r.length?this.i18nService.getString("DvsUi","DvsName.validation.noDvsName"):r.length>e.NAME_MAX_LENGTH?this.i18nService.getString("DvsUi","DvsName.validation.tooLongDvsName"):null},e.prototype.getNameServerError=function(e,t){return this.mutationService.validate(e,"com.vmware.vsphere.client.h5.network.dvs.editsettings.model.DvsNameSpec",{_type:"com.vmware.vsphere.client.h5.network.dvs.editsettings.model.DvsNameSpec",name:t.trim()}).then(function(e){return e.error&&e.error.localizedMessage?e.error.localizedMessage:e.result?e.result:null},function(){return null})},e.prototype.getNumberOfUplinksError=function(e,t){void 0===t&&(t=32);var i=null!==e&&void 0!==e&&new RegExp("^[0-9]+$").test(e.toString());return e<1||"number"!=typeof e||!i?this.i18nService.getString("DvsUi","DvsEditSettingsDialog.generalPage.numUplinks.error.min"):e>t?this.i18nService.getString("DvsUi","DvsEditSettingsDialog.generalPage.numUplinks.error.max",t):null},e.$inject=["i18nService","mutationService"],e.NAME_MAX_LENGTH=80,e}();e.DvsCommonPropertiesValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsCommonPropertiesValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.$q=t,this.dvsPrerequisitesValidationService=i,this.clarityModalService=r}return e.prototype.getValidationResult=function(e,t){var i=this.dvsPrerequisitesValidationService.getPrerequisitesOverallStatus(e);return i===this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.fail")?this.$q.resolve([this.i18nService.getString("DvsUi","PrerequisitesPage.unmetPrerequisites")]):this.$q.resolve(this.showValidationWarning(e,t))},e.prototype.showValidationWarning=function(e,t){if(t.prerequisiteWarningShown)return[];var i=this.dvsPrerequisitesValidationService.getPrerequisitesOverallStatus(e);if(i===this.i18nService.getString("DvsUi","PrerequisitesPage.overallStatus.warn")){var r=this.$q.defer(),n={size:"md",title:this.i18nService.getString("DvsUi","PrerequisitesPage.confirmation.title"),defaultButton:"submit",modalClass:"dvs-upgrade-warning-modal",alerts:[],dialogData:{message:this.i18nService.getString("DvsUi","PrerequisitesPage.confirmation.text")},contentTemplate:"dvs-ui/resources/dvs/common/component/dvsUpgradeWarningDialog.html",preserveNewlines:!0,clarityIcon:{shape:"warning","class":"is-warning",size:32},onSubmit:function(){return r.resolve(!0),t.prerequisiteWarningShown=!0,!0},onCancel:function(){r.resolve(!1)}};return this.clarityModalService.openOkCancelModal(n),r.promise.then(function(e){return e})}return[]},e.$inject=["i18nService","$q","dvsPrerequisitesValidationService","clarityModalService"],e}();e.DvsPrerequisitesPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPrerequisitesPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvsCreateWizardConstants",{page:{DVS_SELECT_NAME_AND_LOCATION_PAGE:"selectNameAndLocationPage",DVS_SELECT_VERSION_PAGE:"selectVersionPage",DVS_CONFIGURE_SETTINGS_PAGE:"configureSettingsPage",DVS_READY_TO_COMPLETE_PAGE:"readyToCompletePage"},properties:{DVS_NEW_UNIQUE_NAME:"newUniqueDvsName",DVPG_NEW_UNIQUE_NAME:"newUniquePortGroupName",PRIMARY_ICON_ID:"primaryIconId",LOCATION_NAME_PROPERTY:"name",SUPPORTED_PRODUCT_SPEC:"supportedProductSpec"},spec:{DVS_CREATE_WIZARD_MUTATION_SPEC:"com.vmware.vsphere.client.h5.network.dvs.create.model.DvsCreateWizardMutationSpec",DVS_CREATE_SPEC:"com.vmware.vim.binding.vim.DistributedVirtualSwitch$CreateSpec",DVS_CONFIG_SPEC:"com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$ConfigSpec",DVS_PRODUCT_SPEC:"com.vmware.vim.binding.vim.dvs.ProductSpec",DVS_UPLINK_PORT_POLICY:"com.vmware.vim.binding.vim.DistributedVirtualSwitch$NameArrayUplinkPortPolicy"},niocVersions:{na:null,_2:"version2",_3:"version3"},lacpVersions:{na:null,singleLag:"singleLag",multipleLag:"multipleLag"},defaultUplinkName:"Uplink "})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.dvsCreateWizardConstants=t,this.simpleValidationCommit=i,this.validator=r,this.dvpgPropertiesService=n}return e.prototype.createPages=function(e){var t=this,i={id:this.dvsCreateWizardConstants.page.DVS_SELECT_NAME_AND_LOCATION_PAGE,title:this.i18nService.getString("DvsUi","DvsNameAndLocationPage.title"),description:this.i18nService.getString("DvsUi","DvsNameAndLocationPage.description"),contentUrl:"dvs-ui/resources/dvs/create/views/dvsNameAndLocationPage.html",onCommit:this.simpleValidationCommit(function(){var i=t.validator.getNameError(e.model.uniqueDvsName);return i?[i]:t.validator.getNameServerError(e.model.parentEntityUrn,e.model.uniqueDvsName).then(function(e){return e?[e]:[]})},e.wizardConfig),validationParams:["model.uniqueDvsName"]},r={id:this.dvsCreateWizardConstants.page.DVS_SELECT_VERSION_PAGE,title:this.i18nService.getString("DvsUi","DvsVersionPage.title"),description:this.i18nService.getString("DvsUi","DvsVersionPage.description"),contentUrl:"dvs-ui/resources/dvs/create/views/dvsVersionPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.selectedVersion"]},n={id:this.dvsCreateWizardConstants.page.DVS_CONFIGURE_SETTINGS_PAGE,title:this.i18nService.getString("DvsUi","DvsConfigureSettingsPage.title"),description:this.i18nService.getString("DvsUi","DvsConfigureSettingsPage.description"),contentUrl:"dvs-ui/resources/dvs/create/views/dvsConfigureSettingsPage.html",onCommit:this.simpleValidationCommit(function(){var i=[],r=t.validator.getNumberOfUplinksError(e.model.numberOfUplinks);if(r&&i.push(r),e.model.createDefaultPortgroup){var n=t.dvpgPropertiesService.getInvalidNameError(e.model.defaultPortgroupName);n&&i.push(n)}return i.length>0?i:e.model.createDefaultPortgroup?t.dvpgPropertiesService.getDuplicateOrTooLongNameError(e.model.parentEntityUrn,e.model.defaultPortgroupName).then(function(e){return e}):[]},e.wizardConfig),validationParams:["model.numberOfUplinks","model.createDefaultPortgroup","model.defaultPortgroupName"]},o={id:this.dvsCreateWizardConstants.page.DVS_READY_TO_COMPLETE_PAGE,title:this.i18nService.getString("DvsUi","DvsReadyToCompletePage.title"),description:this.i18nService.getString("DvsUi","DvsReadyToCompletePage.description"),contentUrl:"dvs-ui/resources/dvs/create/views/dvsReadyToCompletePage.html",onCommit:function(){return!0},validationParams:[]};return[i,r,n,o]},e.$inject=["i18nService","dvsCreateWizardConstants","simpleValidationCommit","dvsCommonPropertiesValidator","dvpgPropertiesService"],e}();e.DvsCreateWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsCreateWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.pageStateManagementService=r,this.mutationService=n,this.wizardConstants=o,this.dvsCreateWizardPages=a,this.dataService=s,this.wizardValidationService=c,this.defaultUriSchemeUtil=l}return t.prototype.show=function(t){var i=this,r=this.$rootScope.$new();r.model=new e.DvsCreateWizardModel,r.model.parentEntityUrn=t,r.wizardConfig={title:this.i18nService.getString("DvsUi","actionCreateDvsTitle"),loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),onFinish:function(){var e={parentEntityMor:i.defaultUriSchemeUtil.getManagedObjectReference(r.model.parentEntityUrn),uniqueDvsName:r.model.uniqueDvsName,selectedVersion:r.model.selectedVersion,numberOfUplinks:r.model.numberOfUplinks,niocEnabled:r.model.niocEnabled,createDefaultPortgroup:r.model.createDefaultPortgroup,defaultPortgroupName:r.model.defaultPortgroupName};return i.mutationService.add(i.wizardConstants.spec.DVS_CREATE_WIZARD_MUTATION_SPEC,e),!0},configureSettingsPageInitialized:!1},r.wizardConfig.pages=this.dvsCreateWizardPages.createPages(r),this.wizardValidationService.initWizardValidation(r),this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(r),this.vuiWizardService({scope:r,configObjectName:"wizardConfig"}).show(),this.requestProperties(r)},t.prototype.requestProperties=function(e){var t=this;e.wizardConfig.loading=!0,this.dataService.getProperties(e.model.parentEntityUrn,[this.wizardConstants.properties.DVS_NEW_UNIQUE_NAME,this.wizardConstants.properties.LOCATION_NAME_PROPERTY,this.wizardConstants.properties.PRIMARY_ICON_ID,this.wizardConstants.properties.SUPPORTED_PRODUCT_SPEC]).then(function(i){e.model.uniqueDvsName=i[t.wizardConstants.properties.DVS_NEW_UNIQUE_NAME],e.model.parentEntityName=i[t.wizardConstants.properties.LOCATION_NAME_PROPERTY],e.model.parentEntityIcon=i[t.wizardConstants.properties.PRIMARY_ICON_ID],e.model.supportedVersions=_.map(i[t.wizardConstants.properties.SUPPORTED_PRODUCT_SPEC],function(e){return e.version}).sort(function(e,t){return e<t?1:t<e?-1:0}),e.model.supportedVersions&&e.model.supportedVersions.length>0&&(e.model.selectedVersion=e.model.supportedVersions[0]),e.model.numberOfUplinks=4,e.model.niocEnabled=!0,e.model.createDefaultPortgroup=!0,e.wizardConfig.loading=!1})},t.$inject=["$rootScope","i18nService","vuiWizardService","pageStateManagementService","mutationService","dvsCreateWizardConstants","dvsCreateWizardPages","dataService","wizardValidationService","defaultUriSchemeUtil"],t}();e.DvsCreateWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsCreateWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvsCreateWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<",wizardConfig:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/create/views/dvsConfigureSettingsPageComponentTemplate.html"}return e}();e.DvsConfigureSettingsPageComponent=t;var i=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.$scope=t,this.validator=i,this.dataService=r,this.wizardConstants=n,this.dvpgPropertiesService=o,t.i18n=this.i18nService.getString,this._numUplinksValidator={message:null,isVisible:!1},this._portgroupNameValidator={message:null,isVisible:!1},this._niocStatusOptions=[{label:this.i18nService.getString("DvsUi","DvsConfigureSettingsPage.resmgmt.enabled"),value:!0},{label:this.i18nService.getString("DvsUi","DvsConfigureSettingsPage.resmgmt.disabled"),value:!1}]}return e.prototype.$onInit=function(){this.wizardConfig.configureSettingsPageInitialized?(this.onNumUplinksChange(),this.wizardModel.createDefaultPortgroup&&this.onPortgroupNameChange()):(this.wizardConfig.loading=!0,this.requestUniquePortgroupName())},Object.defineProperty(e.prototype,"numUplinksValidator",{get:function(){return this._numUplinksValidator},enumerable:!0,configurable:!0}),e.prototype.onNumUplinksChange=function(){var e=this.validator.getNumberOfUplinksError(this.wizardModel.numberOfUplinks);this.numUplinksValidator.message=e,this.numUplinksValidator.isVisible=null!==e},Object.defineProperty(e.prototype,"portgroupNameValidator",{get:function(){return this._portgroupNameValidator},enumerable:!0,configurable:!0}),e.prototype.onPortgroupNameChange=function(){var e=this.dvpgPropertiesService.getInvalidNameError(this.wizardModel.defaultPortgroupName);this.portgroupNameValidator.message=e,this.portgroupNameValidator.isVisible=null!==e},e.prototype.onCreatePortGroupCheckBoxChange=function(){this.wizardModel.createDefaultPortgroup?this.onPortgroupNameChange():(this.portgroupNameValidator.message=null,this.portgroupNameValidator.isVisible=!1)},Object.defineProperty(e.prototype,"niocStatusOptions",{get:function(){return this._niocStatusOptions},enumerable:!0,configurable:!0}),e.prototype.requestUniquePortgroupName=function(){var e=this;this.dataService.getProperties(this.wizardModel.parentEntityUrn,[this.wizardConstants.properties.DVPG_NEW_UNIQUE_NAME]).then(function(t){e.wizardModel.defaultPortgroupName=t[e.wizardConstants.properties.DVPG_NEW_UNIQUE_NAME],e.wizardConfig.loading=!1,e.wizardConfig.configureSettingsPageInitialized=!0})},e.$inject=["i18nService","$scope","dvsCommonPropertiesValidator","dataService","dvsCreateWizardConstants","dvpgPropertiesService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsConfigureSettingsPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/create/views/dvsNameAndLocationPageComponentTemplate.html"}return e}();e.DvsNameAndLocationPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.$scope=t,this.validator=i,t.i18n=this.i18nService.getString,this._nameValidator={message:null,isVisible:!1}}return Object.defineProperty(e.prototype,"nameValidator",{get:function(){return this._nameValidator},enumerable:!0,configurable:!0}),e.prototype.onNameChange=function(){var e=this.validator.getNameError(this.wizardModel.uniqueDvsName);this.nameValidator.message=e,this.nameValidator.isVisible=null!==e},e.$inject=["i18nService","$scope","dvsCommonPropertiesValidator"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsNameAndLocationPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<",wizardConfig:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/create/views/dvsReadyToCompletePageComponentTemplate.html"}return e}();e.DvsReadyToCompletePageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.$scope=t,this.vxPropertyViewService=i,this.$scope.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.wizardConfig.loading=!0,this.buildPropertyView(),this.wizardConfig.loading=!1},e.prototype.buildPropertyView=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general"),i=t.section("generalSection");i.property(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.dvsName"),this.wizardModel.uniqueDvsName),i.property(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.dvsVersion"),this.wizardModel.selectedVersion),i.property(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.numberOfUplinks"),this.wizardModel.numberOfUplinks);var r=this.wizardModel.niocEnabled?this.i18nService.getString("DvsUi","DvsConfigureSettingsPage.resmgmt.enabled"):this.i18nService.getString("DvsUi","DvsConfigureSettingsPage.resmgmt.disabled");i.property(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.niocStatus"),r),this.wizardModel.createDefaultPortgroup&&i.property(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.defaultPortgroup"),this.wizardModel.defaultPortgroupName);var n=t.section("suggestedActionsSection").title(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.section.nextActions.title")),o=n.propertyBuilder().keyBuilder();o.text(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.newPortgroup")),o.icon("vsphere-icon-virtual-port-group");var a=n.propertyBuilder().keyBuilder();a.text(this.i18nService.getString("DvsUi","DvsReadyToCompletePage.property.addAndManageHosts")),a.icon("non-clarity-icon k-sprite network-lib-ui-icon-dvsManageHost"),this._propertyViewData=e.build()},Object.defineProperty(e.prototype,"propertyViewData",{get:function(){return this._propertyViewData},enumerable:!0,configurable:!0}),e.$inject=["i18nService","$scope","vxPropertyViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsReadyToCompletePage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",hasPolicyPrivilege:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgAdvancedPageTemplate.html"}return e}();e.DvpgAdvancedPageComponent=t;var i=function(){function e(e){this.i18nService=e,this.i18n=this.i18nService.getString,this.options=[{value:!0,label:this.i18n("NetworkUi","dvpg.properties.resetAtDisconnect.on")},{value:!1,label:this.i18n("NetworkUi","dvpg.properties.resetAtDisconnect.off")}],this.supportedPolicies={}}return e.prototype.$onInit=function(){var e=this;_.each(this.model,function(t,i){null!==t&&"undefined"!=typeof t&&(e.supportedPolicies[i]=!0)})},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgAdvancedPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",failoverOrderOptions:"<",overrideOptions:"<?",overrideEnabled:"<?",overrideDisallowed:"<?"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgFailoverPolicyPageTemplate.html"}return e}();e.DvpgFailoverPolicyPageComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.$scope=t,this.dvpgFailoverPolicyPageService=i,this.networkUiConstants=r,this.i18n=this.i18nService.getString,this.loadBalancingOptions=[]}return e.prototype.$onInit=function(){var e=this;this.onFailoverOrderChange=this.updateFailoverOrder.bind(this),this.model.loadBalancingModes&&this.model.loadBalancingModes.length>0&&this.model.loadBalancingModes.forEach(function(t){var i={label:e.dvpgFailoverPolicyPageService.getNicTeamingModeLabel(t),val:t};e.loadBalancingOptions.push(i)}),this.failoverOrderHeaderOptions={title:this.i18n("NetworkUi","dvpg.policy.failover.page.order.label")},this.hasLoadBalancingWarningMessage=function(){return e.dvpgFailoverPolicyPageService.hasLoadBalancingWarningMessage(e.failoverOrderOptions.connectees.active,e.failoverOrderOptions.connectees.standby,e.model.loadBalancing,e.model.beaconProbing,!1,e.overrideOptions)},this.beaconProbingOptions=[{label:this.i18n("NetworkUi","dvpg.policy.failover.detection.beaconProbing"),val:!0},{label:this.i18n("NetworkUi","dvpg.policy.failover.detection.linkStatus"),val:!1}],this.notifySwitchesOptions=[{label:this.i18n("NetworkUi","dvpg.policy.failover.notify.off"),val:!1},{label:this.i18n("NetworkUi","dvpg.policy.failover.notify.on"),val:!0}],this.rollingOrderOptions=[{label:this.i18n("NetworkUi","dvpg.policy.failover.failback.off"),val:!0},{label:this.i18n("NetworkUi","dvpg.policy.failover.failback.on"),val:!1}],this.failoverOrderActions=[this.networkUiConstants.failoverOrderActions.MOVE_UP,this.networkUiConstants.failoverOrderActions.MOVE_DOWN],this.signPostConfig={message:null,title:this.i18n("NetworkUi","dvpg.policy.failover.lb.loadbalance_ip.popup.title"),"class":"edit-dv-pg-signpost"}},e.prototype.updateFailoverOrder=function(){var e=this.dvpgFailoverPolicyPageService.hasFailoverOrderChanged(this.failoverOrderOptions,this.model.failoverOrder.activeUplinkPortNames,this.model.failoverOrder.standbyUplinkPortNames);e&&(this.model.failoverOrder.activeUplinkPortNames=this.failoverOrderOptions.connectees.active.slice(),this.model.failoverOrder.standbyUplinkPortNames=this.failoverOrderOptions.connectees.standby.slice(),this.model.failoverOrder.unusedUplinkPortNames=this.failoverOrderOptions.connectees.unused.slice()),this.getLoadBalancingMessages()},e.prototype.getLoadBalancingMessages=function(){this.signPostConfig.message=null;var e=this.dvpgFailoverPolicyPageService.getLoadBalancingMessages(this.failoverOrderOptions.connectees,this.model.loadBalancing,this.model.beaconProbing,this.overrideOptions);this.signPostConfig.message=e?e.join(" "):null,this.signPostIconShape=this.hasLoadBalancingWarningMessage()?"exclamation-triangle":"info-circle"},e.$inject=["i18nService","$scope","dvpgFailoverPolicyPageService","networkUiConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgFailoverPolicyPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",overrideOptions:"<?",overrideEnabled:"<?",overrideDisallowed:"<?"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgMiscPageTemplate.html"}return e}();e.DvpgMiscPageComponent=t;var i=function(){function e(e){this.i18nService=e}return e.prototype.$onInit=function(){this.options=[{value:!0,label:this.i18nService.getString("DvsUi","dvpg.policy.misc.block.on")},{value:!1,label:this.i18nService.getString("DvsUi","dvpg.policy.misc.block.off")}],this.blockPortLabel=this.overrideEnabled?this.i18nService.getString("NetworkUi","port.policy.misc.block.label"):this.i18nService.getString("DvsUi","dvpg.manage.policy.misc.block"),this.blockPortWarning=this.overrideEnabled?this.i18nService.getString("NetworkUi","port.policy.misc.block.warning"):this.i18nService.getString("DvsUi","dvpg.policy.misc.block.warning")},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgMiscPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",overrideOptions:"<?",overrideEnabled:"<?",overrideDisallowed:"<?"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgMonitoringPageTemplate.html"}return e}();e.DvpgMonitoringPageComponent=t;var i=function(){function e(e){this.i18nService=e,this.options=[{value:!0,label:this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.status.on")},{value:!1,label:this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.status.off")}]}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgMonitoringPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",overrideOptions:"<?",overrideEnabled:"<?",overrideDisallowed:"<?"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgSecurityPolicyPageTemplate.html"}return e}();e.DvpgSecurityPolicyPageComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.$scope=t,this.i18n=this.i18nService.getString,this.securityPolicyOptions=[{label:this.i18n("NetworkUi","dvpg.policy.security.accept"),val:!0},{label:this.i18n("NetworkUi","dvpg.policy.security.reject"),val:!1}]}return e.$inject=["i18nService","$scope"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgSecurityPolicyPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",overrideOptions:"<?",overrideEnabled:"<?",overrideDisallowed:"<?"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgTrafficShapingPageTemplate.html"}return e}();e.DvpgTrafficShapingPageComponent=t;var i=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.networkUiConstants=i,this.trafficShapingPolicyValidator=r,this.i18n=t.getString,this.attributeNames=[i.TrafficShapingSetting.AVERAGE_BANDWIDTH,i.TrafficShapingSetting.PEAK_BANDWIDTH,i.TrafficShapingSetting.BURST_SIZE],this.initPage()}return e.prototype.onIngressStatusChange=function(){var e=this;_.forEach(this.attributeNames,function(t){e.onIngressTrafficShapingChange(t)})},e.prototype.onEgressStatusChange=function(){var e=this;_.forEach(this.attributeNames,function(t){e.onEgressTrafficShapingChange(t)})},e.prototype.onIngressTrafficShapingChange=function(e){var t=this.model.inShapingPolicy[e],i=this.trafficShapingPolicyValidator.getTrafficShapingErrorMessage(t,e);this.validators.ingress[e].message=i,this.validators.ingress[e].isVisible=this.model.inShapingPolicy.enabled&&null!==i},e.prototype.onEgressTrafficShapingChange=function(e){var t=this.model.outShapingPolicy[e],i=this.trafficShapingPolicyValidator.getTrafficShapingErrorMessage(t,e);this.validators.egress[e].message=i,this.validators.egress[e].isVisible=this.model.outShapingPolicy.enabled&&null!==i},e.prototype.initPage=function(){this.validators=this.buildInputValidators(),this.statusPolicyOptions=this.buildStatusPolicyOptions()},e.prototype.buildInputValidators=function(){return{ingress:{averageBandwidth:this.buildDefaultValidator(),peakBandwidth:this.buildDefaultValidator(),burstSize:this.buildDefaultValidator()},egress:{averageBandwidth:this.buildDefaultValidator(),peakBandwidth:this.buildDefaultValidator(),burstSize:this.buildDefaultValidator()}}},e.prototype.buildDefaultValidator=function(){return{message:null,isVisible:!1}},e.prototype.buildStatusPolicyOptions=function(){return[{label:this.i18nService.getString("NetworkUi","dvpg.policy.shaping.status.on"),val:!0},{label:this.i18nService.getString("NetworkUi","dvpg.policy.shaping.status.off"),
val:!1}]},e.$inject=["$scope","i18nService","networkUiConstants","trafficShapingPolicyValidator"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgTrafficShapingPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",overrideOptions:"<?",overrideEnabled:"<?",overrideDisallowed:"<?"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/common/components/dvpgVlanPageTemplate.html"}return e}();e.DvpgVlanPageComponent=t;var i=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.networkUiConstants=i,this.dvpgPropertiesService=r,this.vlanIdValidator={},this.i18n=t.getString}return e.prototype.$onInit=function(){this.initPage()},e.prototype.onVlanTypeChange=function(){var e=this.model.vlanType;e===this.networkUiConstants.Vlan.Type.VLAN?(this.model.vlanId=this.networkUiConstants.Vlan.Id.MIN,this.setVlanIdValidator()):e===this.networkUiConstants.Vlan.Type.PRIVATE?this.model.pvlanConfig&&this.model.pvlanConfig.length>0&&(this.model.pvlanId=this.model.pvlanConfig[0].secondaryVlanId):e===this.networkUiConstants.Vlan.Type.TRUNK&&(this.model.vlanTrunkRanges=this.networkUiConstants.Vlan.DEFAULT_VLAN_TRUNK_RANGE)},e.prototype.initPage=function(){this.vlanTypeOptions=[{label:this.i18n("NetworkUi","dvpg.policy.vlan.type.none"),val:this.networkUiConstants.Vlan.Type.NONE},{label:this.i18n("NetworkUi","dvpg.policy.vlan.type.vlan"),val:this.networkUiConstants.Vlan.Type.VLAN},{label:this.i18n("NetworkUi","dvpg.policy.vlan.type.trunk"),val:this.networkUiConstants.Vlan.Type.TRUNK},{label:this.i18n("NetworkUi","dvpg.policy.vlan.type.private"),val:this.networkUiConstants.Vlan.Type.PRIVATE}],this.pvlanTypeOptions=this.buildPvlanOptions(),this.isPvlanAllowed=this.model.pvlanConfig&&this.model.pvlanConfig.length>0},e.prototype.setVlanIdValidator=function(){var e=this.dvpgPropertiesService.getVlanIdError(this.model.vlanId);this.vlanIdValidator.message=e,this.vlanIdValidator.isVisible=null!==e},e.prototype.buildPvlanOptions=function(){var e=this,t=[];return this.model.pvlanConfig?(this.model.pvlanConfig.forEach(function(i){var r=e.getPvlanTypeLabel(i.pvlanType);t.push({label:e.i18n("DvsUi","dvpg.policy.vlan.displayFormat",r,i.primaryVlanId,i.secondaryVlanId),val:i.secondaryVlanId})}),t):t},e.prototype.getPvlanTypeLabel=function(e){switch(e){case this.networkUiConstants.Vlan.PvlanType.ISOLATED:return this.i18n("DvsUi","dvpg.policy.vlan.private.type.isolated");case this.networkUiConstants.Vlan.PvlanType.PROMISCUOUS:return this.i18n("DvsUi","dvpg.policy.vlan.private.type.promiscuous");case this.networkUiConstants.Vlan.PvlanType.COMMUNITY:return this.i18n("DvsUi","dvpg.policy.vlan.private.type.community");default:return""}},e.$inject=["$scope","i18nService","networkUiConstants","dvpgPropertiesService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgVlanPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.networkUtil=e,this.networkUiConstants=t,this.clarityModalService=i,this.$q=r}return e.prototype.hasFailoverOrderChanged=function(e,t,i){if(e.connectees.active.length!==t.length||e.connectees.standby.length!==i.length)return!0;var r=void 0;for(r=0;r<e.connectees.active.length;r++)if(e.connectees.active[r]!==t[r])return!0;for(r=0;r<e.connectees.standby.length;r++)if(e.connectees.standby[r]!==i[r])return!0;return!1},e.prototype.getNicTeamingModeLabel=function(e){switch(e){case this.networkUiConstants.LoadBalancingPolicy.IP:return this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip");case this.networkUiConstants.LoadBalancingPolicy.EXPLICIT:return this.networkUtil.getString("dvpg.policy.failover.lb.failover_explicit");case this.networkUiConstants.LoadBalancingPolicy.LOADBASED:return this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_loadbased");case this.networkUiConstants.LoadBalancingPolicy.SRCID:return this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_srcid");case this.networkUiConstants.LoadBalancingPolicy.SRCMAC:return this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_srcmac");default:return""}},e.prototype.createFailoverOrderSettings=function(e){return{connectees:{active:e.activeUplinkPortNames.slice(),standby:e.standbyUplinkPortNames.slice(),unused:e.unusedUplinkPortNames.slice(),lagNames:e.lagNames?e.lagNames.slice():null},labels:{active:this.networkUtil.getString("dvpg.policy.failover.order.active.group"),standby:this.networkUtil.getString("dvpg.policy.failover.order.standby.group"),unused:this.networkUtil.getString("dvpg.policy.failover.order.unused.group")}}},e.prototype.getLoadBalancingMessages=function(e,t,i,r){var n=this.getFormattedLoadBalancingInfoMessages(e,t);if(t!==this.networkUiConstants.LoadBalancingPolicy.IP)return n;var o=this.getFormattedLoadBalancingWarningMessages(e.active,e.standby,t,i,!1,r);return o&&(n=o.concat(n)),n},e.prototype.getLoadBalancingWarningMessages=function(e,t,i,r,n,o){var a=[];if(o)return this.getLoadBalancingOverrideWarningMessages(e,t,i,r,n,o);if(n&&0===e.length&&(a=[this.networkUtil.getString("dvpg.policy.failover.order.warn.noActiveUplinks")]),i!==this.networkUiConstants.LoadBalancingPolicy.IP)return a;var s,c=t&&t.length>0;return c&&r?(s=[this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.warn.beaconProbingAndStandbyUplinks")],a=a.concat(s)):c?(s=[this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.warn.standbyUplinks")],a=a.concat(s)):r&&(s=[this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.warn.beaconProbing")],a=a.concat(s)),a},e.prototype.getLoadBalancingOverrideWarningMessages=function(e,t,i,r,n,o){if(!o.loadBalancing&&!o.failoverOrder&&!o.beaconProbing)return[];var a=[],s=t&&t.length>0;return o.failoverOrder&&n&&0===e.length&&(a=[this.networkUtil.getString("dvpg.policy.failover.order.warn.noActiveUplinks")]),o.loadBalancing&&i!==this.networkUiConstants.LoadBalancingPolicy.IP?a:(o.loadBalancing&&(o.beaconProbing&&o.failoverOrder&&r&&s?a.push(this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.warn.beaconProbingAndStandbyUplinks")):o.beaconProbing&&r?a.push(this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.warn.beaconProbing")):o.failoverOrder&&s&&a.push(this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.warn.standbyUplinks"))),a)},e.prototype.hasLoadBalancingWarningMessage=function(e,t,i,r,n,o){return o?this.hasLoadBalancingOverrideWarningMessage(e,t,i,r,n,o):!(!n||0!==e.length)||i===this.networkUiConstants.LoadBalancingPolicy.IP&&(t&&t.length>0||r)},e.prototype.shouldShowErrorWarningDialog=function(e,t,i,r){return this.hasLagErrorMessage(e,r)||this.hasLoadBalancingWarningMessage(e.active,e.standby,t,i,!0,r)||this.hasLagWarningMessages(e,i,r)},e.prototype.showErrorWarningDialog=function(e,t,i,r){var n=this.getLagErrorMessage(e,r),o=this.getLoadBalancingWarningMessages(e.active,e.standby,t,i,!0,r),a=this.getLagWarningMessages(e,i,r),s=o.concat(a),c=this.$q.defer(),l={size:"md",defaultButton:"close",alerts:[],dialogData:{},contentTemplate:"network-lib-ui/resources/network-lib/dvpg/edit/portgroupFailoverErrorWarningDialog.html",submit:function(){return c.resolve(!0),!0},onCancel:function(){return c.resolve(!1),!0}},d=this.getDialogWarningMessages(s);if(null===n)l.title=this.networkUtil.getString("dvpg.policy.failover.confirmation.title"),l.dialogData.messages=d;else{var u=this.getDialogErrorMessages([n]),p=u.concat(d);l.title=this.networkUtil.getString("dvpg.policy.failover.error.title"),l.dialogData.messages=p,l.hideSubmitButton=!0,l.closeButtonTitle=this.networkUtil.getString("MessageDialog.okButton")}return l.dialogData.dialogInfo=this.networkUtil.getString("IssuesConfirmationDialog.tip"),this.clarityModalService.openConfirmationModal(l),c.promise.then(function(e){return e})},e.prototype.getFormattedLoadBalancingWarningMessages=function(e,t,i,r,n,o){var a="vsphere-icon-status-warning",s=this.getLoadBalancingWarningMessages(e,t,i,r,n,o);return this.networkUtil.formatTextMessagesWithIcon(s,a)},e.prototype.getLagWarningMessages=function(e,t,i){var r=[],n=e.active,o=e.standby,a=e.lagNames,s=this.getLagCount(n,a),c=this.getLagCount(o,a),l=n.length-s;return 1===c&&l>=1&&r.push(this.networkUtil.getString("dvpg.policy.failover.order.warn.migrationMode")),i&&!i.beaconProbing?r:(t&&!this.hasLagErrorMessage(e,i)&&s+c>=1&&r.push(this.networkUtil.getString("dvpg.policy.failover.order.warn.lacpBeaconProbing")),r)},e.prototype.hasLagErrorMessage=function(e,t){return null!==this.getLagErrorMessage(e,t)},e.prototype.getLagErrorMessage=function(e,t){if(t&&!t.failoverOrder)return null;var i=e.active,r=e.standby,n=e.unused,o=e.lagNames;if(!o||0===o.length)return null;var a=o.length-this.getLagCount(n,o),s=i.length+r.length-a;if(a>1&&0===s)return this.networkUtil.getString("dvpg.policy.failover.order.error.multipleLags");var c=this.getLagCount(i,o),l=this.getLagCount(r,o),d=r.length-l;return c>=1&&s>=1||l>=1&&d>=1?this.networkUtil.getString("dvpg.policy.failover.order.error.hybridMode"):null},e.prototype.hasLagWarningMessages=function(e,t,i){return!(i&&!i.failoverOrder)&&this.getLagWarningMessages(e,t,i).length>0},e.prototype.getLagCount=function(e,t){var i=0;return e&&t&&0!==e.length&&0!==t.length?(_.forEach(e,function(e){_.indexOf(t,e)!==-1&&i++}),i):i},e.prototype.getFormattedLoadBalancingInfoMessages=function(e,t){var i="vsphere-icon-info",r=[];return t===this.networkUiConstants.LoadBalancingPolicy.IP&&(r=[this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.info.etherChannel"),this.networkUtil.getString("dvpg.policy.failover.lb.loadbalance_ip.info.portGroupPolicies")]),this.hasSingleLagBacking(e)&&r.push(this.networkUtil.getString("dvpg.policy.failover.lb.sinlgeLag.info")),this.networkUtil.formatTextMessagesWithIcon(r,i)},e.prototype.getDialogWarningMessages=function(e){var t=[];return _.forEach(e,function(e){t.push({iconClass:"warning",text:e})}),t},e.prototype.getDialogErrorMessages=function(e){var t=[];return _.forEach(e,function(e){t.push({iconClass:"danger",text:e})}),t},e.prototype.hasSingleLagBacking=function(e){if(e&&e.active.length+e.standby.length===1&&e.lagNames&&e.lagNames.length>0){var t=1===e.active.length?e.active[0]:e.standby[0];return _.indexOf(e.lagNames,t)!==-1}return!1},e.prototype.hasLoadBalancingOverrideWarningMessage=function(e,t,i,r,n,o){if(!o.loadBalancing&&!o.failoverOrder&&!o.beaconProbing)return!1;if(o.failoverOrder&&n&&0===e.length)return!0;if(o.loadBalancing&&i===this.networkUiConstants.LoadBalancingPolicy.IP){if(o.beaconProbing&&o.failoverOrder)return t&&t.length>0||r;if(o.beaconProbing)return r;if(o.failoverOrder)return t&&t.length>0}return!1},e.$inject=["networkUtil","networkUiConstants","clarityModalService","$q"],e}();e.DvpgFailoverPolicyPageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgFailoverPolicyPageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VlanIdSpec,i=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$TrunkVlanSpec,r=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$PvlanSpec,n=com.vmware.vim.binding.vim.dvs.DistributedVirtualPort$TrafficShapingPolicy,o=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$UplinkPortTeamingPolicy,a=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$SecurityPolicy,s=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$FailureCriteria,c=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$UplinkPortOrderPolicy,l=com.vmware.vim.binding.vim.BoolPolicy,d=com.vmware.vim.binding.vim.StringPolicy,u=com.vmware.vim.binding.vim.LongPolicy,p=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VMwarePortgroupPolicy,v=function(){function e(e){this.networkUiConstants=e}return e.prototype.buildVlanSpec=function(e){switch(e.vlanType){case this.networkUiConstants.Vlan.Type.NONE:var n=new t;return n.vlanId=this.networkUiConstants.Vlan.Id.NONE,n;case this.networkUiConstants.Vlan.Type.VLAN:var n=new t;return n.vlanId=e.vlanId,n;case this.networkUiConstants.Vlan.Type.TRUNK:var n=new i;return n.vlanId=e.vlanTrunkNumericRanges,n;case this.networkUiConstants.Vlan.Type.PRIVATE:var n=new r;return n.pvlanId=e.pvlanId,n;default:return null}},e.prototype.buildSecurityPolicySpec=function(e){var t=new a;return t.inherited=!1,t.allowPromiscuous=this.buildBoolPolicy(e.allowPromiscuous),t.forgedTransmits=this.buildBoolPolicy(e.forgedTransmits),t.macChanges=this.buildBoolPolicy(e.macChanges),t},e.prototype.buildTrafficShapingSpec=function(e){return this.buildTrafficShaping(e,!1)},e.prototype.buildTrafficShapingSpecPort=function(e,t){return this.buildTrafficShaping(e,t)},e.prototype.buildTrafficShaping=function(e,t){var i=new l;i.value=e.enabled,i.inherited=!1;var r=new n;return r.enabled=i,r.inherited=t,r.enabled.value&&!t&&(r.averageBandwidth=this.buildLongPolicy(e.averageBandwidth*this.networkUiConstants.UnitFormat.KBPS),r.peakBandwidth=this.buildLongPolicy(e.peakBandwidth*this.networkUiConstants.UnitFormat.KBPS),r.burstSize=this.buildLongPolicy(e.burstSize*this.networkUiConstants.UnitFormat.KB)),r},e.prototype.buildTeamingAndFailoverPortSpec=function(e,t){return this.buildTeamingAndFailover(e,t)},e.prototype.buildTeamingAndFailoverSpec=function(e){return this.buildTeamingAndFailover(e,null)},e.prototype.buildTeamingAndFailover=function(e,t){var i=new o;i.inherited=!1,i.policy=this.buildStringPolicy(e.loadBalancing),i.policy.inherited=!!t&&!t.loadBalancing;var r=new s;return r.inherited=!!t&&!t.beaconProbing,r.checkBeacon=this.buildBoolPolicy(e.beaconProbing),r.checkBeacon.inherited=!!t&&!t.beaconProbing,i.failureCriteria=r,i.notifySwitches=this.buildBoolPolicy(e.notifySwitches),i.notifySwitches.inherited=!!t&&!t.notifySwitches,i.rollingOrder=this.buildBoolPolicy(e.rollingOrder),i.rollingOrder.inherited=!!t&&!t.rollingOrder,i.uplinkPortOrder=new c,i.uplinkPortOrder.inherited=!!t&&!t.failoverOrder,i.uplinkPortOrder.activeUplinkPort=e.failoverOrder.activeUplinkPortNames,i.uplinkPortOrder.standbyUplinkPort=e.failoverOrder.standbyUplinkPortNames,i},e.prototype.buildResourcePoolAllocationSpec=function(e){if(e.isVmVnicResourcePoolSupported)return e.networkResourcePoolKey;var t=new d;return t.inherited=!1,t.value=e.networkResourcePoolKey,t},e.prototype.buildMonitoringSpec=function(e){return this.buildBoolPolicy(e.ipfixEnabled)},e.prototype.buildMiscSpec=function(e){return this.buildBoolPolicy(e.arePortsBlocked)},e.prototype.buildPortPoliciesSpec=function(e){var t=new p;return this.isPolicySupported(e.blockOverrideAllowed)&&(t.blockOverrideAllowed=e.blockOverrideAllowed),this.isPolicySupported(e.portConfigResetAtDisconnect)&&(t.portConfigResetAtDisconnect=e.portConfigResetAtDisconnect),this.isPolicySupported(e.shapingOverrideAllowed)&&(t.shapingOverrideAllowed=e.shapingOverrideAllowed),this.isPolicySupported(e.vendorConfigOverrideAllowed)&&(t.vendorConfigOverrideAllowed=e.vendorConfigOverrideAllowed),this.isPolicySupported(e.vlanOverrideAllowed)&&(t.vlanOverrideAllowed=e.vlanOverrideAllowed),this.isPolicySupported(e.uplinkTeamingOverrideAllowed)&&(t.uplinkTeamingOverrideAllowed=e.uplinkTeamingOverrideAllowed),this.isPolicySupported(e.networkResourcePoolOverrideAllowed)&&(t.networkResourcePoolOverrideAllowed=e.networkResourcePoolOverrideAllowed),this.isPolicySupported(e.securityPolicyOverrideAllowed)&&(t.securityPolicyOverrideAllowed=e.securityPolicyOverrideAllowed),this.isPolicySupported(e.ipfixOverrideAllowed)&&(t.ipfixOverrideAllowed=e.ipfixOverrideAllowed),this.isPolicySupported(e.trafficFilterOverrideAllowed)&&(t.trafficFilterOverrideAllowed=e.trafficFilterOverrideAllowed),t},e.prototype.buildLongPolicy=function(e){var t=new u;return t.inherited=!1,t.value=e,t},e.prototype.buildStringPolicy=function(e){var t=new d;return t.inherited=!1,t.value=e,t},e.prototype.buildBoolPolicy=function(e){var t=new l;return t.inherited=!1,t.value=e,t},e.prototype.isPolicySupported=function(e){return null!==e&&"undefined"!=typeof e},e.$inject=["networkUiConstants"],e}();e.DvpgSpecFactory=v,angular.module("com.vmware.vsphere.client.dvs").service("dvpgSpecFactory",v)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.trafficShapingPolicyValidator=e,this.networkUiConstants=t,this.i18nService=i,this.attributeNames=[t.TrafficShapingSetting.AVERAGE_BANDWIDTH,t.TrafficShapingSetting.PEAK_BANDWIDTH,t.TrafficShapingSetting.BURST_SIZE]}return e.prototype.getErrorMessages=function(e,t){var i=this,r=[];if(_.forEach(this.attributeNames,function(n){var o=e[n],a=t[n];if(e.enabled){var s=i.trafficShapingPolicyValidator.getTrafficShapingErrorMessage(o,n);null!==s&&r.push(s)}if(t.enabled){var c=i.trafficShapingPolicyValidator.getTrafficShapingErrorMessage(a,n);null!==c&&r.push(c)}}),0===r.length){var n=this.isTrafficShapingPolicyValid(t),o=this.isTrafficShapingPolicyValid(e);o||n?o?n||r.push(this.i18nService.getString("NetworkUi","dvpg.policy.shaping.egress.avgBwGreaterThanPeakBw")):r.push(this.i18nService.getString("NetworkUi","dvpg.policy.shaping.ingress.avgBwGreaterThanPeakBw")):r.push(this.i18nService.getString("NetworkUi","dvpg.policy.shaping.both.avgBwGreaterThanPeakBw"))}return r},e.prototype.isTrafficShapingPolicyValid=function(e){return!e.enabled||e.averageBandwidth<=e.peakBandwidth},e.$inject=["trafficShapingPolicyValidator","networkUiConstants","i18nService"],e}();e.DvpgTrafficShapingPolicyService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgTrafficShapingPolicyService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvpgCreateWizardConstants",{properties:{DVPG_NEW_UNIQUE_NAME:"newUniquePortGroupName",PRIMARY_ICON_ID:"primaryIconId",NAME_PROPERTY:"name",DVPG_PROPERTIES:"createdvpg:settingsdata"},portBinding:{EARLY_BINDING:"earlyBinding",EPHEMERAL:"ephemeral"},portAllocation:{DEFAULT_AUTO_EXPAND:!0},numPorts:{MIN:0,MAX:8192,DEFAULT_NUMBER_OF_PORTS_FIXED:128,DEFAULT_NUMBER_OF_PORTS_ELASTIC:8},objectType:{DISTRIBUTED_SWITCH:"DistributedSwitch",ROOT_FOLDER:"RootFolder",DATACENTER:"Datacenter"},DVPG_DEFAULT_NETWORK_RESOURCE_POOL_KEY:"-1",MAX_ALLOWED_DVPG_NAME_LENGTH:80,DC_DVS_NODE_TYPE_ID:"DcDvs",NETWORK_FOLDER_DVS_NODE_TYPE_ID:"NetworkFolderDvs"})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e){this.pageStateManagementService=e}return t.prototype.init=function(e){var t=this;this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e),this.pages=e.wizardConfig.pages,e.$watchGroup(["model.isPolicyConfigurationEnabled","model.monitoringPolicyModel.ipfixSupported"],function(e){return t.updatePagesVisibility.apply(t,e)})},t.prototype.updatePagesVisibility=function(t,i){this.togglePageVisibility(e.DvpgCreateWizardPages.PAGES.SECURITY_POLICY,t),this.togglePageVisibility(e.DvpgCreateWizardPages.PAGES.TRAFFIC_SHAPING,t),this.togglePageVisibility(e.DvpgCreateWizardPages.PAGES.FAILOVER_POLICY,t),this.togglePageVisibility(e.DvpgCreateWizardPages.PAGES.MONITORING,t&&i),this.togglePageVisibility(e.DvpgCreateWizardPages.PAGES.MISC,t)},t.prototype.togglePageVisibility=function(e,t){var i=_.findWhere(this.pages,{id:e});this.pageStateManagementService.togglePageVisibility(i,t)},t.$inject=["pageStateManagementService"],t}();e.DvpgCreateWizardFlowManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgCreateWizardFlowManager",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.simpleValidationCommit=t,this.nameAndLocationPageValidator=i,this.generalPropertiesPageValidator=r,this.dvpgTrafficShapingPolicyService=n,this.dvpgFailoverPolicyPageValidator=o}return e.prototype.createPages=function(t){var i=this,r={id:e.PAGES.NAME_AND_LOCATION,title:this.i18nService.getString("DvsUi","dvpg.create.nameAndLocation.title"),description:this.i18nService.getString("DvsUi","dvpg.create.nameAndLocation.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/create/views/dvpgNameAndLocationPage.html",onCommit:this.simpleValidationCommit(function(){return i.nameAndLocationPageValidator.getValidationError(t)},t.wizardConfig),validationParams:[]},n={id:e.PAGES.GENERAL_PROPERTIES,title:this.i18nService.getString("DvsUi","dvpg.create.properties.title"),description:this.i18nService.getString("DvsUi","dvpg.create.properties.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/create/views/dvpgGeneralPropertiesPage.html",onCommit:this.simpleValidationCommit(function(){return i.generalPropertiesPageValidator.getValidationError(t)},t.wizardConfig),validationParams:[]},o={id:e.PAGES.SECURITY_POLICY,title:this.i18nService.getString("DvsUi","dvpg.policy.security.title"),description:this.i18nService.getString("DvsUi","dvpg.policy.security.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgSecurityPolicyPage.html",onCommit:this.simpleValidationCommit(function(){return[]},t.wizardConfig),validationParams:["model.securityPolicyModel.allowPromiscuous","model.securityPolicyModel.forgedTransmits","model.securityPolicyModel.macChanges"]},a={id:e.PAGES.TRAFFIC_SHAPING,title:this.i18nService.getString("DvsUi","dvpg.policy.shaping.title"),description:this.i18nService.getString("DvsUi","dvpg.policy.shaping.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgTrafficShapingPage.html",onCommit:this.simpleValidationCommit(function(){return i.dvpgTrafficShapingPolicyService.getErrorMessages(t.model.trafficShapingPolicyModel.inShapingPolicy,t.model.trafficShapingPolicyModel.outShapingPolicy)},t.wizardConfig),validationParams:["model.trafficShapingPolicyModel.inShapingPolicy.enabled","model.trafficShapingPolicyModel.inShapingPolicy.averageBandwidth","model.trafficShapingPolicyModel.inShapingPolicy.peakBandwidth","model.trafficShapingPolicyModel.inShapingPolicy.burstSize","model.trafficShapingPolicyModel.outShapingPolicy.enabled","model.trafficShapingPolicyModel.outShapingPolicy.averageBandwidth","model.trafficShapingPolicyModel.outShapingPolicy.peakBandwidth","model.trafficShapingPolicyModel.outShapingPolicy.burstSize"]},s={id:e.PAGES.FAILOVER_POLICY,title:this.i18nService.getString("DvsUi","dvpg.policy.failover.title"),description:this.i18nService.getString("DvsUi","dvpg.policy.failover.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgFailoverPolicyPage.html",onCommit:this.simpleValidationCommit(function(){return i.dvpgFailoverPolicyPageValidator.getValidationError(t)},t.wizardConfig),validationParams:["model.failoverPolicyModel.loadBalancing","model.failoverPolicyModel.beaconProbing","model.failoverPolicyModel.notifySwitches","model.failoverPolicyModel.rollingOrder","model.failoverPolicyModel.failoverOrder.activeUplinkPortNames","model.failoverPolicyModel.failoverOrder.standbyUplinkPortNames","model.failoverPolicyModel.failoverOrder.unusedUplinkPortNames"]},c={id:e.PAGES.MONITORING,title:this.i18nService.getString("DvsUi","dvpg.policy.monitoring.title"),description:this.i18nService.getString("DvsUi","dvpg.policy.monitoring.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgMonitoringPage.html",onCommit:this.simpleValidationCommit(function(){return[]},t.wizardConfig),validationParams:["model.monitoringPolicyModel.ipfixEnabled"]},l={id:e.PAGES.MISC,title:this.i18nService.getString("DvsUi","dvpg.policy.misc.title"),description:this.i18nService.getString("DvsUi","dvpg.policy.misc.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgMiscPage.html",onCommit:this.simpleValidationCommit(function(){return[]},t.wizardConfig),validationParams:["model.miscPolicyModel.arePortsBlocked"]},d={id:e.PAGES.READY_TO_COMPLETE,title:this.i18nService.getString("DvsUi","dvpg.create.finish.title"),description:this.i18nService.getString("DvsUi","dvpg.create.finish.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/create/views/dvpgCreateReadyToCompletePage.html",onCommit:function(){return!0},validationParams:[]};return[r,n,o,a,s,c,l,d]},e.$inject=["i18nService","simpleValidationCommit","dvpgNameAndLocationPageValidator","dvpgGeneralPropertiesPageValidator","dvpgTrafficShapingPolicyService","dvpgFailoverPolicyPageValidator"],e.PAGES=function(){function e(){}return e.NAME_AND_LOCATION="nameAndLocationPage",e.GENERAL_PROPERTIES="generalPropertiesPage",e.SECURITY_POLICY="securityPolicyPage",e.TRAFFIC_SHAPING="trafficShapingPage",e.FAILOVER_POLICY="teamingAndFailoverPage",e.MONITORING="monitoringPage",e.MISC="miscPage",e.READY_TO_COMPLETE="readyToCompletePage",e}(),e}();e.DvpgCreateWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgCreateWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.mutationService=r,this.specFactory=n,this.wizardConstants=o,this.dvpgCreateWizardFlowManager=a,this.wizardPages=s}return t.prototype.show=function(e){var t=this,i=this.$rootScope.$new();i.model=this.initWizardDataModel(e),i.flags=this.initWizardFlags(),i.wizardConfig={title:this.i18nService.getString("DvsUi","dvpg.create.title"),loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),onFinish:function(){var e=t.specFactory.buildDvpgCreateSpec(i.model);return t.mutationService.add(e._type,e),!0}},i.wizardConfig.pages=this.wizardPages.createPages(i),this.dvpgCreateWizardFlowManager.init(i),i.wizardConfig.cssClass="dvpg-create-wizard",this.vuiWizardService({scope:i,configObjectName:"wizardConfig"}).show()},t.prototype.initWizardDataModel=function(t){var i=new e.DvpgCreateWizardModel;return i.dvsId=t,i.contextObjId=t,i.name=this.i18nService.getString("DvsUi","dvpg.create.nameAndLocation.defaultName"),i.isPolicyConfigurationEnabled=!1,i},t.prototype.initWizardFlags=function(){var t=new e.DvpgCreateWizardFlags;return t.isNameAndLocationPageInitialized=!1,t.isGeneralPropertiesPageInitialized=!1,t},t.$inject=["$rootScope","i18nService","vuiWizardService","mutationService","dvpgCreateWizardSpecFactory","dvpgCreateWizardConstants","dvpgCreateWizardFlowManager","dvpgCreateWizardPages"],t}();e.DvpgCreateWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgCreateWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VlanIdSpec,i=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$TrunkVlanSpec,r=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$PvlanSpec,n=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VmwarePortConfigPolicy,o=com.vmware.vsphere.client.dvportgroup.DvPortgroupCreateSpec,a=com.vmware.vim.binding.vim.StringPolicy,s=function(){function e(e,t,i,r){this.defaultUriSchemeUtil=e,this.wizardConstants=t,this.networkUiConstants=i,this.dvpgSpecFactory=r}return e.prototype.buildDvpgCreateSpec=function(e){var t=new n;t.vlan=this.createVlanSpec(e),e.isPolicyConfigurationEnabled&&(t.inShapingPolicy=this.dvpgSpecFactory.buildTrafficShapingSpec(e.trafficShapingPolicyModel.inShapingPolicy),t.outShapingPolicy=this.dvpgSpecFactory.buildTrafficShapingSpec(e.trafficShapingPolicyModel.outShapingPolicy),t.securityPolicy=this.dvpgSpecFactory.buildSecurityPolicySpec(e.securityPolicyModel),t.uplinkTeamingPolicy=this.dvpgSpecFactory.buildTeamingAndFailoverSpec(e.failoverPolicyModel),t.ipfixEnabled=this.dvpgSpecFactory.buildMonitoringSpec(e.monitoringPolicyModel),t.blocked=this.dvpgSpecFactory.buildMiscSpec(e.miscPolicyModel));var i=new com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroup$ConfigSpec;i.defaultPortConfig=t,e.portBinding===this.wizardConstants.portBinding.EARLY_BINDING&&(i.autoExpand=e.autoExpand),e.isVmVnicResourcePoolSupported?i.vmVnicNetworkResourcePoolKey=e.networkResourcePoolKey:e.isNetworkResourcePoolSupported&&(i.defaultPortConfig.networkResourcePoolKey=new a,i.defaultPortConfig.networkResourcePoolKey.value=e.networkResourcePoolKey,i.defaultPortConfig.networkResourcePoolKey.inherited=!1),i.name=e.name,i.type=e.portBinding,i.numPorts=e.numPorts;var r=new o;return r.switchRef=this.defaultUriSchemeUtil.getManagedObjectReference(e.dvsId),r.configSpec=i,r},e.prototype.createVlanSpec=function(e){var n;return e.vlanType===this.networkUiConstants.Vlan.Type.NONE?(n=new t,n.vlanId=this.networkUiConstants.Vlan.Id.NONE):e.vlanType===this.networkUiConstants.Vlan.Type.VLAN?(n=new t,n.vlanId=e.vlanId):e.vlanType===this.networkUiConstants.Vlan.Type.TRUNK?(n=new i,n.vlanId=e.vlanTrunkNumericRanges):e.vlanType===this.networkUiConstants.Vlan.Type.PRIVATE&&(n=new r,n.pvlanId=e.pvlanId),n},e.$inject=["defaultUriSchemeUtil","dvpgCreateWizardConstants","networkUiConstants","dvpgSpecFactory"],e}();e.DvpgCreateWizardSpecFactory=s,angular.module("com.vmware.vsphere.client.dvs").service("dvpgCreateWizardSpecFactory",s)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgCreateWizardFlags=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgCreateWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.networkUiConstants=t,this.wizardConstants=i}return e.prototype.getNetworkResourcePoolLabel=function(e,t){var i=this.i18nService.getString("DvsUi","dvpg.create.finish.resourcePool.default");return e!==this.wizardConstants.DVPG_DEFAULT_NETWORK_RESOURCE_POOL_KEY&&t&&0!==t.length?(_.each(t,function(t){t.key===e&&(i=t.name)}),i):i},e.prototype.getPortAllocationLabel=function(e){return e?this.i18nService.getString("DvsUi","dvpg.create.properties.portAllocation.autoExpand.true"):this.i18nService.getString("DvsUi","dvpg.create.properties.portAllocation.autoExpand.false")},e.prototype.getPortBindingLabel=function(e){var t=this.i18nService.getString("DvsUi","dvpg.create.finish.property.na");if(!e)return t;switch(e){case this.wizardConstants.portBinding.EARLY_BINDING:t=this.i18nService.getString("DvsUi","dvpg.create.properties.portBinding.earlyBinding");break;case this.wizardConstants.portBinding.EPHEMERAL:t=this.i18nService.getString("DvsUi","dvpg.create.properties.portBinding.ephemeral")}return t},e.prototype.getVlanPropertyName=function(e){var t=this.i18nService.getString("DvsUi","dvpg.create.finish.vlan");if(!e)return t;switch(e){case this.networkUiConstants.Vlan.Type.NONE:case this.networkUiConstants.Vlan.Type.VLAN:t=this.i18nService.getString("DvsUi","dvpg.create.finish.vlan.id");break;case this.networkUiConstants.Vlan.Type.PRIVATE:t=this.i18nService.getString("DvsUi","dvpg.create.finish.vlan.private");break;case this.networkUiConstants.Vlan.Type.TRUNK:t=this.i18nService.getString("DvsUi","dvpg.create.finish.vlan.trunk")}return t},e.prototype.getVlanPropertyValue=function(e){var t=this.i18nService.getString("DvsUi","dvpg.create.finish.property.na");if(!e)return t;switch(e.vlanType){case this.networkUiConstants.Vlan.Type.VLAN:return e.vlanId.toString();case this.networkUiConstants.Vlan.Type.PRIVATE:return this.getPvlanLabel(e.pvlanId,e.pvlanConfig);case this.networkUiConstants.Vlan.Type.TRUNK:return e.vlanTrunkRanges.replace(/ +/g,"").replace(/,/g,", ")}return t},e.prototype.getPvlanTypeLabel=function(e){switch(e){case this.networkUiConstants.Vlan.PvlanType.ISOLATED:return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.isolated");case this.networkUiConstants.Vlan.PvlanType.PROMISCUOUS:return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.promiscuous");case this.networkUiConstants.Vlan.PvlanType.COMMUNITY:return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.community");default:return""}},e.prototype.getPvlanLabel=function(e,t){var i=this,r=this.i18nService.getString("DvsUi","dvpg.create.finish.property.na");return t?(_.each(t,function(t){if(t.secondaryVlanId===e){var n=i.getPvlanTypeLabel(t.pvlanType);r=i.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.displayFormat",n,t.primaryVlanId,t.secondaryVlanId);
}}),r):r},e.$inject=["i18nService","networkUiConstants","dvpgCreateWizardConstants"],e}();e.DvpgCreateReadyToCompletePageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgCreateReadyToCompletePageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.networkUiConstants=t}return e.prototype.getNetworkResourcePoolsOptions=function(e){var t=[];return e&&e.length>0&&_.each(e,function(e){t.push({label:e.name,val:e.key})}),t},e.prototype.getPvlanOptions=function(e){var t=this,i=[];return e?(_.each(e,function(e){var r=t.getPvlanTypeLabel(e.pvlanType);i.push({label:t.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.displayFormat",r,e.primaryVlanId,e.secondaryVlanId),val:e.secondaryVlanId})}),i):i},e.prototype.getPvlanTypeLabel=function(e){switch(e){case this.networkUiConstants.Vlan.PvlanType.ISOLATED:return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.isolated");case this.networkUiConstants.Vlan.PvlanType.PROMISCUOUS:return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.promiscuous");case this.networkUiConstants.Vlan.PvlanType.COMMUNITY:return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.community");default:return""}},e.$inject=["i18nService","networkUiConstants"],e}();e.DvpgGeneralPropertiesPageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgGeneralPropertiesPageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.mutationService=t,this.networkUiConstants=i,this.dvpgPropertiesService=r,this.wizardConstants=n,this.$q=o}return e.prototype.getValidationError=function(e){var t=[];if(e.model.portBinding===this.wizardConstants.portBinding.EARLY_BINDING){var i=this.dvpgPropertiesService.getNumPortsError(e.model.numPorts);i&&t.push(i)}switch(e.model.vlanType){case this.networkUiConstants.Vlan.Type.VLAN:var r=this.dvpgPropertiesService.getVlanIdError(e.model.vlanId);r&&t.push(r);break;case this.networkUiConstants.Vlan.Type.TRUNK:return this.getTrunkVlanRanges(e);case this.networkUiConstants.Vlan.Type.PRIVATE:var n=this.getPvlanError(e);n&&t.push(n)}return this.$q.resolve(t)},e.prototype.getPvlanError=function(e){if(e.model.showPvlanError)return this.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.private.noConfig")},e.prototype.getTrunkVlanRanges=function(e){var t=this,i=[],r=e.model.vlanTrunkRanges;return e.wizardConfig.loading=!0,this.mutationService.validate(e.model.dvsId,"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupTrunkVlanSpec",{_type:"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupTrunkVlanSpec",numericRanges:r.trim()}).then(function(r){return r&&r.result?e.model.vlanTrunkNumericRanges=r.result:i.push(t.i18nService.getString("DvsUi","dvpg.create.properties.vlan.type.trunk.error")),e.wizardConfig.loading=!1,i},function(){return e.wizardConfig.loading=!1,i})},e.$inject=["i18nService","mutationService","networkUiConstants","dvpgPropertiesService","dvpgCreateWizardConstants","$q"],e}();e.DvpgGeneralPropertiesPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgGeneralPropertiesPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.mutationService=t,this.$q=i,this.wizardConstants=r}return e.prototype.getValidationError=function(e){var t=this.getInvalidNameError(e.model.name);if(t)return this.$q.resolve([t]);var i=this.getDvsErrors(e);return i.length>0?this.$q.resolve(i):this.getNameValidationError(e)},e.prototype.getInvalidNameError=function(e){var t=e?e.trim():e,i=t.replace(/%/g,"%25").replace(/\//g,"%2f").replace(/\\/g,"%5c");return i&&0!==i.length?i.length>this.wizardConstants.MAX_ALLOWED_DVPG_NAME_LENGTH?this.i18nService.getString("DvsUi","dvpg.create.nameAndLocation.tooLong"):null:this.i18nService.getString("DvsUi","dvpg.create.nameAndLocation.nameRequired")},e.prototype.getDvsErrors=function(e){return null===e.model.dvsId?[this.i18nService.getString("DvsUi","dvpg.create.nameAndLocation.noSelectionError")]:[]},e.prototype.getNameValidationError=function(e){return e.wizardConfig.loading=!0,this.mutationService.validate(e.model.dvsId,"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupNameSpec",{_type:"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupNameSpec",name:e.model.name.trim()}).then(function(t){var i=[];return t.error&&t.error.localizedMessage?i.push(t.error.localizedMessage):t.result&&i.push(t.result),e.wizardConfig.loading=!1,i},function(){return e.wizardConfig.loading=!1,[]})},e.$inject=["i18nService","mutationService","$q","dvpgCreateWizardConstants"],e}();e.DvpgNameAndLocationPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgNameAndLocationPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$wizardScope=e,this.i18nService=t,this.vxPropertyViewService=i,this.networkUiConstants=r,this.wizardConstants=n,this.pageService=o;var a=i.createPropertyViewBuilder(),s=a.category("general"),c=s.section("generalSection");c.property(this.i18nService.getString("DvsUi","dvpg.create.finish.name"),this.$wizardScope.model.name),c.property(this.i18nService.getString("DvsUi","dvpg.create.finish.portBinding"),this.pageService.getPortBindingLabel(this.$wizardScope.model.portBinding)),this.$wizardScope.model.portBinding===this.wizardConstants.portBinding.EARLY_BINDING&&(c.property(this.i18nService.getString("DvsUi","dvpg.create.finish.numberOfPorts"),this.$wizardScope.model.numPorts),c.property(this.i18nService.getString("DvsUi","dvpg.create.finish.portAllocation"),this.pageService.getPortAllocationLabel(this.$wizardScope.model.autoExpand))),c.property(this.i18nService.getString("DvsUi","dvpg.create.finish.resourcePool"),this.pageService.getNetworkResourcePoolLabel(this.$wizardScope.model.networkResourcePoolKey,this.$wizardScope.model.networkResourcePools)),c.property(this.pageService.getVlanPropertyName(this.$wizardScope.model.vlanType),this.pageService.getVlanPropertyValue(this.$wizardScope.model)),this.$wizardScope.model.summaryData=a.build()}return e.$inject=["$scope","i18nService","vxPropertyViewService","networkUiConstants","dvpgCreateWizardConstants","dvpgCreateReadyToCompletePageService"],e}();angular.module("com.vmware.vsphere.client.dvs").controller("DvpgCreateReadyToCompletePageController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.$wizardScope=e,this.i18nService=t,this.wizardConstants=i,this.networkUtil=r,this.dataService=n,this.networkUiConstants=o,this.dvpgPropertiesService=a,this.dvpgGeneralPropertiesPageService=s,this.dvpgFailoverPolicyPageService=c,this.numPortsValidator={},this.vlanIdValidator={},this.$wizardScope.flags.isGeneralPropertiesPageInitialized?(this.networkResourcePoolOptions=this.dvpgGeneralPropertiesPageService.getNetworkResourcePoolsOptions(this.$wizardScope.model.networkResourcePools),this.pvlanTypeOptions=this.dvpgGeneralPropertiesPageService.getPvlanOptions(this.$wizardScope.model.pvlanConfig)):(this.initModel(),this.requestProperties()),this.portBindingOptions=[{label:this.i18nService.getString("DvsUi","dvpg.create.properties.portBinding.earlyBinding"),val:this.wizardConstants.portBinding.EARLY_BINDING},{label:this.i18nService.getString("DvsUi","dvpg.create.properties.portBinding.ephemeral"),val:this.wizardConstants.portBinding.EPHEMERAL}],this.portAllocationOptions=[{label:this.i18nService.getString("DvsUi","dvpg.create.properties.portAllocation.autoExpand.true"),val:!0},{label:this.i18nService.getString("DvsUi","dvpg.create.properties.portAllocation.autoExpand.false"),val:!1}],this.vlanTypeOptions=[{label:t.getString("DvsUi","dvpg.create.properties.vlan.type.none"),val:this.networkUiConstants.Vlan.Type.NONE},{label:t.getString("DvsUi","dvpg.create.properties.vlan.type.vlan"),val:this.networkUiConstants.Vlan.Type.VLAN},{label:t.getString("DvsUi","dvpg.create.properties.vlan.type.trunk"),val:this.networkUiConstants.Vlan.Type.TRUNK},{label:t.getString("DvsUi","dvpg.create.properties.vlan.type.private"),val:this.networkUiConstants.Vlan.Type.PRIVATE}],this.setNumPortsValidator(),this.setVlanIdValidator(),this.onVlanIdChange=function(){this.setVlanIdValidator()},this.onNumPortsChange=function(){this.setNumPortsValidator()},this.$wizardScope.$watch(function(){return l.$wizardScope.model.numPorts},function(){if(!l.$wizardScope.model.defaultNumPortsChanged){var e=l.$wizardScope.model.autoExpand?l.wizardConstants.numPorts.DEFAULT_NUMBER_OF_PORTS_ELASTIC:l.wizardConstants.numPorts.DEFAULT_NUMBER_OF_PORTS_FIXED;l.$wizardScope.model.defaultNumPortsChanged=l.$wizardScope.model.numPorts!==e}}),this.$wizardScope.$watch(function(){return l.$wizardScope.model.autoExpand},function(){l.$wizardScope.model.defaultNumPortsChanged||(l.$wizardScope.model.autoExpand?l.$wizardScope.model.numPorts=l.wizardConstants.numPorts.DEFAULT_NUMBER_OF_PORTS_ELASTIC:l.$wizardScope.model.numPorts=l.wizardConstants.numPorts.DEFAULT_NUMBER_OF_PORTS_FIXED)}),this.$wizardScope.$watch(function(){return l.$wizardScope.model.vlanType},function(e,t){t!==e&&(l.clearVlanSettings(),e===l.networkUiConstants.Vlan.Type.VLAN?(l.$wizardScope.model.vlanId=l.networkUiConstants.Vlan.Id.MIN,l.setVlanIdValidator()):e===l.networkUiConstants.Vlan.Type.PRIVATE&&l.$wizardScope.model.pvlanConfig&&l.$wizardScope.model.pvlanConfig.length>0&&(l.$wizardScope.model.pvlanId=l.$wizardScope.model.pvlanConfig[0].secondaryVlanId))})}return e.prototype.initModel=function(){this.$wizardScope.model.portBinding=this.wizardConstants.portBinding.EARLY_BINDING,this.$wizardScope.model.autoExpand=this.wizardConstants.portAllocation.DEFAULT_AUTO_EXPAND,this.$wizardScope.model.numPorts=this.wizardConstants.numPorts.DEFAULT_NUMBER_OF_PORTS_ELASTIC,this.$wizardScope.model.defaultNumPortsChanged=!1,this.$wizardScope.model.vlanType=this.networkUiConstants.Vlan.Type.NONE,this.$wizardScope.model.vlanId=0,this.$wizardScope.model.pvlanId=0},e.prototype.clearVlanSettings=function(){this.$wizardScope.model.vlanTrunkRanges=this.networkUiConstants.Vlan.DEFAULT_VLAN_TRUNK_RANGE,this.$wizardScope.model.vlanTrunkNumericRanges=null,this.$wizardScope.model.vlanId=0},e.prototype.setVlanIdValidator=function(){var e=this.dvpgPropertiesService.getVlanIdError(this.$wizardScope.model.vlanId);this.vlanIdValidator.message=e,this.vlanIdValidator.isVisible=null!==e},e.prototype.setNumPortsValidator=function(){var e=this.dvpgPropertiesService.getNumPortsError(this.$wizardScope.model.numPorts);this.numPortsValidator.message=e,this.numPortsValidator.isVisible=null!==e},e.prototype.requestProperties=function(){var t=this;this.$wizardScope.wizardConfig.loading=!0,this.dataService.getProperties(this.$wizardScope.model.dvsId,[this.wizardConstants.properties.DVPG_PROPERTIES,e.POLICIES_PROPERTY]).then(function(i){var r=i[t.wizardConstants.properties.DVPG_PROPERTIES];t.$wizardScope.model.isNetworkResourcePoolSupported=r.isNetworkResourcePoolSupported,t.$wizardScope.model.isVmVnicResourcePoolSupported=r.isVmVnicResourcePoolSupported,t.$wizardScope.model.networkResourcePools=r.networkResourcePools,t.$wizardScope.model.networkResourcePoolKey=r.networkResourcePoolKey,t.$wizardScope.model.pvlanConfig=r.pvlanConfig,t.$wizardScope.model.showPvlanError=!r.pvlanConfig||0===r.pvlanConfig.length,t.networkResourcePoolOptions=t.dvpgGeneralPropertiesPageService.getNetworkResourcePoolsOptions(t.$wizardScope.model.networkResourcePools),t.pvlanTypeOptions=t.dvpgGeneralPropertiesPageService.getPvlanOptions(t.$wizardScope.model.pvlanConfig),t.initPoliciesConfiguration(i[e.POLICIES_PROPERTY]),t.$wizardScope.flags.isGeneralPropertiesPageInitialized=!0,t.$wizardScope.wizardConfig.loading=!1})},e.prototype.initPoliciesConfiguration=function(e){this.$wizardScope.model.securityPolicyModel=e.securityPolicyModel,this.$wizardScope.model.trafficShapingPolicyModel=e.trafficShapingPolicyModel,this.$wizardScope.model.monitoringPolicyModel=e.monitoringPolicyModel,this.$wizardScope.model.miscPolicyModel=e.miscPolicyModel,this.$wizardScope.model.failoverPolicyModel=e.failoverPolicyModel,this.$wizardScope.model.failoverOrderOptions=this.dvpgFailoverPolicyPageService.createFailoverOrderSettings(this.$wizardScope.model.failoverPolicyModel.failoverOrder)},e.$inject=["$scope","i18nService","dvpgCreateWizardConstants","networkUtil","dataService","networkUiConstants","dvpgPropertiesService","dvpgGeneralPropertiesPageService","dvpgFailoverPolicyPageService"],e.POLICIES_PROPERTY="createdvpg:policiesModel",e}();e.DvpgGeneralPropertiesPageController=t,angular.module("com.vmware.vsphere.client.dvs").controller("DvpgGeneralPropertiesPageController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.$wizardScope=e,this.validator=t,this.dataService=i,this.wizardConstants=r,this.$wizardScope.flags.isNameAndLocationPageInitialized||this.requestProperties(),this.nameValidator={message:null,isVisible:!1},this.onNameChange=function(){var t=this.validator.getInvalidNameError(e.model.name);this.nameValidator.message=t,this.nameValidator.isVisible=null!==t}}return e.prototype.requestProperties=function(){var e=this;this.$wizardScope.wizardConfig.loading=!0,this.dataService.getProperties(this.$wizardScope.model.dvsId,[this.wizardConstants.properties.DVPG_NEW_UNIQUE_NAME,this.wizardConstants.properties.NAME_PROPERTY,this.wizardConstants.properties.PRIMARY_ICON_ID]).then(function(t){e.$wizardScope.model.name=t[e.wizardConstants.properties.DVPG_NEW_UNIQUE_NAME],e.$wizardScope.model.switchName=t[e.wizardConstants.properties.NAME_PROPERTY],e.$wizardScope.model.switchIconId=t[e.wizardConstants.properties.PRIMARY_ICON_ID],e.$wizardScope.wizardConfig.loading=!1,e.$wizardScope.flags.isNameAndLocationPageInitialized=!0})},e.$inject=["$scope","dvpgNameAndLocationPageValidator","dataService","dvpgCreateWizardConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").controller("DvpgNameAndLocationPageController",t)}(dvs_ui||(dvs_ui={})),function(){"use strict";function e(e,i,r,n,o){return function(a,s){function c(){h={page:{title:e.getString("NetworkUi","dvpg.properties.general"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupGeneralPropertiesPage.html",onCommit:function(){return t(I.commitGeneralPropertiesPage)}}},f={page:{title:e.getString("NetworkUi","dvpg.policy.vlan.title"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupVlanPage.html",onCommit:function(){return t(I.commitVlanPage)}}},S={page:{title:e.getString("NetworkUi","dvpg.policy.security.title"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupSecurityPolicyPage.html",onCommit:function(){return t(I.commitSecurityPolicyPage)}}},y={page:{title:e.getString("NetworkUi","dvpg.policy.failover.title"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupFailoverPolicyPage.html",onCommit:function(){return t(I.commitFailoverPolicyPage)}}},P={page:{title:e.getString("NetworkUi","dvpg.policy.shaping.title"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupTrafficShapingPage.html",onCommit:function(){return t(I.commitTrafficShapingPage)}}},C={page:{title:e.getString("NetworkUi","dvpg.policy.monitoring.title"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupMonitoringPage.html",onCommit:function(){return t(I.commitMonitoringPolicyPage)}}},D={page:{title:e.getString("NetworkUi","dvpg.policy.misc.title"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupMiscellaneousPolicyPage.html",onCommit:function(){return t(I.commitMiscellaneousPolicyPage)}}},w={page:{title:e.getString("NetworkUi","dvpg.properties.advanced"),contentUrl:"dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupAdvancedPage.html",onCommit:function(){return t(I.commitAdvancedPage)}}}}function l(){var e=[];return e.push(h.page),e.push(w.page),e.push(f.page),a.isUplink||(e.push(S.page),e.push(y.page),e.push(P.page)),a.ipfixSupported&&e.push(C.page),e.push(D.page),e}function d(e){!e||e.length<1||(u(),s.validationBanner.messages=_.map(e,function(e){return{type:r.validationBanner.type.ERROR,text:e}}))}function u(){s.validationBanner.messages=[]}function p(){if(!v())return!0;var e={_type:b,configVersion:a.configVersion};return T.isGeneralPropertiesPageDirty&&(e.name=a.name,e.description=a.description,e.type=a.type,e.numPorts=a.numPorts,a.isUplink||(a.type===n.PortgroupType.EARLY_BINDING&&(e.autoExpand=a.autoExpand),a.isNetworkResourcePoolSupported&&(a.isVmVnicResourcePoolSupported?e.vmVnicNetworkResourcePoolKey=a.networkResourcePoolKey:e.defaultPortConfig={_type:"com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VmwarePortConfigPolicy",networkResourcePoolKey:{_type:"com.vmware.vim.binding.vim.StringPolicy",value:a.networkResourcePoolKey,inherited:!1}}))),(T.isVlanPageDirty||T.isSecurityPolicyPageDirty||T.isFailoverPolicyPageDirty||T.isTrafficShapingPageDirty||T.isMonitoringPolicyPageDirty||T.isMiscellaneousPolicyPageDirty||T.isAdvancedPageDirty)&&(e.defaultPortConfig||(e.defaultPortConfig={_type:"com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VmwarePortConfigPolicy"}),T.isVlanPageDirty&&(e.defaultPortConfig.vlan=o.buildVlanSpec(a)),T.isSecurityPolicyPageDirty&&(e.defaultPortConfig.securityPolicy=a.isUplink?null:o.buildSecurityPolicySpec(a)),T.isFailoverPolicyPageDirty&&(e.defaultPortConfig.uplinkTeamingPolicy=a.isUplink?null:o.buildTeamingAndFailoverSpec(a)),T.isTrafficShapingPageDirty&&(e.defaultPortConfig.inShapingPolicy=a.isUplink?null:o.buildTrafficShapingSpec(a.inShapingPolicy),e.defaultPortConfig.outShapingPolicy=a.isUplink?null:o.buildTrafficShapingSpec(a.outShapingPolicy)),T.isMonitoringPolicyPageDirty&&(e.defaultPortConfig.ipfixEnabled=m(a.ipfixEnabled)),T.isMiscellaneousPolicyPageDirty&&(e.defaultPortConfig.blocked=g(a.arePortsBlocked)),T.isAdvancedPageDirty&&(e.policy=o.buildPortPoliciesSpec(a.dvPortgroupPortProperties))),i.apply(a.dvPortgroupId,b,e),!0}function v(){return T.isGeneralPropertiesPageDirty||T.isVlanPageDirty||T.isSecurityPolicyPageDirty||T.isFailoverPolicyPageDirty||T.isTrafficShapingPageDirty||T.isMonitoringPolicyPageDirty||T.isMiscellaneousPolicyPageDirty||T.isAdvancedPageDirty}function m(e){return{_type:"com.vmware.vim.binding.vim.BoolPolicy",value:e,inherited:!1}}function g(e){return{_type:"com.vmware.vim.binding.vim.BoolPolicy",value:e,inherited:!1}}var h,f,S,y,P,C,D,w,b="com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroup$ConfigSpec",I={commitGeneralPropertiesPage:function(){return!0},commitVlanPage:function(){return!0},commitSecurityPolicyPage:function(){return!0},commitFailoverPolicyPage:function(){return!0},commitTrafficShapingPage:function(){return!0},commitMonitoringPolicyPage:function(){return!0},commitMiscellaneousPolicyPage:function(){return!0},commitAdvancedPage:function(){return!0}},T={isGeneralPropertiesPageDirty:!1,isVlanPageDirty:!1,isFailoverPolicyPageDirty:!1,isSecurityPolicyPageDirty:!1,isTrafficShapingPageDirty:!1,isMonitoringPolicyPageDirty:!1,isMiscellaneousPolicyPageDirty:!1,isAdvancedPageDirty:!1};return c(),{dvPortgroupData:a,commitPageCallbacks:I,pageDirtyFlags:T,getPageDefinitions:l,showDialogErrors:d,submit:p}}}function t(e){if("function"==typeof e)return e()}angular.module("com.vmware.vsphere.client.dvs").factory("EditDvPortgroupDialogManager",e),e.$inject=["i18nService","mutationService","vuiConstants","networkUiConstants","dvpgSpecFactory"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(a,s){var c="dvpg:editDvPortgroupDialogProperties",l={dvPortgroupId:a},d=t.$new();d.dialogOptions={};var u=new o(l,d.dialogOptions);d.manager=u,_.extend(d.dialogOptions,{title:i.getString("NetworkUi","dvpg.settings.initialTitle"),iconClass:s.action.icon,actionDetails:{actionEval:s,availableTargets:[a]},show:!0,height:"640px",width:"960px",loading:!0,loadingMessage:i.getString("CommonUi","wizard.loading"),confirmOptions:{onClick:u.submit},validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0});var p={scope:d,configObjectName:"dialogOptions"};r(p),e.getProperties(a,[c]).then(function(e){_.extend(l,e[c]),l.initialNumPorts=l.numPorts,l.showPortAllocation=!l.isUplink&&l.type!==n.PortgroupType.EPHEMERAL,l.showPortAllocationInfo=!1,l.showPvlanError=!l.pvlanConfig||0===l.pvlanConfig.length,d.dialogOptions.title=i.getString("NetworkUi","dvpg.settings.title",l.name),d.dialogOptions.loading=!1,d.dialogOptions.pages=u.getPageDefinitions(),d.initialData=angular.copy(l)})}return{show:a}}angular.module("com.vmware.vsphere.client.dvs").service("editDvPortgroupDialogService",e),e.$inject=["dataService","$rootScope","i18nService","vxMultiPageDialogService","networkUiConstants","EditDvPortgroupDialogManager"]}();var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",initialModel:"<",pageDirtyFlags:"<",commitCallbacks:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/edit/pages/dvPortgroupAdvancedPageTemplate.html"}return e}();e.DvPortgroupAdvancedPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.authorizationService=t,this.navigation=i,this.hasPolicyPrivilege=!0}return e.prototype.$onInit=function(){var t=this,i=this.navigation.getRoute().objectId;this.commitCallbacks.commitAdvancedPage=function(){return t.onCommit()},this.authorizationService.checkPrivilege(i,e.PRIVILEDGE_POLICY_OP).then(function(e){t.hasPolicyPrivilege=e})},e.prototype.onCommit=function(){return this.pageDirtyFlags.isAdvancedPageDirty=this.hasConfigureResetAtDisconnectChanged()||this.havePortPoliciesChanged(),!0},e.prototype.hasConfigureResetAtDisconnectChanged=function(){return this.model.portConfigResetAtDisconnect!==this.initialModel.portConfigResetAtDisconnect},e.prototype.havePortPoliciesChanged=function(){return!!this.hasPolicyPrivilege&&!_.isEqual(this.initialModel,this.model)},e.$inject=["i18nService","authorizationService","navigation"],e.PRIVILEDGE_POLICY_OP="DVPortgroup.PolicyOp",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvPortgroupAdvancedPage",new t)}(dvs_ui||(dvs_ui={})),function(){"use strict";function e(e,t){function i(){return e.manager.pageDirtyFlags.isFailoverPolicyPageDirty=r(a,e.manager.dvPortgroupData)||t.hasFailoverOrderChanged(s,e.manager.dvPortgroupData.failoverOrder.activeUplinkPortNames,e.manager.dvPortgroupData.failoverOrder.standbyUplinkPortNames),!e.manager.pageDirtyFlags.isFailoverPolicyPageDirty||!t.shouldShowErrorWarningDialog(e.failoverOrder.connectees,e.manager.dvPortgroupData.loadBalancing,e.manager.dvPortgroupData.beaconProbing)||t.showErrorWarningDialog(e.failoverOrder.connectees,e.manager.dvPortgroupData.loadBalancing,e.manager.dvPortgroupData.beaconProbing)}function r(e,t){return e.loadBalancing!==t.loadBalancing||e.beaconProbing!==t.beaconProbing||e.notifySwitches!==t.notifySwitches||e.rollingOrder!==t.rollingOrder}function n(){return{connectees:{active:e.initialData.failoverOrder.activeUplinkPortNames,standby:e.initialData.failoverOrder.standbyUplinkPortNames,unused:e.initialData.failoverOrder.unusedUplinkPortNames}}}function o(){return{loadBalancing:e.initialData.loadBalancing,beaconProbing:e.initialData.beaconProbing,notifySwitches:e.initialData.notifySwitches,rollingOrder:e.initialData.rollingOrder}}e.manager.commitPageCallbacks.commitFailoverPolicyPage=i,e.failoverOrder=t.createFailoverOrderSettings(e.manager.dvPortgroupData.failoverOrder);var a=o(),s=n();return this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupFailoverPolicyPageController",e),e.$inject=["$scope","dvpgFailoverPolicyPageService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){return e.manager.pageDirtyFlags.isGeneralPropertiesPageDirty=u(),!e.manager.pageDirtyFlags.isGeneralPropertiesPageDirty||c().then(function(t){return t.length>0&&e.manager.showDialogErrors(t),0===t.length})}function c(){var r=[],a=o.getInvalidNameError(e.manager.dvPortgroupData.name);if(a&&r.push(a),e.manager.dvPortgroupData.type===n.PortgroupType.EARLY_BINDING){var s=l();s&&r.push(s)}var c=t.getInvalidDescriptionError(e.manager.dvPortgroupData.description);if(c&&r.push(c),r.length>0)return i.resolve(r);var d=e.manager.dvPortgroupData;return e.initialData.name===d.name?i.resolve([]):o.getDuplicateOrTooLongNameError(d.dvPortgroupId,d.name)}function l(){var t;return t=e.manager.dvPortgroupData.initialNumPorts>n.DvPortgroupNumPorts.MAX?o.getNumPortsError(e.manager.dvPortgroupData.numPorts,e.manager.dvPortgroupData.initialNumPorts):o.getNumPortsError(e.manager.dvPortgroupData.numPorts)}function d(){var t=l();e.numPortsValidator.message=t,e.numPortsValidator.isVisible=null!==t}function u(){return e.manager.dvPortgroupData.name!==e.initialData.name||e.manager.dvPortgroupData.type!==e.initialData.type||e.manager.dvPortgroupData.autoExpand!==e.initialData.autoExpand||e.manager.dvPortgroupData.numPorts!==e.initialData.numPorts||e.manager.dvPortgroupData.description!==e.initialData.description||e.manager.dvPortgroupData.networkResourcePoolKey!==e.initialData.networkResourcePoolKey}return e.nameValidator={message:null,isVisible:!1},e.descriptionValidator={message:null,isVisible:!1},e.numPortsValidator={},e.portBindingOptions=[{label:a.getString("NetworkUtil.earlyBinding"),val:n.PortgroupType.EARLY_BINDING},{label:a.getString("NetworkUtil.ephemeral"),val:n.PortgroupType.EPHEMERAL}],e.portAllocationOptions=[{label:r.getString("NetworkUi","dvpg.properties.portAllocation.autoExpand.true"),val:!0},{label:r.getString("NetworkUi","dvpg.properties.portAllocation.autoExpand.false"),val:!1}],e.networkResourcePoolOptions=[],e.manager.dvPortgroupData.networkResourcePools&&e.manager.dvPortgroupData.networkResourcePools.length>0&&e.manager.dvPortgroupData.networkResourcePools.forEach(function(t){e.networkResourcePoolOptions.push({label:t.name,val:t.key})}),e.onNameChange=function(){var t=o.getInvalidNameError(e.manager.dvPortgroupData.name);e.nameValidator.message=t,e.nameValidator.isVisible=null!==t},e.onDescriptionChange=function(){var i=t.getInvalidDescriptionError(e.manager.dvPortgroupData.description);e.descriptionValidator.message=i,e.descriptionValidator.isVisible=null!==i},d(),e.onNumPortsChange=function(){d()},e.manager.commitPageCallbacks.commitGeneralPropertiesPage=s,e.manager.dvPortgroupData.isUplink||(e.$watch(function(){return e.manager.dvPortgroupData.type},function(t,i){switch(t){case n.PortgroupType.EARLY_BINDING:e.manager.dvPortgroupData.showPortAllocation=!0,e.manager.dvPortgroupData.showPortAllocationInfo=e.manager.dvPortgroupData.autoExpand;break;case n.PortgroupType.EPHEMERAL:e.manager.dvPortgroupData.showPortAllocation=!1,e.manager.dvPortgroupData.showPortAllocationInfo=!1}e.manager.dvPortgroupData.oldType===n.PortgroupType.LATE_BINDING&&i!==t&&(e.manager.dvPortgroupData.showDynamicPortBindingWarning=!1)}),e.$watch(function(){return e.manager.dvPortgroupData.autoExpand},function(t){e.manager.dvPortgroupData.showPortAllocationInfo=t&&n.PortgroupType.EARLY_BINDING===e.manager.dvPortgroupData.type})),this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupGeneralPropertiesPageController",e),e.$inject=["$scope","dvPortgroupGeneralPropertiesPageService","$q","i18nService","networkUiConstants","dvpgPropertiesService","networkUtil"]}(),function(){"use strict";function e(e,t){function i(t){return t&&(t=t.trim(),t.length>r)?e.getString("H5NetworkUi","dvpg.properties.description.tooLong"):null}var r=255;return{getInvalidDescriptionError:i}}angular.module("com.vmware.vsphere.client.dvs").service("dvPortgroupGeneralPropertiesPageService",e),e.$inject=["i18nService","mutationService"]}(),function(){"use strict";function e(e){function t(){return e.manager.pageDirtyFlags.isMiscellaneousPolicyPageDirty=i(),!0}function i(){return e.initialData.arePortsBlocked!==e.manager.dvPortgroupData.arePortsBlocked}return e.manager.commitPageCallbacks.commitMiscellaneousPolicyPage=t,this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupMiscellaneousPolicyPageController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e){function t(){return e.manager.pageDirtyFlags.isMonitoringPolicyPageDirty=i(),!0}function i(){return e.initialData.ipfixEnabled!==e.manager.dvPortgroupData.ipfixEnabled}return e.manager.commitPageCallbacks.commitMonitoringPolicyPage=t,this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupMonitoringPageController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e){function t(){return e.manager.pageDirtyFlags.isSecurityPolicyPageDirty=i(e.initialData,e.manager.dvPortgroupData),!0}function i(e,t){return e.allowPromiscuous!==t.allowPromiscuous||e.forgedTransmits!==t.forgedTransmits||e.macChanges!==t.macChanges}return e.manager.commitPageCallbacks.commitSecurityPolicyPage=t,this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupSecurityPolicyPageController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,t,i){function r(){if(e.manager.pageDirtyFlags.isTrafficShapingPageDirty=n(e.initialData.inShapingPolicy,e.manager.dvPortgroupData.inShapingPolicy)||n(e.initialData.outShapingPolicy,e.manager.dvPortgroupData.outShapingPolicy),e.manager.pageDirtyFlags.isTrafficShapingPageDirty){var r=i.getErrorMessages(e.manager.dvPortgroupData.inShapingPolicy,e.manager.dvPortgroupData.outShapingPolicy);return _.map(r,function(e){return{type:t.validationBanner.type.ERROR,text:e}})}return!0}function n(e,t){return e.enabled!==t.enabled||e.averageBandwidth!==t.averageBandwidth||e.peakBandwidth!==t.peakBandwidth||e.burstSize!==t.burstSize}return e.manager.commitPageCallbacks.commitTrafficShapingPage=r,this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupTrafficShapingPageController",e),e.$inject=["$scope","vuiConstants","dvpgTrafficShapingPolicyService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){if(e.manager.pageDirtyFlags.isVlanPageDirty=a(),e.manager.pageDirtyFlags.isVlanPageDirty)switch(e.manager.dvPortgroupData.vlanType){case i.Vlan.Type.VLAN:var o=r.getVlanIdError(e.manager.dvPortgroupData.vlanId);if(o)return e.manager.showDialogErrors([o]),!1;break;case i.Vlan.Type.TRUNK:return n.getTrunkVlanRanges(e.manager.dvPortgroupData.dvPortgroupId,e.manager.dvPortgroupData.vlanTrunkRanges).then(function(i){return e.manager.dvPortgroupData.vlanTrunkNumericRanges=i,!!i||(e.manager.showDialogErrors([t.getString("DvsUi","dvpg.policy.vlan.trunk.errorMessage")]),!1)});case i.Vlan.Type.PRIVATE:if(e.manager.dvPortgroupData.showPvlanError)return e.manager.showDialogErrors([t.getString("DvsUi","dvpg.policy.vlan.private.noConfig")]),!1}return!0}function a(){return e.manager.dvPortgroupData.vlanType!==e.initialData.vlanType||e.manager.dvPortgroupData.vlanId!==e.initialData.vlanId||e.manager.dvPortgroupData.vlanTrunkRanges!==e.initialData.vlanTrunkRanges||e.manager.dvPortgroupData.pvlanId!==e.initialData.pvlanId}return e.manager.commitPageCallbacks.commitVlanPage=o,this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortgroupVlanPageController",e),e.$inject=["$scope","i18nService","networkUiConstants","dvpgPropertiesService","dvPortgroupVlanPageService"]}(),function(){"use strict";function e(e,t){function i(i,r){return r?e.validate(i,"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupTrunkVlanSpec",{_type:"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupTrunkVlanSpec",numericRanges:r.trim()}).then(function(e){return e&&e.result},function(){return null}):t.resolve(null)}return{getTrunkVlanRanges:i}}angular.module("com.vmware.vsphere.client.dvs").service("dvPortgroupVlanPageService",e),e.$inject=["mutationService","$q"]}();var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvpgManageWizardConstants",{page:{POLICY_TYPE:"policyTypePage",SELECT_PORTGROUPS:"selectPortgroupsPage",
SECURITY_POLICY:"securityPolicyPage",VLAN:"vlanPage",TRAFFIC_SHAPING:"trafficShapingPage",FAILOVER_POLICY:"teamingAndFailoverPage",VM_VNIC_RESOURCE_POOL:"vmVnicResourcePoolPage",MONITORING:"monitoringPage",MISC:"miscPage",SUMMARY:"readyToCompletePage"},properties:{WIZARD_DATA:"manageDvpg:wizardData",POLICY_DATA:"manageDvpg:policiesData"},privileges:{DVPORTGROUP_MODIFY:"DVPortgroup.Modify"}})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.pageStateManagementService=e,this.dvpgManageWizardConstants=t,this.vuiConstants=i,this.pageIds=[this.dvpgManageWizardConstants.page.SECURITY_POLICY,this.dvpgManageWizardConstants.page.VLAN,this.dvpgManageWizardConstants.page.TRAFFIC_SHAPING,this.dvpgManageWizardConstants.page.FAILOVER_POLICY,this.dvpgManageWizardConstants.page.VM_VNIC_RESOURCE_POOL,this.dvpgManageWizardConstants.page.MONITORING,this.dvpgManageWizardConstants.page.MISC]}return e.prototype.init=function(e){var t=this;this.pages=e.wizardConfig.pages,this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e),e.$watchGroup(["model.policies.isSecurityPolicySelected","model.policies.isVlanPolicySelected","model.policies.isTrafficShapingPolicySelected","model.policies.isFailoverPolicySelected","model.policies.isResAllocPolicySelected","model.policies.isMonitoringPolicySelected","model.policies.isMiscPolicySelected"],function(e){t.updatePagesVisibility(e)})},e.prototype.updatePagesVisibility=function(e){var t=this;e.forEach(function(e,i){t.togglePageVisibility(t.pageIds[i],e)})},e.prototype.togglePageVisibility=function(e,t){var i=_.findWhere(this.pages,{id:e});t?i.state===this.vuiConstants.wizard.pageState.SKIPPED&&(i.state=this.vuiConstants.wizard.pageState.DISABLED):i.state=this.vuiConstants.wizard.pageState.SKIPPED},e.$inject=["pageStateManagementService","dvpgManageWizardConstants","vuiConstants"],e}();e.DvpgManageWizardFlowManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgManageWizardFlowManager",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.dvpgManageWizardConstants=t,this.simpleValidationCommit=i,this.policyTypeValidator=r,this.dvpgSelectPortgroupsPageValidator=n,this.dvpgVlanPageValidator=o,this.dvpgTrafficShapingPolicyService=a,this.dvpgFailoverPolicyPageValidator=s}return e.prototype.createPages=function(e){var t=this,i={id:this.dvpgManageWizardConstants.page.POLICY_TYPE,title:this.i18nService.getString("DvsUi","dvpg.manage.policyType.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policyType.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgPolicyTypePage.html",onCommit:this.simpleValidationCommit(function(){return t.policyTypeValidator.getValidationError(e)},e.wizardConfig),validationParams:["model.policies.isSecurityPolicySelected","model.policies.isTrafficShapingPolicySelected","model.policies.isVlanPolicySelected","model.policies.isFailoverPolicySelected","model.policies.isResAllocPolicySelected","model.policies.isTrafficFilterPolicySelected","model.policies.isMonitoringPolicySelected","model.policies.isMiscPolicySelected"]},r={id:this.dvpgManageWizardConstants.page.SELECT_PORTGROUPS,title:this.i18nService.getString("DvsUi","dvpg.manage.portGroupList.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.portGroupList.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgSelectPortgroupsPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvpgSelectPortgroupsPageValidator.getValidationError(e.model)},e.wizardConfig),validationParams:["model.selectedPortgroups"]},n={id:this.dvpgManageWizardConstants.page.SECURITY_POLICY,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.security.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.security.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgSecurityPolicyPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.securityPolicyModel.allowPromiscuous","model.securityPolicyModel.forgedTransmits","model.securityPolicyModel.macChanges"]},o={id:this.dvpgManageWizardConstants.page.VLAN,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.vlan.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.vlan.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgVlanPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvpgVlanPageValidator.getValidationError(e.model.selectedPortgroups[0].id,e.model.vlanPolicyModel)},e.wizardConfig),validationParams:["model.vlanPolicyModel.vlanType","model.vlanPolicyModel.vlanId","model.vlanPolicyModel.pvlanId","model.vlanPolicyModel.vlanTrunkRanges"]},a={id:this.dvpgManageWizardConstants.page.TRAFFIC_SHAPING,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.shaping.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.shaping.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgTrafficShapingPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvpgTrafficShapingPolicyService.getErrorMessages(e.model.trafficShapingPolicyModel.inShapingPolicy,e.model.trafficShapingPolicyModel.outShapingPolicy)},e.wizardConfig),validationParams:["model.trafficShapingPolicyModel.inShapingPolicy.enabled","model.trafficShapingPolicyModel.inShapingPolicy.averageBandwidth","model.trafficShapingPolicyModel.inShapingPolicy.peakBandwidth","model.trafficShapingPolicyModel.inShapingPolicy.burstSize","model.trafficShapingPolicyModel.outShapingPolicy.enabled","model.trafficShapingPolicyModel.outShapingPolicy.averageBandwidth","model.trafficShapingPolicyModel.outShapingPolicy.peakBandwidth","model.trafficShapingPolicyModel.outShapingPolicy.burstSize"]},s={id:this.dvpgManageWizardConstants.page.FAILOVER_POLICY,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.failover.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.failover.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgFailoverPolicyPage.html",onCommit:function(){return t.dvpgFailoverPolicyPageValidator.getValidationError(e).then(function(i){return t.simpleValidationCommit(function(){return i},e.wizardConfig).call(t)})},validationParams:["model.failoverPolicyModel.loadBalancing","model.failoverPolicyModel.beaconProbing","model.failoverPolicyModel.notifySwitches","model.failoverPolicyModel.rollingOrder","model.failoverPolicyModel.failoverOrder.activeUplinkPortNames","model.failoverPolicyModel.failoverOrder.standbyUplinkPortNames","model.failoverPolicyModel.failoverOrder.unusedUplinkPortNames"]},c={id:this.dvpgManageWizardConstants.page.VM_VNIC_RESOURCE_POOL,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.resourceAllocation.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.resourceAllocation.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgResourceAllocationPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.resourceAllocationPolicyModel.networkResourcePoolKey"]},l={id:this.dvpgManageWizardConstants.page.MONITORING,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgMonitoringPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.monitoringPolicyModel.ipfixEnabled"]},d={id:this.dvpgManageWizardConstants.page.MISC,title:this.i18nService.getString("DvsUi","dvpg.manage.policy.misc.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.policy.misc.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgMiscPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.miscPolicyModel.arePortsBlocked"]},u={id:this.dvpgManageWizardConstants.page.SUMMARY,title:this.i18nService.getString("DvsUi","dvpg.manage.summary.title"),description:this.i18nService.getString("DvsUi","dvpg.manage.summary.description"),contentUrl:"dvs-ui/resources/dvs/dvpg/manage/views/dvpgReadyToCompletePage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:[]};return[i,r,n,o,a,s,c,l,d,u]},e.$inject=["i18nService","dvpgManageWizardConstants","simpleValidationCommit","dvpgPolicyTypePageValidator","dvpgSelectPortgroupsPageValidator","dvpgVlanPageValidator","dvpgTrafficShapingPolicyService","dvpgFailoverPolicyPageValidator"],e}();e.DvpgManageWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgManageWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroup$ConfigSpec,i=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VmwarePortConfigPolicy,r=com.vmware.vim.binding.vim.StringPolicy,n=function(){function n(e,t,i,r,n,o,a,s,c,l,d){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.wizardValidationService=r,this.dvpgManageWizardFlowManager=n,this.dvpgManageWizardPages=o,this.dvpgSpecFactory=a,this.dvpgManageWizardConstants=s,this.networkUiConstants=c,this.dataService=l,this.mutationService=d}return n.prototype.show=function(t){var i=this,r=this.$rootScope.$new();r.flags=this.buildWizardFlags(),r.model=this.buildWizardModel(t),r.wizardConfig=new e.WizardConfig,r.wizardConfig.title=this.i18nService.getString("DvsUi","dvpg.manage.initialTitle"),r.wizardConfig.loading=!0,r.wizardConfig.loadingMessage=this.i18nService.getString("CommonUi","wizard.loading"),r.wizardConfig.cssClass="dvpg-manage-wizard",r.wizardConfig.onFinish=function(){return i.submitData(r),!0},r.wizardConfig.pages=this.dvpgManageWizardPages.createPages(r),this.wizardValidationService.initWizardValidation(r),this.dvpgManageWizardFlowManager.init(r),this.retrieveData(t,r),this.vuiWizardService({scope:r,configObjectName:"wizardConfig"}).show()},n.prototype.retrieveData=function(e,t){var i=this,r=this.dataService.getProperties(e,[this.dvpgManageWizardConstants.properties.WIZARD_DATA]);r.then(function(e){var r=e[i.dvpgManageWizardConstants.properties.WIZARD_DATA];t.model.dvsName=r.dvsName,t.wizardConfig.title=i.i18nService.getString("DvsUi","dvpg.manage.titleFormat",t.model.dvsName),t.wizardConfig.loading=!1})},n.prototype.submitData=function(e){var t=this,i=[];e.model.selectedPortgroups.forEach(function(r){var n=t.buildDvpgConfigSpec(r,e.model),o={entity:r.id,spec:n};i.push(o)}),this.mutationService.applyMulti(i[0].spec._type,i)},n.prototype.buildWizardModel=function(t){var i=new e.DvpgManageWizardModel;return i.parentId=t,i.policies=new e.DvpgManagePolicyModel,i.policies.isFailoverPolicySelected=!1,i.policies.isResAllocPolicySelected=!1,i.policies.isTrafficShapingPolicySelected=!1,i.policies.isTrafficFilterPolicySelected=!1,i.policies.isVlanPolicySelected=!1,i.policies.isMiscPolicySelected=!1,i.policies.isMonitoringPolicySelected=!1,i.policies.isSecurityPolicySelected=!1,i},n.prototype.buildWizardFlags=function(){var t=new e.DvpgManageWizardFlags;return t.isPolicyTypePageInitialized=!1,t},n.prototype.buildDvpgConfigSpec=function(e,n){var o=new t,a=this.networkUiConstants.ManageDvpgWizard.DVPG_CONFIG_VERSION_PROP;o.configVersion=e.rawData[a];var s=new i;if(o.defaultPortConfig=s,n.policies.isVlanPolicySelected&&(s.vlan=this.dvpgSpecFactory.buildVlanSpec(n.vlanPolicyModel)),n.policies.isTrafficShapingPolicySelected&&(s.inShapingPolicy=this.dvpgSpecFactory.buildTrafficShapingSpec(n.trafficShapingPolicyModel.inShapingPolicy),s.outShapingPolicy=this.dvpgSpecFactory.buildTrafficShapingSpec(n.trafficShapingPolicyModel.outShapingPolicy)),n.policies.isSecurityPolicySelected&&(s.securityPolicy=this.dvpgSpecFactory.buildSecurityPolicySpec(n.securityPolicyModel)),n.policies.isFailoverPolicySelected&&(s.uplinkTeamingPolicy=this.dvpgSpecFactory.buildTeamingAndFailoverSpec(n.failoverPolicyModel)),n.policies.isMonitoringPolicySelected&&(s.ipfixEnabled=this.dvpgSpecFactory.buildMonitoringSpec(n.monitoringPolicyModel)),n.policies.isMiscPolicySelected&&(s.blocked=this.dvpgSpecFactory.buildMiscSpec(n.miscPolicyModel)),n.policies.isResAllocPolicySelected){var c=this.dvpgSpecFactory.buildResourcePoolAllocationSpec(n.resourceAllocationPolicyModel);c instanceof r?o.defaultPortConfig.networkResourcePoolKey=c:o.vmVnicNetworkResourcePoolKey=c}return o},n.$inject=["$rootScope","i18nService","vuiWizardService","wizardValidationService","dvpgManageWizardFlowManager","dvpgManageWizardPages","dvpgSpecFactory","dvpgManageWizardConstants","networkUiConstants","dataService","mutationService"],n}();e.DvpgManageWizardService=n,angular.module("com.vmware.vsphere.client.dvs").service("dvpgManageWizardService",n)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgManagePolicyModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgManageWizardFlags=t}(dvs_ui||(dvs_ui={}));var DvpgSecurityPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgSecurityPolicyModel,DvpgFailoverPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgFailoverPolicyModel,DvpgResourceAllocationPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgResourceAllocationPolicyModel,DvpgTrafficShapingPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgTrafficShapingPolicyModel,DvpgVlanPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgVlanPolicyModel,DvpgMonitoringPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgMonitoringPolicyModel,DvpgMiscPolicyModel=com.vmware.vsphere.client.h5.network.dvportgroup.common.model.DvpgMiscPolicyModel,dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgManageWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.$q=t,this.dvpgFailoverPolicyPageService=i}return e.prototype.getValidationError=function(e){return this.dvpgFailoverPolicyPageService.shouldShowErrorWarningDialog(e.model.failoverOrderOptions.connectees,e.model.failoverPolicyModel.loadBalancing,e.model.failoverPolicyModel.beaconProbing)?this.dvpgFailoverPolicyPageService.showErrorWarningDialog(e.model.failoverOrderOptions.connectees,e.model.failoverPolicyModel.loadBalancing,e.model.failoverPolicyModel.beaconProbing):this.$q.resolve(!0)},e.$inject=["i18nService","$q","dvpgFailoverPolicyPageService"],e}();e.DvpgFailoverPolicyPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgFailoverPolicyPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t}return e.prototype.getValidationError=function(e){var t=[];return e.model.policies.isSecurityPolicySelected||e.model.policies.isVlanPolicySelected||e.model.policies.isTrafficShapingPolicySelected||e.model.policies.isTrafficFilterPolicySelected||e.model.policies.isMonitoringPolicySelected||e.model.policies.isMiscPolicySelected||e.model.policies.isResAllocPolicySelected||e.model.policies.isFailoverPolicySelected||t.push(this.i18nService.getString("DvsUi","dvpg.manage.policyType.noPoliciesSelected")),this.$q.resolve(t)},e.$inject=["i18nService","$q"],e}();e.DvpgPolicyTypePageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgPolicyTypePageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.dvpgManageWizardConstants=t,this.authorizationService=i,this.$q=r,this.dvpgEditPrivilege=this.dvpgManageWizardConstants.privileges.DVPORTGROUP_MODIFY}return e.prototype.getValidationError=function(e){var t=[];return e.selectedPortgroups&&0!==e.selectedPortgroups.length?this.getNoPrivilegesValidationError(e):(t.push(this.i18nService.getString("DvsUi","dvpg.manage.portGroupList.noPortGroupsSelected")),this.$q.when(t))},e.prototype.getNoPrivilegesValidationError=function(e){var t=this,i=_.map(e.selectedPortgroups,function(e){return e.id});return this.authorizationService.checkPrivilegesForMultipleObjects(i,[this.dvpgEditPrivilege]).then(function(i){return t.buildNoPrivilegesValidationMessages(i,e.selectedPortgroups)})},e.prototype.buildNoPrivilegesValidationMessages=function(e,t){var i=this,r=[];return Object.keys(e).forEach(function(n){if(e[n][i.dvpgEditPrivilege]===!1){var o=i.getPortgroupName(n,t);o&&r.push(i.i18nService.getString("DvsUi","dvpg.manage.portGroupList.noPrivilegesFormat",o))}}),r},e.prototype.getPortgroupName=function(e,t){for(var i=0;i<t.length;i++)if(e===t[i].id)return t[i].name;return null},e.$inject=["i18nService","dvpgManageWizardConstants","authorizationService","$q"],e}();e.DvpgSelectPortgroupsPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgSelectPortgroupsPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$q=e,this.i18nService=t,this.networkUiConstants=i,this.dvpgPropertiesService=r,this.dvPortgroupVlanPageService=n}return e.prototype.getValidationError=function(e,t){var i=this,r=[];switch(t.vlanType){case this.networkUiConstants.Vlan.Type.VLAN:var n=this.dvpgPropertiesService.getVlanIdError(t.vlanId);if(n)return this.$q.resolve([n]);break;case this.networkUiConstants.Vlan.Type.TRUNK:return this.dvPortgroupVlanPageService.getTrunkVlanRanges(e,t.vlanTrunkRanges).then(function(e){if(!e){var n=i.i18nService.getString("DvsUi","dvpg.policy.vlan.trunk.errorMessage");return[n]}return t.vlanTrunkNumericRanges=e,i.$q.resolve(r)});case this.networkUiConstants.Vlan.Type.PRIVATE:if(!t.pvlanConfig||0===t.pvlanConfig.length){var o=this.i18nService.getString("DvsUi","dvpg.policy.vlan.private.noConfig");return this.$q.resolve([o])}}return this.$q.resolve(r)},e.$inject=["$q","i18nService","networkUiConstants","dvpgPropertiesService","dvPortgroupVlanPageService"],e}();e.DvpgVlanPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgVlanPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<",wizardFlags:"<",wizardConfig:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/manage/views/dvpgPolicyTypePageTemplate.html"}return e}();e.DvpgPolicyTypePageComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$scope=t,this.dataService=i,this.wizardConstants=r,this.dvpgFailoverPolicyPageService=n,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.wizardFlags.isPolicyTypePageInitialized?this.buildSignpostItems():(this.wizardConfig.loading=!0,this.requestPolicyAvailabilityData())},e.prototype.requestPolicyAvailabilityData=function(){var e=this;this.dataService.getProperties(this.wizardModel.parentId,[this.wizardConstants.properties.POLICY_DATA]).then(function(t){var i=t[e.wizardConstants.properties.POLICY_DATA];e.wizardModel.policies.availability=i.policyTypeModel,e.wizardModel.securityPolicyModel=i.securityPolicyModel,e.wizardModel.failoverPolicyModel=i.failoverPolicyModel,e.wizardModel.failoverOrderOptions=e.dvpgFailoverPolicyPageService.createFailoverOrderSettings(e.wizardModel.failoverPolicyModel.failoverOrder),e.wizardModel.resourceAllocationPolicyModel=i.resourceAllocationPolicyModel,e.wizardModel.trafficShapingPolicyModel=i.trafficShapingPolicyModel,e.wizardModel.vlanPolicyModel=i.vlanPolicyModel,e.wizardModel.monitoringPolicyModel=i.monitoringPolicyModel,e.wizardModel.miscPolicyModel=i.miscPolicyModel,e.buildSignpostItems(),e.wizardConfig.loading=!1,e.wizardFlags.isPolicyTypePageInitialized=!0})},e.prototype.buildSignpostItem=function(e,t,i){var r="<b>%title%</b><br/>".replace("%title%",e),n="<div class='horizontal-flex-container'>"+"<span class='dvpg-manage-policy-type-description-item'>%description%</span><br/></div>".replace("%description%",t),o=r+n,a="<div data-test-id='dvpg-manage-policy-type-%id%'>%content%<br/></div>".replace("%content%",o).replace("%id%",i);return a},e.prototype.buildSignpostItems=function(){var e="";this.wizardModel.policies.availability.isSecurityPolicyAvailable&&(e=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.security.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.security.description"),"security")),e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.shaping.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.shaping.description"),"traffic-shaping"),this.wizardModel.policies.availability.isVlanPolicyAvailable&&(e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.vlan.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.vlan.description"),"vlan")),this.wizardModel.policies.availability.isFailoverPolicyAvailable&&(e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.failover.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.failover.description"),"failover")),this.wizardModel.policies.availability.isResAllocPolicyAvailable&&(e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.resourceAllocation.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.resourceAllocation.description"),"resource-allocation")),this.wizardModel.policies.availability.isMonitoringPolicyAvailable&&(e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.description"),"monitoring")),this.wizardModel.policies.availability.isTrafficFilterPolicyAvailable&&(e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.trafficFilter.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.trafficFilter.description"),"traffic-filter")),e+=this.buildSignpostItem(this.i18nService.getString("DvsUi","dvpg.manage.policy.misc.title"),this.i18nService.getString("DvsUi","dvpg.manage.policy.misc.description"),"misc"),this.signPostConfig={message:"<div class='dvpg-manage-policy-type-content'>%content%</div>".replace("%content%",e),title:this.i18nService.getString("DvsUi","dvpg.manage.policyType.signpost.title")}},e.$inject=["i18nService","$scope","dataService","dvpgManageWizardConstants","dvpgFailoverPolicyPageService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgPolicyTypePage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/manage/views/dvpgReadyToCompletePageTemplate.html"}return e}();e.DvpgReadyToCompletePageComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.vxPropertyViewService=t}return e.prototype.$onInit=function(){this.buildPropertyView()},e.prototype.buildPropertyView=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general"),i=t.section("generalSection"),r=t.section("updatedPoliciesSection").title(this.i18nService.getString("DvsUi","dvpg.manage.summary.policiesToUpdate"));i.property(this.i18nService.getString("DvsUi","dvpg.manage.summary.portGroupCount"),this.wizardModel.selectedPortgroups.length),this.wizardModel.policies.isSecurityPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.security.title")),this.wizardModel.policies.isTrafficShapingPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.shaping.title")),this.wizardModel.policies.isVlanPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.vlan.title")),this.wizardModel.policies.isFailoverPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.failover.title")),this.wizardModel.policies.isResAllocPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.resourceAllocation.title")),this.wizardModel.policies.isMonitoringPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.monitoring.title")),this.wizardModel.policies.isTrafficFilterPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.trafficFilter.title")),this.wizardModel.policies.isMiscPolicySelected&&r.property(this.i18nService.getString("DvsUi","dvpg.manage.policy.misc.title")),this.propertyViewData=e.build()},e.$inject=["i18nService","vxPropertyViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgReadyToCompletePage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/manage/views/dvpgResourceAllocationPageTemplate.html"}return e}();e.DvpgResourceAllocationPageComponent=t;var i=function(){function e(e){this.i18nService=e}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgResourceAllocationPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/manage/views/dvpgSelectPortgroupsPageTemplate.html"}return e}();e.DvpgSelectPortgroupsPageComponent=t;var i=function(){function e(e){this.i18nService=e,this.isInitializing=!0}return e.prototype.$onInit=function(){var e=this;this.config={contextObject:this.wizardModel.parentId,multipleSelect:!0,listTabConfig:{label:this.i18nService.getString("DvsUi","dvpg.manage.portGroupList.tabs.filter"),listConfig:[{label:"Select distributed portgroups",listViewId:"vsphere.core.dvs.dvpg.manage.list",dataModels:["DistributedVirtualPortgroup"],filterId:"dvpgObjectsFilter",filterParams:[]}]},selectedObjects:_.map(this.wizardModel.selectedPortgroups,function(e){return e.id}),onSelectionChanged:function(t){!e.isInitializing||_.isEmpty(e.wizardModel.selectedPortgroups)?(e.isInitializing=!1,e.wizardModel.selectedPortgroups=t):t.length===e.wizardModel.selectedPortgroups.length&&(e.isInitializing=!1)}}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgSelectPortgroupsPage",new t)}(dvs_ui||(dvs_ui={})),function(){"use strict";function e(e,t,i,r){function n(e){o.dvPortgroupPoliciesData=i.build(e)}var o=this;o.dvPortgroupId=e._route.objectId;var a="dvpg:dvPortgroupPolicies",s={title:r.getString("NetworkUi","dvpg.manage.settings.policiesHeader"),objectId:o.dvPortgroupId,actions:[{actionUid:"vsphere.core.dvPortgroup.editSettingsAction",customLabel:r.getString("H5NetworkUi","dvpg.properties.actions.edit.label")}]};o.settingsViewHeaderAccessor={},o.headerOptions=s,o.refresh=function(){o.loading=!0,o.settingsViewHeaderAccessor&&o.settingsViewHeaderAccessor.refresh&&o.settingsViewHeaderAccessor.refresh(),t.getProperties(o.dvPortgroupId,[a]).then(function(e){o.loading=!1,e&&e[a]&&n(e[a])}),o.liveRefreshProperties=["config.defaultPortConfig.vlan","config.defaultPortConfig.vlan.vlanId","config.defaultPortConfig.vlan.pvlanId","config.defaultPortConfig.uplinkTeamingPolicy.failureCriteria.checkBeacon.value","config.defaultPortConfig.uplinkTeamingPolicy.policy.value","config.defaultPortConfig.uplinkTeamingPolicy.notifySwitches.value","config.defaultPortConfig.uplinkTeamingPolicy.rollingOrder.value","config.defaultPortConfig.uplinkTeamingPolicy.uplinkPortOrder.value","config.defaultPortConfig.uplinkTeamingPolicy.uplinkPortOrder.activeUplinkPort","config.defaultPortConfig.uplinkTeamingPolicy.uplinkPortOrder.standbyUplinkPort","config.defaultPortConfig.securityPolicy.macChanges.value","config.defaultPortConfig.securityPolicy.forgedTransmits.value","config.defaultPortConfig.securityPolicy.allowPromiscuous.value","config.defaultPortConfig.outShapingPolicy.burstSize.value","config.defaultPortConfig.outShapingPolicy.peakBandwidth.value","config.defaultPortConfig.outShapingPolicy.averageBandwidth.value","config.defaultPortConfig.outShapingPolicy.enabled.value","config.defaultPortConfig.inShapingPolicy.averageBandwidth.value","config.defaultPortConfig.inShapingPolicy.peakBandwidth.value","config.defaultPortConfig.inShapingPolicy.enabled.value","config.defaultPortConfig.inShapingPolicy.burstSize.value","config.defaultPortConfig.blocked.value","config.defaultPortConfig.ipfixEnabled.value"]},o.refresh()}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortrgroupPoliciesViewController",e),e.$inject=["$scope","dataService","distributedPortgroupPoliciesViewService","i18nService"]}(),function(){"use strict";function e(e,t,i,r){var n=this;n.dvPortgroupId=t._route.objectId;var o="dvpg:dvPortgroupProperties",a={title:e.getString("NetworkUi","dvpg.manage.settings.propertiesHeader"),objectId:n.dvPortgroupId,actions:[{actionUid:"vsphere.core.dvPortgroup.editSettingsAction",customLabel:e.getString("H5NetworkUi","dvpg.properties.actions.edit.label")}]};return n.settingsViewHeaderAccessor={},n.headerOptions=a,n.refresh=function(){n.loading=!0,n.settingsViewHeaderAccessor&&n.settingsViewHeaderAccessor.refresh&&n.settingsViewHeaderAccessor.refresh(),i.getProperties(n.dvPortgroupId,[o]).then(function(e){n.loading=!1,e&&e[o]&&(n.dvPortgroupPropertiesData=r.buildProperties(e[o]))}),n.liveRefreshProperties=["config.name","config.description","config.type","config.numPorts","config.autoExpand","config.vmVnicNetworkResourcePoolKey","config.policy.portConfigResetAtDisconnect","config.policy.securityPolicyOverrideAllowed","config.policy.vlanOverrideAllowed","config.policy.vendorConfigOverrideAllowed","config.policy.uplinkTeamingOverrideAllowed","config.policy.ipfixOverrideAllowed","config.policy.trafficFilterOverrideAllowed","config.policy.blockOverrideAllowed","config.policy.shapingOverrideAllowed"]},n.refresh(),this}angular.module("com.vmware.vsphere.client.dvs").controller("DvPortrgroupPropertiesViewController",e),e.$inject=["i18nService","$scope","dataService","dvPortgroupPropertiesService"]}();var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/summary/components/dvpgDetailsComponentTemplate.html"}return e}();e.DvpgDetailsComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$rootScope=t,this.dataService=i,this.defaultUriSchemeUtil=r,this.navigation=n}return e.prototype.$onInit=function(){this.requestData()},e.prototype.refresh=function(){this.requestData()},Object.defineProperty(e.prototype,"switchName",{get:function(){return this._data&&this._data.switchName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"switchIconId",{get:function(){return this._data&&this._data.switchIconId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numHosts",{get:function(){return this._data&&this._data.numHosts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numVms",{get:function(){return this._data&&this._data.numVms},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ipPoolName",{get:function(){return this._data&&(this._data.ipPoolName||this.i18nService.getString("NetworkUi","NetworkUtil.noData"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nrpName",{get:function(){return this._data&&(this._data.nrpName||this.i18nService.getString("NetworkUi","NetworkUtil.noData"))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUplink",{get:function(){return this._data&&this._data.isUplink},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showNrpIcon",{get:function(){return this._data&&this._data.nrpName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDvs",{get:function(){return this._data&&this._data.showDvsData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showNrp",{get:function(){return this._data&&this._data.showNrp;
},enumerable:!0,configurable:!0}),e.prototype.navigateToDvs=function(){var t=this.defaultUriSchemeUtil.getVsphereObjectId(this._data.switchMor);this.navigation.navigateToViewAndObject(e.SERVER_OBJECT_VIEWS_EXTENSION,t)},e.prototype.navigateToNrp=function(){var t=this.defaultUriSchemeUtil.getVsphereObjectId(this._data.nrpMor).replace("vmomi","nrp"),i=this.defaultUriSchemeUtil.getVsphereObjectId(this._data.switchMor);this.navigation.navigateToRelatedObject(i,e.NRPS_FOR_DVS_RELATION,t)},e.prototype.requestData=function(){var e=this;this.dvpgUri=this.$rootScope._route.objectId,e.loadingData=!0,e.dataService.getProperties(this.dvpgUri,["dvpg:dvPortgroupDetails"]).then(function(t){e._data=t["dvpg:dvPortgroupDetails"],e.loadingData=!1}),e.liveRefreshProperties=["vm","summary","host"]},e.$inject=["i18nService","$rootScope","dataService","defaultUriSchemeUtil","navigation"],e.SERVER_OBJECT_VIEWS_EXTENSION="vsphere.core.inventory.serverObjectViewsExtension",e.NRPS_FOR_DVS_RELATION="nrpsForDvs",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgDetails",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",onIpValidate:"=",onMacValidate:"="},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/add/dvpgAddTrafficRuleTemplate.html"}return e}();e.DvpgAddTrafficRuleComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.trafficFilterService=t,this.trafficFilterConstants=i,this.dvpgTrafficRuleValidator=r,this.vxValidatorFactory=n,this.i18n=this.i18nService.getString,this.directions=this.trafficFilterService.getTrafficFilterDirections(),this.actions=this.trafficFilterService.getTrafficFilterActions(),this.qosTagPlaceholderText=this.trafficFilterConstants.tag.MIN_MAX_COS_TAG,this.dscpTagPlaceholderText=this.trafficFilterConstants.tag.MIN_MAX_DSCP_TAG,this.validateRuleName=this.ruleNameValidator.bind(this),this.validateTags=this.tagsValidator.bind(this),this.validator=this.vxValidatorFactory.create()}return e.prototype.$onInit=function(){this.signPostConfig={message:this.i18n("DvsUi","trafficFilter.ruleDialog.trafficDirectionInfo"),title:this.i18n("DvsUi","trafficFilter.ruleDialog.trafficDirectionInfo.title"),"class":"traffic-rule-direction-signpost"}},e.prototype.ruleNameValidator=function(){return this.dvpgTrafficRuleValidator.isValidRuleName(this.model.name)?[]:[this.i18n("DvsUi","trafficFilter.ruleDialog.exceededMaxLength")]},e.prototype.tagsValidator=function(){var e=[];return this.model.qosTagSelected&&!this.dvpgTrafficRuleValidator.isValidQosTag(this.model.qosTagValue)&&e.push(this.i18n("DvsUi","trafficFilter.ruleDialog.invalidQosTag")),this.model.dscpTagSelected&&!this.dvpgTrafficRuleValidator.isValidDscpTag(this.model.dscpTagValue)&&e.push(this.i18n("DvsUi","trafficFilter.ruleDialog.invalidDscpTag")),e},e.$inject=["i18nService","dvpgTrafficFilterService","dvpgTrafficFilterConstants","dvpgTrafficRuleValidator","vxValidatorFactory"],e}();e.DvpgAddTrafficRuleContoller=i,angular.module("com.vmware.vsphere.client.dvs").component("dvpgAddTrafficRule",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/clone/dvpgCloneTrafficRulesTemplate.html"}return e}();e.DvpgCloneTrafficRulesComponent=t;var i=function(){function e(e){this.i18nService=e}return e.prototype.$onInit=function(){var e=this;this.selectPortgroupsMessage=this.i18nService.getString("DvsUi","trafficFilter.cloneRulesDialog.description"),this.cloneRulesInfoMessage=this.i18nService.getString("DvsUi","trafficFilter.cloneRulesDialog.info",this.model.dvpgName),this.portGroupConfig={contextObject:this.model.dvsId,multipleSelect:!0,listTabConfig:{label:this.i18nService.getString("DvsUi","dvpg.manage.portGroupList.tabs.filter"),listConfig:[{label:"",listViewId:"vsphere.core.dvs.dvpg.manage.list",dataModels:["DistributedVirtualPortgroup"],filterId:"dvpgExcludedObjectsFilter",filterParams:[this.model.dvpgId]}]},selectedObjects:_.map(this.model.selectedPortgroups,function(e){return e.id}),onSelectionChanged:function(t){e.model.selectedPortgroups=t}}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgCloneTrafficRules",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgCloneTrafficRulesModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",onValidate:"="},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/common/dvpgIpQualifierTemplate.html"}return e}();e.DvpgIpQualifierComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.trafficFilterService=t,this.trafficFilterConstants=i,this.ipQualifierValidator=r,this.vxValidatorFactory=n,this.showProtocolError=!1,this.showSourcePortError=!1,this.showSourcePortEndError=!1,this.showDestPortError=!1,this.showDestPortEndError=!1,this.showSourceIpError=!1,this.showDestIpError=!1,this.showSourcePrefixError=!1,this.showDestPrefixError=!1,this.showAllErrors=!1,this.i18n=this.i18nService.getString,this.constants=this.trafficFilterConstants,this.protocolTypes=this.trafficFilterService.getIpQualifierProtocolTypes(),this.protocolOperations=this.trafficFilterService.getQualifiersProtocolOperations(),this.portOperations=this.trafficFilterService.getIpQualifierPortOperations(),this.ipAddressOperations=this.trafficFilterService.getQualifiersAddressOperations(),this.ipAddressTypes=this.trafficFilterService.getIpQualifierIpAddressTypes(),this.cosTagPlaceholderText=this.trafficFilterConstants.tag.MIN_MAX_COS_TAG,this.dscpTagPlaceholderText=this.trafficFilterConstants.tag.MIN_MAX_DSCP_TAG,this.protocolValidationFunction=this.validateProtocol.bind(this),this.sourcePortValidationFunction=this.validateSourcePort.bind(this),this.destPortValidationFunction=this.validateDestPort.bind(this),this.sourcePortEndValidationFunction=this.validateSourcePortEnd.bind(this),this.destPortEndValidationFunction=this.validateDestPortEnd.bind(this),this.sourceIpValidationFunction=this.validateSourceIpAddress.bind(this),this.destIpValidationFunction=this.validateDestIpAddress.bind(this),this.sourcePrefixValidationFunction=this.validateSourcePrefixLength.bind(this),this.destPrefixValidationFunction=this.validateDestPrefixLength.bind(this),this.initValidators()}return e.prototype.$onInit=function(){this.onValidate&&(this.onValidate.validate=this.validate.bind(this))},e.prototype.validate=function(){this.showAllErrors=!0,this.ipProtocolValidator.validate(),this.sourcePortValidator.validate(),this.sourcePortEndValidator.validate(),this.destPortValidator.validate(),this.destPortEndValidator.validate(),this.sourceIpValidator.validate(),this.sourcePrefixLengthValidator.validate(),this.destIpValidator.validate(),this.destPrefixLengthValidator.validate(),this.showAllErrors=!1},e.prototype.initValidators=function(){this.ipProtocolValidator=this.vxValidatorFactory.create(),this.sourcePortValidator=this.vxValidatorFactory.create(),this.sourcePortEndValidator=this.vxValidatorFactory.create(),this.destPortValidator=this.vxValidatorFactory.create(),this.destPortEndValidator=this.vxValidatorFactory.create(),this.sourceIpValidator=this.vxValidatorFactory.create(),this.sourcePrefixLengthValidator=this.vxValidatorFactory.create(),this.destIpValidator=this.vxValidatorFactory.create(),this.destPrefixLengthValidator=this.vxValidatorFactory.create()},e.prototype.onProtocolChanged=function(){this.model.protocol.customValue||(this.showProtocolError=!1),this.ipProtocolValidator.validate()},e.prototype.onProtocolBlur=function(){this.showProtocolError=!0,this.ipProtocolValidator.validate()},e.prototype.validateProtocol=function(){if(this.showAllErrors||this.showProtocolError){var e=this.ipQualifierValidator.getProtocolError(this.model.protocol);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onSourcePortChanged=function(){this.model.sourcePort.port||(this.showSourcePortError=!1),this.model.sourcePort.portRangeEnd||(this.showSourcePortEndError=!1),this.sourcePortValidator.validate(),this.sourcePortEndValidator.validate()},e.prototype.onSourcePortBlur=function(){this.showSourcePortError=!0,this.sourcePortValidator.validate()},e.prototype.validateSourcePort=function(){if(this.showAllErrors||this.showSourcePortError){var e=this.ipQualifierValidator.getPortError(this.model.sourcePort,!0);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onSourcePortEndBlur=function(){this.showSourcePortEndError=!0,this.sourcePortEndValidator.validate()},e.prototype.validateSourcePortEnd=function(){if(this.showAllErrors||this.showSourcePortEndError){var e=this.ipQualifierValidator.getPortRangeError(this.model.sourcePort,!0);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onDestPortChanged=function(){this.model.destinationPort.port||(this.showDestPortError=!1),this.model.destinationPort.portRangeEnd||(this.showDestPortEndError=!1),this.destPortValidator.validate(),this.destPortEndValidator.validate()},e.prototype.onDestPortBlur=function(){this.showDestPortError=!0,this.destPortValidator.validate()},e.prototype.validateDestPort=function(){if(this.showAllErrors||this.showDestPortError){var e=this.ipQualifierValidator.getPortError(this.model.destinationPort,!1);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onDestPortEndBlur=function(){this.showDestPortEndError=!0,this.destPortEndValidator.validate()},e.prototype.validateDestPortEnd=function(){if(this.showAllErrors||this.showDestPortEndError){var e=this.ipQualifierValidator.getPortRangeError(this.model.destinationPort,!1);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onSourceIpChanged=function(){this.model.sourceIpAddress.ipAddress||(this.showSourceIpError=!1),this.model.sourceIpAddress.prefixLength||(this.showSourcePrefixError=!1),this.sourceIpValidator.validate(),this.sourcePrefixLengthValidator.validate()},e.prototype.onSourceIpBlur=function(){this.showSourceIpError=!0,this.sourceIpValidator.validate()},e.prototype.validateSourceIpAddress=function(){if(this.showAllErrors||this.showSourceIpError){var e=this.ipQualifierValidator.getIpAddressError(this.model.sourceIpAddress,!0);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onSourcePrefixLengthBlur=function(){this.showSourcePrefixError=!0,this.sourcePrefixLengthValidator.validate()},e.prototype.validateSourcePrefixLength=function(){if(this.showAllErrors||this.showSourcePrefixError){var e=this.ipQualifierValidator.getPrefixLengthError(this.model.sourceIpAddress,!0);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onDestIpChanged=function(){this.model.destinationIpAddress.ipAddress||(this.showDestIpError=!1),this.model.destinationIpAddress.prefixLength||(this.showDestPrefixError=!1),this.destIpValidator.validate(),this.destPrefixLengthValidator.validate()},e.prototype.onDestIpBlur=function(){this.showDestIpError=!0,this.destIpValidator.validate()},e.prototype.validateDestIpAddress=function(){if(this.showAllErrors||this.showDestIpError){var e=this.ipQualifierValidator.getIpAddressError(this.model.destinationIpAddress,!1);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onDestPrefixLengthBlur=function(){this.showDestPrefixError=!0,this.destPrefixLengthValidator.validate()},e.prototype.validateDestPrefixLength=function(){if(this.showAllErrors||this.showDestPrefixError){var e=this.ipQualifierValidator.getPrefixLengthError(this.model.destinationIpAddress,!1);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.$inject=["i18nService","dvpgTrafficFilterService","dvpgTrafficFilterConstants","dvpgIpQualifierValidator","vxValidatorFactory"],e}();e.DvpgIpQualifierContoller=i,angular.module("com.vmware.vsphere.client.dvs").component("dvpgIpQualifier",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",onValidate:"="},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/common/dvpgMacQualifierTemplate.html"}return e}();e.DvpgMacQualifierComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.trafficFilterService=t,this.trafficFilterConstants=i,this.macQualifierValidator=r,this.vxValidatorFactory=n,this.showProtocolError=!1,this.showVlanError=!1,this.showSourceMacError=!1,this.showDestMacError=!1,this.showSourceWildcardError=!1,this.showDestWildcardError=!1,this.showErrors=!1,this.i18n=this.i18nService.getString,this.constants=this.trafficFilterConstants}return e.prototype.$onInit=function(){this.protocolTypes=this.trafficFilterService.getMacQualifierProtocolTypes(),this.protocolOperations=this.trafficFilterService.getQualifiersProtocolOperations(),this.vlanOperations=this.trafficFilterService.getMacQualifierVlanOperations(),this.macAddressOperations=this.trafficFilterService.getQualifiersAddressOperations(),this.protocolValidationFunction=this.validateProtocol.bind(this),this.vlanIdValidationFunction=this.validateVlan.bind(this),this.sourceMacValidationFunction=this.validateSourceMac.bind(this),this.destMacValidationFunction=this.validateDestMac.bind(this),this.sourceWildcardValidationFunction=this.validateSourceWildcard.bind(this),this.destWildcardValidationFunction=this.validateDestWildcard.bind(this),this.initValidators(),this.onValidate&&(this.onValidate.validate=this.validate.bind(this))},e.prototype.validate=function(){this.showErrors=!0,this.macProtocolValidator.validate(),this.vlanIdValidator.validate(),this.sourceMacValidator.validate(),this.sourceWildcardValidator.validate(),this.destMacValidator.validate(),this.destWildcardValidator.validate(),this.showErrors=!1},e.prototype.initValidators=function(){this.macProtocolValidator=this.vxValidatorFactory.create(),this.vlanIdValidator=this.vxValidatorFactory.create(),this.sourceMacValidator=this.vxValidatorFactory.create(),this.sourceWildcardValidator=this.vxValidatorFactory.create(),this.destMacValidator=this.vxValidatorFactory.create(),this.destWildcardValidator=this.vxValidatorFactory.create()},e.prototype.onProtocolChanged=function(){this.model.protocol.customValue||(this.showProtocolError=!1),this.macProtocolValidator.validate()},e.prototype.onProtocolBlur=function(){this.showProtocolError=!0,this.macProtocolValidator.validate()},e.prototype.validateProtocol=function(){if(this.showErrors||this.showProtocolError){var e=this.macQualifierValidator.getProtocolError(this.model.protocol);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onVlanChanged=function(){this.model.vlanId||(this.showVlanError=!1),this.vlanIdValidator.validate()},e.prototype.onVlanBlur=function(){this.showVlanError=!0,this.vlanIdValidator.validate()},e.prototype.validateVlan=function(){if(this.showErrors||this.showVlanError){var e=this.macQualifierValidator.getVlanError(this.model.vlanId,this.model.vlanOperation);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onSourceMacChanged=function(){this.model.sourceMacAddress.macAddress||(this.showSourceMacError=!1),this.model.sourceMacAddress.wildcardMask||(this.showSourceWildcardError=!1),this.sourceMacValidator.validate(),this.sourceWildcardValidator.validate()},e.prototype.onSourceMacBlur=function(){this.showSourceMacError=!0,this.sourceMacValidator.validate()},e.prototype.validateSourceMac=function(){if(this.showErrors||this.showSourceMacError){var e=this.macQualifierValidator.getMacAddressError(this.model.sourceMacAddress,!0);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onSourceWildcardBlur=function(){this.showSourceWildcardError=!0,this.sourceWildcardValidator.validate()},e.prototype.validateSourceWildcard=function(){if(this.showErrors||this.showSourceWildcardError){var e=this.macQualifierValidator.getWildcardMaskError(this.model.sourceMacAddress,!0);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onDestMacChanged=function(){this.model.destinationMacAddress.macAddress||(this.showDestMacError=!1),this.model.destinationMacAddress.wildcardMask||(this.showDestWildcardError=!1),this.destMacValidator.validate(),this.destWildcardValidator.validate()},e.prototype.onDestMacBlur=function(){this.showDestMacError=!0,this.destMacValidator.validate()},e.prototype.validateDestMac=function(){if(this.showErrors||this.showDestMacError){var e=this.macQualifierValidator.getMacAddressError(this.model.destinationMacAddress,!1);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.prototype.onDestWildcardBlur=function(){this.showDestWildcardError=!0,this.destWildcardValidator.validate()},e.prototype.validateDestWildcard=function(){if(this.showErrors||this.showDestWildcardError){var e=this.macQualifierValidator.getWildcardMaskError(this.model.destinationMacAddress,!1);return e!==this.trafficFilterConstants.EMPTY?[e]:[]}return[]},e.$inject=["i18nService","dvpgTrafficFilterService","dvpgTrafficFilterConstants","dvpgMacQualifierValidator","vxValidatorFactory"],e}();e.DvpgMacQualifierContoller=i,angular.module("com.vmware.vsphere.client.dvs").component("dvpgMacQualifier",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/common/dvpgSystemQualifierTemplate.html"}return e}();e.DvpgSystemQualifierComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.trafficFilterService=t,this.i18n=this.i18nService.getString,this.trafficOperations=this.trafficFilterService.getSystemQualifierOperations(),this.trafficTypes=this.trafficFilterService.getSystemQualifierTypes()}return e.$inject=["i18nService","dvpgTrafficFilterService"],e}();e.DvpgSystemQualifierContoller=i,angular.module("com.vmware.vsphere.client.dvs").component("dvpgSystemQualifier",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",onIpValidate:"=",onMacValidate:"="},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/common/dvpgTrafficQualifiersTemplate.html"}return e}();e.DvpgTrafficQualifiersComponent=t;var i=function(){function e(e,t){this.$scope=e,this.i18nService=t,this.i18n=this.i18nService.getString}return e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvpgTrafficQualifiers",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvpgTrafficRuleListItem=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvpgTrafficFilterConstants",{properties:{DVPG_NAME:"name",DVPG_DVS:"config/distributedVirtualSwitch",TRAFFIC_FILTER_PROPERTY:"dvpg:dvPortgroupTrafficFilter",TRAFFIC_RULE_PROPERTY:"trafficRuleModel",DVS_PORT_TRAFFIC_FILTER_PROPERTY:"dvsport:portTrafficFilterData",DVPG_PORT_TRAFFIC_FILTER_PROPERTY:"dvportgroupport:portTrafficFilterData",DVS_PORT_EDIT_TRAFFIC_FILTER_PROPERTY:"dvsport:portEditTrafficRuleData",DVPG_PORT_EDIT_TRAFFIC_FILTER_PROPERTY:"dvportgroupport:portEditTrafficRuleData"},privileges:{DVPG_MODIFY:"DVPortgroup.Modify"},direction:{BOTH:"both",EGRESS:"incomingPackets",INGRESS:"outgoingPackets"},action:{ALLOW:"allow",DROP:"drop",TAG:"tag"},tag:{MIN_COS_TAG:0,MAX_COS_TAG:7,MIN_DSCP_TAG:0,MAX_DSCP_TAG:63,MIN_MAX_DSCP_TAG:"0 - 63",MIN_MAX_COS_TAG:"0 - 7"},addressType:{IPV4:"ipv4",IPV6:"ipv6",MIXED:"mixed"},mac:{IPV4_PROTOCOL_HEX_VALUE:2048,IPV6_PROTOCOL_HEX_VALUE:34525,ARP_PROTOCOL_HEX_VALUE:2054,MIN_PROTOCOL_HEX_VALUE:0,MAX_PROTOCOL_HEX_VALUE:65535},vlan:{MIN:0,MAX:4094,CUSTOM:-1},operator:{ANY:0,IS:1,IS_NOT:2,IN_RANGE:3,NOT_IN_RANGE:4,MATCHES:5,DOES_NOT_MATCH:6},protocol:{ICMP:1,ICMP6:58,TCP:6,UDP:17,CUSTOM:0},systemTraffic:{FT:"faultTolerance",HBR:"hbr",ISCSI:"iSCSI",MANAGEMENT:"management",NFS:"nfs",VM:"virtualMachine",VMOTION:"vmotion",VSAN:"vsan",VDP:"vdp"},spec:{DVPG_EDIT_TRAFFIC_RULES_SPEC:"com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgEditTrafficFilterSpec",DVPG_CLONE_TRAFFIC_RULES_SPEC:"com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgCloneTrafficRulesSpec",DVPG_ADD_TRAFFIC_RULE_SPEC:"com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgAddTrafficRuleSpec",DVPG_EDIT_TRAFFIC_RULE_SPEC:"com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgEditTrafficRuleSpec",DVPG_REMOVE_TRAFFIC_RULE_SPEC:"com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgRemoveTrafficRuleSpec",DVS_PORT_EDIT_TRAFFIC_RULES_SPEC:"com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortEditTrafficFilterSpec",DVS_PORT_ADD_TRAFFIC_RULE_SPEC:"com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortAddTrafficRuleSpec",DVS_PORT_EDIT_TRAFFIC_RULE_SPEC:"com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortEditTrafficRuleSpec",DVS_PORT_REMOVE_TRAFFIC_RULE_SPEC:"com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortRemoveTrafficRuleSpec"},EMPTY:"",SEQUENCE_NUMBER:10,MAX_RULE_NAME_LENGTH:255,MAX_PORT_NUMBER:65535,IPV4_ADDRESS_MAX_PREFIX:32,IPV6_ADDRESS_MAX_PREFIX:128,IP_ADDRESS_MIN_PREFIX:1,MIN_PROTOCOL_VALUE:0,MAX_PROTOCOL_VALUE:255,MIN_PROTOCOL_HEX_VALUE:0,MAX_PROTOCOL_HEX_VALUE:65535,EMPTY_MAC_ADDRESS:"00:00:00:00:00:00"})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgTrafficFilterModel,i=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgTrafficRuleModel,r=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgIpQualifierModel,n=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgProtocolModel,o=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgPortModel,a=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgIpAddressModel,s=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgMacQualifierModel,c=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgMacAddressModel,l=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.model.DvpgSystemQualifierModel,d=function(){function d(e,t,i,r,n,o,a,s,c,l,d){this.i18nService=e,this.clarityConstants=t,this.trafficFilterConstants=i,this.trafficFilterSpecFactory=r,this.dvpgTrafficRuleValidator=n,this.dvpgCloneTrafficRulesValidator=o,this.clarityModalService=a,this.dataService=s,this.mutationService=c,this.defaultUriSchemeUtil=l,this.$q=d}return d.prototype.showEditTrafficFilterDialog=function(t){var i=this,r={title:this.i18nService.getString("DvsUi","trafficFilter.rulesDialog.title"),subTitle:{objectId:t},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/edit/dvpgEditTrafficFilterDialog.html",size:"lg",modalClass:"edit-traffic-filter-dialog",dialogData:{objectId:t,model:new e.DvpgEditTrafficFilterModel},onSubmit:function(){var e=i.isRuleOrderChanged(r.dialogData.model.rules,r.dialogData.model.originalRulesKeys),n=r.dialogData.model.initialTrafficRulesetEnabled!==r.dialogData.model.isTrafficRulesetEnabled;if(n||e){var o=i.trafficFilterSpecFactory.buildEditTrafficFilterSpec(r.dialogData.model,e);i.mutationService.apply(t,i.trafficFilterConstants.spec.DVPG_EDIT_TRAFFIC_RULES_SPEC,o)}return!0}};this.dataService.getProperties(t,this.trafficFilterConstants.properties.TRAFFIC_FILTER_PROPERTY).then(function(e){return e[i.trafficFilterConstants.properties.TRAFFIC_FILTER_PROPERTY]}).then(function(e){e?(r.dialogData.model.initialTrafficRulesetEnabled=e.isTrafficRulesetEnabled,r.dialogData.model.isTrafficRulesetEnabled=e.isTrafficRulesetEnabled,r.dialogData.model.rules=e.rules,r.dialogData.model.originalRulesKeys=i.getRulesKeys(e.rules)):(r.dialogData.model.rules=[],r.dialogData.model.originalRulesKeys=[])}),this.clarityModalService.openOkCancelModal(r)},d.prototype.showCloneTrafficFilterDialog=function(t){var i=this,r=new e.DvpgCloneTrafficRulesModel;r.dvpgId=t,r.selectedPortgroups=[];var n={title:this.i18nService.getString("DvsUi","trafficFilter.cloneRulesDialog.title"),subTitle:{objectId:t},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/clone/dvpgCloneTrafficRulesDialog.html",size:"lg",modalClass:"clone-traffic-filter-dialog",dialogData:{objectId:t,model:r},onSubmit:function(){return i.dvpgCloneTrafficRulesValidator.getValidationError(n.dialogData.model).then(function(e){if(_.isArray(e)&&e.length>0)return i.showAllErrors(e,n),!1;if(!e)return!1;var r=i.trafficFilterSpecFactory.buildCloneTrafficFilterSpec(n.dialogData.model);return i.mutationService.apply(t,i.trafficFilterConstants.spec.DVPG_CLONE_TRAFFIC_RULES_SPEC,r),!0})}};this.dataService.getProperties(t,[this.trafficFilterConstants.properties.DVPG_NAME,this.trafficFilterConstants.properties.DVPG_DVS]).then(function(e){n.dialogData.model.dvsId=i.defaultUriSchemeUtil.getVsphereObjectId(e[i.trafficFilterConstants.properties.DVPG_DVS]),n.dialogData.model.dvpgName=e[i.trafficFilterConstants.properties.DVPG_NAME],i.clarityModalService.openOkCancelModal(n)})},d.prototype.showAddRuleDialog=function(e){var i=this,r={},n={},o={title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.title"),subTitle:{objectId:e},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/add/dvpgAddTrafficRuleDialog.html",size:"lg",modalClass:"add-traffic-rule-dialog",dialogData:{availableTargets:[e],objectId:e,ipValidator:r,macValidator:n,newRuleModel:this.initAddTrafficRuleModel(),trafficFiltersModel:new t},onSubmit:function(){return i.dvpgTrafficRuleValidator.getValidationResult(o.dialogData.newRuleModel).then(function(t){if(o.dialogData.ipValidator.validate(),o.dialogData.macValidator.validate(),_.isArray(t)&&t.length>0)return i.showErrors(t,o),!1;if(!t)return!1;var r=i.trafficFilterSpecFactory.buildAddTrafficRuleSpec(o.dialogData.newRuleModel);return i.mutationService.apply(e,i.trafficFilterConstants.spec.DVPG_ADD_TRAFFIC_RULE_SPEC,r),!0})}};this.dataService.getProperties(e,this.trafficFilterConstants.properties.TRAFFIC_FILTER_PROPERTY).then(function(e){return e[i.trafficFilterConstants.properties.TRAFFIC_FILTER_PROPERTY]}).then(function(e){o.dialogData.trafficFiltersModel=e,o.dialogData.newRuleModel.name=i.getUniqueRuleName(e.rules)}),this.clarityModalService.openOkCancelModal(o)},d.prototype.showEditRuleDialog=function(e,t){var i=this,r={},n={},o={title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.editTitle"),subTitle:{objectId:e},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/add/dvpgEditTrafficRuleDialog.html",size:"lg",modalClass:"edit-traffic-rule-dialog",dialogData:{availableTargets:[e],objectId:e,ipValidator:r,macValidator:n,editRuleModel:this.initNewTrafficRuleModel()},onSubmit:function(){return i.dvpgTrafficRuleValidator.getValidationResult(o.dialogData.editRuleModel).then(function(t){if(o.dialogData.ipValidator.validate(),o.dialogData.macValidator.validate(),_.isArray(t)&&t.length>0)return i.showErrors(t,o),!1;if(!t)return!1;var r=i.trafficFilterSpecFactory.buildEditTrafficRuleSpec(o.dialogData.editRuleModel);return i.mutationService.apply(e,i.trafficFilterConstants.spec.DVPG_EDIT_TRAFFIC_RULE_SPEC,r),!0})}},a={propertyParams:[{propertyName:this.trafficFilterConstants.properties.TRAFFIC_RULE_PROPERTY,parameterType:"java.lang.String",parameter:t}]};this.dataService.getProperties(e,[this.trafficFilterConstants.properties.TRAFFIC_RULE_PROPERTY],a).then(function(e){return e[i.trafficFilterConstants.properties.TRAFFIC_RULE_PROPERTY]}).then(function(e){var t=i.initEditTrafficRuleModel(e);o.title=i.i18nService.getString("DvsUi","trafficFilter.ruleDialog.editTitleUpdated",t.name),_.extend(t,{defaultQualifierTabIndex:i.getDefaultQualifierTabIndex(t)}),o.dialogData.editRuleModel=t}),this.clarityModalService.openOkCancelModal(o)},d.prototype.removeRule=function(e,t,i){var r=this,n=function(){var i=r.trafficFilterSpecFactory.buildRemoveTrafficRuleSpec(t);r.mutationService.apply(e,r.trafficFilterConstants.spec.DVPG_REMOVE_TRAFFIC_RULE_SPEC,i)},o={title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.remove.caption"),message:i&&i.trim().length>0?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.remove.warning",i):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.remove.noNameWarning"),submit:n,subTitle:{objectId:e},preserveNewlines:!0,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"}};this.clarityModalService.openConfirmationModal(o)},d.prototype.isRuleOrderChanged=function(e,t){if(!e||!t||e.length!==t.length)return!1;for(var i=0;i<e.length;i++)if(e[i].key!==t[i])return!0;return!1},d.prototype.getRulesKeys=function(e){var t=[];if(!e||0===e.length)return t;for(var i=0;i<e.length;i++)t.push(e[i].key);return t},d.prototype.initAddTrafficRuleModel=function(){return this.initNewTrafficRuleModel()},d.prototype.initEditTrafficRuleModel=function(e){return e?(null===e.ipQualifierModel?e.ipQualifierModel=this.initIpQualifierModel():(null===e.ipQualifierModel.sourcePort&&(e.ipQualifierModel.sourcePort=this.initPortModel()),null===e.ipQualifierModel.destinationPort&&(e.ipQualifierModel.destinationPort=this.initPortModel())),null===e.macQualifierModel&&(e.macQualifierModel=this.initMacQualifierModel()),null===e.systemQualifierModel&&(e.systemQualifierModel=this.initSystemQualifierModel()),e):this.initNewTrafficRuleModel()},d.prototype.getTrafficFilterActions=function(){return[{value:this.trafficFilterConstants.action.ALLOW,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.allow")},{value:this.trafficFilterConstants.action.DROP,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.drop")},{value:this.trafficFilterConstants.action.TAG,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.tag")}]},d.prototype.getTrafficFilterDirections=function(){return[{value:this.trafficFilterConstants.direction.BOTH,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.direction.ingressEgress")},{value:this.trafficFilterConstants.direction.EGRESS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.direction.egress")},{value:this.trafficFilterConstants.direction.INGRESS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.direction.ingress")}]},d.prototype.getQualifiersProtocolOperations=function(){return[{value:this.trafficFilterConstants.operator.ANY,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.any")},{value:this.trafficFilterConstants.operator.IS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.is")},{value:this.trafficFilterConstants.operator.IS_NOT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.isNot")}]},d.prototype.getIpQualifierProtocolTypes=function(){return[{value:this.trafficFilterConstants.protocol.ICMP,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.protocol.icmp",this.trafficFilterConstants.protocol.ICMP.toString())},{value:this.trafficFilterConstants.protocol.TCP,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.protocol.tcp",this.trafficFilterConstants.protocol.TCP.toString())},{value:this.trafficFilterConstants.protocol.UDP,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.protocol.udp",this.trafficFilterConstants.protocol.UDP.toString())},{value:this.trafficFilterConstants.protocol.ICMP6,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.protocol.icmp6",this.trafficFilterConstants.protocol.ICMP6.toString())},{value:this.trafficFilterConstants.protocol.CUSTOM,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.protocol.custom")}]},d.prototype.getMacQualifierProtocolTypes=function(){return[{value:this.trafficFilterConstants.mac.IPV4_PROTOCOL_HEX_VALUE,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.mac.ipv4",this.getHexRepresentation(this.trafficFilterConstants.mac.IPV4_PROTOCOL_HEX_VALUE))
},{value:this.trafficFilterConstants.mac.IPV6_PROTOCOL_HEX_VALUE,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.mac.ipv6",this.getHexRepresentation(this.trafficFilterConstants.mac.IPV6_PROTOCOL_HEX_VALUE))},{value:this.trafficFilterConstants.mac.ARP_PROTOCOL_HEX_VALUE,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.mac.arp",this.getHexRepresentation(this.trafficFilterConstants.mac.ARP_PROTOCOL_HEX_VALUE))},{value:this.trafficFilterConstants.protocol.CUSTOM,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.protocol.custom")}]},d.prototype.getMacQualifierVlanOperations=function(){return[{value:this.trafficFilterConstants.operator.ANY,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.any")},{value:this.trafficFilterConstants.operator.IS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.is")},{value:this.trafficFilterConstants.operator.IS_NOT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.isNot")}]},d.prototype.getIpQualifierPortOperations=function(){return[{value:this.trafficFilterConstants.operator.ANY,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.any")},{value:this.trafficFilterConstants.operator.IS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.is")},{value:this.trafficFilterConstants.operator.IS_NOT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.isNot")},{value:this.trafficFilterConstants.operator.IN_RANGE,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.inRange")},{value:this.trafficFilterConstants.operator.NOT_IN_RANGE,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.notInRange")}]},d.prototype.getQualifiersAddressOperations=function(){return[{value:this.trafficFilterConstants.operator.ANY,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.any")},{value:this.trafficFilterConstants.operator.IS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.is")},{value:this.trafficFilterConstants.operator.IS_NOT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.isNot")},{value:this.trafficFilterConstants.operator.MATCHES,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.matches")},{value:this.trafficFilterConstants.operator.DOES_NOT_MATCH,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.doesNotMatch")}]},d.prototype.getIpQualifierIpAddressTypes=function(){return[{value:this.trafficFilterConstants.addressType.IPV4,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.addressType.ipv4")},{value:this.trafficFilterConstants.addressType.IPV6,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.addressType.ipv6")},{value:this.trafficFilterConstants.addressType.MIXED,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.addressType.all")}]},d.prototype.getSystemQualifierOperations=function(){return[{value:this.trafficFilterConstants.operator.IS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.is")},{value:this.trafficFilterConstants.operator.IS_NOT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.operation.isNot")}]},d.prototype.getSystemQualifierTypes=function(){return[{value:this.trafficFilterConstants.systemTraffic.FT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.faultTolerance")},{value:this.trafficFilterConstants.systemTraffic.HBR,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.hbr")},{value:this.trafficFilterConstants.systemTraffic.ISCSI,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.iscsi")},{value:this.trafficFilterConstants.systemTraffic.MANAGEMENT,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.management")},{value:this.trafficFilterConstants.systemTraffic.NFS,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.nfs")},{value:this.trafficFilterConstants.systemTraffic.VM,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.vm")},{value:this.trafficFilterConstants.systemTraffic.VMOTION,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.vMotion")},{value:this.trafficFilterConstants.systemTraffic.VSAN,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.vsan")},{value:this.trafficFilterConstants.systemTraffic.VDP,label:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.vdp")}]},d.prototype.getUniqueRuleName=function(e){var t=1,i=this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.defaultName",t.toString());if(!e||0===e.length)return i;for(var r=e.map(function(e){return e.name});r.indexOf(i)!==-1;)t++,i=this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.defaultName",t.toString());return i},d.prototype.getHexRepresentation=function(e){if(!e||isNaN(e))return"";for(var t=e.toString(16).toUpperCase();t.length<4;)t="0"+t;return t},d.prototype.initNewTrafficRuleModel=function(){var e=new i;return e.action=this.trafficFilterConstants.action.TAG,e.direction=this.trafficFilterConstants.direction.BOTH,e.ipQualifierModel=this.initIpQualifierModel(),e.macQualifierModel=this.initMacQualifierModel(),e.systemQualifierModel=this.initSystemQualifierModel(),e},d.prototype.areRulesChanged=function(e,t){if(!e||!t||e.length!==t.length)return!0;for(var i=0;i<t.length;i++)if(this.isRuleChanged(e[i],t[i]))return!0;return!1},d.prototype.isRuleChanged=function(e,t){if(!e||!t||e.key!==t.key||e.sequence!==t.sequence||e.displaySequence!==t.displaySequence||e.action!==t.action||e.name!==t.name||e.direction!==t.direction)return!0;if(!t.qualifiers||!e.qualifiers||t.qualifiers.length!==e.qualifiers.length)return!0;for(var i=0;i<t.qualifiers.length;i++)if(e.qualifiers[i]!==t.qualifiers[i])return!0;return!1},d.prototype.initPortModel=function(){var e=new o;return e.operation=this.trafficFilterConstants.operator.ANY,e},d.prototype.initIpAddressModel=function(){var e=new a;return e.operation=this.trafficFilterConstants.operator.ANY,e.ipAddressType=this.trafficFilterConstants.addressType.MIXED,e},d.prototype.initIpProtocolModel=function(){var e=new n;return e.operation=this.trafficFilterConstants.operator.IS,e.type=this.trafficFilterConstants.protocol.TCP,e},d.prototype.initMacProtocolModel=function(){var e=new n;return e.operation=this.trafficFilterConstants.operator.ANY,e.type=this.trafficFilterConstants.mac.IPV4_PROTOCOL_HEX_VALUE,e},d.prototype.initMacAddressModel=function(){var e=new c;return e.operation=this.trafficFilterConstants.operator.ANY,e},d.prototype.initIpQualifierModel=function(){var e=new r;return e.protocol=this.initIpProtocolModel(),e.sourcePort=this.initPortModel(),e.destinationPort=this.initPortModel(),e.sourceIpAddress=this.initIpAddressModel(),e.destinationIpAddress=this.initIpAddressModel(),e},d.prototype.initMacQualifierModel=function(){var e=new s;return e.protocol=this.initMacProtocolModel(),e.vlanOperation=this.trafficFilterConstants.operator.ANY,e.sourceMacAddress=this.initMacAddressModel(),e.destinationMacAddress=this.initMacAddressModel(),e},d.prototype.initSystemQualifierModel=function(){var e=new l;return e.trafficOperation=this.trafficFilterConstants.operator.IS,e.trafficType=this.trafficFilterConstants.systemTraffic.FT,e},d.prototype.showErrors=function(e,t){_.isArray(e)&&e.length>0&&(1===e.length?t.alerts=[{type:this.clarityConstants.notifications.type.ERROR,text:e[0]}]:t.alerts=[{type:this.clarityConstants.notifications.type.ERROR,text:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.generalError")}])},d.prototype.showAllErrors=function(e,t){var i=this;_.isArray(e)&&e.length>0&&(t.alerts=[],_.each(e,function(e){t.alerts.push({type:i.clarityConstants.notifications.type.ERROR,text:e})}))},d.prototype.getDefaultQualifierTabIndex=function(e){return!e||e.ipQualifierModel.enableIpQualifier||!e.macQualifierModel.enableMacQualifier&&!e.systemQualifierModel.enableSystemQualifier?0:e.macQualifierModel.enableMacQualifier?1:2},d.$inject=["i18nService","clarityConstants","dvpgTrafficFilterConstants","dvpgTrafficFilterSpecFactory","dvpgTrafficRuleValidator","dvpgCloneTrafficRulesValidator","clarityModalService","dataService","mutationService","defaultUriSchemeUtil","$q"],d}();e.DvpgTrafficFilterService=d,angular.module("com.vmware.vsphere.client.dvs").service("dvpgTrafficFilterService",d)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgEditTrafficFilterSpec,i=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgEditRuleSequenceSpec,r=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgAddTrafficRuleSpec,n=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgRemoveTrafficRuleSpec,o=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgEditTrafficRuleSpec,a=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgCloneTrafficRulesSpec,s=function(){function e(e){this.defaultUriSchemeUtil=e}return e.prototype.buildEditTrafficFilterSpec=function(e,r){var n=new t;if(n.isTrafficRulesetEnabled=e.isTrafficRulesetEnabled,r){var o=[];e.rules.forEach(function(e){var t=new i;t.ruleKey=e.key,t.sequence=e.sequence,o.push(t)}),n.rules=o}return n},e.prototype.buildCloneTrafficFilterSpec=function(e){var t=this,i=new a,r=[];return e.selectedPortgroups.forEach(function(e){r.push(t.defaultUriSchemeUtil.getManagedObjectReference(e.id))}),i.portgroups=r,i},e.prototype.buildAddTrafficRuleSpec=function(e){var t=new r;return t.newRule=e,t},e.prototype.buildEditTrafficRuleSpec=function(e){var t=new o;return t.editedRule=e,t},e.prototype.buildRemoveTrafficRuleSpec=function(e){var t=new n;return t.key=e,t},e.$inject=["defaultUriSchemeUtil"],e}();e.DvpgTrafficFilterSpecFactory=s,angular.module("com.vmware.vsphere.client.dvs").service("dvpgTrafficFilterSpecFactory",s)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={dvpgId:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/dvpgTrafficFilterViewTemplate.html"}return e}();e.DvpgTrafficFilterViewComponent=t;var i=function(){function e(e,t,i,r){this.dataService=e,this.i18nService=t,this.dvpgTrafficFilterService=i,this.dvpgTrafficFilterConstants=r,this.liveRefreshProperties=["config.defaultPortConfig.filterPolicy","config.defaultPortConfig.filterPolicy.filterConfig"],this.settingsViewHeaderAccessor={},this.headerOptions={title:this.i18nService.getString("DvsUi","dvpg.trafficFilter.title.disabled"),objectId:this.dvpgId,actions:[{actionUid:"vsphere.core.dvs.trafficFilters.editRulesAction",customLabel:this.i18nService.getString("DvsUi","actionEditTrafficFiltersLabel")},{actionUid:"vsphere.core.dvs.trafficFilters.cloneRulesAction",customLabel:this.i18nService.getString("DvsUi","actionCloneTrafficFiltersLabel")}]}}return e.prototype.$onInit=function(){this.getData()},e.prototype.getData=function(){var e=this;this.hasPendingRequest=!0,this.dataService.getProperties(this.dvpgId,this.dvpgTrafficFilterConstants.properties.TRAFFIC_FILTER_PROPERTY).then(function(t){return t[e.dvpgTrafficFilterConstants.properties.TRAFFIC_FILTER_PROPERTY]}).then(function(t){e.hasPendingRequest=!1,t?(e.dvpgTrafficFilterService.areRulesChanged(e.trafficFilterRules,t.rules)&&(e.trafficFilterRules=t.rules),e.headerOptions.title=t.isTrafficRulesetEnabled?e.i18nService.getString("DvsUi","dvpg.trafficFilter.title.enabled"):e.i18nService.getString("DvsUi","dvpg.trafficFilter.title.disabled")):e.trafficFilterRules=[],e.settingsViewHeaderAccessor.refresh&&e.settingsViewHeaderAccessor.refresh()})},e.prototype.onAddRule=function(){this.dvpgTrafficFilterService.showAddRuleDialog(this.dvpgId)},e.prototype.onEditRule=function(e){this.dvpgTrafficFilterService.showEditRuleDialog(this.dvpgId,e.key)},e.prototype.onRemoveRule=function(e){this.dvpgTrafficFilterService.removeRule(this.dvpgId,e.key,e.name)},e.$inject=["dataService","i18nService","dvpgTrafficFilterService","dvpgTrafficFilterConstants"],e}();e.DvpgTrafficFilterViewContoller=i,angular.module("com.vmware.vsphere.client.dvs").component("dvpgTrafficFilterView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/dvpg/trafficfilter/edit/dvpgEditTrafficFilterTemplate.html"}return e}();e.DvpgEditTrafficFilterComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.$sce=t,this.i18n=this.i18nService,this.enableOverrideInfoText=this.$sce.trustAsHtml(this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.enableOverrideInfoText"))}return e.$inject=["i18nService","$sce"],e}();e.DvpgEditTrafficFilterContoller=i,angular.module("com.vmware.vsphere.client.dvs").component("dvpgEditTrafficFilter",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.showTrafficFilterOverride=!1,this.enableTrafficFilterOverride=!1,this.isTrafficRulesetOverwritten=!1,this.initialIsTrafficRulesetOverwritten=!1,this.initialTrafficRulesetEnabled=!1,this.isTrafficRulesetEnabled=!1}return e}();e.DvpgEditTrafficFilterModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.dvpgTrafficFilterConstants=t,this.authorizationService=i,this.$q=r,this.privilegeToCheck=this.dvpgTrafficFilterConstants.privileges.DVPG_MODIFY}return e.prototype.getValidationError=function(e){var t=[];return e.selectedPortgroups&&0!==e.selectedPortgroups.length?this.getNoPrivilegesValidationError(e):(t.push(this.i18nService.getString("DvsUi","trafficFilter.cloneRulesDialog.noPortGroupsSelected")),this.$q.when(t))},e.prototype.getNoPrivilegesValidationError=function(e){var t=this,i=_.map(e.selectedPortgroups,function(e){return e.id});return this.authorizationService.checkPrivilegesForMultipleObjects(i,[this.privilegeToCheck]).then(function(i){return t.buildNoPrivilegesValidationMessages(i,e.selectedPortgroups)})},e.prototype.buildNoPrivilegesValidationMessages=function(e,t){var i=this,r=[];return Object.keys(e).forEach(function(n){if(e[n][i.privilegeToCheck]===!1){var o=i.getPortgroupName(n,t);""!==o&&r.push(i.i18nService.getString("DvsUi","trafficFilter.cloneRulesDialog.noPrivilegesFormat",o))}}),r},e.prototype.getPortgroupName=function(e,t){for(var i=0;i<t.length;i++)if(e===t[i].id)return t[i].name;return""},e.$inject=["i18nService","dvpgTrafficFilterConstants","authorizationService","$q"],e}();e.DvpgCloneTrafficRulesValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgCloneTrafficRulesValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.trafficFilterConstants=t,this.validatorService=i,this.ipParserService=r,this.networkUtil=n}return e.prototype.getValidationErrors=function(e){var t=[];if(!e)return t;if(e.protocol.type===this.trafficFilterConstants.protocol.TCP||e.protocol.type===this.trafficFilterConstants.protocol.UDP){var i=this.getPortError(e.sourcePort,!0),r=this.getPortRangeError(e.sourcePort,!0),n=this.getPortError(e.destinationPort,!1),o=this.getPortRangeError(e.destinationPort,!1);i!==this.trafficFilterConstants.EMPTY?t.push(i):r!==this.trafficFilterConstants.EMPTY&&t.push(r),n!==this.trafficFilterConstants.EMPTY?t.push(n):o!==this.trafficFilterConstants.EMPTY&&t.push(o)}var a=this.getIpAddressError(e.sourceIpAddress,!0),s=this.getPrefixLengthError(e.sourceIpAddress,!0),c=this.getIpAddressError(e.destinationIpAddress,!1),l=this.getPrefixLengthError(e.destinationIpAddress,!1);a!==this.trafficFilterConstants.EMPTY&&t.push(a),s!==this.trafficFilterConstants.EMPTY&&t.push(s),c!==this.trafficFilterConstants.EMPTY&&t.push(c),l!==this.trafficFilterConstants.EMPTY&&t.push(l);var d=this.getIpMatchError(e.sourceIpAddress,e.destinationIpAddress);d!==this.trafficFilterConstants.EMPTY&&t.push(d);var u=this.getProtocolError(e.protocol);return u!==this.trafficFilterConstants.EMPTY&&t.push(u),t},e.prototype.getPortError=function(e,t){var i=this.trafficFilterConstants.EMPTY;return!e||e.operation!==this.trafficFilterConstants.operator.IS&&e.operation!==this.trafficFilterConstants.operator.IS_NOT?i:this.validatorService.isValidInteger(e.port,0,this.trafficFilterConstants.MAX_PORT_NUMBER)?i:t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourcePort"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDestinationPort")},e.prototype.getPortRangeError=function(e,t){var i=this.trafficFilterConstants.EMPTY;if(!e||e.operation!==this.trafficFilterConstants.operator.IN_RANGE&&e.operation!==this.trafficFilterConstants.operator.NOT_IN_RANGE)return i;var r=parseInt(e.port),n=parseInt(e.portRangeEnd);return isNaN(r)||isNaN(n)?t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.emptySourcePortRange"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.emptyDestinationPortRange"):this.validatorService.isValidInteger(e.port,0,this.trafficFilterConstants.MAX_PORT_NUMBER)&&this.validatorService.isValidInteger(e.portRangeEnd,0,this.trafficFilterConstants.MAX_PORT_NUMBER)?r>=n?t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidEndSourcePortRange"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidEndDestinationPortRange"):i:t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourcePortRange"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDestinationPortRange")},e.prototype.getIpAddressError=function(e,t){var i=this.trafficFilterConstants.EMPTY;if(!e||e.operation===this.trafficFilterConstants.operator.ANY)return i;var r=e.ipAddress&&e.ipAddress.length>0?e.ipAddress.trim():e.ipAddress,n=this.ipParserService.isIpv4AddressValid(r),o=!1;return n||(o=this.ipParserService.isIpv6AddressValid(r)),n||o?i:t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourceIp"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDestinationIp")},e.prototype.getPrefixLengthError=function(e,t){var i=this.trafficFilterConstants.EMPTY;if(!e||e.operation!==this.trafficFilterConstants.operator.MATCHES&&e.operation!==this.trafficFilterConstants.operator.DOES_NOT_MATCH)return i;var r=e.ipAddress&&e.ipAddress.length>0?e.ipAddress.trim():e.ipAddress,n=this.ipParserService.isIpv4AddressValid(r),o=n?this.trafficFilterConstants.IPV4_ADDRESS_MAX_PREFIX:this.trafficFilterConstants.IPV6_ADDRESS_MAX_PREFIX;return this.validatorService.isValidInteger(e.prefixLength,this.trafficFilterConstants.IP_ADDRESS_MIN_PREFIX,o)?i:t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourcePrefix",this.trafficFilterConstants.IP_ADDRESS_MIN_PREFIX,o):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDestinationPrefix",this.trafficFilterConstants.IP_ADDRESS_MIN_PREFIX,o)},e.prototype.getIpMatchError=function(e,t){var i=this.trafficFilterConstants.EMPTY;if(!e||!t)return i;var r=this.getIpAddressVersion(e),n=this.getIpAddressVersion(t);return r!==this.trafficFilterConstants.addressType.MIXED&&n!==this.trafficFilterConstants.addressType.MIXED&&r!==n&&(i=this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.ipMismatch")),i},e.prototype.getIpAddressVersion=function(e){if(!e)return this.trafficFilterConstants.addressType.MIXED;if(e.operation===this.trafficFilterConstants.operator.ANY)return e.ipAddressType;var t=e.ipAddress&&e.ipAddress.length>0?e.ipAddress.trim():e.ipAddress,i=this.ipParserService.isIpv4AddressValid(t),r=this.ipParserService.isIpv6AddressValid(t);return i?this.trafficFilterConstants.addressType.IPV4:r?this.trafficFilterConstants.addressType.IPV6:this.trafficFilterConstants.addressType.MIXED},e.prototype.getProtocolError=function(e){if(!e||e.operation===this.trafficFilterConstants.operator.ANY)return this.trafficFilterConstants.EMPTY;var t;return t=e.type===this.trafficFilterConstants.protocol.CUSTOM?e.customValue:e.type.toString(),this.validatorService.isValidInteger(t,this.trafficFilterConstants.MIN_PROTOCOL_VALUE,this.trafficFilterConstants.MAX_PROTOCOL_VALUE)?this.trafficFilterConstants.EMPTY:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidProtocol")},e.$inject=["i18nService","dvpgTrafficFilterConstants","dvpgQualifierValidatorService","ipParserService","networkUtil"],e}();e.DvpgIpQualifierValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgIpQualifierValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.validatorService=t,this.trafficFilterConstants=i}return e.prototype.getValidationErrors=function(e){var t=[];if(!e)return t;var i=this.getProtocolError(e.protocol);i!==this.trafficFilterConstants.EMPTY&&t.push(i);var r=this.getVlanError(e.vlanId,e.vlanOperation);r!==this.trafficFilterConstants.EMPTY&&t.push(r);var n=this.getMacAddressError(e.sourceMacAddress,!0),o=this.getWildcardMaskError(e.sourceMacAddress,!0),a=this.getMacAddressError(e.destinationMacAddress,!1),s=this.getWildcardMaskError(e.destinationMacAddress,!1);return n!==this.trafficFilterConstants.EMPTY&&t.push(n),o!==this.trafficFilterConstants.EMPTY&&t.push(o),a!==this.trafficFilterConstants.EMPTY&&t.push(a),s!==this.trafficFilterConstants.EMPTY&&t.push(s),t},e.prototype.getProtocolError=function(e){if(!e||e.operation===this.trafficFilterConstants.operator.ANY)return this.trafficFilterConstants.EMPTY;var t;return t=e.type===this.trafficFilterConstants.protocol.CUSTOM?parseInt(e.customValue,16):e.type,isNaN(t)||t<this.trafficFilterConstants.MIN_PROTOCOL_HEX_VALUE||t>this.trafficFilterConstants.MAX_PROTOCOL_HEX_VALUE?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidProtocolHex"):this.trafficFilterConstants.EMPTY},e.prototype.getVlanError=function(e,t){var i=this.trafficFilterConstants.EMPTY;return t===this.trafficFilterConstants.operator.ANY?i:this.validatorService.isValidInteger(e,this.trafficFilterConstants.vlan.MIN,this.trafficFilterConstants.vlan.MAX)?i:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidVlan")},e.prototype.getMacAddressError=function(e,t){var i=this.trafficFilterConstants.EMPTY;if(!e||e.operation===this.trafficFilterConstants.operator.ANY)return i;var r=e.macAddress&&e.macAddress.length>0?e.macAddress.trim():e.macAddress;return this.validatorService.isValidMac(r)&&r!==this.trafficFilterConstants.EMPTY_MAC_ADDRESS?this.validatorService.isMulticastOrBroadcastAddress(r)&&t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourceMacFirstHex"):i:t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourceMac"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDestinationMac")},e.prototype.getWildcardMaskError=function(e,t){var i=this.trafficFilterConstants.EMPTY;if(!e||e.operation===this.trafficFilterConstants.operator.ANY||e.operation!==this.trafficFilterConstants.operator.MATCHES&&e.operation!==this.trafficFilterConstants.operator.DOES_NOT_MATCH)return i;var r=e.wildcardMask&&e.wildcardMask.length>0?e.wildcardMask.trim():e.wildcardMask;return this.validatorService.isValidMac(r)?i:t?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidSourceMask"):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDestinationMask")},e.$inject=["i18nService","dvpgQualifierValidatorService","dvpgTrafficFilterConstants"],e}();e.DvpgMacQualifierValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgMacQualifierValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.networkUiConstants=e}return e.prototype.isValidInteger=function(e,t,i){return this.networkUiConstants.POSITIVE_INTEGER_REG_EXP.test(e)&&parseInt(e)>=t&&parseInt(e)<=i},e.prototype.isValidMac=function(e){return void 0!==e&&null!==e&&e.length>0&&new RegExp("^([0-9a-fA-F]{1,2}[:-]){5}[0-9a-fA-F]{1,2}$").test(e)},e.prototype.isMulticastOrBroadcastAddress=function(e){if(!e||0===e.length)return!1;e=e.trim();var t=-1,i=[":","-","."," "];_.each(i,function(i){t=e.indexOf(i),t!==-1});var r=t===-1?e.substr(0,2):e.substr(0,t);return 1===(1&parseInt(r,16))},e.$inject=["networkUiConstants"],e}();e.DvpgQualifierValidatorService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgQualifierValidatorService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.dvpgTrafficFilterConstants=t,this.dvpgQualifierValidatorService=i,this.dvpgIpQualifierValidator=r,this.dvpgMacQualifierValidator=n,this.clarityModalService=o,this.$q=a}return e.prototype.getValidationResult=function(e){if(!e)return this.$q.resolve(!1);var t=[];this.isValidRuleName(e.name)||t.push(this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.exceededMaxLength")),e.action===this.dvpgTrafficFilterConstants.action.TAG&&(e.qosTagSelected&&!this.isValidQosTag(e.qosTagValue)&&t.push(this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidQosTag")),e.dscpTagSelected&&!this.isValidDscpTag(e.dscpTagValue)&&t.push(this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.invalidDscpTag"))),e.action!==this.dvpgTrafficFilterConstants.action.ALLOW&&e.action!==this.dvpgTrafficFilterConstants.action.DROP&&e.action!==this.dvpgTrafficFilterConstants.action.TAG&&t.push(this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.unsupportedAction")),e.ipQualifierModel.enableIpQualifier||e.macQualifierModel.enableMacQualifier||e.systemQualifierModel.enableSystemQualifier||t.push(this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.missingQualifier"));var i=this.getQualifiersErrors(e);return i.length>0&&_.each(i,function(e){t.push(e)}),t.length>0?this.$q.resolve(t):e.action!==this.dvpgTrafficFilterConstants.action.TAG||e.dscpTagSelected||e.qosTagSelected?this.$q.resolve([]):this.showTagActionWarning()},e.prototype.getQualifiersErrors=function(e){if(!e)return[];var t=[];if(e.ipQualifierModel.enableIpQualifier){var i=this.dvpgIpQualifierValidator.getValidationErrors(e.ipQualifierModel);i.length>0&&_.each(i,function(e){t.push(e)})}if(e.macQualifierModel.enableMacQualifier){var r=this.dvpgMacQualifierValidator.getValidationErrors(e.macQualifierModel);r.length>0&&_.each(r,function(e){t.push(e)})}return t},e.prototype.isValidRuleName=function(e){return void 0!==e&&e.length<=this.dvpgTrafficFilterConstants.MAX_RULE_NAME_LENGTH},e.prototype.isValidQosTag=function(e){return void 0===e||null===e||0===e.length||this.dvpgQualifierValidatorService.isValidInteger(e,this.dvpgTrafficFilterConstants.tag.MIN_COS_TAG,this.dvpgTrafficFilterConstants.tag.MAX_COS_TAG)},e.prototype.isValidDscpTag=function(e){return void 0===e||null===e||0===e.length||this.dvpgQualifierValidatorService.isValidInteger(e,this.dvpgTrafficFilterConstants.tag.MIN_DSCP_TAG,this.dvpgTrafficFilterConstants.tag.MAX_DSCP_TAG)},e.prototype.showTagActionWarning=function(){var e=this.$q.defer(),t={size:"md",title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.noTagSpecifiedTitle"),defaultButton:"submit",modalClass:"dvpg-traffic-rule-tag-warning",alerts:[],dialogData:{message:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.noTagSpecified")},contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/validators/dvpgTrafficRuleWarningDialog.html",preserveNewlines:!0,clarityIcon:{shape:"warning","class":"is-warning",size:32},onSubmit:function(){return e.resolve(!0),!0},onCancel:function(){e.resolve(!1)}};return this.clarityModalService.openOkCancelModal(t),e.promise.then(function(e){return e})},e.$inject=["i18nService","dvpgTrafficFilterConstants","dvpgQualifierValidatorService","dvpgIpQualifierValidator","dvpgMacQualifierValidator","clarityModalService","$q"],e}();e.DvpgTrafficRuleValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvpgTrafficRuleValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/export/exportDvsComponentTemplate.html"}return e}();e.ExportDvsComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.exportDvsConstants=t}return e.$inject=["i18nService","exportDvsConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("exportDvsComponent",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("exportDvsConstants",{configurationsToExport:{DVS_AND_ALL_PORTGROUPS:"dvsAndAllPortgroups",DVS_ONLY:"dvsOnly"},configurationRestoreTypes:{FROM_PREVIOUS_CONFIGURATION:"previous",FROM_FILE:"file"}})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.exp.model.ExportDvsSpec,i=function(){function i(e,t,i,r,n,o,a){this.i18nService=e,this.clarityModalService=t,this.exportDvsConstants=i,this.dataService=r,this.exportDvsService=n,this.$q=o,this.defaultUriSchemeUtil=a}return i.prototype.show=function(i){var r=this,n="DistributedVirtualPortgroup"===this.defaultUriSchemeUtil.getManagedObjectReference(i).type,o=this.i18nService.getString("DvsUi","dvs.backup.dialog.title"),a="dvs-ui/resources/dvs/export/exportDvsDialog.html";n&&(o=this.i18nService.getString("DvsUi","dvpg.export.dialog.title"),a="dvs-ui/resources/dvs/export/exportDvsDialog.html");var s={},c={title:o,defaultButton:"submit",size:"lg",alerts:[],loading:!1,dialogData:s,contentTemplate:a,subTitle:{objectId:i}};c.dialogData.pageModel=new e.ExportDvsPageModel,c.dialogData.pageModel.type=n?"dvpg":"dvs",n||(c.dialogData.pageModel.selectedConfigurationToExport=this.exportDvsConstants.configurationsToExport.DVS_AND_ALL_PORTGROUPS),c.onSubmit=function(){var e="dvs:exportDvsConfiguration",o=new t;o.description=c.dialogData.pageModel.description||"",n||(o.includePortGroups=c.dialogData.pageModel.selectedConfigurationToExport===r.exportDvsConstants.configurationsToExport.DVS_AND_ALL_PORTGROUPS),c.loading=!0,c.submitDisabled=!0;var a=r.dataService.getProperties(i,e,{propertyParams:[{propertyName:e,parameterType:o._type,parameter:o}]}).then(function(t){var i=t[e];return r.exportDvsService.saveCharArrayToDisk(i),c.loading=!1,c.submitDisabled=!1,r.$q.when(!0)},function(e){return r.$q.when(!0)});return a},this.clarityModalService.openOkCancelModal(c)},i.$inject=["i18nService","clarityModalService","exportDvsConstants","dataService","exportDvsService","$q","defaultUriSchemeUtil"],i}();e.ExportDvsDialogService=i,angular.module("com.vmware.vsphere.client.dvs").service("exportDvsDialogService",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.prototype.saveCharArrayToDisk=function(e){var t=function(){return function(e,t){var i=new Blob(e,{type:"octet/stream"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(i,t);else{var r=document.getElementsByClassName("invisibleExportDvsDownloadAnchor")[0],n=window.URL.createObjectURL(i);r&&(r.href=n,r.download=t,r.click()),window.URL.revokeObjectURL(n)}}}(),i=this.base64ToArrayBuffer(e);t([i],"backup.zip")},e.prototype.base64ToArrayBuffer=function(e){for(var t=window.atob(e),i=t.length,r=new Uint8Array(i),n=0;n<i;n++){var o=t.charCodeAt(n);r[n]=o}return r},e}();e.ExportDvsService=t,angular.module("com.vmware.vsphere.client.dvs").service("exportDvsService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.ExportDvsPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.templateUrl="dvs-ui/resources/dvs/healthcheck/manage/dvsHealthCheckManageViewTemplate.html",this.controller=i}return e}();e.DvsHealthCheckManageViewComponent=t;var i=function(){function e(e,t,i,r,n){this.$scope=e,this.$rootScope=t,this.i18nService=i,this.propertyViewService=r,this.dataService=n,this.liveRefreshProperties=["config.healthCheckConfig"]}return e.prototype.$onChanges=function(){
this.refreshPropertyView()},e.prototype.refreshPropertyView=function(){var t=this;this.$scope.healthCheckManageLoading=!0,this.dvsUri=this.$rootScope._route.objectId,this.title=this.i18nService.getString("DvsUi","healthCheck.manage.view.title"),this.action=[{actionUid:"vsphere.core.dvs.editHealthCheckSettings",customLabel:this.i18nService.getString("DvsUi","DvsPropertiesView.edit.label")}];var i=this.dataService.getProperties(this.dvsUri,[e.HEALTH_CHECK_DETAILS_DATA_PROPERTY]);i.then(function(i){if(i&&i[e.HEALTH_CHECK_DETAILS_DATA_PROPERTY]){var r=i[e.HEALTH_CHECK_DETAILS_DATA_PROPERTY];t.healthCheckManagePropertyViewData=t.buildPropertyView(r.vlanMtuEnabledLabel,r.teamingAndFailoverEnabledLabel)}else t.healthCheckManagePropertyViewData=t.buildPropertyView(t.i18nService.getString("DvsUi","healthCheck.manage.view.na"),t.i18nService.getString("DvsUi","healthCheck.manage.view.na"));t.$scope.healthCheckManageLoading=!1})},e.prototype.buildPropertyView=function(e,t){var i=this.propertyViewService.createPropertyViewBuilder(),r=i.category("properties"),n=r.section("general");return n.property(this.i18nService.getString("DvsUi","healthCheck.manage.view.vlanMtuProperty"),e),n.property(this.i18nService.getString("DvsUi","healthCheck.manage.view.teamingProperty"),t),i.build()},e.$inject=["$scope","$rootScope","i18nService","vxPropertyViewService","dataService"],e.HEALTH_CHECK_DETAILS_DATA_PROPERTY="dvsHealthCheckManage:dvsHealthCheckSettingsData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckManageView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.templateUrl="dvs-ui/resources/dvs/healthcheck/manage/editdialog/dvsHealthCheckManageDialogTemplate.html",this.controller=i}return e}();e.DvsHealthCheckManageDialogComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.vxValidatorFactory=t,this.dvsHealthCheckManageDialogValidator=i,this.i18n=this.i18nService.getString,this.validator=t.create(),this.validateVlanAndMtuInterval=this.vlanAndMtuIntervalValidator.bind(this),this.validateTeamingAndFailoverInterval=this.teamingAndFailoverIntervalValidator.bind(this),this.options=[{value:!0,label:this.i18nService.getString("DvsUi","healthCheck.manage.enabled")},{value:!1,label:this.i18nService.getString("DvsUi","healthCheck.manage.disabled")}]}return e.prototype.vlanAndMtuIntervalValidator=function(){var e=this.dvsHealthCheckManageDialogValidator.getMonitoringIntervalValidationMessage(this.pageModel.vlanMtuInterval,this.i18n("DvsUi","healthCheck.manage.view.vlanMtuProperty"));return e?[e]:[]},e.prototype.teamingAndFailoverIntervalValidator=function(){var e=this.dvsHealthCheckManageDialogValidator.getMonitoringIntervalValidationMessage(this.pageModel.teamingAndFailoverInterval,this.i18n("DvsUi","healthCheck.manage.view.teamingProperty"));return e?[e]:[]},e.$inject=["i18nService","vxValidatorFactory","dvsHealthCheckManageDialogValidator"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckManageDialog",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.dvs.api.spec.DvsUpdateHealthCheckSpec,i=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VlanMtuHealthCheckConfig,r=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$TeamingHealthCheckConfig,n=function(){function e(e){this.data=e,this.vlanMtuEanbled=e.vlanMtuEnabled,this.teamingAndFailoverEanbled=e.teamingAndFailoverEnabled,this.vlanMtuInterval=e.vlanMtuEnabled?e.vlanMtuInterval:1,this.teamingAndFailoverInterval=e.teamingAndFailoverEnabled?e.teamingAndFailoverInterval:1}return e.prototype.buildSpec=function(e){for(var n=this.getInitialConfig(),o=!1,a=0,s=n;a<s.length;a++){var c=s[a];if(c instanceof i&&(c.enable!==e.vlanMtuEanbled||c.interval!==e.vlanMtuInterval)){var l=n.indexOf(c);n[l].enable=e.vlanMtuEanbled,n[l].interval=n[l].enable?e.vlanMtuInterval:0,o=!0}else if(c instanceof r&&(c.enable!==e.teamingAndFailoverEanbled||c.interval!==e.teamingAndFailoverInterval)){var l=n.indexOf(c);n[l].enable=e.teamingAndFailoverEanbled,n[l].interval=n[l].enable?e.teamingAndFailoverInterval:0,o=!0}}var d=new t;return d.config=n,o?d:null},e.prototype.getInitialConfig=function(){var e=[],t=new i;t.enable=this.vlanMtuEanbled,t.interval=this.vlanMtuInterval;var n=new r;return n.enable=this.teamingAndFailoverEanbled,n.interval=this.teamingAndFailoverInterval,e.push(t),e.push(n),e},e}();e.DvsHealthCheckManageDialogModel=n}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a){this.dataService=e,this.i18nService=t,this.$q=i,this.clarityModalService=r,this.mutationService=n,this.clarityConstants=o,this.dvsHealthCheckManageDialogValidator=a}return t.prototype.show=function(i){var r=this,n={title:this.i18nService.getString("DvsUi","healthCheck.manage.editTitle"),defaultButton:"submit",alerts:[],dialogData:{},contentTemplate:"dvs-ui/resources/dvs/healthcheck/manage/editdialog/dvsHealthCheckManageDialog.html"},o=this.dataService.getProperties(i,t.DVS_HEALTH_CHECK_DATA_PROPERTY),a=null;o.then(function(i){if(i&&i[t.DVS_HEALTH_CHECK_DATA_PROPERTY]){var r=i[t.DVS_HEALTH_CHECK_DATA_PROPERTY],o=r.name.trim(),s=o.replace(/%25/g,"%").replace(/%2f/g,"/").replace(/%5c/g,"\\");n.subTitle=s,n.dialogData.pageModel=new e.DvsHealthCheckManageDialogModel(r),a=new e.DvsHealthCheckManageDialogModel(r)}}),n.onSubmit=function(){return r.onSubmit(a,n,i)},this.clarityModalService.openOkCancelModal(n)},t.prototype.onSubmit=function(e,t,i){var r=this,n=e?e.buildSpec(t.dialogData.pageModel):null;if(null===n)return!0;var o=this.dvsHealthCheckManageDialogValidator.getAllErrors(t.dialogData.pageModel);return o.length>0?(t.alerts=_.map(o,function(e){return{type:r.clarityConstants.notifications.type.ERROR,text:e}}),!1):t.dialogData.pageModel.vlanMtuEanbled&&0===t.dialogData.pageModel.vlanMtuInterval||t.dialogData.pageModel.teamingAndFailoverEanbled&&0===t.dialogData.pageModel.teamingAndFailoverInterval?this.showWarningDialog(i,n._type,n):(this.mutationService.apply(i,n._type,n),!0)},t.prototype.showWarningDialog=function(e,t,i){var r=this,n=this.$q.defer(),o=function(){r.mutationService.apply(e,t,i),n.resolve(!0)},a=function(){n.resolve(!1)},s={title:this.i18nService.getString("DvsUi","healthCheck.manage.dialog.warningDialogTitle"),message:this.i18nService.getString("DvsUi","healthCheck.manage.dialog.warningMessage"),clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},submit:o,onCancel:a,preserveNewlines:!0};return this.clarityModalService.openConfirmationModal(s),n.promise},t.$inject=["dataService","i18nService","$q","clarityModalService","mutationService","clarityConstants","dvsHealthCheckManageDialogValidator"],t.DVS_HEALTH_CHECK_DATA_PROPERTY="dvsHealthCheckManage:dvsHealthCheckSettingsData",t}();e.DvsHealthCheckManageDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsHealthCheckManageDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.networkUtil=t,this.i18n=e.getString}return e.prototype.getAllErrors=function(e){var t=[];if(null===e.vlanMtuInterval||void 0===e.vlanMtuInterval){var i=this.i18n("DvsUi","healthCheck.manage.dialog.errorMessage",this.i18n("DvsUi","healthCheck.manage.view.vlanMtuProperty"));t.push(i)}else{var r=this.getMonitoringIntervalValidationMessage(e.vlanMtuInterval,this.i18n("DvsUi","healthCheck.manage.view.vlanMtuProperty"));r&&t.push(r)}if(null===e.teamingAndFailoverInterval||void 0===e.teamingAndFailoverInterval){var i=this.i18n("DvsUi","healthCheck.manage.dialog.errorMessage",this.i18n("DvsUi","healthCheck.manage.view.teamingProperty"));t.push(i)}else{var r=this.getMonitoringIntervalValidationMessage(e.teamingAndFailoverInterval,this.i18n("DvsUi","healthCheck.manage.view.teamingProperty"));r&&t.push(r)}return t},e.prototype.getMonitoringIntervalValidationMessage=function(e,t){var i=this.i18n("DvsUi","healthCheck.manage.dialog.errorMessage",t);return null===e||void 0===e?i:this.getNumericInputValidationMessage(e,i)},e.prototype.getNumericInputValidationMessage=function(e,t){return this.networkUtil.isPositiveInteger(Number(e))?null:t},e.$inject=["i18nService","networkUtil"],e}();e.DvsHealthCheckManageDialogValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsHealthCheckManageDialogValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={hostName:"<"},this.templateUrl="dvs-ui/resources/dvs/healthcheck/monitor/components/dvsHealthCheckMonitorDetailsViewTemplate.html",this.controller=i}return e}();e.DvsHealthCheckMonitorDetailsViewComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$rootScope=t,this.$scope=i,this.vuiConstants=r,this.dataService=n,this.i18n=this.i18nService.getString}return e.prototype.$onChanges=function(){this.healthCheckDetailsData?(this.$scope.healthCheckDetailsLoading=!0,this.filterDataForHost(this.hostName),this.$scope.healthCheckDetailsLoading=!1):this.refresh(this.hostName)},e.prototype.refresh=function(t){var i=this;this.dvsUrn=this.$rootScope._route.objectId,this.$scope.healthCheckDetailsLoading=!0;var r=this.dataService.getProperties(this.dvsUrn,[e.HEALTH_CHECK_DETAILS_DATA_PROPERTY]);r.then(function(r){r&&r[e.HEALTH_CHECK_DETAILS_DATA_PROPERTY]&&(i.healthCheckDetailsData=r[e.HEALTH_CHECK_DETAILS_DATA_PROPERTY],i.filterDataForHost(t))})["finally"](function(){i.$scope.healthCheckDetailsLoading=!1}),this.liveRefreshProperties=["runtime"]},e.prototype.filterDataForHost=function(e){for(var t=new Array,i=new Array,r=0,n=this.healthCheckDetailsData.detailsItemsData;r<n.length;r++){var o=n[r];null!==o?(o.hostName===e&&null!==o.vlanStatus&&t.push(o),o.hostName===e&&null!==o.mtuStatus&&i.push(o),o.hostName===e&&null!==o.teamingStatus&&(this.$scope.healthCheckIpHashData=o)):this.$scope.healthCheckIpHashData=null}this.$scope.healthCheckVlanItemsData=t?t:[],this.$scope.healthCheckMtuItemsData=i?i:[]},e.$inject=["i18nService","$rootScope","$scope","vuiConstants","dataService"],e.HEALTH_CHECK_DETAILS_DATA_PROPERTY="dvsHealthCheckMonitor:dvsHealthCheckDetailsData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckMonitorDetailsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={healthCheckIpHashData:"<"},this.templateUrl="dvs-ui/resources/dvs/healthcheck/monitor/components/dvsHealthCheckMonitorIpHashViewTemplate.html",this.controller=i}return e}();e.DvsHealthCheckMonitorIpHashViewComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.propertyViewService=t}return e.prototype.$onChanges=function(){this.buildPropertyView()},e.prototype.buildPropertyView=function(){var e,t,i=this.propertyViewService.createPropertyViewBuilder(),r=i.category("properties"),n=r.section("general");this.healthCheckIpHashData?(this.healthCheckIpHashData.teamingStatus&&this.healthCheckIpHashData.teamingStatusIcon?(e=this.healthCheckIpHashData.teamingStatus,t=this.healthCheckIpHashData.teamingStatusIcon):(e=this.i18nService.getString("DvsUi","healthCheck.monitor.status.unknwon"),t="vsphere-icon-status-unknown"),n.propertyBuilder().keyBuilder().text(this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.statusPropName")).exit().valueBuilder().icon(t).text(e).exit().exit(),this.healthCheckIpHashData.ipHashDetails?n.property(this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.detailsPropName"),this.healthCheckIpHashData.ipHashDetails):n.property(this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.detailsPropName"),this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.na"))):(e=this.i18nService.getString("DvsUi","healthCheck.monitor.status.unknwon"),t="vsphere-icon-status-unknown",n.propertyBuilder().keyBuilder().text(this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.statusPropName")).exit().valueBuilder().icon(t).text(e).exit().exit(),n.property(this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.detailsPropName"),this.i18nService.getString("DvsUi","healthCheck.monitor.health.tab.teaming.na"))),this.healthCheckIpHashPropertyViewData=i.build()},e.$inject=["i18nService","vxPropertyViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckMonitorIpHashView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={healthCheckMtuItemsData:"<"},this.templateUrl="dvs-ui/resources/dvs/healthcheck/monitor/components/dvsHealthCheckMonitorVlanMtuViewTemplate.html",this.controller=i}return e}();e.DvsHealthCheckMonitorMtuViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$rootScope=t,this.$scope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.pnicSettingsDialogService=o,this.defaultUriSchemeUtil=a,this.createDataGrid(this.healthCheckMtuItemsData)}return e.prototype.$onInit=function(){this.refresh()},e.prototype.$onChanges=function(){this.datagridOptions.data=this.healthCheckMtuItemsData?this.healthCheckMtuItemsData:[]},e.prototype.refresh=function(){this.createDataGrid(this.healthCheckMtuItemsData)},e.prototype.createDataGrid=function(e){var t=this;this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:e,resizable:!0,height:"100%",pageConfig:{hidePager:!0},showPnicDialog:function(e){t.pnicSettingsDialogService.show(t.defaultUriSchemeUtil.getVsphereObjectId(e.hostMor),e.pnicName,e.hostName)}}},e.prototype.createColumnDefinitions=function(){var t=this.columnRenderersRegistry.getColumnRenderer("icon-text");return[{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.uplink.column"),field:"uplinkName",width:"150px"},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.pnic.column"),field:"pnicName",width:"150px",template:function(i){var r=t(["icon","text"],{icon:e.PNIC_ICON_ID,text:i.pnicName}),n=['<a ng-click="datagridOptions.showPnicDialog(dataItem)">',r,"</a>"].join("");return n}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.mtu.mtuStatus.column"),field:"mtuStatus",width:"150px",template:function(e){return t(["icon","text"],{icon:e.mtuStatusIcon,text:e.mtuStatus})}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.trunk.column"),field:"vlanTrunk",width:"150px"}]},e.$inject=["i18nService","$rootScope","$scope","vuiConstants","columnRenderersRegistry","pnicSettingsDialogService","defaultUriSchemeUtil"],e.PNIC_ICON_ID="network-lib-ui-icon-physicalAdapter",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckMonitorMtuView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={healthCheckStatusData:"<"},this.templateUrl="dvs-ui/resources/dvs/healthcheck/monitor/components/dvsHealthCheckMonitorViewTemplate.html",this.controller=i}return e}();e.DvsHealthCheckMonitorViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s){var c=this;this.$q=e,this.$rootScope=t,this.$scope=i,this.i18nService=r,this.dataService=n,this.vuiConstants=o,this.columnRenderersRegistry=a,this.networkUiConstants=s,this.preselectComparator=function(e){return!!c.$scope.hostName&&c.$scope.hostName===e.hostName},this.i18n=this.i18nService.getString,this.createHealthCheckStatusDatagridOptions(this.dvsHealthCheckItemsData)}return e.prototype.$onInit=function(){this.showNoItemSelected=!0,this.refresh()},e.prototype.$onChanges=function(){this.datagridOptions.data=this.dvsHealthCheckItemsData?this.dvsHealthCheckItemsData:[],this.$scope.refreshDetails=!0},e.prototype.refresh=function(){var t=this;this.$scope.healthCheckLoading=!0,this.$scope.refreshDetails=!0,this.dvsUri=this.$rootScope._route.objectId,this.headerOptions={title:this.i18nService.getString("DvsUi","healthCheck.monitor.masterTitle"),objectId:this.dvsUri,actions:null},this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"45%"},{min:"250px",size:"55%"}]};var i=this.dataService.getProperties(this.dvsUri,[e.HEALTH_CHECK_DATA_PROPERTY_NAME]);i.then(function(i){if(i[e.HEALTH_CHECK_DATA_PROPERTY_NAME]){var r=i[e.HEALTH_CHECK_DATA_PROPERTY_NAME];t.overallHealthCheckStatus=r.normalOverallHealthCheckStatus?t.i18n("DvsUi","healthCheck.monitor.status.normal"):t.i18n("DvsUi","healthCheck.monitor.status.warning"),t.overallHealthCheckStatusIcon=r.overallHealthCheckStatusIcon,t.showWarningsLinkBtn=!r.normalOverallHealthCheckStatus,t.showWarningsLinkBtn&&(t.signPostContent=t.buildSignPostContentView(r),t.signPostCustomTriggerBtnLabel=t.i18n("DvsUi","healthCheck.monitor.status.issues",r.overallWarningsCount)),t.vlanMtuHealthCheckEnablement=r.vlanAndMtuHealthCheckEnabled?t.i18n("DvsUi","healthCheck.monitor.enabled"):t.i18n("DvsUi","healthCheck.monitor.disabled"),t.teamingHealthCheckEnablement=r.teamingAndFailoverHealthCheckEnabled?t.i18n("DvsUi","healthCheck.monitor.enabled"):t.i18n("DvsUi","healthCheck.monitor.disabled"),t.dvsHealthCheckItemsData=r.dvsHealthCheckItems?r.dvsHealthCheckItems:[],t.createHealthCheckStatusDatagridOptions(t.dvsHealthCheckItemsData),t.$scope.healthCheckLoading=!1}}),this.liveRefreshProperties=["runtime","config.healthCheckConfig"]},e.prototype.createHealthCheckStatusDatagridOptions=function(e){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:e,resizable:!0,height:"100%",pageConfig:{hidePager:!0},actionBarOptions:{actions:[]},onChange:this.onSelectionChange.bind(this)}},e.prototype.createColumnDefinitions=function(){var e=this.columnRenderersRegistry.getColumnRenderer("object-link");return[{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.grid.hostName.column"),field:"hostNameFormated",width:"150px",template:function(t){return e([void 0,"hostNameFormated",t.hostIcon],t)}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.grid.state.column"),field:"hostState",width:"150px"},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.grid.vdsStatus.column"),field:"dvsStatus",width:"150px",template:function(t){return e([void 0,"dvsStatus",t.dvsStatusIcon],t)}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.grid.vlanHealthStatus.column"),field:"vlanHealthStatus",width:"150px",template:function(t){return e([void 0,"vlanHealthStatus",t.vlanHealthStatusIcon],t)}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.grid.mtuHealthStatus.column"),field:"mtuHealthStatus",width:"150px",template:function(t){return e([void 0,"mtuHealthStatus",t.mtuHealthStatusIcon],t)}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.grid.teamingHealthStatus.column"),field:"teamingAndFailoverHealthStatus",width:"150px",template:function(t){return e([void 0,"teamingAndFailoverHealthStatus",t.teamingAndFailoverHealthStatusIcon],t)}}]},e.prototype.onSelectionChange=function(e){e&&e.length>0?(this.$scope.hostName=e[0].hostName,this.showNoItemSelected=!1):(this.$scope.hostName=null,this.showNoItemSelected=!0)},e.prototype.buildSignPostContentView=function(e){this.propertyValueDictionary=[],this.propertyValueDictionary.push({property:this.i18n("DvsUi","healthCheck.monitor.signpost.disconnectedHosts"),value:e.disconnectedHostsCount},{property:this.i18n("DvsUi","healthCheck.monitor.signpost.outOfSyncHosts"),value:e.outOfSyncHostsCount},{property:this.i18n("DvsUi","healthCheck.monitor.signpost.unsupportedVlan"),value:e.unsupportedVlansCount},{property:this.i18n("DvsUi","healthCheck.monitor.signpost.mtuMismatch"),value:e.mtuMismatchCount},{property:this.i18n("DvsUi","healthCheck.monitor.signpost.ipHashMismatch"),value:e.ipHashMismatchCount});for(var t=[],i=0,r=this.propertyValueDictionary;i<r.length;i++){var n=r[i];t.push('<div class="row">\n               <div class="col-md-8">\n                  <span class="nw-property-label-group">\n                     '+n.property+'\n                  </span>\n               </div>\n               <div class="col-md-2">\n                  <span class="nw-property-label-group">\n                     '+n.value+"\n                  </span>\n               </div>\n            </div>")}return t.join(" ")},e.$inject=["$q","$rootScope","$scope","i18nService","dataService","vuiConstants","columnRenderersRegistry","networkUiConstants","vxPropertyViewService"],e.HEALTH_CHECK_DATA_PROPERTY_NAME="dvsHealthCheckMonitor:dvsHealthCheckData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckMonitorView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={healthCheckVlanItemsData:"<"},this.templateUrl="dvs-ui/resources/dvs/healthcheck/monitor/components/dvsHealthCheckMonitorVlanMtuViewTemplate.html",this.controller=i}return e}();e.DvsHealthCheckMonitorVlanViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.$rootScope=t,this.$scope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.pnicSettingsDialogService=o,this.defaultUriSchemeUtil=a,this.$compile=s,this.createDataGrid(this.healthCheckVlanItemsData)}return e.prototype.$onInit=function(){this.refresh()},e.prototype.$onChanges=function(){this.datagridOptions.data=this.healthCheckVlanItemsData?this.healthCheckVlanItemsData:[]},e.prototype.refresh=function(){this.createDataGrid(this.healthCheckVlanItemsData)},e.prototype.createDataGrid=function(e){var t=this;this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:e,resizable:!0,height:"100%",pageConfig:{hidePager:!0},showPnicDialog:function(e){t.pnicSettingsDialogService.show(t.defaultUriSchemeUtil.getVsphereObjectId(e.hostMor),e.pnicName,e.hostName)}}},e.prototype.createColumnDefinitions=function(){var t=this.columnRenderersRegistry.getColumnRenderer("icon-text");return[{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.uplink.column"),field:"uplinkName",width:"150px"},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.pnic.column"),field:"pnicName",width:"150px",template:function(i){var r=t(["icon","text"],{icon:e.PNIC_ICON_ID,text:i.pnicName}),n=['<a ng-click="datagridOptions.showPnicDialog(dataItem)">',r,"</a>"].join("");return n}},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.trunk.column"),field:"vlanTrunk",width:"150px"},{displayName:this.i18nService.getString("DvsUi","healthCheck.monitor.health.vlan.vlanStatus.column"),field:"vlanStatus",width:"150px",template:function(e){return t(["icon","text"],{icon:e.vlanStatusIcon,text:e.vlanStatus})}}]},e.$inject=["i18nService","$rootScope","$scope","vuiConstants","columnRenderersRegistry","pnicSettingsDialogService","defaultUriSchemeUtil","$compile"],e.PNIC_ICON_ID="network-lib-ui-icon-physicalAdapter",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHealthCheckMonitorVlanView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/import/dvsImportComponentTemplate.html"}return e}();e.DvsImportComponent=t;var i=function(){function e(){this.bindings={wizardModel:"<"},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/import/dvpgRestoreComponentTemplate.html"}return e}();e.DvpgRestoreComponent=i;var r=function(){function e(e,t,i,r){this.i18nService=e,this.exportDvsConstants=t,this.$element=i,this.$timeout=r,this.hintLabel="",this.FILE_INPUT_SELECTOR=".import-dvs-upload-file-input"}return e.prototype.$onInit=function(){var e=this;this.hintLabel=this.wizardModel.isDvpgConfig?this.i18nService.getString("DvsUi","dvpg.import.filePage.hintLabel"):this.i18nService.getString("DvsUi","dvs.import.wizard.filePage.hintLabel");var t=this.$element.find(this.FILE_INPUT_SELECTOR);t.on("change",function(t){t.target.files&&t.target.files.length&&e.setImportFile(t.target.files[0])})},e.prototype.setImportFile=function(e){this.wizardModel.configurationPageModel.configurationData="",this._fileReader=new FileReader,this._fileReader&&e&&(this._fileReader.readAsArrayBuffer(e),this._fileReader.onload=this.onLoad.bind(this),this.wizardModel.configurationPageModel.fileLocation=e.name)},e.prototype.onLoad=function(){var e=this._fileReader.result,t=new Uint8Array(e);this.saveByteArray(t)},e.prototype.saveByteArray=function(e){if(this.wizardModel.isRestoreAction&&this.wizardModel.isDvpgConfig)this.wizardModel.configurationPageModel.restoreType===this.exportDvsConstants.configurationRestoreTypes.FROM_FILE&&(this.wizardModel.configurationPageModel.restoreDvpgConfigurationData=[].slice.call(e));else{var t=this.arrayBufferToString(e);t=window.btoa(t),this.wizardModel.configurationPageModel.configurationData=t}},e.prototype.onBrowseButtonClicked=function(){var e=this.$element.find(this.FILE_INPUT_SELECTOR);this.$timeout(function(){e.click()})},e.prototype.arrayBufferToString=function(e){for(var t=e.length,i="",r=Math.pow(2,16)-1,n=0;n<t;n+=r)n+r>t&&(r=t-n),i+=String.fromCharCode.apply(null,e.subarray(n,n+r));return i},e.$inject=["i18nService","exportDvsConstants","$element","$timeout"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsImportComponent",new t),angular.module("com.vmware.vsphere.client.dvs").component("dvpgRestoreComponent",new i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/import/dvsImportReadyToCompletePageComponentTemplate.html"}return e}();e.DvsImportReadyToCompletePageComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.vxPropertyViewService=t,this.vimEntityEscapingService=i,this.networkUiConstants=r}return e.prototype.$onInit=function(){this.buildPropertyView()},e.prototype.buildPropertyView=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general");this.wizardModel.isDvpgConfig?this.wizardModel.isRestoreAction?this.buildDvpgRestorePropView(t):this.buildDvpgImportPropView(t):this.buildDvsImportPropView(t),this.propertyViewData=e.build()},e.prototype.getPortBindingLabel=function(e){var t="";return this.networkUiConstants.PortgroupType.EARLY_BINDING===e?t="dvpg.import.summary.portBinding.static":this.networkUiConstants.PortgroupType.LATE_BINDING===e?t="dvpg.import.summary.portBinding.dynamic":this.networkUiConstants.PortgroupType.EPHEMERAL===e&&(t="dvpg.import.summary.portBinding.ephemeral"),this.i18nService.getString("DvsUi",t)},e.prototype.buildDvpgImportPropView=function(e){var t=this.wizardModel.configurationPageModel,i=e.section("importSettings").title(this.i18nService.getString("DvsUi","dvpg.import.summary.settingsHeader")),r=t.dvsImportPortgroupWrapperSpec.dvsImportPortgroupSpec;i.property(this.i18nService.getString("DvsUi","dvpg.import.summary.nameLabel"),r.portgroupName),r.nameAlreadyExists&&i.message(this.i18nService.getString("DvsUi","dvpg.import.summary.nameConflictError",r.newPortgroupName),"vsphere-icon-status-warning"),i.property(this.i18nService.getString("DvsUi","dvpg.import.summary.vlanLabel"),t.dvsImportPortgroupWrapperSpec.vlanLabel);var n=r.isUplink?this.i18nService.getString("DvsUi","dvpg.import.summary.type.uplink"):this.i18nService.getString("DvsUi","dvpg.import.summary.type.standard");if(i.property(this.i18nService.getString("DvsUi","dvpg.import.summary.typeLabel"),n),i.property(this.i18nService.getString("DvsUi","dvpg.import.summary.portBindingLabel"),this.getPortBindingLabel(r.portBinding)),this.networkUiConstants.PortgroupType.EARLY_BINDING===r.portBinding&&!r.isUplink){var o=r.autoExpand?this.i18nService.getString("DvsUi","dvpg.import.summary.portAllocation.elastic"):this.i18nService.getString("DvsUi","dvpg.import.summary.portAllocation.fixed");i.property(this.i18nService.getString("DvsUi","dvpg.import.summary.portAllocationLabel"),o)}r.annotation&&i.property(this.i18nService.getString("DvsUi","dvpg.import.summary.annotation"),r.annotation)},e.prototype.buildDvsImportPropView=function(e){var t=this.wizardModel.configurationPageModel,i=e.section("importSettings");if(this.wizardModel.isRestoreAction?i.title(this.i18nService.getString("DvsUi","dvs.restore.wizard.summaryPage.header")):i.title(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.header")),i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.fileName"),t.fileLocation),void 0!==t.dvsImportInfoSpec){var r=this.vimEntityEscapingService.unescapeSpecialCharacters(t.dvsImportInfoSpec.dvsName);i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.switchName"),r),i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.switchVersion"),t.dvsImportInfoSpec.dvsVersion),t.dvsImportInfoSpec.differentContextKey&&this.wizardModel.isRestoreAction&&i.message(this.i18nService.getString("DvsUi","dvs.restore.wizard.summaryPage.differentSwitch"),"vsphere-icon-status-warning"),i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.pgCount"),t.dvsImportInfoSpec.portgroupCount),i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.uplinkCount"),t.dvsImportInfoSpec.uplinksCount),i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.nrpCount"),t.dvsImportInfoSpec.nrpCount),void 0!==t.dvsImportInfoSpec.lagCount&&i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.lagCount"),t.dvsImportInfoSpec.lagCount),t.dvsImportInfoSpec.annotation&&i.property(this.i18nService.getString("DvsUi","dvs.import.wizard.summaryPage.annotation"),t.dvsImportInfoSpec.annotation).renderAsHtml(!0)}},e.prototype.buildDvpgRestorePropView=function(e){for(var t=this.wizardModel.configurationPageModel,i=0,r=t.dvPortgroupRestoreInfoWrapperSpec.dvpgRestoreSectionRepresentationSpec;i<r.length;i++)for(var n=r[i],o=e.section(n.sectionTitle).title(n.sectionTitle),a=0,s=n.sectionSettings;a<s.length;a++){var c=s[a];o.property(c.key,c.value)}},e.$inject=["i18nService","vxPropertyViewService","vimEntityEscapingService","networkUiConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsImportReadyToCompletePageComponent",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.page={SWITCH_CONFIGURATION_PAGE:"switchConfigurationPage",READY_TO_COMPLETE_PAGE:"readyToCompletePage"},e}();e.DvsImportWizardConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.pageStateManagementService=e}return e.prototype.init=function(e){this.pages=e.wizardConfig.pages,this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e)},e.$inject=["pageStateManagementService","vuiConstants"],e}();e.DvsImportWizardFlowManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsImportWizardFlowManager",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.dvs.api.spec.DvPortgroupQueryRestoreSpec,i=function(){function i(e,t,i,r,n,o){this.i18nService=e,this.dataService=t,this.$q=i,this.wizardPageService=r,this.clarityModalService=n,this.exportDvsConstants=o}return i.prototype.createPages=function(t,i,r){var n=this,o=this.getFilePageProperties(i,r),a={id:e.DvsImportWizardConstants.page.SWITCH_CONFIGURATION_PAGE,title:o.filePageTitle,description:o.filePageDescription,contentUrl:o.filePageTemplate,onCommit:function(){return n.onConfigurationPageCommit(t,i,r)}},s={id:e.DvsImportWizardConstants.page.READY_TO_COMPLETE_PAGE,
title:this.i18nService.getString("DvsUi","dvs.import.wizard.readyToCompletePage.title"),description:this.i18nService.getString("DvsUi","dvs.import.wizard.readyToCompletePage.description"),contentUrl:"dvs-ui/resources/dvs/import/views/dvsImportReadyToCompletePage.html",validationParams:[],validationFunction:function(){return!0}},c=[a,s];return c},i.prototype.getFilePageProperties=function(e,t){var i={filePageTitle:"",filePageDescription:"",filePageTemplate:""};return t?(i.filePageTitle=e?this.i18nService.getString("DvsUi","dvpg.restore.selectPage.title"):this.i18nService.getString("DvsUi","dvs.restore.wizard.filePage.tocTitle"),i.filePageDescription=e?this.i18nService.getString("DvsUi","dvpg.restore.selectPage.desc"):this.i18nService.getString("DvsUi","dvs.restore.wizard.filePage.desc"),i.filePageTemplate=e?"dvs-ui/resources/dvs/import/views/dvpgRestoreConfigurationPage.html":"dvs-ui/resources/dvs/import/views/dvsImportSwitchConfigurationPage.html"):(i.filePageTitle=e?this.i18nService.getString("DvsUi","dvpg.import.filePage.title"):this.i18nService.getString("DvsUi","dvs.import.wizard.filePage.title"),i.filePageDescription=e?this.i18nService.getString("DvsUi","dvpg.import.filePage.desc"):this.i18nService.getString("DvsUi","dvs.import.wizard.filePage.desc"),i.filePageTemplate="dvs-ui/resources/dvs/import/views/dvsImportSwitchConfigurationPage.html"),i},i.prototype.onConfigurationPageCommit=function(e,i,r){var n=this,o=this.$q.defer(),a=!(e.model.configurationPageModel.configurationData||i&&r),s=i&&r&&e.model.configurationPageModel.restoreType!==this.exportDvsConstants.configurationRestoreTypes.FROM_PREVIOUS_CONFIGURATION&&!e.model.configurationPageModel.restoreDvpgConfigurationData;if(a||s){var c=void 0;c=i?r?this.i18nService.getString("DvsUi","dvpg.restore.selectPage.selectNote"):this.i18nService.getString("DvsUi","dvpg.import.filePage.selectNote"):this.i18nService.getString("DvsUi","dvs.import.wizard.filePage.selectNote"),this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,c),o.resolve(!1)}else{var l="dvs:switchImportInfoWrapper",d="dvpg:dvpgImportInfoWrapper",u="dvpg:dvpgRestoreInfoWrapper",p=l;i&&(p=r?u:d);var v="[B",m=(new t)._type;e.wizardConfig.loading=!0;var g=void 0;if(i&&r){var h=new t;e.model.configurationPageModel.restoreType===this.exportDvsConstants.configurationRestoreTypes.FROM_PREVIOUS_CONFIGURATION?h.fromMemory=!0:(h.fromMemory=!1,h.fileConfig=e.model.configurationPageModel.restoreDvpgConfigurationData),g=[{propertyName:p,parameterType:m,parameter:h}]}else g=[{propertyName:p,parameterType:v,parameter:e.model.configurationPageModel.configurationData}];this.dataService.getProperties(e.model.objectId,p,{propertyParams:g}).then(function(t){if(t&&t[p]||(e.wizardConfig.loading=!1,o.resolve(!1)),i)if(r){var a=t[p];a&&(a.error?(n.wizardPageService.clearErrors(e.wizardConfig),n.showErrorDialog(a.error,function(){o.resolve(!1)},i)):(e.model.configurationPageModel.dvPortgroupRestoreInfoWrapperSpec=a,n.wizardPageService.markPageComplete(e.wizardConfig),o.resolve(!0)))}else{var s=t[d];s&&(s.error?(n.wizardPageService.clearErrors(e.wizardConfig),n.showErrorDialog(s.error,function(){o.resolve(!1)},i)):(s.dvsImportPortgroupWrapperSpec&&(e.model.configurationPageModel.dvsImportPortgroupWrapperSpec=s.dvsImportPortgroupWrapperSpec),n.wizardPageService.markPageComplete(e.wizardConfig),o.resolve(!0)))}else{var c=t[p];c&&(c.error?(n.wizardPageService.clearErrors(e.wizardConfig),n.showErrorDialog(c.error,function(){o.resolve(!1)},i)):(c.dvsImportInfoSpec&&(e.model.configurationPageModel.dvsImportInfoSpec=c.dvsImportInfoSpec),n.wizardPageService.markPageComplete(e.wizardConfig),o.resolve(!0)))}e.wizardConfig.loading=!1},function(t){e.wizardConfig.loading=!1,o.resolve(!1)})}return o.promise},i.prototype.showErrorDialog=function(e,t,i){this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("DvsUi","dvs.import.wizard.error"),message:i?e:this.i18nService.getString("DvsUi","dvs.import.wizard.filePage.internalError",e),clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"},saveButtonLabel:this.i18nService.getString("Common","alert.ok"),hideCancelButton:!0,submit:t})},i.$inject=["i18nService","dataService","$q","wizardPageService","clarityModalService","exportDvsConstants"],i}();e.DvsImportWizardPages=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsImportWizardPages",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.dvs.api.spec.DvsImportActionSpec,i=com.vmware.vsphere.client.dvs.api.spec.DvsRestoreActionSpec,r=com.vmware.vsphere.client.dvs.api.spec.DvsImportPortgroupSpec,n=com.vmware.vsphere.client.dvs.api.spec.DvPortgroupApplyRestoreSpec,o=function(){function o(e,t,i,r,n,o,a,s,c,l){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.mutationService=r,this.dataService=n,this.wizardValidationService=o,this.vimEntityEscapingService=a,this.dvsImportWizardPages=s,this.dvsImportWizardFlowManager=c,this.exportDvsConstants=l}return o.prototype.show=function(o,a,s){var c=this,l=this.$rootScope.$new();l.model=new e.DvsImportWizardModel,l.model.objectId=o,l.model.isDvpgConfig=a,l.model.isRestoreAction=s;var d=new e.WizardConfig;s?d.title=a?this.i18nService.getString("DvsUi","dvs.restore.wizard.titleInitial"):this.i18nService.getString("DvsUi","dvs.restore.wizard.titleInitial"):d.title=a?this.i18nService.getString("DvsUi","dvpg.import.wizard.titleInitial"):this.i18nService.getString("DvsUi","dvs.import.wizard.titleInitial"),d.loadingMessage=this.i18nService.getString("CommonUi","wizard.loading"),d.cssClass="vui-wizard.dvs-import-wizard",d.onFinish=function(){var e,o;return s?a?(e={configSpec:l.model.configurationPageModel.dvPortgroupRestoreInfoWrapperSpec.dvPortgroupRestoreInfoSpec.configSpecDiff},o=(new n)._type):(e={configData:l.model.configurationPageModel.configurationData,restorePortgroups:l.model.configurationPageModel.restorePortgroups===c.exportDvsConstants.configurationsToExport.DVS_AND_ALL_PORTGROUPS,infoSpec:l.model.configurationPageModel.dvsImportInfoSpec},o=(new i)._type):a?(e=l.model.configurationPageModel.dvsImportPortgroupWrapperSpec.dvsImportPortgroupSpec,o=(new r)._type):(e={configData:l.model.configurationPageModel.configurationData,createNewObjectKeys:!l.model.configurationPageModel.preserveOriginalIdentifiers,infoSpec:l.model.configurationPageModel.dvsImportInfoSpec},o=(new t)._type),c.mutationService.apply(l.model.objectId,o,e),!0},d.pages=this.dvsImportWizardPages.createPages(l,a,s),l.wizardConfig=d,this.wizardValidationService.initWizardValidation(l),this.dvsImportWizardFlowManager.init(l),this.vuiWizardService({scope:l,configObjectName:"wizardConfig"}).show();var u="name";this.dataService.getProperties(l.model.objectId,[u]).then(function(e){if(e&&e[u]){var t=c.vimEntityEscapingService.unescapeSpecialCharacters(e[u]);t&&(s?d.title=a?c.i18nService.getString("DvsUi","dvpg.restore.wizard.title",t):c.i18nService.getString("DvsUi","dvs.restore.wizard.title",t):d.title=a?c.i18nService.getString("DvsUi","dvpg.import.wizard.title",t):c.i18nService.getString("DvsUi","dvs.import.wizard.title",t))}})},o.$inject=["$rootScope","i18nService","vuiWizardService","mutationService","dataService","wizardValidationService","vimEntityEscapingService","dvsImportWizardPages","dvsImportWizardFlowManager","exportDvsConstants"],o}();e.DvsImportWizardService=o,angular.module("com.vmware.vsphere.client.dvs").service("dvsImportWizardService",o)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.preserveOriginalIdentifiers=!1,this.restorePortgroups="dvsAndAllPortgroups",this.restoreType="previous"}return e}();e.DvsImportWizardConfigurationPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.configurationPageModel=new e.DvsImportWizardConfigurationPageModel}return t}();e.DvsImportWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.loading=!1,this.pages=[]}return e}();e.WizardConfig=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={dvsId:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/lacp/lacpConfigTemplate.html"}return e}();e.LacpConfigComponent=t;var i=function(){function e(t,i,r,n){this.dataService=t,this.i18n=i,this.lagPropertiesService=r,this.configurationService=n,this.liveRefreshProperties=[e.LAGS_PROPERTY]}return e.prototype.$onInit=function(){this.getData()},e.prototype.getData=function(){var t=this;this.hasPendingRequest=!0,this.dataService.getProperties(this.dvsId,e.LAGS_PROPERTY).then(function(t){return t[e.LAGS_PROPERTY]}).then(function(e){e||(e=[]),t.lacpGroupConfig=e,t.hasPendingRequest=!1})},e.prototype.selectionChanged=function(e){null!==e?(this.propertiesData=this.lagPropertiesService.getPropertyViewData(e),this.selectedLagName=e.name,this.hasSelection=!0):this.hasSelection=!1},e.LAGS_PROPERTY="config.lacpGroupConfig",e.$inject=["dataService","i18nService","lagPropertiesService","configurationService"],e}();e.LacpConfigController=i,angular.module("com.vmware.vsphere.client.dvs").component("lacpConfig",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.Mode=function(){function e(){}return e.ACTIVE="active",e.PASSIVE="passive",e}(),e.Vlan=function(){function e(){}return e.OUT_RANGE_DELIMITER=", ",e.OUT_RANGE_DIVIDER="-",e}(),e}();e.LagConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=e.LagConstants,i=function(){function e(e){this.i18nService=e}return e.prototype.getLacpModeText=function(e){switch(e){case t.Mode.ACTIVE:return this.i18nService.getString("DvsUi","lag.mode.active");case t.Mode.PASSIVE:return this.i18nService.getString("DvsUi","lag.mode.passive");default:return""}},e.prototype.getLoadBalancingModeText=function(e){return this.i18nService.getString("DvsUi","lag.loadBalancingMode."+e)},e.prototype.getVlanText=function(e){if(!e||null===e.vlan||null===e.vlan.vlanId||0===e.vlan.vlanId.length)return this.i18nService.getString("DvsUi","lag.vlan.inherit");var i="";return _.forEach(e.vlan.vlanId,function(e){i+=e.start===e.end?e.start.toString():e.start.toString()+t.Vlan.OUT_RANGE_DIVIDER+e.end.toString(),i+=t.Vlan.OUT_RANGE_DELIMITER}),i.length>0&&(i=i.substring(0,i.length-t.Vlan.OUT_RANGE_DELIMITER.length)),i},e.prototype.getIpfixText=function(e){return e&&null!==e.ipfix&&null!==e.ipfix.ipfixEnabled?e.ipfix.ipfixEnabled?this.i18nService.getString("DvsUi","lag.ipfix.on"):this.i18nService.getString("DvsUi","lag.ipfix.off"):this.i18nService.getString("DvsUi","lag.ipfix.inherit")},e.$inject=["i18nService"],e}();e.LagPropertiesFormattingService=i,angular.module("com.vmware.vsphere.client.dvs").service("lagPropertiesFormattingService",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.formattingService=e,this.vxPropertyViewService=t,this.i18n=i}return e.prototype.getPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("general"),r=i.section("generalSection"),n=i.section("policies").title(this.i18n.getString("DvsUi","lag.properties.policies"));return r.property(this.i18n.getString("DvsUi","lag.properties.name"),e.name),r.property(this.i18n.getString("DvsUi","lag.properties.numPorts"),e.uplinkNum.toString()),r.property(this.i18n.getString("DvsUi","lag.properties.mode"),this.formattingService.getLacpModeText(e.mode)),r.property(this.i18n.getString("DvsUi","lag.properties.loadBalancing"),this.formattingService.getLoadBalancingModeText(e.loadbalanceAlgorithm)),n.property(this.i18n.getString("DvsUi","lag.properties.vlanLabel"),this.formattingService.getVlanText(e)),n.property(this.i18n.getString("DvsUi","lag.properties.ipfixLabel"),this.formattingService.getIpfixText(e)),t.build()},e.$inject=["lagPropertiesFormattingService","vxPropertyViewService","i18nService"],e}();e.LagPropertiesService=t,angular.module("com.vmware.vsphere.client.dvs").service("lagPropertiesService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/lacpupgrade/components/dvsLagPageComponentTemplate.html"}return e}();e.DvsLagPageComponent=t;var i=function(){function e(e,t,i,r,n){var o=this;this.i18nService=e,this.vxPropertyViewService=t,this.vxValidatorFactory=i,this.formattingService=r,this.dvsLagPageValidator=n,this.validateLagName=function(e){return o.dvsLagPageValidator.getLagNameError(e)},this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.lagNameValidator=this.vxValidatorFactory.create(),this.buildLagDetails()},e.prototype.buildLagDetails=function(){this.uplinkNum=this.wizardModel.lag.uplinkNum.toString(),this.lagMode=this.formattingService.getLacpModeText(this.wizardModel.lag.mode),this.loadBalancing=this.formattingService.getLoadBalancingModeText(this.wizardModel.lag.loadbalanceAlgorithm),this.vlan=this.formattingService.getVlanText(this.wizardModel.lag),this.netFlow=this.formattingService.getIpfixText(this.wizardModel.lag)},e.$inject=["i18nService","vxPropertyViewService","vxValidatorFactory","lagPropertiesFormattingService","dvsLagPageValidator"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsLagPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/lacpupgrade/components/dvsUpgradeLacpSummaryPageTemplate.html"}return e}();e.DvsUpgradeLacpSummaryPageComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.vxPropertyViewService=t,this.$sce=i,this.formattingService=r,this.overviewInfo=this.$sce.trustAsHtml(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.overview"))}return e.prototype.$onInit=function(){this.buildPropertyView()},e.prototype.buildPropertyView=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general"),i=t.section("lagSection").title(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.lag"));if(null!==this.wizardModel.lag){i.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.lagName"),this.wizardModel.lag.name),i.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.numPorts"),this.wizardModel.lag.uplinkNum.toString()),i.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.mode"),this.formattingService.getLacpModeText(this.wizardModel.lag.mode)),i.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.loadBalancing"),this.formattingService.getLoadBalancingModeText(this.wizardModel.lag.loadbalanceAlgorithm)),i.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.vlanLabel"),this.formattingService.getVlanText(this.wizardModel.lag)),i.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.ipfixLabel"),this.formattingService.getIpfixText(this.wizardModel.lag));var r=t.section("entitySection").title(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.affectedEntities"));r.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.numberOfPortGroups"),this.wizardModel.portgroupCount.toString()),this.wizardModel.portgroupCount>0&&r.warning(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.portGroupChanges")),r.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.numberOfHosts"),this.wizardModel.hostCount.toString()),this.wizardModel.hostCount>0&&r.warning(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.hostChanges"))}else i.warning(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.lag.notNeeded"));this.propertyViewData=e.build()},e.$inject=["i18nService","vxPropertyViewService","$sce","lagPropertiesFormattingService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsUpgradeLacpSummaryPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvsUpgradeLacpWizardConstants",{pages:{DVS_LACP_OVERVIEW_PAGE:"lacpOverviewPage",DVS_LACP_VALIDATION_PAGE:"lacpValidatePrerequisitesPage",DVS_LACP_LAG_PAGE:"lacpLagPage",DVS_LACP_SUMMARY_PAGE:"lacpReadyToCompletePage"},properties:{DVS_UPGRADE_LACP_WIZARD_DATA:"lacpupgrade:wizardData"},validationResult:{FAIL:"fail",WARNING:"warning",PASS:"pass"},spec:{MUTATION_SPEC_TYPE:"com.vmware.vim.binding.vim.dvs.DvsUpgradeLacpSpec"},lag:{NAME_MAX_LENGTH:16,ACTIVE_LACP_MODE:"active",PASSIVE_LACP_MODE:"passive",OUT_RANGE_DELIMITER:", ",OUT_RANGE_DIVIDER:"-"}})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.pageStateManagementService=e}return e.prototype.init=function(e){this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e)},e.$inject=["pageStateManagementService"],e}();e.DvsUpgradeLacpWizardManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeLacpWizardManager",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.wizardConstants=t,this.simpleValidationCommit=i,this.dvsPrerequisitesPageValidator=r,this.dvsLagPageValidator=n,this.vuiConstants=o}return e.prototype.createPages=function(e){var t=this,i={id:this.wizardConstants.pages.DVS_LACP_OVERVIEW_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.overview.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.overview.description"),contentUrl:"dvs-ui/resources/dvs/lacpupgrade/views/dvsUpgradeLacpOverviewPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:[]},r={id:this.wizardConstants.pages.DVS_LACP_VALIDATION_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.prerequisites.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.prerequisites.description"),contentUrl:"dvs-ui/resources/dvs/lacpupgrade/views/dvsUpgradeLacpPrerequisitesPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvsPrerequisitesPageValidator.getValidationResult(e.model.prerequisiteChecks,e.model)},e.wizardConfig),validationParams:[]},n={id:this.wizardConstants.pages.DVS_LACP_LAG_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.description"),contentUrl:"dvs-ui/resources/dvs/lacpupgrade/views/dvsUpgradeLacpLagPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvsLagPageValidator.getValidationError(e)},e.wizardConfig),validationParams:["model.lag.name"]},o={id:this.wizardConstants.pages.DVS_LACP_SUMMARY_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.description"),contentUrl:"dvs-ui/resources/dvs/lacpupgrade/views/dvsUpgradeLacpSummaryPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:[]},a=[i,r];return null!==e.model.lag&&a.push(n),a.push(o),a},e.prototype.skipPage=function(e,t){var i=_.findWhere(e,{id:t});i&&(i.state=this.vuiConstants.wizard.pageState.SKIPPED)},e.$inject=["i18nService","dvsUpgradeLacpWizardConstants","simpleValidationCommit","dvsPrerequisitesPageValidator","dvsLagPageValidator","vuiConstants"],e}();e.DvsUpgradeLacpWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeLacpWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.mutationService=r,this.dataService=n,this.specFactory=o,this.wizardConstants=a,this.wizardManager=s,this.wizardPages=c,this.wizardValidationService=l}return t.prototype.show=function(t){var i=this,r=this.$rootScope.$new();r.model=new e.DvsUpgradeLacpWizardModel,r.model.dvsId=t,r.wizardConfig={title:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.initialTitle"),loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),cssClass:"dvs-upgrade-lacp-wizard",onFinish:function(){var e=i.specFactory.buildDvsLacpUpgradeSpec(r.model);return i.mutationService.apply(r.model.dvsId,e._type,e),!0}},r.wizardConfig.pages=this.wizardPages.createPages(r),this.wizardValidationService.initWizardValidation(r),this.wizardManager.init(r),this.requestProperties(r)},t.prototype.requestProperties=function(e){var t=this;e.wizardConfig.loading=!0,this.dataService.getProperties(e.model.dvsId,[this.wizardConstants.properties.DVS_UPGRADE_LACP_WIZARD_DATA]).then(function(i){var r=i[t.wizardConstants.properties.DVS_UPGRADE_LACP_WIZARD_DATA];e.model.dvsName=r.dvsName,e.model.portgroupCount=null!==r.portgroupCount?r.portgroupCount:0,e.model.hostCount=null!==r.hostCount?r.hostCount:0,e.model.prerequisiteChecks=r.prerequisiteCheckResults,e.model.lag=r.lagConfig,e.wizardConfig.title=t.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.titleFormat",e.model.dvsName),null===e.model.lag&&t.wizardPages.skipPage(e.wizardConfig.pages,t.wizardConstants.pages.DVS_LACP_LAG_PAGE),e.wizardConfig.loading=!1,t.vuiWizardService({scope:e,configObjectName:"wizardConfig"}).show()})},t.$inject=["$rootScope","i18nService","vuiWizardService","mutationService","dataService","dvsUpgradeLacpWizardSpecFactory","dvsUpgradeLacpWizardConstants","dvsUpgradeLacpWizardManager","dvsUpgradeLacpWizardPages","wizardValidationService"],t}();e.DvsUpgradeLacpWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeLacpWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.dvs.api.spec.LacpUpgradeSpec,i=function(){function e(e){this.defaultUriSchemeUtil=e}return e.prototype.buildDvsLacpUpgradeSpec=function(e){var i=new t;return i.lag=e.lag,i},e.$inject=["defaultUriSchemeUtil"],e}();e.DvsUpgradeLacpWizardSpecFactory=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeLacpWizardSpecFactory",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.prerequisiteWarningShown=!1}return e}();e.DvsUpgradeLacpWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.wizardConstants=t}return e.prototype.getValidationError=function(e){return this.getLagNameError(e.model.lag.name)},e.prototype.getLagNameError=function(e){return e&&0!==e.trim().length?e.trim().length>this.wizardConstants.lag.NAME_MAX_LENGTH?[this.i18nService.getString("DvsUi","lag.name.nameTooLong")]:[]:[this.i18nService.getString("DvsUi","lag.name.nameRequired")]},e.$inject=["i18nService","dvsUpgradeLacpWizardConstants"],e}();e.DvsLagPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsLagPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"="},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/moveTo/moveDvsToComponentTemplate.html"}return e}();e.MoveDvsToComponent=t;var i=function(){function e(){}return e.prototype.$onInit=function(){var e=this;this.dvsIds=this.pageModel.objectIds,this.onLocationSelected=function(t){e.pageModel.entityToMoveDvsTo=t}},e.$inject=[],e}();angular.module("com.vmware.vsphere.client.dvs").component("moveDvsToComponent",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.MoveNetworkSpec,i=function(){function e(e,t,i,r){this.clarityModalService=e,this.i18nService=t,this.mutationService=i,this.defaultUriSchemeUtil=r}return e.prototype.openMoveToDialog=function(e){var t=this,i={title:this.i18nService.getString("DvsUi","moveto.dialog.title"),subTitle:{objectId:e[0]},defaultButton:"submit",dialogData:{objectIds:e},contentTemplate:"dvs-ui/resources/dvs/moveTo/moveDvsToDialog.html"};i.onSubmit=function(){return t.moveDvsTo(i.dialogData.objectIds,i.dialogData.entityToMoveDvsTo),!0},this.clarityModalService.openOkCancelModal(i)},e.prototype.moveDvsTo=function(e,i){var r=this,n=e.map(function(e){return r.defaultUriSchemeUtil.getManagedObjectReference(e)}),o=new t;return o.entities=n,this.mutationService.apply(i,o._type,o).then(function(){}),!0},e.$inject=["clarityModalService","i18nService","mutationService","defaultUriSchemeUtil"],e}();e.MoveDvsToService=i,angular.module("com.vmware.vsphere.client.dvs").service("moveDvsToService",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/netflow/dvsNetFlowViewTemplate.html"}return e}();e.DvsNetFlowViewComponent=t;var i=function(){function e(e,t,i,r){this.$rootScope=e,this.i18nService=t,this.dataService=i,this.dvsNetFlowViewService=r,this.dvsNetFlowLoading=!1,this.settingsViewHeaderAccessor={},this._actions=[{actionUid:"vsphere.core.dvs.editNetFlow",customLabel:this.i18nService.getString("DvsUi","DvsPropertiesView.edit.label")}]}return e.prototype.$onInit=function(){this.refresh()},Object.defineProperty(e.prototype,"title",{get:function(){return this.i18nService.getString("DvsUi","dvs.netFlowView.title")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"actions",{get:function(){return this._actions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dvsUri",{get:function(){return this._dvsUri},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){var t=this;t.dvsNetFlowLoading=!0,t._dvsUri=this.$rootScope._route.objectId;var i=t.dataService.getProperties(t._dvsUri,[e.NETFLOW_DATA_PROPERTY_NAME]);t._selectedDistributedSwitchPromise=i,i.then(function(r){if(t._selectedDistributedSwitchPromise===i){var n=r?r[e.NETFLOW_DATA_PROPERTY_NAME]:null;n&&(t.dvsNetFlowData=t.dvsNetFlowViewService.buildProperties(n)),t.dvsNetFlowLoading=!1}},function(e){t.dvsNetFlowLoading=!1}),t.settingsViewHeaderAccessor.refresh&&t.settingsViewHeaderAccessor.refresh(),this.liveRefreshProperties=["config.ipfixConfig.collectorPort","config.ipfixConfig.collectorIpAddress","config.ipfixConfig.observationDomainId","config.ipfixConfig.activeFlowTimeout","config.ipfixConfig.idleFlowTimeout","config.ipfixConfig.internalFlowsOnly","config.ipfixConfig.samplingRate","config.switchIpAddress"]},e.$inject=["$rootScope","i18nService","dataService","dvsNetFlowViewService"],e.NETFLOW_DATA_PROPERTY_NAME="dvswitchproperties:netFlowDetails",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsNetFlowView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.vxPropertyViewService=t,this.i18n=this.i18nService.getString}return e.prototype.buildProperties=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("general");return this.addPropertiesToSection(e,i),t.build()},e.prototype.addPropertiesToSection=function(e,t){var i=t.section("generalSection"),r=this.i18n("NetworkUi","NetworkUtil.noData");i.property(this.i18n("DvsUi","dvs.netFlowView.collector.ipAddress"),null!==e.collectorIpAddress&&""!==e.collectorIpAddress?e.collectorIpAddress:r),i.property(this.i18n("DvsUi","dvs.netFlowView.collector.port"),null!==e.collectorPort?e.collectorPort:r),e.ipfixV10Supported&&i.property(this.i18n("DvsUi","dvs.netFlowView.collector.observationDomainId"),null!==e.observationDomainId?e.observationDomainId:r),i.property(this.i18n("DvsUi","dvs.netFlowView.switch.ipAddress"),null!==e.switchIpAddress&&""!==e.switchIpAddress?e.switchIpAddress:r),i.property(this.i18n("DvsUi","dvs.netFlowView.activeFlowTimeout"),null!==e.activeFlowTimeout?this.i18n("DvsUi","dvs.netFlowView.flowTimeout.unitFormat",e.activeFlowTimeout):r),i.property(this.i18n("DvsUi","dvs.netFlowView.idleFlowTimeout"),null!==e.idleFlowTimeout?this.i18n("DvsUi","dvs.netFlowView.flowTimeout.unitFormat",e.idleFlowTimeout):r),i.property(this.i18n("DvsUi","dvs.netFlowView.samplingRate"),null!==e.samplingRate?e.samplingRate:r),i.property(this.i18n("DvsUi","dvs.netFlowView.internalFlowsOnly"),e.internalFlowsOnly?this.i18n("DvsUi","dvs.netFlowView.internalFlowsOnlyEnabled"):this.i18n("DvsUi","dvs.netFlowView.internalFlowsOnlyDisabled"))},e.$inject=["i18nService","vxPropertyViewService"],e}();e.DvsNetFlowViewService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsNetFlowViewService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/netflow/edit/dvsEditNetFlowDialogTemplate.html"}return e}();e.DvsEditNetFlowDialogComponent=t;var i=function(){function t(e,t,i,r){this.i18nService=e,this.networkUtil=t,this.vxValidatorFactory=i,this.dvsEditNetFlowDialogValidator=r,this.i18n=e.getString,this.validator=i.create(),this.validateCollectorIpAddress=this.collectorIpValidator.bind(this),this.validateSwitchIpAddress=this.switchIpValidator.bind(this),this.validateCollectorPort=this.collectorPortValidator.bind(this),this.validateObservationDomainId=this.observationDomainIdValidator.bind(this),this.validateActiveFlowTimeout=this.activeFlowTimeoutValidator.bind(this),this.validateIdleFlowTimeout=this.idleFlowTimeoutValidator.bind(this),this.validateSamplingRate=this.samplingRateValidator.bind(this)}return t.prototype.$onInit=function(){this.collectorIpAddressPlaceholder=this.pageModel.ipv6ForIpfixSupported?this.i18n("NetworkUi","NetFlowPage.collector.ipAllPrompt"):this.i18n("NetworkUi","NetFlowPage.collector.ipv4Prompt"),this.initSwitchAddressSignPost(),this.internalFlowsOnlyOptions=[{label:this.i18nService.getString("NetworkUi","NetFlowPage.advanced.internalFlowsOnlyEnabled"),value:e.DvsEditNetFlowDialogConstants.INTERNAL_FLOWS_ONLY_ENABLED},{label:this.i18nService.getString("NetworkUi","NetFlowPage.advanced.internalFlowsOnlyDisabled"),value:e.DvsEditNetFlowDialogConstants.INTERNAL_FLOWS_ONLY_DISABLED}]},t.prototype.collectorIpValidator=function(){var e=null;return this.pageModel.collectorIpAddress&&(e=this.dvsEditNetFlowDialogValidator.getCollectorIpValidationMessage(this.pageModel.collectorIpAddress,this.pageModel.ipv6ForIpfixSupported)),e?[e]:[]},t.prototype.switchIpValidator=function(){var e=null;return this.pageModel.switchIpAddress&&(e=this.dvsEditNetFlowDialogValidator.getSwitchIpValidationMessage(this.pageModel.switchIpAddress)),e?[e]:[]},t.prototype.collectorPortValidator=function(){var e=this.dvsEditNetFlowDialogValidator.getCollectorPortValidationMessage(this.pageModel.collectorPort);return e?[e]:[]},t.prototype.observationDomainIdValidator=function(){var e=this.dvsEditNetFlowDialogValidator.getObservationDomainIdValidationMessage(this.pageModel.observationDomainId);return e?[e]:[]},t.prototype.activeFlowTimeoutValidator=function(){var e=this.dvsEditNetFlowDialogValidator.getActiveFlowTimeoutValidationMessage(this.pageModel.activeFlowTimeout);return e?[e]:[]},t.prototype.idleFlowTimeoutValidator=function(){var e=this.dvsEditNetFlowDialogValidator.getIdleFlowTimeoutValidationMessage(this.pageModel.idleFlowTimeout);return e?[e]:[]},t.prototype.samplingRateValidator=function(){var e=this.dvsEditNetFlowDialogValidator.getSamplingRateValidationMessage(this.pageModel.samplingRate);return e?[e]:[]},t.prototype.initSwitchAddressSignPost=function(){var e=[this.i18n("NetworkUi","NetFlowPage.info.switchIp.message")];this.pageModel.ipv6ForIpfixSupported&&e.push(this.i18n("NetworkUi","NetFlowPage.info.switchIp.ipv6Disclaimer")),this.signPostConfig={message:this.formatTextMessages(e),title:this.i18n("NetworkUi","NetFlowPage.info.switchIp.title"),"class":"edit-netflow-switchAddress-signpost"}},t.prototype.formatTextMessages=function(e){var t="",i="<div class='horizontal-flex-container'><span class='info-msg-color'>%msg%</span></div>";return e.forEach(function(e){t&&(t+="<br>"),t+=i.replace("%msg%",e)}),t},t.$inject=["i18nService","networkUtil","vxValidatorFactory","dvsEditNetFlowDialogValidator"],t}();angular.module("com.vmware.vsphere.client.dvs").component("dvsEditNetFlowDialog",new t);
}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.COLLECTOR_PORT_MIN_VAL=0,e.COLLECTOR_PORT_MAX_VAL=65535,e.OBSERVATION_DOMAIN_ID_MIN_VAL=0,e.OBSERVATION_DOMAIN_ID_MAX_VAL=4294967295,e.ACTIVE_FLOW_MIN_VAL=60,e.ACTIVE_FLOW_MAX_VAL=3600,e.IDLE_FLOW_MIN_VAL=10,e.IDLE_FLOW_MAX_VAL=600,e.SAMPLING_RATE_MIN_VAL=0,e.SAMPLING_RATE_MAX_VAL=1e3,e.INTERNAL_FLOWS_ONLY_ENABLED=!0,e.INTERNAL_FLOWS_ONLY_DISABLED=!1,e}();e.DvsEditNetFlowDialogConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o){this.dataService=e,this.i18nService=t,this.clarityModalService=i,this.mutationService=r,this.dvsEditNetFlowDialogValidator=n,this.clarityConstants=o,this.i18n=this.i18nService.getString}return t.prototype.show=function(i){function r(){var e=this,t=a?a.buildSpec(n.dialogData.pageModel):null;if(null===t)return!0;var r=this.dvsEditNetFlowDialogValidator.getAllErrors(n.dialogData.pageModel);return r.length>0?(n.alerts=_.map(r,function(t){return{type:e.clarityConstants.notifications.type.ERROR,text:t}}),!1):(this.mutationService.apply(i,t._type,t),!0)}var n={title:this.i18nService.getString("DvsUi","actionEditNetFlowCaption"),defaultButton:"submit",alerts:[],dialogData:{},contentTemplate:"dvs-ui/resources/dvs/netflow/edit/dvsEditNetFlowDialog.html",onSubmit:r.bind(this)},o=this.dataService.getData(i,t.EDIT_NETFLOW_DATA_MODEL),a=null;o.then(function(t){t&&(n.subTitle=t.name,n.dialogData.pageModel=new e.DvsEditNetFlowDialogModel(t),a=new e.DvsEditNetFlowDialogModel(t))}),this.clarityModalService.openOkCancelModal(n)},t.$inject=["dataService","i18nService","clarityModalService","mutationService","dvsEditNetFlowDialogValidator","clarityConstants"],t.EDIT_NETFLOW_DATA_MODEL="com.vmware.vsphere.client.h5.network.dvs.netflow.model.DvsEditNetFlowDialogData",t}();e.DvsEditNetFlowDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditNetFlowDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.dvs.api.spec.DvsConfigSpec,i=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$ConfigSpec,r=function(){function e(e){this.name=e.name,this.configVersion=e.configVersion,this.ipv6ForIpfixSupported=e.ipv6ForIpfixSupported,e.dvsConfigNetflow&&_.extend(this,e.dvsConfigNetflow)}return e.prototype.buildSpec=function(e){var i=this.getDefaultSpec(),r=new t;r.configSpec=i;var n=!1;return this.collectorIpAddress!==e.collectorIpAddress&&(i.ipfixConfig.collectorIpAddress=e.collectorIpAddress,n=!0),this.collectorPort!==Number(e.collectorPort)&&(i.ipfixConfig.collectorPort=e.collectorPort,n=!0),this.observationDomainId!==Number(e.observationDomainId)&&(i.ipfixConfig.observationDomainId=e.observationDomainId,n=!0),this.switchIpAddress!==e.switchIpAddress&&(i.switchIpAddress=e.switchIpAddress,n=!0),this.activeFlowTimeout!==Number(e.activeFlowTimeout)&&(i.ipfixConfig.activeFlowTimeout=e.activeFlowTimeout,n=!0),this.idleFlowTimeout!==Number(e.idleFlowTimeout)&&(i.ipfixConfig.idleFlowTimeout=e.idleFlowTimeout,n=!0),this.samplingRate!==Number(e.samplingRate)&&(i.ipfixConfig.samplingRate=e.samplingRate,n=!0),this.internalFlowsOnly!==e.internalFlowsOnly&&(i.ipfixConfig.internalFlowsOnly=e.internalFlowsOnly,n=!0),n?r:null},e.prototype.getDefaultSpec=function(){var e=new i;return e.configVersion=this.configVersion,e.ipfixConfig=new com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$IpfixConfig,e.ipfixConfig.idleFlowTimeout=this.idleFlowTimeout,e.ipfixConfig.internalFlowsOnly=this.internalFlowsOnly,e.ipfixConfig.samplingRate=this.samplingRate,e.ipfixConfig.activeFlowTimeout=this.activeFlowTimeout,e},e}();e.DvsEditNetFlowDialogModel=r}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.ipParserService=t,this.networkUtil=i,this.i18n=e.getString}return t.prototype.getAllErrors=function(e){var t=[];if(e.collectorIpAddress){var i=this.getCollectorIpValidationMessage(e.collectorIpAddress,e.ipv6ForIpfixSupported);i&&t.push(i)}if(e.switchIpAddress){var i=this.getSwitchIpValidationMessage(e.switchIpAddress);i&&t.push(i)}var r=this.getCollectorPortValidationMessage(e.collectorPort);if(r&&t.push(r),e.ipfixV10Supported){var n=this.getObservationDomainIdValidationMessage(e.observationDomainId);n&&t.push(n)}var o=this.getActiveFlowTimeoutValidationMessage(e.activeFlowTimeout);o&&t.push(o);var a=this.getIdleFlowTimeoutValidationMessage(e.idleFlowTimeout);a&&t.push(a);var s=this.getSamplingRateValidationMessage(e.samplingRate);return s&&t.push(s),t},t.prototype.getCollectorIpValidationMessage=function(e,t){if(t){if(!this.ipParserService.isIpv4AddressValid(e)&&!this.ipParserService.isIpv6AddressValid(e))return this.i18n("NetworkUi","NetFlowPage.error.invalidCollectorAddress.allIp")}else if(!this.ipParserService.isIpv4AddressValid(e))return this.i18n("NetworkUi","NetFlowPage.error.invalidCollectorAddress.ipv4");return null},t.prototype.getSwitchIpValidationMessage=function(e){return this.ipParserService.isIpv4AddressValid(e)?null:this.i18n("NetworkUi","NetFlowPage.error.invalidIpAddress")},t.prototype.getCollectorPortValidationMessage=function(t){var i=e.DvsEditNetFlowDialogConstants.COLLECTOR_PORT_MIN_VAL,r=e.DvsEditNetFlowDialogConstants.COLLECTOR_PORT_MAX_VAL,n=this.i18n("NetworkUi","NetFlowPage.error.collectorPort",i,r);return this.getNumericInputValidationMessage(t,i,r,n)},t.prototype.getObservationDomainIdValidationMessage=function(t){var i=e.DvsEditNetFlowDialogConstants.OBSERVATION_DOMAIN_ID_MIN_VAL,r=e.DvsEditNetFlowDialogConstants.OBSERVATION_DOMAIN_ID_MAX_VAL,n=this.i18n("NetworkUi","NetFlowPage.error.observationDomainId",i,r);return this.getNumericInputValidationMessage(t,i,r,n)},t.prototype.getActiveFlowTimeoutValidationMessage=function(t){var i=e.DvsEditNetFlowDialogConstants.ACTIVE_FLOW_MIN_VAL,r=e.DvsEditNetFlowDialogConstants.ACTIVE_FLOW_MAX_VAL,n=this.i18n("DvsUi","NetFlowPage.error.activeFlowTimeout",i,r);return this.getNumericInputValidationMessage(t,i,r,n)},t.prototype.getIdleFlowTimeoutValidationMessage=function(t){var i=e.DvsEditNetFlowDialogConstants.IDLE_FLOW_MIN_VAL,r=e.DvsEditNetFlowDialogConstants.IDLE_FLOW_MAX_VAL,n=this.i18n("DvsUi","NetFlowPage.error.idleFlowTimeout",i,r);return this.getNumericInputValidationMessage(t,i,r,n)},t.prototype.getSamplingRateValidationMessage=function(t){var i=e.DvsEditNetFlowDialogConstants.SAMPLING_RATE_MIN_VAL,r=e.DvsEditNetFlowDialogConstants.SAMPLING_RATE_MAX_VAL,n=this.i18n("DvsUi","NetFlowPage.error.samplingRate",i,r);return this.getNumericInputValidationMessage(t,i,r,n)},t.prototype.getNumericInputValidationMessage=function(e,t,i,r){return this.networkUtil.isPositiveInteger(Number(e),t,i)?null:r},t.$inject=["i18nService","ipParserService","networkUtil"],t}();e.DvsEditNetFlowDialogValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditNetFlowDialogValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/niocupgrade/components/dvsNiocSharesPageComponentTemplate.html"}return e}();e.DvsNiocSharesPageComponent=t;var i=function(){function e(e){this.i18nService=e,this.i18n=this.i18nService.getString}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsNiocSharesPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/niocupgrade/components/dvsUpgradeNiocSummaryPageTemplate.html"}return e}();e.DvsUpgradeNiocSummaryPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.vxPropertyViewService=t,this.$scope=i,this.$scope.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.buildPropertyView()},e.prototype.buildPropertyView=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general");if(this.wizardModel.niocUpgradeStatistics&&this.wizardModel.niocUpgradeStatistics.userDefinedNrpCount>0){var i=t.section("modifiedObjectSection").title(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.modifiedObjects"));i.property(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.userDefinedNrpsCount"),this.wizardModel.niocUpgradeStatistics.userDefinedNrpCount.toString()),i.property(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.portGroupCount"),this.wizardModel.niocUpgradeStatistics.modifiedPortGroupCount.toString()),this.wizardModel.migrateShares&&(i.property(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.migrateShares"),this.wizardModel.migrateShares?this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.migrateShares.on"):this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.migrateShares.off")),i.property(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.vmCount"),this.wizardModel.niocUpgradeStatistics.modifiedVmCount.toString()))}t.section("nextStepSection").title(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.nextSteps"));this.propertyViewData=e.build()},e.$inject=["i18nService","vxPropertyViewService","$scope"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsUpgradeNiocSummaryPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvsUpgradeNiocWizardConstants",{pages:{DVS_NIOC_OVERVIEW_PAGE:"niocOverviewPage",DVS_NIOC_VALIDATION_PAGE:"niocValidatePrerequisitesPage",DVS_NIOC_MIGRATE_SHARES_PAGE:"niocLagPage",DVS_NIOC_SUMMARY_PAGE:"niocReadyToCompletePage"},properties:{DVS_UPGRADE_NIOC_WIZARD_DATA:"niocupgrade:wizardData"},validationResult:{FAIL:"fail",WARNING:"warning",PASS:"pass"},spec:{MUTATION_SPEC_TYPE:"com.vmware.vsphere.client.dvs.specs.DvsResControlUpgradeSpec"}})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.pageStateManagementService=e}return e.prototype.init=function(e){this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e)},e.$inject=["pageStateManagementService"],e}();e.DvsUpgradeNiocWizardManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeNiocWizardManager",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.wizardConstants=t,this.simpleValidationCommit=i,this.dvsPrerequisitesPageValidator=r,this.vuiConstants=n}return e.prototype.createPages=function(e){var t=this,i={id:this.wizardConstants.pages.DVS_NIOC_OVERVIEW_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.overview.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.overview.description"),contentUrl:"dvs-ui/resources/dvs/niocupgrade/views/dvsUpgradeNiocOverviewPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:[]},r={id:this.wizardConstants.pages.DVS_NIOC_VALIDATION_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.prerequisites.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.prerequisites.description"),contentUrl:"dvs-ui/resources/dvs/niocupgrade/views/dvsUpgradeNiocPrerequisitesPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvsPrerequisitesPageValidator.getValidationResult(e.model.prerequisiteChecks,e.model)},e.wizardConfig),validationParams:[]},n={id:this.wizardConstants.pages.DVS_NIOC_MIGRATE_SHARES_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.migrateShares.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.migrateShares.description"),contentUrl:"dvs-ui/resources/dvs/niocupgrade/views/dvsUpgradeNiocSharesPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.migrateShares"]},o={id:this.wizardConstants.pages.DVS_NIOC_SUMMARY_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.description"),contentUrl:"dvs-ui/resources/dvs/niocupgrade/views/dvsUpgradeNiocSummaryPage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:[]},a=[i,r,n,o];return a},e.prototype.skipPage=function(e,t){var i=_.findWhere(e,{id:t});i&&(i.state=this.vuiConstants.wizard.pageState.SKIPPED)},e.$inject=["i18nService","dvsUpgradeNiocWizardConstants","simpleValidationCommit","dvsPrerequisitesPageValidator","vuiConstants"],e}();e.DvsUpgradeNiocWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeNiocWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.mutationService=r,this.dataService=n,this.specFactory=o,this.wizardConstants=a,this.wizardManager=s,this.wizardPages=c,this.wizardValidationService=l}return t.prototype.show=function(t){var i=this,r=this.$rootScope.$new();r.model=new e.DvsUpgradeNiocWizardModel,r.model.dvsId=t,r.wizardConfig={title:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.initialTitle"),loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),cssClass:"dvs-upgrade-nioc-wizard",onFinish:function(){var e=i.specFactory.buildDvsNiocUpgradeSpec(r.model);return i.mutationService.apply(r.model.dvsId,e._type,e),!0}},r.wizardConfig.pages=this.wizardPages.createPages(r),this.wizardValidationService.initWizardValidation(r),this.wizardManager.init(r),this.requestProperties(r)},t.prototype.requestProperties=function(e){var t=this;e.wizardConfig.loading=!0,this.dataService.getProperties(e.model.dvsId,[this.wizardConstants.properties.DVS_UPGRADE_NIOC_WIZARD_DATA]).then(function(i){var r=i[t.wizardConstants.properties.DVS_UPGRADE_NIOC_WIZARD_DATA];e.model.dvsName=r.dvsName,e.model.prerequisiteChecks=r.prerequisiteCheckResults,e.model.niocUpgradeStatistics=r.niocUpgradeStatistics,e.wizardConfig.title=t.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.titleFormat",e.model.dvsName),e.model.niocUpgradeStatistics&&0!==e.model.niocUpgradeStatistics.userDefinedNrpCount||t.wizardPages.skipPage(e.wizardConfig.pages,t.wizardConstants.pages.DVS_NIOC_MIGRATE_SHARES_PAGE),e.wizardConfig.loading=!1,t.vuiWizardService({scope:e,configObjectName:"wizardConfig"}).show()})},t.$inject=["$rootScope","i18nService","vuiWizardService","mutationService","dataService","dvsUpgradeNiocWizardSpecFactory","dvsUpgradeNiocWizardConstants","dvsUpgradeNiocWizardManager","dvsUpgradeNiocWizardPages","wizardValidationService"],t}();e.DvsUpgradeNiocWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeNiocWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.dvs.api.spec.DvsResControlUpgradeSpec,i=function(){function e(e){this.defaultUriSchemeUtil=e}return e.prototype.buildDvsNiocUpgradeSpec=function(e){var i=new t;return i.migrateShares=e.migrateShares,i},e.$inject=["defaultUriSchemeUtil"],e}();e.DvsUpgradeNiocWizardSpecFactory=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeNiocWizardSpecFactory",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.prerequisiteWarningShown=!1,this.migrateShares=!1}return e}();e.DvsUpgradeNiocWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",validator:"<",pageId:"@"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/common/components/dvsSpanSessionEditableListComponentTemplate.html"}return e}();e.DvsSpanSessionEditableListComponent=t;var i=function(){function t(e,t,i,r,n,o){this.i18nService=e,this.vuiConstants=t,this.ipParserService=i,this.vxValidatorFactory=r,this.dvsSpanSessionEditableListValidator=n,this.networkUtil=o,this.getString=function(t,i){return void 0===i&&(i="DvsUi"),e.getString(i,t)},this._loaded=!1}return t.prototype.$onInit=function(){var t=this;switch(this.pageId){case e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_VLANS:this.getInvalidValueError=function(e){return t.dvsSpanSessionEditableListValidator.getVlanIdError(e)},this.getDuplicateValueError=function(e,i){var r=0,n=_.any(i,function(t){return t.value===e&&1===r++});return n?t.getString("AddSpanSessionWizard.sourceVlansPage.duplicateVlanIdError"):null},this.columnName=this.getString("AddSpanSessionWizard.sourceVlansPage.vlanId");break;case e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_ADDRESSES:this.getInvalidValueError=function(e){return t.dvsSpanSessionEditableListValidator.getIpAddressError(e)},this.getDuplicateValueError=function(e,i){var r=t.ipParserService.isIpv6AddressValid(e)?t.ipParserService.expandIpv6Address(e):e,n=i.map(function(e){return t.ipParserService.isIpv6AddressValid(e.value)?t.ipParserService.expandIpv6Address(e.value):e.value}),o=0,a=_.any(n,function(e){return e===r&&1===o++});return a?t.getString("AddSpanSessionWizard.destinationsPage.IpAddressList.ipAddress.error"):null},this.columnName=this.getString("AddSpanSessionWizard.destinationsPage.IpAddressList.ipAddress");break;default:throw new Error("Page ID not supported or not specified!")}this.validator.vxValidator=this.vxValidatorFactory.create(),this.datagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.getColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!0,showCheckboxesOnMultiSelection:!1,actionBarOptions:{actions:this.getActionDefinitions()},onChange:this.onSelectionChange.bind(this),validator:this.validator,syncListModel:this.syncListModel.bind(this),validateAndSyncModel:this.validateAndSyncModel.bind(this),selectItem:function(e){var t=$(".dvs-span-session-editable-grid [kendo-grid]").data("kendoGrid"),i="tr[data-uid='"+e.uid+"']",r=$(i)[0];t.select(r)}},setTimeout(this.loadExistingValues.bind(this),0)},t.prototype.$onDestroy=function(){delete this.validator.vxValidator},t.prototype.onSelectionChange=function(e){this.setActionAvailability(t.REMOVE_ACTION,e&&e.length>0),this._loaded&&(this.datagridOptions.validator.validate(),this.datagridOptions.dataSource._data.forEach(function(t){t.active=!t.valid||_.contains(e,t)||!1}),this.syncListModel())},t.prototype.loadExistingValues=function(){var e=this;this.model.cachedData&&(this.model.cachedData.forEach(function(t){e.datagridOptions.dataSource.add(t)}),this.setItemCallbacks()),this._loaded=!0},t.prototype.getColumnDefinitions=function(){var e=this;return[{displayName:this.columnName,field:"value",type:"string",template:function(e){var t="datagridOptions.validator.vxValidator";return"<vsc-validate class='validateable-input' ng-if='dataItem.active' [validator]='"+t+"'\n                           [required]='false' [custom-validation-function]='dataItem.validationFunction'\n                           [clr-tooltip-direction]=\"'top-left'\">\n                           <input class='fill-parent' ng-model='dataItem.value' type='text'\n                                 vx-focus-and-select ng-blur='datagridOptions.validateAndSyncModel()'\n                                 ng-change='datagridOptions.syncListModel()'\n                                 ng-click='datagridOptions.selectItem(dataItem)'/>\n                        </vsc-validate>\n                        <span ng-if='!dataItem.active' ng-bind='dataItem.value' ng-click='dataItem.onClick()'>"},sortable:function(t,i){return e.networkUtil.compareNumericAndNonNumericValues(t,i,"value")}}]},t.prototype.getActionDefinitions=function(){var e=this;return[{id:t.ADD_ACTION,iconClass:"vsphere-icon-add",enabled:!0,onClick:function(){e.addRow()}},{id:t.REMOVE_ACTION,iconClass:"vsphere-icon-remove",enabled:!0,onClick:function(){e.removeSelectedRows()}}]},t.prototype.addRow=function(){var e=!this.datagridOptions.dataSource._data||!this.datagridOptions.dataSource._data.length||_.last(this.datagridOptions.dataSource._data).valid;if(e){this.datagridOptions.dataSource._data.forEach(function(e){e.active=!e.valid});var t={value:"",active:!0,valid:!0};this.datagridOptions.dataSource.add(t),this.setItemCallbacks(),this.datagridOptions.selectItem(_.last(this.datagridOptions.dataSource._data))}},t.prototype.setItemCallbacks=function(){var e=this;this.datagridOptions.dataSource._data.forEach(function(t){t.validationFunction=function(){if(t.deleted)return[];var i=e.getInvalidValueError(t.value)||e.getDuplicateValueError(t.value,e.datagridOptions.dataSource._data);return t.valid=null===i,t.valid?[]:[i]},t.onClick=function(){t.active=!0}})},t.prototype.removeSelectedRows=function(){var e=this;this.datagridOptions.selectedItems&&(this.datagridOptions.selectedItems.forEach(function(t){e.datagridOptions.dataSource.remove(t),t.deleted=!0}),this.validateAndSyncModel(),this.setActionAvailability(t.REMOVE_ACTION,!1))},t.prototype.syncListModel=function(){var e=[],t=[];this.datagridOptions.dataSource._data.forEach(function(i){e.push(i.value),t.push({value:i.value,active:i.active,valid:i.valid})}),this.model.values="undefined"==typeof this.model.values||this.hasCollectionChanged(e,this.model.values)?e:this.model.values,this.model.cachedData="undefined"==typeof this.model.cachedData||this.hasCollectionChanged(e,this.model.cachedData)?t:this.model.cachedData},t.prototype.hasCollectionChanged=function(e,t){return e.length!==t.length||_.zip(e,t).some(function(e){return e[0]!==e[1]})},t.prototype.validateAndSyncModel=function(){this.datagridOptions.validator.validate(),this.syncListModel()},t.prototype.setActionAvailability=function(e,t){for(var i=0,r=this.datagridOptions.actionBarOptions.actions;i<r.length;i++){var n=r[i];if(n.id===e){n.enabled=t;break}}},t.$inject=["i18nService","vuiConstants","ipParserService","vxValidatorFactory","dvsSpanSessionEditableListValidator","networkUtil"],t.ADD_ACTION="addIpAction",t.REMOVE_ACTION="removeIpAction",t}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSpanSessionEditableList",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={dvsUrn:"<",portsToIgnore:"<",onSelectionChange:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/common/components/dvsSpanSessionPortBrowserComponentTemplate.html"}return e}();e.DvsSpanSessionPortBrowserComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.vuiConstants=t,this.portBrowserService=i,this.getString=function(t,i){return void 0===i&&(i="DvsUi"),e.getString(i,t)}}return e.prototype.$onInit=function(){var e=this;this.datagridOptions=this.portBrowserService.createDatagridOptions(this.onSelectionChange),this.loading=!0,this.portBrowserService.getData(this.dvsUrn).then(function(t){var i;if(e.portsToIgnore&&t){var r={};e.portsToIgnore.forEach(function(e){r[e]=!0}),i=t.filter(function(e){return!r[e.portId]})}else i=t;e.datagridOptions.data=i||[],e.loading=!1})},e.$inject=["i18nService","vuiConstants","dvsSpanSessionPortBrowserService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSpanSessionPortBrowser",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.portlist.DvsSpanSessionPortListItemData,i=function(){function e(){this.bindings={dvsUrn:"<",model:"<",trafficDirectionEnabled:"<",editMode:"<"},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/portmirroring/common/components/dvsSpanSessionPortsListComponentTemplate.html"}return e}();e.DvsSpanSessionPortsListComponent=i;var r=function(){function i(e,t,i,r,n){var o=this;this.i18nService=e,this.vuiConstants=t,this.dataService=i,this.portBrowserDialogService=r,this.portsListService=n,this.getString=function(t,i){return void 0===i&&(i="DvsUi"),e.getString(i,t)},this.preselectComparator=function(e){return o._selectedPortsIds&&o._selectedPortsIds.indexOf(e.portId)>-1},this.loading=!1}return i.prototype.$onInit=function(){var e=this;if(this.datagridOptions=this.portsListService.createDatagridOptions(this.getActionDefinitions(),this.onSelectionChange.bind(this),this.trafficDirectionEnabled),this.editMode){this.loading=!0;var i=this.model.ports.map(function(e){return e.id});this.portsListService.getData(this.dvsUrn,i).then(function(i){e.datagridOptions.data=e.model.ports.map(function(e){var i=new t;return i.portId=e.id,i.trafficDirection=e.trafficDirection,i}),e.onDataRetrieved(i)})}else this.model.cachedData&&setTimeout(function(){e.datagridOptions.data=e.model.cachedData},0)},i.prototype.getActionDefinitions=function(){var t=this,r=[];return r.push({id:i.ADD_ACTION,enabled:!0,iconClass:"network-lib-ui-icon-portAdd",tooltipText:this.i18nService.getString("DvsUi","sessionDvPortSourceList.addPortByPortSelector"),onClick:function(){var e=[];t.model.ports&&(e=_.map(t.model.ports,function(e){return e.id})),t.portBrowserDialogService.show(t.dvsUrn,e,function(e){e&&0!==e.length&&(t.loading=!0,t.portsListService.getData(t.dvsUrn,e).then(function(e){t.onDataRetrieved(e)}))})}}),r.push({id:i.REMOVE_ACTION,enabled:!0,iconClass:"vx-icon-removeIcon",tooltipText:this.i18nService.getString("DvsUi","sessionDvPortSourceList.remove"),onClick:function(){var e=_.map(t.datagridOptions.selectedItems,function(e){return e.portId});t.model.ports=_.filter(t.model.ports,function(t){return e.indexOf(t.id)<0}),t.datagridOptions.data=_.filter(t.datagridOptions.data,function(t){return e.indexOf(t.portId)<0}),t.model.cachedData=t.datagridOptions.data}}),this.trafficDirectionEnabled&&(r.push(this.vuiConstants.actions.SEPARATOR),r.push({id:i.INGRESS_ACTION,enabled:!0,iconClass:"network-lib-ui-icon-ingressTraffic",tooltipText:this.i18nService.getString("DvsUi","sessionDvPortSourceList.ingress"),onClick:function(){t.onTrafficDirectionChange(e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS)}}),r.push({id:i.EGRESS_ACTION,enabled:!0,iconClass:"network-lib-ui-icon-egressTraffic",tooltipText:this.i18nService.getString("DvsUi","sessionDvPortSourceList.egress"),onClick:function(){t.onTrafficDirectionChange(e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS)}}),r.push({id:i.BOTH_ACTION,enabled:!0,iconClass:"network-lib-ui-icon-ingressEgressTraffic",tooltipText:this.i18nService.getString("DvsUi","sessionDvPortSourceList.both"),onClick:function(){t.onTrafficDirectionChange(e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH)}})),r},i.prototype.onDataRetrieved=function(t){var i=this,r=[],n=[];this.datagridOptions.data.forEach(function(e){n.push(e),r.push(e.portId)}),t.items.forEach(function(t){r.indexOf(t.portId)<0?(t.trafficDirection=e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH,n.push(t),i.model.ports.push(new e.PortData(t.portId,t.trafficDirection))):n.forEach(function(e){e.portId===t.portId&&(e.host=t.host,e.connectee=t.connectee,e.connecteeType=t.connecteeType)})}),this.datagridOptions.data=n,this.model.cachedData=n,this.loading=!1},i.prototype.onSelectionChange=function(e){if(this._ignoreNextItemSelection)return void(this._ignoreNextItemSelection=!1);var t=e&&e.length>0;t?this._selectedPortsIds=_.map(e,function(e){return e.portId}):this._selectedPortsIds=[];for(var r=0,n=this.datagridOptions.actionBarOptions.actions;r<n.length;r++){var o=n[r];o.id!==i.REMOVE_ACTION&&o.id!==i.BOTH_ACTION&&o.id!==i.EGRESS_ACTION&&o.id!==i.INGRESS_ACTION||(o.enabled=t)}},i.prototype.onTrafficDirectionChange=function(e){this._ignoreNextItemSelection=!0;var t=_.map(this.datagridOptions.selectedItems,function(e){return e.portId});this.model.ports.forEach(function(i){t.indexOf(i.id)>-1&&(i.trafficDirection=e)}),this.datagridOptions.data.forEach(function(i){t.indexOf(i.portId)>-1&&(i.trafficDirection=e)}),this.datagridOptions.data=this.datagridOptions.data.slice(),this.model.cachedData=this.datagridOptions.data},i.$inject=["i18nService","vuiConstants","dataService","dvsSpanSessionPortBrowserDialogService","dvsSpanSessionPortsListService"],i.ADD_ACTION="add-ports",i.REMOVE_ACTION="remove-ports",i.INGRESS_ACTION="set-ingress",i.EGRESS_ACTION="set-egress",i.BOTH_ACTION="set-both",i}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSpanSessionPortsList",new i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<",validator:"<",sessionType:"<",editMode:"<",loading:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/common/components/dvsSpanSessionPropertiesPageComponentTemplate.html"}return e}();e.DvsSpanSessionPropertiesPageComponent=t;var i=function(){function t(e,t,i){this.i18nService=e,this.vxValidatorFactory=t,this.propertiesValidator=i,this.getString=function(t){return e.getString("DvsUi",t)}}return t.prototype.$onInit=function(){this.validator.vxValidator=this.vxValidatorFactory.create(),this.initDropdownOptions(),this.initValidationFunctions()},t.prototype.$onDestroy=function(){delete this.validator.vxValidator},Object.defineProperty(t.prototype,"sessionTypeLabel",{get:function(){switch(this.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:return this.getString("span.session.type.encapsulatedRemoteMirrorSource");case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:return this.getString("span.session.type.remoteMirrorSource");case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:return this.getString("span.session.type.dvPortMirror");case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:return this.getString("span.session.type.remoteMirrorDest");default:return this.getString("AddSpanSessionWizard.noData")}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sessionIdEnabled",{get:function(){return this.pageModel.encapsulationType!==e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encapsulationTypeEnabled",{get:function(){return!this.editMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sessionIdAvailable",{get:function(){return!this.editMode||this.pageModel.encapsulationType!==e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"encapsulationOptionsAvailable",{get:function(){return this.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE&&this.pageModel.erspanSupported},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vlanOptionsAvailable",{get:function(){return this.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"normalIoOptionsAvailable",{get:function(){return this.sessionType!==e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE},enumerable:!0,configurable:!0}),t.prototype.initDropdownOptions=function(){this.sessionStatusOptions=[{value:!1,label:this.getString("AddSpanSessionWizard.propertiesPage.status.disabled")},{value:!0,label:this.getString("AddSpanSessionWizard.propertiesPage.status.enabled")}],this.encapsulationTypeOptions=[{value:e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE,label:this.getString("SpanSessionEncapsulation.type.gre")},{value:e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.ERSPAN2,label:this.getString("SpanSessionEncapsulation.type.erspan2")},{value:e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.ERSPAN3,label:this.getString("SpanSessionEncapsulation.type.erspan3")}],this.isTcpIpStackInVspanSessionSupported=this.pageModel.isTcpIpStackSupported&&this.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE,this.isTcpIpStackInVspanSessionSupported&&(this.tcpIpNetStackOptions=[{value:e.DvsSpanSessionConstants.TCP_IP_STACK.DEFAULT_STACK,label:this.getString("spanSession.tcpip.stack.default")},{value:e.DvsSpanSessionConstants.TCP_IP_STACK.MIRROR_STACK,label:this.getString("spanSession.tcpip.stack.mirror")}]),this.normalTrafficAllowedOptions=[{value:!1,label:this.getString("AddSpanSessionWizard.propertiesPage.normalTrafficAllowed.off")
},{value:!0,label:this.getString("AddSpanSessionWizard.propertiesPage.normalTrafficAllowed.on")}]},t.prototype.initValidationFunctions=function(){this.validationFunctions={},this.validationFunctions.sessionName=this.getSessionNameValidationFunction(),this.validationFunctions.sessionId=this.getSessionIdValidationFunction(),this.validationFunctions.mirroredPacketLength=this.getPacketLengthValidationFunction(),this.validationFunctions.samplingRate=this.getSamplingRateValidationFunction(),this.validationFunctions.encapsulationVlanId=this.getEncapsulationVlanIdValidationFunction()},t.prototype.getSessionNameValidationFunction=function(){var e=this;return function(){var t=e.propertiesValidator.getNameError(e.pageModel.sessionName);return t?[t]:[]}},t.prototype.getSessionIdValidationFunction=function(){var t=this;return function(){if(t.pageModel.encapsulationType===e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE)return[];var i=t.propertiesValidator.getSessionIdError(t.pageModel.sessionId);return i?[i]:[]}},t.prototype.getPacketLengthValidationFunction=function(){var e=this;return function(){if(!e.pageModel.mirroredPacketLengthEnabled)return[];var t=e.propertiesValidator.getPacketLengthError(e.pageModel.mirroredPacketLength);return t?[t]:[]}},t.prototype.getSamplingRateValidationFunction=function(){var e=this;return function(){var t=e.propertiesValidator.getSamplingRateError(e.pageModel.samplingRate);return t?[t]:[]}},t.prototype.getEncapsulationVlanIdValidationFunction=function(){var e=this;return function(){var t=e.propertiesValidator.getEncapsulationVlanIdError(e.pageModel.encapsulationVlanId);return t?[t]:[]}},t.$inject=["i18nService","vxValidatorFactory","dvsSpanSessionPropertiesValidator"],t}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSpanSessionPropertiesPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",dvsUrn:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/common/components/dvsSpanSessionSelectDestinationUplinksPageComponentTemplate.html"}return e}();e.DvsSpanSessionSelectDestinationUplinksPageComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.dvsSpanSessionDestinationUplinksService=i,this.$scope=r,r.i18n=this.i18nService.getString,this._loaded=!1}return e.prototype.$onInit=function(){this.existingUplinksDatagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.getColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.NONE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,data:[],selectedItems:[],resizable:!0,onChange:this.onPrimaryGridSelectionChange.bind(this)},this.selectedUplinksDatagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.getSelectedUplinksColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.NONE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,data:[],selectedItems:[],resizable:!0,onChange:this.onSecondaryGridSelectionChange.bind(this)},this.getDestinationUplinkNames(this.dvsUrn)},e.prototype.getDestinationUplinkNames=function(e){var t=this,i=!this.model.notSelectedUplinks||0===this.model.notSelectedUplinks.length,r=!this.model.uplinks||0===this.model.uplinks.length;if(i&&r){var n=this.dvsSpanSessionDestinationUplinksService.getDestinationUplinkNames(e);this.uplinksPromise=n,n.then(function(e){t.uplinksPromise===n&&(t.existingUplinksDatagridOptions.data=e?e:[],t._loaded=!0,t.isAddAllBtnEnabled=t.existingUplinksDatagridOptions.data.length>0,t.isRemoveAllBtnEnabled=t.selectedUplinksDatagridOptions.data.length>0)})}else this.fillDataForDataGrid(this.model.notSelectedUplinks,this.existingUplinksDatagridOptions),this.fillDataForDataGrid(this.model.uplinks,this.selectedUplinksDatagridOptions),this.isAddAllBtnEnabled=this.existingUplinksDatagridOptions.data.length>0,this.isRemoveAllBtnEnabled=this.selectedUplinksDatagridOptions.data.length>0},e.prototype.fillDataForDataGrid=function(e,t){for(var i=[],r=0;r<e.length;r++){var n={uplinkName:e[r]};i.push(n)}t.data=i},e.prototype.getColumnDefinitions=function(){return[{displayName:this.$scope.i18n("DvsUi","AddSpanSessionWizard.destinationsPage.UplinksLists.existingUplinksTitle"),width:"150px",field:"uplinkName",sortable:!0,type:"string"}]},e.prototype.getSelectedUplinksColumnDefinitions=function(){return[{displayName:this.$scope.i18n("DvsUi","AddSpanSessionWizard.destinationsPage.UplinksLists.selectedUplinksTitle"),width:"150px",field:"uplinkName",sortable:!0,type:"string"}]},e.prototype.onPrimaryGridSelectionChange=function(e){this.isAddBtnEnabled=e&&e.length>0},e.prototype.onSecondaryGridSelectionChange=function(e){this.isRemoveBtnEnabled=e&&e.length>0},e.prototype.onAddBtnClicked=function(){if(this.existingUplinksDatagridOptions.selectedItems&&this.existingUplinksDatagridOptions.selectedItems.length>0){var e=this.selectedUplinksDatagridOptions.data.slice(),t=this.existingUplinksDatagridOptions.data.slice();this.existingUplinksDatagridOptions.selectedItems.forEach(function(i){var r={uplinkName:i.uplinkName},n=_.where(t,r);t=_.without(t,n[0]),e.push(r)}),this.selectedUplinksDatagridOptions.data=e,this.existingUplinksDatagridOptions.data=t,this.isAddAllBtnEnabled=this.existingUplinksDatagridOptions.data.length>0,this.isRemoveAllBtnEnabled=this.selectedUplinksDatagridOptions.data.length>0,this.existingUplinksDatagridOptions.selectedItems=[],this.syncListModel()}},e.prototype.onAddAllBtnClicked=function(){if(this.existingUplinksDatagridOptions.data&&this.existingUplinksDatagridOptions.data.length>0){var e=this.selectedUplinksDatagridOptions.data.slice();this.existingUplinksDatagridOptions.data.length?this.selectedUplinksDatagridOptions.data=_.union(e,this.existingUplinksDatagridOptions.data):this.selectedUplinksDatagridOptions.data=this.existingUplinksDatagridOptions.data,this.existingUplinksDatagridOptions.data=[],this.isRemoveAllBtnEnabled=!0,this.isAddAllBtnEnabled=!1,this.syncListModel()}},e.prototype.onRemoveBtnClicked=function(){if(this.selectedUplinksDatagridOptions.selectedItems&&this.selectedUplinksDatagridOptions.selectedItems.length>0){var e=this.existingUplinksDatagridOptions.data.slice(),t=this.selectedUplinksDatagridOptions.data.slice();this.selectedUplinksDatagridOptions.selectedItems.forEach(function(i){var r={uplinkName:i.uplinkName},n=_.where(t,r);t=_.without(t,n[0]),e.push(r)}),this.selectedUplinksDatagridOptions.data=t,this.existingUplinksDatagridOptions.data=e,this.selectedUplinksDatagridOptions.selectedItems=[],this.isRemoveAllBtnEnabled=this.selectedUplinksDatagridOptions.data.length>0,this.isAddAllBtnEnabled=this.existingUplinksDatagridOptions.data.length>0,this.syncListModel()}},e.prototype.onRemoveAllBtnClicked=function(){if(this.selectedUplinksDatagridOptions.data&&this.selectedUplinksDatagridOptions.data.length>0){var e=this.existingUplinksDatagridOptions.data.slice();this.existingUplinksDatagridOptions.data.length?this.existingUplinksDatagridOptions.data=_.union(e,this.selectedUplinksDatagridOptions.data):this.existingUplinksDatagridOptions.data=this.selectedUplinksDatagridOptions.data,this.selectedUplinksDatagridOptions.data=[],this.isRemoveAllBtnEnabled=!1,this.isAddAllBtnEnabled=!0,this.syncListModel()}},e.prototype.syncListModel=function(){var e=this;this.model.uplinks=[],this.model.notSelectedUplinks=[],this.selectedUplinksDatagridOptions.data.forEach(function(t){e.model.uplinks.push(t.uplinkName)}),this.existingUplinksDatagridOptions.data.forEach(function(t){e.model.notSelectedUplinks.push(t.uplinkName)})},e.$inject=["i18nService","vuiConstants","dvsSpanSessionDestinationUplinksService","$scope"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSpanSessionSelectDestinationUplinksPageComponent",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.DV_PORT_MIRROR="dvPortMirror",this.REMOTE_MIRROR_DEST="remoteMirrorDest",this.REMOTE_MIRROR_SOURCE="remoteMirrorSource",this.L3_SOURCE="encapsulatedRemoteMirrorSource"}return e}(),i=function(){function e(){this.GRE="gre",this.ERSPAN2="erspan2",this.ERSPAN3="erspan3"}return e}(),r=function(){function e(){this.INGRESS="ingress",this.EGRESS="egress",this.BOTH="both"}return e}(),n=function(){function e(){this.DEFAULT_STACK="defaultTcpipStack",this.MIRROR_STACK="mirror"}return e}(),o=function(){function e(){}return e.PAGE_ID={SELECT_SESSION_TYPE:"selectSessionTypePage",EDIT_PROPERIES:"editPropertiesPage",SELECT_SOURCE_PORTS:"selectSourcePortsPage",SELECT_SOURCE_VLANS:"selectSourceVlansPage",SELECT_DESTINATION_PORTS:"selectDestinationPortsPage",SELECT_DESTINATION_ADDRESSES:"selectDestinationAddressesPage",SELECT_DESTINATION_UPLINKS:"selectDestinationUplinksPage",READY_TO_COMPLETE:"readyToCompletePage"},e.SESSION_TYPE=new t,e.ENCAPSULATION_TYPE=new i,e.TRAFFIC_DIRECTION=new r,e.TCP_IP_STACK=new n,e.VLAN_ID_MIN=1,e.VLAN_ID_MAX=4094,e}();e.DvsSpanSessionConstants=o}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.uplinks=[],this.notSelectedUplinks=[]}return e}();e.DvsSpanSessionDestinationUplinksModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.values=[]}return e}();e.DvsSpanSessionEditableListModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.ports=[]}return e}();e.DvsSpanSessionPortsListModel=t;var i=function(){function e(e,t){this.id=e,this.trafficDirection=t}return e}();e.PortData=i}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvsSpanSessionPropertiesPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.ipAddressesListModel=new e.DvsSpanSessionEditableListModel,this.portsListModel=new e.DvsSpanSessionPortsListModel,this.uplinksListModel=new e.DvsSpanSessionDestinationUplinksModel}return t}();e.DvsSpanSessionSelectDestinationsPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.portsListModel=new e.DvsSpanSessionPortsListModel,this.vlanIdListModel=new e.DvsSpanSessionEditableListModel}return t}();e.DvsSpanSessionSelectSourcesPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$q=e,this.i18nService=t,this.vuiConstants=i,this.dataService=r,this.getString=function(e){return n.i18nService.getString("DvsUi",e)}}return e.prototype.getDestinationUplinkNames=function(t){return this.dataService.getProperties(t,[e.DATA_PROPERTY]).then(function(t){return t[e.DATA_PROPERTY]})},e.$inject=["$q","i18nService","vuiConstants","dataService"],e.DATA_PROPERTY="dvswitchportmirroring:dvsuplinks",e}();e.DvsSpanSessionDestinationUplinksService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionDestinationUplinksService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.clarityModalService=i,this.mutationService=r}return e.prototype.show=function(e,t,r){var n=new i(e,t),o={title:this.i18nService.getString("DvsUi","PortBrowserDialog.title"),defaultButton:"submit",size:"lg",alerts:[],dialogData:n,contentTemplate:"dvs-ui/resources/dvs/portmirroring/common/components/dvsSpanSessionPortBrowserDialog.html",onSubmit:function(){return r(n.portIds),!0},onSelectionChange:function(e){n.portIds=e}};this.clarityModalService.openOkCancelModal(o)},e.$inject=["$q","i18nService","clarityModalService","mutationService"],e}();e.DvsSpanSessionPortBrowserDialogService=t;var i=function(){function e(e,t){this.dvsUrn=e,this.portsToIgnore=t,this.portIds=[]}return e}();angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionPortBrowserDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$q=e,this.i18nService=t,this.vuiConstants=i,this.dataService=r,this.getString=function(e){return n.i18nService.getString("DvsUi",e)}}return e.prototype.createDatagridOptions=function(e){var t={height:"300",pageConfig:{hidePager:!0},columnDefs:this.getColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.NONE,data:[],resizable:!0,actionBarOptions:{actions:[]},selectedPorts:{}},i=this.getOnSelectionChangeCallback(e,t);return t.onSelectionChange=i,t.onMasterCheckboxClick=function(e){for(var r=e.currentTarget.checked,n=0,o=t.data;n<o.length;n++){var a=o[n];t.selectedPorts[a.portId]=r}i()},t},e.prototype.getData=function(t){return this.dataService.getProperties(t,[e.DATA_PROPERTY]).then(function(t){var i=t[e.DATA_PROPERTY];return i?i.ports:[]})["catch"](function(){return[]})},e.prototype.getColumnDefinitions=function(){var e=[];return e.push({width:"35px",headerTemplate:"<input type='checkbox' ng-click='datagridOptions.onMasterCheckboxClick($event)'/>",template:function(e){var t="'datagridOptions.selectedPorts[\""+e.portId+"\"]'";return"<input type='checkbox' %model %change/>".replace("%model","ng-model="+t).replace("%change","ng-change='datagridOptions.onSelectionChange()'")}}),e.push({displayName:this.getString("PortBrowser.columnHeader.portId"),field:"portId",width:"90px",template:this.getGenericColumnRenderer("portId")}),e.push({displayName:this.getString("PortBrowser.columnHeader.name"),field:"name",width:"150px",template:this.getGenericColumnRenderer("name")}),e.push({displayName:this.getString("PortBrowser.columnHeader.connectedEntityName"),field:"connectedEntity",width:"150px",template:this.getConnectedEntityColumnRenderer()}),e.push({displayName:this.getString("PortBrowser.columnHeader.proxyHostName"),field:"host",width:"150px",template:this.getHostColumnRenderer()}),e.push({displayName:this.getString("PortBrowser.columnHeader.macAddress"),field:"mac",width:"150px",template:this.getGenericColumnRenderer("mac")}),e.push({displayName:this.getString("PortBrowser.columnHeader.portgroupName"),field:"portgroup",width:"150px",template:this.getPortgroupColumnRenderer()}),e.push({displayName:this.getString("PortBrowser.columnHeader.portState"),field:"state",width:"150px",template:this.getPortStateColumnRenderer()}),e.push({displayName:this.getString("PortBrowser.columnHeader.vlanIds"),field:"vlan",width:"150px",template:this.getGenericColumnRenderer("vlan")}),e},e.prototype.getOnSelectionChangeCallback=function(e,t){return function(){var i=[];t.data.forEach(function(e){t.selectedPorts[e.portId]&&i.push(e.portId)}),e(i)}},e.prototype.getGenericColumnRenderer=function(t){var i=this;return function(r){var n=r[t]||e.NO_DATA;return i.buildCellHtml(n)}},e.prototype.getConnectedEntityColumnRenderer=function(){var e=this;return function(t){return"vmVnic"===t.connectedEntityType?e.buildCellHtml(t.connectedEntity,"vsphere-icon-vm"):"hostVmkVnic"===t.connectedEntityType?e.buildCellHtml(t.connectedEntity,"network-lib-ui-icon-virtualAdapter"):e.buildCellHtml(t.connectedEntity)}},e.prototype.getPortStateColumnRenderer=function(){var t=this;return function(i){var r,n;switch(i.state){case"LINK_UP":r=t.getString("PortState.linkUp"),n="network-lib-ui-icon-dvsPortConnectedLf";break;case"LINK_DOWN":r=t.getString("PortState.linkDown"),n="network-lib-ui-icon-dvsPortNotconnectedLf";break;case"BLOCKED":r=t.getString("PortState.blocked"),n="network-lib-ui-icon-dvsPortBlockedLf";break;default:r=e.NO_DATA,n=""}return t.buildCellHtml(r,n)}},e.prototype.getHostColumnRenderer=function(){var e=this;return function(t){var i=t.host?"vsphere-icon-host":"";return e.buildCellHtml(t.host,i)}},e.prototype.getPortgroupColumnRenderer=function(){var t=this;return function(i){var r=i.portgroup?"vsphere-icon-virtual-port-group":"";return t.buildCellHtml(i.portgroup||e.NO_DATA,r)}},e.prototype.buildCellHtml=function(e,t){void 0===t&&(t="");var i="<div>%icon%text</div>";return i.replace("%icon","<span class='"+t+"'></span>").replace("%text","<span>"+e+"</span>")},e.$inject=["$q","i18nService","vuiConstants","dataService"],e.DATA_PROPERTY="dvswitchportmirroring:portBrowserData",e.NO_DATA="--",e}();e.DvsSpanSessionPortBrowserService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionPortBrowserService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.portlist.DvsSpanSessionPortListData,i=com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.portlist.DvsSpanSessionPortListSpec,r=function(){function r(e,t,i,r){var n=this;this.$q=e,this.i18nService=t,this.vuiConstants=i,this.dataService=r,this.getString=function(e){return n.i18nService.getString("DvsUi",e)}}return r.prototype.createDatagridOptions=function(e,t,i){return{height:"100%",pageConfig:{hidePager:!0},columnDefs:this.getColumnDefinitions(i),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],data:[],resizable:!0,actionBarOptions:{actions:e},onChange:t}},r.prototype.getData=function(e,n){var o=new i;o.portIds=n;var a={propertyParams:[{propertyName:r.DATA_PROPERTY,parameterType:o._type,parameter:o}]};if(n&&n.length>0)return this.dataService.getProperties(e,[r.DATA_PROPERTY],a).then(function(e){var t=e[r.DATA_PROPERTY];return t});var s=new t;return s.items=[],this.$q.when(s)},r.prototype.getColumnDefinitions=function(e){var t=[];return t.push({displayName:this.getString("AddSpanSessionWizard.sourcesPage.PortList.port"),field:"portId",width:"90px",template:this.getGenericColumnRenderer("portId")}),t.push({displayName:this.getString("AddSpanSessionWizard.sourcesPage.PortList.host"),field:"host",width:"150px",template:this.getHostColumnRenderer()}),t.push({displayName:this.getString("AddSpanSessionWizard.sourcesPage.PortList.connectee"),field:"connectee",width:"150px",template:this.getConnectedEntityColumnRenderer()}),e&&t.push({displayName:this.getString("AddSpanSessionWizard.sourcesPage.PortList.direction"),field:"trafficDirection",width:"180px",template:this.getTrafficDirectionColumnRenderer()}),t},r.prototype.getGenericColumnRenderer=function(e){var t=this;return function(i){return t.buildCellHtml(i[e])}},r.prototype.getConnectedEntityColumnRenderer=function(){var e=this;return function(t){return"vmVnic"===t.connecteeType?e.buildCellHtml(t.connectee,"vsphere-icon-vm"):"hostVmkVnic"===t.connecteeType?e.buildCellHtml(t.connectee,"network-lib-ui-icon-virtualAdapter"):e.buildCellHtml(t.connectee)}},r.prototype.getHostColumnRenderer=function(){var e=this;return function(t){var i=t.host?"vsphere-icon-host":"";return e.buildCellHtml(t.host,i)}},r.prototype.getTrafficDirectionColumnRenderer=function(){var t=this;return function(i){var r,n;switch(i.trafficDirection){case e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH:r=t.getString("NetworkTrafficRuleDirection.ingressEgress"),n="network-lib-ui-icon-ingressEgressTraffic";break;case e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS:r=t.getString("NetworkTrafficRuleDirection.ingress"),n="network-lib-ui-icon-ingressTraffic";break;case e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS:r=t.getString("NetworkTrafficRuleDirection.egress"),n="network-lib-ui-icon-egressTraffic";break;default:r="",n=""}return t.buildCellHtml(r,n)}},r.prototype.buildCellHtml=function(t,i){void 0===t&&(t=e.DvsSpanSessionPortBrowserService.NO_DATA),void 0===i&&(i="");var r="<div>%icon%text</div>";return r.replace("%icon","<span class='"+i+"'></span>").replace("%text","<span>"+t+"</span>")},r.$inject=["$q","i18nService","vuiConstants","dataService"],r.DATA_PROPERTY="dvswitchportmirroring:portListData",r}();e.DvsSpanSessionPortsListService=r,angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionPortsListService",r)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){var i=this;this.i18nService=e,this.vxPropertyViewService=t,this.getString=function(e){return i.i18nService.getString("DvsUi",e)}}return t.prototype.buildPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder();return this.buildCommonPropertiesSection(t,e),this.buildAdvancedPropertiesSection(t,e),t.build()},t.prototype.buildCommonPropertiesSection=function(t,i){var r=t.category("main"),n=r.section("commonSection");n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.name"),i.propertiesPageModel.sessionName);var o=i.propertiesPageModel.enabled?this.getString("AddSpanSessionWizard.readyToCompletePage.enabled"):this.getString("AddSpanSessionWizard.readyToCompletePage.disabled");switch(n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.status"),o),n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.type"),this.getSessionTypeLocalized(i.sessionType)),i.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:this.buildL3SourceCommonPropertiesSection(n,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:this.buildRemoteSourceCommonPropertiesSection(n,i)}},t.prototype.buildL3SourceCommonPropertiesSection=function(t,i){t.property(this.getString("AddSpanSessionWizard.readyToCompletePage.encapsulation.type"),this.getEncapsulationTypeLocalized(i.propertiesPageModel.encapsulationType)),i.propertiesPageModel.encapsulationType!==e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.ERSPAN2&&i.propertiesPageModel.encapsulationType!==e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.ERSPAN3||t.property(this.getString("AddSpanSessionWizard.readyToCompletePage.encapsulation.sessionId"),i.propertiesPageModel.sessionId)},t.prototype.buildRemoteSourceCommonPropertiesSection=function(e,t){e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.encapsulationVlanId"),t.propertiesPageModel.encapsulationVlanId),e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.preserveOriginalVlan"),this.getPreserveOriginalVlanLocalized(t.propertiesPageModel.preserveOriginalVlan))},t.prototype.buildAdvancedPropertiesSection=function(t,i){var r=t.getCategory("main"),n=r.section("advancedSection").title(this.getString("AddSpanSessionWizard.readyToCompletePage.advancedProperties"));switch(i.sessionType!==e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE&&n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.normalTrafficAllowed"),this.getNormalTrafficAllowedLocalized(i.propertiesPageModel.normalTrafficAllowed)),i.propertiesPageModel.tcpIpStack&&i.propertiesPageModel.isTcpIpStackSupported&&i.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE&&n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.encapsulation.tcpipStack"),this.getTcpIpStackLocalized(i.propertiesPageModel.tcpIpStack)),i.propertiesPageModel.mirroredPacketLengthEnabled&&n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.mirroredPacketLength"),this.i18nService.getString("DvsUi","AddSpanSessionWizard.readyToCompletePage.mirroredPacketLengthSummary",i.propertiesPageModel.mirroredPacketLength)),n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.samplingRate"),this.i18nService.getString("DvsUi","AddSpanSessionWizard.readyToCompletePage.samplingRateSummary",i.propertiesPageModel.samplingRate)),i.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:this.buildL3SourceAdvancedPropertiesSection(n,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:this.buildRemoteSourceAdvancedPropertiesSection(n,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:this.buildDvPortMirroradvancedPropertiesSection(n,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:this.buildRemoteMirroringDestAdvancedPropertiesSection(n,i)}n.property(this.getString("AddSpanSessionWizard.readyToCompletePage.sessionDescription"),i.propertiesPageModel.description||this.getString("AddSpanSessionWizard.readyToCompletePage.noData"))},t.prototype.buildL3SourceAdvancedPropertiesSection=function(e,t){var i=t.selectSourcesPageModel.portsListModel.ports&&t.selectSourcesPageModel.portsListModel.ports.length||0;e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.numSourcePorts"),i),e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.destinationIpAddresses"),t.selectDestinationsPageModel.ipAddressesListModel.values)},t.prototype.buildRemoteSourceAdvancedPropertiesSection=function(e,t){var i=t.selectSourcesPageModel.portsListModel.ports&&t.selectSourcesPageModel.portsListModel.ports.length||0;e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.numSourcePorts"),i);var r=t.selectDestinationsPageModel.uplinksListModel.uplinks,n=r&&r.length>0?r.join(", "):"";e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.destinationUplinks"),n)},t.prototype.buildDvPortMirroradvancedPropertiesSection=function(e,t){var i=t.selectSourcesPageModel.portsListModel.ports&&t.selectSourcesPageModel.portsListModel.ports.length||0;e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.numSourcePorts"),i);var r=t.selectDestinationsPageModel.portsListModel.ports&&t.selectDestinationsPageModel.portsListModel.ports.length||0;e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.numDestinationPorts"),r)},t.prototype.buildRemoteMirroringDestAdvancedPropertiesSection=function(e,t){var i=t.selectSourcesPageModel.vlanIdListModel.values&&t.selectSourcesPageModel.vlanIdListModel.values.length||0;e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.numVlanIds"),i);var r=t.selectDestinationsPageModel.portsListModel.ports&&t.selectDestinationsPageModel.portsListModel.ports.length||0;e.property(this.getString("AddSpanSessionWizard.readyToCompletePage.numDestinationPorts"),r)},t.prototype.getSessionTypeLocalized=function(t){switch(t){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:return this.getString("span.session.type.encapsulatedRemoteMirrorSource");case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:return this.getString("span.session.type.remoteMirrorSource");case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:return this.getString("dvsPortMirror.sessionType.remoteMirrorDest");case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:return this.getString("span.session.type.dvPortMirror");default:return this.getString("AddSpanSessionWizard.readyToCompletePage.noData")}},t.prototype.getEncapsulationTypeLocalized=function(t){switch(t){case e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE:return this.getString("SpanSessionEncapsulation.type.gre");case e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.ERSPAN2:return this.getString("SpanSessionEncapsulation.type.erspan2");case e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.ERSPAN3:return this.getString("SpanSessionEncapsulation.type.erspan3");default:return this.getString("AddSpanSessionWizard.readyToCompletePage.noData")}},t.prototype.getTcpIpStackLocalized=function(t){switch(t){case e.DvsSpanSessionConstants.TCP_IP_STACK.DEFAULT_STACK:return this.getString("spanSession.tcpip.stack.default");case e.DvsSpanSessionConstants.TCP_IP_STACK.MIRROR_STACK:return this.getString("spanSession.tcpip.stack.mirror");default:return this.getString("spanSession.tcpip.stack.default")}},t.prototype.getPreserveOriginalVlanLocalized=function(e){return e?this.getString("AddSpanSessionWizard.readyToCompletePage.yes"):this.getString("AddSpanSessionWizard.readyToCompletePage.no")},t.prototype.getNormalTrafficAllowedLocalized=function(e){return e?this.getString("AddSpanSessionWizard.readyToCompletePage.on"):this.getString("AddSpanSessionWizard.readyToCompletePage.off")},t.$inject=["i18nService","vxPropertyViewService"],t}();e.DvsSpanSessionReadyToCompletePageService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionReadyToCompletePageService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.ipParserService=t,this.networkUtil=i}return t.prototype.getIpAddressError=function(e){var t=e.trim(),i=!t.length,r=!this.ipParserService.isIpv4AddressValid(t)&&!this.ipParserService.isIpv6AddressValid(t);return i||r?this.i18nService.getString("DvsUi","SpanSession.error.ipAddress"):null},t.prototype.getVlanIdError=function(t){var i=this.networkUtil.isPositiveInteger(t,e.DvsSpanSessionConstants.VLAN_ID_MIN,e.DvsSpanSessionConstants.VLAN_ID_MAX);return i?null:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sourceVlansPage.invalidVlanIdError",e.DvsSpanSessionConstants.VLAN_ID_MIN,e.DvsSpanSessionConstants.VLAN_ID_MAX)},t.$inject=["i18nService","ipParserService","networkUtil"],t}();e.DvsSpanSessionEditableListValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionEditableListValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this._model=e,this.vxValidator=t}return Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),e.prototype.validate=function(){if(this.vxValidator&&this.vxValidator.validate){var e=this.vxValidator.validate();return this._model&&(this._model.errors=e),e&&0===e.length}return!0},e}();e.DvsSpanSessionPageValidator=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.wizard.DvsSpanSessionNameSpec,i=function(){function e(e,t){this._beginning=Math.floor(e),this._end=Math.floor(t)}return Object.defineProperty(e.prototype,"beginning",{get:function(){return this._beginning},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!0,configurable:!0}),e}(),r=function(){function e(e,t){this.i18nService=e,this.mutationService=t}return e.prototype.getNameError=function(t){var i=t?t.trim():"",r=i.replace(/%/g,"%25").replace(/\//g,"%2f").replace(/\\/g,"%5c");return 0===r.length?this.i18nService.getString("DvsUi","SpanSession.error.blankName"):r.length>e.NAME_MAX_LENGTH?this.i18nService.getString("DvsUi","SpanSession.error.tooLongName"):null},e.prototype.getNameServerError=function(e,i){var r=this,n=new t;return n.name=i,this.mutationService.validate(e,n._type,n).then(function(e){return e.result?e.result:null},function(){return r.i18nService.getString("DvsUi","networkConnectionError")})},e.prototype.getSessionIdError=function(t){return this.isInteger(t)&&this.isWithinInterval(t,e.SESSION_ID_INTERVAL)?null:this.i18nService.getString("DvsUi","SpanSession.error.sessionId")},e.prototype.getPacketLengthError=function(t){return this.isInteger(t)&&this.isWithinInterval(t,e.PACKET_LENGTH_INTERVAL)?null:this.i18nService.getString("DvsUi","SpanSession.error.packetLength")},e.prototype.getSamplingRateError=function(t){return this.isInteger(t)&&this.isWithinInterval(t,e.SAMPLING_RATE_INTERVAL)?null:this.i18nService.getString("DvsUi","SpanSession.error.samplingRate")},e.prototype.getEncapsulationVlanIdError=function(t){return this.isInteger(t)&&this.isWithinInterval(t,e.ENCAPSULATION_VLAN_INTERVAL)?null:this.i18nService.getString("DvsUi","SpanSession.error.encapsulationVlan")},e.prototype.getDescriptionError=function(t){return t&&t.length>e.DESCRIPTION_MAX_LENGHT?this.i18nService.getString("DvsUi","SpanSession.error.description"):null},e.prototype.isWithinInterval=function(e,t){return e>=t.beginning&&e<=t.end},e.prototype.isInteger=function(e){return e%1===0},e.$inject=["i18nService","mutationService"],e.NAME_MAX_LENGTH=80,e.SESSION_ID_INTERVAL=new i(0,1023),e.PACKET_LENGTH_INTERVAL=new i(60,9e3),e.SAMPLING_RATE_INTERVAL=new i(1,65535),e.ENCAPSULATION_VLAN_INTERVAL=new i(1,4094),e.DESCRIPTION_MAX_LENGHT=255,e}();e.DvsSpanSessionPropertiesValidator=r,angular.module("com.vmware.vsphere.client.dvs").service("dvsSpanSessionPropertiesValidator",r)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/create/components/dvsAddSpanSessionSelectTypePageComponentTemplate.html"}return e}();e.DvsAddSpanSessionSelectTypePageComponent=t;
var i=function(){function t(e,t){this.i18nService=e,this.$scope=t,t.i18n=this.i18nService.getString}return t.prototype.$onInit=function(){this.initSessionNameByType(),this.initDescriptions(),this.buildSignpostItems()},t.prototype.initDescriptions=function(){this.descriptionsByType={},this.descriptionsByType[e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR]=this.i18nService.getString("DvsUi","span.session.type.dvPortMirrorDescription"),this.descriptionsByType[e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE]=this.i18nService.getString("DvsUi","span.session.type.remoteMirrorSourceDescription"),this.descriptionsByType[e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE]=this.i18nService.getString("DvsUi","span.session.type.encapsulatedRemoteMirrorSourceDescription"),this.descriptionsByType[e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST]=this.i18nService.getString("DvsUi","span.session.type.remoteMirrorDestDescription")},t.prototype.initSessionNameByType=function(){this.sessionNameByType={},this.sessionNameByType[e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR]=this.i18nService.getString("DvsUi","span.session.type.dvPortMirror"),this.sessionNameByType[e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE]=this.i18nService.getString("DvsUi","span.session.type.remoteMirrorSource"),this.sessionNameByType[e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE]=this.i18nService.getString("DvsUi","span.session.type.encapsulatedRemoteMirrorSource"),this.sessionNameByType[e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST]=this.i18nService.getString("DvsUi","span.session.type.remoteMirrorDest")},t.prototype.buildSignpostItems=function(){var e=this,t="";_.forEach(this.wizardModel.supportedSessionTypes,function(i){var r="<b>%title%</b><br/>".replace("%title%",e.getSessionName(i)),n=e.getSessionDescription(i),o="<div class='horizontal-flex-container'><span class='new-span-session-description-bullet'></span><span class='new-span-session-description-item'>%description%</span><br/></div>",a=r+o.replace("%description%",n),s="<div data-test-id='span-session-section-%sessionType%'>%content%</div>";t+=s.replace("%sessionType%",i).replace("%content%",a)}),this.signPostConfig={message:"<div class='new-span-session-signpost-content'>%content%</div>".replace("%content%",t)}},t.prototype.getSessionDescription=function(e){return this.descriptionsByType[e]},t.prototype.getSessionName=function(e){return this.sessionNameByType[e]},t.$inject=["i18nService","$scope"],t}();angular.module("com.vmware.vsphere.client.dvs").component("dvsAddSpanSessionSelectTypePage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/create/components/dvsSpanSessionReadyToCompletePageComponentTemplate.html"}return e}();e.DvsSpanSessionReadyToCompletePageComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.propertyViewService=t,this.getString=function(t){return e.getString("DvsUi",t)}}return e.prototype.$onInit=function(){this.propertyViewData=this.propertyViewService.buildPropertyViewData(this.model)},e.$inject=["i18nService","dvsSpanSessionReadyToCompletePageService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSpanSessionReadyToCompletePage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.pageStateManagementService=e,this.vuiConstants=t}return t.prototype.init=function(e){var t=this;this.pages=e.wizardConfig.pages,this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e),e.$watchGroup(["model.sessionType"],function(e){t.updatePagesVisibility.apply(t,e)})},t.prototype.updatePagesVisibility=function(t){var i=t===e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE||t===e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE||t===e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR;this.togglePageVisibility(e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_PORTS,i);var r=t===e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST;this.togglePageVisibility(e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_VLANS,r);var n=t===e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE;this.togglePageVisibility(e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_ADDRESSES,n);var o=t===e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR||t===e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST;this.togglePageVisibility(e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_PORTS,o);var a=t===e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE;this.togglePageVisibility(e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_UPLINKS,a)},t.prototype.togglePageVisibility=function(e,t){var i=_.findWhere(this.pages,{id:e});t?i.state===this.vuiConstants.wizard.pageState.SKIPPED&&(i.state=this.vuiConstants.wizard.pageState.DISABLED):i.state=this.vuiConstants.wizard.pageState.SKIPPED},t.$inject=["pageStateManagementService","vuiConstants"],t}();e.DvsAddSpanSessionWizardFlowManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddSpanSessionWizardFlowManager",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.simpleValidationCommit=t,this.propertiesValidator=i}return t.prototype.createPages=function(t){var i=[];return i.push({id:e.DvsSpanSessionConstants.PAGE_ID.SELECT_SESSION_TYPE,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sessionType.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sessionType.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionSelectTypePage.html",onCommit:this.simpleValidationCommit(function(){return[]},t.wizardConfig),validationParams:["model.sessionType"]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.EDIT_PROPERIES,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.propertiesPage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.propertiesPage.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionEditPropertiesPage.html",onCommit:this.simpleValidationCommit(this.buildPropertiesPageCommitCallback(t),t.wizardConfig),validationParams:["model.propertiesPageModel.sessionName","model.propertiesPageModel.sessionName","model.propertiesPageModel.enabled","model.propertiesPageModel.mirroredPacketLength","model.propertiesPageModel.mirroredPacketLengthEnabled","model.propertiesPageModel.samplingRate","model.propertiesPageModel.description","model.propertiesPageModel.erspanSupported","model.propertiesPageModel.encapsulationType","model.propertiesPageModel.sessionId","model.propertiesPageModel.preserveOriginalVlan","model.propertiesPageModel.encapsulationVlanId","model.propertiesPageModel.normalTrafficAllowed"]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_PORTS,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sourcesPage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sourcesPage.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionSelectSourcePortsPage.html",onCommit:this.simpleValidationCommit(function(){return[]},t.wizardConfig),validationParams:[]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_VLANS,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sourcesPage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.sourceVlansPage.descriptionLabel"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionSelectSourceVlansPage.html",onCommit:this.simpleValidationCommit(this.buildSourceVlansPageCommitCallback(t),t.wizardConfig),validationParams:["model.selectSourcesPageModel.vlanIdListModel.values"]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_ADDRESSES,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.destinationsPage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.destinationsPage.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionSelectDestinationAddressesPage.html",onCommit:this.simpleValidationCommit(this.buildDestinationsPageCommitCallback(t),t.wizardConfig),validationParams:["model.selectDestinationsPageModel.ipAddressesListModel.values"]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_PORTS,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.destinationsPage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.destinationsPage.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionSelectDestinationPortsPage.html",onCommit:this.simpleValidationCommit(this.buildDestinationsPageCommitCallback(t),t.wizardConfig),validationParams:[]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_UPLINKS,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.destinationsPage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.destinationsPage.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionSelectDestUplinkPage.html",onCommit:this.simpleValidationCommit(this.buildDestinationsPageCommitCallback(t),t.wizardConfig),validationParams:[]}),i.push({id:e.DvsSpanSessionConstants.PAGE_ID.READY_TO_COMPLETE,title:this.i18nService.getString("DvsUi","AddSpanSessionWizard.readyToCompletePage.title"),description:this.i18nService.getString("DvsUi","AddSpanSessionWizard.readyToCompletePage.description"),contentUrl:"dvs-ui/resources/dvs/portmirroring/create/views/dvsAddSpanSessionReadyToCompletePage.html",onCommit:this.simpleValidationCommit(function(){return[]},t.wizardConfig),validationParams:[]}),i},t.prototype.buildPropertiesPageCommitCallback=function(t){var i=this;return function(){t.model.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.EDIT_PROPERIES].validate();var r=t.model.propertiesPageModel,n=r.errors?r.errors.slice():[],o=i.propertiesValidator.getDescriptionError(t.model.propertiesPageModel.description);return o&&n.push(o),n.length>0?n:(t.busy=!0,i.propertiesValidator.getNameServerError(t.model.dvsUrn,t.model.propertiesPageModel.sessionName).then(function(e){return t.busy=!1,e?[e]:[]}))}},t.prototype.buildDestinationsPageCommitCallback=function(t){var i=this;return function(){var r=t.model.selectDestinationsPageModel;if(t.model.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE)return t.model.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_ADDRESSES].validate(),r.ipAddressesListModel.errors?r.ipAddressesListModel.errors.slice():[];if(t.model.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR){var n=t.model.selectSourcesPageModel.portsListModel.ports,o=r.portsListModel.ports.filter(function(e){return n.some(function(t){return t.id===e.id})}).map(function(e){return e.id})||[];return o.length?1===o.length?[i.i18nService.getString("DvsUi","SpanSession.error.alreadyUsedSourcePort",o[0])]:[i.i18nService.getString("DvsUi","SpanSession.error.alreadyUsedSourcePorts",o.join(", "))]:[]}return[]}},t.prototype.buildSourceVlansPageCommitCallback=function(t){return function(){var i=t.model.selectSourcesPageModel;return t.model.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_VLANS].validate(),i.vlanIdListModel.errors?i.vlanIdListModel.errors.slice():[]}},t.$inject=["i18nService","simpleValidationCommit","dvsSpanSessionPropertiesValidator"],t}();e.DvsAddSpanSessionWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddSpanSessionWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l,d){this.$rootScope=e,this.i18nService=t,this.vxValidatorFactory=i,this.vuiWizardService=r,this.wizardValidationService=n,this.pageStateManagementService=o,this.mutationService=a,this.dataService=s,this.wizardPages=c,this.specFactory=l,this.flowManager=d}return t.prototype.show=function(t){var i=this.$rootScope.$new();i.busy=!1,i.model=new e.DvsAddSpanSessionWizardModel,i.model.dvsUrn=t,i.wizardConfig=this.createWizardConfig(i.model),i.wizardConfig.pages=this.wizardPages.createPages(i),i.wizardConfig.loading=!0,this.wizardValidationService.initWizardValidation(i),this.flowManager.init(i),this.vuiWizardService({scope:i,configObjectName:"wizardConfig"}).show(),this.requestData(i)},t.prototype.requestData=function(e){var i=this;this.dataService.getProperties(e.model.dvsUrn,[t.DATA_PROPERTY]).then(function(r){var n=r[t.DATA_PROPERTY];n&&(i.updateWizardModel(e,n),i.updatePageModels(e,n),i.initPageValidators(e.model),e.wizardConfig.title=i.i18nService.getString("DvsUi","AddSpanSessionWizard.titleFormat",n.dvsName),e.wizardConfig.loading=!1)})},t.prototype.createWizardConfig=function(t){var i=this,r=new e.WizardConfig;return r.title=this.i18nService.getString("DvsUi","AddSpanSessionWizard.initialTitle"),r.loadingMessage=this.i18nService.getString("CommonUi","wizard.loading"),r.cssClass="add-span-session",r.onFinish=function(){var e=i.specFactory.buildSpec(t);return i.mutationService.apply(t.dvsUrn,e._type,e),!0},r},t.prototype.updateWizardModel=function(t,i){t.model.sessionType=e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR,t.model.supportedSessionTypes=[],i.dvPortMirrorSupported&&t.model.supportedSessionTypes.push(e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR),i.remoteSourceSupported&&t.model.supportedSessionTypes.push(e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE),i.remoteDestSupported&&t.model.supportedSessionTypes.push(e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST),t.model.supportedSessionTypes.push(e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE)},t.prototype.updatePageModels=function(e,t){e.model.propertiesPageModel.sessionName=e.model.retrievedSessionName=t.sessionName,e.model.propertiesPageModel.erspanSupported=t.erspanSupported,e.model.propertiesPageModel.isTcpIpStackSupported=t.mirrorNetstackSupported},t.prototype.initPageValidators=function(t){t.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.EDIT_PROPERIES]=new e.DvsSpanSessionPageValidator(t.propertiesPageModel,this.vxValidatorFactory.create()),t.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_ADDRESSES]=new e.DvsSpanSessionPageValidator(t.selectDestinationsPageModel.ipAddressesListModel,this.vxValidatorFactory.create()),t.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_VLANS]=new e.DvsSpanSessionPageValidator(t.selectSourcesPageModel.vlanIdListModel,this.vxValidatorFactory.create())},t.$inject=["$rootScope","i18nService","vxValidatorFactory","vuiWizardService","wizardValidationService","pageStateManagementService","mutationService","dataService","dvsAddSpanSessionWizardPages","dvsAddSpanSessionWizardSpecFactory","dvsAddSpanSessionWizardFlowManager"],t.DATA_PROPERTY="dvswitchportmirroring:addSpanSessionWizardData",t}();e.DvsAddSpanSessionWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddSpanSessionWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.wizard.DvsAddSpanSessionSpec,i=function(){function i(){}return i.prototype.buildSpec=function(i){var r=new t;switch(r.sessionType=i.sessionType,r.sessionName=i.propertiesPageModel.sessionName,r.enabled=i.propertiesPageModel.enabled,r.mirroredPacketLength=i.propertiesPageModel.mirroredPacketLengthEnabled?i.propertiesPageModel.mirroredPacketLength:-1,r.samplingRate=i.propertiesPageModel.samplingRate,r.description=i.propertiesPageModel.description,i.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:this.buildEncapsulatedSessionSpec(r,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:this.buildRemoteSourceSessionSpec(r,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:this.buildDvPortSessionSpec(r,i);break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:this.buildRemoteDestSessionSpec(r,i)}return r},i.prototype.buildEncapsulatedSessionSpec=function(t,i){t.encapsulationType=i.propertiesPageModel.encapsulationType,i.propertiesPageModel.encapsulationType!==e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE&&(t.sessionId=i.propertiesPageModel.sessionId),i.propertiesPageModel.isTcpIpStackSupported&&(t.tcpIpStack=i.propertiesPageModel.tcpIpStack),this.buildSourcePortsSpec(t,i),i.selectDestinationsPageModel.ipAddressesListModel.values&&(t.destinationIps=i.selectDestinationsPageModel.ipAddressesListModel.values.filter(function(e){return e}))},i.prototype.buildRemoteSourceSessionSpec=function(e,t){e.encapsulationVlanId=t.propertiesPageModel.encapsulationVlanId,e.preserveOriginalVlan=t.propertiesPageModel.preserveOriginalVlan,e.normalTrafficAllowed=t.propertiesPageModel.normalTrafficAllowed,this.buildSourcePortsSpec(e,t),e.destinationUplinks=t.selectDestinationsPageModel.uplinksListModel.uplinks},i.prototype.buildSourcePortsSpec=function(t,i){i.selectSourcesPageModel.portsListModel.ports&&(t.sourcePortsEgress=[],t.sourcePortsIngress=[],i.selectSourcesPageModel.portsListModel.ports.forEach(function(i){i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS&&i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH||t.sourcePortsEgress.push(i.id),i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS&&i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH||t.sourcePortsIngress.push(i.id)}))},i.prototype.buildDvPortSessionSpec=function(t,i){t.normalTrafficAllowed=i.propertiesPageModel.normalTrafficAllowed,i.selectSourcesPageModel.portsListModel.ports&&(t.sourcePortsEgress=[],t.sourcePortsIngress=[],i.selectSourcesPageModel.portsListModel.ports.forEach(function(i){i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS&&i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH||t.sourcePortsEgress.push(i.id),i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS&&i.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH||t.sourcePortsIngress.push(i.id)})),t.destinationPorts=_.map(i.selectDestinationsPageModel.portsListModel.ports,function(e){return e.id})},i.prototype.buildRemoteDestSessionSpec=function(e,t){e.normalTrafficAllowed=t.propertiesPageModel.normalTrafficAllowed,e.sourceVlanIds=_.map(t.selectSourcesPageModel.vlanIdListModel.values,function(e){return+e}),e.destinationPorts=_.map(t.selectDestinationsPageModel.portsListModel.ports,function(e){return e.id})},i}();e.DvsAddSpanSessionWizardSpecFactory=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsAddSpanSessionWizardSpecFactory",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.pageValidators={},this.propertiesPageModel=new e.DvsSpanSessionPropertiesPageModel,this.selectSourcesPageModel=new e.DvsSpanSessionSelectSourcesPageModel,this.selectDestinationsPageModel=new e.DvsSpanSessionSelectDestinationsPageModel}return Object.defineProperty(t.prototype,"sessionType",{get:function(){return this._sessionType},set:function(t){if(t!==this._sessionType){switch(this._sessionType=t,this.propertiesPageModel.sessionName=this.retrievedSessionName,this.propertiesPageModel.enabled=!1,this.propertiesPageModel.mirroredPacketLengthEnabled=!1,this.propertiesPageModel.mirroredPacketLength=60,this.propertiesPageModel.samplingRate=1,this.propertiesPageModel.description="",this.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:this.propertiesPageModel.encapsulationType=e.DvsSpanSessionConstants.ENCAPSULATION_TYPE.GRE,this.propertiesPageModel.sessionId=0,this.propertiesPageModel.tcpIpStack=e.DvsSpanSessionConstants.TCP_IP_STACK.DEFAULT_STACK;break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:this.propertiesPageModel.preserveOriginalVlan=!0,this.propertiesPageModel.encapsulationVlanId=1,this.propertiesPageModel.normalTrafficAllowed=!1;break;case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:this.propertiesPageModel.normalTrafficAllowed=!1;break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:this.propertiesPageModel.normalTrafficAllowed=!1}this.selectSourcesPageModel.portsListModel.ports=[],delete this.selectSourcesPageModel.portsListModel.cachedData,this.selectSourcesPageModel.vlanIdListModel.values=[],delete this.selectSourcesPageModel.vlanIdListModel.cachedData,this.selectDestinationsPageModel.portsListModel.ports=[],delete this.selectDestinationsPageModel.portsListModel.cachedData,this.selectDestinationsPageModel.ipAddressesListModel.values=[],delete this.selectDestinationsPageModel.ipAddressesListModel.cachedData}},enumerable:!0,configurable:!0}),t}();e.DvsAddSpanSessionWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.dataService=e,this.i18nService=t,this.propertyViewService=i,this.i18n=this.i18nService.getString}return e.prototype.getDvsPortMirrorSessionDetails=function(t,i){var r={_type:"com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.DvsPortMirroringSpec",sessionKey:i},n={propertyParams:[{propertyName:e.DATA_PROPERTY,parameterType:"com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.DvsPortMirroringSpec",parameter:r}]};return this.dataService.getProperties(t,[e.DATA_PROPERTY],n).then(function(t){return t[e.DATA_PROPERTY]})},e.prototype.buildDvsPortMirrorSessionPropertiesView=function(e){if(e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildDvsPortMirrorSessionPropertiesCategory(t,e),t.build()}},e.prototype.buildDvsPortMirrorSessionPropertiesCategory=function(e,t){var i=e.category("properties");i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.name"),t.name),i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.type"),t.sessionType),t.encapsulationType&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.encapsulationType"),t.encapsulationType),t.sessionId!==-1&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.erspanId"),t.sessionId),t.tcpIpStack&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.tcpIpStack"),t.tcpIpStack),i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.status"),t.enabled),t.normalTrafficOnDestPorts&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.normalTrafficAllowed"),t.normalTrafficOnDestPorts),t.encapsulationVlanId&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.encapsulationVlanId"),t.encapsulationVlanId),t.preserveOriginalVlan&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.preserveOriginalVlan"),t.preserveOriginalVlan),i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.mirroredPacketLength"),t.mirroredPacketLength),t.samplingRate&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.samplingRate"),t.samplingRate),t.description&&i.section("general").property(this.i18n("DvsUi","SpanSessionDetailsView.description"),t.description)},e.$inject=["dataService","i18nService","vxPropertyViewService"],e.DATA_PROPERTY="dvswitchportmirroring:portMirroringSessionDetails",e}();e.DvsPortMirroringDetailsViewService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortMirroringDetailsViewService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={portMirrorSessions:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringTemplate.html"}return e}();e.DvsPortMirroringComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.$q=e,this.$rootScope=t,this.$scope=i,this.i18nService=r,this.vuiConstants=n,this.actionToolbarFactory=o,this.columnRenderersRegistry=a,this.networkUiConstants=s,this.dvsPortMirroringComponentService=c,this._actionAvailabilityById={},this.preselectComparator=function(e){return!!l.$scope.selectedSession&&l.$scope.selectedSession.key===e.key},this.createPortMirrorDatagridOptions(this.portMirrorSessions)}return e.prototype.$onInit=function(){this.showNoItemSelected=!0,this.refresh()},e.prototype.$onChanges=function(){this.datagridOptions.data=this.portMirrorSessions?this.portMirrorSessions:[]},e.prototype.refresh=function(){var e=this;this.$scope.portMirrorLoading=!0,this.dSwitchUri=this.$rootScope._route.objectId,this.headerOptions={title:this.i18nService.getString("DvsUi","dvs.portMirroringView.title"),objectId:this.dSwitchUri,actions:null},this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"45%"},{min:"250px",size:"55%"}]};var t=this.dvsPortMirroringComponentService.getDvsPortMirroringData(this.dSwitchUri);this._selectedDvsPromise=t,this.evaluationContext={};var i=[this.networkUiConstants.actions.ADD_SPAN_SESSION,this.vuiConstants.actions.SEPARATOR,this.networkUiConstants.actions.EDIT_SPAN_SESSION,this.networkUiConstants.actions.REMOVE_SPAN_SESSION],r=this.actionToolbarFactory.createActionbarOptions([this.$rootScope._route.objectId],i,this.evaluationContext);this._actionPromise=r,this.$q.all([t,r]).then(function(i){if(e._selectedDvsPromise===t){var n=i[0];n&&(e.portMirrorSessions=n.portMirroringSessionsData?n.portMirroringSessionsData:[],e.createPortMirrorDatagridOptions(e.portMirrorSessions))}e._actionPromise===r&&(e.datagridOptions.actionBarOptions=i[1],e.datagridOptions.actionBarOptions&&_.forEach(e.datagridOptions.actionBarOptions.actions,function(t){t!==e.vuiConstants.actions.SEPARATOR&&(e._actionAvailabilityById[t.actionId]=t.enabled)}))})["finally"](function(){e.$scope.portMirrorLoading=!1}),this.liveRefreshProperties=["config.vspanSession"]},e.prototype.createPortMirrorDatagridOptions=function(e){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:e,resizable:!0,height:"100%",pageConfig:{hidePager:!0},actionBarOptions:{actions:[]},onChange:this.onSelectionChange.bind(this)}},e.prototype.createColumnDefinitions=function(){var e=this;return[{displayName:this.i18nService.getString("DvsUi","dvs.portMirroring.grid.sessionName.columnHeader"),field:"name",width:"150px",template:function(t){return e.columnRenderersRegistry.getColumnRenderer("text")(["name"],t,!0)}},{displayName:this.i18nService.getString("DvsUi","dvs.portMirroring.grid.type.columnHeader"),field:"sessionType",width:"150px"},{displayName:this.i18nService.getString("DvsUi","dvs.portMirroring.grid.status.columnHeader"),field:"enabled",width:"150px"}]},e.prototype.onSelectionChange=function(e){e&&e.length>0?(this.$scope.selectedSession=e[0],this.evaluationContext.selectedSession=e[0],this.portMirrorDetailsHeader=this.i18nService.getString("DvsUi","SpanSessionDetailsView.title",e[0].name)):(this.$scope.selectedSession=null,this.evaluationContext.selectedSession=null),this.showNoItemSelected=null===this.$scope.selectedSession,this.toggleActionsAvailability()},e.prototype.toggleActionsAvailability=function(){var e=this;this.datagridOptions.actionBarOptions&&this.datagridOptions.actionBarOptions.actions&&this.datagridOptions.actionBarOptions.actions.forEach(function(t){t.actionId===e.networkUiConstants.actions.ADD_SPAN_SESSION?t.enabled=!!e._actionAvailabilityById[t.actionId]:t.actionId===e.networkUiConstants.actions.EDIT_SPAN_SESSION?t.enabled=!!e._actionAvailabilityById[t.actionId]&&null!==e.$scope.selectedSession&&!e.$scope.selectedSession.isLegacySession:t.actionId===e.networkUiConstants.actions.REMOVE_SPAN_SESSION&&(t.enabled=!!e._actionAvailabilityById[t.actionId]&&null!==e.$scope.selectedSession)})},e.$inject=["$q","$rootScope","$scope","i18nService","vuiConstants","actionToolbarFactory","columnRenderersRegistry","networkUiConstants","dvsPortMirroringComponentService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.dataService=e}return e.prototype.getDvsPortMirroringData=function(t){return this.dataService.getProperties(t,[e.PORT_MIRRORING_DATA_PROPERTY_NAME]).then(function(t){return t?t[e.PORT_MIRRORING_DATA_PROPERTY_NAME]:null})},e.$inject=["dataService","vxPropertyViewService"],e.PORT_MIRRORING_DATA_PROPERTY_NAME="dvswitchportmirroring:portMirroringDetails",e}();e.DvsPortMirroringComponentService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortMirroringComponentService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<",shouldRefresh:"<",onRefresh:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringSourcesDestViewTemplate.html"}return e}();e.DvsPortMirroringDestinationsViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$rootScope=t,this.$scope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.networkUtil=o,this.dvsPortMirroringSourcesAndDestRefreshService=a,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.datagridOptions.data=this.tableEntries,this.createDatagridOptions()},e.prototype.$onChanges=function(){this.shouldRefresh&&(this.dvsPortMirroringSourcesAndDestRefreshService.refreshDvsPortMirroringDestinationView(this.$scope,this.$rootScope,this.selectedSession,this.fillTableEntries.bind(this)),this.dSwitchUri=this.$rootScope._route.objectId,this.liveRefreshProperties=["config.vspanSession"])},e.prototype.fillTableEntries=function(e){e?(this.tableEntries=e.destinationPortData?e.destinationPortData:[],this.sortEntities()):this.datagridOptions.data=[],this.$scope.portMirrorLoading=!1,this.onRefresh()},e.prototype.sortEntities=function(){var e=this,t=[];this.tableEntries&&(t=this.tableEntries.sort(function(t,i){return e.networkUtil.compareNumericAndNonNumericValues(t,i,"portKey")})),this.datagridOptions.data=t},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){var e=this.columnRenderersRegistry.getColumnRenderer("object-link");return[{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.port"),field:"portKey",width:"150px"},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.host"),field:"hostProxyName",width:"150px",template:function(t){return e([void 0,"hostProxyName",t.hostIcon],t)}},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.connectee"),field:"connectedEntityName",width:"150px",template:function(t){return e([void 0,"connectedEntityName",t.connecteeIconId],t)}}]},e.$inject=["i18nService","$rootScope","$scope","vuiConstants","columnRenderersRegistry","networkUtil","dvsPortMirroringSourcesAndDestRefreshService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringDestinationsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringDetailsViewTemplate.html"}return e}();e.DvsPortMirroringDetailsComponent=t;var i=function(){function e(e,t,i,r){var n=this;this.$rootScope=e,this.$scope=t,this.i18nService=i,this.dvsPortMirroringDetailsViewService=r,this.i18n=this.i18nService.getString,this.isLegacySession=!1,this.isRemoteDestinationSession=!1,this.isRemoteSourceSession=!1,this.isEncapsulatedSession=!1,this.showDestinationsView=!1,this.selectedTabIndex=0,this.$scope.onSourcesViewRefreshed=function(){n.$scope.shouldRefreshSourcesView=!1},this.$scope.onDestinationsViewRefreshed=function(){
n.$scope.shouldRefreshDestinationsView=!1},this.$scope.onTabSelected=function(e){n.$scope.isSourcesTabLoaded=1===e||!!n.$scope.isSourcesTabLoaded,n.$scope.isDestinationsTabLoaded=2===e||n.$scope.isDestinationsTabLoaded,n.selectedTabIndex=e}}return e.prototype.$onChanges=function(){this.$scope.portMirrorLoading=!0,this.refresh(this.selectedSession)},e.prototype.refresh=function(e){var t=this;this.$scope.portMirrorLoading=!0,this.dSwitchUri=this.$rootScope._route.objectId;var i=this.dvsPortMirroringDetailsViewService.getDvsPortMirrorSessionDetails(this.dSwitchUri,e);this._selectedSessionPromise=i,this.$scope.isSourcesTabLoaded=1===this.selectedTabIndex,this.$scope.isDestinationsTabLoaded=2===this.selectedTabIndex,i.then(function(r){if(t._selectedSessionPromise===i){var n=r;t.$scope.dvsPortMirrorSessionData=t.dvsPortMirroringDetailsViewService.buildDvsPortMirrorSessionPropertiesView(n),n&&(t.isLegacySession=n.isLegacySession,t.isRemoteSourceSession=n.isRemoteSourceSession,t.isEncapsulatedSession=n.isEncapsulatedSession,t.isRemoteDestinationSession=n.isRemoteDestinationSession,t.showDestinationsView=n.isRemoteDestinationSession||n.isDvPortMirrorSession,t.$scope.shouldRefreshSourcesView=!0,t.$scope.shouldRefreshDestinationsView=!0,t.$scope.selectedSession=e),t.$scope.portMirrorLoading=!1}}),this.liveRefreshProperties=["config.vspanSession"]},e.$inject=["$rootScope","$scope","i18nService","dvsPortMirroringDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringDetailsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<",shouldRefresh:"<",onRefresh:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringSourcesDestViewTemplate.html"}return e}();e.DvsPortMirroringEncapsulationDestinationsViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$rootScope=t,this.$scope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.networkUtil=o,this.dvsPortMirroringSourcesAndDestRefreshService=a,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.createDatagridOptions()},e.prototype.$onChanges=function(){this.shouldRefresh&&this.dvsPortMirroringSourcesAndDestRefreshService.refreshDvsPortMirroringDestinationView(this.$scope,this.$rootScope,this.selectedSession,this.fillTableEntries.bind(this))},e.prototype.fillTableEntries=function(e){e?this.tableEntries=e.destinationPortData?e.destinationPortData:[]:this.tableEntries=[],this.$scope.portMirrorLoading=!1,this.onRefresh(),this.datagridOptions.data=this.tableEntries},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){this.columnRenderersRegistry.getColumnRenderer("object-link");return[{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.ipAddress"),field:"ipAddress",width:"150px"}]},e.$inject=["i18nService","$rootScope","$scope","vuiConstants","columnRenderersRegistry","networkUtil","dvsPortMirroringSourcesAndDestRefreshService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringEncapsulationDestinationsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<",shouldRefresh:"<",onRefresh:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringSourcesDestViewTemplate.html"}return e}();e.DvsPortMirroringLegacyDestinationsViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$scope=t,this.$rootScope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.networkUtil=o,this.dvsPortMirroringSourcesAndDestRefreshService=a,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.datagridOptions.data=this.tableEntries,this.createDatagridOptions()},e.prototype.$onChanges=function(){this.shouldRefresh&&this.dvsPortMirroringSourcesAndDestRefreshService.refreshDvsPortMirroringDestinationView(this.$scope,this.$rootScope,this.selectedSession,this.fillTableEntries.bind(this))},e.prototype.fillTableEntries=function(e){e?(this.tableEntries=e.destinationPortData?e.destinationPortData:[],this.sortEntities()):this.datagridOptions.data=[],this.$scope.portMirrorLoading=!1,this.onRefresh()},e.prototype.sortEntities=function(){var e=this,t=[];this.tableEntries&&(t=this.tableEntries.sort(function(t,i){return e.networkUtil.compareNumericAndNonNumericValues(t,i,"portKey")})),this.datagridOptions.data=t},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("object-link");return[{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.portIdAndUplink"),field:"portKey",width:"150px",sortable:function(t,i){return e.networkUtil.compareNumericAndNonNumericValues(t,i,"portKey")}},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.host"),field:"hostProxyName",width:"150px",template:function(e){return t([void 0,"hostProxyName",e.hostIcon],e)}},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.connectee"),field:"connectedEntityName",width:"150px",template:function(e){return t([void 0,"connectedEntityName",e.connecteeIconId],e)}}]},e.$inject=["i18nService","$scope","$rootScope","vuiConstants","columnRenderersRegistry","networkUtil","dvsPortMirroringSourcesAndDestRefreshService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringLegacyDestinationsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.dataService=e}return e.prototype.getDvsPortMirrorSourcePortsDataDetails=function(t,i){var r={_type:e.DESTINATION_PORTS_SPEC_TYPE,sessionKey:i},n={propertyParams:[{propertyName:e.SOURCE_PORTS_DATA_PROPERTY,parameterType:r._type,parameter:r}]};return this.dataService.getProperties(t,[e.SOURCE_PORTS_DATA_PROPERTY],n).then(function(t){return t[e.SOURCE_PORTS_DATA_PROPERTY]})},e.prototype.getDvsPortMirrorDestPortsDataDetails=function(t,i){var r={_type:e.DESTINATION_PORTS_SPEC_TYPE,sessionKey:i},n={propertyParams:[{propertyName:e.DESTINATION_PORTS_DATA_PROPERTY,parameterType:r._type,parameter:r}]};return this.dataService.getProperties(t,[e.DESTINATION_PORTS_DATA_PROPERTY],n).then(function(t){return t[e.DESTINATION_PORTS_DATA_PROPERTY]})},e.$inject=["dataService"],e.SOURCE_PORTS_DATA_PROPERTY="dvswitchportmirroring:portMirroringSourcePortsDetails",e.DESTINATION_PORTS_DATA_PROPERTY="dvswitchportmirroring:portMirroringDestinationPortsDetails",e.DESTINATION_PORTS_SPEC_TYPE="com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.DvsPortMirroringSpec",e}();e.DvsPortMirroringPortsDetailsDataService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortMirroringPortsDetailsDataService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<",shouldRefresh:"<",onRefresh:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringSourcesDestViewTemplate.html"}return e}();e.DvsPortMirroringRemoteSourceDestinationsViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$scope=t,this.$rootScope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.networkUtil=o,this.dvsPortMirroringSourcesAndDestRefreshService=a,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.datagridOptions.data=this.tableEntries,this.createDatagridOptions()},e.prototype.$onChanges=function(){this.shouldRefresh&&this.dvsPortMirroringSourcesAndDestRefreshService.refreshDvsPortMirroringDestinationView(this.$scope,this.$rootScope,this.selectedSession,this.fillTableEntries.bind(this))},e.prototype.fillTableEntries=function(e){e?this.tableEntries=e.destinationPortData?e.destinationPortData:[]:this.tableEntries=[],this.$scope.portMirrorLoading=!1,this.datagridOptions.data=this.tableEntries,this.onRefresh()},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){return[{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.uplink"),field:"portKey",width:"150px"}]},e.$inject=["i18nService","$scope","$rootScope","vuiConstants","columnRenderersRegistry","networkUtil","dvsPortMirroringSourcesAndDestRefreshService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringRemoteSourceDestinationsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.dataService=e,this.dvsPortMirroringPortsDetailsDataService=t}return e.prototype.refreshDvsPortMirroringSourcesView=function(e,t,i,r){var n=this;e.portMirrorLoading=!0;var o=t._route.objectId,a=this.dvsPortMirroringPortsDetailsDataService.getDvsPortMirrorSourcePortsDataDetails(o,i);this._sourcePortsDataPromise=a,a.then(function(e){n._sourcePortsDataPromise===a&&r(e)})},e.prototype.refreshDvsPortMirroringDestinationView=function(e,t,i,r){var n=this;e.portMirrorLoading=!0;var o=t._route.objectId,a=this.dvsPortMirroringPortsDetailsDataService.getDvsPortMirrorDestPortsDataDetails(o,i);this._destinationPortsDataPromise=a,a.then(function(e){n._destinationPortsDataPromise===a&&r(e)})},e.$inject=["dataService","dvsPortMirroringPortsDetailsDataService"],e}();e.DvsPortMirroringSourcesAndDestRefreshService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortMirroringSourcesAndDestRefreshService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<",shouldRefresh:"<",onRefresh:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringSourcesDestViewTemplate.html"}return e}();e.DvsPortMirroringSourcesViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$rootScope=t,this.$scope=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.networkUtil=o,this.dvsPortMirroringSourcesAndDestRefreshService=a,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.datagridOptions.data=this.tableEntries,this.createDatagridOptions()},e.prototype.$onChanges=function(){this.shouldRefresh&&(this.dvsPortMirroringSourcesAndDestRefreshService.refreshDvsPortMirroringSourcesView(this.$scope,this.$rootScope,this.selectedSession,this.fillTableEntries.bind(this)),this.dSwitchUri=this.$rootScope._route.objectId,this.liveRefreshProperties=["config.vspanSession"])},e.prototype.fillTableEntries=function(e){e?(this.tableEntries=e.sourcePortData?e.sourcePortData:[],this.sortEntities()):this.datagridOptions.data=[],this.$scope.portMirrorLoading=!1,this.onRefresh()},e.prototype.sortEntities=function(){var e=this,t=[];this.tableEntries&&(t=this.tableEntries.sort(function(t,i){return e.networkUtil.compareNumericAndNonNumericValues(t,i,"portKey")})),this.datagridOptions.data=t},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("object-link");return[{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.port"),field:"portKey",width:"150px",sortable:function(t,i){return e.networkUtil.compareNumericAndNonNumericValues(t,i,"portKey")}},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.host"),field:"hostProxyName",width:"150px",template:function(e){return t([void 0,"hostProxyName",e.hostIcon],e)}},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.connectee"),field:"connectedEntityName",width:"150px",template:function(e){return t([void 0,"connectedEntityName",e.connecteeIconId],e)}},{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.direction"),field:"trafficDirection",width:"150px",template:function(e){return t([void 0,"trafficDirection",e.trafficDirectionIconId],e)}}]},e.$inject=["i18nService","$rootScope","$scope","vuiConstants","columnRenderersRegistry","networkUtil","dvsPortMirroringSourcesAndDestRefreshService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringSourcesView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedSession:"<",shouldRefresh:"<",onRefresh:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/portmirroring/dvsPortMirroringSourcesDestViewTemplate.html"}return e}();e.DvsPortMirroringSourcesVlanViewComponent=t;var i=function(){function e(e,t,i,r,n,o,a){this.$rootScope=e,this.$scope=t,this.i18nService=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.networkUtil=o,this.dvsPortMirroringSourcesAndDestRefreshService=a,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.createDatagridOptions()},e.prototype.$onChanges=function(){this.shouldRefresh&&this.dvsPortMirroringSourcesAndDestRefreshService.refreshDvsPortMirroringSourcesView(this.$scope,this.$rootScope,this.selectedSession,this.fillTableEntries.bind(this))},e.prototype.fillTableEntries=function(e){e?this.tableEntries=e.sourcePortData?e.sourcePortData:[]:this.tableEntries=[],this.$scope.portMirrorLoading=!1,this.datagridOptions.data=this.tableEntries,this.onRefresh()},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){var e=this;return[{displayName:this.i18nService.getString("DvsUi","SessionDvPortSourceList.vlanId"),field:"vlan",width:"150px",sortable:function(t,i){return e.networkUtil.compareNumericValues(t,i,"vlan")}}]},e.$inject=["$rootScope","$scope","i18nService","vuiConstants","columnRenderersRegistry","networkUtil","dvsPortMirroringSourcesAndDestRefreshService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortMirroringSourcesVlanView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i){this.vuiConstants=e,this.i18nService=t,this.propertiesValidator=i}return t.prototype.createPageDefinitions=function(t,i){var r=[];switch(r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.propertiesPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionPropertiesPage.html",onCommit:this.buildPropertiesPageCommitCallback(t)}),i){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.sourcesPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectSourcePortsPage.html",onCommit:function(){return!0}}),r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.destinationsPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectDestinationAddressesPage.html",onCommit:this.buildDestinationAddressesPageCommitCallback(t)});break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.sourcesPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectSourcePortsPage.html",onCommit:function(){return!0}}),r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.destinationsPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectDestinationUplinksPage.html",onCommit:function(){return!0}});break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.sourcesPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectSourceVlansPage.html",onCommit:this.buildSourceVlansPageCommitCallback(t)}),r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.destinationsPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectDestinationPortsPage.html",onCommit:function(){return!0}});break;case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.sourcesPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectSourcePortsPage.html",onCommit:this.buildPortsPageCommitCallback(t,"SpanSession.error.alreadyUsedDestPort","SpanSession.error.alreadyUsedDestPorts")}),r.push({title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.destinationsPage.title"),contentUrl:"dvs-ui/resources/dvs/portmirroring/edit/views/dvsEditSpanSessionSelectDestinationPortsPage.html",onCommit:this.buildPortsPageCommitCallback(t,"SpanSession.error.alreadyUsedSourcePort","SpanSession.error.alreadyUsedSourcePorts")})}return r},t.prototype.buildPropertiesPageCommitCallback=function(e){var t=this;return function(){e.model.pageValidators.editPropertiesPage.validate();var i=e.model.propertiesPageModel,r=i.errors?i.errors.slice():[],n=t.propertiesValidator.getDescriptionError(e.model.propertiesPageModel.description);return n&&r.push(n),r.length>0?(t.showDialogErrors(e,r),!1):e.model.originalData.sessionName===e.model.propertiesPageModel.sessionName||(e.busy=!0,t.propertiesValidator.getNameServerError(e.model.dvsUrn,e.model.propertiesPageModel.sessionName).then(function(i){return t.showDialogErrors(e,[i]),e.busy=!1,!i}))}},t.prototype.buildDestinationAddressesPageCommitCallback=function(t){var i=this;return function(){t.model.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.SELECT_DESTINATION_ADDRESSES].validate();var r=t.model.selectDestinationsPageModel;return!r.ipAddressesListModel.errors||!r.ipAddressesListModel.errors.length||(i.showDialogErrors(t,r.ipAddressesListModel.errors),!1)}},t.prototype.buildSourceVlansPageCommitCallback=function(t){var i=this;return function(){t.model.pageValidators[e.DvsSpanSessionConstants.PAGE_ID.SELECT_SOURCE_VLANS].validate();var r=t.model.selectSourcesPageModel;return!r.vlanIdListModel.errors||!r.vlanIdListModel.errors.length||(i.showDialogErrors(t,r.vlanIdListModel.errors),!1)}},t.prototype.buildPortsPageCommitCallback=function(e,t,i){var r=this;return function(){var n=e.model.selectSourcesPageModel.portsListModel.ports.map(function(e){return e.id}),o=e.model.selectDestinationsPageModel.portsListModel.ports.map(function(e){return e.id}),a=_.intersection(n,o);return 1===a.length?(r.showDialogErrors(e,[r.i18nService.getString("DvsUi",t,a[0])]),!1):!(a.length>1)||(r.showDialogErrors(e,[r.i18nService.getString("DvsUi",i,a.join(", "))]),!1)}},t.prototype.showDialogErrors=function(e,t){var i=this;e.dialogOptions.validationBanner.messages=_.map(t,function(e){return{type:i.vuiConstants.validationBanner.type.ERROR,text:e}})},t.$inject=["vuiConstants","i18nService","dvsSpanSessionPropertiesValidator"],t}();e.DvsEditSpanSessionDialogPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSpanSessionDialogPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c){this.$rootScope=e,this.vuiConstants=t,this.vxValidatorFactory=i,this.vxMultiPageDialogService=r,this.i18nService=n,this.dataService=o,this.mutationService=a,this.dvsEditSpanSessionDialogPages=s,this.specFactory=c}return t.prototype.show=function(t,i,r){var n=this,o=this.$rootScope.$new();o.dvsUrn=t,o.sessionKey=i,o.sessionType=r,o.busy=!1,o.dialogOptions=this.createDialogOptions(o,r),o.dialogOptions.confirmOptions={onClick:function(){return n.submitDialog(o.model),!0}},o.model=new e.DvsEditSpanSessionDialogModel,o.model.dvsUrn=t;var a={scope:o,configObjectName:"dialogOptions"};this.vxMultiPageDialogService(a),this.requestData(o)},t.prototype.createDialogOptions=function(e,t){return{title:this.i18nService.getString("DvsUi","EditSpanSessionDialog.initialTitle"),pages:this.dvsEditSpanSessionDialogPages.createPageDefinitions(e,t),show:!0,loading:!0,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0,height:"600px",width:"920px"}},t.prototype.requestData=function(e){var i=this;this.dataService.getProperties(e.dvsUrn,[t.DATA_PROPERTY],{propertyParams:[{propertyName:t.DATA_PROPERTY,parameterType:"java.lang.String",parameter:e.sessionKey}]}).then(function(r){r&&r[t.DATA_PROPERTY]&&(i.updateDialogModel(e.model,r[t.DATA_PROPERTY]),i.initPageValidators(e.model),e.dialogOptions.title=i.i18nService.getString("DvsUi","EditSpanSessionDialog.titleFormat",r[t.DATA_PROPERTY].dvsName),e.dialogOptions.loading=!1)})},t.prototype.updateDialogModel=function(e,t){e.originalData=t,e.sessionType=t.sessionType,this.updatePropertiesPageModel(e.propertiesPageModel,t),e.originalData.mirroredPacketLength=e.propertiesPageModel.mirroredPacketLength,this.updateSourcesPageModel(e.selectSourcesPageModel,t),this.updateDestinationsPageModel(e.selectDestinationsPageModel,t)},t.prototype.updatePropertiesPageModel=function(e,t){e.sessionName=t.sessionName,e.enabled=t.enabled,e.description=t.description,e.samplingRate=t.samplingRate,e.mirroredPacketLengthEnabled=t.mirroredPacketLengthEnabled,e.mirroredPacketLength=t.mirroredPacketLengthEnabled?t.mirroredPacketLength:60,e.encapsulationType=t.encapsulationType,e.sessionId=t.sessionId,e.isTcpIpStackSupported=t.mirrorNetstackSupported,e.tcpIpStack=t.tcpIpStack,e.erspanSupported=t.erspanSupported,e.encapsulationVlanId=t.encapsulationVlanId,e.preserveOriginalVlan=t.preserveOriginalVlan,e.normalTrafficAllowed=t.normalTrafficAllowed},t.prototype.updateSourcesPageModel=function(t,i){var r={};(i.sourcePortsIngress||[]).forEach(function(t){r[t]=e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS}),(i.sourcePortsEgress||[]).forEach(function(t){r[t]="undefined"==typeof r[t]?e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS:e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH}),t.portsListModel.ports=[],Object.getOwnPropertyNames(r).forEach(function(i){t.portsListModel.ports.push(new e.PortData(i,r[i]))}),t.vlanIdListModel.values=[],t.vlanIdListModel.cachedData=[],(i.sourceVlans||[]).forEach(function(e){t.vlanIdListModel.values.push(String(e)),t.vlanIdListModel.cachedData.push({value:String(e),active:!1,valid:!0})})},t.prototype.updateDestinationsPageModel=function(t,i){t.ipAddressesListModel.values=[],t.ipAddressesListModel.cachedData=[],(i.destinationAddresses||[]).forEach(function(e){t.ipAddressesListModel.values.push(e),t.ipAddressesListModel.cachedData.push({value:e,active:!1,valid:!0})}),(i.destinationPorts||[]).forEach(function(i){t.portsListModel.ports.push(new e.PortData(i,e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH))}),(i.uplinkPortsSelected||[]).forEach(function(e){t.uplinksListModel.uplinks.push(e)}),(i.uplinkPortsExisting||[]).forEach(function(e){t.uplinksListModel.notSelectedUplinks.push(e)})},t.prototype.initPageValidators=function(t){t.pageValidators.editPropertiesPage=new e.DvsSpanSessionPageValidator(t.propertiesPageModel,this.vxValidatorFactory.create()),t.pageValidators.selectDestinationAddressesPage=new e.DvsSpanSessionPageValidator(t.selectDestinationsPageModel.ipAddressesListModel,this.vxValidatorFactory.create()),t.pageValidators.selectSourceVlansPage=new e.DvsSpanSessionPageValidator(t.selectSourcesPageModel.vlanIdListModel,this.vxValidatorFactory.create())},t.prototype.submitDialog=function(e){var t=this.specFactory.buildChanges(e);t&&this.mutationService.apply(e.dvsUrn,t._type,t)},t.$inject=["$rootScope","vuiConstants","vxValidatorFactory","vxMultiPageDialogService","i18nService","dataService","mutationService","dvsEditSpanSessionDialogPages","dvsEditSpanSessionDialogSpecFactory"],t.DATA_PROPERTY="dvswitchportmirroring:editSpanSessionDialogData",t}();e.DvsEditSpanSessionDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSpanSessionDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.dialog.DvsEditSpanSessionDialogData,i=function(){function i(){}return i.prototype.buildChanges=function(e){var t=this.havePropertiesChanged(e)||this.haveSourcesChanged(e)||this.haveDestinationsChanged(e);return t?_.extend(this.buildCommonPropertiesChanges(e),this.buildSourcesChanges(e),this.buildDestinationChanges(e)):null},i.prototype.buildCommonPropertiesChanges=function(e){var i=new t;return i.key=e.originalData.key,i.sessionType=e.originalData.sessionType,i.sessionName=e.propertiesPageModel.sessionName,i.enabled=e.propertiesPageModel.enabled,i.sessionId=e.propertiesPageModel.sessionId,e.propertiesPageModel.isTcpIpStackSupported&&(i.tcpIpStack=e.propertiesPageModel.tcpIpStack),i.preserveOriginalVlan=e.propertiesPageModel.preserveOriginalVlan,i.encapsulationVlanId=e.propertiesPageModel.encapsulationVlanId,i.normalTrafficAllowed=e.propertiesPageModel.normalTrafficAllowed,i.mirroredPacketLength=e.propertiesPageModel.mirroredPacketLengthEnabled?e.propertiesPageModel.mirroredPacketLength:-1,i.samplingRate=e.propertiesPageModel.samplingRate,i.description=e.propertiesPageModel.description,i},i.prototype.buildSourcesChanges=function(i){var r=new t;return i.originalData.sessionType!==e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST?(r.sourcePortsEgress=[],r.sourcePortsIngress=[],i.selectSourcesPageModel.portsListModel.ports.forEach(function(t){t.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS&&t.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH||r.sourcePortsEgress.push(t.id),t.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS&&t.trafficDirection!==e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH||r.sourcePortsIngress.push(t.id)})):i.originalData.sessionType===e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST&&(r.sourceVlans=i.selectSourcesPageModel.vlanIdListModel.values.map(function(e){return parseInt(e)})),r},i.prototype.buildDestinationChanges=function(i){var r=new t;switch(i.originalData.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:r.destinationAddresses=i.selectDestinationsPageModel.ipAddressesListModel.values;break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:r.destinationPorts=i.selectDestinationsPageModel.portsListModel.ports.map(function(e){return e.id});break;case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:r.uplinkPortsSelected=i.selectDestinationsPageModel.uplinksListModel.uplinks}return r},i.prototype.havePropertiesChanged=function(e){for(var t=Object.getOwnPropertyNames(e.propertiesPageModel),i=0,r=t;i<r.length;i++){var n=r[i];if("errors"!==n&&e.originalData[n]!==e.propertiesPageModel[n])return!0}return!1},i.prototype.haveSourcesChanged=function(t){switch(t.originalData.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:return this.haveSourcePortsChanged(t);case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:return this.haveSourceVlansChanged(t);default:return!1}},i.prototype.haveDestinationsChanged=function(t){switch(t.originalData.sessionType){case e.DvsSpanSessionConstants.SESSION_TYPE.L3_SOURCE:return this.haveDestinationAddressesChanged(t);case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_DEST:case e.DvsSpanSessionConstants.SESSION_TYPE.DV_PORT_MIRROR:return this.haveDestinationPortsChanged(t);case e.DvsSpanSessionConstants.SESSION_TYPE.REMOTE_MIRROR_SOURCE:return this.haveDestinationUplinksChanged(t);default:return!1}},i.prototype.haveSourcePortsChanged=function(e){return i.havePortsListValuesChanged(e.selectSourcesPageModel.portsListModel.ports,e.originalData.sourcePortsEgress,e.originalData.sourcePortsIngress)},i.prototype.haveSourceVlansChanged=function(e){var t=e.selectSourcesPageModel.vlanIdListModel.values||[],r=(e.originalData.sourceVlans||[]).map(function(e){return String(e)});return i.haveEditableListValuesChanged(t,r)},i.prototype.haveDestinationAddressesChanged=function(e){var t=e.selectDestinationsPageModel.ipAddressesListModel.values||[],r=e.originalData.destinationAddresses||[];return i.haveEditableListValuesChanged(t,r)},i.prototype.haveDestinationPortsChanged=function(e){return i.havePortsListValuesChanged(e.selectDestinationsPageModel.portsListModel.ports,e.originalData.destinationPorts,e.originalData.destinationPorts)},i.haveEditableListValuesChanged=function(e,t){if(e.length!==t.length)return!0;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!0;return!1},i.havePortsListValuesChanged=function(t,i,r){var n=[],o=[];return t.forEach(function(t){switch(t.trafficDirection){case e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.BOTH:n.push(t.id),o.push(t.id);break;case e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.EGRESS:n.push(t.id);break;case e.DvsSpanSessionConstants.TRAFFIC_DIRECTION.INGRESS:o.push(t.id)}}),_.difference(n,i).length>0||_.difference(i,n).length>0||_.difference(o,r).length>0||_.difference(r,o).length>0},i.prototype.haveDestinationUplinksChanged=function(e){var t=e.selectDestinationsPageModel.uplinksListModel.uplinks||[],i=e.originalData.uplinkPortsSelected||[];if(t.length!==i.length)return!0;for(var r=0;r<t.length;r++)if(t[r]!==i[r])return!0;return!1},i}();e.DvsEditSpanSessionDialogSpecFactory=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSpanSessionDialogSpecFactory",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(){this.pageValidators={},this.propertiesPageModel=new e.DvsSpanSessionPropertiesPageModel,this.selectSourcesPageModel=new e.DvsSpanSessionSelectSourcesPageModel,this.selectDestinationsPageModel=new e.DvsSpanSessionSelectDestinationsPageModel,this.selectDestinationUplinksPageModel=new e.DvsSpanSessionDestinationUplinksModel}return t}();e.DvsEditSpanSessionDialogModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.mutationService=e,this.actionConfirmationService=t,this.i18nService=i,this.clarityModalService=r}return e.prototype.removeSpanSession=function(e,t){var i=this,r="com.vmware.vsphere.client.h5.network.dvs.portmirroring.model.DvsPortMirroringSpec",n={_type:r,sessionKey:t.selectedSession.key},o=function(){i.mutationService.apply(e[0],n._type,n)},a={title:this.i18nService.getString("DvsUi","actionRemoveSpanSessionCaption"),message:this.i18nService.getString("DvsUi","actionRemoveSpanSessionWarning",t.selectedSession.name),submit:o,subTitle:{text:t.selectedSession.name,objectId:e[0]},preserveNewlines:!0,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"}};this.clarityModalService.openConfirmationModal(a)},e.$inject=["mutationService","actionConfirmationService","i18nService","clarityModalService"],e}();e.DvsPortMirroringRemoveSessionService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortMirroringRemoveSessionService",t);
}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.controller=i,this.bindings={isPortGroupContext:"<"},this.templateUrl="dvs-ui/resources/dvs/ports/dvsPortsTemplate.html"}return e}();e.DvsPortsComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c,l,d){var u=this;this.$q=e,this.$scope=t,this.i18nService=i,this.dataService=r,this.vuiConstants=n,this.navigation=o,this.dvsPortsService=a,this.actionToolbarFactory=s,this.networkUiConstants=c,this.authorizationService=l,this.defaultUriSchemeUtil=d,this.selectedPorts=[],this.preselectComparator=function(e){return _.contains(_.pluck(u.selectedPorts,"portId"),e.portId)},this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.portContextId=this.navigation.getRoute().objectId,this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{min:"250px",size:"55%"},{min:"150px",size:"45%"}]},this.datagridOptions={columnDefs:this.dvsPortsService.getColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,showCheckboxesOnMultiSelection:!1,selectedItems:[],data:[],resizable:!0,height:"100%",actionBarOptions:{actions:[]},onChange:this.onSelectionChanged.bind(this)},this.liveRefreshProperties=this.dvsPortsService.assignLiveRefreshProperties(this.isPortGroupContext),this.watchForObjects=[this.portContextId],this.refresh()},e.prototype.refresh=function(){var t=this;this.portsLoading=!0;var i=this.isPortGroupContext?e.DVPG_PORTS_VIEW_DATA_PROPERTY_NAME:e.DVS_PORTS_VIEW_DATA_PROPERTY_NAME,r=this.dataService.getProperties(this.portContextId,[i]);this._currentDvsPromise=r,this.evaluationContext={},this.evaluationContext.isPortGroupContext=this.isPortGroupContext;var n=[this.networkUiConstants.actions.EDIT_DVPORT],o=this.actionToolbarFactory.createActionbarOptions([this.portContextId],n,this.evaluationContext);this._actionPromise=o;var a=this.authorizationService.checkPrivilege(this.portContextId,e.PRIVILEGE_PORT_CONFIG);this._authorizationPromise=a,this.$q.all([r,o,a]).then(function(e){if(t._currentDvsPromise===r){var n=e[0];n&&n[i]&&(t.dSwitchUri=t.defaultUriSchemeUtil.getVsphereObjectId(n[i].dvsMor),t.isPortTrafficFilterSupported=n[i].portTrafficFilterSupported,t.evaluationContext.dSwitchUri=t.dSwitchUri,t.datagridOptions.data=n[i].ports,t.isPortGroupContext&&t.watchForObjects&&t.watchForObjects.length<2&&t.watchForObjects.push(t.dSwitchUri))}t._actionPromise===o&&(t.datagridOptions.actionBarOptions=e[1]),t._authorizationPromise===a&&(t.hasPortConfigPrivilege=e[2],t.datagridOptions.actionBarOptions.actions.length>0&&(t.datagridOptions.actionBarOptions.actions[0].enabled=e[2]))})["finally"](function(){t.portsLoading=!1})},e.prototype.onSelectionChanged=function(e){e&&e.length>0?(this.selectedPorts=e,this.evaluationContext.selectedPort=e[0]):(this.selectedPorts=[],this.evaluationContext.selectedPort=null),this.hasPortConfigPrivilege&&this.toggleActionsAvailability()},e.prototype.toggleActionsAvailability=function(){this.datagridOptions.actionBarOptions&&1===this.datagridOptions.actionBarOptions.actions.length&&(this.datagridOptions.actionBarOptions.actions[0].enabled=this.selectedPorts&&this.selectedPorts.length>0)},e.DVS_PORTS_VIEW_DATA_PROPERTY_NAME="dvsports:portsViewData",e.DVPG_PORTS_VIEW_DATA_PROPERTY_NAME="dvportgroupports:portsViewData",e.PRIVILEGE_PORT_CONFIG="DVSwitch.PortConfig",e.$inject=["$q","$scope","i18nService","dataService","vuiConstants","navigation","dvsPortsService","actionToolbarFactory","networkUiConstants","authorizationService","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.VM_VNIC="vmVnic",e.PNIC="pnic",e.VMK_VNIC="hostVmkVnic",e.LIVE_REFRESH_PROPERTIES=["config.defaultPortConfig.vlan.vlanId","config.defaultPortConfig.vlan","config.defaultPortConfig.securityPolicy.allowPromiscuous.value","config.defaultPortConfig.securityPolicy.macChanges.value","config.defaultPortConfig.securityPolicy.forgedTransmits.value","config.defaultPortConfig.uplinkTeamingPolicy.policy.value","config.defaultPortConfig.uplinkTeamingPolicy.failureCriteria.checkBeacon.value","config.defaultPortConfig.uplinkTeamingPolicy.notifySwitches.value","config.defaultPortConfig.uplinkTeamingPolicy.rollingOrder.value","config.defaultPortConfig.uplinkTeamingPolicy.uplinkPortOrder.standbyUplinkPort","config.defaultPortConfig.uplinkTeamingPolicy.uplinkPortOrder.activeUplinkPort","config.defaultPortConfig.inShapingPolicy.averageBandwidth.value","config.defaultPortConfig.inShapingPolicy.peakBandwidth.value","config.defaultPortConfig.inShapingPolicy.burstSize.value","config.defaultPortConfig.inShapingPolicy.enabled.value","config.defaultPortConfig.outShapingPolicy.averageBandwidth.value","config.defaultPortConfig.outShapingPolicy.peakBandwidth.value","config.defaultPortConfig.outShapingPolicy.burstSize.value","config.defaultPortConfig.outShapingPolicy.enabled.value","config.defaultPortConfig.ipfixEnabled.value","config.defaultPortConfig.blocked.value"],e}();e.DvsPortsConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r){this.i18nService=e,this.columnRenderersRegistry=t,this.networkUtil=i,this.vxPropertyViewService=r,this.i18n=this.i18nService.getString,this.EMPTY_PROPERTY_VALUE=this.i18n("DvsUi","PortList.noData")}return t.prototype.getColumnDefinitions=function(){var t=this;return[{displayName:this.i18n("DvsUi","PortList.keyHeaderText"),field:"portId",width:"50px",template:function(e){return t.columnRenderersRegistry.getColumnRenderer("text")(["portId"],e,!1)},sortable:function(e,i){return t.networkUtil.compareNumericAndNonNumericValues(e,i,"portId")}},{displayName:this.i18n("DvsUi","PortList.nameHeaderText"),field:"name",width:"90px",template:function(e){return e.name?t.columnRenderersRegistry.getColumnRenderer("text")(["name"],e,!1):t.EMPTY_PROPERTY_VALUE}},{displayName:this.i18n("DvsUi","PortList.connecteeHeaderText"),field:"connectee",width:"90px",template:function(i){return i.connectedEntity?i.connectedEntityType===e.DvsPortsConstants.VM_VNIC?i.formattedName=i.connectedEntity:i.formattedName=i.host+" - "+i.connectedEntity:i.formattedName=t.EMPTY_PROPERTY_VALUE,t.columnRenderersRegistry.getColumnRenderer("text")(["formattedName"],i,!1)},sortable:function(e,t){return e.formattedName.localeCompare(t.formattedName)}},{displayName:this.i18n("DvsUi","PortList.macHeaderText"),field:"mac",width:"90px",template:function(e){return e.mac?t.columnRenderersRegistry.getColumnRenderer("text")(["mac"],e,!1):t.EMPTY_PROPERTY_VALUE}},{displayName:this.i18n("DvsUi","PortList.pgHeaderText"),field:"portgroup",width:"90px",template:function(e){return e.portgroup?t.columnRenderersRegistry.getColumnRenderer("text")(["portgroup"],e,!1):t.EMPTY_PROPERTY_VALUE}},{displayName:this.i18n("DvsUi","PortList.stateHeaderText"),field:"state",width:"90px",template:function(e){var i={icon:"",text:t.EMPTY_PROPERTY_VALUE};switch(e.state){case"LINK_UP":i.text=t.i18n("DvsUi","PortState.linkUp"),i.icon="network-lib-ui-icon-dvsPortConnectedLf";break;case"LINK_DOWN":i.text=t.i18n("DvsUi","PortState.linkDown"),i.icon="network-lib-ui-icon-dvsPortNotconnectedLf";break;case"BLOCKED":i.text=t.i18n("DvsUi","PortState.blocked"),i.icon="network-lib-ui-icon-dvsPortBlockedLf"}return t.columnRenderersRegistry.getColumnRenderer("icon-text")(["icon","text"],i,!1)}},{displayName:this.i18n("DvsUi","PortList.vlanIdHeaderText"),field:"vlan",width:"90px",template:function(e){return e.vlan?t.columnRenderersRegistry.getColumnRenderer("text")(["vlan"],e,!1):t.EMPTY_PROPERTY_VALUE}}]},t.prototype.buildDvsPortNetworkConnectionPropertiesView=function(e){if(e){var t=this.vxPropertyViewService.createPropertyViewBuilder();return this.buildDvsPortNetworkConnectionCategory(t,e),t.build()}},t.prototype.assignLiveRefreshProperties=function(t){return t?e.DvsPortsConstants.LIVE_REFRESH_PROPERTIES:[]},t.prototype.buildDvsPortNetworkConnectionCategory=function(t,i){var r=t.category("general"),n=r.section("generalSection");if(n.property(this.i18n("DvsUi","PortDetails.portId"),i.portId),i.name&&n.property(this.i18n("DvsUi","PortDetails.name"),i.name),i.description&&n.property(this.i18n("DvsUi","PortDetails.description"),i.description),i.lagName&&n.property(this.i18n("DvsUi","PortDetails.lagName"),i.lagName),i.connectedEntity){var o={icon:"",text:this.EMPTY_PROPERTY_VALUE};switch(i.connectedEntityType){case e.DvsPortsConstants.VMK_VNIC:o.text=i.host+" - "+i.connectedEntity,o.icon="network-lib-ui-icon-virtualAdapter";break;case e.DvsPortsConstants.VM_VNIC:o.text=""+i.connectedEntity,o.icon="vsphere-icon-vm";break;case e.DvsPortsConstants.PNIC:o.text=i.host+" - "+i.connectedEntity,o.icon="network-lib-ui-icon-physicalAdapter"}this.addPropertyValueWithIcon(n,this.i18n("DvsUi","PortDetails.connectee"),o)}var a={icon:"",text:this.EMPTY_PROPERTY_VALUE};switch(i.state){case"LINK_UP":a.text=this.i18n("DvsUi","PortState.linkUp"),a.icon="network-lib-ui-icon-dvsPortConnectedLf";break;case"LINK_DOWN":a.text=this.i18n("DvsUi","PortState.linkDown"),a.icon="network-lib-ui-icon-dvsPortNotconnectedLf";break;case"BLOCKED":a.text=this.i18n("DvsUi","PortState.blocked"),a.icon="network-lib-ui-icon-dvsPortBlockedLf"}this.addPropertyValueWithIcon(n,this.i18n("DvsUi","PortDetails.state"),a),i.mac&&n.property(this.i18n("DvsUi","PortDetails.mac"),i.mac)},t.prototype.addPropertyValueWithIcon=function(e,t,i){return e.propertyBuilder().keyBuilder().text(t).exit().valueBuilder().icon(i.icon).text(i.text).exit().exit()},t.$inject=["i18nService","columnRenderersRegistry","networkUtil","vxPropertyViewService"],t}();e.DvsPortsSerivce=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortsService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedPort:"<",isPortGroupContext:"<",isPortTrafficFilterSupported:"<",portContextId:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/ports/dvsPortsDetailsViewTemplate.html"}return e}();e.DvsPortTabsDetailsComponent=t;var i=function(){function e(e,t){this.$scope=e,this.i18nService=t,this.i18n=this.i18nService.getString}return e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortTabsDetailsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<",isLagOrUplink:"<",disableNetworkResourcePool:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/ports/edit/components/dvsPortEditPropertiesPageComponentTemplate.html"}return e}();e.DvsPortEditPropertiesPage=t;var i=function(){function e(e,t,i){this.$scope=e,this.i18nService=t,this.dvsPortEditPropertiesPageValidator=i,this.i18n=this.i18nService.getString,this.nameValidator={message:null,isVisible:!1},this.descriptionValidator={message:null,isVisible:!1}}return e.prototype.$onInit=function(){var e=this;this.pageModel.networkResourcePools&&this.pageModel.networkResourcePools.length&&(this.resourcePoolOptions=[],_.forEach(this.pageModel.networkResourcePools,function(t){e.resourcePoolOptions.push({label:t.name,val:t.key})}))},e.prototype.onNameChange=function(){var e="";this.pageModel.name&&(e=this.dvsPortEditPropertiesPageValidator.getNameError(this.pageModel.name)),this.nameValidator.message=e,this.nameValidator.isVisible=!!e},e.prototype.onDescriptionChange=function(){var e="";this.pageModel.description&&(e=this.dvsPortEditPropertiesPageValidator.getDescriptionError(this.pageModel.description)),this.descriptionValidator.message=e,this.descriptionValidator.isVisible=!!e},e.$inject=["$scope","i18nService","dvsPortEditPropertiesPageValidator"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortEditPropertiesPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.EDIT_OPERATION="edit",e.DATA_DVS_PROPERTY="dvsports:portEditData",e.DATA_DVS_VLAN_TRUNK_PROPERTY="dvsport:vlanTrunkRanges",e.DATA_DVPG_PROPERTY="dvportgroupport:portEditData",e.POLICY_ALLOW_PROMISCUOUS="allowPromiscuous",e.POLICY_MAC_CHANGES="macChanges",e.POLICY_FORGET_TRANSMITS="forgedTransmits",e.NAME_MAX_BYTE_LENGTH=80,e.DESCRIPTION_MAX_CHAR_LENGTH=255,e}();e.DvsPortEditDialogConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.dvsPortEditVlanPageValidator=t,this.dvsPortEditPropertiesPageValidator=i,this.dvpgTrafficShapingPolicyService=r,this.dvpgFailoverPolicyPageService=n,this.vuiConstants=o}return e.prototype.createPages=function(e){var t=[],i={title:this.i18nService.getString("NetworkUi","port.properties.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditPropertiesPage.html",onCommit:this.buildPropertiesPageCommitCallback(e)},r={title:this.i18nService.getString("NetworkUi","dvpg.policy.security.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditSecurityPage.html",onCommit:function(){return!0}},n={title:this.i18nService.getString("NetworkUi","dvpg.policy.vlan.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditVlanPage.html",onCommit:this.buildVlanPageCommitCallback(e)},o={title:this.i18nService.getString("NetworkUi","dvpg.policy.shaping.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditTrafficShapingPage.html",onCommit:this.buildTrafficShapingPageCommitCallback(e)},a={title:this.i18nService.getString("NetworkUi","dvpg.policy.failover.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditFailoverPage.html",onCommit:this.buildTeamingAndFailoverCommitCallback(e)},s={title:this.i18nService.getString("NetworkUi","dvpg.policy.monitoring.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditMonitoringPage.html",onCommit:function(){return!0}},c={title:this.i18nService.getString("NetworkUi","dvpg.policy.misc.title"),contentUrl:"dvs-ui/resources/dvs/ports/edit/views/dvsPortEditMiscellaneousPage.html",onCommit:function(){return!0}};return t.push(i),t.push(n),e.model.isUplink||(t.splice(1,0,r,o),t.push(a)),e.model.monitoringPage&&e.model.monitoringPage.monitoringPolicy&&e.model.monitoringPage.monitoringPolicy.ipfixSupported&&t.push(s),t.push(c),t},e.prototype.buildPropertiesPageCommitCallback=function(e){var t=this;return function(){if(!e.model.propertiesPage)return!0;var i=t.dvsPortEditPropertiesPageValidator.getErrors(e.model.propertiesPage);return!(i&&i.length>0)||(t.showDialogErrors(e,i),!1)}},e.prototype.buildVlanPageCommitCallback=function(e){var t=this;return function(){return!(e.model.vlanPage&&e.model.vlanPage.overrideOptions&&e.model.vlanPage.overrideOptions.overrideVlan)||t.dvsPortEditVlanPageValidator.getValidationError(e.model.portDvsUrn,e.model.vlanPage.vlanPolicy).then(function(i){return!(i&&i.length>0)||(t.showDialogErrors(e,i),!1)})}},e.prototype.buildTrafficShapingPageCommitCallback=function(e){var t=this;return function(){if(!e.model.trafficShapingPage||e.model.trafficShapingPage.shouldSkipValidation())return!0;var i=t.dvpgTrafficShapingPolicyService.getErrorMessages(e.model.trafficShapingPage.trafficShapingPolicy.inShapingPolicy,e.model.trafficShapingPage.trafficShapingPolicy.outShapingPolicy);return!(i&&i.length>0)||(t.showDialogErrors(e,i),!1)}},e.prototype.buildTeamingAndFailoverCommitCallback=function(e){var t=this;return function(){return!(e.model.failoverPolicyPage&&!e.model.failoverPolicyPage.shouldSkipValidation())||(!t.dvpgFailoverPolicyPageService.shouldShowErrorWarningDialog(e.model.failoverPolicyPage.failoverOrder.connectees,e.model.failoverPolicyPage.failoverPolicy.loadBalancing,e.model.failoverPolicyPage.failoverPolicy.beaconProbing,e.model.failoverPolicyPage.overrideOptions)||t.dvpgFailoverPolicyPageService.showErrorWarningDialog(e.model.failoverPolicyPage.failoverOrder.connectees,e.model.failoverPolicyPage.failoverPolicy.loadBalancing,e.model.failoverPolicyPage.failoverPolicy.beaconProbing,e.model.failoverPolicyPage.overrideOptions))}},e.prototype.showDialogErrors=function(e,t){var i=this;e.dialogOptions.validationBanner.messages=_.map(t,function(e){return{type:i.vuiConstants.validationBanner.type.ERROR,text:e}})},e.$inject=["i18nService","dvsPortEditVlanPageValidator","dvsPortEditPropertiesPageValidator","dvpgTrafficShapingPolicyService","dvpgFailoverPolicyPageService","vuiConstants"],e}();e.DvsPortEditDialogPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortEditDialogPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c){this.$rootScope=e,this.vxMultiPageDialogService=t,this.i18nService=i,this.dataService=r,this.mutationService=n,this.dvsPortEditDialogPages=o,this.defaultUriSchemeUtil=a,this.dvsPortEditDialogSpecFactory=s,this.dvpgFailoverPolicyPageService=c}return t.prototype.show=function(t,i,r,n){var o=this,a=this.$rootScope.$new();a.portContextUrn=t,a.isPortgoupContext=r,a.selectedPort=i,a.model=new e.DvsPortEditDialogModel,a.model.portId=i.portId,a.dialogOptions=this.createDialogOptions(),a.dialogOptions.confirmOptions={onClick:function(){return o.submitDialog(a.model,a.initialModel),!0}};var s={scope:a,configObjectName:"dialogOptions"};this.vxMultiPageDialogService(s),this.requestData(a,n)},t.prototype.requestData=function(t,i){var r,n=this,o=t.isPortgoupContext?e.DvsPortEditDialogConstants.DATA_DVPG_PROPERTY:e.DvsPortEditDialogConstants.DATA_DVS_PROPERTY;r=t.isPortgoupContext?this.dataService.getProperties(t.portContextUrn,[o],{propertyParams:[{propertyName:o,parameterType:"java.util.Map",parameter:{dSwitchUri:i,portId:t.selectedPort.portId}}]}):this.dataService.getProperties(t.portContextUrn,[o],{propertyParams:[{propertyName:o,parameterType:"java.util.Map",parameter:{portgroupKey:t.selectedPort.portgroupKey,portId:t.selectedPort.portId}}]}),r.then(function(i){if(i&&i[o]){var r=i[o];t.initialModel=angular.copy(r),t.model.propertiesPage=new e.DvsPortEditPropertiesPageModel(r.properties),t.model.portDvsUrn=n.defaultUriSchemeUtil.getVsphereObjectId(r.switchRef),t.model.isUplink=r.isUplink,t.model.isLag=r.isLag,t.model.configVersion=r.configVersion,t.model.securityPage=new e.DvsPortEditSecurityPageModel(r.securityPolicy),t.model.vlanPage=new e.DvsPortEditVlanPageModel(r.vlanPolicy),t.model.trafficShapingPage=new e.DvsPortEditTrafficShapingPageModel(r.trafficShapingPolicy),t.model.failoverPolicyPage=n.assignFailoverPolicies(r.failoverPolicy),t.model.monitoringPage=new e.DvsPortEditMonitoringPageModel(r.monitoringPolicy),t.model.miscellaneousPage=new e.DvsPortEditMiscellaneousPageModel(r.miscPolicy),t.model.dvPortgroupPortProperties=r.dvPortgroupPortProperties,t.dialogOptions.title=n.i18nService.getString("NetworkUi","port.settings.title",t.selectedPort.portId,r.switchName),t.dialogOptions.pages=n.dvsPortEditDialogPages.createPages(t),t.dialogOptions.loading=!1}})},t.prototype.assignFailoverPolicies=function(t){if(!t)return null;var i=this.dvpgFailoverPolicyPageService.createFailoverOrderSettings(t.failoverOrder);return new e.DvsPortEditFailoverPageModel(t,i)},t.prototype.createDialogOptions=function(){return{title:this.i18nService.getString("NetworkUi","port.settings.initialTitle"),show:!0,loading:!0,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,height:"640px",width:"960px",maximizable:!0}},t.prototype.submitDialog=function(e,t){var i=this.dvsPortEditDialogSpecFactory.buildSpec(e,t);i&&this.mutationService.apply(e.portDvsUrn,i._type,i)},t.$inject=["$rootScope","vxMultiPageDialogService","i18nService","dataService","mutationService","dvsPortEditDialogPages","defaultUriSchemeUtil","dvsPortEditDialogSpecFactory","dvpgFailoverPolicyPageService"],t}();e.DvsPortEditDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortEditDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vim.binding.vim.dvs.DistributedVirtualPort$ConfigSpec,i=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$VmwarePortConfigPolicy,r=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$SecurityPolicy,n=com.vmware.vim.binding.vim.BoolPolicy,o=com.vmware.vim.binding.vim.StringPolicy,a=function(){function a(e,t){this.i18nService=e,this.dvpgSpecFactory=t}return a.prototype.buildSpec=function(r,n){if(!n||!r||!r.dvPortgroupPortProperties)return null;var o=r.propertiesPage&&r.propertiesPage.isPropertiesPageChanged(n.properties),a=r.securityPage&&!r.isUplink&&r.dvPortgroupPortProperties.securityPolicyOverrideAllowed&&r.securityPage.isSecurityPageChanged(n.securityPolicy),s=r.vlanPage&&r.dvPortgroupPortProperties.vlanOverrideAllowed&&r.vlanPage.isVlanPageChanged(n.vlanPolicy),c=r.trafficShapingPage&&r.dvPortgroupPortProperties.shapingOverrideAllowed&&r.trafficShapingPage.isTrafficShapingPageChanged(n.trafficShapingPolicy),l=r.failoverPolicyPage&&r.dvPortgroupPortProperties.uplinkTeamingOverrideAllowed&&r.failoverPolicyPage.isFailoverPageChanged(n.failoverPolicy),d=r.monitoringPage&&r.dvPortgroupPortProperties.ipfixOverrideAllowed&&r.monitoringPage.isMonitoringPageChanged(n.monitoringPolicy),u=r.miscellaneousPage&&r.dvPortgroupPortProperties.blockOverrideAllowed&&r.miscellaneousPage.isMiscellaneousPageChanged(n.miscPolicy),p=r.propertiesPage&&r.dvPortgroupPortProperties.networkResourcePoolOverrideAllowed&&r.propertiesPage.isResourcePoolChanged(n.properties),v=a||s||c||l||d||u||p;if(!o&&!v)return null;var m=new t;m.key=r.portId,m.configVersion=r.configVersion,m.operation=e.DvsPortEditDialogConstants.EDIT_OPERATION,o&&(r.propertiesPage.name!==n.properties.name&&(m.name=r.propertiesPage.name),r.propertiesPage.description!==n.properties.description&&(m.description=r.propertiesPage.description));var g=new i;return p&&(g.networkResourcePoolKey=this.buildNetworkResourcePoolPolicy(r.propertiesPage.selectedResourcePool)),a&&(g.securityPolicy=this.buildSecurityPolicy(n.securityPolicy,r)),s&&(g.vlan=this.buildVlanPolicy(r.vlanPage)),c&&r.trafficShapingPage.trafficShapingPolicy&&r.trafficShapingPage.overrideOptions&&(g.inShapingPolicy=this.dvpgSpecFactory.buildTrafficShapingSpecPort(r.trafficShapingPage.trafficShapingPolicy.inShapingPolicy,!r.trafficShapingPage.overrideOptions.inShapingPolicy),g.outShapingPolicy=this.dvpgSpecFactory.buildTrafficShapingSpecPort(r.trafficShapingPage.trafficShapingPolicy.outShapingPolicy,!r.trafficShapingPage.overrideOptions.outShapingPolicy)),l&&(g.uplinkTeamingPolicy=this.dvpgSpecFactory.buildTeamingAndFailoverPortSpec(r.failoverPolicyPage.failoverPolicy,r.failoverPolicyPage.overrideOptions)),d&&(g.ipfixEnabled=this.buildBoolPolicy(r.monitoringPage.monitoringPolicy.ipfixEnabled,r.monitoringPage.monitoringPolicy.ipfixOverrided)),u&&(g.blocked=this.buildBoolPolicy(r.miscellaneousPage.policy.arePortsBlocked,r.miscellaneousPage.policy.blockPortsOverrided)),v&&(m.setting=g),m},a.prototype.buildNetworkResourcePoolPolicy=function(e){var t=new o;return t.value=e.key,t.inherited=!e.overrided,t},a.prototype.buildSecurityPolicy=function(t,i){var n=new r;return n.inherited=i.securityPage.isInherited(),i.securityPage.policyValues&&i.securityPage.overrideOptions&&(i.securityPage.isPolicyChanged(t.allowPromiscuous,e.DvsPortEditDialogConstants.POLICY_ALLOW_PROMISCUOUS)&&(n.allowPromiscuous=this.buildBoolPolicy(i.securityPage.policyValues.allowPromiscuous,i.securityPage.overrideOptions.allowPromiscuous)),i.securityPage.isPolicyChanged(t.macChanges,e.DvsPortEditDialogConstants.POLICY_MAC_CHANGES)&&(n.macChanges=this.buildBoolPolicy(i.securityPage.policyValues.macChanges,i.securityPage.overrideOptions.macChanges)),i.securityPage.isPolicyChanged(t.forgedTransmits,e.DvsPortEditDialogConstants.POLICY_FORGET_TRANSMITS)&&(n.forgedTransmits=this.buildBoolPolicy(i.securityPage.policyValues.forgedTransmits,i.securityPage.overrideOptions.forgedTransmits))),n},a.prototype.buildVlanPolicy=function(e){var t=this.dvpgSpecFactory.buildVlanSpec(e.vlanPolicy);return t.inherited=e.overrideOptions&&!e.overrideOptions.overrideVlan,t},a.prototype.buildBoolPolicy=function(e,t){var i=new n;return i.inherited=!t,i.value=e,i},a.$inject=["i18nService","dvpgSpecFactory"],a}();e.DvsPortEditDialogSpecFactory=a,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortEditDialogSpecFactory",a)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e}();e.DvsPortEditDialogModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){e&&t&&(this.failoverPolicy=e,this.failoverOrder=t,this.overrideOptions=e.overrideOptions,this.isFailoverPageChanged=this.isFailoverPageChangedFunction.bind(this),this.shouldSkipValidation=this.shouldSkipValidationFunction.bind(this))}return e.prototype.isFailoverPageChangedFunction=function(e){return!!(e&&this.overrideOptions&&this.failoverPolicy)&&(!_.isEqual(e.overrideOptions,this.overrideOptions)||!_.isEqual(e,this.failoverPolicy))},e.prototype.shouldSkipValidationFunction=function(){if(!this.overrideOptions)return!0;for(var e in this.overrideOptions)if(this.overrideOptions[e])return!1;return!0},e}();e.DvsPortEditFailoverPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){e&&(this.policy=e,this.isMiscellaneousPageChanged=this.isMiscellaneousPageChangedFunction.bind(this))}return e.prototype.isMiscellaneousPageChangedFunction=function(e){return!(!e||!this.policy)&&(e.blockPortsOverrided!==this.policy.blockPortsOverrided||e.arePortsBlocked!==this.policy.arePortsBlocked)},e}();e.DvsPortEditMiscellaneousPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){e&&(this.monitoringPolicy=e,this.isMonitoringPageChanged=this.isMonitoringPageChangedFunction.bind(this))}return e.prototype.isMonitoringPageChangedFunction=function(e){return!(!e||!this.monitoringPolicy)&&(e.ipfixOverrided!==this.monitoringPolicy.ipfixOverrided||e.ipfixEnabled!==this.monitoringPolicy.ipfixEnabled)},e}();e.DvsPortEditMonitoringPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){e&&(this.name=e.name,this.description=e.description,e.networkResourcePools&&e.networkResourcePools.length&&(this.selectedResourcePool=e.selectedResourcePool,this.networkResourcePools=e.networkResourcePools),this.isPropertiesPageChanged=this.isPropertiesPageChangedFunction.bind(this),this.isResourcePoolChanged=this.isResourcePoolChangedFunction.bind(this))}return e.prototype.isResourcePoolChangedFunction=function(e){return!(!e||!this.selectedResourcePool)&&!_.isEqual(this.selectedResourcePool,e.selectedResourcePool)},e.prototype.isPropertiesPageChangedFunction=function(e){return!!e&&(this.name!==e.name||this.description!==e.description)},e}();e.DvsPortEditPropertiesPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e){e&&(this.overrideOptions=_.mapObject(e,function(e){return!e.inherited}),this.policyValues=_.mapObject(e,function(e){return e.value}),this.isInherited=this.isInheritedFunction.bind(this),this.isSecurityPageChanged=this.isSecurityPageChangedFunction.bind(this),this.isPolicyChanged=this.isPolicyChangedFunction.bind(this))}return t.prototype.isInheritedFunction=function(){return!this.overrideOptions||!this.overrideOptions.macChanges&&!this.overrideOptions.allowPromiscuous&&!this.overrideOptions.forgedTransmits},t.prototype.isSecurityPageChangedFunction=function(t){return!!t&&(this.isPolicyChanged(t.allowPromiscuous,e.DvsPortEditDialogConstants.POLICY_ALLOW_PROMISCUOUS)||this.isPolicyChanged(t.macChanges,e.DvsPortEditDialogConstants.POLICY_MAC_CHANGES)||this.isPolicyChanged(t.forgedTransmits,e.DvsPortEditDialogConstants.POLICY_FORGET_TRANSMITS))},t.prototype.isPolicyChangedFunction=function(t,i){if(!t||!this.overrideOptions||!this.policyValues)return!1;switch(i){case e.DvsPortEditDialogConstants.POLICY_ALLOW_PROMISCUOUS:return this.overrideOptions.allowPromiscuous===t.inherited||this.policyValues.allowPromiscuous!==t.value;case e.DvsPortEditDialogConstants.POLICY_FORGET_TRANSMITS:return this.overrideOptions.forgedTransmits===t.inherited||this.policyValues.forgedTransmits!==t.value;case e.DvsPortEditDialogConstants.POLICY_MAC_CHANGES:return this.overrideOptions.macChanges===t.inherited||this.policyValues.macChanges!==t.value}return!1},t}();e.DvsPortEditSecurityPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){e&&(this.trafficShapingPolicy=e,this.overrideOptions={inShapingPolicy:e.inShapingOverrided,outShapingPolicy:e.outShapingOverrided},this.isTrafficShapingPageChanged=this.isTrafficShapingPageChangedFunction.bind(this),this.shouldSkipValidation=this.shouldSkipValidationFunction.bind(this))}return e.prototype.isTrafficShapingPageChangedFunction=function(e){return!!e&&(e.inShapingOverrided!==this.overrideOptions.inShapingPolicy||e.outShapingOverrided!==this.overrideOptions.outShapingPolicy||!_.isEqual(e,this.trafficShapingPolicy))},e.prototype.shouldSkipValidationFunction=function(){return!this.overrideOptions||!this.trafficShapingPolicy||!this.overrideOptions.inShapingPolicy&&!this.overrideOptions.outShapingPolicy},e}();e.DvsPortEditTrafficShapingPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){e&&(this.vlanPolicy=e,this.overrideOptions={overrideVlan:e.isVlanPolicyOverrided},this.isVlanPageChanged=this.isVlanPageChangedFunction.bind(this))}return e.prototype.isVlanPageChangedFunction=function(e){return!!e&&(e.isVlanPolicyOverrided!==this.overrideOptions.overrideVlan||!_.isEqual(e,this.vlanPolicy))},e}();e.DvsPortEditVlanPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.i18nService=e,this.networkUtil=t}return t.prototype.getErrors=function(e){var t=[];if(!e)return t;var i=this.getNameError(e.name),r=this.getDescriptionError(e.description);return i&&t.push(i),r&&t.push(r),t},t.prototype.getNameError=function(t){return t&&this.networkUtil.getStringLengthInUtf8Bytes(t)>e.DvsPortEditDialogConstants.NAME_MAX_BYTE_LENGTH?this.i18nService.getString("DvsUi","portEdit.propertiesPage.name.error"):""},t.prototype.getDescriptionError=function(t){return t&&t.length>e.DvsPortEditDialogConstants.DESCRIPTION_MAX_CHAR_LENGTH?this.i18nService.getString("DvsUi","portEdit.propertiesPage.description.error"):""},t.$inject=["i18nService","networkUtil"],t}();e.DvsPortEditPropertiesPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortEditPropertiesPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortTrunkVlanSpec,i=function(){function i(e,t,i,r,n){this.$q=e,this.i18nService=t,this.networkUiConstants=i,this.dvpgPropertiesService=r,this.dataService=n}return i.prototype.getValidationError=function(i,r){var n=this;switch(r.vlanType){case this.networkUiConstants.Vlan.Type.VLAN:var o=this.dvpgPropertiesService.getVlanIdError(r.vlanId);if(o)return this.$q.resolve([o]);break;case this.networkUiConstants.Vlan.Type.TRUNK:if(!r.vlanTrunkRanges){var a=this.i18nService.getString("DvsUi","dvpg.policy.vlan.trunk.errorMessage");return this.$q.resolve([a])}var s=new t;s.numericRanges=r.vlanTrunkRanges;var c=this.dataService.getProperties(i,[e.DvsPortEditDialogConstants.DATA_DVS_VLAN_TRUNK_PROPERTY],{propertyParams:[{propertyName:e.DvsPortEditDialogConstants.DATA_DVS_VLAN_TRUNK_PROPERTY,parameterType:s._type,parameter:s}]});return c.then(function(t){if(!t||!t[e.DvsPortEditDialogConstants.DATA_DVS_VLAN_TRUNK_PROPERTY]){var i=n.i18nService.getString("DvsUi","dvpg.policy.vlan.trunk.errorMessage");return[i]}return r.vlanTrunkNumericRanges=t[e.DvsPortEditDialogConstants.DATA_DVS_VLAN_TRUNK_PROPERTY],n.$q.resolve([])},function(){return null});case this.networkUiConstants.Vlan.Type.PRIVATE:if(!r.pvlanConfig||0===r.pvlanConfig.length){var l=this.i18nService.getString("DvsUi","dvpg.policy.vlan.private.noConfig");return this.$q.resolve([l]);
}}return this.$q.resolve([])},i.$inject=["$q","i18nService","networkUiConstants","dvpgPropertiesService","dataService"],i}();e.DvsPortEditVlanPageValidator=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortEditVlanPageValidator",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedPort:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/ports/networkConnection/dvsPortNetworkConnectionViewTemplate.html"}return e}();e.DvsPortNetworkConnectionComponent=t;var i=function(){function e(e,t,i){this.$scope=e,this.i18nService=t,this.dvsPortsService=i,this.i18n=this.i18nService.getString}return e.prototype.$onChanges=function(){this.refresh(this.selectedPort)},e.prototype.refresh=function(e){this.dvsPortNetworkConnectionData=this.dvsPortsService.buildDvsPortNetworkConnectionPropertiesView(e)},e.$inject=["$scope","i18nService","dvsPortsService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortNetworkConnectionView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedPort:"<",portContextId:"<",isPortGroupContext:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/ports/policies/dvsPortPoliciesViewTemplate.html"}return e}();e.DvsPortPoliciesComponent=t;var i=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.dataService=i,this.distributedPortgroupPoliciesViewService=r,this.i18n=this.i18nService.getString}return e.prototype.$onChanges=function(){this.refresh(this.selectedPort)},e.prototype.refresh=function(t){var i=this;if(t){this.portsLoading=!0;var r,n=this.isPortGroupContext?e.DVPG_PORTS_POLICIES_DATA_PROPERTY_NAME:e.DVS_PORTS_POLICIES_DATA_PROPERTY_NAME;r=this.isPortGroupContext?this.dataService.getProperties(this.portContextId,[n],{propertyParams:[{propertyName:n,parameterType:"java.lang.String",parameter:t.portId}]}):this.dataService.getProperties(this.portContextId,[n],{propertyParams:[{propertyName:n,parameterType:"java.util.Map",parameter:{portgroupKey:t.portgroupKey,portId:t.portId}}]}),this._currentDvsPromise=r,r.then(function(e){i._currentDvsPromise===r&&e[n]&&(i.dvsPortPoliciesData=i.distributedPortgroupPoliciesViewService.buildDistributedPortPoliciesView(e[n]))})["finally"](function(){i.portsLoading=!1})}},e.DVS_PORTS_POLICIES_DATA_PROPERTY_NAME="dvsport:portPoliciesData",e.DVPG_PORTS_POLICIES_DATA_PROPERTY_NAME="dvportgroupport:portPoliciesData",e.$inject=["$scope","i18nService","dataService","distributedPortgroupPoliciesViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortPoliciesView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedPort:"<",portContextId:"<",isPortGroupContext:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/ports/statistics/dvsPortStatisticsViewTemplate.html"}return e}();e.DvsPortStatisticsComponent=t;var i=function(){function e(e,t,i,r,n){this.$scope=e,this.i18nService=t,this.dataService=i,this.vxPropertyViewService=r,this.dvsPortStatisticsService=n,this.PORT_STATISTICS_PROPERTY="dvsport:portStatisticsData",this.DVPG_PORT_STATISTICS_PROPERTY="dvpgport:portStatisticsData",this.REFRESH_PORT_STATISTICS_PROPERTY="dvsports:refreshedPortsData",this.DVPG_REFRESH_PORT_STATISTICS_PROPERTY="dvpgports:refreshedPortsData",this.REFRESH_STATISTICS_TIMEOUT=2e3,this.i18n=this.i18nService.getString,this.refreshStatistics=!1}return e.prototype.$onChanges=function(){this.refresh(this.selectedPort)},e.prototype.$onDestroy=function(){this.refreshStatistics=!1,clearTimeout(this.refreshTimeout)},e.prototype.refresh=function(e){var t=this;if(clearTimeout(this.refreshTimeout),e){this.portsLoading=!0;var i=this.isPortGroupContext?this.DVPG_PORT_STATISTICS_PROPERTY:this.PORT_STATISTICS_PROPERTY;this.dataService.getProperties(this.portContextId,[i],{propertyParams:[{propertyName:i,parameterType:"java.util.Map",parameter:{portgroupKey:e.portgroupKey,portId:e.portId}}]}).then(function(e){null!==e&&(t.dvsPortStatisticsData=t.dvsPortStatisticsService.buildDistributedPortStatisticsView(e[i])),t.refreshStatistics&&(t.refreshTimeout=setTimeout(t.enableRefreshStatistics(),t.REFRESH_STATISTICS_TIMEOUT))})["finally"](function(){t.portsLoading=!1})}},e.prototype.enableRefreshStatistics=function(){var e=this;if(this.refreshStatistics){var t=this.isPortGroupContext?this.DVPG_REFRESH_PORT_STATISTICS_PROPERTY:this.REFRESH_PORT_STATISTICS_PROPERTY;this.dataService.getProperties(this.portContextId,[t],{propertyParams:[{propertyName:t,parameterType:"java.util.Map",parameter:{portgroupKey:this.selectedPort.portgroupKey,portId:this.selectedPort.portId}}]}).then(function(i){null!==i&&(i[t].isErrorFound?e.refreshStatistics=!1:(e.dvsPortStatisticsData=e.dvsPortStatisticsService.buildDistributedPortStatisticsView(i[t]),e.refreshTimeout=setTimeout(function(){return e.enableRefreshStatistics()},e.REFRESH_STATISTICS_TIMEOUT)))})}else clearTimeout(this.refreshTimeout)},e.$inject=["$scope","i18nService","dataService","vxPropertyViewService","dvsPortStatisticsService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPortStatisticsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.vxPropertyViewService=t,this.browserLanguage=i}return e.prototype.buildDistributedPortStatisticsView=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("statistics"),r=i.section("statistics").title(this.i18nService.getString("DvsUi","PortList.statistics.title"));return e&&(r.property(this.i18nService.getString("DvsUi","PortList.bytesInUnicastHeaderText"),e.bytesInUnicast),r.property(this.i18nService.getString("DvsUi","PortList.bytesOutUnicastHeaderText"),e.bytesOutUnicast),r.property(this.i18nService.getString("DvsUi","PortList.bytesInBroadcastHeaderText"),e.bytesInBroadcast),r.property(this.i18nService.getString("DvsUi","PortList.bytesOutBroadcastnameHeaderText"),e.bytesOutBroadcast),r.property(this.i18nService.getString("DvsUi","PortList.bytesInMulticastHeaderText"),e.bytesInMulticast),r.property(this.i18nService.getString("DvsUi","PortList.bytesOutMulticastHeaderText"),e.bytesOutMulticast),r.property(this.i18nService.getString("DvsUi","PortList.packetsInUnicastHeaderText"),this.getLocalizedPacketsValue(e.packetsInUnicast)),r.property(this.i18nService.getString("DvsUi","PortList.packetsOutUnicastHeaderText"),this.getLocalizedPacketsValue(e.packetsOutUnicast)),r.property(this.i18nService.getString("DvsUi","PortList.packetsInBroadcastHeaderText"),this.getLocalizedPacketsValue(e.packetsInBroadcast)),r.property(this.i18nService.getString("DvsUi","PortList.packetsOutBroadcastnameHeaderText"),this.getLocalizedPacketsValue(e.packetsOutBroadcast)),r.property(this.i18nService.getString("DvsUi","PortList.packetsInMulticastHeaderText"),this.getLocalizedPacketsValue(e.packetsInMulticast)),r.property(this.i18nService.getString("DvsUi","PortList.packetsOutMulticastHeaderText"),this.getLocalizedPacketsValue(e.packetsOutMulticast)),r.property(this.i18nService.getString("DvsUi","PortList.packetsInDroppedHeaderText"),this.getLocalizedPacketsValue(e.packetsInDropped)),r.property(this.i18nService.getString("DvsUi","PortList.packetsOutDroppedHeaderText"),this.getLocalizedPacketsValue(e.packetsOutDropped)),r.property(this.i18nService.getString("DvsUi","PortList.packetsInExceptionHeaderText"),this.getLocalizedPacketsValue(e.packetsInException)),r.property(this.i18nService.getString("DvsUi","PortList.packetsOutExceptionHeaderText"),this.getLocalizedPacketsValue(e.packetsOutException))),t.build()},e.prototype.getLocalizedPacketsValue=function(e){return e===-1?this.i18nService.getString("DvsUi","PortList.noData"):e.toLocaleString(this.browserLanguage.get(),{minimumFractionDigits:0,maximumFractionDigits:2})},e.$inject=["i18nService","vxPropertyViewService","browserLanguage"],e}();e.DvsPortStatisticsService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortStatisticsService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortTrafficFilterModel,i=function(){function i(e,t,i,r,n,o,a,s,c,l){this.i18nService=e,this.clarityConstants=t,this.trafficFilterConstants=i,this.dvpgTrafficFilterService=r,this.dvpgTrafficRuleValidator=n,this.dvsPortTrafficFilterSpecFactory=o,this.clarityModalService=a,this.dataService=s,this.mutationService=c,this.$q=l}return i.prototype.showPortEditTrafficFilterDialog=function(t,i,r){var n,o=this,a={title:this.i18nService.getString("DvsUi","trafficFilter.rulesDialog.title"),subTitle:{objectId:t},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/edit/dvpgEditTrafficFilterDialog.html",size:"lg",modalClass:"edit-traffic-filter-dialog",dialogData:{objectId:r.portId,model:new e.DvpgEditTrafficFilterModel},onSubmit:function(){var e=o.dvpgTrafficFilterService.isRuleOrderChanged(a.dialogData.model.rules,a.dialogData.model.originalRulesKeys),i=a.dialogData.model.initialTrafficRulesetEnabled!==a.dialogData.model.isTrafficRulesetEnabled,n=a.dialogData.model.initialIsTrafficRulesetOverwritten!==a.dialogData.model.isTrafficRulesetOverwritten;if(n||i||e){var s=o.dvsPortTrafficFilterSpecFactory.buildEditTrafficFilterSpec(r.portId,a.dialogData.model,e);o.mutationService.apply(t,o.trafficFilterConstants.spec.DVS_PORT_EDIT_TRAFFIC_RULES_SPEC,s)}return!0}},s=i?this.trafficFilterConstants.properties.DVPG_PORT_TRAFFIC_FILTER_PROPERTY:this.trafficFilterConstants.properties.DVS_PORT_TRAFFIC_FILTER_PROPERTY;n=i?this.dataService.getProperties(t,[s],{propertyParams:[{propertyName:s,parameterType:"java.lang.String",parameter:r.portId}]}):this.dataService.getProperties(t,[s],{propertyParams:[{propertyName:s,parameterType:"java.util.Map",parameter:{portgroupKey:r.portgroupKey,portId:r.portId}}]}),n.then(function(e){var t=e[s];t?(a.dialogData.model.initialTrafficRulesetEnabled=t.isTrafficRulesetEnabled,a.dialogData.model.isTrafficRulesetEnabled=t.isTrafficRulesetEnabled,a.dialogData.model.showTrafficFilterOverride=!0,a.dialogData.model.enableTrafficFilterOverride=t.isTrafficRulesetOverrideEnabled,a.dialogData.model.initialIsTrafficRulesetOverwritten=t.isTrafficRulesetOverwritten,a.dialogData.model.isTrafficRulesetOverwritten=t.isTrafficRulesetOverwritten,a.dialogData.model.rules=t.rules,a.dialogData.model.originalRulesKeys=o.dvpgTrafficFilterService.getRulesKeys(t.rules)):(a.dialogData.model.rules=[],a.dialogData.model.originalRulesKeys=[])}),this.clarityModalService.openOkCancelModal(a)},i.prototype.showPortAddRuleDialog=function(e,i,r,n){var o,a=this,s={},c={},l={title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.title"),subTitle:{objectId:e},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/add/dvpgAddTrafficRuleDialog.html",size:"lg",modalClass:"add-traffic-rule-dialog",dialogData:{availableTargets:[e],objectId:n,ipValidator:s,macValidator:c,newRuleModel:this.dvpgTrafficFilterService.initAddTrafficRuleModel(),trafficFiltersModel:new t},onSubmit:function(){return a.dvpgTrafficRuleValidator.getValidationResult(l.dialogData.newRuleModel).then(function(t){if(l.dialogData.ipValidator.validate(),l.dialogData.macValidator.validate(),_.isArray(t)&&t.length>0)return a.dvpgTrafficFilterService.showErrors(t,l),!1;if(!t)return!1;var i=a.dvsPortTrafficFilterSpecFactory.buildAddTrafficRuleSpec(n,l.dialogData.newRuleModel);return a.mutationService.apply(e,a.trafficFilterConstants.spec.DVS_PORT_ADD_TRAFFIC_RULE_SPEC,i),!0})}},d=i?this.trafficFilterConstants.properties.DVPG_PORT_TRAFFIC_FILTER_PROPERTY:this.trafficFilterConstants.properties.DVS_PORT_TRAFFIC_FILTER_PROPERTY;o=i?this.dataService.getProperties(e,[d],{propertyParams:[{propertyName:d,parameterType:"java.lang.String",parameter:n}]}):this.dataService.getProperties(e,[d],{propertyParams:[{propertyName:d,parameterType:"java.util.Map",parameter:{portgroupKey:r,portId:n}}]}),o.then(function(e){var t=e[d];t&&(l.dialogData.trafficFiltersModel=t,l.dialogData.newRuleModel.name=a.dvpgTrafficFilterService.getUniqueRuleName(t.rules))}),this.clarityModalService.openOkCancelModal(l)},i.prototype.showPortEditRuleDialog=function(e,t,i,r){var n=this,o={},a={},s={title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.editTitle"),subTitle:{objectId:e},defaultButton:"submit",contentTemplate:"dvs-ui/resources/dvs/dvpg/trafficfilter/add/dvpgEditTrafficRuleDialog.html",size:"lg",modalClass:"edit-traffic-rule-dialog",dialogData:{availableTargets:[e],objectId:i,ipValidator:o,macValidator:a,editRuleModel:this.dvpgTrafficFilterService.initNewTrafficRuleModel()},onSubmit:function(){return n.dvpgTrafficRuleValidator.getValidationResult(s.dialogData.editRuleModel).then(function(t){if(s.dialogData.ipValidator.validate(),s.dialogData.macValidator.validate(),_.isArray(t)&&t.length>0)return n.dvpgTrafficFilterService.showErrors(t,s),!1;if(!t)return!1;var r=n.dvsPortTrafficFilterSpecFactory.buildEditTrafficRuleSpec(i,s.dialogData.editRuleModel);return n.mutationService.apply(e,n.trafficFilterConstants.spec.DVS_PORT_EDIT_TRAFFIC_RULE_SPEC,r),!0})}},c=t?this.trafficFilterConstants.properties.DVPG_PORT_EDIT_TRAFFIC_FILTER_PROPERTY:this.trafficFilterConstants.properties.DVS_PORT_EDIT_TRAFFIC_FILTER_PROPERTY,l=this.dataService.getProperties(e,[c],{propertyParams:[{propertyName:c,parameterType:"java.util.Map",parameter:{ruleKey:r,portId:i}}]});l.then(function(e){var t=n.dvpgTrafficFilterService.initEditTrafficRuleModel(e[c]);s.title=n.i18nService.getString("DvsUi","trafficFilter.ruleDialog.editTitleUpdated",t.name),_.extend(t,{defaultQualifierTabIndex:n.dvpgTrafficFilterService.getDefaultQualifierTabIndex(t)}),s.dialogData.editRuleModel=t}),this.clarityModalService.openOkCancelModal(s)},i.prototype.removePortRule=function(e,t,i,r){var n=this,o=function(){var r=n.dvsPortTrafficFilterSpecFactory.buildRemoveTrafficRuleSpec(t,i);n.mutationService.apply(e,n.trafficFilterConstants.spec.DVS_PORT_REMOVE_TRAFFIC_RULE_SPEC,r)},a={title:this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.remove.caption"),message:r&&r.trim().length>0?this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.remove.warning",r):this.i18nService.getString("DvsUi","trafficFilter.ruleDialog.remove.noNameWarning"),submit:o,subTitle:{objectId:e},preserveNewlines:!0,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"}};this.clarityModalService.openConfirmationModal(a)},i.$inject=["i18nService","clarityConstants","dvpgTrafficFilterConstants","dvpgTrafficFilterService","dvpgTrafficRuleValidator","dvsPortTrafficFilterSpecFactory","clarityModalService","dataService","mutationService","$q"],i}();e.DvsPortTrafficFilterService=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortTrafficFilterService",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvportgroup.trafficfilter.DvpgEditRuleSequenceSpec,i=com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortEditTrafficFilterSpec,r=com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortAddTrafficRuleSpec,n=com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortEditTrafficRuleSpec,o=com.vmware.vsphere.client.h5.network.dvs.ports.model.DvsPortRemoveTrafficRuleSpec,a=function(){function e(){}return e.prototype.buildEditTrafficFilterSpec=function(e,r,n){var o=new i;if(o.isTrafficRulesetEnabled=r.isTrafficRulesetEnabled,o.isTrafficRulesetOverwritten=r.isTrafficRulesetOverwritten,o.portKey=e,n){var a=[];r.rules.forEach(function(e){var i=new t;i.ruleKey=e.key,i.sequence=e.sequence,a.push(i)}),o.rules=a}return o},e.prototype.buildAddTrafficRuleSpec=function(e,t){var i=new r;return i.portKey=e,i.newRule=t,i},e.prototype.buildEditTrafficRuleSpec=function(e,t){var i=new n;return i.portKey=e,i.editedRule=t,i},e.prototype.buildRemoveTrafficRuleSpec=function(e,t){var i=new o;return i.portKey=e,i.ruleKey=t,i},e.$inject=[],e}();e.DvsPortTrafficFilterSpecFactory=a,angular.module("com.vmware.vsphere.client.dvs").service("dvsPortTrafficFilterSpecFactory",a)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={selectedPort:"<",portContextId:"<",isPortGroupContext:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/ports/trafficfilter/dvsPortTrafficFilterViewTemplate.html"}return e}();e.DvsPortTrafficFilterViewComponent=t;var i=function(){function e(e,t,i,r,n,o){this.dataService=e,this.i18nService=t,this.actionsService=i,this.dvpgTrafficFilterService=r,this.dvsPortTrafficFilterService=n,this.dvpgTrafficFilterConstants=o,this.isTrafficFilterEnabled=!1,this.liveRefreshProperties=["config.defaultPortConfig.filterPolicy","config.defaultPortConfig.filterPolicy.filterConfig"],this.trafficFilterSettingsTitle=this.i18nService.getString("DvsUi","dvpg.trafficFilter.title.disabled"),this.enableAndReorderActionLabel=this.i18nService.getString("DvsUi","actionEditTrafficFiltersLabel")}return e.prototype.$onChanges=function(){this.refresh(this.selectedPort)},e.prototype.invokeEnableAndReorderAction=function(){var e=this;this.actionsService.getAction("vsphere.core.dvs.trafficFilters.editPortRulesAction",[this.portContextId]).then(function(t){var i={};i.isPortGroupContext=e.isPortGroupContext,i.selectedPort=e.selectedPort,e.actionsService.invokeAction(t,i)})},e.prototype.refresh=function(e){var t=this;if(e){this.isLoading=!0;var i,r=this.isPortGroupContext?this.dvpgTrafficFilterConstants.properties.DVPG_PORT_TRAFFIC_FILTER_PROPERTY:this.dvpgTrafficFilterConstants.properties.DVS_PORT_TRAFFIC_FILTER_PROPERTY;i=this.isPortGroupContext?this.dataService.getProperties(this.portContextId,[r],{propertyParams:[{propertyName:r,parameterType:"java.lang.String",parameter:e.portId}]}):this.dataService.getProperties(this.portContextId,[r],{propertyParams:[{propertyName:r,parameterType:"java.util.Map",parameter:{portgroupKey:e.portgroupKey,portId:e.portId}}]}),i.then(function(e){var i=e[r];i?(t.isTrafficFilterEnabled=i.isTrafficRulesetOverrideEnabled&&i.isTrafficRulesetOverwritten,t.dvpgTrafficFilterService.areRulesChanged(t.trafficFilterRules,i.rules)&&(t.trafficFilterRules=i.rules),t.trafficFilterSettingsTitle=i.isTrafficRulesetEnabled?t.i18nService.getString("DvsUi","dvpg.trafficFilter.title.enabled"):t.i18nService.getString("DvsUi","dvpg.trafficFilter.title.disabled")):t.trafficFilterRules=[]})["finally"](function(){t.isLoading=!1})}},e.prototype.onAddRule=function(){this.dvsPortTrafficFilterService.showPortAddRuleDialog(this.portContextId,this.isPortGroupContext,this.selectedPort.portgroupKey,this.selectedPort.portId)},e.prototype.onEditRule=function(e){this.dvsPortTrafficFilterService.showPortEditRuleDialog(this.portContextId,this.isPortGroupContext,this.selectedPort.portId,e.key)},e.prototype.onRemoveRule=function(e){this.dvsPortTrafficFilterService.removePortRule(this.portContextId,this.selectedPort.portId,e.key,e.name)},e.$inject=["dataService","i18nService","actionsService","dvpgTrafficFilterService","dvsPortTrafficFilterService","dvpgTrafficFilterConstants"],e}();e.DvsPortTrafficFilterViewController=i,angular.module("com.vmware.vsphere.client.dvs").component("dvsPortTrafficFilterView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.HOST_CONFIG_NETWORK="Host.Config.Network",e}();e.Privileges=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.pvlan.model.DvsPvlanData,i=function(){function e(){this.bindings={},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/pvlan/dvsPvlanViewTemplate.html"}return e}();e.DvsPvlanViewComponent=i;var r=function(){function e(e,t,i,r,n){var o=this;this.$rootScope=e,this.$scope=t,this.i18nService=i,this.dataService=r,this.dvsPvlanViewService=n,this.dvsPvlanLoading=!1,this.$scope.preselectComparator=function(e){return e.secondaryVlanId===o._selectedItemSecondaryId},this.settingsViewHeaderAccessor={},this.actions=[{actionUid:"vsphere.core.dvs.editPvlan",customLabel:this.i18nService.getString("DvsUi","dvs.pvlanView.edit.label")}]}return e.prototype.$onInit=function(){this.refresh()},Object.defineProperty(e.prototype,"title",{get:function(){return this.i18nService.getString("DvsUi","dvs.pvlanView.title")},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){var e=this;this.dvsPvlanLoading=!0,this.dvsUri=this.$rootScope._route.objectId;var i=this.dataService.getData(this.dvsUri,(new t)._type);this._selectedDistributedSwitchPromise=i,i.then(function(t){if(e._selectedDistributedSwitchPromise===i){var r=t&&t.pvlans||[],n=e.dvsPvlanViewService.formatPvlanEntries(r);e.datagridOptions?(e.datagridOptions.data=n,e._ignoreNextItemSelection=!0):e.datagridOptions=e.dvsPvlanViewService.createPvlanDatagridOptions(n,e.onSelectionChange.bind(e))}e.dvsPvlanLoading=!1},function(t){e.dvsPvlanLoading=!1}),this.liveRefreshProperties=["config.pvlanConfig"],this.settingsViewHeaderAccessor.refresh&&this.settingsViewHeaderAccessor.refresh()},e.prototype.onSelectionChange=function(e){return this._ignoreNextItemSelection?void(this._ignoreNextItemSelection=!1):void(e&&e.length>0?this._selectedItemSecondaryId=e[0].secondaryVlanId:this._selectedItemSecondaryId=-1)},e.$inject=["$rootScope","$scope","i18nService","dataService","dvsPvlanViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsPvlanView",new i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.vuiConstants=e,this.i18nService=t,this.i18n=this.i18nService.getString}return t.prototype.formatPvlanEntries=function(e){var t=this;void 0!==e&&null!==e&&e.length>0&&e.map(function(e){e.pvlanType=t.localizePvlanType(e)});var i=_.sortBy(e,function(e){return e.secondaryVlanId});return _.sortBy(i,function(e){return e.primaryVlanId})},t.prototype.createPvlanDatagridOptions=function(e,t){return{columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:e,resizable:!0,height:"100%",onChange:t}},t.prototype.createColumnDefinitions=function(){return[{displayName:this.i18n("NetworkUi","PrivateVlanView.list.primary.header"),field:"primaryVlanId",type:"number",sortable:!0,width:"50px"},{displayName:this.i18n("NetworkUi","PrivateVlanView.list.secondary.header"),field:"secondaryVlanId",type:"number",sortable:!0,width:"50px"},{displayName:this.i18n("NetworkUi","PrivateVlanView.list.type.header"),field:"pvlanType",type:"string",sortable:!0,width:"200px"}]},t.prototype.localizePvlanType=function(t){return t.pvlanType!==e.PvlanType.promiscuous&&t.pvlanType!==e.PvlanType.isolated&&t.pvlanType!==e.PvlanType.community?"":this.i18n("DvsUi","PrivateVlanPage.type."+t.pvlanType)},t.$inject=["vuiConstants","i18nService"],t}();e.DvsPvlanViewService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsPvlanViewService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/pvlan/edit/dvsEditPvlanDialogTemplate.html"}return e}();e.DvsEditPvlanDialogComponent=t;var i=function(){function t(e,t,i,r){var n=this;this.dvsEditPvlanDialogService=e,this.vuiConstants=t,this.i18nService=i,this.$scope=r,this.i18n=this.i18nService.getString,this.$scope.primaryPreselectComparator=function(e){return n.selectedPrimaryIdKey===e.primaryId.key},this.$scope.secondaryPreselectComparator=function(e){return n.selectedSecondaryIdKey===e.secondaryId.key},this.primaryDatagridCallbacks={selectPrimaryIdRow:this.selectPrimaryIdRow.bind(this),updatePvlanIdValue:this.onPrimaryPvlanIdChange.bind(this),addPromiscuousPvlanMap:this.addPromiscuousPvlanMap.bind(this),removePrimaryVlanId:this.removePrimaryVlanId.bind(this),validateDuplicatePvlanMaps:this.validateDuplicatePrimaryPvlanMaps.bind(this)},this.secondaryDatagridCallbacks={selectSecondaryIdRow:this.selectSecondaryIdRow.bind(this),updatePvlanType:this.updatePvlanType.bind(this),updatePvlanIdValue:this.onSecondaryPvlanIdChange.bind(this),addCommunityPvlanMap:this.addCommunityPvlanMap.bind(this),removeSecondaryVlanId:this.removeSecondaryVlanId.bind(this),validateDuplicatePvlanMaps:this.validateDuplicateSecondaryPvlanMaps.bind(this)},this.valueToBeUsedForNewPvlan=[]}return t.prototype.$onInit=function(){var e=this;this.primaryDatagridDescription=this.i18n("DvsUi","PrivateVlanView.list.primary.header"),this.primaryDatagridOptions=this.dvsEditPvlanDialogService.createPrimaryVlanIdDatagridOptions(this.pageModel.pvlanMaps,this.primaryDatagridCallbacks);var t=this.primaryDatagridOptions.data;_.forEach(t,function(t){var i=e.dvsEditPvlanDialogService.filterPvlanMapsByPrimaryId(e.pageModel.pvlanMaps,t.primaryId.key);e.pageModel.updateIsolatedError(t.primaryId.key,i)})},t.prototype.removePrimaryVlanId=function(){var e=this;if(this.primaryDatagridOptions.selectedItems.length>0){var t=this.primaryDatagridOptions.selectedItems.slice();_.forEach(t,function(t){var i=e.dvsEditPvlanDialogService.filterPvlanMapsByPrimaryId(e.pageModel.pvlanMaps,t.primaryId.key);_.forEach(i,function(t){delete e.pageModel.pvlanMaps[t.secondaryId.key],delete e.pageModel.pvlanIds[t.secondaryId.key],e.removeValueToBeUsedForNewPvlan(t.secondaryId.key)}),e.primaryDatagridOptions.data=e.dvsEditPvlanDialogService.removePvlanIdFromData(e.primaryDatagridOptions.data,t)}),this.lastEditedPrimaryVlan=null}},t.prototype.addPromiscuousPvlanMap=function(){var t=this.addNewPvlanMap(e.PvlanType.promiscuous);this.selectedPrimaryIdKey=t.primaryId.key,this.primaryDatagridOptions.data=this.primaryDatagridOptions.data.concat(t)},t.prototype.removeSecondaryVlanId=function(){var e=this;if(this.primaryDatagridOptions.selectedItems.length>0&&this.secondaryDatagridOptions.selectedItems.length>0){var t=this.secondaryDatagridOptions.selectedItems.slice();_.forEach(t,function(t){var i=t.secondaryId.key;delete e.pageModel.pvlanMaps[i],delete e.pageModel.pvlanIds[i],e.removeValueToBeUsedForNewPvlan(i),e.secondaryDatagridOptions.data=e.dvsEditPvlanDialogService.removePvlanIdFromData(e.secondaryDatagridOptions.data,t),e.pageModel.updateIsolatedError(e.selectedPrimaryIdKey,e.secondaryDatagridOptions.data),e.lastEditedSecondaryVlan=null})}},t.prototype.addCommunityPvlanMap=function(){var t=this.pageModel.pvlanIds[this.primaryDatagridOptions.selectedItems[0].primaryId.key],i=this.addNewPvlanMap(e.PvlanType.community,t);this.selectedSecondaryIdKey=i.secondaryId.key,this.secondaryDatagridOptions.data=this.secondaryDatagridOptions.data.concat(i)},t.prototype.addNewPvlanMap=function(t,i){var r=this.dvsEditPvlanDialogService.getKeys(this.pageModel.pvlanIds),n=this.dvsEditPvlanDialogService.getFirstAvailableKey(r),o=this.createNextPvlanId(n);this.pageModel.pvlanIds[o.key]=o,i||(i=o);var a=new e.PvlanMapModel(i,o,t);return this.pageModel.pvlanMaps[o.key]=a,a},t.prototype.selectPrimaryIdRow=function(e){this.pageModel.updateDuplicateError(),this.updateSelectedPrimaryIdValue(),_.isEmpty(e)?this.primaryDatagridOptions.actionBarOptions.actions[1].enabled=!1:(1===e.length&&(this.selectedPrimaryIdKey=e[0].primaryId.key,this.secondaryDatagridOptions=this.dvsEditPvlanDialogService.createSecondaryVlanIdDatagridOptions(this.pageModel.pvlanMaps,this.selectedPrimaryIdKey,this.secondaryDatagridCallbacks)),this.primaryDatagridOptions.actionBarOptions.actions[1].enabled=!0),this.selectedSecondaryIdKey=-1},t.prototype.selectSecondaryIdRow=function(e){this.pageModel.updateDuplicateError(),this.updateSelectedSecondaryIdValue(),_.isEmpty(e)?this.secondaryDatagridOptions.actionBarOptions.actions[1].enabled=!1:(this.secondaryDatagridOptions.actionBarOptions.actions[1].enabled=!this.dvsEditPvlanDialogService.hasPromiscuousPvlanMap(e),this.selectedSecondaryIdKey=e[0].secondaryId.key)},t.prototype.onPrimaryPvlanIdChange=function(e){this.pageModel.pvlanIds[e.key].val=e.val,this.lastEditedPrimaryVlan=this.primaryDatagridOptions.selectedItems[0]},t.prototype.onSecondaryPvlanIdChange=function(e){this.pageModel.pvlanIds[e.key].val=e.val,this.lastEditedSecondaryVlan=this.secondaryDatagridOptions.selectedItems[0]},t.prototype.validateDuplicatePrimaryPvlanMaps=function(){this.pageModel.updateDuplicateError(),this.updateSelectedPrimaryIdValue()},t.prototype.validateDuplicateSecondaryPvlanMaps=function(){this.pageModel.updateDuplicateError(),this.updateSelectedSecondaryIdValue()},t.prototype.updatePvlanType=function(e){this.pageModel.pvlanMaps[e.secondaryId.key].type=e.type,this.pageModel.updateIsolatedError(this.selectedPrimaryIdKey,this.secondaryDatagridOptions.data)},t.prototype.updateSelectedPrimaryIdValue=function(){this.lastEditedPrimaryVlan&&(this.lastEditedPrimaryVlan.primaryId.val=this.pageModel.pvlanIds[this.lastEditedPrimaryVlan.primaryId.key].val)},t.prototype.updateSelectedSecondaryIdValue=function(){this.lastEditedSecondaryVlan&&(this.lastEditedSecondaryVlan.secondaryId.val=this.pageModel.pvlanIds[this.lastEditedSecondaryVlan.secondaryId.key].val)},t.prototype.createNextPvlanId=function(t){var i=[];_.forEach(this.pageModel.pvlanIds,function(e){i.push(e.val)});var r=_.last(this.valueToBeUsedForNewPvlan)?_.last(this.valueToBeUsedForNewPvlan).val:0,n=this.dvsEditPvlanDialogService.getNextAvailableValue(i,r),o=new e.PvlanIdModel(t,n);return this.valueToBeUsedForNewPvlan.push(o),o},t.prototype.removeValueToBeUsedForNewPvlan=function(e){var t=_.findIndex(this.valueToBeUsedForNewPvlan,function(t){return t.key===e});t!==-1&&this.valueToBeUsedForNewPvlan.splice(t,1)},t.$inject=["dvsEditPvlanDialogService","vuiConstants","i18nService","$scope"],t}();angular.module("com.vmware.vsphere.client.dvs").component("dvsEditPvlanDialog",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.ADD="add-action",e.REMOVE="remove-action",e.PVLAN_ID_VALUE_MIN=1,e.PVLAN_ID_VALUE_MAX=4094,e}();e.DvsEditPvlanDialogConstants=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.pvlan.model.DvsEditPvlanData,i=e.DvsEditPvlanDialogConstants,r=function(){function r(e,t,i,r,n,o,a){this.dataService=e,this.mutationService=t,this.i18nService=i,this.clarityModalService=r,this.clarityConstants=n,this.vuiConstants=o,this.vimEntityEscapingService=a,this.i18n=this.i18nService.getString}return r.prototype.show=function(i){function r(){var e=this,t="";if(_.forEach(o.dialogData.pageModel.pvlanMaps,function(i){if(i.hasErrors())return void(t=e.i18n("DvsUi","PrivateVlanPage.errorSummary"))}),t)return o.alerts=[{type:this.clarityConstants.notifications.type.ERROR,text:t}],!1;var r=o.dialogData.pageModel.buildSpec();return null!==r&&this.mutationService.apply(i,r._type,r),!0}var n=this,o={title:this.i18n("DvsUi","PrivateVlanPage.titleFormat"),defaultButton:"submit",size:"lg",alerts:[],dialogData:{},contentTemplate:"dvs-ui/resources/dvs/pvlan/edit/dvsEditPvlanDialog.html",onSubmit:r.bind(this)},a=this.dataService.getData(i,(new t)._type);a.then(function(t){t&&(o.subTitle=n.vimEntityEscapingService.unescapeSpecialCharacters(t.name),o.dialogData.pageModel=new e.DvsEditPvlanDialogModel(t))}),this.clarityModalService.openOkCancelModal(o)},r.prototype.createPrimaryVlanIdDatagridOptions=function(e,t){var r=this.filterPromiscuousPvlanMaps(e);return{columnDefs:this.createPrimaryVlanIdColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],data:r,pvlanMaps:e,resizable:!0,height:"100%",onChange:t.selectPrimaryIdRow,validateDuplicatePvlanMaps:t.validateDuplicatePvlanMaps,updatePvlanIdValue:t.updatePvlanIdValue,pageConfig:{hidePager:!0},actionBarOptions:{actions:[{id:i.ADD,enabled:!0,iconClass:"vsphere-icon-toolbar-add",onClick:t.addPromiscuousPvlanMap},{id:i.REMOVE,enabled:!1,iconClass:"vsphere-icon-toolbar-remove",onClick:t.removePrimaryVlanId}]}}},r.prototype.createPrimaryVlanIdColumnDefinitions=function(){return[{width:"50px",template:this.createPrimaryValidationCellTemplate.bind(this)
},{displayName:this.i18n("DvsUi","PrivateVlanView.list.primary.header"),type:"number",field:"primaryId.val",sortable:!0,template:this.createPrimaryIdCellTemplate}]},r.prototype.createSecondaryVlanIdDatagridOptions=function(t,r,n){var o=this.filterPvlanMapsByPrimaryId(t,r),a=this.sortPvlanMaps(o);return{columnDefs:this.createSecondaryVlanIdColumnDefinitions(),data:a,sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],resizable:!0,height:"100%",onChange:n.selectSecondaryIdRow,validateDuplicatePvlanMaps:n.validateDuplicatePvlanMaps,typeOptions:[{value:e.PvlanType.isolated,label:this.i18nService.getString("DvsUi","PrivateVlanPage.type.isolated")},{value:e.PvlanType.community,label:this.i18nService.getString("DvsUi","PrivateVlanPage.type.community")}],pvlanMaps:t,pvlanMap:t[r],localizePvlanType:this.localizePvlanType.bind(this),updatePvlanIdValue:n.updatePvlanIdValue,updatePvlanType:n.updatePvlanType,pageConfig:{hidePager:!0},actionBarOptions:{actions:[{id:i.ADD,enabled:!0,iconClass:"vsphere-icon-toolbar-add",onClick:n.addCommunityPvlanMap},{id:i.REMOVE,enabled:!1,iconClass:"vsphere-icon-toolbar-remove",onClick:n.removeSecondaryVlanId}]}}},r.prototype.createSecondaryVlanIdColumnDefinitions=function(){return[{width:"50px",template:this.createSecondaryValidationCellTemplate.bind(this)},{displayName:this.i18n("DvsUi","PrivateVlanView.list.secondary.header"),type:"number",field:"secondaryId.val",sortable:!0,template:this.createSecondaryIdCellTemplate},{displayName:this.i18n("DvsUi","PrivateVlanView.list.type.header"),type:"string",field:"type",sortable:!0,template:this.createPvlanTypeCellTemplate.bind(this)}]},r.prototype.localizePvlanType=function(t){return t!==e.PvlanType.promiscuous&&t!==e.PvlanType.isolated&&t!==e.PvlanType.community?"":this.i18n("DvsUi","PrivateVlanPage.type."+t)},r.prototype.filterPromiscuousPvlanMaps=function(t){return _.where(_.values(t),{type:e.PvlanType.promiscuous})},r.prototype.filterPvlanMapsByPrimaryId=function(e,t){return _.filter(_.values(e),function(e){return e.primaryId.key===t})},r.prototype.getFirstAvailableKey=function(e){for(var t=0;t<e.length;t++)if(t+1!==e[t])return t+1;return e.length+1},r.prototype.getKeys=function(e){var t=[];for(var i in e)t.push(Number(i));return t},r.prototype.getNextAvailableValue=function(e,t){e.sort(function(e,t){return e-t});var r=_.indexOf(e,t+1),n=t+1;if(r!==-1)for(var o=r;o<e.length;o++){if(n!==e[o])return n;n++}return n<=i.PVLAN_ID_VALUE_MAX?n:(n=this.getFirstAvailableKey(e),n<=i.PVLAN_ID_VALUE_MAX?n:i.PVLAN_ID_VALUE_MIN)},r.prototype.removePvlanIdFromData=function(e,t){if(!t||!t.secondaryId)return e;var i=_.find(e,function(e){return e.secondaryId.key===t.secondaryId.key});return _.without(e,i)},r.prototype.hasPromiscuousPvlanMap=function(t){if(!t)return!1;for(var i=0;i<t.length;i++)if(t[i].type===e.PvlanType.promiscuous)return!0;return!1},r.prototype.sortPvlanMaps=function(t){return _.sortBy(t,function(t){return t.type===e.PvlanType.promiscuous?0:t.secondaryId.val})},r.prototype.createPrimaryValidationCellTemplate=function(e){var t=this.i18n("DvsUi","PrivateVlanPage.id.duplicate"),i=this.i18n("DvsUi","PrivateVlanPage.entries.errors"),r="datagridOptions.pvlanMaps["+e.secondaryId.key+"].errors.duplicate",n="datagridOptions.pvlanMaps["+e.secondaryId.key+"].errors.secondaryDuplicate",o="datagridOptions.pvlanMaps["+e.secondaryId.key+"].errors.secondaryIsolated",a="datagridOptions.pvlanMaps["+e.secondaryId.key+"].hasErrors()";return'\n            <div class="icon-container" ng-if="'+a+'">\n               <a role="tooltip" aria-haspopup="true" class="tooltip tooltip-sm tooltip-bottom-right">\n                  <clr-icon shape="error" class="is-error" size="24"></clr-icon>\n                  <span class="tooltip-content">\n                     <div ng-if="'+r+'">\n                        '+t+'\n                     </div>\n                     <div ng-if="'+n+" || "+o+'">\n                        '+i+"\n                     </div>\n                  </span>\n               </a>\n            </div>\n         "},r.prototype.createSecondaryValidationCellTemplate=function(t){var i=this.i18n("DvsUi","PrivateVlanPage.id.duplicate"),r=this.i18n("DvsUi","PrivateVlanPage.isolated.duplicate"),n=t.type===e.PvlanType.promiscuous,o="datagridOptions.pvlanMaps["+t.secondaryId.key+"].errors.duplicate",a="datagridOptions.pvlanMaps["+t.secondaryId.key+"].errors.isolated",s="datagridOptions.pvlanMaps["+t.secondaryId.key+"].hasErrors()";return'\n            <div class="icon-container" ng-if="!'+n+" && "+s+'">\n               <a role="tooltip" aria-haspopup="true" class="tooltip tooltip-md tooltip-bottom-right">\n                  <clr-icon shape="error" class="is-error" size="24"></clr-icon>\n                  <span class="tooltip-content">\n                     <div ng-if="'+o+'">\n                        '+i+'\n                     </div>\n                     <div ng-if="'+a+'">\n                        '+r+"\n                     </div>\n                  </span>\n               </a>\n            </div>\n         "},r.prototype.createPrimaryIdCellTemplate=function(e){return'\n            <div ng-if="datagridOptions.selectedItems[0] === dataItem">\n               <input type="number"\n                   ng-model="dataItem.primaryId.val"\n                   vx-focus-and-select\n                   ng-change="datagridOptions.updatePvlanIdValue(dataItem.primaryId)"\n                   ng-blur="datagridOptions.validateDuplicatePvlanMaps()"/>\n            </div>\n            <div ng-if="datagridOptions.selectedItems[0] !== dataItem">{{dataItem.primaryId.val}}</div>\n         '},r.prototype.createSecondaryIdCellTemplate=function(t){return t.type===e.PvlanType.promiscuous?"{{ datagridOptions.pvlanMap.secondaryId.val }}":'\n            <div ng-if="datagridOptions.selectedItems[0] === dataItem">\n            <input type="number"\n                   ng-model="dataItem.secondaryId.val"\n                   vx-focus-and-select\n                   ng-change="datagridOptions.updatePvlanIdValue(dataItem.secondaryId)"\n                   ng-blur="datagridOptions.validateDuplicatePvlanMaps()"/>\n            </div>\n            <div ng-if="datagridOptions.selectedItems[0] !== dataItem">{{dataItem.secondaryId.val}}</div>\n         '},r.prototype.createPvlanTypeCellTemplate=function(t){return t.type===e.PvlanType.promiscuous?this.localizePvlanType(e.PvlanType.promiscuous):'\n            <div class=\'select\' ng-if="datagridOptions.selectedItems[0] === dataItem"> \n               <select \n                       ng-options="item.value as item.label for item in datagridOptions.typeOptions"\n                       ng-change="datagridOptions.updatePvlanType(dataItem)"\n                       ng-model="dataItem.type">\n               </select> \n            </div>\n            <div ng-if="datagridOptions.selectedItems[0] !== dataItem">{{datagridOptions.localizePvlanType(dataItem.type)}}</div>\n         '},r.$inject=["dataService","mutationService","i18nService","clarityModalService","clarityConstants","vuiConstants","vimEntityEscapingService"],r}();e.DvsEditPvlanDialogService=r,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditPvlanDialogService",r)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$PvlanMapEntry,i=com.vmware.vsphere.client.dvs.api.spec.DvsConfigSpec,r=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$ConfigSpec,n=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$PvlanConfigSpec,o=function(){function o(e){this.name=e.name,this.configVersion=e.configVersion,this.pvlansInitial=e.pvlans,this.pvlanIds=this.extractUniqueIds(),this.pvlanMaps=this.buildPvlanMaps()}return o.prototype.buildSpec=function(){var e=this,t=this.buildPvlansUpdated(),n=[];if(_.forEach(this.pvlansInitial,function(i){var r=_.findWhere(t,{secondaryVlanId:i.secondaryVlanId});r?(r.isFound=!0,i.primaryVlanId===r.primaryVlanId&&i.pvlanType===r.pvlanType||n.push(e.buildPvlanSpec(r,a.edit))):n.push(e.buildPvlanSpec(i,a.remove))}),_.forEach(t,function(t){t.isFound||n.push(e.buildPvlanSpec(t,a.add))}),_.isEmpty(n))return null;var o=new i;return o.configSpec=new r,o.configSpec.configVersion=this.configVersion,o.configSpec.pvlanConfigSpec=n,o},o.prototype.updateIsolatedError=function(t,i){var r=_.filter(i,function(t){return t.type===e.PvlanType.isolated}),n=_.difference(i,r);_.forEach(r,function(e){e.errors.isolated=r.length>1}),_.forEach(n,function(e){e.errors.isolated=!1}),this.pvlanMaps[t].errors.secondaryIsolated=r.length>1},o.prototype.updateDuplicateError=function(){var t=this,i=this.getDuplicatePvlanMaps(),r=_.difference(_.values(this.pvlanMaps),i);_.forEach(i,function(i){i.errors.duplicate=!0,i.type!==e.PvlanType.promiscuous&&(t.pvlanMaps[i.primaryId.key].errors.secondaryDuplicate=!0)}),_.forEach(r,function(i){i.errors.duplicate=!1,i.type===e.PvlanType.promiscuous&&(t.pvlanMaps[i.primaryId.key].errors.secondaryDuplicate=!0)}),_.forEach(this.pvlanMaps,function(i){i.type===e.PvlanType.promiscuous&&(i.errors.secondaryDuplicate=t.isDuplicateInPvlanMaps(i))})},o.prototype.isDuplicateInPvlanMaps=function(t){var i=this.filterPvlanMapsByPrimaryId(this.pvlanMaps,t.primaryId.key),r=_.find(i,function(t){return t.type!==e.PvlanType.promiscuous&&t.errors.duplicate});return!!r},o.prototype.getDuplicatePvlanMaps=function(){for(var e=[],t=this.sortPvlanMaps(_.values(this.pvlanMaps)),i=1;i<t.length;i++){var r=t[i],n=t[i-1];r.secondaryId.val===n.secondaryId.val&&(_.last(e)!==n&&e.push(n),e.push(r))}return e},o.prototype.sortPvlanMaps=function(e){return _.sortBy(e,function(e){return e.secondaryId.val})},o.prototype.filterPvlanMapsByPrimaryId=function(e,t){return _.filter(_.values(e),function(e){return e.primaryId.key===t})},o.prototype.extractUniqueIds=function(){var t=_.pluck(this.pvlansInitial,"secondaryVlanId"),i={};return _.forEach(t,function(t){i[t]=new e.PvlanIdModel(t,t)}),i},o.prototype.buildPvlanMaps=function(){var t=this,i={};return _.forEach(this.pvlansInitial,function(r){var n=t.pvlanIds[r.primaryVlanId],o=t.pvlanIds[r.secondaryVlanId];i[r.secondaryVlanId]=new e.PvlanMapModel(n,o,r.pvlanType)}),i},o.prototype.buildPvlanSpec=function(e,i){var r=new t;r.primaryVlanId=e.primaryVlanId,r.secondaryVlanId=e.secondaryVlanId,r.pvlanType=e.pvlanType;var o=new n;return o.pvlanEntry=r,o.operation=i,o},o.prototype.buildPvlansUpdated=function(){return _.map(this.pvlanMaps,function(t){return new e.PvlanMapEntryExtended(t.primaryId.val,t.secondaryId.val,t.type)})},o}();e.DvsEditPvlanDialogModel=o;var a=function(){function e(){}return e.add="add",e.remove="remove",e.edit="edit",e}();e.PvlanOperationType=a}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.key=e,this._val=t}return Object.defineProperty(t.prototype,"val",{get:function(){return this._val},set:function(t){null!==t&&(t>e.DvsEditPvlanDialogConstants.PVLAN_ID_VALUE_MAX?this._val=e.DvsEditPvlanDialogConstants.PVLAN_ID_VALUE_MAX:t<e.DvsEditPvlanDialogConstants.PVLAN_ID_VALUE_MIN?this._val=e.DvsEditPvlanDialogConstants.PVLAN_ID_VALUE_MIN:t%1===0&&(this._val=t))},enumerable:!0,configurable:!0}),t}();e.PvlanIdModel=t}(dvs_ui||(dvs_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},dvs_ui;!function(e){var t=com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$PvlanMapEntry,i=function(e){function t(t,i,r){e.call(this),this.primaryVlanId=t,this.secondaryVlanId=i,this.pvlanType=r,this.isFound=!1}return __extends(t,e),t}(t);e.PvlanMapEntryExtended=i}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.primaryId=e,this.secondaryId=t,this.type=i,this.errors=new r}return e.prototype.hasErrors=function(){return this.errors.duplicate||this.errors.isolated||this.errors.secondaryDuplicate||this.errors.secondaryIsolated},e}();e.PvlanMapModel=t;var i=function(){function e(){}return e.promiscuous="promiscuous",e.isolated="isolated",e.community="community",e}();e.PvlanType=i;var r=function(){function e(){this.duplicate=!1,this.isolated=!1,this.secondaryDuplicate=!1,this.secondaryIsolated=!1}return e}();e.PvlanMapErrors=r}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.clarityModalService=e,this.i18nService=t,this.dataService=i,this.mutationService=r,this.defaultUriSchemeUtil=n}return e.prototype.removeDvs=function(e,t,i){var r=this,n={_type:"com.vmware.vsphere.client.dvs.api.spec.DvsHostRemoveSpec",hosts:[this.defaultUriSchemeUtil.getManagedObjectReference(e)]},o=function(){r.mutationService.apply(i,n._type,n)};this.openConfirmationDialog(e,t,o)},e.prototype.removeGhostDvs=function(e,t,i){var r=this,n={_type:"com.vmware.vsphere.client.network.GhostProxySwitchRemoveSpec",dvsUuid:i},o=function(){r.mutationService.apply(e,n._type,n)};this.openConfirmationDialog(e,t,o)},e.prototype.openConfirmationDialog=function(e,t,i){var r=this,n={title:this.i18nService.getString("DvsUi","removeHostFromDvs.dialogCaption"),submit:i,saveButtonLabel:this.i18nService.getString("NetworkUi","NetworkUtil.labelYes"),cancelButtonLabel:this.i18nService.getString("NetworkUi","NetworkUtil.labelNo"),preserveNewlines:!0,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"}};this.dataService.getProperties(e,["name"]).then(function(e){n.message=r.i18nService.getString("DvsUi","removeHostFromDvs.confirmWarning",e.name,t)}),this.clarityModalService.openConfirmationModal(n)},e.$inject=["clarityModalService","i18nService","dataService","mutationService","defaultUriSchemeUtil"],e}();e.RemoveDvsDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("removeDvsDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.prototype.getNrpKey=function(t){return this.isObjectIdValid(t)?t.substring(t.lastIndexOf(e.COLON_DELIMITER)+1):""},e.prototype.getDvsUrn=function(t){if(!this.isObjectIdValid(t))return"";var i=t.split(e.COLON_DELIMITER)[3];if(!this.isSwitchIdentifierValid(i))return"";var r=i.split(e.UNDERSCORE_DELIMITER)[0],n=i.split(e.UNDERSCORE_DELIMITER)[1];return"urn:vmomi:VmwareDistributedVirtualSwitch:"+n+":"+r},e.prototype.isObjectIdValid=function(t){return!!t&&5===t.split(e.COLON_DELIMITER).length},e.prototype.isSwitchIdentifierValid=function(t){return!!t&&2===t.split(e.UNDERSCORE_DELIMITER).length},e.UNDERSCORE_DELIMITER="_",e.COLON_DELIMITER=":",e}();e.NrpNavigatorService=t,angular.module("com.vmware.vsphere.client.dvs").service("nrpNavigatorService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.template='<nrp-portgroups-list [dvs-urn]="$ctrl.dvsUrn"\n                                               [selected-nrp-key]="$ctrl.nrpKey"\n                                               class="fill-parent dvs-nrp-navigator-view"></nrp-portgroups-list>'}return e}();e.NrpNavigatorPortgroupsViewComponent=t;var i=function(){function e(e,t){this.$rootScope=e,this.nrpNavigatorService=t;var i=this.$rootScope._route.objectId;this.nrpKey=this.nrpNavigatorService.getNrpKey(i),this.dvsUrn=this.nrpNavigatorService.getDvsUrn(i)}return e.$inject=["$rootScope","nrpNavigatorService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("nrpNavigatorPortgroupsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.template='<nrp-vms-list [dvs-urn]="$ctrl.dvsUrn"\n                                        [selected-nrp-key]="$ctrl.nrpKey"\n                                        class="fill-parent dvs-nrp-navigator-view"></nrp-vms-list>'}return e}();e.NrpNavigatorVmViewComponent=t;var i=function(){function e(e,t){this.$rootScope=e,this.nrpNavigatorService=t;var i=this.$rootScope._route.objectId;this.nrpKey=this.nrpNavigatorService.getNrpKey(i),this.dvsUrn=this.nrpNavigatorService.getDvsUrn(i)}return e.$inject=["$rootScope","nrpNavigatorService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("nrpNavigatorVmsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/resmgmt/nrp/views/dvsNrpOverviewComponentTemplate.html"}return e}();e.DvsNrpOverviewComponent=t;var i,r=function(){function e(e,t,i){this.i18nService=e,this.vxPropertyViewService=t,this.numberFormatterService=i}return e.prototype.$onChanges=function(){this.data&&this.buildPropertyViewData()},e.prototype.buildPropertyViewData=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general"),r=t.section("generalSection"),n=this.i18nService.getString("DvsUi","networkResourcePools.noData"),o=this.data.capacity&&this.data.capacity>0?this.numberFormatterService.formatBandwidth(this.data.capacity,i.MBITPS,i.AUTO,2,!1):n;r.property(this.i18nService.getString("DvsUi","networkResourcePools.summary.totalBandwidth"),o);var a=this.data.vmTrafficReservation&&this.data.vmTrafficReservation>0?this.numberFormatterService.formatBandwidth(this.data.vmTrafficReservation,i.MBITPS,i.AUTO):n;r.property(this.i18nService.getString("DvsUi","networkResourcePools.summary.vmTrafficReservation"),a),this.propertyViewData=e.build()},e.$inject=["i18nService","vxPropertyViewService","numberFormatterService"],e}();!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.dvs").component("dvsNrpOverview",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<",dvsUrn:"<"},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/resmgmt/nrp/views/dvsNrpReservationComponentTemplate.html"}return e}();e.DvsNrpReservationComponent=t;var i,r=function(){function e(e){this.numberFormatterService=e}return e.prototype.$onChanges=function(){this.data&&this.buildMeterData()},e.prototype.buildMeterData=function(){this.groupedMeters=this.buildMeters(),this.maxValue=this.numberFormatterService.formatBandwidth(this.data.configuredReservation,i.MBITPS,i.GBITPS,2,!1)},e.prototype.buildMeters=function(){var e=0;this.data.configuredReservation>0&&(e=(this.data.grantedQuota+this.data.vmReservation)/this.data.configuredReservation*100);var t,i,r,n=this.data.grantedQuota/this.data.configuredReservation*100||0,o=this.data.vmReservation/this.data.configuredReservation*100||0;return e<=100?(t={colorClass:"dvs-meter-light-blue",value:n},i={colorClass:"dvs-meter-normal-blue",value:o},r={colorClass:"dvs-meter-white",value:100-e}):(t={colorClass:"dvs-meter-red",value:100},i={colorClass:"dvs-meter-normal-blue",value:0},r={colorClass:"dvs-meter-white",value:0}),[t,i,r]},e.$inject=["numberFormatterService"],e}();!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.dvs").component("dvsNrpReservation",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/resmgmt/nrp/views/dvsNrpViewComponentTemplate.html"}return e}();e.DvsNrpViewComponent=t;var i=function(){function e(e,t,i){this.$rootScope=e,this.i18nService=t,this.dataService=i,this.liveRefreshProperties=["config.vmVnicNetworkResourcePool"],this.dvsUrn=e._route.objectId}return e.prototype.$onInit=function(){this.dvsUrn&&this.refresh()},e.prototype.refresh=function(){var t=this;this.dataService.getProperties(this.dvsUrn,[e.DATA_PROPERTY]).then(function(i){if(i){var r=i[e.DATA_PROPERTY];r&&(t.meterData=r.meterData,t.overviewData=r.overviewData,t.setAlertText(),t.setShowInfoBanner())}})},e.prototype.setAlertText=function(){if(!this.meterData)return void(this.alertText=null);var e=this.meterData.grantedQuota+this.meterData.vmReservation;this.alertText=e>this.meterData.configuredReservation?this.i18nService.getString("DvsUi","networkResourcePools.error.reservationQuota"):null},e.prototype.setShowInfoBanner=function(){this.showInfoBanner=this.overviewData&&this.overviewData.vmTrafficReservation<=0},e.$inject=["$rootScope","i18nService","dataService"],e.DATA_PROPERTY="dvsresmgmt:networkResourcePoolsData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsNrpView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=r,this.template='<vx-property-view data="$ctrl.propertyViewData"></vx-property-view>'}return e}();e.DvsSystemTrafficOverviewComponent=t;var i,r=function(){function e(e,t,i){this.i18nService=e,this.vxPropertyViewService=t,this.numberFormatterService=i}return e.prototype.$onChanges=function(){this.data&&this.buildPropertyViewData(this.data)},e.prototype.buildPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),r=t.category("general"),n=r.section("generalSection"),o=this.i18nService.getString("DvsUi","systemTrafficList.noData"),a=e.niocEnabled?this.i18nService.getString("DvsUi","systemTrafficView.summary.niocStatus.enabled"):this.i18nService.getString("DvsUi","systemTrafficView.summary.niocStatus.disabled");n.property(this.i18nService.getString("DvsUi","systemTrafficView.summary.resourceManagementStatus"),a||o),n.property(this.i18nService.getString("DvsUi","systemTrafficView.summary.resourceManagementVersion"),e.niocVersion||o);var s=e.excludedPnics&&e.excludedPnics>0?this.i18nService.getString("DvsUi","systemTrafficView.summary.totalPhysicalNicCountWithExclusion",e.numPnics,e.excludedPnics):e.numPnics;n.property(this.i18nService.getString("DvsUi","systemTrafficView.summary.totalPhysicalNicCount"),s||o);var c=e.minPnicSpeed&&e.minPnicSpeed>0?this.numberFormatterService.formatBandwidth(e.minPnicSpeed,i.MBITPS,i.AUTO):o;n.property(this.i18nService.getString("DvsUi","systemTrafficView.summary.minimumLinkSpeed"),c),this.propertyViewData=t.build()},e.$inject=["i18nService","vxPropertyViewService","numberFormatterService"],e}();!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.dvs").component("dvsSystemTrafficOverview",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/resmgmt/systemtraffic/views/dvsSystemTrafficReservationComponentTemplate.html"}return e}();e.DvsSystemTrafficReservationComponent=t;var i,r=function(){function e(e,t){this.i18nService=e,this.numberFormatterService=t}return e.prototype.$onChanges=function(){if(this.data){var e=this.data.reserved/this.data.capacity*100||0,t=e<=this.data.ratio?"bandwidth-reservation-satisfied":"bandwidth-reservation-unsatisfied";this.meters=[{colorClass:t,value:e<this.data.ratio?e:Math.min(e,100),label:e+"%"}],this.maxValue=this.numberFormatterService.formatBandwidth(this.data.capacity,i.MBITPS,i.GBITPS,2,!1),this.data.capacity>0?this.pointers=[{colorClass:"bandwidth-reservation-margin",value:this.data.ratio,size:19,label:this.numberFormatterService.formatBandwidth(this.data.capacity*(this.data.ratio/100),i.MBITPS,i.GBITPS,2,!1)}]:this.pointers=[],this.buildLegendData()}},e.prototype.buildLegendData=function(){this.legendData={capacity:this.data.capacity,allowed:this.data.capacity*(this.data.ratio/100),reserved:this.data.reserved,available:this.data.available>0?this.data.available:0,ratio:this.data.ratio}},e.$inject=["i18nService","numberFormatterService"],e}();!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.dvs").component("dvsSystemTrafficReservation",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.resmgmt.systemtraffic.model.DvsSystemTrafficViewData,i=function(){function e(){this.bindings={},this.controller=r,this.templateUrl="dvs-ui/resources/dvs/resmgmt/systemtraffic/views/dvsSystemTrafficViewComponentTemplate.html"}return e}();e.DvsSystemTrafficViewComponent=i;var r=function(){function e(e,i,r,n){this.$rootScope=e,this.i18nService=i,this.dataService=r,this.vxPropertyViewService=n,this.dvsUrn=e._route.objectId,this.watchForObjects=[this.dvsUrn],this.liveRefreshProperties=["config.networkResourceManagementEnabled","config.networkResourceManagementVersion","config.infrastructureTrafficResourceConfig"],this.data=new t,this.loading=!1}return e.prototype.$onInit=function(){this.loading=!0,this.requestData()},e.prototype.requestData=function(){var t=this;this.dataService.getProperties(this.dvsUrn,[e.DATA_PROPERTY]).then(function(i){i&&(t.data=i[e.DATA_PROPERTY],t.alertText=null,t.data&&t.setAlertText(),t.loading=!1)})},e.prototype.setAlertText=function(){if(this.data.overviewData&&this.data.meterData)if(this.data.overviewData.numPnics>0){var e=this.data.meterData.capacity*(this.data.meterData.ratio/100);this.data.meterData.reserved>e&&(this.alertText=this.i18nService.getString("DvsUi","systemTrafficView.error.reservationExceedsMaximum",this.data.meterData.ratio))}else this.data.meterData.reserved>0&&(this.alertText=this.i18nService.getString("DvsUi","systemTrafficView.error.cannotGuaranteeReservation"))},e.$inject=["$rootScope","i18nService","dataService","vxPropertyViewService"],e.DATA_PROPERTY="dvsresmgmt:systemTrafficViewData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsSystemTrafficView",new i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/settings/dvsPropertiesTemplate.html"}return e}();e.DvsPropertiesComponent=t;var i=function(){function e(e,t,i){this.$rootScope=e,this.i18nService=t,this.networkUtil=i,this._actions=[{actionUid:"vsphere.core.dvs.editSettings",customLabel:this.i18nService.getString("DvsUi","DvsPropertiesView.edit.label")}]}return Object.defineProperty(e.prototype,"actions",{get:function(){return this._actions},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dvsUri",{get:function(){var e=this.$rootScope._route.objectId;return this.networkUtil.isDistributedSwitch(e)?e:""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this.i18nService.getString("NetworkUi","VSwitchPropertiesView.title")},enumerable:!0,configurable:!0}),e.$inject=["$rootScope","i18nService","networkUtil"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsProperties",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.dialogScope=e,this.vuiConstants=t,this.mutationService=i}return e.prototype.showDialogErrors=function(e){var t=this;!e||e.length<1||(this.dialogScope.dialogOptions.validationBanner.messages=_.map(e,function(e){return{type:t.vuiConstants.validationBanner.type.ERROR,text:e}}))},e.prototype.submitDialog=function(){var t=this.dialogScope.generalPageModel.buildChanges(this.dialogScope.originalData),i=this.dialogScope.advancedPageModel.buildChanges(this.dialogScope.originalData),r=null!==t||null!==i;if(r){var n={_type:e.DVS_CONFIG_SPEC,configSpec:{_type:e.DVS_CONFIG_SPEC_BINDING,configVersion:this.dialogScope.originalData.configVersion}};null!==t&&(n.configSpec.name=t.name,n.configSpec.description=t.description,t.uplinkPortNames&&(n.configSpec.uplinkPortPolicy={_type:e.UPLINK_POLICY_SPEC,uplinkPortName:t.uplinkPortNames}),n.enableResourceManagement=t.isNiocEnabled),null!==i&&(null!==i.mtu&&(n.configSpec.maxMtu=i.mtu),null!==i.multicastFilteringMode&&(n.configSpec.multicastFilteringMode=i.multicastFilteringMode),null===i.ldpProtocol&&null===i.ldpOperation||(n.configSpec.linkDiscoveryProtocolConfig={_type:e.LDP_CONFIG_SPEC,protocol:i.ldpProtocol,operation:i.ldpOperation}),null===i.contactName&&null===i.contactDetails||(n.configSpec.contact={_type:e.DVS_CONTACT_INFO,name:null!==i.contactName?i.contactName:this.dialogScope.originalData.contactName,contact:null!==i.contactDetails?i.contactDetails:this.dialogScope.originalData.contactDetails})),this.mutationService.apply(this.dialogScope.dvsUrn,e.DVS_CONFIG_SPEC,n)}return!0},e.DVS_CONFIG_SPEC="com.vmware.vsphere.client.dvs.api.spec.DvsConfigSpec",e.DVS_CONFIG_SPEC_BINDING="com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$ConfigSpec",e.UPLINK_POLICY_SPEC="com.vmware.vim.binding.vim.DistributedVirtualSwitch$NameArrayUplinkPortPolicy",e.LDP_CONFIG_SPEC="com.vmware.vim.binding.vim.host.LinkDiscoveryProtocolConfig",e.DVS_CONTACT_INFO="com.vmware.vim.binding.vim.DistributedVirtualSwitch$ContactInfo",e}();e.DvsEditSettingsDialogManager=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t){this.vuiConstants=e,this.mutationService=t}return t.prototype.createManager=function(t){return new e.DvsEditSettingsDialogManager(t,this.vuiConstants,this.mutationService)},t.$inject=["vuiConstants","mutationService"],t}();e.DvsEditSettingsDialogManagerFactory=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSettingsDialogManagerFactory",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l){this.$rootScope=e,this.vxMultiPageDialogService=t,this.i18nService=i,this.dataService=r,this.mutationService=n,this.authorizationService=o,this.networkUiConstants=a,this.generalPageValidator=s,this.advancedPageValidator=c,this.managerFactory=l}return t.prototype.show=function(t){var i=this.$rootScope.$new(),r=this.managerFactory.createManager(i);i.dvsUrn=t,i.generalPageModel=new e.DvsEditSettingsGeneralPageModel,i.advancedPageModel=new e.DvsEditSettingsAdvancedPageModel,i.dialogOptions=this.createDialogOptions(),i.dialogOptions.pages=this.createPages(r),i.dialogOptions.confirmOptions={onClick:function(){return r.submitDialog()}};var n={scope:i,configObjectName:"dialogOptions"};this.vxMultiPageDialogService(n),this.requestData(i),this.requestPrivileges(i)},t.prototype.requestData=function(i){var r=this;this.dataService.getProperties(i.dvsUrn,[t.DATA_PROPERTY]).then(function(n){if(n&&n[t.DATA_PROPERTY]){var o=n[t.DATA_PROPERTY],a=o.name.trim(),s=a.replace(/%25/g,"%").replace(/%2f/g,"/").replace(/%5c/g,"\\");o.name=s,i.generalPageModel.name=o.name,i.generalPageModel.description=o.description,i.generalPageModel.maxNumUplinks=o.maxNumUplinks,i.generalPageModel.uplinkPortNames=o.uplinkPortNames,i.generalPageModel.isNiocEnabled=o.isNiocEnabled,i.generalPageModel.isNiocSupported=o.isNiocSupported,i.advancedPageModel.mtu=o.mtu,i.advancedPageModel.multicastFilteringMode=o.multicastFilteringMode,i.advancedPageModel.multicastSnoopingSupported=o.multicastSnoopingSupported,i.advancedPageModel.lldpSupported=o.lldpSupported,o.ldpOperation!==r.networkUiConstants.LinkDiscoveryOperation.DISABLED?(i.advancedPageModel.ldpProtocol=o.ldpProtocol,i.advancedPageModel.ldpOperation=o.ldpOperation):(i.advancedPageModel.ldpProtocol=e.DvsEditSettingsAdvancedPageModel.LDP_PROTOCOL_DISABLED,i.advancedPageModel.ldpOperation=r.networkUiConstants.LinkDiscoveryOperation.LISTEN),i.advancedPageModel.contactName=o.contactName,i.advancedPageModel.contactDetails=o.contactDetails,i.originalData=o,i.originalData.initialLdpProtocol=i.advancedPageModel.ldpProtocol,i.originalData.initialLdpOperation=i.advancedPageModel.ldpOperation,i.dialogOptions.title=r.i18nService.getString("NetworkUi","DvsConfigPage.titleFormat",o.name),i.dialogOptions.loading=!1}})},t.prototype.requestPrivileges=function(e){var i=[t.DVS_MODIFY_PRIVILEGE,t.DVS_RES_MGMT_PRIVILEGE];this.authorizationService.checkPrivileges(e.dvsUrn,i).then(function(t){
t&&(e.generalPageModel.hasModifyPrivilege=t[0],e.generalPageModel.hasNiocPrivilege=t[1],e.advancedPageModel.hasModifyPrivilege=t[0])})},t.prototype.createDialogOptions=function(){return{title:this.i18nService.getString("NetworkUi","DvsConfigPage.initialTitle"),iconClass:"network-lib-ui-icon-dvsEdit",show:!0,loading:!0,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0}},t.prototype.createPages=function(e){var t=this,i=[];return i.push({title:this.i18nService.getString("NetworkUi","DvsConfigPage.general.title"),contentUrl:"dvs-ui/resources/dvs/settings/edit/pages/dvsEditSettingsGeneralPage.html",onCommit:function(){var i=t.generalPageValidator.getAllErrors(e.dialogScope.generalPageModel);return i&&i.length>0?(e.showDialogErrors(i),!1):t.generalPageValidator.getNameServerError(e.dialogScope.dvsUrn,e.dialogScope.generalPageModel.name).then(function(t){return t?(e.showDialogErrors([t]),!1):(e.dialogScope.generalPageModel.updateUplinkPortNames(),!0)})}}),i.push({title:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.title"),contentUrl:"dvs-ui/resources/dvs/settings/edit/pages/dvsEditSettingsAdvancedPage.html",onCommit:function(){var i=t.advancedPageValidator.getAllErrors(e.dialogScope.advancedPageModel);return!(i&&i.length>0)||(e.showDialogErrors(i),!1)}}),i},t.$inject=["$rootScope","vxMultiPageDialogService","i18nService","dataService","mutationService","authorizationService","networkUiConstants","dvsEditSettingsGeneralPageValidator","dvsEditSettingsAdvancedPageValidator","dvsEditSettingsDialogManagerFactory"],t.DATA_PROPERTY="dvsedit:settingsdata",t.DVS_MODIFY_PRIVILEGE="DVSwitch.Modify",t.DVS_RES_MGMT_PRIVILEGE="DVSwitch.ResourceManagement",t}();e.DvsEditSettingsDialogService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSettingsDialogService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.prototype.buildChanges=function(t){var i={mtu:null,multicastFilteringMode:null,ldpProtocol:null,ldpOperation:null,contactName:null,contactDetails:null};this.mtu!==t.mtu&&(i.mtu=this.mtu),this.multicastSnoopingSupported&&this.multicastFilteringMode!==t.multicastFilteringMode&&(i.multicastFilteringMode=this.multicastFilteringMode);var r=this.ldpOperation!==t.initialLdpOperation,n=this.ldpProtocol!==t.initialLdpProtocol;return this.ldpProtocol!==e.LDP_PROTOCOL_DISABLED?(r||n)&&(i.ldpOperation=this.ldpOperation,i.ldpProtocol=this.ldpProtocol):n&&(i.ldpProtocol=t.ldpProtocol,i.ldpOperation=e.LDP_OPERATION_NONE),this.contactName!==t.contactName&&(i.contactName=this.contactName),this.contactDetails!==t.contactDetails&&(i.contactDetails=this.contactDetails),this.hasChanges(i)?i:null},e.prototype.hasChanges=function(e){for(var t in e)if(null!==e[t])return!0;return!1},e.LDP_OPERATION_NONE="none",e.LDP_PROTOCOL_DISABLED="disabled",e}();e.DvsEditSettingsAdvancedPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return Object.defineProperty(e.prototype,"uplinkPortNames",{get:function(){return this._uplinkPortNames},set:function(e){this._uplinkPortNames=e,!this.numUplinks&&e&&(this.numUplinks=e.length)},enumerable:!0,configurable:!0}),e.prototype.buildChanges=function(e){var t={name:null,description:null,uplinkPortNames:null,isNiocEnabled:null};return e.name!==this.name&&(t.name=this.name),e.description!==this.description&&(t.description=this.description),e.isNiocSupported&&e.isNiocEnabled!==this.isNiocEnabled&&(t.isNiocEnabled=this.isNiocEnabled),this.uplinkPortsChanged(e)&&(t.uplinkPortNames=this.uplinkPortNames),this.hasChanges(t)?t:null},e.prototype.updateUplinkPortNames=function(){if(this.uplinkPortNames){var e=this.uplinkPortNames,t=e.slice();if(e)if(e.length>=this.numUplinks)t.splice(this.numUplinks);else for(var i=this.numUplinks-e.length;i>0;)i--,t.push(this.generateUniqueUplinkName(t));this.uplinkPortNames=t}},e.prototype.hasChanges=function(e){for(var t in e)if(null!==e[t])return!0;return!1},e.prototype.uplinkPortsChanged=function(e){var t=_.zip(e.uplinkPortNames,this.uplinkPortNames);return _.some(t,function(e){return e[0]!==e[1]})},e.prototype.generateUniqueUplinkName=function(e){for(var t=1,i=this.buildUplinkName(t);_.contains(e,i);)t++,i=this.buildUplinkName(t);return i},e.prototype.buildUplinkName=function(e){return"Uplink "+e},e}();e.DvsEditSettingsGeneralPageModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/settings/edit/pages/dvsEditSettingsAdvancedPageComponentTemplate.html"}return e}();e.DvsEditSettingsAdvancedPageComponent=t;var i=function(){function t(e,t,i,r){this.i18nService=e,this.$scope=t,this.validator=i,this.networkUiConstants=r,this._mtuValidator={message:null,isVisible:!1},this._contactNameValidator={message:null,isVisible:!1},this._contactDetailsValidator={message:null,isVisible:!1}}return t.prototype.$onInit=function(){this.initDropdownOptions()},Object.defineProperty(t.prototype,"mtuValidator",{get:function(){return this._mtuValidator},enumerable:!0,configurable:!0}),t.prototype.onMtuChange=function(){var e=this.validator.getMtuError(this.pageModel.mtu);this.mtuValidator.message=e,this.mtuValidator.isVisible=null!==e},Object.defineProperty(t.prototype,"contactNameValidator",{get:function(){return this._contactNameValidator},enumerable:!0,configurable:!0}),t.prototype.onContactNameChange=function(){var e=this.validator.getContactNameError(this.pageModel.contactName);this.contactNameValidator.message=e,this.contactNameValidator.isVisible=null!==e},Object.defineProperty(t.prototype,"contactDetailsValidator",{get:function(){return this._contactDetailsValidator},enumerable:!0,configurable:!0}),t.prototype.onContactDetailsChange=function(){var e=this.validator.getContactDetailsError(this.pageModel.contactDetails);this.contactDetailsValidator.message=e,this.contactDetailsValidator.isVisible=null!==e},Object.defineProperty(t.prototype,"multicastFilteringOptions",{get:function(){return this._multicastFilteringOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ldpProtocolOptions",{get:function(){return this._ldpProtocolOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ldpOperationOptions",{get:function(){return this._ldpOperationOptions},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ldpOperationDropdownDisabled",{get:function(){return this.pageModel.ldpProtocol===e.DvsEditSettingsAdvancedPageModel.LDP_PROTOCOL_DISABLED||!this.pageModel.hasModifyPrivilege},enumerable:!0,configurable:!0}),t.prototype.initDropdownOptions=function(){this._multicastFilteringOptions=[{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.multicastMode.basic"),value:this.networkUiConstants.MulticastFiltering.BASIC},{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.multicastMode.snooping"),value:this.networkUiConstants.MulticastFiltering.SNOOPING}],this._ldpProtocolOptions=[{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.dp.type.disabled"),value:e.DvsEditSettingsAdvancedPageModel.LDP_PROTOCOL_DISABLED},{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.dp.type.cdp"),value:this.networkUiConstants.LinkDiscoveryProtocol.CDP}],this.pageModel.lldpSupported&&this._ldpProtocolOptions.push({label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.dp.type.lldp"),value:this.networkUiConstants.LinkDiscoveryProtocol.LLDP}),this._ldpOperationOptions=[{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.dp.operation.listen"),value:this.networkUiConstants.LinkDiscoveryOperation.LISTEN},{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.dp.operation.advertise"),value:this.networkUiConstants.LinkDiscoveryOperation.ADVERTISE},{label:this.i18nService.getString("NetworkUi","DvsConfigPage.advanced.dp.operation.both"),value:this.networkUiConstants.LinkDiscoveryOperation.BOTH}]},t.$inject=["i18nService","$scope","dvsEditSettingsAdvancedPageValidator","networkUiConstants"],t}();angular.module("com.vmware.vsphere.client.dvs").component("dvsEditSettingsAdvancedPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/settings/edit/pages/dvsEditSettingsGeneralPageComponentTemplate.html"}return e}();e.DvsEditSettingsGeneralPageComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$scope=t,this.validator=i,this.clarityModalService=r,this.clarityConstants=n,this._descriptionValidator={message:null,isVisible:!1},this._nameValidator={message:null,isVisible:!1},this._numUplinksValidator={message:null,isVisible:!1},this.niocSelectOptions=[{label:this.i18nService.getString("NetworkUi","DvsConfigPage.resmgmt.enabled"),value:!0},{label:this.i18nService.getString("NetworkUi","DvsConfigPage.resmgmt.disabled"),value:!1}]}return Object.defineProperty(e.prototype,"editUplinkNamesAvailable",{get:function(){return!this.numUplinksValidator.isVisible&&this.pageModel.hasModifyPrivilege},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptionValidator",{get:function(){return this._descriptionValidator},enumerable:!0,configurable:!0}),e.prototype.onDescriptionChange=function(){var e=this.validator.getDescriptionError(this.pageModel.description);this.descriptionValidator.message=e,this.descriptionValidator.isVisible=null!==e},Object.defineProperty(e.prototype,"nameValidator",{get:function(){return this._nameValidator},enumerable:!0,configurable:!0}),e.prototype.onNameChange=function(){var e=this.validator.getNameError(this.pageModel.name);this.nameValidator.message=e,this.nameValidator.isVisible=null!==e},Object.defineProperty(e.prototype,"numUplinksValidator",{get:function(){return this._numUplinksValidator},enumerable:!0,configurable:!0}),e.prototype.onNumUplinksChange=function(){var e=this.validator.getNumberOfUplinksError(this.pageModel.numUplinks,this.pageModel.maxNumUplinks);this.numUplinksValidator.message=e,this.numUplinksValidator.isVisible=null!==e},e.prototype.onEditUplinkNamesClick=function(){var e=this;this.pageModel.updateUplinkPortNames();var t={uplinks:[],onUplinkNameChange:function(){e.onUplinkNameChange(t.uplinks)}};_.forEach(this.pageModel.uplinkPortNames,function(e,i){t.uplinks.push({name:e,index:i+1,validator:{message:null,isVisible:!1}})});var i={title:this.i18nService.getString("NetworkUi","UplinkNamingDialog.title"),defaultButton:"submit",size:"sm",alerts:[],dialogData:t,contentTemplate:"dvs-ui/resources/dvs/settings/edit/pages/editUplinkNamesDialogTemplate.html",onSubmit:function(){var r=e.onEditUplinkNamesDialogSubmitted(t.uplinks);return i.alerts=r,!r||0===r.length}};this.clarityModalService.openOkCancelModal(i)},e.prototype.onUplinkNameChange=function(e){var t=this;_.forEach(e,function(e){var i=t.validator.getUplinkNameError(e.name);e.validator.message=i,e.validator.isVisible=null!==i});var i=[];_.forEach(e,function(e){i[e.name]||(i[e.name]=[]),i[e.name].push(e)});var r=function(e){_.forEach(i[e],function(r){r.validator.message=i[e].length>1?t.i18nService.getString("NetworkUi","UplinkNamingDialog.duplicate"):r.validator.message,r.validator.isVisible=null!==r.validator.message})};for(var n in i)r(n)},e.prototype.onEditUplinkNamesDialogSubmitted=function(e){var t=[],i=_.some(e,function(e){return e.validator.isVisible});return i?t.push({text:this.i18nService.getString("NetworkUi","UplinkNamingDialog.error.validationSummary"),type:this.clarityConstants.notifications.type.ERROR}):this.pageModel.uplinkPortNames=_.map(e,function(e){return e.name}),t},e.$inject=["i18nService","$scope","dvsEditSettingsGeneralPageValidator","clarityModalService","clarityConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsEditSettingsGeneralPage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.networkUtil=t}return e.prototype.getAllErrors=function(e){var t=[],i=this.getMtuError(e.mtu);i&&t.push(i);var r=this.getContactNameError(e.contactName);r&&t.push(r);var n=this.getContactDetailsError(e.contactDetails);return n&&t.push(n),t},e.prototype.getMtuError=function(e){return this.networkUtil.isMtuValid(e)?null:this.i18nService.getString("DvsUi","DvsEditSettingsDialog.advancedPage.mtu.error")},e.prototype.getContactNameError=function(t){return t&&t.length>e.CONTACT_MAX_LENGTH?this.i18nService.getString("DvsUi","DvsEditSettingsDialog.advancedPage.contactName.error"):null},e.prototype.getContactDetailsError=function(t){return t&&t.length>e.CONTACT_MAX_LENGTH?this.i18nService.getString("DvsUi","DvsEditSettingsDialog.advancedPage.contactDetails.error"):null},e.CONTACT_MAX_LENGTH=128,e.$inject=["i18nService","networkUtil"],e}();e.DvsEditSettingsAdvancedPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSettingsAdvancedPageValidator",t)}(dvs_ui||(dvs_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},dvs_ui;!function(e){var t=e.DvsCommonPropertiesValidator,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.getAllErrors=function(e){var t=[],i=this.getNameError(e.name);i&&t.push(i);var r=this.getNumberOfUplinksError(e.numUplinks,e.maxNumUplinks);r&&t.push(r);var n=this.getDescriptionError(e.description);return n&&t.push(n),t},t.prototype.getDescriptionError=function(e){return e&&e.length>t.DESCRIPTION_MAX_LENGHT?this.i18nService.getString("DvsUi","DvsEditSettingsDialog.generalPage.description.error"):null},t.prototype.getUplinkNameError=function(e){return e&&0!==e.length?e.length>t.MAX_UPLINK_NAME_LENGTH?this.i18nService.getString("NetworkUi","UplinkNamingDialog.tooLong"):null:this.i18nService.getString("NetworkUi","UplinkNamingDialog.empty")},t.DESCRIPTION_MAX_LENGHT=255,t.MAX_UPLINK_NAME_LENGTH=80,t}(t);e.DvsEditSettingsGeneralPageValidator=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsEditSettingsGeneralPageValidator",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/summary/components/dvsDetailsComponentTemplate.html"}return e}();e.DvsDetailsComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.$rootScope=t,this.dataService=i}return e.prototype.$onInit=function(){this.requestData()},e.prototype.refresh=function(){this.requestData()},Object.defineProperty(e.prototype,"networks",{get:function(){return this._data&&this._data.numPortgroups},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hosts",{get:function(){return this._data&&this._data.numHosts},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vms",{get:function(){return this._data&&this._data.numVms},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ports",{get:function(){return this._data&&this._data.numPorts},enumerable:!0,configurable:!0}),e.prototype.requestData=function(){var t=this,i=this.$rootScope._route.objectId;t.loadingData=!0,t.dataService.getData(i,e.DATA_MODEL).then(function(e){t._data=e,t.loadingData=!1}),this.dSwitchUri=this.$rootScope._route.objectId,this.liveRefreshProperties=["summary.vm","portgroup","config.numPorts","summary.hostMember"]},e.$inject=["i18nService","$rootScope","dataService"],e.DATA_MODEL="com.vmware.vsphere.client.h5.network.dvs.model.DvsDetailsPortletData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsDetails",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/summary/components/dvsFeaturesComponentTemplate.html"}return e}();e.DvsFeaturesComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.$rootScope=t,this.dataService=i,this.networkUiConstants=r}return e.prototype.$onInit=function(){this.requestData(),this.niocStackBlockExpanded=!1},e.prototype.refresh=function(){this.requestData()},Object.defineProperty(e.prototype,"loadingData",{get:function(){return this._loadingData},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.getFeatureSupportedText=function(e){return e?this.i18nService.getString("NetworkUi","DvsFeaturesView.supported"):this.i18nService.getString("NetworkUi","DvsFeaturesView.notSupported")},e.prototype.getLacpSupportText=function(){if(this._data.lacpSupported){if(this._data.lacpApiVersion===this.networkUiConstants.LacpSupport.BASIC)return this.i18nService.getString("NetworkUi","DvsFeaturesView.lacp.basicSupport");if(this._data.lacpApiVersion===this.networkUiConstants.LacpSupport.ENHANCED)return this.i18nService.getString("NetworkUi","DvsFeaturesView.lacp.enhancedSupport")}return this.i18nService.getString("NetworkUi","DvsFeaturesView.notSupported")},e.prototype.requestData=function(){var t=this,i=this.$rootScope._route.objectId;t._loadingData=!0,t.dataService.getProperties(i,[e.DATA_PROPERTY]).then(function(i){var r=i[e.DATA_PROPERTY];r&&(t._data=r,t._loadingData=!1)}),this.dSwitchUri=this.$rootScope._route.objectId,this.liveRefreshProperties=["capability.featuresSupported.ipfixCapability.ipv6ForIpfixSupported","capability.featuresSupported.multicastSnoopingSupported","capability.featuresSupported.lacpCapability.multiLacpGroupSupported","capability.featuresSupported.vspanCapability.erspanProtocolSupported","capability.featuresSupported.networkFilterSupported","capability.featuresSupported.ipfixCapability.observationDomainIdSupported","capability.featuresSupported.networkResourceManagementCapability.networkResourceControlVersion3Supported","config.networkResourceControlVersion","config.productInfo.version"]},e.$inject=["i18nService","$rootScope","dataService","networkUiConstants"],e.DATA_PROPERTY="dvs:featuresPortletData",e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsFeatures",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={hosts:"<",selectedHosts:"="},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/summary/components/dvsRectifyHostsOutOfSyncTemplate.html"}return e}();e.DvsRectifyHostsOutOfSyncComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.networkUiConstants=t}return e.prototype.onSelectedHostsChange=function(e){this.selectedHosts=e},e.$inject=["i18nService","networkUiConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsRectifyHostsOutOfSync",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.clarityModalService=e,this.i18nService=t,this.vxPropertyViewService=i,this.columnRenderersRegistry=r,this.defaultUriSchemeUtil=n}return e.prototype.showDetails=function(e,t,i){var r={title:this.i18nService.getString("DvsUi","OutOfSyncDvsHost.details"),subTitle:{objectId:i},size:"lg",defaultButton:"close",closeButtonTitle:this.i18nService.getString("DvsUi","OutOfSyncDvsHost.close"),hideSubmitButton:!0,alerts:[],dialogData:{desc:t,dvsOutOfSyncHostData:this.buildHostOutOfSyncPropertiesView(e)},contentTemplate:"dvs-ui/resources/dvs/summary/views/dvsOutOfSyncHost.html",modalClass:"dvs-out-of-sync-host-details-modal"};this.clarityModalService.openOkCancelModal(r)},e.prototype.buildHostOutOfSyncPropertiesView=function(e){if(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("dvsOutOfSyncHost");return this.buildHostOutOfSyncSection(i,e),t.build()}},e.prototype.buildHostOutOfSyncSection=function(e,t){for(var i=this.columnRenderersRegistry.getColumnRenderer("link-and-text"),r=0,n=t;r<n.length;r++){var o=n[r],a={hostName:o.outOfSyncHost.name,hostId:this.defaultUriSchemeUtil.getVsphereObjectId(o.outOfSyncHost.host)},s=e.section(a.hostName).compileAsHtml(!0).title(i(a.hostId,a.hostName,null,"Host:",!0));s.property(this.i18nService.getString("DvsUi","OutOfSyncDvsHost.params"),o.configParamters)}},e.$inject=["clarityModalService","i18nService","vxPropertyViewService","columnRenderersRegistry","defaultUriSchemeUtil"],e}();e.DvsOutOfSyncHostService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsOutOfSyncHostService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.clarityModalService=e,this.i18nService=t,this.dataService=i,this.mutationService=r,this.clarityConstants=n}return e.prototype.show=function(t){var i=this,r={title:this.i18nService.getString("DvsUi","OutOfSyncDvsHost.rectifyDetails"),subTitle:{objectId:t},size:"lg",submitButtonTitle:this.i18nService.getString("DvsUi","OutOfSyncDvsHost.rectifyButton"),defaultButton:"submit",alerts:[],dialogData:{hosts:[],loading:!0,selectedHosts:null},onSubmit:function(){if(!r.dialogData.selectedHosts.length)return r.alerts=[{text:i.i18nService.getString("DvsUi","OutOfSyncDvsHost.message.noHostSelected"),type:i.clarityConstants.notifications.type.ERROR}],!1;var e="com.vmware.vsphere.client.h5.network.dvs.summary.spec.DvsRectifyOutOfSyncHostSpec",n={_type:e,hosts:_.pluck(r.dialogData.selectedHosts,"hostRef")};return i.mutationService.apply(t,e,n),!0},contentTemplate:"dvs-ui/resources/dvs/summary/views/dvsRectifyHostsOutOfSync.html",modalClass:"rectify-out-of-sync-hosts-modal"},n=this.dataService.getProperties(t,[e.DVS_HOSTS_DATA_PROP]);n.then(function(t){var i=t[e.DVS_HOSTS_DATA_PROP];i&&(r.dialogData.hosts=i.dvsHosts)})["finally"](function(){r.dialogData.loading=!1}),this.clarityModalService.openOkCancelModal(r)},e.DVS_HOSTS_DATA_PROP="dvs:dvsOutOfSyncHostsData",e.$inject=["clarityModalService","i18nService","dataService","mutationService","clarityConstants"],e}();e.DvsRectifyHostsOutOfSyncService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsRectifyHostsOutOfSyncService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.$scope=e,this.description=e.modalOptions.dialogData.desc,this.dvsOutOfSyncHostData=e.modalOptions.dialogData.dvsOutOfSyncHostData;var t=e.$on("vxRouteChangeSuccess",function(){e.modalOptions.modalOpen=!1});e.$on("$destroy",function(){t()})}return e.$inject=["$scope"],e}();e.DvsOutOfSyncHostController=t,angular.module("com.vmware.vsphere.client.dvs").controller("DvsOutOfSyncHostController",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.LagDetailsDialogContent=t;var i=function(){function e(e){this.lagPropertiesService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.lagPropertiesService.getPropertyViewData(this.data)},e.$inject=["lagPropertiesService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("lagDetailsDialogContent",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.PnicDetailsDialogCdpViewComponent=t;var i=function(){function e(e){this.physicalAdapterDetailsViewService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.physicalAdapterDetailsViewService.buildOnlyCdp(this.data)},e.$inject=["physicalAdapterDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("pnicDetailsDialogCdpView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.PnicDetailsDialogLldpViewComponent=t;var i=function(){function e(e){this.physicalAdapterDetailsViewService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.physicalAdapterDetailsViewService.buildOnlyLldp(this.data)},e.$inject=["physicalAdapterDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("pnicDetailsDialogLldpView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.PnicDetailsDialogPropertiesViewComponent=t;var i=function(){function e(e){this.physicalAdapterDetailsViewService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.physicalAdapterDetailsViewService.buildOnlyProperties(this.data)},e.$inject=["physicalAdapterDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("pnicDetailsDialogPropertiesView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.PortgroupDetailsDialogPoliciesView=t;var i=function(){function e(e,t){this.distributedPortgroupPoliciesViewService=e,this.networkDetailsViewService=t}return e.prototype.$onInit=function(){this.isDvPortgroup?this.propertyViewData=this.distributedPortgroupPoliciesViewService.build(this.data):this.propertyViewData=this.networkDetailsViewService.buildOnlyPolicies(this.data)},e.$inject=["distributedPortgroupPoliciesViewService","networkDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("portgroupDetailsDialogPoliciesView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.PortgroupDetailsDialogPropertiesViewComponent=t;var i=function(){function e(e,t){this.dvPortgroupPropertiesService=e,this.networkDetailsViewService=t}return e.prototype.$onInit=function(){this.isDvPortgroup?this.propertyViewData=this.dvPortgroupPropertiesService.buildProperties(this.data):this.propertyViewData=this.networkDetailsViewService.buildOnlyProperties(this.data)},e.$inject=["dvPortgroupPropertiesService","networkDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("portgroupDetailsDialogPropertiesView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.VmkDetailsDialogIpSettingsViewComponent=t;var i=function(){function e(e){this.networkDetailsViewService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.networkDetailsViewService.buildOnlyIpSettings(this.data)},e.$inject=["networkDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("vmkDetailsDialogIpSettingsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view vmk-details-dialog-network-connection-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.VmkDetailsDialogNetworkConnectionViewComponent=t;var i=function(){function e(e,t){this.propertyViewService=e,this.i18nService=t}return e.prototype.$onInit=function(){this.propertyViewData=this.buildPropertyViewData()},e.prototype.buildPropertyViewData=function(){var e=this.propertyViewService.createPropertyViewBuilder(),t=e.category("");if(this.data){var i=t.section("networkConnection").title(this.getString("switchdiagram.nic.details.networkConnection")).property(this.getString("switchdiagram.nic.details.portId"),this.data.portId),r=i.propertyBuilder(),n=this.getStateIconAndLabel(this.data.state);r.keyBuilder().text(this.getString("switchdiagram.nic.details.state")),r.valueBuilder().icon(n.icon).text(n.label),this.data.mac&&i.property(this.getString("switchdiagram.nic.details.macRuntime"),this.data.mac)}return e.build()},e.prototype.getStateIconAndLabel=function(e){var t="",i="";return"LINK_UP"===e?(t="vsphere-icon-port_green",i=this.getString("PortState.linkUp")):"LINK_DOWN"===e?(t="vsphere-icon-port_white",i=this.getString("PortState.linkDown")):"BLOCKED"===e&&(t="vsphere-icon-port_blocked",i=this.getString("PortState.blocked")),{icon:t,label:i}},e.prototype.getString=function(e){return this.i18nService.getString("DvsUi",e)},e.$inject=["vxPropertyViewService","i18nService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("vmkDetailsDialogNetworkConnectionView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.VmkDetailsDialogNicSettingsViewComponent=t;var i=function(){function e(e){this.networkDetailsViewService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.networkDetailsViewService.buildOnlyNicSettings(this.data)},e.$inject=["networkDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("vmkDetailsDialogNicSettingsView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=i,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.VmkDetailsDialogPropertiesViewComponent=t;var i=function(){function e(e){this.networkDetailsViewService=e}return e.prototype.$onInit=function(){this.propertyViewData=this.networkDetailsViewService.buildOnlyProperties(this.data)},e.$inject=["networkDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("vmkDetailsDialogPropertiesView",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={data:"<"},this.controller=r,this.template='<vx-property-view class="network-ui-fixed-size-vx-property-view vm-vnic-details-dialog-content"\n                                            data="$ctrl.propertyViewData"/>'}return e}();e.VmVnicDetailsDialogContent=t;var i,r=function(){function e(e,t,i){this.propertyViewService=e,this.i18nService=t,this.numberFormatterService=i}return e.prototype.$onInit=function(){this.propertyViewData=this.buildPropertyViewData()},e.prototype.buildPropertyViewData=function(){var e=this.propertyViewService.createPropertyViewBuilder(),t=e.category("");if(this.data.dvsPortData){var r=t.section("networkConnection").title(this.getString("switchdiagram.nic.details.networkConnection")).property(this.getString("switchdiagram.nic.details.portId"),this.data.dvsPortData.portId),n=r.propertyBuilder(),o=this.getStateIconAndLabel(this.data.dvsPortData.state);n.keyBuilder().text(this.getString("switchdiagram.nic.details.state")),n.valueBuilder().icon(o.icon).text(o.label),this.data.dvsPortData.mac&&r.property(this.getString("switchdiagram.nic.details.macRuntime"),this.data.dvsPortData.mac)}var a=t.section("adapter").title(this.data.vmVnicModel.adapterName).property(this.getString("switchdiagram.nic.details.mac"),this.data.vmVnicModel.macAddress).property(this.getString("switchdiagram.nic.details.adapterType"),this.data.vmVnicModel.adapterType);
if(this.data.vmVnicModel.resourceAllocation){a.property(this.getString("switchdiagram.nic.details.shares"),this.i18nService.getString("DvsUi","switchdiagram.nic.details.sharesValueFormat",this.data.vmVnicModel.resourceAllocation.sharesValue,this.getSharesLevelLabel(this.data.vmVnicModel.resourceAllocation.sharesLevel))).property(this.getString("switchdiagram.nic.details.reservation"),this.numberFormatterService.formatBandwidth(this.data.vmVnicModel.resourceAllocation.reservation,i.MBITPS,i.AUTO));var s=this.data.vmVnicModel.resourceAllocation.limit>-1?this.numberFormatterService.formatBandwidth(this.data.vmVnicModel.resourceAllocation.limit,i.MBITPS,i.AUTO):this.getString("switchdiagram.nic.details.unlimited");a.property(this.getString("switchdiagram.nic.details.limit"),s)}return this.data.vmVnicModel.sriovCapable&&t.section("sriov").title(this.getString("switchdiagram.nic.details.sriov")).property(this.getString("switchdiagram.nic.details.sriovStatus"),this.getSriovStatusLabel(this.data.vmVnicModel.sriovCapable)).property(this.getString("switchdiagram.nic.details.sriov.virtualFunction"),this.data.vmVnicModel.virtualFunctionId).property(this.getString("switchdiagram.nic.details.sriov.physicalFunction"),this.i18nService.getString("DvsUi","switchdiagram.nic.details.sriov.physicalFunctionFormat",this.data.vmVnicModel.physicalFunctionId,this.data.vmVnicModel.physicalFunctionDeviceId)).property(this.getString("switchdiagram.nic.details.gosMtu"),this.getGuestOsMtuChangesLabel(this.data.vmVnicModel.guestOsMtuChange)),e.build()},e.prototype.getStateIconAndLabel=function(e){var t="",i=this.getString("switchdiagram.noData");return"LINK_UP"===e?(t="vsphere-icon-port_green",i=this.getString("PortState.linkUp")):"LINK_DOWN"===e?(t="vsphere-icon-port_white",i=this.getString("PortState.linkDown")):"BLOCKED"===e&&(t="vsphere-icon-port_blocked",i=this.getString("PortState.blocked")),{icon:t,label:i}},e.prototype.getSriovStatusLabel=function(e){return this.getString(e?"switchdiagram.nic.details.sriov.enabled":"switchdiagram.nic.details.sriov.notSupported")},e.prototype.getGuestOsMtuChangesLabel=function(e){return this.getString(e?"switchdiagram.nic.details.gosMtu.allowed":"switchdiagram.nic.details.gosMtu.disallowed")},e.prototype.getSharesLevelLabel=function(e){switch(e){case"low":return this.getString("switchdiagram.nic.details.sharesLevel.low");case"normal":return this.getString("switchdiagram.nic.details.sharesLevel.normal");case"high":return this.getString("switchdiagram.nic.details.sharesLevel.high");case"custom":return this.getString("switchdiagram.nic.details.sharesLevel.custom");default:return""}},e.prototype.getString=function(e){return this.i18nService.getString("DvsUi",e)},e.$inject=["vxPropertyViewService","i18nService","numberFormatterService"],e}();!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.dvs").component("vmVnicDetailsDialogContent",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={model:"<",feature:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/upgrade/components/dvsEnableFeatureTemplate.html"}return e}();e.DvsEnableFeatureComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.dvsUpgradeWizardConstants=t,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){switch(this.feature){case this.dvsUpgradeWizardConstants.features.LACP:this.featureLabel=this.i18n("DvsUi","DvsLacpPrerequisitesPage.feature.label"),this.featureProperty="isExplicitLacpUpgradeEnabled",this.featureInfo=this.i18n("DvsUi","DvsLacpPrerequisitesPage.feature.description"),this.signPostConfig={message:this.i18n("DvsUi","DvsLacpPrerequisitesPage.info"),title:this.i18n("DvsUi","DvsLacpPrerequisitesPage.title"),"class":"dvs-upgrade-info-signpost"};break;case this.dvsUpgradeWizardConstants.features.NIOC:this.featureLabel=this.i18n("DvsUi","DvsNiocPrerequisitesPage.feature.label"),this.featureInfo=this.i18n("DvsUi","DvsNiocPrerequisitesPage.feature.description"),this.featureProperty="isExplicitNiocUpgradeEnabled",this.signPostConfig={message:this.i18n("DvsUi","DvsNiocPrerequisitesPage.info"),title:this.i18n("DvsUi","DvsNiocPrerequisitesPage.title"),"class":"dvs-upgrade-info-signpost"}}},e.$inject=["i18nService","dvsUpgradeWizardConstants"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsEnableFeature",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={hostCompatibilityData:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/upgrade/components/dvsHostCompatibilityListTemplate.html"}return e}();e.DvsHostCompatibilityListComponent=t;var i=function(){function e(e,t,i,r){this.vuiConstants=e,this.i18nService=t,this.columnRenderersRegistry=i,this.dvsHostCompatibilityService=r,this.hasCompatibilityError=!1,this.datagridDescription=this.i18nService.getString("DvsUi","DvsHostCompatibilityList.compatibilityIssuesHeader"),this.datagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.buildColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,data:this.hostCompatibilityData,actionBarOptions:{actions:[]},onChange:this.onSelectionChange.bind(this)},this.compatibilityIssuesHeader=this.i18nService.getString("DvsUi","DvsHostCompatibilityList.compatibilityIssuesHeader")}return e.prototype.$onInit=function(){this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{size:"70%",min:"120px"},{size:"30%",min:"50px"}]},this.iconTextRenderer=this.columnRenderersRegistry.getColumnRenderer("icon-text")},e.prototype.$onChanges=function(){this.datagridOptions.data=this.hostCompatibilityData?this.hostCompatibilityData:[]},e.prototype.setOverallCompatibilityStatus=function(){this.hostCompatibilityData&&0!==this.hostCompatibilityData.length?this.dvsHostCompatibilityService.isIncompatibleHostAvailable(this.hostCompatibilityData)?(this.hostCompatibilityIssues=[this.i18nService.getString("DvsUi","DvsHostCompatibilityPage.incompatibleHostsPresent")],this.hasCompatibilityError=!0):(this.hostCompatibilityIssues=[this.i18nService.getString("DvsUi","DvsHostCompatibilityPage.allHostsCompatible")],this.hasCompatibilityError=!1):(this.hostCompatibilityIssues=[this.i18nService.getString("DvsUi","DvsHostCompatibilityPage.noHosts")],this.hasCompatibilityError=!1)},e.prototype.buildColumnDefinitions=function(){var e=this;return[{displayName:this.i18nService.getString("DvsUi","DvsHostCompatibilityList.hostColumnHeader"),field:"hostName",width:"300px",template:function(t){return e.iconTextRenderer(["hostIcon","hostName"],{hostName:t.hostName,hostIcon:t.hostIcon})}},{displayName:this.i18nService.getString("DvsUi","DvsHostCompatibilityList.compatibilityColumnHeader"),width:"100%",template:function(t){var i=e.isHostCompatible(t),r=i?e.i18nService.getString("DvsUi","DvsHostCompatibilityList.compatibleText",t.hostName):e.i18nService.getString("DvsUi","DvsHostCompatibilityList.incompatibleText");return i?"<span><span class='vsphere-icon-status-ok'></span>"+("<span class='vertical-align-cell'>"+r+"</span></span>"):"<span><clr-icon shape='error' size='24' class='is-error dvs-host-compatibility-error'></clr-icon>"+("<span class='vertical-align-cell'>"+r+"</span></span>")}}]},e.prototype.isHostCompatible=function(e){return null===e.compatibilityErrors||0===e.compatibilityErrors.length},e.prototype.onSelectionChange=function(e){e&&e.length>0?this.isHostCompatible(e[0])?(this.hostCompatibilityIssues=[this.i18nService.getString("DvsUi","DvsHostCompatibilityList.compatibleHost",e[0].hostName)],this.hasCompatibilityError=!1):(this.hostCompatibilityIssues=e[0].compatibilityErrors,this.hasCompatibilityError=!0):this.setOverallCompatibilityStatus()},e.$inject=["vuiConstants","i18nService","columnRenderersRegistry","dvsHostCompatibilityService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsHostCompatibilityList",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={wizardModel:"<"},this.controller=i,this.templateUrl="dvs-ui/resources/dvs/upgrade/components/dvsUpgradeReadyToCompletePageTemplate.html"}return e}();e.DvsUpgradeReadyToCompletePageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.vxPropertyViewService=t,this.formattingService=i,this.dvsUpgradeWarning=this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.warningMessage")}return e.prototype.$onInit=function(){this.buildPropertyView()},e.prototype.buildPropertyView=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general"),i=t.section("generalSection");if(i.property(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.dvsName"),this.wizardModel.dvsName),i.property(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.currentDvsVersion"),this.wizardModel.currentVersion),i.property(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.upgradeDvsVersion"),this.wizardModel.selectedVersion),this.wizardModel.isExplicitNiocUpgradeSupported&&i.property(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.upgradeNioc"),this.wizardModel.isExplicitNiocUpgradeSupported&&this.wizardModel.isExplicitNiocUpgradeEnabled?this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.enabled"):this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.disabled")),this.wizardModel.isExplicitLacpUpgradeSupported&&i.property(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.upgradeLacp"),this.wizardModel.isExplicitLacpUpgradeSupported&&this.wizardModel.isExplicitLacpUpgradeEnabled?this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.enabled"):this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.disabled")),this.wizardModel.isExplicitNiocUpgradeSupported&&this.wizardModel.isExplicitNiocUpgradeEnabled&&this.wizardModel.niocUpgradeStatistics&&this.wizardModel.niocUpgradeStatistics.userDefinedNrpCount>0){var r=t.section("niocSection").title(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.niocSettings"));r.property(this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.migrateShares"),this.wizardModel.migrateShares?this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.migrateShares.on"):this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.summary.migrateShares.off"))}if(this.wizardModel.isExplicitLacpUpgradeSupported&&this.wizardModel.isExplicitLacpUpgradeEnabled&&null!==this.wizardModel.lag){var n=t.section("lagSection").title(this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.lacpSettings"));n.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.summary.lagName"),this.wizardModel.lag.name),n.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.numPorts"),this.wizardModel.lag.uplinkNum.toString()),n.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.mode"),this.formattingService.getLacpModeText(this.wizardModel.lag.mode)),n.property(this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.loadBalancing"),this.formattingService.getLoadBalancingModeText(this.wizardModel.lag.loadbalanceAlgorithm))}this.propertyViewData=e.build()},e.$inject=["i18nService","vxPropertyViewService","lagPropertiesFormattingService"],e}();angular.module("com.vmware.vsphere.client.dvs").component("dvsUpgradeReadyToCompletePage",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){angular.module("com.vmware.vsphere.client.dvs").constant("dvsUpgradeWizardConstants",{pages:{DVS_SELECT_VERSION_PAGE:"selectVersionPage",DVS_NIOC_PREREQUISITES_PAGE:"upgradeNiocPage",DVS_NIOC_MIGRATE_SHARES_PAGE:"niocMigrateSharesPage",DVS_LACP_PREREQUISITES_PAGE:"enhanceLacpPage",DVS_LACP_CREATE_LAG_PAGE:"lacpCreateLag",DVS_HOST_COMPATIBILITY_PAGE:"hostCompatibilityPage",DVS_READY_TO_COMPLETE_PAGE:"readyToCompletePage"},properties:{DVS_UPGRADE_WIZARD_DATA:"dvsupgrade:wizardData",DVS_HOST_COMPATIBILITY_DATA:"dvsupgrade:hostCompatibility"},spec:{PRODUCT_SPEC_TYPE:"com.vmware.vim.binding.vim.dvs.ProductSpec"},features:{LACP:"lacp",NIOC:"nioc"}})}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r){this.pageStateManagementService=e,this.wizardConstants=t,this.vuiConstants=i,this.featureService=r}return e.prototype.init=function(e){var t=this;this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(e),this.showHideUpgradeNiocPages(e.wizardConfig.pages,!1,!1,!1),this.showHideUpgradeLacpPages(e.wizardConfig.pages,!1,!1,!1),e.$watch("model.isExplicitLacpUpgradeEnabled",function(){var i=e.model.isExplicitLacpUpgradeSupported&&e.model.isExplicitLacpUpgradeEnabled&&null!==e.model.lag;t.showHidePage(e.wizardConfig.pages,t.wizardConstants.pages.DVS_LACP_CREATE_LAG_PAGE,i)}),e.$watch("model.isExplicitNiocUpgradeEnabled",function(){var i=e.model.isExplicitNiocUpgradeSupported&&e.model.isExplicitNiocUpgradeEnabled&&null!==e.model.niocUpgradeStatistics&&e.model.niocUpgradeStatistics.userDefinedNrpCount>0;t.showHidePage(e.wizardConfig.pages,t.wizardConstants.pages.DVS_NIOC_MIGRATE_SHARES_PAGE,i)})},e.prototype.showHideUpgradeNiocPages=function(e,t,i,r){var n=t&&r&&i;this.showHidePage(e,this.wizardConstants.pages.DVS_NIOC_PREREQUISITES_PAGE,t),this.showHidePage(e,this.wizardConstants.pages.DVS_NIOC_MIGRATE_SHARES_PAGE,n)},e.prototype.showHideUpgradeLacpPages=function(e,t,i,r){var n=t&&r&&i;this.showHidePage(e,this.wizardConstants.pages.DVS_LACP_PREREQUISITES_PAGE,t),this.showHidePage(e,this.wizardConstants.pages.DVS_LACP_CREATE_LAG_PAGE,n)},e.prototype.updateExplicitUpgradesPages=function(e){e.model.isExplicitLacpUpgradeSupported=this.featureService.isExplicitLacpUpgradeSupported(e.model.selectedVersion,e.model.isLacpConfigured,e.model.currentLacpVersion),this.showHideUpgradeLacpPages(e.wizardConfig.pages,e.model.isExplicitLacpUpgradeSupported,e.model.isExplicitLacpUpgradeEnabled,null!==e.model.lag),e.model.isExplicitNiocUpgradeSupported=this.featureService.isExplicitNiocUpgradeSupported(e.model.selectedVersion,e.model.currentNiocVersion,e.model.niocUpgradeStatistics);var t=null!==e.model.niocUpgradeStatistics&&e.model.niocUpgradeStatistics.userDefinedNrpCount>0;this.showHideUpgradeNiocPages(e.wizardConfig.pages,e.model.isExplicitNiocUpgradeSupported,e.model.isExplicitNiocUpgradeEnabled,t)},e.prototype.showHidePage=function(e,t,i){var r=_.findWhere(e,{id:t});r&&(r.state=i?this.vuiConstants.wizard.pageState.INCOMPLETE:this.vuiConstants.wizard.pageState.SKIPPED)},e.$inject=["pageStateManagementService","dvsUpgradeWizardConstants","vuiConstants","dvsUpgradeFeaturesService"],e}();e.DvsUpgradeWizardManager=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeWizardManager",t)}(dvs_ui||(dvs_ui={}));var DvsUpdateWizardPages=dvs_ui.DvsUpgradeWizardPages,dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.wizardManager=t,this.wizardConstants=i,this.simpleValidationCommit=r,this.vuiConstants=n,this.dvsHostCompatibilityPageValidator=o,this.dvsPrerequisitesPageValidator=a,this.dvsLagPageValidator=s}return e.prototype.createPages=function(e){var t=this,i={id:this.wizardConstants.pages.DVS_SELECT_VERSION_PAGE,title:this.i18nService.getString("DvsUi","SelectDvsVersionPage.title"),description:this.i18nService.getString("DvsUi","SelectDvsVersionPage.description"),contentUrl:"dvs-ui/resources/dvs/upgrade/views/dvsSelectVersionPage.html",onCommit:this.simpleValidationCommit(function(){return t.wizardManager.updateExplicitUpgradesPages(e),[]},e.wizardConfig),validationParams:["model.selectedVersion"]},r={id:this.wizardConstants.pages.DVS_HOST_COMPATIBILITY_PAGE,title:this.i18nService.getString("DvsUi","DvsHostCompatibilityPage.title"),description:this.i18nService.getString("DvsUi","DvsHostCompatibilityPage.description"),contentUrl:"dvs-ui/resources/dvs/upgrade/views/dvsHostCompatibilityPage.html",onCommit:this.simpleValidationCommit(function(){return t.dvsHostCompatibilityPageValidator.getValidationError(e)},e.wizardConfig),validationParams:[]},n={id:this.wizardConstants.pages.DVS_NIOC_PREREQUISITES_PAGE,title:this.i18nService.getString("DvsUi","DvsNiocPrerequisitesPage.title"),description:this.i18nService.getString("DvsUi","DvsNiocPrerequisitesPage.description"),contentUrl:"dvs-ui/resources/dvs/upgrade/views/dvsNiocPrerequisitesPage.html",defaultState:this.vuiConstants.wizard.pageState.SKIPPED,onCommit:this.simpleValidationCommit(function(){return!e.model.isExplicitNiocUpgradeEnabled||t.dvsPrerequisitesPageValidator.getValidationResult(e.model.niocPrerequisiteChecks,e.model)},e.wizardConfig),validationParams:[]},o={id:this.wizardConstants.pages.DVS_NIOC_MIGRATE_SHARES_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.migrateShares.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeNiocWizard.migrateShares.description"),contentUrl:"dvs-ui/resources/dvs/niocupgrade/views/dvsUpgradeNiocSharesPage.html",defaultState:this.vuiConstants.wizard.pageState.SKIPPED,onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:["model.migrateShares"]},a={id:this.wizardConstants.pages.DVS_LACP_PREREQUISITES_PAGE,title:this.i18nService.getString("DvsUi","DvsLacpPrerequisitesPage.title"),description:this.i18nService.getString("DvsUi","DvsLacpPrerequisitesPage.description"),contentUrl:"dvs-ui/resources/dvs/upgrade/views/dvsLacpPrerequisitesPage.html",defaultState:this.vuiConstants.wizard.pageState.SKIPPED,onCommit:this.simpleValidationCommit(function(){return!e.model.isExplicitLacpUpgradeEnabled||t.dvsPrerequisitesPageValidator.getValidationResult(e.model.lacpPrerequisiteChecks,e.model)},e.wizardConfig),validationParams:[]},s={id:this.wizardConstants.pages.DVS_LACP_CREATE_LAG_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeLacpWizard.createLag.description"),contentUrl:"dvs-ui/resources/dvs/lacpupgrade/views/dvsUpgradeLacpLagPage.html",defaultState:this.vuiConstants.wizard.pageState.SKIPPED,onCommit:this.simpleValidationCommit(function(){return t.dvsLagPageValidator.getValidationError(e)},e.wizardConfig),validationParams:["model.lag.name"]},c={id:this.wizardConstants.pages.DVS_READY_TO_COMPLETE_PAGE,title:this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.title"),description:this.i18nService.getString("DvsUi","DvsUpgradeWizard.summary.description"),contentUrl:"dvs-ui/resources/dvs/upgrade/views/dvsUpgradeReadyToCompletePage.html",onCommit:this.simpleValidationCommit(function(){return[]},e.wizardConfig),validationParams:[]},l=[i,r,n,o,a,s,c];return l},e.$inject=["i18nService","dvsUpgradeWizardManager","dvsUpgradeWizardConstants","simpleValidationCommit","vuiConstants","dvsHostCompatibilityPageValidator","dvsPrerequisitesPageValidator","dvsLagPageValidator"],e}();e.DvsUpgradeWizardPages=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeWizardPages",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.mutationService=r,this.dataService=n,this.specFactory=o,this.wizardConstants=a,this.wizardManager=s,this.wizardPages=c,this.wizardValidationService=l}return t.prototype.show=function(t){var i=this,r=this.$rootScope.$new();r.model=new e.DvsUpgradeWizardModel,r.model.dvsId=t,r.wizardConfig={title:this.i18nService.getString("DvsUi","DvsUpgradeWizard.title"),loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),cssClass:"dvs-upgrade-wizard",onFinish:function(){var e=i.specFactory.buildDvsUpgradeSpec(r.model);return i.mutationService.apply(r.model.dvsId,e._type,e),!0}},r.wizardConfig.pages=this.wizardPages.createPages(r),this.wizardValidationService.initWizardValidation(r),this.wizardManager.init(r),this.requestProperties(r),this.vuiWizardService({scope:r,configObjectName:"wizardConfig"}).show()},t.prototype.requestProperties=function(e){var t=this;e.wizardConfig.loading=!0,this.dataService.getProperties(e.model.dvsId,[this.wizardConstants.properties.DVS_UPGRADE_WIZARD_DATA]).then(function(i){var r=i[t.wizardConstants.properties.DVS_UPGRADE_WIZARD_DATA];e.model.dvsName=r.dvsName,e.model.supportedVersionSpecs=r.supportedSwitchSpec,e.model.currentVersion=r.currentSwitchSpec.version;var n=_.filter(r.supportedSwitchSpec,function(t){return t.version>e.model.currentVersion});e.model.supportedVersions=_.map(n,function(e){return e.version}).sort(function(e,t){return e<t?1:t<e?-1:0}),e.model.supportedVersions&&e.model.supportedVersions.length>0&&(e.model.selectedVersion=e.model.supportedVersions[0]),e.model.currentNiocVersion=r.currentNiocVersion,e.model.niocUpgradeStatistics=r.niocUpgradeStatistics,e.model.isLacpConfigured=r.isLacpConfigured,r.isLacpSupported&&(e.model.currentLacpVersion=r.currentLacpVersion),e.model.niocPrerequisiteChecks=r.niocPrerequisiteCheckResults,e.model.lacpPrerequisiteChecks=r.lacpPrerequisiteCheckResults,e.model.lag=r.lagConfig,e.wizardConfig.title=t.i18nService.getString("DvsUi","DvsUpgradeWizard.titleFormat",e.model.dvsName),e.wizardConfig.loading=!1})},t.$inject=["$rootScope","i18nService","vuiWizardService","mutationService","dataService","dvsUpgradeWizardSpecFactory","dvsUpgradeWizardConstants","dvsUpgradeWizardManager","dvsUpgradeWizardPages","wizardValidationService"],t}();e.DvsUpgradeWizardService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeWizardService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.dvs.upgrade.model.DvsUpgradeWizardSpec,i=function(){function e(e,t,i){this.defaultUriSchemeUtil=e,this.dvsVersionPageConstants=t,this.featureService=i}return e.prototype.buildDvsUpgradeSpec=function(e){var i=new t;return i.productSpec=_.find(e.supportedVersionSpecs,function(t){return t.version===e.selectedVersion}),i.implicitNiocUpgrade=this.featureService.isImplicitNiocUpgradeSupported(e.selectedVersion,e.currentNiocVersion,e.niocUpgradeStatistics),i.explicitNiocUpgrade=e.isExplicitNiocUpgradeSupported&&e.isExplicitNiocUpgradeEnabled,i.implicitLacpUpgrade=this.featureService.isImplicitLacpUpgradeSupported(e.selectedVersion,e.isLacpConfigured,e.currentLacpVersion),i.explicitLacpUpgrade=e.isExplicitLacpUpgradeSupported&&e.isExplicitLacpUpgradeEnabled,i.migrateShares=e.migrateShares,i.lag=e.lag,i.isMultiLagLacpSupported=this.featureService.isMultiLagLacpSupported(e.selectedVersion),i},e.$inject=["defaultUriSchemeUtil","dvsVersionPageConstants","dvsUpgradeFeaturesService"],e}();e.DvsUpgradeWizardSpecFactory=i,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeWizardSpecFactory",i)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.selectedVersion="",this.currentVersion="",this.migrateShares=!1,this.prerequisiteWarningShown=!1,this.isCompatibilityDataRetrievedForVersion="",this.isExplicitNiocUpgradeSupported=!1,this.isExplicitLacpUpgradeSupported=!1,this.isExplicitLacpUpgradeEnabled=!0,this.isExplicitNiocUpgradeEnabled=!0}return e}();e.DvsUpgradeWizardModel=t}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){}return e.prototype.isIncompatibleHostAvailable=function(e){if(!e||0===e.length)return!1;var t=_.find(e,function(e){return e.compatibilityErrors&&0!==e.compatibilityErrors.length});return void 0!==t},e.$inject=[],e}();e.DvsHostCompatibilityService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsHostCompatibilityService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e){this.dvsVersionPageConstants=e,this.LACP_API_VERSION_SINGLE_LAG="singleLag"}return e.prototype.isMultiLagLacpSupported=function(e){return this.isSupportedForVersion(e,this.dvsVersionPageConstants.versions._55)},e.prototype.isImplicitNiocUpgradeSupported=function(e,t,i){var r=this.isNiocUpgradeSupported(e,t);return r&&i&&(isNaN(i.modifiedSystemNrpCount)||0===i.modifiedSystemNrpCount)&&(isNaN(i.userDefinedNrpCount)||0===i.userDefinedNrpCount)},e.prototype.isExplicitNiocUpgradeSupported=function(e,t,i){var r=this.isNiocUpgradeSupported(e,t);return r&&!this.isImplicitNiocUpgradeSupported(e,t,i)},e.prototype.isImplicitLacpUpgradeSupported=function(e,t,i){return this.isMultiLagLacpSupported(e)&&(!i||i===this.LACP_API_VERSION_SINGLE_LAG&&!t)},e.prototype.isExplicitLacpUpgradeSupported=function(e,t,i){return this.isMultiLagLacpSupported(e)&&(!i||i===this.LACP_API_VERSION_SINGLE_LAG)&&!this.isImplicitLacpUpgradeSupported(e,t,i)},e.prototype.isNiocUpgradeSupported=function(e,t){return this.isSupportedForVersion(e,this.dvsVersionPageConstants.versions._60)&&!isNaN(t)&&t<3},e.prototype.isSupportedForVersion=function(e,t){if(!e||!t)return!1;var i=parseInt(e.replace(".","")),r=parseInt(t.replace(".",""));return!isNaN(i)&&!isNaN(r)&&i>=r},e.$inject=["dvsVersionPageConstants"],e}();e.DvsUpgradeFeaturesService=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsUpgradeFeaturesService",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.$q=t,this.dvsHostCompatibilityService=i}return e.prototype.getValidationError=function(e){return this.dvsHostCompatibilityService.isIncompatibleHostAvailable(e.model.hostCompatibilityData)?this.$q.resolve([this.i18nService.getString("DvsUi","DvsHostCompatibilityPage.incompatibleHostsPresent")]):this.$q.resolve([])},e.$inject=["i18nService","$q","dvsHostCompatibilityService"],e}();e.DvsHostCompatibilityPageValidator=t,angular.module("com.vmware.vsphere.client.dvs").service("dvsHostCompatibilityPageValidator",t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$scope=e,this.dataService=t,this.$q=i,this.i18nService=r,this.wizardConstants=n,this.$scope.model.isCompatibilityDataRetrievedForVersion!==this.$scope.model.selectedVersion?this.requestHostCompatibilityData():this.hostCompatibilityData=this.$scope.model.hostCompatibilityData}return e.prototype.requestHostCompatibilityData=function(){var e=this;this.$scope.wizardConfig.loading=!0,this.dataService.getProperties(this.$scope.model.dvsId,[this.wizardConstants.properties.DVS_HOST_COMPATIBILITY_DATA],{propertyParams:[{propertyName:this.wizardConstants.properties.DVS_HOST_COMPATIBILITY_DATA,parameterType:this.wizardConstants.spec.PRODUCT_SPEC_TYPE,parameter:_.find(this.$scope.model.supportedVersionSpecs,function(t){return t.version===e.$scope.model.selectedVersion})}]}).then(function(t){var i=t[e.wizardConstants.properties.DVS_HOST_COMPATIBILITY_DATA];i?e.hostCompatibilityData=i:e.hostCompatibilityData=[],e.$scope.model.hostCompatibilityData=e.hostCompatibilityData,e.$scope.model.isCompatibilityDataRetrievedForVersion=e.$scope.model.selectedVersion,e.$scope.wizardConfig.loading=!1})},e.$inject=["$scope","dataService","$q","i18nService","dvsUpgradeWizardConstants"],e}();e.DvsHostCompatibilityPageController=t,angular.module("com.vmware.vsphere.client.dvs").controller("DvsHostCompatibilityPageController",t)}(dvs_ui||(dvs_ui={})),h5=h5||{},h5.commonModule={angularModule:angular.module("com.vmware.vsphere.client.commonModule",["com.vmware.platform.ui","ui.bootstrap"])},angular.module("com.vmware.vsphere.client.commonModule").run(["mutationService","vuiModalService","$rootScope","$document","clarityConstants","$timeout","actionDialogService","clarityModalService","dataService","i18nService","libraryService","categoryService","categoryActionService","createContentLibraryService","$injector","AngularInjector","defaultUriSchemeUtil","dragAndDropStockExpressionsService","vscAssignTagsLauncherService","vscOpenManageAlarmService","managedEntityConstants",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P){function C(t,i){return e.apply(t,"com.vmware.opsmgmt.client.alarms.EnableAlarmActionsSpec",{enabled:i})}function D(e){return _.map(e,function(e){return 0===e.associableEntityTypes.length?e.displayAssociableEntityTypesString=l.getString("Common","tag.dashboard.categories.associable.all"):e.displayAssociableEntityTypesString=w(e.associableEntityTypes).join(", "),e})}function w(e){return _.map(e,function(e){return l.getString("Common","typeResource.entityType."+e+"Plural")})}function b(e,t){c.getProperties(e[0],["name"]).then(function(i){s.openModal(t,e,{objectId:e[0],existingObjectName:i.name,defaultButton:"submit"},"common-module-ui/resources/common-module/views/rename/renameObject.html")})}function I(){var e=i.$new(),t={title:l.getString("CommonUi","about.vsphere.title"),subTitle:l.getString("CommonUi","about.vsphere.version"),contentUrl:"common-module-ui/resources/common-module/views/about-vsphere/AboutVsphere.html",size:"lg"};e.modalOptions=t,s.openPopUp(e)}var T="name",E="type",V="morIdOfVmtx";h5.actions["vsphere.core.actions.openAboutVsphere"]=function(e,t){I()},h5.actions["vsphere.opsmgmt.alarms.acknowledge"]=function(t,r,n){var o=n.alarm?n.alarm:n.details.alarmInfo.alarm;return e.apply(n.entityId,"com.vmware.opsmgmt.client.alarms.AlarmAcknowledgementSpec",{alarm:o}).then(function(e){e&&e.error||i.$broadcast("IssueChangeEvent")})},h5.actions["vsphere.opsmgmt.alarms.reset"]=function(t,r,n){var o=n.alarm?n.alarm:n.details.alarmInfo.alarm;return e.apply(n.entityId,"com.vmware.opsmgmt.client.alarms.AlarmStatusSpec",{alarm:o,status:"green"}).then(function(e){if(!e||!e.error){var t={operationType:"CHANGE",objectId:n.entityId,object:n.entity};i.$broadcast("modelChanged",t),i.$broadcast("IssueChangeEvent")}})},h5.actions["vsphere.opsmgmt.alarms.enableAlarmActions"]=function(e,t,i){return C(t[0],!0)},h5.actions["vsphere.opsmgmt.alarms.disableAlarmActions"]=function(e,t,i){return C(t[0],!1)},h5.actions["vsphere.core.actions.editCustomAttributesAction"]=function(e,t,i){s.openModal(e,t,i,"common-module-ui/resources/common-module/views/custom-attributes/EditCustomAttributesDialog.html")},h5.actions["vsphere.core.inventory.actions.addPermission"]=function(e,t,i){i||(i={edit:!1}),s.openModal(e,t,i,"common-module-ui/resources/common-module/views/permission/AddPermissionDialog.html",{height:"auto"})},h5.actions["vsphere.core.common.actions.removeTagAction"]=function(e,t,i){s.openModal(e,t,i,"common-module-ui/resources/common-module/views/tags/removeTagDialog.html",{height:"auto"})},h5.actions["vsphere.core.common.actions.assignTag"]=function(e,t,i){S.showAssignTagsModal(t,i)},h5.actions["vsphere.core.common.actions.addCategory"]=function(e,t,i){s.openModal(e,t,i,"common-module-ui/resources/common-module/views/categories/add-edit-category.html")},h5.actions["vsphere.core.common.actions.editCategory"]=function(e,t){t&&u.getAll().then(function(e){var i=D(e);c.getProperties(t[0],["name","description","multipleCardinality","associableEntityType"]).then(function(e){var r="";null===e.associableEntityType&&(r=l.getString("Common","tag.dashboard.categories.associable.all"));var n=t[0].split(":"),o={type:n[2],value:n[3],serverGuid:n[4]},a={categoryName:e.name,managedObjectReference:o,categoryDescription:e.description,multipleCardinality:e.multipleCardinality,displayAssociableEntityTypesString:r,associableEntityTypes:e.associableEntityType};p.addEditCategory(i,a)})})},h5.actions["vsphere.core.common.actions.deleteCategory"]=function(t,r){if(r){var n="com.vmware.vsphere.client.tagging.CategoryCreateSpec";e.remove(r,n,{}),i._navigateToView("vsphere.core.tagsAndCustomAttributes.domainView")}},h5.actions["vsphere.opsmgmt.alarms.creation"]=function(e,t){_.isEmpty(t)||y.openManageAlarmWizard(t)},h5.actions["vsphere.core.common.actions.rename"]=function(e,t){b(t,e)},h5.actions["vsphere.core.common.actions.delete"]=function(t,i){e.remove(i[0])},h5.actions["vsphere.core.library.delete"]=function(e,t){d.deleteContentLibrary(t)},h5.actions["vsphere.core.library.subscribed.editSettings"]=function(e,t){
var i=g.get("vscSubscribedLibraryEditSettingsModalService");i.openSubscribedLibraryEditSettingsDialog(t[0])},h5.actions["vsphere.core.library.editNotesAction"]=function(t,i,r){function n(t,i,r){var n="com.vmware.vsphere.client.library.specs.EditLibraryBasicSpec",o={description:i};return e.apply(t,n,o,r),!0}var o={notesPropName:"com.vmware.content.LibraryModel/description",onUpdateNotesCallback:n,focusTarget:r?r.focusTarget:void 0};s.openModal(t,i,o,"common-module-ui/resources/common-module/views/notes/NotesDialog.html")},h5.actions["vsphere.core.library.item.actions.editNotesAction"]=function(t,i,r){function n(t,i,r){var n="com.vmware.vsphere.client.libraryItem.specs.EditLibraryItemSpec",o={itemDescription:i};return e.apply(t,n,o,r),!0}var o={notesPropName:"com.vmware.content.library.ItemModel/description",onUpdateNotesCallback:n,focusTarget:r?r.focusTarget:void 0};s.openModal(t,i,o,"common-module-ui/resources/common-module/views/notes/NotesDialog.html")},h5.actions["vsphere.core.library.add"]=function(e,t){v.showWizard(t[0])},h5.actions["vsphere.core.libraryItem.import"]=function(e,t){var i=m.get("vscImportLibraryItemInvoker");i.openImportLibraryItemModal(t[0])},h5.actions["vsphere.core.library.rename"]=function(e,t){var i=g.get("vscRenameLibraryService");i.renameLibrary(t[0])},h5.actions["vsphere.core.library.local.editSettings"]=function(e,t,i){var r=g.get("vscLocalEditSettingsModalService");r.openLocalEditSettingsDialog(t[0],i)},h5.actions["vsphere.core.library.sync"]=function(e,t){var i=m.get("vscSyncLibraryService");i.startLibrarySync(t)},h5.actions["vsphere.core.library.item.actions.deployFromTemplate"]=function(e,t){var i=m.get("createVmWizardService"),r=m.get("creationTypeConstants");c.getProperties(t[0],[E,V,T]).then(function(e){var n,o,a;if(e&&e[E]===P.VM_TEMPLATE&&e.hasOwnProperty(V)){var s=e[V];n=r.DEPLOY_VM_FROM_VMTX,o=h.createVmomiUri(s.type,s.value,s.serverGuid),a={libraryItemId:t[0],vmtxLibraryItemId:o,libraryItemName:e[T]}}else n=r.DEPLOY_VM_FROM_TEMPLATE,o=t[0];i.showWizard(o,n,a)})},h5.actions["vsphere.core.library.item.actions.publishVmtxTemplate"]=function(e,t){var i=g.get("vscPublishVmtxTemplateService");i.invokePublishDialog(t[0])},h5.actions["vsphere.core.library.item.actions.deployFromVapp"]=function(e,t){var i=m.get("createVmWizardService"),r=m.get("creationTypeConstants"),n={},o=r.DEPLOY_VM_FROM_VAPP,a=t[0];i.showWizard(a,o,n)},h5.actions["vsphere.core.library.item.actions.updateItem"]=function(e,t){var i=m.get("vscImportLibraryItemInvoker");i.openImportLibraryItemModal(t[0],!0)},h5.actions["vsphere.core.library.item.actions.exportItem"]=function(e,t){var i=m.get("vscExportLibraryItemService");i.exportLibraryItem(t[0])},h5.actions["vsphere.core.library.item.actions.cloneItem"]=function(e,t){var i=m.get("vscCloneItemModalInvokerService");i.openModal(t)},h5.actions["vsphere.core.library.item.actions.deleteItem"]=function(e,t){var i=g.get("vscDeleteLibraryItemService");i.deleteLibraryItem(t)},h5.actions["vsphere.core.library.item.actions.syncItem"]=function(e,t){var i=g.get("vscSyncLibraryItemService");i.syncLibraryItem(t)},h5.actions["vsphere.core.library.item.actions.evictLibraryItem"]=function(e,t){var i=g.get("vscEvictLibraryItemService");i.evictLibraryItem(t)},h5.actions["vsphere.core.library.item.actions.renameItem"]=function(e,t){var i=g.get("vscRenameLibraryItemService");i.renameLibraryItem(t[0])},h5.actions["vsphere.core.library.item.actions.createSubscription"]=function(e,t){var i=g.get("vscCreateSubscriptionWizardActionInvokerService");i.invoke(e,t)},h5.dragAndDropValidationMethods.equalServerGuid=function(e,t){var i=h.getManagedObjectReference(e),r=h.getManagedObjectReference(t);return i.serverGuid===r.serverGuid},h5.dragAndDropValidationMethods.isDatacenterFolder=function(e){return f.isDatacenterFolder(e)},h5.dragAndDropValidationMethods.isVmFolder=function(e){return f.isVmFolder(e)},h5.dragAndDropValidationMethods.isTargetAccessible=function(e){return f.isTargetAccessible(e)},h5.dragAndDropValidationMethods.isWithinSameDatacenter=function(e,t){return f.isWithinSameDatacenter(e,t)},h5.dragAndDropValidationMethods.isVmFolderWithinSameDatacenter=function(e,t){return f.isVmFolderWithinSameDatacenter(e,t)},h5.dragAndDropValidationMethods.isWithinSameClusterOrHost=function(e,t){return f.isWithinSameClusterOrHost(e,t)},h5.dragAndDropValidationMethods.isWithinSameStandaloneHost=function(e,t){return f.isWithinSameStandaloneHost(e,t)},h5.dragAndDropValidationMethods.notDirectParent=function(e,t){return!f.hasDirectParent(e,t)},h5.dragAndDropValidationMethods.isInVmFolderWithinSameDatacenter=function(e,t){return f.isInVmFolderWithinSameDatacenter(e,t)}}]).run(["tagActionService","i18nService","defaultUriSchemeUtil","mutationService","dataService","$rootScope",function(e,t,i,r,n,o){h5.actions["vsphere.core.common.actions.addTag"]=function(){e.modifyTag({name:t.getString("CommonModuleUi","tag.create.form.defaultName"),description:"",mode:0})},h5.actions["vsphere.core.common.actions.editTag"]=function(t,r,o){if(o&&o.tag){var a=i.getVsphereObjectId(o.tag.resourceObject);e.modifyTag({name:o.tag.name,description:o.tag.description,mode:1,categoryName:o.tag.categoryName},a)}else{if(!r)return;n.getProperties(r[0],["name","description","categoryName"]).then(function(t){e.modifyTag({name:t.name,description:t.description,mode:1,categoryName:t.categoryName},r)})}},h5.actions["vsphere.core.common.actions.deleteTag"]=function(t,i,n){if(!n||!n.tag){if(!i)return;var a="com.vmware.vsphere.client.tagging.TagCreateSpec";r.remove(i,a,{}),o._navigateToView("vsphere.core.tagsAndCustomAttributes.domainView")}e.deleteTag(JSON.parse(JSON.stringify(n.tag.resourceObject)))}}]).run(["columnRenderersRegistry","templateHelperService",function(e,t){e.registerColumnRenderers({"vcenter-name":function(t,i,r){var n=t[0],o=t[1],a=e.getColumnRenderer("object-link");return a([o,n,"vsphere-icon-vcenter"],i,r)},"tpm-supported":function(e,i,r){var n=i[e[0]],o="Not Supported";n&&(o="Supported");var a="<span>{{text}}</span>",s=t.getHtmlEscapingTemplateRenderFunction(a);return s({text:o})},"tpm-version":function(e,i,r){var n=i[e[0]];n||(n="N/A");var o="<span>{{text}}</span>",a=t.getHtmlEscapingTemplateRenderFunction(o);return a({text:n})},txtEnabled:function(e,i,r){var n=i[e[0]];n||(n="N/A");var o="<span>{{text}}</span>",a=t.getHtmlEscapingTemplateRenderFunction(o);return a({text:n})},"tpm-attestion-status":function(e,i,r){var n=i[e[0]],o="N/A",a="<div><span>{{text}}</span></div>";"accepted"===n?o="Passed":"notAccepted"===n&&(a="<div><clr-icon shape='exclamation-circle' class='is-error' size='25'></clr-icon><span>{{text}}</span></div>",o="Failed");var s=t.getHtmlEscapingTemplateRenderFunction(a);return s({text:o})},"tpm-attestion-time":function(e,i,r){var n=i[e[0]],o="N/A";n&&(o=moment(n).format("MM/DD/YYYY, h:mm A"));var a="<span>{{text}}</span>",s=t.getHtmlEscapingTemplateRenderFunction(a);return s({text:o})},"tpm-attestion-message":function(e,i,r){var n=i[e[0]],o="";n&&(o=n);var a="<span>{{text}}</span>",s=t.getHtmlEscapingTemplateRenderFunction(a);return s({text:o})},"tpm-txt-enabled":function(e,i,r){var n=i[e[0]],o="Off";n&&(o="On");var a="<span>{{text}}</span>",s=t.getHtmlEscapingTemplateRenderFunction(a);return s({text:o})}})}]);var h5_client;!function(e){var t;!function(e){!function(e){e[e.invalid=0]="invalid",e[e.fetchLibrary=1]="fetchLibrary",e[e.addLibrary=2]="addLibrary",e[e.deleteLibrary=3]="deleteLibrary",e[e.updateLibrary=4]="updateLibrary"}(e.LibraryOperations||(e.LibraryOperations={}));var t=(e.LibraryOperations,function(){function e(){}return e.LIBRARYTYPE_LOCAL="LOCAL",e.LIBRARYTYPE_SUBSCRIBED="SUBSCRIBED",e.SYNC_STRATEGY_IMMEDIATE="SYNC_IMMEDIATE",e.SYNC_STRATEGY_ONDEMAND="SYNC_ONDEMAND",e.CREATE_LIBRARY_DEFAULT_USER="vcsp",e.CREATE_LIBRARY_AUTHENTICATION_BASIC="BASIC",e.CREATE_LIBRARY_AUTHENTICATION_NONE="NONE",e}());e.ContentLibraryConstants=t;var t;!function(e){var t=function(){function e(){}return e.SCHEME="https://",e.VAPI_REST_BASE="/rest/com/vmware",e.VAPI_REST_SESSION="/cis/session",e.ADD_LIBRARY_LOCAL="/content/local-library",e.ADD_LIBRARY_SUBSCRIBED="/content/subscribed-library",e.FETCH_LIBRARY="/content/library/id:",e.DELETE_LIBRARY_LOCAL="/content/local-library/id:",e.DELETE_LIBRARY_SUBSCRIBED="/content/subscribed-library/id:",e}();e.Api=t}(t=e.ContentLibraryConstants||(e.ContentLibraryConstants={}))}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),angular.module("com.vmware.vsphere.client.commonModule").constant("drsFaultsViewConstants",{FIELD_KEY:"field",ICON_KEY:"icon",TARGET_KEY:"target",DETAILS_KEY:"details",REASON:"reason",LOCALIZED_REASON:"reasonLocalized",ICON_FIELD:"icon",ICON_TARGET_FIELD:"target.icon",TARGET_TEXT_FIELD:"target.text",REASON_ICON_CLASS:"reasonIconClass",PREVENTED_RECOMMENDATION:"preventedRecommendation",PREVENTED_RECOMMENDATION_ICON_CLASS:"preventedRecommendationIconClass",ID_KEY:"id",NAME_KEY:"name",TEXT_KEY:"text",DESCRIPTION_KEY:"description",HOST_NAME_KEY:"hostName",HOST_ICON_KEY:"hostIcon",VM_NAME_KEY:"vmName",VM_ICON_KEY:"vmIcon",DISK_NAME_KEY:"disk"}),function(){"use strict";angular.module("com.vmware.vsphere.client.commonModule").constant("hostConnectionState",{CONNECTED:"connected",DISCONNECTED:"disconnected",NOT_RESPONDING:"notResponding"})}();var h5_client;!function(e){var t=function(){function e(){}return e.ANY_COMPUTE_RESOURCE="AnyComputeResource",e.COMPUTE_RESOURCE="ComputeResource",e.CLUSTER="ClusterComputeResource",e.DATACENTER="Datacenter",e.DATASTORE="Datastore",e.FOLDER="Folder",e.HOST="HostSystem",e.HOST_PROFILE="HostProfile",e.RESOURCE_POOL="ResourcePool",e.STORAGE_POD="StoragePod",e.V_APP="VirtualApp",e.VIRTUAL_MACHINE="VirtualMachine",e.NETWORK="Network",e.DISTRIBUTED_VIRTUAL_PORTGROUP="DistributedVirtualPortgroup",e.OPAQUE_NETWORK="OpaqueNetwork",e.VM_TEMPLATE="vm-template",e}();e.ManagedEntityConstants=t,angular.module("com.vmware.vsphere.client.commonModule").constant("managedEntityConstants",t)}(h5_client||(h5_client={})),function(){angular.module("com.vmware.vsphere.client.commonModule").directive("rangeInput",function(){return{restrict:"A",require:"?ngModel",scope:{ngModel:"="},link:function(e,t,i,r){"type"in i&&"range"===i.type.toLowerCase()&&(r.$parsers.push(Number),e.$watch("ngModel",function(e){e||(e=0),t.val(e)}))}}})}(),function(){"use strict";function e(){function e(e,t){function i(){return d}function r(e){return d.find(function(t){return t.key===e})}function n(){var i=[];t&&(i=angular.copy(e));var r={};return i.forEach(function(e){e.value=null,r[e.key]=e}),t||_.each(u,function(e){i.push({_type:"com.vmware.vim.binding.vim.storageDrs.OptionSpec",option:{_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.key,value:e.value},operation:"remove",removeKey:e.key})}),d.forEach(function(e){return!(e&&e.key&&e.value)||void(r[e.key]?r[e.key].value=e.value:t?i.push({_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.key,value:e.value}):void 0!==e.type&&i.push({_type:"com.vmware.vim.binding.vim.storageDrs.OptionSpec",option:{_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.key,value:e.value},operation:e.type}))}),i}function o(e){var t=c(),i={key:e.key,value:e.value,id:t,type:"add"};return p[t]=i,d=d.concat([i]),t}function a(i,r){var n=p[i];if(t)n.key=r.key,n.value=r.value,n.type="edit";else{var o,a=!1;_.each(e,function(e,t){t+1===n.id&&e.key===n.key&&(o={key:e.key,value:e.value,type:"remove"},a=!0)}),n.key===r.key&&a?(n.value=r.value,n.type="edit"):(a&&u.push(o),n.key=r.key,n.value=r.value,n.type="add")}}function s(t){var i=!1;void 0!==p[t]&&_.each(e,function(e,r){r+1===p[t].id&&(i=!0)}),d=d.filter(function(e){return e.id!==t}),i&&u.push(p[t]),delete p[t]}function c(){return++l}var l=0;e=e||[];var d=e.map(function(e){return{key:e.key,value:e.value,id:c()}}),u=[],p=[];return d.forEach(function(e){p[e.id]=e}),{getOptions:i,getOptionByKey:r,buildOptions:n,addOption:o,updateOption:a,removeOption:s}}return{getBuilder:e}}angular.module("com.vmware.vsphere.client.commonModule").service("advancedOptionsBuilderFactory",e),e.$inject=[]}();var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.$injector=e}return e.prototype.get=function(e){return this.$injector.get(e)},e.$inject=["$injector"],e}();e.AngularInjector=t,angular.module("com.vmware.vsphere.client.commonModule").service("AngularInjector",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){function e(){function e(){return{Folder:{displayName:"folder",selection:!0,associableType:"Folder",associableTypeString:"Folder"},Cluster:{displayName:"cluster",selection:!0,associableType:"ClusterComputeResource",associableTypeString:"ClusterComputeResource"},Datacenter:{displayName:"datacenter",selection:!0,associableType:"Datacenter",associableTypeString:"Datacenter"},Datastore:{displayName:"datastore",selection:!0,associableType:"Datastore",associableTypeString:"Datastore"},DatastoreCluster:{displayName:"storagePod",selection:!0,associableType:"StoragePod",associableTypeString:"StoragePod"},DistributedPortGroup:{displayName:"dvpg",selection:!0,associableType:"DistributedVirtualPortgroup",associableTypeString:"DistributedVirtualPortgroup"},DistributedSwitch:{displayName:"dvs",selection:!0,associableType:"DistributedVirtualSwitch",associableTypeString:"DistributedVirtualSwitch",associatedTypes:["VmwareDistributedVirtualSwitch"]},Host:{displayName:"host",selection:!0,associableType:"HostSystem",associableTypeString:"HostSystem"},Library:{displayName:"library",selection:!0,associableType:"com.vmware.content.Library",associableTypeString:"Library"},LibraryItem:{displayName:"libraryItem",selection:!0,associableType:"com.vmware.content.library.Item",associableTypeString:"LibraryItem"},Network:{displayName:"network",selection:!0,associableType:"HostNetwork",associableTypeString:"HostNetwork",associatedTypes:["Network","OpaqueNetwork"]},ResourcePool:{displayName:"rp",selection:!0,associableType:"ResourcePool",associableTypeString:"ResourcePool"},vApp:{displayName:"vapp",selection:!0,associableType:"VirtualApp",associableTypeString:"VirtualApp"},VirtualMachine:{displayName:"vm",selection:!0,associableType:"VirtualMachine",associableTypeString:"VirtualMachine"}}}function t(){return{Folder:{displayName:"folder",associableType:"Folder",associableTypeString:"Folder"},Cluster:{displayName:"cluster",associableType:"ClusterComputeResource",associableTypeString:"ClusterComputeResource"},Datacenter:{displayName:"datacenter",associableType:"Datacenter",associableTypeString:"Datacenter"},Datastore:{displayName:"datastore",associableType:"Datastore",associableTypeString:"Datastore"},DatastoreCluster:{displayName:"storagePod",associableType:"StoragePod",associableTypeString:"StoragePod"},DistributedPortGroup:{displayName:"dvpg",associableType:"DistributedVirtualPortgroup",associableTypeString:"DistributedVirtualPortgroup"},DistributedSwitch:{displayName:"dvs",associableType:"DistributedVirtualSwitch",associableTypeString:"DistributedVirtualSwitch"},Host:{displayName:"host",associableType:"HostSystem",associableTypeString:"HostSystem"},Network:{displayName:"network",associableType:"HostNetwork",associableTypeString:"Network"},OpaqueNetwork:{displayName:"opaqueNetwork",associableType:"OpaqueNetwork",associableTypeString:"OpaqueNetwork"},ResourcePool:{displayName:"rp",associableType:"ResourcePool",associableTypeString:"ResourcePool"},vApp:{displayName:"vapp",associableType:"VirtualApp",associableTypeString:"VirtualApp"},VirtualMachine:{displayName:"vm",associableType:"VirtualMachine",associableTypeString:"VirtualMachine"}}}var i={get:e,getTypeDataForAttributes:t};return i}angular.module("com.vmware.vsphere.client.commonModule").factory("associableObjectTypesService",e)}(),function(){function e(e,t){function i(){return e.bowser.name}function r(){return e.bowser.version}function n(){var t=/^((?!chrome|android).)*safari/i.test(e.navigator.userAgent.toLowerCase());return t}function o(){return e.navigator.userAgent.toLowerCase().indexOf("chrome")>=0&&e.navigator.vendor.toLowerCase().indexOf("google inc")>=0}function a(){return e.navigator.userAgent.toLowerCase().indexOf("edge")>=0}function s(){var t=e.navigator.userAgent.toLowerCase(),i=t.indexOf("msie")>=0,r=t.indexOf("trident/7")>=0;return i||r}function c(){return e.navigator.userAgent.toLowerCase().indexOf("firefox")>=0}function l(){if(void 0!==p)return p;if(p=!1,(a()||o())&&(p=!0),c()){var e=parseInt(r());e>=50&&(p=!0)}return p}function d(){var i=t.defer();if(v)i.resolve(v);else{var r=e.open();setTimeout(function(){v=u(r),i.resolve(v)},100)}return i.promise}function u(e){return!(!e||0===e.outerHeight)&&(e.close(),!0)}var p,v,m={name:i(),version:r(),isSafari:n(),isEdge:a(),isIe:s(),isFirefox:c,isWebkitDirectorySupported:l,areBlockingPopupsAllowed:d};return m}angular.module("com.vmware.vsphere.client.commonModule").factory("browserService",e),e.$inject=["$window","$q"]}();var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n){this.categoryService=e,this.clarityModalService=t,this.i18nService=i,this.$q=r,this.$rootScope=n}return e.prototype.deleteCategory=function(e){var t=this;this.categoryService.getCategoryDetails(e).then(function(i){var r=null!==i.childTags?i.childTags.length:0,n={title:t.i18nService.getString("CommonModuleUi","categoryAction.remove.dialog.title"),message:t.i18nService.getString("CommonModuleUi","categoryAction.remove.warning",i.name)+t.i18nService.getString("CommonModuleUi","categoryAction.remove.warning.tags",r),icon:"vsphere-icon-status-warning",submit:function(){t.categoryService.deleteCategory(e).then(function(){t.$rootScope.$broadcast("refreshCategories")})},preserveNewlines:!0};t.clarityModalService.openConfirmationModal(n)})},e.prototype.addEditCategory=function(e,t){var i={},r=this.i18nService.getString("CommonModuleUi","add.category");if(t){var n=t.displayAssociableEntityTypesString===this.i18nService.getString("Common","tag.dashboard.categories.associable.all");i={allSelected:n,categoryMoRef:t.managedObjectReference,description:t.categoryDescription,displayAssociableEntityTypesString:t.displayAssociableEntityTypesString,multipleCardinality:t.multipleCardinality,name:t.categoryName,selectedAssociableEntityTypes:t.associableEntityTypes},r=this.i18nService.getString("CommonModuleUi","edit.category")}var o={action:{label:r}},a={categories:e,categoryState:i,title:r};this.clarityModalService.openModal(o,null,a,"common-module-ui/resources/common-module/views/categories/add-edit-category.html")},e.$inject=["categoryService","clarityModalService","i18nService","$q","$rootScope"],e}();e.CategoryActionService=t,angular.module("com.vmware.vsphere.client.commonModule").service("categoryActionService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,i,r){function n(){return e.get(t).then(function(e){return e.data})}function o(i,r,n,o){var a={categoryName:i,categoryDescription:r,multipleCardinality:n,associableEntityTypes:o};return e.post(t,a)}function a(i){return e["delete"](t+"/"+i.value)}function s(e){return i.getProperties(r.createVmomiUri(e.type,e.value,e.serverGuid),["name","childTags"])}function c(i,r,n,o,a){var s={categoryName:r,categoryDescription:n,multipleCardinality:o,associableEntityTypes:a};return e.put(t+"/"+i.value,s)}return{getAll:n,addCategory:o,deleteCategory:a,getCategoryDetails:s,editCategory:c}}angular.module("com.vmware.vsphere.client.commonModule").service("categoryService",e),e.$inject=["$http","dataService","defaultUriSchemeUtil"];var t="tagging-ui/ctrl/categories"}();var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.ContentLibraryConstants,r=function(){function e(e,t,r,n){var o=this;this.$http=e,this.$q=t,this.$location=r,this.dataService=n,this.PROP_REST_AUTH_TOKEN_TYPE="urn:vri:vsphere:vSphereClientInstance:root",this.PROP_REST_AUTH_TOKEN="vApiRestAuthToken",this.PROP_REST_ENDPOINT="vApiRestEndpoint",this.HTTP_MIME_TYPE="application/json",this.endpoint=null,this.login=function(){return o.vmwareApiSessionId?o.$q.when({}):o.dataService.getProperties(o.PROP_REST_AUTH_TOKEN_TYPE,[o.PROP_REST_AUTH_TOKEN,o.PROP_REST_ENDPOINT]).then(function(e){"localhost"===o.$location.host()&&o.setEndpoint(e.vApiRestEndpoint);var t={Authorization:'SIGN token = "'+e.vApiRestAuthToken+'"'};return t.Accept=o.HTTP_MIME_TYPE,t["Content-Type"]=o.HTTP_MIME_TYPE,t["vmware-use-header-authn"]="true",o.$http({method:"POST",url:o.getEndpoint()+i.Api.VAPI_REST_SESSION,headers:t})}).then(function(e){e.data&&(o.vmwareApiSessionId=e.data.value)},function(e){delete o.vmwareApiSessionId})}}return e.prototype.logout=function(){var e=this;this.$http({method:"DELETE",url:this.getEndpoint()+i.Api.VAPI_REST_SESSION}).then(function(){delete e.vmwareApiSessionId},function(t){delete e.vmwareApiSessionId})},e.prototype.isVapiSessionAlive=function(){return this.$http({method:"POST",url:this.getEndpoint()+"/cis/session?~action=get"}).then(function(){return!0},function(e){return!1})},e.prototype.isSessionReady=function(){return!!this.vmwareApiSessionId},e.prototype.getEndpoint=function(){return this.endpoint?this.endpoint:i.Api.SCHEME+this.$location.host()+i.Api.VAPI_REST_BASE},e.prototype.getVmwareApiSessionId=function(){return this.vmwareApiSessionId},e.prototype.setEndpoint=function(e){this.endpoint=i.Api.SCHEME+this.parseHostName(e)+i.Api.VAPI_REST_BASE},e.prototype.parseHostName=function(e){var t=document.createElement("a");return t.href=e,t.hostname},e.prototype.removePort=function(e){var t=i.Api.SCHEME,r=e.indexOf("/",t.length+1),n=e.indexOf(":",t.length+1);return e.substring(0,n)+e.substring(r)},e.$inject=["$http","$q","$location","dataService"],e}();t.VapiSessionService=r,angular.module("com.vmware.vsphere.client.commonModule").service("vapiSessionService",r)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.ContentLibraryConstants,r=function(){function e(e){var t=this;this.defaultUriSchemeUtil=e,this.reset=function(){return t.libraryData=null,t},this.setData=function(e){return t.libraryData=e,t},this.buildModel=function(){if(!t.libraryData||!t.libraryData.datastore)return{};var e={create_spec:{storage_backings:[{datastore_id:t.defaultUriSchemeUtil.getPartsFromVsphereObjectId(t.libraryData.datastore.id).value,type:"DATASTORE"}],name:t.libraryData.name,type:t.libraryData.type,server_guid:t.libraryData.vcService.serviceGuid,version:"string",id:"string",description:t.libraryData.description}};if(t.libraryData.isPublished&&t.buildPublishInfo(t.libraryData,e.create_spec),t.libraryData.type===i.LIBRARYTYPE_SUBSCRIBED){var r=!!t.libraryData.subscriptionPassword&&t.libraryData.subscriptionPassword.length>0;angular.extend(e.create_spec,{subscription_info:{on_demand:t.libraryData.syncStrategy!==i.SYNC_STRATEGY_IMMEDIATE,authentication_method:r?i.CREATE_LIBRARY_AUTHENTICATION_BASIC:i.CREATE_LIBRARY_AUTHENTICATION_NONE,ssl_thumbprint:t.libraryData.sslThumbprint?t.libraryData.sslThumbprint:"",automatic_sync_enabled:!0,user_name:r?i.CREATE_LIBRARY_DEFAULT_USER:"",subscription_url:t.libraryData.subscriptionUrl}}),r&&angular.merge(e.create_spec,{subscription_info:{password:t.libraryData.subscriptionPassword}})}return e},this.buildPublishInfo=function(e,t){var r=i.CREATE_LIBRARY_AUTHENTICATION_NONE;e.isAuthenticationEnabled&&(r=i.CREATE_LIBRARY_AUTHENTICATION_BASIC),angular.extend(t,{publish_info:{persist_json_enabled:!1,authentication_method:r,publish_url:"",current_password:"",published:!0,password:e.password,user_name:e.userName}}),e.isStreamingOptimized&&angular.extend(t,{optimization_info:{optimize_remote_publishing:e.isStreamingOptimized}})}}return e.$inject=["defaultUriSchemeUtil"],e}();t.AddLibraryDataBuilder=r,angular.module("com.vmware.vsphere.client.commonModule").service("addLibraryDataBuilder",r)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.ContentLibraryConstants,r=function(){function e(){this.name="",this.type=i.LIBRARYTYPE_LOCAL,this.description="",this.isPublished=!1,this.isAuthenticationEnabled=!1,this.userName=i.CREATE_LIBRARY_DEFAULT_USER,this.password="",this.syncStrategy=i.SYNC_STRATEGY_IMMEDIATE,this.subscriptionUrl="",this.isSubscriptionAuthenticated=!1,this.subscriptionPassword="",this.sslThumbprint="",this.vcService={name:""},this.datastore={id:""},this.id=""}return e}();t.LibraryDataModel=r}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.LibraryOperations,r=e.common_module_ui.ContentLibraryConstants,n=function(){function e(){this.method=e.HTTP_POST}return e.HTTP_GET="GET",e.HTTP_POST="POST",e.HTTP_DELETE="DELETE",e}();t.RequestObject=n;var o=function(){function e(e,t){var r=this;this.addLibraryDataBuilder=e,this.defaultUriSchemeUtil=t,this.setBaseUrl=function(e){return r.baseUrl=e,r},this.setOperation=function(e){return r.op=e,r},this.setHeaders=function(e){return r.headers=e,r},this.buildApiRequest=function(e){var t=null;if(!e)return null;switch(r.op){case i.addLibrary:t=r.getAddLibraryRequest(e);break;case i.fetchLibrary:t=r.getFetchLibraryRequest(e);break;case i.deleteLibrary:t=r.getDeleteLibraryRequest(e);break;case i.updateLibrary:break;default:throw Error("Library operation unsupported")}return t&&(t.headers=r.headers),t}}return e.prototype.reset=function(){return this.baseUrl="",this.op=i.invalid,this},e.prototype.getAddLibraryRequest=function(e){var t=new n;t.data=this.addLibraryDataBuilder.setData(e).buildModel();var i=e.type===r.LIBRARYTYPE_LOCAL?r.Api.ADD_LIBRARY_LOCAL:r.Api.ADD_LIBRARY_SUBSCRIBED;return t.url=this.baseUrl+i,t},e.prototype.getFetchLibraryRequest=function(e){var t=new n,i=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e.id).value;return t.url=this.baseUrl+r.Api.FETCH_LIBRARY+i,t.method=n.HTTP_GET,t.data={},t},e.prototype.getDeleteLibraryRequest=function(e){var t=new n,i=e.type===r.LIBRARYTYPE_LOCAL?r.Api.DELETE_LIBRARY_LOCAL:r.Api.DELETE_LIBRARY_SUBSCRIBED;return t.url=this.baseUrl+i+e.id,t.method=n.HTTP_DELETE,t},e.$inject=["addLibraryDataBuilder","defaultUriSchemeUtil"],e}();t.LibraryApiBuilderService=o,angular.module("com.vmware.vsphere.client.commonModule").service("libraryApiBuilderService",o)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.ContentLibraryConstants,r=function(){function e(e,t){this.mutationService=e,this.defaultUriSchemeUtil=t,this.DELETE_LIBRARY_SPEC="com.vmware.vsphere.client.library.specs.DeleteLibrarySpec",this.ADD_LIBRARY_SPEC="com.vmware.vsphere.client.library.CreateLibrarySpec",this.VALIDATE_LIBRARY_SPEC="com.vmware.vsphere.client.library.specs.SubscriptionUrlValidatorSpec",this.DUMMY_LIBRARY="urn:vapi:com.vmware.content.Library:dummy"}return e.prototype.deleteContentLibrary=function(e){return this.mutationService.removeOnMultiEntity(e,this.DELETE_LIBRARY_SPEC,{})},e.prototype.addContentLibrary=function(e){var t={name:e.name,description:e.description,vcServiceGuid:e.vcService.serviceGuid,type:e.type,subscriptionUrl:e.subscriptionUrl,datastoreRefs:[this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e.datastore.id)],isAuthBasic:!!e.subscriptionPassword||!!e.isAuthenticationEnabled,isStreamOptimized:!!e.isStreamingOptimized,isExternallyPublished:!!e.isPublished,localPublishedUsername:e.isPublished?e.userName:null,localPublishedPassword:e.isPublished?e.password:null,sslThumbprint:e.sslThumbprint?e.sslThumbprint:"",subscribedUsername:this.getSubscriptionUsername(e),subscribedPassword:e.type===i.LIBRARYTYPE_SUBSCRIBED?e.subscriptionPassword:"",storageFileSystemPath:null,createLocalCopy:e.syncStrategy===i.SYNC_STRATEGY_IMMEDIATE,useFilesystem:!1,useDatastore:!0};return this.mutationService.add(this.ADD_LIBRARY_SPEC,t,"ADD")},e.prototype.validateSubscription=function(e,t,r){var n={name:"",subscriptionUrl:e,isAuthBasic:!!r,sslThumbprint:t?t:"",username:i.CREATE_LIBRARY_DEFAULT_USER,password:r};return this.mutationService.validate(this.DUMMY_LIBRARY,this.VALIDATE_LIBRARY_SPEC,n)},e.prototype.isSubscriptionAuthenticated=function(e){return!!e.subscriptionPassword&&e.subscriptionPassword.length>0},e.prototype.getSubscriptionUsername=function(e){return e.type===i.LIBRARYTYPE_SUBSCRIBED&&this.isSubscriptionAuthenticated(e)?i.CREATE_LIBRARY_DEFAULT_USER:""},e.$inject=["mutationService","defaultUriSchemeUtil"],e}();t.LibraryMutationService=r,angular.module("com.vmware.vsphere.client.commonModule").service("libraryMutationService",r)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.LibraryOperations,r=e.common_module_ui.ContentLibraryConstants,n=e.common_module_ui.LibraryDataModel,o=function(){function e(e,t,r,o,a,s){var c=this;this.mutationService=e,this.vapiSessionService=t,this.libraryApiBuilderService=r,this.defaultUriSchemeUtil=o,this.$http=a,this.$location=s,this.VALIDATE_LIBRARY_SPEC="com.vmware.vsphere.client.library.specs.SubscriptionUrlValidatorSpec",this.DUMMY_LIBRARY="urn:vapi:com.vmware.content.Library:dummy",this.deleteContentLibrary=function(e){c.vapiSessionService.login().then(function(){var t=c.vapiSessionService.getEndpoint(),r=new n;r.id=e;var o=c.libraryApiBuilderService.reset().setBaseUrl(t).setOperation(i.fetchLibrary).buildApiRequest(r);c.$http(o).then(function(e){var r=c.libraryApiBuilderService.reset().setBaseUrl(t).setOperation(i.deleteLibrary).buildApiRequest(e.data.value);return c.$http(r)}).then()})}}return e.prototype.addContentLibrary=function(e){var t=this;this.vapiSessionService.login().then(function(){var r=t.vapiSessionService.getEndpoint(),n=t.libraryApiBuilderService.reset().setBaseUrl(r).setOperation(i.addLibrary).setHeaders({"vmware-api-session-id":t.vapiSessionService.getVmwareApiSessionId()}).buildApiRequest(e);return t.$http(n)}).then()},e.prototype.validateSubscription=function(e,t,i){var n={name:"",subscriptionUrl:e,isAuthBasic:!!i,sslThumbprint:t?t:"",username:r.CREATE_LIBRARY_DEFAULT_USER,password:i};return this.mutationService.validate(this.DUMMY_LIBRARY,this.VALIDATE_LIBRARY_SPEC,n)},e.$inject=["mutationService","vapiSessionService","libraryApiBuilderService","defaultUriSchemeUtil","$http","$location"],e}();t.LibraryVapiService=o,angular.module("com.vmware.vsphere.client.commonModule").service("libraryVapiService",o)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n){this.libraryMutationService=e,this.libraryVapiService=t,this.featureFlagsService=i,this.defaultUriSchemeUtil=r,this.dataService=n,this.TARGET_LIBRARIES_PROP="targetLibraries",this.FOLDER="Folder",this.GROUPD1="group-d1"}return e.prototype.usingVapiService=function(){return!1},e.prototype.init=function(){this.service=this.usingVapiService()?this.libraryVapiService:this.libraryMutationService},e.prototype.deleteContentLibrary=function(e){this.init(),this.service.deleteContentLibrary(e)},e.prototype.addContentLibrary=function(e){return this.init(),this.service.addContentLibrary(e)},e.prototype.validateSubscription=function(e,t,i){return this.init(),this.service.validateSubscription(e,t,i)},e.prototype.getAllContentLibraryInVc=function(e){var t=e.serviceGuid,i=this.defaultUriSchemeUtil.createVmomiUri(this.FOLDER,this.GROUPD1,t);return this.dataService.getProperties(i,[this.TARGET_LIBRARIES_PROP])},e.$inject=["libraryMutationService","libraryVapiService","featureFlagsService","defaultUriSchemeUtil","dataService"],e}();e.LibraryService=t,angular.module("com.vmware.vsphere.client.commonModule").service("libraryService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r){
this.customAttributesService=e,this.clarityModalService=t,this.i18nService=i,this.$rootScope=r}return e.prototype.createCustomAttribute=function(){var e=this,t=e.i18nService.getString("Common","editCustomFieldDefinitionView.add.title");e.openAddEditCustomAttributeModal(t,{})},e.prototype.editCustomAttribute=function(e){var t=this,i=t.i18nService.getString("Common","editCustomAttributesView.title");t.openAddEditCustomAttributeModal(i,e)},e.prototype.deleteCustomAttribute=function(e){var t=this,i={title:t.i18nService.getString("Common","customFieldAction.delete.confirmation.title"),message:t.i18nService.getString("Common","customFieldAction.delete.confirmation.message"),icon:"vsphere-icon-status-warning",submit:function(){t.customAttributesService.deleteCustomAttribute(e).then(function(){t.$rootScope.$broadcast("refreshCustomAttributes")})},preserveNewlines:!0};t.clarityModalService.openConfirmationModal(i)},e.prototype.openAddEditCustomAttributeModal=function(e,t){var i={action:{label:e}},r={customAttributeState:angular.copy(t),title:e};this.clarityModalService.openModal(i,null,r,"common-module-ui/resources/common-module/views/custom-attributes/add-edit-custom-attribute.html")},e.$inject=["customAttributesService","clarityModalService","i18nService","$rootScope"],e}();e.CustomAttributesActionService=t,angular.module("com.vmware.vsphere.client.commonModule").service("customAttributesActionService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,t,i,r,n){function o(e){return n.getAllServersInfo().then(function(t){var i=[{key:e.key,operationId:"REMOVE"}],n=r.createVmomiUri("Folder","group-d1",t.serversInfo[0].serviceGuid);return u(n,i)})}function a(e,t){return n.getAllServersInfo().then(function(i){var n=[{attribute:e.attribute,operationId:"ADD",value:"",type:"global"!==t.associableTypeString?t.associableTypeString:null}],o=r.createVmomiUri("Folder","group-d1",i.serversInfo[0].serviceGuid);return u(o,n)})}function s(e){return n.getAllServersInfo().then(function(t){var i=[{key:e.key,attribute:e.attribute,operationId:"RENAME"}],n=r.createVmomiUri("Folder","group-d1",t.serversInfo[0].serviceGuid);return u(n,i)})}function c(t){return e.getProperties(t,["availableField","customValue"],{queryName:c.name+":"+t}).then(function(e){return _.map(e.availableField,function(t){var i=t.key,r=_.find(e.customValue,function(e){return e.key===i})||{},n=t.managedObjectType?t.managedObjectType.wsdlName:"global",o={attribute:t.name,value:r.value,key:i,type:n,typeLabel:v(n)};return o})})}function l(){return n.getAllServersInfo().then(function(t){var i={propertyName:"customAttributeFields",parameter:"anyObjectType",parameterType:"java.lang.String"},n=r.getVsphereObjectId(t.serversInfo[0].serviceInstance),o=["customAttributeFields"];return e.getProperties(n,o,{propertyParams:[i],queryName:l.name+":"+n}).then(d)})}function d(e){return e.customAttributeFields.map(function(e){var t=e.fieldDef.managedObjectType?e.fieldDef.managedObjectType.wsdlName:"global";return{attribute:e.fieldDef.name,type:t,typeFormatted:v(t),key:e.fieldDef.key}})}function u(e,i){var n="com.vmware.vsphere.client.attribute.CustomFieldSpec",o=[],a=r.getManagedObjectReference(e);return _.map(i,function(e){var t=p(a,e);o.push(t)}),t.applyMultiSpec(e,n,o,"Modifying Custom Attributes")}function p(e,t){switch(t.operationId){case"ADD":return{name:t.attribute,owner:e,value:t.value,operationId:t.operationId,typeName:"global"!==t.type?t.type:null};case"REMOVE":return{owner:e,operationId:t.operationId,key:t.key};default:return{name:t.attribute,owner:e,value:t.value,operationId:t.operationId,key:t.key}}}function v(e){return i.getString("Common","fieldType."+e)}return{getCustomAttributes:c,modifyCustomAttributes:u,getAllCustomAttributes:l,deleteCustomAttribute:o,renameCustomAttribute:s,addCustomAttribute:a}}angular.module("com.vmware.vsphere.client.commonModule").factory("customAttributesService",e),e.$inject=["dataService","mutationService","i18nService","defaultUriSchemeUtil","userSessionService"]}();var common_module_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.vuiConstants=e,this.i18nService=t,this.drsFaultsViewConstants=i,this.defaultUriSchemeUtil=r,this.linksUtil=n}return e.prototype.getMasterViewGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getMasterColumnDefs(),height:"100%"}},e.prototype.getDetailsViewGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.NONE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getDetailsColumnDefs(),height:"100%"}},e.prototype.interpolateWithLinks=function(e,t){var i=this,r=[];return t.forEach(function(e){var t=typeof e,n="";if("object"===t){var o=i.defaultUriSchemeUtil.getVsphereObjectId(e[i.drsFaultsViewConstants.ID_KEY]);n=i.linksUtil.generateObjectLink(o,e[i.drsFaultsViewConstants.NAME_KEY])}else"string"===t&&(n=e);r.push(n)}),this.i18nService.interpolate(e,r)},e.prototype.getMasterColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("Common","drs.faultControl.reasonColumnHeaderLabel"),field:this.drsFaultsViewConstants.LOCALIZED_REASON,type:"string",template:function(t){return e.gridColumnTemplate(e.drsFaultsViewConstants.LOCALIZED_REASON,e.drsFaultsViewConstants.ICON_FIELD,t)}},{displayName:this.i18nService.getString("Common","drs.faultControl.targetColumnHeaderLabel"),field:this.drsFaultsViewConstants.TARGET_TEXT_FIELD,type:"string",template:function(t){return e.gridColumnTemplate(e.drsFaultsViewConstants.TARGET_TEXT_FIELD,e.drsFaultsViewConstants.ICON_TARGET_FIELD,t)}}]},e.prototype.getDetailsColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("Common","drs.faultControl.details.faultColumnHeaderLabel"),field:this.drsFaultsViewConstants.REASON,type:"string",template:function(t){return e.gridColumnTemplate(e.drsFaultsViewConstants.REASON,e.drsFaultsViewConstants.REASON_ICON_CLASS,t)}},{displayName:this.i18nService.getString("Common","drs.faultControl.details.preventedRecommendationColumnHeaderLabel"),field:this.drsFaultsViewConstants.PREVENTED_RECOMMENDATION,type:"string",template:function(t){return e.gridColumnTemplate(e.drsFaultsViewConstants.PREVENTED_RECOMMENDATION,e.drsFaultsViewConstants.PREVENTED_RECOMMENDATION_ICON_CLASS,t)}}]},e.prototype.gridColumnTemplate=function(e,t,i){var r={};return r[this.drsFaultsViewConstants.FIELD_KEY]=e,r[this.drsFaultsViewConstants.ICON_KEY]=t,this.iconWithTextItemRenderer(r,i)},e.prototype.iconWithTextItemRenderer=function(e,t){var i=t||{};i.text=this.getNestedObjectProperty(t,e[this.drsFaultsViewConstants.FIELD_KEY]),i.icon=this.getNestedObjectProperty(t,e[this.drsFaultsViewConstants.ICON_KEY]);var r='<span class="'+i.icon+'"></span>';return[r,i.text].join("")},e.prototype.getNestedObjectProperty=function(e,t){var i=e;return t.split(".").forEach(function(e){i=i[e]}),i},e.$inject=["vuiConstants","i18nService","drsFaultsViewConstants","defaultUriSchemeUtil","linksUtil"],e}();e.DrsFaultsViewService=t,angular.module("com.vmware.vsphere.client.commonModule").service("drsFaultsViewService",t)}(common_module_ui||(common_module_ui={}));var common_module_ui;!function(e){var t=function(){function e(){}return e.prototype.createRecommendationsStore=function(e){return new i(e)},e}();e.DrsRecommendationsService=t;var i=function(){function e(e){var t=this;this.recommendations=e;var i=e.filter(function(e){return e.isFirst});this.selectableActionsByKey=_.indexBy(i,function(e){return e.parentRecommendation.key}),this.checkedRecommendations={},i.forEach(function(e){t.checkedRecommendations[e.parentRecommendation.key]=!0}),this.selectableActionsCount=i.length}return e.prototype.getRecommendationsToApply=function(){var e=this,t=[];this.recommendations.forEach(function(i){if(i.isFirst===!0){var r=i.parentRecommendation.key;e.checkedRecommendations[r]===!0&&t.push(r)}});var i=t.slice();return t.forEach(function(t){var r=e.selectableActionsByKey[t].prerequisiteRecommendations;i=i.filter(function(e){return r.indexOf(e)===-1})}),i},e.prototype.getCheckedRecommendationCount=function(){var e=_.filter(this.checkedRecommendations,function(e){return e===!0});return e.length},e.prototype.getSelectableActionsCount=function(){return this.selectableActionsCount},e.prototype.isRecommendationChecked=function(e){return this.checkedRecommendations[e]===!0},e.prototype.uncheckRecommendation=function(e){var t=this,i=!1;this.checkedRecommendations[e]=!1;var r=this.selectableActionsByKey[e];return r.dependantRecommendations.forEach(function(e){t.checkedRecommendations[e]===!0&&(t.checkedRecommendations[e]=!1,i=!0)}),i},e.prototype.checkRecommendation=function(e){var t=this,i=!1;this.checkedRecommendations[e]=!0;var r=this.selectableActionsByKey[e];return r.prerequisiteRecommendations.forEach(function(e){t.checkedRecommendations[e]===!1&&(t.checkedRecommendations[e]=!0,i=!0)}),i},e.prototype.getRecommendationKeys=function(){return this.recommendations.map(function(e){return e.parentRecommendation.key})},e}();e.RecommendationsStore=i,angular.module("com.vmware.vsphere.client.commonModule").service("drsRecommendationsService",t)}(common_module_ui||(common_module_ui={})),function(){"use strict";function e(){var e={Datacenter:"vsphere-icon-datacenter",ClusterComputeResource:"vsphere-icon-cluster",HostSystem:"vsphere-icon-host",Folder:"vsphere-icon-folder",Datastore:"vsphere-icon-datastore"};return{getByObjectRef:function(t){return e[t.type]},getByObjectType:function(t){return e[t]},parseIcon:function(e){e="string"!=typeof e?"":e;var t=e.split(":");return 1===t.length&&t.unshift(void 0),t}}}angular.module("com.vmware.vsphere.client.commonModule").service("iconService",e)}(),angular.module("com.vmware.vsphere.client.commonModule").service("managedEntityMutationService",["mutationService",function(e){return{rename:function(t,i,r){return e.apply(t,"com.vmware.vsphere.client.mixed.ManagedEntityNameInfo",i,r)}}}]),angular.module("com.vmware.vsphere.client.commonModule").factory("relatedItemsService",["$http",function(e){return{getRelatedItems:function(t){return e({method:"get",url:"relateditems/simple/"+t}).then(function(e){return e.data})},getRelatedItemsByRelationId:function(t,i,r){return e({method:"get",url:"relateditems/"+i+"/"+t+"?defaultProperties="+r}).then(function(e){return e.data})}}}]);var h5_client;!function(e){var t;!function(e){var t=function(){function t(e,t,i,r){var n=this;this.tagService=e,this.clarityModalService=t,this.i18nService=i,this.$rootScope=r,this.i18n=function(e,t){return n.i18nService.getString("CommonModuleUi",e,t)}}return t.prototype.deleteTag=function(e){var t=this;this.tagService.getEntityObjectsCount(e).then(function(i){var r=t.i18n("tagAction.remove.warning");i&&(r=r+"\n"+t.i18n("tagAction.remove.entity.count",i));var n={title:t.i18n("tagAction.remove.dialog.title"),message:r,icon:"vsphere-icon-status-warning",submit:function(){t.tagService.deleteTag(e).then(function(){t.$rootScope.$broadcast("refreshTagGrid")})},preserveNewlines:!0};t.clarityModalService.openConfirmationModal(n)})},t.prototype.modifyTag=function(t,i){var r={modifyTagData:t,categoryData:{}},n={contentTemplate:"common-module-ui/resources/common-module/views/tags/modify-tag-dialog.html",title:t.mode===e.ModifyTagMode.ADD?this.i18n("tag.action.add"):this.i18n("tag.action.edit"),defaultButton:"submit",onSubmit:t.mode===e.ModifyTagMode.ADD?this.onTagAdd.bind(this,r):this.onTagModify.bind(this,i,r),dialogData:r,submitDisabled:!0};t.mode===e.ModifyTagMode.EDIT&&(n.subTitle={text:angular.copy(t.name)}),this.clarityModalService.openOkCancelModal(n)},t.prototype.onTagAdd=function(e){var t=this;return this.tagService.createTag(e.modifyTagData.name,e.modifyTagData.description,e.categoryData.selectedCategory.managedObjectReference).then(function(e){return t.$rootScope.$broadcast("refreshTagGrid"),e})},t.prototype.onTagModify=function(e,t){var i=this;return this.tagService.editTag(e,t.modifyTagData.name,t.modifyTagData.description).then(function(e){return i.$rootScope.$broadcast("refreshTagGrid"),e})},t.$inject=["tagService","clarityModalService","i18nService","$rootScope"],t}();e.TagActionService=t,angular.module("com.vmware.vsphere.client.commonModule").service("tagActionService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,t,i,r){function n(e){var t={};return _.each(e,function(e,r){var n=i.getPartsFromVsphereObjectId(r);t[r]=angular.extend({resourceObject:n},e)}),_.values(t)}function o(){return r.get(f).then(function(e){return e.data})}function a(t){var i="entity",r="inventoryservice:InventoryServiceTag",o=["name","description","categoryName"];return e.getPropertiesByRelation(t,i,r,o,{queryName:"getTagInfoForObject:"+t}).then(n)}function s(t){return e.getProperties(t,["assignableTagsForTarget"],{queryName:"getAssignableTagsForObject:"+t})}function c(e,r){var n={resources:[i.getMoRefOrURIref(r)]};return t.apply(i.getVsphereObjectId(e),m,n)}function l(e,r){var n={resources:[i.getMoRefOrURIref(r)],ignoreAlreadyAttached:!0};return t.apply(i.getVsphereObjectId(e.resourceObject),g,n)}function d(e,i,r){var n={tagName:e,tagDescription:i,categoryMoRef:r};return t.add(h,n)}function u(e,i,r){var n={tagName:i,tagDescription:r};return t.apply(e,h,n)}function p(e){var r=i.getVsphereObjectId(e);return t.remove(r,h,{})}function v(t){var r=i.createVmomiUri(t.type,t.value,t.serverGuid);return e.getProperties(r,["entityObjects"],{queryName:"getEntityObjectsCount:"+r}).then(function(e){return e.entityObjects.totalMatchedObjectCount})}var m="com.vmware.vsphere.client.tagging.TagDetachSpec",g="com.vmware.vsphere.client.tagging.TagAttachSpec",h="com.vmware.vsphere.client.tagging.TagCreateSpec",f="tagging-ui/ctrl/tags";return{getTagInfoForObject:a,getAssignableTagsForObject:s,detachTag:c,attachTag:l,getAllTags:o,createTag:d,deleteTag:p,getEntityObjectsCount:v,editTag:u}}angular.module("com.vmware.vsphere.client.commonModule").service("tagService",e),e.$inject=["dataService","mutationService","defaultUriSchemeUtil","$http"]}();var h5_client;!function(e){var t=function(){function e(e,t){this.defaultUriSchemeUtil=e,this.managedEntityConstants=t,this.FAILED_STATUS="__FAILED__",this.NOT_FOUND_STATUS="__NOT_FOUND__",this.DC_FOLDER_VALUE="group-d",this.HOST_FOLDER_VALUE="group-h",this.VM_FOLDER_VALUE="group-v"}return e.prototype.isTargetAccessible=function(e){var t=e.spriteCssClass?e.spriteCssClass:e.primaryIconId;switch(t){case"vsphere-icon-host-maintenance":case"vsphere-icon-host-disconnected":case"vsphere-icon-datastore-inaccessible":case"vsphere-icon-datastore-error":case"vsphere-icon-datastore-maintenance":return!1;default:return!0}},e.prototype.isVmFolder=function(e){var t=this.defaultUriSchemeUtil.getManagedObjectReference(e),i=t.type,r=t.value;return i===this.managedEntityConstants.FOLDER&&r.indexOf(this.VM_FOLDER_VALUE)!==-1},e.prototype.isDatacenterFolder=function(e){var t=this.defaultUriSchemeUtil.getManagedObjectReference(e),i=t.type,r=t.value;return i===this.managedEntityConstants.FOLDER&&r.indexOf(this.DC_FOLDER_VALUE)!==-1},e.prototype.isHostFolder=function(e){var t=this.defaultUriSchemeUtil.getManagedObjectReference(e),i=t.type,r=t.value;return i===this.managedEntityConstants.FOLDER&&r.indexOf(this.HOST_FOLDER_VALUE)!==-1},e.prototype.isWithinSameDatacenter=function(e,t){var i=this.hasCommonParent(e,t,"Datacenter");return void 0===i||i},e.prototype.isVmFolderWithinSameDatacenter=function(e,t){return!!this.isVmFolder(e.id)&&this.isWithinSameDatacenter(e,t)},e.prototype.hasDirectParent=function(e,t){var i=this;if(!e||!t)return!1;var r=_.map(t,function(e){return i.getDirectParent(e)});if(_.contains(r,this.FAILED_STATUS))return!1;var n=_.some(r,function(t){return e.id===t}),o=this.getDirectParent(e);if(o===this.FAILED_STATUS)return!1;var a=_.some(t,function(e){return e.id===o});return n||a},e.prototype.hasCommonParent=function(e,t,i){var r=this,n=this.getFirstParentOfType(e,i);switch(n){case this.FAILED_STATUS:return;case this.NOT_FOUND_STATUS:return!1}var o=_.map(t,function(e){return r.getFirstParentOfType(e,i)});if(!_.contains(o,this.FAILED_STATUS)){var a=_.every(o,function(e){return e===n});return a}},e.prototype.isWithinSameClusterOrHost=function(e,t){var i=this.hasCommonParent(e,t,"ClusterComputeResource");if(i)return!0;var r=this.hasCommonParent(e,t,"HostSystem");return void 0===r||void 0===i||r},e.prototype.isWithinSameStandaloneHost=function(e,t){return!!this.isStandaloneHost(e)&&this.isWithinSameClusterOrHost(e,t)},e.prototype.isInVmFolderWithinSameDatacenter=function(e,t){var i=this,r=_.map(t,function(e){return i.getDirectParent(e)});return!!_.contains(r,this.FAILED_STATUS)||this.hasCommonParent(e,t,"Datacenter")&&_.every(r,function(e){return i.isVmFolder(e)})},e.prototype.isStandaloneHost=function(e){var t=this.getFirstParentOfType(e,"ClusterComputeResource");switch(t){case this.FAILED_STATUS:return!0;case this.NOT_FOUND_STATUS:return!0;default:return!1}},e.prototype.getFirstParentOfType=function(e,t){if(!e)return this.FAILED_STATUS;for(;e;){var i=this.defaultUriSchemeUtil.getEntityType(e.id);if(!i)return this.FAILED_STATUS;if(i===t)return e.id;if(!e.parentNode)return this.FAILED_STATUS;e=e.parentNode()}return this.NOT_FOUND_STATUS},e.prototype.getDirectParent=function(e){if(!e||!e.parentNode)return this.FAILED_STATUS;var t=e.parentNode();return t&&t.id?t.id:this.FAILED_STATUS},e.$inject=["defaultUriSchemeUtil","managedEntityConstants"],e}();e.DragAndDropStockExpressionsService=t,angular.module("com.vmware.vsphere.client.commonModule").service("dragAndDropStockExpressionsService",t)}(h5_client||(h5_client={})),function(){"use strict";function e(){function e(e,t){var i="",r="vsphere.core.inventory.serverObjectViewsExtension",n=['"'+r+'"','"'+e+'"'],o=$("<a/>").addClass(i).attr("ng-click","$root._navigateToViewAndObject("+n.join(", ")+")").attr("title",t).text(t)[0].outerHTML;return'<div class="object object-link">'+o+"</div>"}return{generateObjectLink:e}}angular.module("com.vmware.vsphere.client.commonModule").factory("linksUtil",e)}();var common_module_ui;!function(e){var t=function(){function e(){this.UNIT_STEP=1024}return e.prototype.toMegabytes=function(e,t){var i=e/this.UNIT_STEP;return t?this.roundNumber(i,t):i},e.prototype.fromMegabytes=function(e){return e*this.UNIT_STEP},e.prototype.toGigabytes=function(e,t){var i=this.toMegabytes(e)/this.UNIT_STEP;return t?this.roundNumber(i,t):i},e.prototype.roundNumber=function(e,t){return Number(Math.round(Number(e+"e"+t))+"e-"+t)},e}();e.UnitFormatterService=t,angular.module("com.vmware.vsphere.client.commonModule").service("unitFormatterService",t)}(common_module_ui||(common_module_ui={})),angular.module("com.vmware.vsphere.client.commonModule").service("wizardPageService",["vuiConstants",function(e){function t(e,t){return _.find(e,function(e){return e.title===t})}function i(e,t){var i=_.find(e.flows,function(e){return e.id===t});if(!i)throw new Error("Could not find a valid flow with ID: "+t);return i}function r(t,i){var r=_.findIndex(t,function(e){return e.title===i});if(r===-1)throw new Error("Cannot find page index");var n=_.find(t.slice(r+1),function(t){return t.state!==e.wizard.pageState.SKIPPED});return n}function n(e,t){var r=[],o=i(e,t);if(!o||!o.pages||0===o.pages.length)return r;for(var a=o.pages,s=0;s<a.length;s++){r.push(a[s]);var c;if(a[s].hasOwnProperty("decisionOptions")){var l=a[s].decisionOptions;c=l.hasOwnProperty("selectedFlowId")?l.selectedFlowId:l.flowIds[0];var d=n(e,c);r=r.concat(d)}}return r}return{clearErrors:function(e){e.validationBanner.messages=[]},showLoadingIndicator:function(e){e.loading=!0},hideLoadingIndicator:function(e){e.loading=!1},markPageComplete:function(t,o){t.currentPage.state=e.wizard.pageState.COMPLETED;var a;if(o&&t.flows){var s=_.any(t.pages,function(e){return e.title===t.currentPage.title});if(s)a=i(t,o).pages[0];else{var c=n(t,o);a=r(c,t.currentPage.title)}a&&a.state===e.wizard.pageState.DISABLED&&(a.state=e.wizard.pageState.INCOMPLETE)}else a=r(t.pages,t.currentPage.title),a&&a.state!==e.wizard.pageState.COMPLETED&&(a.state=e.wizard.pageState.INCOMPLETE)},markPageIncompleteWithError:function(t,i){t.currentPage.state=e.wizard.pageState.INCOMPLETE,t.validationBanner.messages=[{text:i,type:e.validationBanner.type.ERROR}]},markPageIncompleteWithErrors:function(t,i){t.currentPage.state=e.wizard.pageState.INCOMPLETE,t.validationBanner.messages=_.map(i,function(t){return{text:t,type:e.validationBanner.type.ERROR}})},invalidateNextPages:function(t,i,r){var o;o=t.flows&&t.flows.length>0?n(t,i):t.pages;var a=_.findIndex(o,function(e){return e.title===r});if(a===-1)throw new Error("Cannot find page index");_.each(o,function(t,i){i>a&&t.state!==e.wizard.pageState.SKIPPED&&(t.state=e.wizard.pageState.DISABLED)})},initializePageStates:function(t){var i=_.map(t,function(t){return t.state=t.defaultState||e.wizard.pageState.DISABLED,t});return i[0].state=e.wizard.pageState.INCOMPLETE,i},initializeFlowStates:function(t){return _.map(t,function(t){return t.pages=_.map(t.pages,function(t){return t.state=t.defaultState||e.wizard.pageState.DISABLED,t}),t})},markPageSkipped:function(i,r){t(i,r).state=e.wizard.pageState.SKIPPED},markPageDisabled:function(i,r){t(i,r).state=e.wizard.pageState.DISABLED},showWarningMessages:function(t,i){t.validationBanner.messages=_.map(i,function(t){return{text:t,type:e.validationBanner.type.WARNING}})}}}]),function(){"use strict";function e(e,t,i){var r=i.getString;e.contentPatent=t.trustAsHtml(r("CommonUi","about.vsphere.content.patent",r("CommonUi","about.content.content.patentUrl")))}angular.module("com.vmware.vsphere.client.commonModule").controller("AboutVsphereController",e),e.$inject=["$scope","$sce","i18nService"]}(),function(){"use strict";function e(e,t){return{restrict:"E",templateUrl:"common-module-ui/resources/common-module/views/advanced-options/advancedOptions.html",scope:{items:"=",builder:"=",editable:"@",accessibility:"@?"},controller:["$scope","$element",function(i,r){function n(e){var r=252;e&&(r+=33);var n={selectionMode:t.grid.selectionMode.SINGLE,sortMode:t.grid.sortMode.SINGLE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:o(),height:r+"px"};return e&&angular.extend(n,{editable:{mode:"incell",createAt:"bottom"},actionBarOptions:{actions:[l,d]},save:function(e){var t={key:e.model.key,value:e.model.value};angular.extend(t,e.values),angular.isDefined(e.model.id)?i.builder.updateOption(e.model.id,t):e.model.id=i.builder.addOption(t)}}),n}function o(){return[{displayName:c("config.advancedOptions.optionColumnHeaderLabel"),field:"key",type:"string"},{displayName:c("config.advancedOptions.valueColumnHeaderLabel"),field:"value",type:"string"}]}function a(){r.find("[kendo-grid]").data("kendoGrid").addRow()}function s(){var e=i.gridOptions.selectedItems;0!==e.length&&e.forEach(function(e){i.builder.removeOption(e.id)})}function c(t){return e.getString("ClusterUi",t)}var l={id:"advancedOptionsGridAddButton",label:c("config.advancedOptions.button.add"),enabled:!0,iconClass:"vui-icon-action-add",onClick:a},d={id:"advancedOptionsGridRemoveButton",label:c("config.advancedOptions.button.delete"),enabled:!0,iconClass:"vui-icon-action-delete",onClick:s};i.gridOptions=n(i.editable),i.editable?(i.$watch("gridOptions.selectedItems",function(e){d.enabled=0!==e.length}),i.$watch("builder.getOptions()",function(e){var t=e?e:[];i.gridOptions.data=t})):i.$watch("items",function(e){var t=e?e:[];i.gridOptions.data=t})}]}}angular.module("com.vmware.vsphere.client.commonModule").directive("advancedOptions",e),e.$inject=["i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){d.alarmDetails=null;var e=o.getVsphereObjectId(d.selectedItem.alarmState.alarm);i.getProperties(e,"alarmDetails").then(function(e){d.alarmDetails=e.alarmDetails||void 0})}function c(){if(d.selectedItem){var e=d.selectedItem.alarmInfo.expression;if(e){var t="com.vmware.vim.binding.vim.alarm.OrAlarmExpression",i=e._type===t?"triggers.any":"triggers.all",r=n.getString(d.bundle,i);return n.getString(d.bundle,"triggersBlock.lblAllAny.states",[r])}}}function l(){var t=d.selectedItem.alarmInfo.entity.serverGuid,i=d.selectedItem.alarmInfo.entity.type,r=d.selectedItem.alarmInfo.entity.value,n=o.createVmomiUri(i,r,t);return n===e._route.objectId}var d=this;d.bundle="AlarmsUi";var u="com.vmware.opsmgmt.client.alarms.RemoveAlarmDefinitionSpec",p=n.getString(d.bundle,"alarmsDefTabView.tableHeaderText.name"),v=n.getString(d.bundle,"alarmsDefTabView.tableHeaderText.definedIn");d.openDeleteModal=function(){var e={title:n.getString("AlarmsUi","alarmSettingsWizard.confirm.removeAlarmDefinition.shorttitle"),message:n.getString("AlarmsUi","alarmSettingsWizard.confirm.removeAlarmDefinition.message",d.selectedItem.alarmInfo.name),icon:"vsphere-icon-status-warning",submit:d.deleteAlarm};a.openConfirmationModal(e)};var m={id:"delete-alarm-action",iconClass:"vsphere-icon-toolbar-remove",enabled:!1,tooltipText:n.getString("AlarmsUi","alarmAction.remove.description"),onClick:d.openDeleteModal};d.dataGridOptions={actionBarOptions:{actions:[m]},columnDefs:[{displayName:p,field:"alarmInfo.name",width:"150px"},{displayName:v,field:"definedInName",width:"150px"}],sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.SINGLE,selectedItems:[],data:[],height:"100%",resizable:!0},d.splitterOptions={orientation:t.splitter.orientation.VERTICAL,panes:[{min:"140px"},{min:"100px"}]},e.$watch("c.dataGridOptions.selectedItems",function(e){e.length>0?(d.selectedItem=e[0],d.stackViewOptions={header:{title:d.selectedItem.alarmInfo.name}},d.triggersTitle=c(),m.enabled=l(),s()):(m.enabled=!1,d.selectedItem=null)}),d.refreshAlarmsGrid=function(){return i.getProperties(e._route.objectId,"alarmDefinitions").then(function(e){d.dataGridOptions.data=e.alarmDefinitions})},d.getStatusImage=function(e){var t;switch(e){case"statusGreen":t="vsphere-icon-status-ok";break;case"statusYellow":t="vsphere-icon-status-warning";break;case"statusRed":t="vsphere-icon-status-error";break;case"statusUnknown":t="vsphere-icon-status-unknown"}return t},d.deleteAlarm=function(){var e=o.getVsphereObjectId(d.selectedItem.alarmState.alarm);return r.remove(e,u,{}).then(function(){d.refreshAlarmsGrid()})},d.refreshAlarmsGrid()}angular.module("com.vmware.vsphere.client.commonModule").controller("AlarmDefinitionsController",e),angular.module("com.vmware.vsphere.client.commonModule").filter("trusted",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),e.$inject=["$scope","vuiConstants","dataService","mutationService","i18nService","defaultUriSchemeUtil","clarityModalService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){g.errorMessage=t.getString("Common","tag.create.form.error.server.category.create"),g.validity="invalid"}function s(){g.allCheckbox=0===_.map(g.associableObjectTypes,"selection").filter(function(e){return!e}).length}function c(){Object.keys(g.associableObjectTypes).forEach(function(e){g.associableObjectTypes[e].disabled||(g.associableObjectTypes[e].selection=g.allCheckbox)})}function l(){var t,i=[];for(var r in g.associableObjectTypes)g.associableObjectTypes[r].selection&&(i.push(g.associableObjectTypes[r].associableType),g.associableObjectTypes[r].associatedTypes&&(i=i.concat(g.associableObjectTypes[r].associatedTypes)));if(h.name===g.name||u(g.name)){var s;s=h.categoryMoRef?e.editCategory(h.categoryMoRef,g.name,g.description,d(),i):e.addCategory(g.name,g.description,d(),i),t=o.all([s]).then(function(){n.$broadcast("refreshCategories")}),g.closeModal()}else a(),t=o.resolve();return t}function d(){return"multiple"===g.multipleCardinality}function u(e){return 0===_.filter(i.modalOptions.dialogData.categories,function(t){return t.categoryName===e}).length}function p(){return""===g.name||!(g.name||v())}function v(){return!!g.allCheckbox||Object.keys(g.associableObjectTypes).some(function(e){return g.associableObjectTypes[e].selection})}function m(e){return f.indexOf(g.associableObjectTypes[e].associableTypeString)!==-1}var g=this,h=i.modalOptions.dialogData.categoryState,f=h.selectedAssociableEntityTypes;g.associableObjectTypes=r.get(),g.multipleCardinality=h.multipleCardinality+""=="true"?"multiple":"single",g.description=h.description||"",g.name=h.name||"","undefined"!=typeof h.allSelected?(g.disableInputs=f&&Object.keys(g.associableObjectTypes).every(m),g.allCheckbox=g.allCheckbox||!f||g.disableInputs,"multiple"===g.multipleCardinality&&(g.isCardinalityDisabled=!0)):g.allCheckbox=!0,f&&Object.keys(g.associableObjectTypes).forEach(function(e){f.indexOf(g.associableObjectTypes[e].associableTypeString)!==-1?(g.associableObjectTypes[e].selection=!0,g.associableObjectTypes[e].disabled=!0):(g.associableObjectTypes[e].selection=g.allCheckbox,g.associableObjectTypes[e].disabled=g.allCheckbox)}),g.toggleAllTypes=s,g.toggleAllCheckbox=c,g.submit=l,g.okButtonDisabled=p,g.closeModal=function(){i.closeModal()}}angular.module("com.vmware.vsphere.client.commonModule").controller("addEditCategoryController",e),e.$inject=["categoryService","i18nService","$scope","associableObjectTypesService","$rootScope","$q"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){t.addEditCategory(p.datagridOptions.data)}function a(){var e=p.datagridOptions.selectedItems[0];t.deleteCategory(e.managedObjectReference)}function s(){t.addEditCategory(p.datagridOptions.data,p.datagridOptions.selectedItems[0])}function c(e){return _.map(e,function(e){return 0===e.associableEntityTypes.length?e.displayAssociableEntityTypesString=i.getString("Common","tag.dashboard.categories.associable.all"):e.displayAssociableEntityTypesString=l(e.associableEntityTypes).join(", "),e})}function l(e){return _.map(e,function(e){return i.getString("Common","typeResource.entityType."+e+"Plural")})}function d(){e.getAll().then(function(e){p.datagridOptions.data=c(e)})}function u(e,t){var i=document.createElement("span");return i.setAttribute("ng-non-bindable","ng-non-bindable"),i.title=e[t],i.textContent=e[t],i.outerHTML}var p=this,v={id:"add-category-action",iconClass:"vsphere-icon-toolbar-add",tooltipText:i.getString("CommonModuleUi","add.category"),enabled:!0,onClick:o},m={id:"edit-tag-action",iconClass:"vsphere-icon-toolbar-edit",tooltipText:i.getString("CommonModuleUi","edit.category"),enabled:!0,onClick:s},g={id:"delete-category-action",iconClass:"vsphere-icon-toolbar-remove",tooltipText:i.getString("CommonModuleUi","categoryAction.remove.desc"),enabled:!1,onClick:a};p.datagridOptions={actionBarOptions:{actions:[v,m,g]},columnDefs:[{displayName:i.getString("Common","tag.dashboard.categories.name"),field:"categoryName",sortable:!0,searchable:!1,template:function(e){return u(e,"categoryName")}},{displayName:i.getString("Common","tag.dashboard.categories.desc"),field:"categoryDescription",sortable:!0,searchable:!1,template:function(e){return u(e,"categoryDescription")}},{displayName:i.getString("Common","tag.dashboard.categories.cardinality"),field:"multipleCardinality",sortable:!0,searchable:!1,template:function(e){return u(e,"multipleCardinality")}},{displayName:i.getString("Common","tag.dashboard.categories.associable"),field:"displayAssociableEntityTypesString",sortable:!0,searchable:!1,template:function(e){return u(e,"displayAssociableEntityTypesString")}}],sortOrder:[{field:"categoryName",dir:"asc"}],height:"100%",resizable:!0,selectionMode:n.grid.selectionMode.SINGLE,selectedItems:[],data:[]},r.$watch("ctrl.datagridOptions.selectedItems",function(e){var t=e.length>0;g.enabled=t,m.enabled=t}),r.$on("refreshCategories",function(){d()}),d()}angular.module("com.vmware.vsphere.client.commonModule").controller("CategoriesController",e),e.$inject=["categoryService","categoryActionService","i18nService","$scope","vuiConstants"]}(),function(){
"use strict";angular.module("com.vmware.vsphere.client.commonModule").directive("vxCompatibilityMessageNode",["$compile",function(e){return{restrict:"A",templateUrl:"common-module-ui/resources/common-module/views/compatibility/vxCompatibilityMessageNode.html",scope:{content:"="},link:function(t,i){if(!_.isEmpty(t.content.contents)){var r=e('<li vx-compatibility-message-node content="childContent" ng-repeat="childContent in content.contents"class="horizontal-flex-container"></li>')(t);i.find("ul").append(r)}}}}])}(),function(){"use strict";function e(e,t,i,r){return{restrict:"E",replace:!0,templateUrl:"common-module-ui/resources/common-module/views/compatibility/vxCompatibilityView.html",scope:{compatibilityTitle:"<",contents:"<",summarize:"<?",onShowDetailsClick:"&?",isLoading:"<",validatingAriaLabel:"@?"},link:function(n,o,a){function s(e){var t={errors:0,warnings:0,unknown:0,ok:0};return _.each(e,function(e){if("vsphere-icon-status-error"===e.icon||"vui-icon-datagrid-status-red"===e.icon?t.errors++:"vsphere-icon-status-warning"===e.icon||"vui-icon-datagrid-status-yellow"===e.icon?t.warnings++:"vsphere-icon-status-unknown"===e.icon||"vui-icon-datagrid-status-unknown"===e.icon?t.unknown++:"vsphere-icon-status-ok"!==e.icon&&"vui-icon-datagrid-status-green"!==e.icon||t.ok++,!_.isEmpty(e.contents)){var i=s(e.contents);t=c(t,i)}}),t}function c(e,t){return _.mapObject(e,function(e,i){return e+t[i]})}function l(e){n.issuesSummaryMessage={message:"",icon:""},n.issuesLength=e.errors+e.warnings+e.unknown,n.issuesLength>1&&(e.errors>0?(n.issuesSummaryMessage.message=t.getString("CommonModuleUi","compatibilityView.errorStateDefaultMessage"),n.issuesSummaryMessage.icon="vsphere-icon-status-error"):e.warnings>0?(n.issuesSummaryMessage.message=t.getString("CommonModuleUi","compatibilityView.warningStateDefaultMessage"),n.issuesSummaryMessage.icon="vsphere-icon-status-warning"):e.unknown>0&&(n.issuesSummaryMessage.message=t.getString("CommonModuleUi","compatibilityView.infoStateDefaultMessage"),n.issuesSummaryMessage.icon="vsphere-icon-status-unknown"))}_.defaults(n,{summarize:!0}),n.summarize&&(n.showDetailsLabel=t.getString("CommonModuleUi","compatibilityView.showDetails"),n.validationMessage=t.getString("CommonModuleUi","compatibilityView.validating"),n.openPopup=function(){var o=_.pluck(n.contents,"advancedCompatibilityContents");if(o=_.filter(o,function(e){return e}),!_.isEmpty(o)){var a=i.get("vscAdvancedCompatibilityDialogOpenService");return void a.open(o)}var s={dialogData:{compatibilityTitle:n.compatibilityTitle,contents:n.contents},title:t.getString("CommonModuleUi","compatibilityViewPopup.title"),contentTemplate:"common-module-ui/resources/common-module/views/compatibility/vxCompatibilityViewPopup.html",hideSubmitButton:!0,defaultButton:"close",closeButtonTitle:t.getString("Common","close.label")};"function"==typeof n.onShowDetailsClick?r.resolve(n.onShowDetailsClick({contents:n.contents})).then(function(){e.openOkCancelModal(s)}):e.openOkCancelModal(s)},n.$watchCollection(function(){return n.contents},function(e,t){var i=s(e);l(i)}))}}}angular.module("com.vmware.vsphere.client.commonModule").directive("vxCompatibilityView",e),e.$inject=["clarityModalService","i18nService","$injector","$q"]}();var h5_client;!function(e){var t=function(){function e(e,t,i){var r=this;this.$scope=e,this.i18nService=t,this.actionsService=i,this.libraryId=this.$scope._route.objectId,this.actionsService.getAction("vsphere.core.library.local.editSettings",[this.libraryId]).then(function(e){r.$scope.portlet.footerLinks=[{label:r.i18nService.getString("LibraryUi","library.editAction"),onClick:function(t){return r.actionsService.invokeAction(e,{focusTarget:t.currentTarget})},ariaLabel:r.i18nService.getString("LibraryUi","library.editPublicationSettings"),enabled:e&&e.available}]})}return e.$inject=["$scope","i18nService","actionsService"],e}();e.ContentLibraryPublicationPortletController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("contentLibraryPublicationPortletController",t)}(h5_client||(h5_client={}));var h5_client;!function(e){var t=function(){function e(e){this.$scope=e,this.libraryId=this.$scope._route.objectId}return e.$inject=["$scope"],e}();e.ContentLibraryStoragePortletController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("contentLibraryStoragePortletController",t)}(h5_client||(h5_client={}));var h5_client;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.AngularInjector=t,this.i18nService=i,this.actionsService=r,this.libraryId=this.$scope._route.objectId,this.editSettingsService=t.get("vscSubscribedLibraryEditSettingsModalService"),this.actionsService.getAction("vsphere.core.library.subscribed.editSettings",[this.libraryId]).then(function(e){n.$scope.portlet.footerLinks=[{label:n.i18nService.getString("LibraryUi","library.editAction"),ariaLabel:n.i18nService.getString("LibraryUi","library.editSubscriptionSettings"),onClick:n.onEditSettingsClicked.bind(n),enabled:e&&e.available}]})}return e.prototype.onEditSettingsClicked=function(e){var t=e.currentTarget;this.editSettingsService.openSubscribedLibraryEditSettingsDialog(this.libraryId,t)},e.$inject=["$scope","AngularInjector","i18nService","actionsService"],e}();e.ContentLibrarySubscriptionPortletController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("contentLibrarySubscriptionPortletController",t)}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.navigation=t,this.dataService=i,this.featureFlagsService=r,this.showVmtxNotAvailableAlert=!1,this.showPublishAvailableAlert=!1}return e.prototype.$onInit=function(){var e=this;this.i18n=this.i18nService.getString.bind(this.i18nService,"LibraryUi"),this.featureFlagsService.CL_VMTX_SyncEnabled()&&this.dataService.getProperties(this.navigation.getRoute().objectId,["isLocalLibrary","publishInfo.published","isSubscriptionsCapabilitySupported"]).then(function(t){e.showVmtxNotAvailableAlert=t.isLocalLibrary===!1&&t["publishInfo.published"]===!1,e.showPublishAvailableAlert=t.isLocalLibrary===!0&&t["publishInfo.published"]===!0&&t.isSubscriptionsCapabilitySupported===!0})},e.prototype.hideWarning=function(){this.showVmtxNotAvailableAlert=!1,this.showPublishAvailableAlert=!1},e.$inject=["i18nService","navigation","dataService","featureFlagsService"],e}();e.ContentLibraryTemplatesViewController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("ContentLibraryTemplatesViewController",t)}(t||(t={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.LibraryDataModel,r=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.vuiWizardService=e,this.$rootScope=t,this.i18nService=i,this.featureFlagsService=r,this.libraryService=n,this.wizardPageService=o,this.contentLibraryNamePageService=a,this.createContentLibraryFinishPageService=s,this.createContentLibrarySelectDataStorePageService=c,this.createContentLibraryConfigurePageService=l,this.createContentLibraryConfigureVapiPageService=d}return e.prototype.showWizard=function(){var e=this,t=this.$rootScope.$new(),r=this.contentLibraryNamePageService.build(),n=this.createContentLibraryFinishPageService.build(),o=this.createContentLibrarySelectDataStorePageService.build(),a=this.createContentLibraryConfigureVapiPageService.build(),s=[];s.push({id:"create.contentLibrary.flowId",pages:[r,a,o,n]}),t.wizardConfig={pages:this.wizardPageService.initializePageStates(s[0].pages),flows:this.wizardPageService.initializeFlowStates(s)},t.wizardConfig.title=this.i18nService.getString("LibraryUi","createLibraryWizard.title"),t.wizardState=new i,t.wizardConfig.onFinish=function(){return e.libraryService.addContentLibrary(angular.copy(t.wizardState)),!0},this.vuiWizardService({scope:t,configObjectName:"wizardConfig",validationBanner:{}}).show()},e.$inject=["vuiWizardService","$rootScope","i18nService","featureFlagsService","libraryService","wizardPageService","contentLibraryNamePageService","createContentLibraryFinishPageService","createContentLibrarySelectDataStorePageService","createContentLibraryConfigurePageService","createContentLibraryConfigureVapiPageService"],e}();angular.module("com.vmware.vsphere.client.commonModule").service("createContentLibraryService",r)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.build=function(){return{title:this.i18nService.getString("LibraryUi","createLibraryWizard.libraryNamePage.title"),description:this.i18nService.getString("LibraryUi","createLibraryWizard.libraryNamePage.description"),contentUrl:"common-module-ui/resources/common-module/views/content-library/wizard/pages/createContentLibraryName.html"}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.commonModule").service("contentLibraryNamePageService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.build=function(){return{title:this.i18nService.getString("LibraryUi","createLibraryWizard.configurePage.title"),description:this.i18nService.getString("LibraryUi","createLibraryWizard.configurePage.description"),contentUrl:"common-module-ui/resources/common-module/views/content-library/wizard/pages/createContentLibraryConfigure.html"}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.commonModule").service("createContentLibraryConfigurePageService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n){this.$scope=e,this.i18nService=t,this.libraryService=i,this.vuiConstants=r,this.clarityModalService=n,this.CERTIFICATE_ERROR_STATUS="CERTIFICATE_ERROR",this.subscriptionUrl=this.$scope.wizardState.subscriptionUrl,this.sslThumbprint="",this.i18n=t.getString,this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE,this.init(),this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE}return e.prototype.init=function(){var e=this,t=this;this.$scope.vuiWizard.currentPage.disableNext=function(){return!t.subscriptionUrl.length},this.$scope.vuiWizard.currentPage.onCommit=function(){return e.getValidateSubscriptionUrlPromise.call(e)}},e.prototype.getValidateSubscriptionUrlPromise=function(){var e=this;return this.libraryService.validateSubscription(e.subscriptionUrl,e.sslThumbprint).then(function(t){var i="";if(t.error&&(i=t.error.localizedMessage),t.result){if(e.isSslThumbprintError(t.result))return e.sslThumbprint=t.result.sslThumbprint,e.openSslThumbprintAlert(e.sslThumbprint),!1;if(!t.result.errorMessages.length)return e.$scope.wizardState.type={name:"SUBSCRIBED"},e.$scope.wizardState.subscriptionUrl=e.subscriptionUrl,e.$scope.vuiWizard.currentPage.state=e.vuiConstants.wizard.pageState.COMPLETED,!0;i=t.result.errorMessages[0].defaultMessage}return!i||(e.$scope.wizardConfig.validationBanner.messages=[{text:i,type:e.vuiConstants.validationBanner.type.ERROR}],e.$scope.wizardConfig.validationBanner.showAllMessages=!0,!1)})},e.prototype.isSslThumbprintError=function(e){return!!(e&&e.status&&e.status.enumValue)&&e.status.enumValue===this.CERTIFICATE_ERROR_STATUS},e.prototype.openSslThumbprintAlert=function(e){var t=this;this.clarityModalService.openConfirmationModal({title:this.i18n("LibraryUi","sslDialog.securityAlertTitle",t.$scope.wizardState.name),message:this.i18nService.getString("LibraryUi","sslDialog.securityAlertText",e),preserveNewlines:!0,saveButtonLabel:this.i18n("LibraryUi","yes"),clarityIcon:{shape:"warning","class":"is-warning",size:64},submit:function(){return t.$scope.wizardState.sslThumbprint=t.sslThumbprint,t.$scope.wizardManager.onNextClick(),!0},onCancel:function(){t.sslThumbprint=""}})},e.$inject=["$scope","i18nService","libraryService","vuiConstants","clarityModalService"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("createContentLibraryConfigureController",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.build=function(){return{title:this.i18nService.getString("LibraryUi","createLibraryWizard.readyToCompletePage.title"),description:this.i18nService.getString("LibraryUi","createLibraryWizard.readyToCompletePage.description"),contentUrl:"common-module-ui/resources/common-module/views/content-library/wizard/pages/createContentLibraryFinish.html"}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.commonModule").service("createContentLibraryFinishPageService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.ContentLibraryConstants,r=function(){function e(e,t,i){this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.i18n=t.getString,this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE}return e.prototype.getLibraryTypeString=function(){return this.$scope.wizardState.type===i.LIBRARYTYPE_LOCAL?this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.localLibrary"):this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.subscribedLibrary")},e.prototype.isLibraryLocal=function(){return this.$scope.wizardState.type===i.LIBRARYTYPE_LOCAL},e.prototype.getPublishedString=function(){return this.$scope.wizardState.isPublished?this.getDetailedPublishedString():this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.published.no")},e.prototype.getDetailedPublishedString=function(){var e=this.$scope.wizardState.isStreamingOptimized?this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.streamOptimized"):this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.streamNotOptimized"),t=this.$scope.wizardState.isAuthenticationEnabled?this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.passwordRequired"):this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.passwordNotRequired");return this.i18n("LibraryUi","createLibraryWizard.readyToCompletePage.published.yes",e,t)},e.$inject=["$scope","i18nService","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("createContentLibraryFinishController",r)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.build=function(){return{title:this.i18nService.getString("LibraryUi","createLibraryWizard.addStoragePage.title"),description:this.i18nService.getString("LibraryUi","createLibraryWizard.addStoragePage.description"),contentUrl:"common-module-ui/resources/common-module/views/content-library/wizard/pages/createContentLibrarySelectStorage.html"}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.commonModule").service("createContentLibrarySelectDataStorePageService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$scope=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.dataService=r,this.vuiConstants=n,this.authorizationService=o,this.$q=a,this.DATASTORE_ALLOCATESPACE_PRIVILEGE="Datastore.AllocateSpace",this.i18n=t.getString;var c={listViewId:"vsphere.core.datastore.list",dataModels:["Datastore"]};this.objSelectorConf={contextObject:this.defaultUriSchemeUtil.createVmomiUri("Folder","group-d1",this.$scope.wizardState.vcService.serviceGuid),multipleSelect:!1,listTabConfig:{selectedTabIndex:0,listConfig:[c]},selectedObjects:this.$scope.wizardState.datastore?[this.$scope.wizardState.datastore.id]:null,onSelectionChanged:this.onDatastoreSelectionChange.bind(this)},this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE,this.$scope.vuiWizard.currentPage.onCommit=function(){var e=s;return s.$scope.wizardState.datastore.id?s.isValidDatastore(s.$scope.wizardState.datastore.id).then(function(i){return i?(e.$scope.vuiWizard.currentPage.state=e.vuiConstants.wizard.pageState.COMPLETED,!0):(e.$scope.wizardConfig.validationBanner.messages=[{text:t.getString("LibraryUi","error.datastore.inaccessible"),type:e.vuiConstants.validationBanner.type.ERROR}],e.$scope.wizardConfig.validationBanner.showAllMessages=!0,!1)}):(s.showValidationMessage("createLibraryWizard.addStoragePage.selectDatastore"),e.$q.when(!1))}}return e.prototype.isValidDatastore=function(e){return this.dataService.getProperties(e,["summary.accessible"]).then(function(e){return e["summary.accessible"]})},e.prototype.onDatastoreSelectionChange=function(e){var t=this;this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE,this.hasPrivilegeOnDatastore(e[0].id).then(function(i){i?(t.$scope.wizardState.datastore={id:e[0].id,name:e[0].name},t.$scope.vuiWizard.currentPage.state=t.vuiConstants.wizard.pageState.COMPLETED):(t.$scope.wizardState.datastore={},t.showValidationMessage("h5.error.noDatastorePrivilege"))})},e.prototype.hasPrivilegeOnDatastore=function(e){return this.authorizationService.checkPrivilege(e,this.DATASTORE_ALLOCATESPACE_PRIVILEGE)},e.prototype.showValidationMessage=function(e){this.$scope.wizardConfig.validationBanner.messages=[{text:this.i18nService.getString("LibraryUi",e),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.wizardConfig.validationBanner.showAllMessages=!0},e.$inject=["$scope","i18nService","defaultUriSchemeUtil","dataService","vuiConstants","authorizationService","$q"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("createContentLibrarySelectDatastoreController",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.$scope=e,this.$rootScope=t,this.i18nService=i,this.userSessionService=r,this.vuiConstants=n,this.clarityModalService=o,this.$q=a,this.libraryService=s,this.name=this.$scope.wizardState.name,this.description=this.$scope.wizardState.description,this.vcService=this.$scope.wizardState.vcService,this.MAX_LENGTH=80,this.i18n=i.getString;var c=this;c.$scope.vuiWizard.currentPage.state=c.vuiConstants.wizard.pageState.INCOMPLETE,r.getAllServersInfo().then(function(e){if(c.vCenters=e.serversInfo.filter(function(e){return e.name&&"noError"===e.errorCode}),c.$scope.wizardState.vcService.name){if(c.vCenters){var t=c.$scope.wizardState.vcService.serviceGuid;c.vcService=_.find(c.vCenters,function(e){return t===e.serviceGuid})}}else c.vcService=c.vCenters[0];c.init()})}return e.prototype.init=function(){var e=this;this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE,this.$scope.vuiWizard.currentPage.disableNext=function(){return!e.name.length},this.$scope.vuiWizard.currentPage.onCommit=function(){var t=e.$q.defer();return e.name.length>e.MAX_LENGTH?(e.$scope.wizardConfig.validationBanner.messages=[{text:e.i18n("VmUi","NameValidator.nameTooLongSpecialChars"),type:e.vuiConstants.validationBanner.type.ERROR}],e.$scope.wizardConfig.validationBanner.showAllMessages=!0,t.resolve(!1)):e.isDuplicateLibraryName().then(function(i){i?e.clarityModalService.openConfirmationModal({title:e.i18nService.getString("LibraryUi","library.dupeNameWarning.dialogDescriptionHeader"),message:e.i18nService.getString("LibraryUi","library.dupeNameWarning.dialogDescriptionBodyCreate",e.name),icon:"vsphere-icon-status-warning",submit:function(){e.onSubmit(t)},onCancel:function(){t.resolve(!1)},preserveNewlines:!0}):e.onSubmit(t)}),t.promise}},e.prototype.onSubmit=function(e){this.$scope.wizardState.name=this.name,this.$scope.wizardState.description=this.description,this.$scope.wizardState.vcService=this.vcService,this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.COMPLETED,e.resolve(!0)},e.prototype.isDuplicateLibraryName=function(){var e=this;return this.libraryService.getAllContentLibraryInVc(this.vcService).then(function(t){return e.libraries=t,_.findIndex(e.libraries.targetLibraries,{name:e.name})!==-1})},e.$inject=["$scope","$rootScope","i18nService","userSessionService","vuiConstants","clarityModalService","$q","libraryService"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("createContentLibraryController",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.build=function(){return{title:this.i18nService.getString("LibraryUi","createLibraryWizard.configurePage.title"),description:this.i18nService.getString("LibraryUi","createLibraryWizard.configurePage.description"),contentUrl:"common-module-ui/resources/common-module/views/content-library/wizard/pages/vapi/createContentLibraryConfigureVapi.html"}},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.commonModule").service("createContentLibraryConfigureVapiPageService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(t){var i=e.common_module_ui.ContentLibraryConstants,r=function(){function e(e,t,r,n,o,a,s){var c=this;this.$scope=e,this.i18nService=t,this.libraryService=r,this.vuiConstants=n,this.clarityModalService=o,this.authorizationService=a,this.defaultUriSchemeUtil=s,this.CERTIFICATE_ERROR_STATUS="CERTIFICATE_ERROR",this.CREATE_LOC_LIB_PRIVILEGE="ContentLibrary.CreateLocalLibrary",this.CREATE_SUB_LIB_PRIVILEGE="ContentLibrary.CreateSubscribedLibrary",this.PROBE_SUBSCRIPTION_PRIVILEGE="ContentLibrary.ProbeSubscription",this.PASSWORD_PATTERN=/((?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^A-Za-z0-9]).{8,})/,this.subscriptionUrl="",this.local=i.LIBRARYTYPE_LOCAL,this.SYNC_IMMEDIATE=i.SYNC_STRATEGY_IMMEDIATE,this.SYNC_ONDEMAND=i.SYNC_STRATEGY_ONDEMAND,this.placeholderSubscription="",this.loading=!1,this.isLocalLibraryPrivilege=!0,this.isPublishedLibraryPrivilege=!0,this.isProbeSubscriptionPrivilege=!0,this.publishExternally=!1,this.isAuthenticationEnabled=!1,this.password="",this.isPasswordValid=!1,this.isStreamingOptimized=!1,this.subscribed=i.LIBRARYTYPE_SUBSCRIBED,this.sslThumbprint="",this.isSubscribeAuthEnabled=!1,this.subscribePassword="",this.selectedLibraryType=this.local,this.syncStrategy=this.SYNC_IMMEDIATE,this.init=function(){var e=c.defaultUriSchemeUtil.getRootFolder(c.$scope.wizardState.vcService.serviceGuid);c.authorizationService.checkPrivileges(e,[c.CREATE_LOC_LIB_PRIVILEGE,c.CREATE_SUB_LIB_PRIVILEGE,c.PROBE_SUBSCRIPTION_PRIVILEGE]).then(function(e){e&&3===e.length&&(c.isLocalLibraryPrivilege=e[0],c.isPublishedLibraryPrivilege=e[1],c.isProbeSubscriptionPrivilege=e[2]),c.$scope.vuiWizard.currentPage.disableNext=function(){return c.loading||c.isLocalLibrarySelected()?!c.isLocalLibraryValid():!c.isSubscribedLibraryValid()},c.selectedLibraryType=c.$scope.wizardState.type,c.isLocalLibrarySelected()?(c.publishExternally=c.$scope.wizardState.isPublished,c.isStreamingOptimized=c.$scope.wizardState.isStreamingOptimized,c.isAuthenticationEnabled=c.$scope.wizardState.isAuthenticationEnabled,c.isAuthenticationEnabled&&(c.password=c.$scope.wizardState.password,c.isPasswordValid=!0)):(c.subscriptionUrl=c.$scope.wizardState.subscriptionUrl,c.isSubscribeAuthEnabled=c.$scope.wizardState.isSubscriptionAuthenticated,c.syncStrategy=c.$scope.wizardState.syncStrategy,c.subscribePassword=c.$scope.wizardState.subscriptionPassword),c.$scope.vuiWizard.currentPage.onCommit=function(){var e=c;if(c.isLocalLibrarySelected()){if(!e.isLocalLibraryPrivilege)return c.setBannerErrorMessage(c.i18n("LibraryUi","error.noPrivileges.localLibrary")),!1}else{if(!e.isPublishedLibraryPrivilege)return c.setBannerErrorMessage(c.i18n("LibraryUi","error.noPrivileges.subscribedLibrary")),!1;if(!e.isProbeSubscriptionPrivilege)return c.setBannerErrorMessage(c.i18n("LibraryUi","error.noPrivileges.probeSubscription")),!1}return e.$scope.wizardState.type=c.selectedLibraryType,c.selectedLibraryType===i.LIBRARYTYPE_LOCAL?(e.$scope.wizardState.isPublished=c.publishExternally,e.$scope.wizardState.isStreamingOptimized=c.isStreamingOptimized,e.$scope.wizardState.isAuthenticationEnabled=c.isAuthenticationEnabled,c.isAuthenticationEnabled&&(e.$scope.wizardState.password=c.password),e.$scope.vuiWizard.currentPage.state=e.vuiConstants.wizard.pageState.COMPLETED,!0):(c.loading=!0,c.libraryService.validateSubscription(e.subscriptionUrl,e.sslThumbprint,e.subscribePassword).then(function(t){c.loading=!1;var i="",r=!1;if(t.error&&(i=t.error.localizedMessage,i=c.translateErrorMessage(i)),t.result){if(e.isSslThumbprintError(t.result))return e.sslThumbprint=t.result.sslThumbprint,e.openSslThumbprintAlert(e.sslThumbprint),!1;if(!t.result.errorMessages.length)return e.$scope.wizardState.subscriptionUrl=e.subscriptionUrl,e.$scope.wizardState.syncStrategy=e.syncStrategy,e.$scope.wizardState.isSubscriptionAuthenticated=e.isSubscribeAuthEnabled,e.$scope.wizardState.subscriptionPassword=e.subscribePassword,e.$scope.vuiWizard.currentPage.state=e.vuiConstants.wizard.pageState.COMPLETED,!0;i=t.result.errorMessages[0].defaultMessage,"INVALID_CREDENTIALS"===t.result.status.name&&(e.isSubscribeAuthEnabled=!0,r=!0)}return!i||(e.$scope.wizardConfig.validationBanner.messages=[{text:i,type:r?e.vuiConstants.validationBanner.type.WARNING:e.vuiConstants.validationBanner.type.ERROR}],e.$scope.wizardConfig.validationBanner.showAllMessages=!0,!1)}))}})},this.i18n=t.getString,this.$scope.vuiWizard.currentPage.state=this.vuiConstants.wizard.pageState.INCOMPLETE,this.placeholderSubscription=this.i18n("LibraryUi","createLibraryWizard.configurePage.exampleSubscriptionURL"),this.init()}return e.prototype.isSubscribedLibraryValid=function(){var e=!this.isSubscribeAuthEnabled||!!this.subscribePassword;return!!this.subscriptionUrl&&e},e.prototype.onPublishedChanged=function(){this.publishExternally||(this.isAuthenticationEnabled=!1)},e.prototype.isLocalLibrarySelected=function(){return this.selectedLibraryType===i.LIBRARYTYPE_LOCAL},e.prototype.isLocalLibraryValid=function(){return!this.isAuthenticationEnabled||this.getPasswordValid()},e.prototype.getPasswordValid=function(){return this.isPasswordValid},e.prototype.isSslThumbprintError=function(e){return!!(e&&e.status&&e.status.enumValue)&&e.status.enumValue===this.CERTIFICATE_ERROR_STATUS},e.prototype.onPublishPasswordStatusChange=function(e){this.isPasswordValid=e.isValid,this.password=e.password},e.prototype.openSslThumbprintAlert=function(e){var t=this;this.clarityModalService.openConfirmationModal({title:this.i18n("LibraryUi","sslDialog.securityAlertTitle",t.$scope.wizardState.name),message:this.i18nService.getString("LibraryUi","sslDialog.securityAlertText",e),preserveNewlines:!0,saveButtonLabel:this.i18n("LibraryUi","yes"),clarityIcon:{shape:"warning","class":"is-warning",size:64},submit:function(){return t.$scope.wizardState.sslThumbprint=t.sslThumbprint,t.$scope.wizardManager.onNextClick(),!0},onCancel:function(){t.sslThumbprint=""}})},e.prototype.setBannerErrorMessage=function(e){e&&(this.$scope.wizardConfig.validationBanner.messages=[{text:e,type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.wizardConfig.validationBanner.showAllMessages=!0)},e.prototype.radioChanged=function(){this.$scope.wizardConfig.validationBanner.messages=[]},e.prototype.translateErrorMessage=function(e){if(e){if(e.toLowerCase().indexOf("unknown protocol")>-1)return this.i18nService.getString("LibraryUi","h5.probe.subscription.url.unknownProtocol");if(e.toLowerCase().indexOf("no protocol")>-1)return this.i18nService.getString("LibraryUi","h5.probe.subscription.url.noProtocol")}return e},e.$inject=["$scope","i18nService","libraryService","vuiConstants","clarityModalService","authorizationService","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("createContentLibraryConfigureVapiController",r)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.$scope=e,this.$rootScope=t,this.i18nService=i,this.associableObjectTypesService=r,this.customAttributesService=n,this.isInEditMode=!1,this.closeModal=function(){o.$scope.closeModal()},this.okButtonDisabled=function(){return!o.attributeState.attribute},this.submit=function(){o.isInEditMode?o.customAttributesService.renameCustomAttribute(o.attributeState).then(function(){o.$rootScope.$broadcast("refreshCustomAttributes"),o.closeModal()}):o.customAttributesService.addCustomAttribute(o.attributeState,o.selectedType).then(function(){o.$rootScope.$broadcast("refreshCustomAttributes"),o.closeModal()})};var a=this;if(a.i18n=i.getString,a.attributeState=e.modalOptions.dialogData.customAttributeState,a.attributeState&&a.attributeState.attribute?a.isInEditMode=!0:a.attributeState={attribute:""},a.isInEditMode)a.selectedType=a.attributeState.typeFormatted;else{a.associableObjectTypes=r.getTypeDataForAttributes(),a.associableObjectTypes.global={associableTypeString:"global",displayName:"global"};for(var s=0,c=Object.keys(a.associableObjectTypes);s<c.length;s++){var l=c[s];a.associableObjectTypes[l].i18nString=a.i18n("Common","fieldType."+a.associableObjectTypes[l].associableTypeString)}a.selectedType=a.associableObjectTypes.global}}return e.$inject=["$scope","$rootScope","i18nService","associableObjectTypesService","customAttributesService"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("addEditCustomAttributeController",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,t,i,r,n){function o(){i.getAllCustomAttributes().then(function(e){l.datagridOptions.data=e})}function a(){n.deleteCustomAttribute(l.datagridOptions.selectedItems[0])}function s(){n.editCustomAttribute(l.datagridOptions.selectedItems[0],e.getString("CommonModuleUi","edit.attribute"))}function c(){n.editCustomAttribute(null,e.getString("Common","editCustomFieldDefinitionView.add.title"))}var l=this,d={id:"delete-custom-action",iconClass:"vsphere-icon-toolbar-remove",tooltipText:e.getString("Common","ca.delete.delete"),enabled:!1,onClick:a},u={id:"edit-tag-action",iconClass:"vsphere-icon-toolbar-edit",tooltipText:e.getString("CommonModuleUi","edit.attribute"),enabled:!0,onClick:s},p={id:"add-tag-action",iconClass:"vsphere-icon-toolbar-add",tooltipText:e.getString("CommonModuleUi","add.attribute"),enabled:!0,onClick:c};l.datagridOptions={actionBarOptions:{actions:[p,u,d]},columnDefs:[{displayName:e.getString("Common","attributesName"),field:"attribute",sortable:!0,searchable:!1},{displayName:e.getString("Common","attributesGrid.typeColumnHeaderText"),field:"type",sortable:!0,searchable:!1,template:function(t){return e.getString("Common","fieldType."+t.type)}},{displayName:e.getString("Common","ca.values.key"),field:"key",visible:!1}],sortOrder:[{field:"attribute",dir:"asc"}],height:"100%",resizable:!1,reorderable:!0,selectionMode:t.grid.selectionMode.SINGLE,selectedItems:[],data:[]},r.$watch("ctrl.datagridOptions.selectedItems",function(e){var t=e&&e.length;d.enabled=t,u.enabled=t}),r.$on("refreshCustomAttributes",function(){o()}),o()}angular.module("com.vmware.vsphere.client.commonModule").controller("CustomAttributesController",e),e.$inject=["i18nService","vuiConstants","customAttributesService","$scope","customAttributesActionService"]}(),function(){"use strict";function e(e,t,i,r){var n=this,o=e._route.objectId;n.objectId=o,n.liveRefreshProperties=["availableField","customValue"],n.datagridOptions={
columnDefs:[{displayName:i.getString("Common","attributesName"),field:"attribute",sortable:!1,searchable:!1},{displayName:i.getString("Common","ca.values.value"),field:"value",sortable:!1,searchable:!1}],height:"200px",resizable:!1,reorderable:!1};var a={summaryViewCustomAttributeDatagridOptions:n.datagridOptions};r.getAction("vsphere.core.actions.editCustomAttributesAction",[o]).then(function(t){var n=!(!t||!t.available);e.portlet.footerLinks=[{label:i.getString("Common","action.editCustomAttributes.label"),ariaLabel:i.getString("Common","action.editCustomAttributes.description"),onClick:function(){r.invokeAction(t,a)},enabled:n}]}),n.refresh=function(){t.getCustomAttributes(o).then(function(e){n.datagridOptions.data=e})},n.refresh()}angular.module("com.vmware.vsphere.client.commonModule").controller("CustomAttributesPortletController",e),e.$inject=["$scope","customAttributesService","i18nService","actionsService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(e){var t=angular.extend({},e.model,e.values);t.operationId=e.values.value?"EDIT":"RENAME",e.model.key&&P.push(t)}function a(){var e=S.datagridOptions.dataSource.view().filter(function(e){return!e.key}),i=P.concat(e);i.length>0&&t.modifyCustomAttributes(y,i).then(function(e){e.error||(d(),S.closeModal())})}function s(){e.attribute="",e.value="",e.type=C.type}function c(){var e=S.datagridOptions.dataSource.view().filter(function(e){return S.datagridOptions.selectedItems[0].attribute!==e.attribute});S.datagridOptions.data=e,S.datagridOptions.selectedItems[0].key&&(S.datagridOptions.selectedItems[0].operationId="REMOVE",P.push(S.datagridOptions.selectedItems[0]))}function l(e,t,r){if(_.isUndefined(e)||_.isNull(e)||_.isEmpty(e))return void g(!1);var n=e.length<S.FOLDER_MAX_LENGTH;if(!n)return void h(!1);var o=t.length<S.FOLDER_MAX_LENGTH;if(!o)return void f(!1);var a={attribute:e,value:t,type:r,typeLabel:i.getString("Common","fieldType."+r),operationId:"ADD"};u(a)}function d(){p()}function u(e){var t=[];return angular.copy(S.datagridOptions.dataSource.view(),t),v(e.attribute)?void m(!1):(t.splice(0,0,e),S.datagridOptions.data=t,s(),void m(!0))}function p(){_.forEach(P,function(e){_.forEach(S.datagridOptions.data,function(t){e.key&&e.key===t.key&&(t.value=e.value,t.attribute=e.attribute)})})}function v(e){var t=_.find(S.datagridOptions.dataSource.view(),function(t){return t.attribute===e});return void 0!==t}function m(e){S.addForm&&(S.addForm.newCustomAttributeName.$setValidity("duplicateAttributeError",e),S.newAttributeErrorConfig.isVisible(S.addForm.newCustomAttributeName))}function g(e){S.addForm&&(S.addForm.newCustomAttributeName.$setValidity("emptyAttributeError",e),S.newAttributeErrorConfig.isVisible(S.addForm.newCustomAttributeName))}function h(e){S.addForm&&(S.addForm.newCustomAttributeName.$setValidity("maxLengthError",e),S.newAttributeErrorConfig.isVisible(S.addForm.newCustomAttributeName))}function f(e){S.addForm&&(S.addForm.newCustomAttributeValue.$setValidity("maxLengthError",e),S.newAttributeErrorConfig.isVisible(S.addForm.newCustomAttributeValue))}var S=this;S.FOLDER_MAX_LENGTH=80;var y=e.modalOptions.availableTargets[0],P=[],C=r.getManagedObjectReference(y);S.addAttribute=l,S.deleteCustomAttribute=c,S.saveModifiedCustomAttributes=a,s(),S.attributeTypeOptions=[{label:i.getString("Common","fieldType.global"),value:"global"},{label:i.getString("Common","fieldType."+C.type),value:C.type}],S.datagridOptions={actionBarOptions:{actions:[{id:"deleteCustomAttributeAction",enabled:!1,tooltipText:i.getString("Common","ca.delete.delete"),iconClass:"vsphere-icon-toolbar-remove",onClick:S.deleteCustomAttribute}]},columnDefs:[{displayName:i.getString("Common","ca.values.attribute"),field:"attribute",sortable:!1,searchable:!1,editable:{validator:{required:!0,uniqueAttribute:function(e){var t=e.val().length<S.FOLDER_MAX_LENGTH;if(!t)return e.attr("data-uniqueAttribute-msg","The name is too long"),!1;var i=e.parents("table").find('[ng-bind="dataItem.attribute"]').map(function(e,t){return $(t).html()});return e.attr("data-uniqueAttribute-msg","Attribute is not unique"),!_.contains(i,e.val())}}}},{displayName:i.getString("Common","ca.values.key"),field:"key",visible:!1},{displayName:i.getString("Common","ca.values.value"),field:"value",sortable:!1,searchable:!1,editable:{validator:{uniqueAttribute:function(e){var t=e.val().length<S.FOLDER_MAX_LENGTH;return!!t||(e.attr("maxlength",S.FOLDER_MAX_LENGTH),e.attr("data-uniqueAttribute-msg","The value is too long"),e.val(e.val().substring(0,S.FOLDER_MAX_LENGTH)),!1)}}}},{displayName:i.getString("Common","ca.values.type"),field:"typeLabel",sortable:!1,searchable:!1,editable:!1}],height:"200px",resizable:!1,reorderable:!1,selectionMode:n.grid.selectionMode.SINGLE,editable:!0,selectedItems:[],save:o},e.$watch("editCtrl.datagridOptions.selectedItems",function(e){S.datagridOptions.actionBarOptions.actions[0].enabled=e.length>0}),t.getCustomAttributes(y).then(function(e){S.datagridOptions.data=e}),S.newAttributeErrorConfig={message:"",isVisible:function(e){return e.$error.duplicateAttributeError?(this.message=i.getString("Common","ca.error.duplicate"),!0):e.$error.emptyAttributeError?(this.message=i.getString("Common","ca.error.empty"),!0):!!e.$error.maxLengthError&&(this.message=i.getString("Common","ca.error.length"),!0)}},S.closeModal=function(){e.closeModal()}}angular.module("com.vmware.vsphere.client.commonModule").controller("EditCustomAttributesDialogController",e),e.$inject=["$scope","customAttributesService","i18nService","defaultUriSchemeUtil","vuiConstants"]}(),angular.module("com.vmware.vsphere.client.commonModule").controller("NotesController",["$scope","dataService","actionsService","i18nService",function(e,t,i,r){function n(){if(!s)throw new Error("Unknown notes property name");t.getProperties(d,[s]).then(function(e){l.notes=e[s]})}function o(){c&&i.getActions([e._route.objectId],[c]).then(function(e){e&&a(e)})}function a(t){var n=r.getString("CommonModuleUi","notes.editLabel"),o=t&&t.length>0&&t[0].available;e.portlet.footerLinks=[{enabled:o,label:n,onClick:function(e){var r=e.currentTarget;i.invokeAction(t[0],{focusTarget:r})}}]}var s,c,l=this,d=e._route.objectId,u=[];e.portlet._view.contentSpec.metadata&&(s=e.portlet._view.contentSpec.metadata.notesPropName,c=e.portlet._view.contentSpec.metadata.editNotesActionId,u.push(s)),l.watchForObjects=[d],l.getNotes=n,l.liveRefreshProperties=u,n(),o()}]),function(){"use strict";function e(e,t){var i=this;i.loading=!0;var r,n=e.modalOptions.availableTargets[0],o=e.modalOptions.dialogData.notesPropName,a=e.modalOptions.dialogData.additionalPropForEdit,s=e.modalOptions.dialogData.onUpdateNotesCallback,c=[o,"name"];a&&c.push(a),t.getProperties(n,c).then(function(e){i.notes=e[o],i.name=e.name,i.loading=!1,a&&(r=e[a])});var l=e.modalOptions.title;i.closeModal=function(){e.closeModal()},i.save=function(){i.closeModal();var e=i.notes;return s(n,e,l,r)}}angular.module("com.vmware.vsphere.client.commonModule").controller("NotesDialogController",e),e.$inject=["$scope","dataService"]}(),function(){"use strict";function e(e,t,i,r){function n(){if(a.objectIds=e.modalOptions.availableTargets,e.modalOptions.dialogData.selectedPermission){if(a.selectedPermission=e.modalOptions.dialogData.selectedPermission,a.selectedPermission.principal){var t=a.selectedPermission.principal.split("\\");t.length>=2&&(a.selectedDomainForPermission=t[0],a.selectedUserForPermission=t[1])}a.propagateToChildren=e.modalOptions.dialogData.selectedPermission.propagateToChildren}a.getDomainList().then(function(){a.selectedDomain=a.domainList[0]}),a.getUserRoles().then(function(){if(a.selectedRole=a.userRolesList[0],e.modalOptions.dialogData.edit){var t=a.userRolesList.filter(function(e){return e.id===a.selectedPermission.roleId});t.length>0&&(a.selectedRole=t[0])}}),a.getParentObjectReference()}function o(){_.each(a.objectIds,function(r){if(a.parentObjects&&a.parentObjects[r]&&"ComputeResource"===a.parentObjects[r].type&&(r=i.getVsphereObjectId(a.parentObjects[r])),e.modalOptions.dialogData.edit){var n=[{roleId:a.selectedRole.id,propagate:a.propagateToChildren,id:a.selectedPermission.permissionId,principal:a.selectedPermission.principal,group:a.selectedPermission.isGroup}];t.editUserGroupPermissions(r,n)}else{var o=[a.selectedUserGroup].map(function(e){return{principal:[a.selectedDomain.name,e.name].join("\\"),group:e.group,roleId:a.selectedRole.id,propagate:a.propagateToChildren}});t.saveUserGroupPermissions(r,o)}})}var a=this;a.selectedRole=null,a.selectedUserGroup=null,a.domainList=null,a.propagateToChildren=!1,a.selectedDomainForPermission=null,a.selectedUserForPermission=null,a.userGroupListLoading=!1,e.$watch(function(){return a.selectedDomain},function(){a.selectedUserGroup=null}),a.getUserRoles=function(){return t.getRolesInfo(a.objectIds[0]).then(function(e){a.userRolesList=e})},a.getParentObjectReference=function(){return r.getPropertiesForObjects(a.objectIds,["parent"]).then(function(e){a.parentObjects={},_.each(e,function(e,t){a.parentObjects[t]=e.parent})})},a.onAddPermissionButtonClicked=function(){o(),e.closeModal()},a.onCancelButtonClicked=function(){e.closeModal()},a.getDomainList=function(){return t.getDomains().then(function(e){a.domainList=e})},a.getUserGroupsList=function(e){return a.userGroupListLoading=!0,e=e||"",t.getUserGroups(a.objectIds[0],a.selectedDomain.name,e).then(function(e){return a.userGroupListLoading=!1,e["vsphere:userGroups"].map(function(e){return{name:e.principal,description:e.fullName,group:e.group}})})},n()}angular.module("com.vmware.vsphere.client.commonModule").controller("AddPermissionDialogController",e),e.$inject=["$scope","PermissionDataService","defaultUriSchemeUtil","dataService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(t){return e.getProperties(t,["name"]).then(function(e){return e.name})}function a(t){return e.getProperties(t,["rolesInfo"]).then(function(e){return e.rolesInfo})}function s(){return e.getProperties("urn:vri:sso:UserDirectory",["vsphere:domainList"]).then(function(e){return _.map(e["vsphere:domainList"],function(e){return{name:e.name,label:e.label}})})}function c(t,i,r){var n={propertyName:"vsphere:userGroups",parameterType:"com.vmware.vise.vim.users.UserDirectorySpec",parameter:{domain:i,searchString:r||"",exactMatch:!1,findUsers:!0,findGroups:!0}};return e.getProperties(t,["vsphere:userGroups"],{propertyParams:[n]})}function l(e,i){return t.apply(e,"com.vmware.vise.vim.security.data.UpdatePermissionsSpec",{permissions:i},"Add permission")}function d(e,i){return t.apply(e,"com.vmware.vise.vim.security.data.UpdatePermissionsSpec",{permissions:i},"Edit permission")}function u(e,i){return i.id=i.permissionId,i.group=i.isGroup,t.apply(e,"com.vmware.vise.vim.security.data.RemovePermissionSpec",{permission:i},"Remove permission")}function p(t){return e.getProperties(t,["permissionViewData"]).then(function(e){return r.all(_.map(e.permissionViewData,function(e){var t=r.defer();return e.entityType?i.getObjectTypeSpec(e.entityType).then(function(i){e.isRootFolder?e.icon="vsphere-icon-vcenter":e.icon=i.icon,t.resolve(e)},function(e){t.reject(e)}):t.resolve(e),t.promise}))})}function v(e){return p(e)}return{getName:o,getRolesInfo:a,getUserGroups:c,getDomains:s,saveUserGroupPermissions:l,getEntityPermissions:v,removeUserGroupPermissions:u,editUserGroupPermissions:d}}angular.module("com.vmware.vsphere.client.commonModule").service("PermissionDataService",e),e.$inject=["dataService","mutationService","objectTypesService","$q","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(e){if(e.isGlobal)return"<span>"+g("globalPermission")+"</span>";if(e.isDefinedOnCurrentObject){var t=e.propagateToChildren?"permissionView.thisEntity.propagate":"PermissionView.thisEntity";return"<span>"+g(t)+"</span>"}return h(["entityId","icon","entityName"],e)}function d(){return h5.actions["vsphere.core.inventory.actions.addPermission"]({action:{label:g("permissionAction.add.label")}},[m],{edit:!1})}function u(){return h5.actions["vsphere.core.inventory.actions.addPermission"]({action:{label:g("permissionAction.edit.dialog.title")}},[m],{edit:!0,selectedPermission:JSON.parse(JSON.stringify(v.datagridOptions.selectedItems[0]))})}function p(){var e={title:i.getString("Common","permissionAction.remove.dialog.title"),message:i.getString("Common","permissionAction.remove.warning"),icon:"icon-warning-32",defaultButton:"close",submit:function(){r.removeUserGroupPermissions(m,v.datagridOptions.selectedItems[0].toJSON())}};s.openConfirmationModal(e)}var v=this,m=e._route.objectId||e._vxViewNodeData.node.contentSpec.metadata.objectId,g=i.getString.bind(i,"Common"),h=n.getColumnRenderer("object-name");v.watchForObjects=[m],v.havePrivilege=!1,v.datagridOptions={columnDefs:[{displayName:g("PermissionView.userGroupName"),field:"principal",width:"40%",template:function(e){var t,i,r=e.principal;return e.isGroup?(t="icon-vSphere-group",i=g("PermissionView.group")):(t="icon-vSphere-user",i=g("PermissionView.user")),'<div><i class="'+t+'" aria-label="'+_.escape(i)+'"></i><span title="'+_.escape(r)+'">'+_.escape(r)+"</span></div>"}},{displayName:g("PermissionView.role"),field:"role",width:"30%",template:function(e){return"<span>"+e.role+"</span>"}},{displayName:g("PermissionView.defined"),width:"30%",field:"entityId",searchable:!1,template:function(e){return l(e)}}],data:[],sortOrder:[{field:"principal",dir:"asc"}],sortMode:o.grid.sortMode.SINGLE,selectionMode:o.grid.selectionMode.SINGLE,selectedItems:[],height:"100%",resizable:!0,actionBarOptions:{actions:[{id:"add-permission-action",iconClass:"vsphere-icon-toolbar-add",tooltipText:g("permissionAction.add.label"),enabled:v.havePrivilege,onClick:d},{id:"edit-permission-action",iconClass:"vsphere-icon-toolbar-edit",tooltipText:g("permissionAction.edit.label"),enabled:!1,onClick:u},{id:"delete-permission-action",iconClass:"vsphere-icon-toolbar-remove",tooltipText:g("permissionAction.remove.label"),enabled:v.havePrivilege,onClick:p}]}},e.$watch(function(){return v.datagridOptions.selectedItems},function(e){v.datagridOptions.actionBarOptions.actions[0].enabled=!1,v.datagridOptions.actionBarOptions.actions[1].enabled=!1,v.datagridOptions.actionBarOptions.actions[2].enabled=!1,v.havePrivilege&&(v.datagridOptions.actionBarOptions.actions[0].enabled=!0,_.isEmpty(e)||(v.datagridOptions.actionBarOptions.actions[1].enabled=!0,(e[0].isDefinedOnCurrentObject||"urn:vri:acl:RootPermissionNode:root"===m&&e[0].isGlobal)&&(v.datagridOptions.actionBarOptions.actions[2].enabled=!0)))}),v.fetchPermissions=function(){m||(m=e._vxViewNodeData.node.contentSpec.metadata.objectId);var i=c.getUserPrivileges(m),n=r.getEntityPermissions(m);t.all([i,n]).then(function(e){var t=e[0],i=e[1];v.havePrivilege=t.grantedPrivileges&&t.grantedPrivileges.indexOf("Authorization.ModifyPermissions")>=0,v.datagridOptions.data=i})},v.showActionsMenu=function(t){var i=t.clientX,r=t.clientY,n=t.data;a.showObjectContextMenu(t,e,n,i,r)},v.fetchPermissions()}angular.module("com.vmware.vsphere.client.commonModule").controller("PermissionViewController",e),e.$inject=["$scope","$q","i18nService","PermissionDataService","columnRenderersRegistry","vuiConstants","actionsService","clarityModalService","userPrivilegeService"]}(),function(){"use strict";function e(){function e(e,i){var r=new t(e,i);return r.formatPrivilegeData()}return{formatData:e}}function t(e,t){function i(e){return e.label.toLowerCase()}this._nodesByName={},this._roots=[],this._properties=e,this._privilegeData=t,this.formatPrivilegeData=function(){return _.forEach(this.filterOutSystemPrivileges(),function(e){this.placeInTree(e.group.split("."),e.name,this._properties)},this),this.getData()},this.filterOutSystemPrivileges=function(){return _.filter(this._privilegeData,function(e){return!_.contains(["System.Read","System.View","System.Anonymous"],e.name)})},this.getItem=function(e){return this._nodesByName[e]},this.placeInTree=function(e,t){var i=this.getItem(t);if(i)return i;if(0===e.length)return this.addRoot(t);var r=this.placeInTree(e.slice(0,e.length-1),e.join("."));return this.addChild(r,t)},this.addRoot=function(e){var t=this.buildTreeItem(e);return this._nodesByName[e]=t,this._roots.push(t),this._roots=_.sortBy(this._roots,i),t},this.addChild=function(e,t){var r=this.buildTreeItem(t);return this._nodesByName[t]=r,e.items.push(r),e.items=_.sortBy(e.items,i),r},this.getData=function(){return[{label:"All Privileges",expanded:!0,items:this._roots}]},this.buildTreeItem=function(e){return{label:this._properties["privilege."+e+".label"],items:[],privilegeId:e}}}angular.module("com.vmware.vsphere.client.commonModule").factory("privilegeTreeDataPresenter",e)}(),angular.module("com.vmware.vsphere.client.commonModule").controller("RelatedItemsPortletController",["$scope","relatedItemsService",function(e,t){"use strict";var i=this,r=e._route.objectId;"undefined"!==r&&null!==r||(r=e._view.contentSpec.metadata.objectId),i.watchForObjects=[r],i.getData=function(){var e=t.getRelatedItems(r);e.then(function(e){i.stackViewData=e})},i.getData()}]),function(){function e(e,t,i,r){var n=this;n.validity="",n.errorMessage="",n.name=e.modalOptions.dialogData.existingObjectName,n.maxNameLength=e.modalOptions.dialogData.maxNameLength||80,n.renameObject=function(){n.name?i.validate(e.modalOptions.dialogData.objectId,"com.vmware.vsphere.client.mixed.ManagedEntityExtendedNameInfo",{name:n.name,targetType:null}).then(function(i){i.result?(t.rename(e.modalOptions.dialogData.objectId,{name:n.name},e.modalOptions.secondaryTitle+"-"+e.modalOptions.title),n.closeModal()):n.invalidateForm(r.getString("Common","rename.name.exist",n.name))}):n.invalidateForm(r.getString("CommonModuleUi","NameValidator.emptyName"))},n.invalidateForm=function(e){n.validity="invalid",n.errorMessage=e},n.closeModal=function(){e.closeModal()}}angular.module("com.vmware.vsphere.client.commonModule").controller("renameObjectController",e),e.$inject=["$scope","managedEntityMutationService","mutationService","i18nService"]}();var cluster_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.navigation=t,this.i18n=e.getString.bind(this,"HostUi")}return e.prototype.$onInit=function(){this.listViewType="HostSystem",this.objectId=this.navigation.getRoute().objectId},e.$inject=["i18nService","navigation"],e}();e.HostSecurityOverviewController=t,angular.module("com.vmware.vsphere.client.commonModule").component("hostSecurityOverview",{templateUrl:"common-module-ui/resources/common-module/views/security/host-security-overview.html",controller:t,bindings:{relationId:"@"}})}(cluster_ui||(cluster_ui={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.dataService=r,this.timeFormatterService=n,this.mutationService=o,this.userSessionService=a,this.clarityModalService=s,this.defaultUriSchemeUtil=c,this.PROP_USER_SESSION="vcUserSessions",this.PROP_USER_CURRENT_SESSION="currentSessionId",this.SESSION_TERMINATE_SPEC="com.vmware.vsphere.client.folder.VcSessionTerminationSpec",this.objectId=this.$scope._route.objectId||this.$scope._vxViewNodeData.node.contentSpec.metadata.objectId,this.watchForObjects=[this.objectId],this.terminateAction=this.getTerminateAction(),this.dataGridOptions=this.getDataGridOptions(),this.getUserSessionData(),this.$scope.$watch("sessionViewCtrl.dataGridOptions.selectedItems",function(e){var t=!!e&&e.length>0&&!e[0].currentSession;l.terminateAction.enabled=t})}return e.prototype.openDeleteModal=function(){var e={title:this.i18nService.getString("FolderUi","vcSessions.terminateSessionCaption"),message:this.i18nService.getString("FolderUi","vcSessions.terminateSessionWarning"),icon:"vsphere-icon-status-warning",submit:this.terminateSession.bind(this)};this.clarityModalService.openConfirmationModal(e)},e.prototype.terminateSession=function(){var e=this,t={userSessionId:[this.dataGridOptions.selectedItems[0].key]};return this.userSessionService.getAllServersInfo().then(function(i){var r=e.defaultUriSchemeUtil.createVmomiUri("Folder","group-d1",i.serversInfo[0].serviceGuid);e.mutationService.apply(r,e.SESSION_TERMINATE_SPEC,t)})},e.prototype.getUserSessionData=function(){var e=this;return this.activeSessions=0,this.idleSessions=0,this.dataService.getProperties(this.objectId,[this.PROP_USER_SESSION,this.PROP_USER_CURRENT_SESSION]).then(function(t){e.dataGridOptions.data=t.vcUserSessions,e.timeFormatterService.getUserTimeFormatPreference().then(function(i){var r=(new Date).getTime();e.parseUserSessionData(i,r,t.currentSessionId)})})},e.prototype.parseUserSessionData=function(e,t,i){for(var r={day:"numeric",month:"numeric",year:"2-digit",hour:"numeric",minute:"numeric"},n=0,o=this.dataGridOptions.data;n<o.length;n++){var a=o[n];a.onlineSince=this.timeFormatterService.timestampToText(a.loginTime,e,r),a.idleTime=Math.floor((t-a.lastActiveTime)/6e4),a.currentSession=i===a.key,a.status=this.getStatus(a)}},e.prototype.getStatus=function(e){if(e.currentSession)return this.activeSessions++,this.i18nService.getString("FolderUi","vcSessions.sessionStatusThisSession");if(this.isActiveSession(e))return this.activeSessions++,this.i18nService.getString("FolderUi","vcSessions.sessionStatusActive");this.idleSessions++;var t=Math.floor(e.idleTime/1440),i=Math.floor(e.idleTime%1440/60),r=e.idleTime%60;return t>0?this.i18nService.getString("FolderUi","vcSessions.sessionStatusIdleDays",t,i,r):i>0?this.i18nService.getString("FolderUi","vcSessions.sessionStatusIdleHours",i,r):this.i18nService.getString("FolderUi","vcSessions.sessionStatusIdleMinutes",r)},e.prototype.isActiveSession=function(e){return e.currentSession||e.idleTime<=10},e.prototype.getDataGridOptions=function(){return{actionBarOptions:{actions:[this.terminateAction]},columnDefs:[{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.userName"),field:"userName",width:"20%"},{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.fullName"),field:"fullName",width:"15%"},{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.onlineSince"),field:"onlineSince",width:"13%"},{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.status"),field:"status",width:"15%"},{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.ipAddress"),field:"ipAddress",width:"11%"},{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.userAgent"),field:"userAgent",width:"15%"},{displayName:this.i18nService.getString("FolderUi","vcSessions.userSessions.callCount"),field:"callCount",type:"number",width:"11%"}],data:[],sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],height:"100%",resizable:!0}},e.prototype.getTerminateAction=function(){return{id:"delete-session-action",iconClass:"vsphere-icon-toolbar-remove",tooltipText:this.i18nService.getString("FolderUi","vcSessions.terminateSessionCaption"),enabled:!1,onClick:this.openDeleteModal.bind(this)}},e.prototype.getActiveSessionString=function(){return this.i18nService.getString("FolderUi","vcSessions.activeSessions",this.activeSessions)},e.prototype.getIdleSessionString=function(){return this.i18nService.getString("FolderUi","vcSessions.idleSessions",this.idleSessions)},e.$inject=["$scope","i18nService","vuiConstants","dataService","timeFormatterService","mutationService","userSessionService","clarityModalService","defaultUriSchemeUtil"],e}();e.SessionViewController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("SessionViewController",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,t,i,r){function n(e){var t=this;t.objectId=e,t.datagridOptions={actionBarOptions:{actions:[{id:"addTag",enabled:!0,label:i.getString("CommonModuleUi","add.tag"),iconClass:"vx-icon-tag"}]},columnDefs:[{displayName:i.getString("Common","tag.dashboard.assignedNameColumn"),field:"name",sortable:!0,searchable:!1},{displayName:i.getString("Common","tag.dashboard.categoryColumn"),field:"categoryName",sortable:!1,searchable:!1},{displayName:i.getString("Common","tag.dashboard.descColumn"),field:"description",sortable:!1,searchable:!1}],height:"200px",resizable:!1,reorderable:!0,selectionMode:r.grid.selectionMode.SINGLE,selectedItems:[]}}function o(e){return new n(e)}return n.prototype.populateDataGrid=function(){var e=this;t.getAssignableTagsForObject(e.objectId).then(function(t){e.datagridOptions.data=t.assignableTagsForTarget||[]})},n.prototype.assignTag=function(){var i=this;t.attachTag(i.datagridOptions.selectedItems[0],i.objectId).then(function(){e.$broadcast("tagUpdate",i.objectId)})},n.prototype.setTagSelectionListener=function(t){var i=this;e.$watch(function(){return i.datagridOptions.selectedItems},function(e){var i=e&&e.length?e[0]:null;t.call(this,i)})},{make:o}}angular.module("com.vmware.vsphere.client.commonModule").factory("AssignTagGridFactory",e),e.$inject=["$rootScope","tagService","i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(){r.getAction(a).then(function(e){var t={title:i.getString("CommonModuleUi","add.tag")};r.invokeAction(e,t)})}var o=this,a="vsphere.core.common.actions.addTag",s=e.modalOptions.availableTargets[0];o.tagGrid=t.make(s),o.tagGrid.datagridOptions.actionBarOptions.actions[0].onClick=n,o.tagGrid.populateDataGrid(),o.onTagSelectionChanged=function(e){o.assignDisabled=!e},o.tagGrid.setTagSelectionListener(o.onTagSelectionChanged),e.$on("refreshTagGrid",function(){o.tagGrid.populateDataGrid()}),o.assignTag=function(){o.tagGrid.assignTag(),o.closeModal()},o.closeModal=function(){e.closeModal()}}angular.module("com.vmware.vsphere.client.commonModule").controller("AssignTagsDialogController",e),e.$inject=["$scope","AssignTagGridFactory","i18nService","actionsService"]}();var h5_client;!function(e){var t;!function(e){var t=function(){function e(){this.bindings={modifyTagData:"<",categoryData:"<",submitDisabled:"=",onSubmit:"="},this.controller=i,this.templateUrl="common-module-ui/resources/common-module/views/tags/modify-tag-component.html"}return e}();e.ModifyTagComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.$rootScope=t,this.categoryService=i,this.actionsService=r,this.CREATE_CATEGORY_ACTION_ID="vsphere.core.common.actions.addCategory"}return e.prototype.$onInit=function(){var e=this;this.validity="valid",this.errorMessage="",this.unModifiedName=angular.copy(this.modifyTagData.name),this.createTagCategoryPromiseResolved=!1,this.i18n=function(t){return e.i18nService.getString("CommonModuleUi",t)},this.onSubmitCaller=this.onSubmit,this.onSubmit=function(){return e.onSubmitFunction()},this.disableSubmit(),this.modifyTagData.mode===r.ADD&&(this.populateCategorySelect(),this.createTagCategoryPromise=this.actionsService.getAction(this.CREATE_CATEGORY_ACTION_ID).then(function(t){if(t)return e.createTagCategoryPromiseResolved=!0,t})),this.$rootScope.$on("refreshCategories",function(){e.populateCategorySelect()})},e.prototype.disableSubmit=function(){this.modifyTagData.mode===r.ADD?this.submitDisabled=!this.modifyTagData.name||!this.categoryData.selectedCategory:this.submitDisabled=!this.modifyTagData.name},e.prototype.populateCategorySelect=function(){var e=this;this.categoryService.getAll().then(function(t){t&&t.length&&(e.categoryData.selectedCategory=t[0],e.categories=t),e.disableSubmit()})},e.prototype.isCategoryAvailable=function(){return this.modifyTagData.mode===r.EDIT||!this.createTagCategoryPromiseResolved},e.prototype.addCategory=function(){var e=this;this.createTagCategoryPromise.then(function(t){var i={title:e.i18n("add.category"),categoryState:{}};e.actionsService.invokeAction(t,i)})},e.prototype.onSubmitFunction=function(){var e=this;return this.onSubmitCaller().then(function(t){return!(t.error&&t.error.message&&t.error.message.indexOf("AlreadyExistsFault")>=0)||(e.displayDuplicateError(),!1)})},e.prototype.displayDuplicateError=function(){var e=this.modifyTagData.mode===r.ADD?this.categoryData.selectedCategory.categoryName:this.modifyTagData.categoryName;this.validity="invalid",this.errorMessage=this.i18nService.getString("Common","tag.create.form.error.tag.duplicate",e)},e.$inject=["i18nService","$rootScope","categoryService","actionsService"],e}();!function(e){e[e.ADD=0]="ADD",e[e.EDIT=1]="EDIT"}(e.ModifyTagMode||(e.ModifyTagMode={}));var r=e.ModifyTagMode;angular.module("com.vmware.vsphere.client.commonModule").component("modifyTagComponent",new t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){function e(e,t,i,r){function n(t){var n=this;n.objectIds=t,n.datagridOptions={columnDefs:[{displayName:i.getString("Common","tag.dashboard.assignedNameColumn"),field:"name",sortable:!1,searchable:!1},{displayName:i.getString("Common","tag.dashboard.categoryColumn"),field:"categoryName",sortable:!1,searchable:!1},{displayName:i.getString("Common","tag.dashboard.descColumn"),field:"description",sortable:!1,searchable:!1}],height:"200px",resizable:!1,reorderable:!1,selectedItems:[],selectionMode:r.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedTags:[],data:[]},e.$on("tagUpdate",function(e,t){n.objectIds.indexOf(t)!==-1&&n.populateDataGrid()})}function o(e){return new n(e)}return n.prototype.populateDataGrid=function(){var e=this;e.objectIds.forEach(function(i){t.getTagInfoForObject(i).then(function(t){var i=t.filter(function(t){return!e.datagridOptions.data.some(function(e){return _.isEqual(t,e)})});e.datagridOptions.data=e.datagridOptions.data.concat(i)})})},n.prototype.removeTag=function(){for(var e=this,t=e.datagridOptions.selectedItems.length,i=e.datagridOptions.selectedItems[t-1],r=0;r<t-1;r++)this.removeMultiple(e.objectIds,e.datagridOptions.selectedItems[r]);i&&this.removeMultiple(e.objectIds,i,!0)},n.prototype.removeMultiple=function(i,r,n){i.forEach(function(i){t.detachTag(r.resourceObject,i).then(function(){n&&e.$broadcast("tagUpdate",i)})})},n.prototype.setTagSelectionListener=function(t){var i=this;e.$watch(function(){return i.datagridOptions.selectedItems},function(e){var i=e&&e.length?e:null;t.call(this,i)})},n.prototype.refresh=function(){this.populateDataGrid()},{make:o}}angular.module("com.vmware.vsphere.client.commonModule").factory("RemoveMultiTagsGridFactory",e),e.$inject=["$rootScope","tagService","i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r){var n=this,o=e.modalOptions.availableTargets;o.length>1?(n.bulkRemoval=!0,n.tagGrid=i.make(o),e.modalOptions.title=r.getString("Common","tag.remove.form.batch.title",o.length+""),e.modalOptions.secondaryTitle=""):n.tagGrid=t.make(o[0]),n.tagGrid.populateDataGrid(),n.onTagSelectionChanged=function(e){n.removeDisabled=!e},n.tagGrid.setTagSelectionListener(n.onTagSelectionChanged),n.removeTag=function(){n.tagGrid.removeTag(),n.closeModal()},n.closeModal=function(){e.closeModal()}}angular.module("com.vmware.vsphere.client.commonModule").controller("RemoveTagDialogController",e),e.$inject=["$scope","RemoveTagGridFactory","RemoveMultiTagsGridFactory","i18nService"]}(),function(){"use strict";function e(e,t,i,r){function n(t){var n=this;n.objectId=t,n.datagridOptions={columnDefs:[{displayName:i.getString("Common","tag.dashboard.assignedNameColumn"),field:"name",sortable:!1,searchable:!1},{displayName:i.getString("Common","tag.dashboard.categoryColumn"),field:"categoryName",sortable:!1,searchable:!1},{displayName:i.getString("Common","tag.dashboard.descColumn"),field:"description",sortable:!1,searchable:!1}],height:"200px",resizable:!1,reorderable:!1,selectedItems:[],selectionMode:r.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedTags:[]},e.$on("tagUpdate",function(e,t){n.objectId===t&&n.populateDataGrid()})}function o(e){return new n(e)}return n.prototype.populateDataGrid=function(){var e=this;t.getTagInfoForObject(e.objectId).then(function(t){
e.datagridOptions.data=t})},n.prototype.removeTag=function(){for(var i=this,r=i.datagridOptions.selectedItems.length,n=0;n<r-1;n++){var o=i.datagridOptions.selectedItems[n];t.detachTag(o.resourceObject,i.objectId)}var a=i.datagridOptions.selectedItems[r-1];a&&t.detachTag(a.resourceObject,i.objectId).then(function(t){return e.$broadcast("tagUpdate",i.objectId),!0})},n.prototype.setTagSelectionListener=function(t){var i=this;e.$watch(function(){return i.datagridOptions.selectedItems},function(e){var i=e&&e.length?e:null;t.call(this,i)})},n.prototype.refresh=function(){var e=this;t.getTagInfoForObject(e.objectId).then(function(t){e.datagridOptions.data=t})},{make:o}}angular.module("com.vmware.vsphere.client.commonModule").factory("RemoveTagGridFactory",e),e.$inject=["$rootScope","tagService","i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(e){var t=document.createElement("span");return t.setAttribute("ng-non-bindable","ng-non-bindable"),t.title=e,t.textContent=e,t.outerHTML}function l(){var e=[{actionId:"vsphere.core.common.actions.addTag",isActionAvailable:function(e){return e.available&&f.grantedPrivileges.indexOf(m)!==-1}},{actionId:"vsphere.core.common.actions.editTag",isActionAvailable:function(e){return e.available&&f.selectedItem&&f.grantedPrivileges.indexOf(g)!==-1},getActionInvocationContext:function(){return{tag:f.selectedItem}}},{actionId:"vsphere.core.common.actions.deleteTag",isActionAvailable:function(e){return e.available&&f.selectedItem&&f.grantedPrivileges.indexOf(h)!==-1},getActionInvocationContext:function(){return{tag:f.selectedItem}}}];r.updateActionBar(f.datagridOptions,[],e)}function d(){o.getProperties(n.createUri(p,v),[u]).then(function(e){e&&e[u]&&(f.grantedPrivileges=e[u],l())})}var u="grantedPrivileges",p="acl:RootPermissionNode",v="root",m="InventoryService.Tagging.CreateTag",g="InventoryService.Tagging.EditTag",h="InventoryService.Tagging.DeleteTag",f=this;f.grantedPrivileges=[],f.onSelectionChange=function(e){f.selectedItem=e&&1===e.length?e[0]:null,l()},f.datagridOptions={actionBarOptions:{actions:[]},columnDefs:[{displayName:e.getString("Common","tag.dashboard.nameColumn"),field:"name",sortable:!0,searchable:!1,template:function(e){return c(e.name)}},{displayName:e.getString("Common","tag.dashboard.categoryColumn"),field:"categoryName",sortable:!0,searchable:!1,template:function(e){return c(e.categoryName)}},{displayName:e.getString("Common","tag.dashboard.descColumn"),field:"description",sortable:!0,searchable:!1,template:function(e){return c(e.description)}}],sortOrder:[{field:"categoryName",dir:"asc"}],height:"100%",resizable:!0,reorderable:!0,selectionMode:t.grid.selectionMode.SINGLE,onChange:f.onSelectionChange.bind(f),selectedItems:[],pageable:!0,pageConfig:{displayMode:t.grid.displayMode.VIRTUAL_SCROLLING,size:50},data:{url:"tagging-ui/ctrl/tags",dataType:t.grid.dataType.JSON,method:t.grid.dataMethod.GET,data:"summaryItemSpecs",total:"totalMatchedObjectCount",beforeSend:function(e){e.setRequestHeader(s.WEB_CLIENT_SESSION_ID,s.webClientSessionId)}},pageSize:50},i.$on("refreshTagGrid",function(){a.find("[kendo-grid]").data("kendoGrid").dataSource.read()}),d()}angular.module("com.vmware.vsphere.client.commonModule").controller("TagsController",e),e.$inject=["i18nService","vuiConstants","$scope","datagridActionBarService","defaultUriSchemeUtil","dataService","$element","userSessionService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(t){e.portlet.footerLinks[1].enabled=t}function a(t){if(c.selectedTags){var r={title:i.getString("Common","tag.remove.warning.title"),message:i.getString("Common","tag.remove.warning.text",c.selectedTags[0].name,e.currentObject.name),saveButtonLabel:i.getString("Common","tag.remove.warning.submit"),submit:function(){return c.tagGrid.removeTag(),!0},focusTarget:t.currentTarget};c.selectedTags.length>1&&(r.message=i.getString("Common","tag.multi.remove.warning.text",c.selectedTags.length,e.currentObject.name)),n.openConfirmationModal(r)}}function s(e){c.assignMutex||(c.assignMutex=!0,r.getAction("vsphere.core.common.actions.assignTag",[c.objectId]).then(function(t){r.invokeAction(t,{focusTarget:e.currentTarget})})["finally"](function(){c.assignMutex=!1}))}var c=this;c.objectId=e._route.objectId,e.portlet.footerLinks=[{label:i.getString("Common","tag.dashboard.assign"),ariaLabel:i.getString("Common","tag.dashboard.assignAriaLabel"),onClick:s,enabled:!0},{label:i.getString("Common","tag.dashboard.remove"),ariaLabel:i.getString("Common","tag.dashboard.removeAriaLabel"),onClick:a,enabled:!1}],c.tagGrid=t.make(c.objectId),c.tagGrid.populateDataGrid(c.objectId),c.refresh=function(){c.tagGrid.refresh(c.objectId)},c.onTagSelectionChanged=function(e){o(!!e),c.selectedTags=e},c.tagGrid.setTagSelectionListener(c.onTagSelectionChanged),c.assignMutex=!1}angular.module("com.vmware.vsphere.client.commonModule").controller("TagsPortletController",e),e.$inject=["$scope","RemoveTagGridFactory","i18nService","actionsService","clarityModalService"]}();var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n){this.$q=e,this.defaultUriSchemeUtil=t,this.objectTypesService=i,this.dataService=r,this.timeFormatterService=n,this.SOURCE_OBJECTS_PROPERTY="sourceObjects"}return e.prototype.handleAlarmUpdates=function(e,t,i){var r=this;if(e.isDelta){if(!e.data)return this.handleResetToGreenAlarm(e,i);if(e.data)return this.handleAcknowledgeAlarm(e,i)}return this.isNewAlarmRelevant(e,t).then(function(t){return t?r.handleNewAlarm(e,i):r.$q.resolve(!1)})},e.prototype.isNewAlarmRelevant=function(e,t){return this.isAlarmEntitySameAsCurrentView(e,t)?this.$q.resolve(!0):this.isCurrentViewRootFolder(t)&&this.isAlarmEntityRootFolderMatching(e,t)?this.$q.resolve(!0):this.isAlarmEntityUnderCurrentView(e,t)},e.prototype.isAlarmEntitySameAsCurrentView=function(e,t){var i=this.defaultUriSchemeUtil.getVsphereObjectId(e.data.entity);return i===t},e.prototype.isCurrentViewRootFolder=function(e){return this.defaultUriSchemeUtil.isRootFolder(e)},e.prototype.isAlarmEntityUnderCurrentView=function(e,t){var i=this,r=this.defaultUriSchemeUtil.getVsphereObjectId(e.data.entity);return this.dataService.getProperties(r,this.SOURCE_OBJECTS_PROPERTY).then(function(e){if(e&&e[i.SOURCE_OBJECTS_PROPERTY]){var r=e[i.SOURCE_OBJECTS_PROPERTY],n=i.defaultUriSchemeUtil.getVsphereObjectId(r.hostedObject),o=i.defaultUriSchemeUtil.getVsphereObjectId(r.vmFolder);return n===t||o===t}return!1})},e.prototype.isAlarmEntityRootFolderMatching=function(e,t){var i=e.data.entity,r=this.defaultUriSchemeUtil.getManagedObjectReference(t);return i.serverGuid===r.serverGuid},e.prototype.handleNewAlarm=function(e,t){var i=e.data.key,r={entity:e.data.entity,entityName:e.metadata.issueInfo.entityName,details:{alarmState:{_type:"com.vmware.vim.binding.vim.alarm.AlarmState",key:i,overallStatus:e.data.overallStatus,time:this.getTimestampFromDate(e.data.time),acknowledged:e.data.acknowledged,entity:e.data.entity},alarmInfo:{_type:"com.vmware.vim.binding.vim.alarm.AlarmInfo",name:e.metadata[i].name,entity:e.metadata[i].entity,alarm:e.data.alarm},definedInEntityName:e.metadata.alarmInfoName}};return this.getDefinedInEntityObject(r).then(function(e){return r.definedInEntityIcon=e.icon,r.definedInEntityNamespace=e.namespace,t.push(r),!0})},e.prototype.handleResetToGreenAlarm=function(e,t){var i=_.findIndex(t,function(t){return e.source===t.details.alarmState.key});return i===-1?this.$q.resolve(!1):(t.splice(i,1),this.$q.resolve(!0))},e.prototype.handleAcknowledgeAlarm=function(e,t){var i=_.findIndex(t,function(t){return e.data.key===t.details.alarmState.key});if(i===-1)return this.$q.resolve(!1);var r=t[i].details.alarmState;return r.acknowledged=e.data.acknowledged,r.acknowledgedTime=this.getTimestampFromDate(e.data.acknowledgedTime),r.acknowledgedByUser=e.data.acknowledgedByUser,this.$q.resolve(!0)},e.prototype.getTimestampFromDate=function(e){return new Date(Date.UTC(e.year,e.month,e.dayOfMonth,e.hourOfDay,e.minute,e.second)).valueOf()},e.prototype.getDefinedInEntityObject=function(e){var t=e.details.alarmInfo.entity._type;return this.objectTypesService.getObjectTypeSpec(t)},e.$inject=["$q","defaultUriSchemeUtil","objectTypesService","dataService","timeFormatterService"],e}();e.TriggeredAlarmsRefreshService=t,angular.module("com.vmware.vsphere.client.commonModule").service("triggeredAlarmsRefreshService",t)}(t=e.common_module_ui||(e.common_module_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){function g(){var e="live.updates.alarms.enabled";return p.getProperty(e).then(function(e){if("false"!==e)return i.$on("alarms",h)})}function h(i,r){var n=[];_.each(r.updates,function(e){n.push(m.handleAlarmUpdates(e,D.objectId,D.alarms))}),e.all(n).then(function(){v.safeApply(t,function(){D.datagridOptions.data=_.sortBy(D.alarms,function(e){return e.details.alarmState.time}).reverse()})})}function f(e){return u.getUserTimeFormatPreference().then(function(t){D.savedDateFormat=t,e&&e(t)})}function S(){d.updateActionBar(D.datagridOptions,[D.objectId],T).then(function(e){w=e})}function y(){w&&d.updateActionBar(D.datagridOptions,[D.objectId],T,w)}function P(){var e=D.datagridOptions.selectedItems,t=e[0].details.alarmInfo;return{entityId:o.getVsphereObjectId(e[0].details.alarmState.entity),alarm:t.alarm}}var C=s.getColumnRenderer("link"),D=this,w=null,b={actionId:"vsphere.opsmgmt.alarms.acknowledge",noLabel:!0,getActionInvocationContext:P,isActionAvailable:function(e){var t=D.datagridOptions.selectedItems;return 0!==t.length&&(!t[0].details.alarmState.acknowledged&&e.available)}};D.savedDateFormat=null;var I={actionId:"vsphere.opsmgmt.alarms.reset",noLabel:!0,getActionInvocationContext:P,isActionAvailable:function(e){return e.available&&D.datagridOptions.selectedItems.length>0}},T=[b,I];D.objectId=t._route.objectId,D.watchForObjects=[D.objectId],D.alarms=[],D.pendingRequest=!1,D.datagridOptions={actionBarOptions:{actions:[]},resizable:!0,searchable:!1,selectionMode:c.grid.selectionMode.SINGLE,height:"99%",selectedItems:[],columnDefs:[{displayName:r.getString("Common","alarmsView.tableHeaderText.object"),field:"entityName",template:function(e){return C(o.getVsphereObjectId(e.entity),e.entityName)}},{displayName:r.getString("Common","alarmsView.tableHeaderText.severity"),field:"details.alarmState.overallStatus",template:function(e){var t=n.getSeverity(e.details.alarmState.overallStatus),i=n.getStatusIconClass(e.details.alarmState.overallStatus);return C(null,t,i)}},{displayName:r.getString("Common","alarmsView.tableHeaderText.name"),field:"details.alarmInfo.name",template:function(e){var t=o.getVsphereObjectId(e.details.alarmInfo.entity),i=e.definedInEntityNamespace+".manage.alarmDefinitions";return C(t,e.details.alarmInfo.name,null,!1,{extensionName:i})}},{displayName:r.getString("Common","alarmsView.tableHeaderText.triggered"),field:"details.alarmState.time",template:function(e){return u.timestampToText(parseInt(e.details.alarmState.time),D.savedDateFormat)}},{displayName:r.getString("Common","alarmsView.tableHeaderText.acknowledgedTime"),field:"details.alarmState.acknowledgedTime",template:function(e){return e.details.alarmState.acknowledgedTime?u.timestampToText(parseInt(e.details.alarmState.acknowledgedTime),D.savedDateFormat):""}},{displayName:r.getString("Common","alarmsView.tableHeaderText.acknowledgedByUser"),field:"details.alarmState.acknowledgedByUser",template:function(e){return e.details.alarmState.acknowledgedByUser?e.details.alarmState.acknowledgedByUser:""}},{displayName:r.getString("Common","alarmsView.tableHeaderText.definedIn"),field:"details.definedInEntityName",template:function(e){var t,i,n;n="group-d1"===e.details.alarmInfo.entity.value||"group-d1"===e.details.alarmInfo.entity._value?"vsphere-icon-vcenter":e.definedInEntityIcon;var a=o.getVsphereObjectId(e.details.alarmInfo.entity);return a===D.objectId?(i=r.getString("AlarmsUi","definedIn.this.object"),t=null):(i=e.details.definedInEntityName,t=a),C(t,i,n)}}],data:[]},D.showActionsMenu=function(e){var i=e.data[0];i&&i.details&&l.showActionsMenu(e,t,i.details.alarmInfo,i.details.alarmState,e.clientX,e.clientY,e.currentTarget)},S(),t.$watch("ctrl.datagridOptions.selectedItems",function(){y()}),t.$on("IssueChangeEvent",D.getAlarms),D.getAlarms=function(){D.pendingRequest!==!0&&(D.pendingRequest=!0,n.getAlarms(D.objectId).then(function(t){var i=_.map(t,function(e){var t=e.details.alarmInfo.entity.type;return a.getObjectTypeSpec(t).then(function(t){return e.definedInEntityIcon=t.icon,e.definedInEntityNamespace=t.namespace,e})});return e.all(i)}).then(function(e){D.alarms=e,D.datagridOptions.data=e})["finally"](function(){D.pendingRequest=!1,D.cancelLiveRefreshFn||g().then(function(e){D.cancelLiveRefreshFn=e,t.$on("$destroy",function(){D.cancelLiveRefreshFn()})})}))},f(D.getAlarms)}angular.module("com.vmware.vsphere.client.commonModule").controller("TriggeredAlarmsViewController",e),e.$inject=["$q","$scope","$rootScope","i18nService","alarmService","defaultUriSchemeUtil","objectTypesService","columnRenderersRegistry","vuiConstants","alarmIssueActionService","datagridActionBarService","timeFormatterService","configurationService","vuiUtils","triggeredAlarmsRefreshService"]}();var common_module_ui;!function(e){var t=function(){function e(){}return e.prototype.$onChanges=function(e){var t="undefined"!=typeof e.maxValue?e.maxValue.currentValue:"",i="undefined"!=typeof e.groupedMeters?e.groupedMeters.currentValue:[];if(t&&""!==t&&(this.minValue=this.getMinValue(t)),i&&i.length>0){var r=_.max(i,function(e){return parseFloat(e.value)}),n=_.pluck(i,"value"),o=100-_.reduce(n,function(e,t){return e+parseFloat(t)},0);100!==o&&0!==o&&_.each(e.groupedMeters.currentValue,function(e){_.isEqual(r,e)&&(e.value=parseFloat(r.value)+o)})}},e.prototype.getMinValue=function(e){var t="";return e.length>0&&(t="0 "+e.split(" ")[1]),t},e}(),i=function(){function e(){this.controller=t,this.templateUrl="common-module-ui/resources/common-module/views/utilization/objectUtilizationMeterGroup.html",this.bindings={groupedMeters:"<",meters:"<",maxValue:"<",pointers:"<"}}return e}();angular.module("com.vmware.vsphere.client.commonModule").component("objectUtilizationMeterGroup",new i)}(common_module_ui||(common_module_ui={}));var common_module_ui;!function(e){var t=function(){function e(){}return e.PROP_SERVER_SETTINGS="vcServerSettings",e.PROP_DATABASE_STATISTICS="estimatedDastabaseSize",e.KEY_DATABASE="databaseSettings",e.KEY_RUNTIME="runtimeSettings",e.KEY_USER_DIRECTORY="activeDirectorySettings",e.KEY_MAIL="mailSettings",e.KEY_SNMP_RECEIVER="snmpSettings",e.KEY_PORTS="portsSettings",e.KEY_TIMEOUT="timeoutSettings",e.KEY_LOGGING="logSettings",e.KEY_SSL="sslSettings",e.DEFAULT_HOST_COUNT=50,e.DEFAULT_VM_COUNT=2e3,e}();e.VCServerSettingConstants=t}(common_module_ui||(common_module_ui={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t){var i=this;this.$scope=e,this.vcServerSettingService=t;var r=this.$scope._route.objectId||this.$scope._vxViewNodeData.node.contentSpec.metadata.objectId;this.vcServerSettingService.getServerSettings(r).then(function(e){i.vcServerSettings=e})}return e.$inject=["$scope","vcServerSettingService"],e}();e.VCServerSettingController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("VCServerSettingController",t)}(t||(t={}))}(h5_client||(h5_client={}));var common_module_ui;!function(e){var t=e.VCServerSettingConstants,i=function(){function e(e,t,i){var r=this;this.dataService=e,this.i18nService=t,this.numberFormatterService=i,this.i18n=function(e,t){return r.i18nService.getString("FolderUi",e,t)}}return e.prototype.getServerSettings=function(e){var i=this,n=[{propertyName:t.PROP_DATABASE_STATISTICS,parameterType:"com.vmware.vim.binding.vim.ResourcePlanningManager$DatabaseSizeParam",parameter:{_type:"com.vmware.vim.binding.vim.ResourcePlanningManager$DatabaseSizeParam",inventoryDesc:{_type:"com.vmware.vim.binding.vim.ResourcePlanningManager$InventoryDescription",numHosts:t.DEFAULT_HOST_COUNT,numVirtualMachines:t.DEFAULT_VM_COUNT}}}];return this.dataService.getProperties(e,[t.PROP_SERVER_SETTINGS,t.PROP_DATABASE_STATISTICS],{propertyParams:n}).then(function(e){var t=i.numberFormatterService.formatStorage(e.estimatedDastabaseSize,r.MB,r.GB,2),n=e.vcServerSettings.properties;return i.parseServerSettings(n,t),n})},e.prototype.parseServerSettings=function(e,t){this.parseStatisticsSettings(e,t),this.parseDatabaseSettings(e),this.parseRuntimeSettings(e),this.parseUserDirectorySettings(e),this.parseMailSettings(e),this.parseSNMPSettings(e),this.parsePortsSettings(e),this.parseTimeoutSettings(e),this.parseLoggingSettings(e),this.parseSSLSettings(e)},e.prototype.parseStatisticsSettings=function(e,t){e.unshift({titleLabel:this.i18n("vcStatisticsConfigPage.title"),titleLabelContent:this.i18n("vcStatisticsConfigPage.estimatedDbSizeLabel"),estimatedDatabaseSize:t,sizeLabel:this.i18nService.getString("CommonUi","gigaByte.label")})},e.prototype.parseDatabaseSettings=function(e){var i=_.findIndex(e,{name:t.KEY_DATABASE});e[i].titleLabel=this.i18n("vcDatabaseConfigPage.title"),e[i].titleLabelContent=this.i18n("vcConfigView.dbMaxConnectionsHeaderLabel",e[i].value.properties[0].value)},e.prototype.parseRuntimeSettings=function(e){var i=_.findIndex(e,{name:t.KEY_RUNTIME});e[i].titleLabel=this.i18n("vcRuntimeConfigPage.title"),e[i].titleLabelContent=this.i18n("vcConfigView.vcInstanceNameHeaderLabel",e[i].value.properties[2].value)},e.prototype.parseUserDirectorySettings=function(e){var i=_.findIndex(e,{name:t.KEY_USER_DIRECTORY});e[i].titleLabel=this.i18n("vcActiveDirectoryConfigPage.title"),e[i].titleLabelContent=this.i18n("vcConfigView.adTimeoutHeaderLabel",e[i].value.properties[0].value)},e.prototype.parseMailSettings=function(e){var i=_.findIndex(e,{name:t.KEY_MAIL});e[i].titleLabel=this.i18n("vcMailConfigPage.title"),e[i].titleLabelContent=e[i].value.properties[0].value},e.prototype.parseSNMPSettings=function(e){var i=_.findIndex(e,{name:t.KEY_SNMP_RECEIVER});e[i].titleLabel=this.i18n("vcSnmpConfigPage.title")},e.prototype.parsePortsSettings=function(e){var i=_.findIndex(e,{name:t.KEY_PORTS});e[i].titleLabel=this.i18n("vcPortsConfigPage.title"),e[i].titleLabelContent=this.i18n("vcConfigView.httpPortLabel",e[i].value.properties[0].value)+"\t\t\t"+this.i18n("vcConfigView.httpsPortLabel",e[i].value.properties[1].value)},e.prototype.parseTimeoutSettings=function(e){var i=_.findIndex(e,{name:t.KEY_TIMEOUT});e[i].titleLabel=this.i18n("vcTimeoutConfigPage.title"),e[i].titleLabelContent=this.i18n("vcConfigView.normalTimeoutLabel",e[i].value.properties[0].value)+"\t\t"+this.i18n("vcConfigView.longTimeoutLabel",e[i].value.properties[1].value)},e.prototype.parseLoggingSettings=function(e){var i=_.findIndex(e,{name:t.KEY_LOGGING});e[i].titleLabel=this.i18n("vcLogConfigPage.title"),e[i].titleLabelContent=this.i18n("vcConfigView.logLevelLabel",e[i].value.properties[0].value)},e.prototype.parseSSLSettings=function(e){var i=_.findIndex(e,{name:t.KEY_SSL});e[i].titleLabel=this.i18n("vcSslConfigPage.title"),e[i].titleLabelContent=this.i18n(e[i].value.properties[0].value?"vcConfigView.verifySslCertificatesEnabled":"vcConfigView.verifySslCertificatesDisabled")},e.$inject=["dataService","i18nService","numberFormatterService"],e}();e.VCServerSettingService=i;var r;!function(e){e[e.B=0]="B",e[e.KB=1]="KB",e[e.MB=2]="MB",e[e.GB=3]="GB",e[e.TB=4]="TB",e[e.PB=5]="PB"}(r||(r={})),angular.module("com.vmware.vsphere.client.commonModule").service("vcServerSettingService",i)}(common_module_ui||(common_module_ui={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t){var i=this;this.$scope=e,this.dataService=t,this.ABOUT_INFO_PROP="aboutInfo";var r=this.$scope._route.objectId||this.$scope._vxViewNodeData.node.contentSpec.metadata.objectId;this.dataService.getProperties(r,[this.ABOUT_INFO_PROP]).then(function(e){i.version=e.aboutInfo.version,i.build=e.aboutInfo.build})}return e.$inject=["$scope","dataService"],e}();e.VersionInformationController=t,angular.module("com.vmware.vsphere.client.commonModule").controller("VersionInformationController",t)}(t||(t={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,t){var i=this;i.objectId="urn:vmomi:Folder:aggregatedData:serverGUID",i.getObjSummaryData=function(){e.getData(i.objectId,"com.vmware.vsphere.client.folder.model.AggregatedFolderSummaryData").then(function(e){i.summaryData=e})},i.getObjSummaryData(),i.getFreeCapacity=function(e){return e.progress>100?t.getString("Common","ResourceAllocationComponent.overusedCapFormat",e.free):t.getString("Common","ResourceAllocationComponent.freeCapFormat",e.free)}}angular.module("com.vmware.vsphere.client.commonModule").controller("ViHomeController",e),e.$inject=["dataService","i18nService"]}(),h5=h5||{},h5.storage={angularModule:angular.module("com.vmware.vsphere.client.storage",["com.vmware.platform.ui","com.vmware.vsphere.client.networkLibUi","ngCookies"])},angular.module("com.vmware.vsphere.client.storage").run(["columnRenderersRegistry","i18nService","datastoreConstants",function(e,t,i){e.registerColumnRenderers({"datastore-type":function(e,r){var n,o=r[e[0]];if(o){var a=o.toLowerCase();switch(a){case i.datastoreSpecificType.nfs3.toLowerCase():n=t.getString("StorageUi","datastore.specificType.nfs3");break;case i.datastoreSpecificType.nfs41.toLowerCase():n=t.getString("StorageUi","datastore.specificType.nfs41");break;case i.datastoreSpecificType.vsan.toLowerCase():n=t.getString("StorageUi","datastore.specificType.vsan");break;case i.datastoreSpecificType.vvol.toLowerCase():n=t.getString("StorageUi","datastore.specificType.vvol");break;case i.datastoreSpecificType.vmfs3.toLowerCase():n=t.getString("StorageUi","datastore.specificType.vmfs3");break;case i.datastoreSpecificType.vmfs5.toLowerCase():n=t.getString("StorageUi","datastore.specificType.vmfs5");break;case i.datastoreSpecificType.vmfs6.toLowerCase():n=t.getString("StorageUi","datastore.specificType.vmfs6");break;default:n=o}}else n="";return'<div title="'+n+'">'+n+"</div>"},"ds-cluster-name":function(t,i,r){var n=e.getColumnRenderer("object-link");return n([t[0],t[1],"vsphere-icon-datastore-cluster"],i,r)},"storage-policy-name":function(e,i){var r=i[e[0]];return r||(r=t.getString("StorageUi","datastore.policy.notAvailable")),'<div title="'+r+'">'+r+"</div>"}})}]).run(["mutationService","i18nService","clarityModalService","vxValidatorFactory","renameFileService","deleteFilesService","storageValidationService",function(e,t,i,r,n,o,a){h5.actions["vsphere.core.datastore.actions.createFolder"]=function(n,o,s){if(o&&o.length&&(s||s.currentPath)){var c=s.currentPath.slice(1,s.currentPath.length-1),l={value:t.getString("StorageUi","datastore.fileManager.defaultFolderName")},d=r.create(),u={contentTemplate:"storage-ui/resources/storage/views/manage/files/CreateNewFolderView.html",title:t.getString("StorageUi","actionCreateFolderDescription"),subTitle:{text:c},defaultButton:"submit",dialogData:{name:l,prompt:t.getString("StorageUi","datastore.fileManager.folderNamePrompt"),validator:d,isValidFolderName:a.validateDatastoreBrowserItemName.bind(a)},alerts:[],onSubmit:function(){var t=d.validate();if(t&&t.length)return!1;var i=l.value.trim(),r=s.isRootFolder&&!s.topLevelDirectoryCreateSupported?i:s.currentPath+"/"+i;return e.apply(o[0],"com.vmware.vsphere.client.h5.storage.spec.DatastoreCreateFolderSpec",{datacenter:s.datastoreDatacenter,isRootFolder:s.isRootFolder,supportTopLevelDirectoryCreate:s.topLevelDirectoryCreateSupported,folderName:r}).then(function(e){s.callback&&s.callback(e)}),!0}};i.openOkCancelModal(u)}},h5.actions["vsphere.core.datastore.actions.deleteFile"]=function(e,t,i){t&&t.length&&i&&o.openDeleteFilesDialog(t[0],i.targetFileNames,i.spec,i.callback)},h5.actions["vsphere.core.datastore.actions.renameFile"]=function(e,t,i){t&&t.length&&i&&n.openRenameFileDialog(t[0],i.spec,i.callback)}}]).run(["fileDownloadService","folderDownloadService","streamVmdkService","$q",function(e,t,i,r){function n(n){var o,a=n.datastoreId,s=!1;n.selectedFiles&&1===n.selectedFiles.length&&"folder"===n.selectedFiles[0].type?(o=t.getFolderChildren(a,n.selectedFiles[0]),s=!0):o=n.isStreamFormat&&n.selectedFiles&&1===n.selectedFiles.length&&n.selectedFiles[0].diskExtents?i.openStreamVmdkWarningDialog(n.selectedFiles):r.when(n.selectedFiles),o.then(function(t){var i=n.datastoreDcRef,r=[],o="",c=!1;_.forEach(t,function(e){c=c||e.diskExtents&&n.isStreamFormat,r.push(e.path),e.diskExtents&&!c&&(r=r.concat(e.diskExtents.slice())),o=n.zipFileName||e.name+".zip"}),r&&r.length>0&&(1!==r.length||s?e.startFilesDownloadAsZip(i,a,r,o,s?n.selectedFiles[0].path:void 0,c):e.startFilesDownload(i,a,r,c))})}h5.actions["vsphere.core.datastore.actions.downloadFromDatastore"]=function(e,t,i){t&&t.length&&i&&n(i)}}]).run(["fileCopyService",function(e){h5.actions["vsphere.core.datastore.actions.copyFile"]=function(t,i,r){if(i&&i.length&&r){var n="com.vmware.vsphere.client.storage.DatastoreFileCopySpec";e.copyFiles(i[0],r.datastoreDcRef,r.selectedFiles,n,r.callback)}}}]).run(["fileCopyService",function(e){h5.actions["vsphere.core.datastore.actions.moveFile"]=function(t,i,r){if(i&&i.length&&r){var n="com.vmware.vsphere.client.storage.DatastoreFileMoveSpec";e.copyFiles(i[0],r.datastoreDcRef,r.selectedFiles,n,r.callback)}}}]).run(["fileUploadService",function(e){h5.actions["vsphere.core.datastore.actions.uploadToDatastore"]=function(t,i,r){i&&i.length&&r&&e.startFilesUpload(r.datastoreDcRef,r.datastoreId,r.path,r.files,r.isDatastoreSelected,r.isStreamFormat)}}]).run(["mutationService",function(e){h5.actions["vsphere.core.datastore.inflateDiskAction"]=function(t,i,r){i&&1===i.length&&r&&r.spec&&e.apply(i[0],"com.vmware.vsphere.client.storage.InflateDiskSpec",r.spec).then(function(e){r.callback&&r.callback(e)})}}]).run(["$window",function(e){h5.actions["vsphere.core.datastore.actions.popupDsBrowser"]=function(t,i,r){if(i&&1===i.length){var n=$.param({datastoreId:i[0]}),o=document.createElement("a");if(o.href="datastore-browser",o.hash="?"+n,h5.debug){var a=$.param({debug:!0});o.search=a}var s=o.href;e.open(s,"_blank","width=980,height=640,toolbar=0,location=0,menubar=0,resizable=1,noopener")}}}]).run(["$rootScope","mutationService","dataService","datastoreConstants","clarityModalService","selectVmToRegisterService","actionsService",function(e,t,i,r,n,o,a){h5.actions["vsphere.core.datastore.actions.browseFiles"]=function(t,i){i&&i.length&&e&&e._navigateToViewAndObject&&e._navigateToViewAndObject("vsphere.core.datastore.manage.filesView",i[0])},h5.actions["vsphere.core.datastore.actions.registerVm"]=function(e,t){if(t&&t.length){var i=t[0],r=function(t){var r=t.name,n=r.substring(r.lastIndexOf(".")+1),o={vmName:r.substring(0,r.lastIndexOf(".")),vmFilePath:t.path,isTemplate:"vmtx"===n},s=e.additionalData.registerVmActionId,c=[];c[i]={available:!0};var l={action:{uid:s},invoker:s,evaluationStatuses:c,available:!0};a.invokeAction(l,o)};o.browseFile(i,r)}},h5.actions["vsphere.core.datastore.actions.rename"]=function(e,t){if(t&&t.length){var o=t[0];i.getProperties(o,["summary.type","name"]).then(function(i){var a=i&&i["summary.type"]?i["summary.type"].toLowerCase():null,s=r.maxNameLengthForNonNfsDatastore;a!==r.nfsVersions.NFS_3&&a!==r.nfsVersions.NFS_4_1||(s=r.maxNameLengthForNfsDatastore),n.openModal(e,t,{objectId:o,maxNameLength:s,existingObjectName:i.name},"common-module-ui/resources/common-module/views/rename/renameObject.html")})}},h5.actions["vsphere.core.datastore.actions.refresh"]=function(e,i){i&&i.length&&t.applyOnMultiEntity(i,"com.vmware.vsphere.client.storage.DatastoreRefreshSpec",{_type:"com.vmware.vsphere.client.storage.DatastoreRefreshSpec"})},h5.actions["vsphere.core.datastore.actions.deleteVmfs"]=function(e,i){i&&i.length&&t.removeOnMultiEntity(i,"com.vmware.vsphere.client.storage.DatastoreRemovalSpec",{})}}]).run(["$rootScope","addDatastoreWizardService","increaseDatastoreCapacityWizardService",function(e,t,i){h5.actions["vsphere.core.datastore.actions.add"]=function(e,i){i&&i.length&&t.showWizard(i[0])},h5.actions["vsphere.core.datastore.actions.increaseCapacity"]=function(e,t){t&&t.length&&i.showWizard(t[0])}}]).run(["upgradeVmfsDatastoreModalService",function(e){h5.actions["vsphere.core.datastore.actions.upgradeVmfsDatastore"]=function(t,i){i&&i.length&&e.openDialog(i)}}]).run(["mutationService",function(e){h5.actions["vsphere.core.host.actions.refreshStorageSystem"]=function(t,i,r){i&&i.length&&e.apply(i[0],"com.vmware.vsphere.client.storage.StorageSystemRefreshSpec",{_type:"com.vmware.vsphere.client.storage.StorageSystemRefreshSpec"}).then(function(e){r&&r.callback&&r.callback(e)})}}]).run(["mutationService",function(e){h5.actions["vsphere.core.host.actions.rescanHba"]=function(t,i,r){i&&i.length&&e.apply(i[0],"com.vmware.vsphere.client.storage.adapters.StorageAdapterRescanSpec",{adapterKey:r.adapterKey}).then(function(e){r&&r.callback&&r.callback(e)})}}]).run(["addSoftwareAdapterDialogService",function(e){h5.actions["vsphere.core.host.actions.adapters.addSoftwareAdapter"]=function(t,i,r){i&&i.length&&e.show(i[0],r)}}]).run(["AddIscsiTargetDialogService",function(e){h5.actions["vsphere.core.host.actions.adapters.addIscsiTarget"]=function(t,i,r){i&&i.length&&e.openAddIscsiTargetDialog(r.adapter,i[0],r.dynamicTarget,r.targets,r)}}]).run(["editIscsiAdvancedOptionsService",function(e){h5.actions["vsphere.core.host.actions.adapters.editAdvancedOptionsForAdapter"]=function(t,i,r){i&&i.length&&e.showAdvancedOptionsDialogForAdapter(i[0],r.hba)},h5.actions["vsphere.core.host.actions.adapters.editAdvancedOptionsForTarget"]=function(t,i,r){i&&i.length&&e.showAdvancedOptionsDialogForTarget(i[0],r.hba,r.targetSet)}}]).run(["clarityModalService","i18nService","adapterTargetsService",function(e,t,i){h5.actions["vsphere.core.host.actions.adapters.removeIscsiTarget"]=function(r,n,o){if(n&&n.length&&o&&o.adapter){var a={title:t.getString("StorageUi","storage.adapters.iscsiTargets.actions.remove.header",o.adapter.device),message:t.getString("StorageUi","storage.adapters.iscsiTargets.actions.remove.message"),submit:function(){return i.removeIscsiAdapterTargets(n[0],o.dynamicTarget,o.adapter.device,o.targets).then(function(e){e&&e.effect&&e.effect.affectedEntites&&e.effect.affectedEntites.length&&o&&o.callback&&o.callback(e,o.adapter)}),!0}};e.openConfirmationModal(a)}}}]).run(["storageAdapterEditAuthenticationService","adapterStatusService","hostStorageConstants","swIscsiEditSettingsDialogService",function(e,t,i,r){h5.actions["vsphere.core.host.actions.adapters.editAuthSettingsIscsiTarget"]=function(t,i,r){i&&i.length&&r&&r.adapter&&r.target&&e.editAuthSettingsIscsiTarget(i[0],r.adapter,r.target,r.parentDynamicTargetAuthProperties,r.callback)},h5.actions["vsphere.core.host.actions.adapters.editIscsiAuthenticationSettings"]=function(t,i,r){i&&i.length&&r&&r.adapter&&e.openModal(i[0],r.adapter)},h5.actions["vsphere.core.host.actions.adapters.editIscsiGeneralSettings"]=function(e,t,i){t.length&&i&&i.adapter&&r.openModal(t[0],i.adapter)},h5.actions["vsphere.core.host.actions.adapters.disableSoftwareIscsiAdapter"]=function(e,r,n){if(r&&r.length&&n&&n.adapter){var o={hostId:r[0],isIscsiAdapter:n.adapter.type===i.hostAdapterTypes.ISCSI,deviceName:n.adapter.device,onSuccessCallback:n.callback};t.disable(o)}},h5.actions["vsphere.core.host.actions.adapters.enableSoftwareIscsiAdapter"]=function(e,r,n){if(r&&r.length&&n&&n.adapter){var o={hostId:r[0],isIscsiAdapter:n.adapter.type===i.hostAdapterTypes.ISCSI,deviceName:n.adapter.device};t.enable(o).then(function(e){n.callback(e)})}}}]).run(["defaultUriSchemeUtil","rescanStorageDialogService",function(e,t){h5.actions["vsphere.core.host.actions.rescan"]=function(i,r){var n=e.getManagedObjectReferences(r);n&&n.length&&t.open(n)}}]).run(["modifyDatastoreDialogService","mutationService","i18nService","defaultUriSchemeUtil","affectHeartbeatDatastoreService",function(e,t,i,r,n){
h5.actions["vsphere.core.datastore.actions.mountVmfs"]=function(n,o){o&&o.length&&e.openModifyDatastoreDialog(o[0],i.getString("StorageUi","vmfsDatastore.mountDialogTitle"),"datastoreOperations:availableHostsForMountVmfs",function(e){var n=_.map(e,function(e){return r.getVsphereObjectId(e.hostRef)});return t.applyOnMultiEntity(n,"com.vmware.vsphere.client.storage.VmfsDatastoreHostsMountSpec",{datastoreToMount:r.getManagedObjectReference(o[0])},i.getString("StorageUi","modifyDatastoreForm.mountDatastore")),!0})},h5.actions["vsphere.core.datastore.actions.mountNfs"]=function(r,n){n&&n.length&&e.openModifyDatastoreDialog(n[0],i.getString("StorageUi","nfsDatastore.mountDialogTitle"),"datastoreOperations:availableHostsForMountNfs",function(e){var r=_.map(e,function(e){return e.hostRef});return t.applyOnMultiEntity([n[0]],"com.vmware.vsphere.client.h5.storage.spec.MountNfsDatastoreSpec",{hostsToMount:r},i.getString("StorageUi","modifyDatastoreForm.mountNfsDatastore")),!0})},h5.actions["vsphere.core.datastore.actions.unmountVmfs"]=function(o,a){a&&a.length&&e.openModifyDatastoreDialog(a[0],i.getString("StorageUi","vmfsDatastore.unmountDialogTitle"),"datastoreOperations:availableHostsForUnmount",function(e){var o=_.map(e,function(e){return r.getVsphereObjectId(e.hostRef)}),s=_.map(e,function(e){return e.hostRef});return n.checkForAffectedClusters(a[0],s).then(function(e){return!!e&&(t.applyOnMultiEntity(o,"com.vmware.vsphere.client.storage.VmfsDatastoreUnmountSpec",{datastoreToUnmount:r.getManagedObjectReference(a[0])},i.getString("StorageUi","modifyDatastoreForm.unmountDatastore")),!0)})},"storage-ui/resources/storage/views/datastore/UnmountVmfsDatastoreDialogHeader.html")},h5.actions["vsphere.core.datastore.actions.unmountNfs"]=function(o,a){a&&a.length&&(a.length>1?e.openRemoveDatastoreDialog(a,i.getString("StorageUi","actionUnmountDatastoreCaption"),i.getString("StorageUi","actionUnmountDatastoreWarning"),function(){return t.removeOnMultiEntity(a,"com.vmware.vsphere.client.storage.DatastoreRemovalSpec",{selectedContextObject:r.getManagedObjectReference(a[0])},i.getString("StorageUi","modifyDatastoreForm.removeDatastore")),!0}):e.openModifyDatastoreDialog(a[0],i.getString("StorageUi","vmfsDatastore.unmountDialogTitle"),"datastoreOperations:availableHostsForUnmountNfs",function(e,o){var s=_.map(e,function(e){return r.getVsphereObjectId(e.hostRef)}),c=_.map(e,function(e){return e.hostRef});return n.checkForAffectedClusters(a[0],c).then(function(e){if(e){var n=[s,"com.vmware.vsphere.client.storage.NfsDatastoreRemovalSpec",{datastoreToRemove:r.getManagedObjectReference(a[0])},i.getString("StorageUi","modifyDatastoreForm.unmountNfsDatastore")];return o?t.removeOnMultiEntity.apply(t,n):t.applyOnMultiEntity.apply(t,n),!0}return!1})},"storage-ui/resources/storage/views/datastore/UnmountVmfsDatastoreDialogHeader.html"))},h5.actions["vsphere.core.datastore.actions.unmountVvol"]=function(n,o){o&&o.length&&e.openModifyDatastoreDialog(o[0],i.getString("StorageUi","vmfsDatastore.unmountDialogTitle"),"datastoreOperations:availableHostsForUnmount",function(e){var n=_.map(e,function(e){return r.getVsphereObjectId(e.hostRef)});return t.removeOnMultiEntity(n,"com.vmware.vsphere.client.storage.vvol.RemoveVvolDatastoreSpec",{datastore:r.getManagedObjectReference(o[0])},i.getString("StorageUi","modifyDatastoreForm.unmountVvolDatastore")),!0},"storage-ui/resources/storage/views/datastore/UnmountVmfsDatastoreDialogHeader.html")},h5.actions["vsphere.core.datastore.actions.mountVvol"]=function(r,n){n&&n.length&&e.openModifyDatastoreDialog(n[0],i.getString("StorageUi","actionMountVvolDatastore"),"datastoreOperations:availableHostsForMountVvol",function(e){var r=_.map(e,function(e){return e.hostRef});return t.apply(n[0],"com.vmware.vsphere.client.h5.storage.spec.MountVvolDatastoreSpec",{hostsToMount:r},i.getString("StorageUi","modifyDatastoreForm.mountDatastore")),!0})}}]).run(["mutationService","i18nService",function(e,t){h5.actions["vsphere.core.host.actions.paths.enablePath"]=function(i,r,n){r&&r.length&&n&&e.apply(r[0],"com.vmware.vsphere.client.storage.adapters.StoragePathEnableSpec",{pathName:n.pathName,enable:!0},t.getString("StorageUi","storage.paths.actions.enableTask"))},h5.actions["vsphere.core.host.actions.paths.disablePath"]=function(i,r,n){r&&r.length&&n&&e.apply(r[0],"com.vmware.vsphere.client.storage.adapters.StoragePathEnableSpec",{pathName:n.pathName,enable:!1},t.getString("StorageUi","storage.paths.actions.disableTask"))}}]).run(["storageDeviceMultipathingPolicyDialogService",function(e){h5.actions["vsphere.core.host.actions.storageDevice.editMultipathingPolicy"]=function(t,i,r){i&&i.length&&r&&e.show(i[0],r.deviceId,r.name)}}]).run(["mutationService","i18nService","clarityModalService",function(e,t,i){h5.actions["vsphere.core.host.actions.storageDevice.unmount"]=function(r,n,o){if(n&&n.length&&o){var a={message:t.getString("StorageUi","storage.adapters.devices.action.unmount.text",o.name),title:t.getString("StorageUi","storage.adapters.devices.action.unmount.title"),saveButtonLabel:t.getString("Common","yes.label"),cancelButtonLabel:t.getString("Common","no.label"),preserveNewlines:!0,defaultButton:"submit",showXIcon:!1,clarityIcon:{"class":"is-warning",shape:"warning",size:48},subTitle:{objectId:n[0]},submit:function(){var i={_type:"com.vmware.vsphere.client.storage.adapters.StorageDeviceMountSpec",lunUuid:o.lunUuid,mount:!1};e.apply(n[0],i._type,i,t.getString("StorageUi","storage.adapters.devices.action.unmount.taskName"))}};i.openConfirmationModal(a)}},h5.actions["vsphere.core.host.actions.storageDevice.mount"]=function(i,r,n){if(r&&r.length&&n){var o={_type:"com.vmware.vsphere.client.storage.adapters.StorageDeviceMountSpec",lunUuid:n.lunUuid,mount:!0};e.apply(r[0],o._type,o,t.getString("StorageUi","storage.adapters.devices.action.mount.taskName"))}}}]).run(["datastoreConfigIOControlDialogService",function(e){h5.actions["vsphere.core.datastore.actions.configSIOC"]=function(t,i){i&&i.length&&e.show(i)}}]).run(["datastoreSpaceReclamationPriorityDialogService",function(e){h5.actions["vsphere.core.datastore.actions.spaceReclamationPriorityAction"]=function(t,i){i&&i.length&&e.show(i)}}]).run(["renameStorageDeviceDialogService",function(e){h5.actions["vsphere.core.host.actions.storageDevice.rename"]=function(t,i,r){i&&i.length&&r&&e.show(i[0],r.lunUuid,r.name)}}]).run(["mutationService","i18nService",function(e,t){function i(i,r,n){return e.apply(i,"com.vmware.vsphere.client.storage.TagDiskAsSsdSpec",{isSSD:n,diskUUID:r},t.getString("StorageUi",n?"storage.adapters.devices.action.tagAsSsd.taskName":"storage.adapters.devices.action.untagAsSsd.taskName")),!0}h5.actions["vsphere.core.storage.devices.tagAsSSD"]=function(e,t,r){return!(t&&t.length&&r.length)||i(t[0],_.map(r,function(e){return e.lunUuid}),!0)},h5.actions["vsphere.core.storage.devices.tagAsHDD"]=function(e,t,r){return!(t&&t.length&&r.length)||i(t[0],_.pluck(r,"lunUuid"),!1)}}]).run(["mutationService","defaultUriSchemeUtil","i18nService",function(e,t,i){h5.actions["vsphere.core.datastore.actions.mountVmfsSingleHost"]=function(r,n,o){if(n&&n.length&&o){var a={_type:"com.vmware.vsphere.client.storage.VmfsDatastoreHostsMountSpec",datastoreToMount:t.getManagedObjectReference(o.datastoreId)};e.apply(n[0],a._type,a,i.getString("StorageUi","modifyDatastoreForm.mountDatastore"))}},h5.actions["vsphere.core.datastore.actions.unmountVmfsSingleHost"]=function(r,n,o){if(n&&n.length&&o){var a={_type:"com.vmware.vsphere.client.storage.VmfsDatastoreUnmountSpec",datastoreToUnmount:t.getManagedObjectReference(o.datastoreId)};e.apply(n[0],a._type,a,i.getString("StorageUi","modifyDatastoreForm.unmountDatastore"))}}}]).run(["storageProvidersService","storageProviderConstants",function(e,t){h5.actions[t.actions.RESYNC_INTERNAL_PROVIDER]=function(t,i){i&&1===i.length&&e.resyncInternalVasaProviders(i[0])},h5.actions[t.actions.REMOVE]=function(t,i,r){i&&1===i.length&&e.removeStorageProvider(i[0],r)},h5.actions[t.actions.SYNC]=function(t,i,r){i&&1===i.length&&e.syncProvider(i[0],r)},h5.actions[t.actions.REFRESH_CERTIFICATE]=function(t,i,r){i&&1===i.length&&e.refreshCertificate(i[0],r)}}]).run(["addStorageProviderDialogService",function(e){h5.actions["vsphere.core.storage.storageProviders.addNew"]=function(t,i,r){i&&1===i.length&&e.showAddStorageProviderDialog(i[0],r.providerNames)}}]).run(["allocateSpaceDialogService",function(e){h5.actions["vsphere.core.host.actions.vFlash.editCacheConfiguration"]=function(t,i,r){i&&1===i.length&&r&&r.selectedDatastore&&e.openSpaceAllocationDialog(r.selectedDatastore,i[0])}}]).run(["clarityModalService","i18nService","moveDatastoreToService",function(e,t,i){h5.actions["vsphere.core.datastore.actions.moveTo"]=function(i,r){if(r&&r.length){var n={title:t.getString("StorageUi","datastoreMoveToTitle"),defaultButton:"submit",dialogData:{objectIds:r},contentTemplate:"storage-ui/resources/storage/views/datastore/moveDatastoreToDialog.html"};e.openOkCancelModal(n)}},h5.actions["vsphere.core.datastore.actions.moveDatastoreToDrag"]=function(e,t,r){t&&t.length&&r&&i.moveDatastoreTo(r.dropTarget,t)}}]).run(["mutationService","i18nService",function(e,t){function i(i,r,n){e.apply(i,"com.vmware.vsphere.client.storage.LightDiskLedSpec",{turnOn:n,diskUUID:r},t.getString("StorageUi",n?"storage.adapters.devices.action.turnLedOn.taskName":"storage.adapters.devices.action.turnLedOff.taskName"))}h5.actions["vsphere.core.host.actions.storageDevice.turnLedOn"]=function(e,t,r){t&&t.length&&r.length&&i(t[0],_.map(r,function(e){return e.lunUuid}),!0)},h5.actions["vsphere.core.host.actions.storageDevice.turnLedOff"]=function(e,t,r){t&&t.length&&r.length&&i(t[0],_.map(r,function(e){return e.lunUuid}),!1)}}]).run(["erasePartitionsDialogService",function(e){h5.actions["vsphere.core.host.actions.storageDevice.erasePartitions"]=function(t,i,r){i&&i.length&&r&&r.selectedDevices&&e.open(i[0],r.selectedDevices)}}]).run(["hostStorageService",function(e){function t(t,i,r){t&&t.length&&i&&i.selectedDevices&&e.changeDiskLocalState(t[0],i.selectedDevices,r)}h5.actions["vsphere.core.host.actions.storageDevice.tagAsLocal"]=function(e,i,r){t(i,r,!0)},h5.actions["vsphere.core.host.actions.storageDevice.untagAsLocal"]=function(e,i,r){t(i,r,!1)}}]),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(c){function l(){if(E.showPathActions){var e=[];E.showRefreshStorageSystemAction&&(e.push({actionId:"vsphere.core.host.actions.refreshStorageSystem"}),e.push(i.actions.SEPARATOR)),e.push({actionId:"vsphere.core.host.actions.paths.enablePath",getActionInvocationContext:function(){return{pathName:E.selectedPath.name}},isActionAvailable:function(e){return E.selectedPath&&e.available&&E.selectedPath.pathState===n.adapterPathState.DISABLED}}),e.push({actionId:"vsphere.core.host.actions.paths.disablePath",getActionInvocationContext:function(){return{pathName:E.selectedPath.name}},isActionAvailable:function(e){return E.selectedPath&&e.available&&(E.selectedPath.pathState===n.adapterPathState.ACTIVE||E.selectedPath.pathState===n.adapterPathState.STANDBY)}}),o.updateActionBar(E.datagridOptions,[E.hostId],e)}}function d(e){return e===m?(f.visible=!0,[S,D,y,f,I]):e===g?(f.visible=!1,[S,D,w,y,P,C,f,I]):e===h?(b.visible=!0,[S,D,b,y,f,I]):[S,y,P,D,b,C]}function u(t,i){var r,o="storage-ui-icon-path-";if(!t)return{icon:o+n.adapterPathState.STANDBY,text:e.getString("StorageUi","storage.adapters.paths.state.unknown")};switch(t){case n.adapterPathState.ACTIVE:r=e.getString("StorageUi","storage.adapters.paths.state.active");break;case n.adapterPathState.STANDBY:r=e.getString("StorageUi","storage.adapters.paths.state.standby");break;case n.adapterPathState.DISABLED:r=e.getString("StorageUi","storage.adapters.paths.state.disabled");break;case n.adapterPathState.DEAD:r=e.getString("StorageUi","storage.adapters.paths.state.dead");break;default:r=e.getString("StorageUi","storage.adapters.paths.state.unknown")}return i&&(r=e.getString("StorageUi","storage.adapters.paths.state.workingPath",r)),{icon:o+t,text:r}}function p(e){return e.lunNumber===-1||"-1"===e.lunNumber?"":e.lunNumber}var v="STORAGE_ADAPTERS_PATHS",m="STORAGE_DEVICE_PATHS",g="VMFS_EXTENT_PATHS",h="PROTOCOL_ENDPOINT_PATHS";c.showPathActions=c.showPathActions||!1,c.showRefreshStorageSystemAction=c.showRefreshStorageSystemAction||!1,c.columnSet=c.columnSet||v;var f={displayName:e.getString("StorageUi","storage.paths.list.name"),field:"name",width:"150px",template:function(e){return e.name}},S={displayName:e.getString("StorageUi","storage.adapters.paths.runtimeName"),field:"runtimeName",width:"100px",template:function(e){return e.runtimeName}},y={displayName:e.getString("StorageUi","storage.adapters.paths.target"),field:"formattedTarget",width:"180px",template:function(e){return e.formattedTarget}},P={displayName:e.getString("StorageUi","storage.adapters.paths.lun"),field:"lunNumber",width:"80px",sortable:function(e,t){return a.compareNumericValues(e,t,"lunNumber")},template:p},C={displayName:e.getString("StorageUi","storage.adapters.paths.lunId"),field:"lunId",width:"150px",visible:!1,template:function(e){return e.lunId}},D={displayName:e.getString("StorageUi","storage.adapters.paths.status"),field:"status",width:"100px",template:function(e){var t=u(e.pathState,e.isWorkingPath);return T(["icon","text"],t)},sortable:function(e,t){return u(e.pathState,e.isWorkingPath).text.localeCompare(u(t.pathState,t.isWorkingPath).text)}},w={displayName:e.getString("StorageUi","storage.paths.list.adapter"),field:"adapter",width:"100px",visible:!1,template:function(e){return e.adapter}},b={displayName:e.getString("StorageUi","storage.adapters.paths.device"),field:"device",width:"180px",visible:!1,template:function(e){return e.device}},I={displayName:e.getString("StorageUi","storage.paths.list.preferred"),field:"preferred",width:"150px",template:function(e){return e.preferred}},T=t.getColumnRenderer("icon-text"),E=c,V=r.getColumnChangeHandler(c.viewId,c);r.applyPersistedState(d(c.columnSet),c.viewId).then(function(t){E.datagridOptions={height:"100%",columnDefs:t,sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!0,vuiFooter:{actions:[{disabled:!1,label:e.getString("StorageUi","action.copyAll"),tooltip:e.getString("StorageUi","action.copyAll"),icon:"vui-icon-action-copy",action:function(){s.copyAllItems("#adapterPathsGrid [kendo-grid]")}}]},columnMenu:{sortable:!1,messages:{columns:e.getString("CommonUi","listview.showColumnsMenu"),filter:e.getString("CommonUi","listview.filterMenu")}},columnHide:V,columnReorder:V,columnResize:V,columnShow:V,actionBarOptions:{actions:[]}},E.$watch(function(){return E.paths},function(e,t){e!==t&&(E.datagridOptions.data=e)}),E.$watch(function(){return E.datagridOptions.selectedItems},function(e,t){e===t||_.isEqual(e,t)||(e&&e.length?E.selectedPath=e[0]:E.selectedPath=null,l())}),E.datagridOptions.data=E.paths,l()}),c.preselectComparator=function(e){return!(!c.selectedPath||!e)&&c.selectedPath.runtimeName===e.runtimeName}}var l={replace:!0,scope:{paths:"=",selectedPath:"=?",columnSet:"=?",viewId:"=",hostId:"=?",showPathActions:"=?",showRefreshStorageSystemAction:"=?"},templateUrl:"storage-ui/resources/storage/directives/adapterPathsList/adapterPathsList.html",link:c};return l}angular.module("com.vmware.vsphere.client.storage").directive("adapterPathsList",e),e.$inject=["i18nService","columnRenderersRegistry","vuiConstants","listViewColumnService","hostStorageConstants","datagridActionBarService","listUtil","kendoGridService"]}(),function(){"use strict";function e(e,t,i){function r(r){function n(){if(s.targetItemsMap={},s.targets)for(var e=0;e<s.targets.length;e++)s.targetItemsMap[e]=s.targets[e],s.targets[e].targetIndex=e;s.datagridOptions.data=s.targets}function o(){return[{actionId:"vsphere.core.host.actions.adapters.addIscsiTarget",getActionInvocationContext:function(){return{adapter:s.adapter,dynamicTarget:s.showDynamicTargets,targets:s.targets,callback:r.onTargetAdded}}},{actionId:"vsphere.core.host.actions.adapters.removeIscsiTarget",isActionAvailable:function(e){return e.available&&0!==s.datagridOptions.selectedItems.length},getActionInvocationContext:function(){if(s.datagridOptions.selectedItems&&s.datagridOptions.selectedItems.length){var e=s.datagridOptions.selectedItems.map(function(e){return s.targetItemsMap[e.targetIndex].target});return{adapter:s.adapter,dynamicTarget:s.showDynamicTargets,targets:e,callback:r.onTargetRemoved}}}},{actionId:"vsphere.core.host.actions.adapters.editAuthSettingsIscsiTarget",isActionAvailable:function(e){return e.available&&1===s.datagridOptions.selectedItems.length},getActionInvocationContext:function(){if(s.datagridOptions.selectedItems&&s.datagridOptions.selectedItems.length){var e=s.targetItemsMap[s.datagridOptions.selectedItems[0].targetIndex];return{adapter:s.adapter,target:e.target,parentDynamicTargetAuthProperties:e.parentDynamicTargetAuthProperties,callback:r.onTargetEdited}}}},{actionId:"vsphere.core.host.actions.adapters.editAdvancedOptionsForTarget",isActionAvailable:function(e){return e.available&&1===s.datagridOptions.selectedItems.length},getActionInvocationContext:function(){if(s.datagridOptions.selectedItems&&s.datagridOptions.selectedItems.length){var e=s.targetItemsMap[s.datagridOptions.selectedItems[0].targetIndex],t={_type:"com.vmware.vim.binding.vim.host.InternetScsiHba$TargetSet"};return c?t.sendTargets=[e.target]:t.staticTargets=[e.target],{hba:s.hba,targetSet:t}}}}]}function a(e){return e?[l]:[l,d]}var s=r,c=!!r.showDynamicTargets,l={displayName:e.getString("StorageUi","storage.adapters.iscsiTargets.staticTarget.serverColumnLabel"),field:"address",width:"100px",template:function(e){return e.address}},d={displayName:e.getString("StorageUi","storage.adapters.iscsiTargets.staticTarget.targetNameLabel"),field:"name",width:"150px",template:function(e){return e.name}};s.datagridOptions={height:"100%",columnDefs:a(c),sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,data:[],selectedItems:[],resizable:!0,columnMenu:{sortable:!1,messages:{columns:e.getString("CommonUi","listview.showColumnsMenu"),filter:e.getString("CommonUi","listview.filterMenu")}},actionBarOptions:{actions:[]}},s.$watch(function(){return s.targets},function(e,t){e!==t&&n()}),s.$watch(function(){return s.datagridOptions.selectedItems},function(e,t){e===t||_.isEqual(e,t)||(s.selectedTargets=e,i.updateActionBar(s.datagridOptions,[s.hostId],o()))}),s.comparator=function(e){var t=_.find(s.selectedTargets,function(t){return t.address===e.address});return void 0!==t},n(),i.updateActionBar(s.datagridOptions,[s.hostId],o())}var n={replace:!0,scope:{targets:"=",selectedTargets:"=?",showDynamicTargets:"=?",loading:"=?",hostId:"=",adapter:"=",hba:"=",onTargetAdded:"=onTargetAdded",onTargetRemoved:"=onTargetRemoved",onTargetEdited:"=onTargetEdited"},templateUrl:"storage-ui/resources/storage/directives/adapterTargetsList/adapterTargetsList.html",link:r};return n}angular.module("com.vmware.vsphere.client.storage").directive("adapterTargetsList",e),e.$inject=["i18nService","vuiConstants","datagridActionBarService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(l){function d(r){var n=[];return n=n.concat([{displayName:e.getString("StorageUi","storage.adapters.devices.name"),field:"name",width:"300px",template:function(e){return p(["name","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.identifier"),field:"identifier",width:"270px",visible:!1,template:function(e){return p(["identifier","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.lun"),field:"localizedLunNumber",width:"60px",sortable:function(e,i){return t.compareNumericValues(e,i,"lunNumber")},template:function(e){return p(["localizedLunNumber","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.type"),field:"type",width:"75px",template:function(e){return p(["type","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.capacity"),field:"localizedCapacity",width:"90px",sortable:function(e,i){return t.compareNumericValues(e,i,"capacity")},template:function(e){var t="right-align-cell vertical-align-cell";return e.disabled===!0&&(t+=" disabled-text"),'<span class="'+t+'">'+e.localizedCapacity+"</span>"}},{displayName:e.getString("StorageUi","storage.adapters.devices.datastore"),field:"datastoreName",width:"90px",template:function(t){if(t.datastoreItem){var r=JSON.parse(JSON.stringify(t.datastoreItem)),n=i.getColumnRenderer("object-link"),o={dsId:s.getVsphereObjectId(r.ref),dsName:r.name};return n(["dsId","dsName","vsphere-icon-datastore"],o)}return e.getString("StorageUi","storage.adapters.devices.datastore.empty")}},{displayName:e.getString("StorageUi","storage.adapters.devices.opState"),field:"localizedState",width:"120px",template:function(e){return p(["localizedState","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.hardwareAcc"),field:"hardwareAcceleration",width:"150px",template:function(e){return p(["hardwareAcceleration","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.driveType"),field:"localizedDriveType",width:"90px",template:function(e){return p(["localizedDriveType","disabled"],e)}}]),r&&(n=n.concat([{displayName:e.getString("StorageUi","storage.devices.adapterColumn.header"),field:"adapter",width:"120px",visible:!1,template:function(e){return p(["adapter","disabled"],e)}}])),n=n.concat([{displayName:e.getString("StorageUi","storage.adapters.devices.transport"),field:"transport",width:"120px",template:function(e){return p(["transport","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.owner"),field:"ownerPlugin",width:"90px",visible:!1,template:function(e){return p(["ownerPlugin","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.physicalLocation"),field:"physicalLocation",width:"150px",visible:!1,template:function(e){return p(["physicalLocation","disabled"],e)}},{displayName:e.getString("StorageUi","storage.adapters.devices.sectorFormat"),field:"sectorFormat",width:"150px",visible:!1,template:function(e){return p(["sectorFormat","disabled"],e)}}])}var u=!!l.showAdapterColumn,p=i.getColumnRenderer("disabled-text"),v=l,m=n.getColumnChangeHandler(l.viewId,l);n.applyPersistedState(d(u),l.viewId).then(function(t){function i(e){return 1===l.datagridOptions.selectedItems.length&&l.datagridOptions.selectedItems[0].operationalState===e}function n(){l.hasActionBar&&o.updateActionBar(l.datagridOptions,l.hostId,[{actionId:"vsphere.core.host.actions.refreshStorageSystem"},r.actions.SEPARATOR,{actionId:"vsphere.core.host.actions.storageDevice.mount",isActionAvailable:function(e){return e.available&&i(a.operationalState.OFF)},getActionInvocationContext:function(){return l.datagridOptions.selectedItems[0]}},{actionId:"vsphere.core.host.actions.storageDevice.unmount",isActionAvailable:function(e){return e.available&&i(a.operationalState.OK)},getActionInvocationContext:function(){return l.datagridOptions.selectedItems[0]}},{actionId:"vsphere.core.host.actions.storageDevice.rename",isActionAvailable:function(e){return e.available&&1===l.datagridOptions.selectedItems.length&&l.datagridOptions.selectedItems[0].isRenameSupported===!0},getActionInvocationContext:function(){return l.datagridOptions.selectedItems[0]}},{actionId:"vsphere.core.host.actions.storageDevice.turnLedOn",isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length&&_.every(l.datagridOptions.selectedItems,function(e){return e.type===a.deviceType.DISK})},getActionInvocationContext:function(){return l.datagridOptions.selectedItems}},{actionId:"vsphere.core.host.actions.storageDevice.turnLedOff",isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length&&_.every(l.datagridOptions.selectedItems,function(e){return e.type===a.deviceType.DISK})},getActionInvocationContext:function(){return l.datagridOptions.selectedItems}},{actionId:"vsphere.core.host.actions.storageDevice.erasePartitions",getActionInvocationContext:function(){return{selectedDevices:l.datagridOptions.selectedItems}},isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length&&_.every(l.datagridOptions.selectedItems,function(e){return e.isScsiDisk})}},{actionId:"vsphere.core.storage.devices.tagAsSSD",isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length>0&&_.every(l.datagridOptions.selectedItems,function(e){return e.isScsiDisk&&!e.isFlash})},getActionInvocationContext:function(){return l.datagridOptions.selectedItems}},{actionId:"vsphere.core.storage.devices.tagAsHDD",isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length>0&&_.every(l.datagridOptions.selectedItems,function(e){return e.isFlash})},getActionInvocationContext:function(){return l.datagridOptions.selectedItems}},{actionId:"vsphere.core.host.actions.storageDevice.tagAsLocal",isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length>0&&_.every(l.datagridOptions.selectedItems,function(e){return e.isScsiDisk&&!e.isLocal})},getActionInvocationContext:function(){return{selectedDevices:l.datagridOptions.selectedItems}}},{actionId:"vsphere.core.host.actions.storageDevice.tagAsRemote",isActionVisible:function(e){return e.available&&l.datagridOptions.selectedItems.length>0&&_.every(l.datagridOptions.selectedItems,function(e){return e.isScsiDisk&&e.isLocal})},getActionInvocationContext:function(){return{selectedDevices:l.datagridOptions.selectedItems}}}])}function s(e){return _.forEach(e,function(e){e.datastoreName=e.datastoreItem?e.datastoreItem.name:""}),e}v.datagridOptions={height:"100%",columnDefs:t,sortMode:r.grid.sortMode.SINGLE,selectionMode:r.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,data:[],selectedItems:[],resizable:!0,vuiFooter:{actions:[{disabled:!1,label:e.getString("StorageUi","action.copyAll"),tooltip:e.getString("StorageUi","action.copyAll"),icon:"vui-icon-action-copy",action:function(){c.copyAllItems("#configStorageDevicesGrid [kendo-grid]")}}]},columnMenu:{sortable:!1,messages:{columns:e.getString("CommonUi","listview.showColumnsMenu"),filter:e.getString("CommonUi","listview.filterMenu")}},columnHide:m,columnReorder:m,columnResize:m,columnShow:m,actionBarOptions:{actions:[]}},n(),v.$watch(function(){return v.devices},function(e,t){e!==t&&(v.datagridOptions.data=s(e))}),v.datagridOptions.data=s(v.devices),v.$watch(function(){return v.datagridOptions.selectedItems},function(e,t){e===t||_.isEqual(e,t)||(n(),e&&e.length?l.selectedDevices=e:l.selectedDevices=null)})}),l.preselectComparator=function(e){return!!(l.selectedDevices&&l.selectedDevices.length&&e)&&_.find(l.selectedDevices,function(t){return t.identifier===e.identifier})}}var d={replace:!0,scope:{devices:"=",hasActionBar:"=?",hostId:"=?",selectedDevices:"=?",showAdapterColumn:"=?",viewId:"="},templateUrl:"storage-ui/resources/storage/directives/configDeviceList/configDeviceList.html",link:l};return d}angular.module("com.vmware.vsphere.client.storage").directive("configDeviceList",e),e.$inject=["i18nService","storageUtil","columnRenderersRegistry","vuiConstants","listViewColumnService","datagridActionBarService","hostStorageConstants","defaultUriSchemeUtil","kendoGridService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(r,n,a){function c(e){d&&m!==e&&(m=e,r.selectedDeviceChanged({selectedDevice:e?e.scsiDiskInfo:null}))}function l(){var r=[{displayName:e.getString("StorageUi","deviceList.columns.name"),field:"name",width:"180px",template:"#:name#"},{displayName:e.getString("StorageUi","storage.adapters.devices.identifier"),field:"identifier",visible:!1,width:"100px",template:"#:identifier#"},{displayName:e.getString("StorageUi","deviceList.columns.lun"),field:"localizedLunNumber",width:"70px",sortable:function(e,i){return t.compareNumericValues(e,i,"lun")},template:"#:localizedLunNumber#"},{displayName:e.getString("StorageUi","deviceList.columns.capacity"),field:"localizedCapacity",width:"100px",sortable:function(e,i){return t.compareNumericValues(e,i,"capacity")},template:function(e){return i.getColumnRenderer("number")(["localizedCapacity"],e)}},{displayName:e.getString("StorageUi","deviceList.columns.vStorage"),field:"vStrorage",width:"100px",template:"#:vStrorage#"},{displayName:e.getString("StorageUi","deviceList.columns.driveType"),field:"driveType",width:"90px",template:"#:driveType#"},{displayName:e.getString("StorageUi","storage.adapters.devices.sectorFormat"),field:"sectorFormat",width:"150px",template:"#:sectorFormat#"}];return u&&r.push({displayName:e.getString("StorageUi","deviceList.columns.snapshot"),field:"snapshot",width:"80px",template:"#:snapshot#"}),p&&r.push({displayName:e.getString("StorageUi","deviceList.columns.expandable"),field:"expandable",width:"80px",template:"#:expandable#"}),r}var d=!!a.onSelectedDeviceChanged,u=!!a.showSnapshotColumn,p=!!a.showExpandableColumn,v=!a.showPager;r.$watch(function(){return r.devices},function(e,t){e!==t&&s(r)}),r.datagridOptions={height:"100%",pageConfig:{hidePager:v},columnDefs:l(),sortMode:o.grid.sortMode.SINGLE,selectionMode:o.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,columnMenu:{sortable:!1,messages:{columns:e.getString("CommonUi","listview.showColumnsMenu"),filter:e.getString("CommonUi","listview.filterMenu")}}},s(r),r.$watch(function(){return r.datagridOptions.selectedItems},function(e){c(e&&e.length?e[0]:null)}),r.preselectComparator=function(e){return!(!r.selectedDevice||!e)&&r.selectedDevice.disk.devicePath===e.scsiDiskInfo.disk.devicePath};var m=null}function s(e){var i=[];e.devices&&(i=_.map(e.devices,function(e){var i=t.lbaToBytes(e.disk.capacity);return{name:t.formatDeviceName(e.disk),identifier:e.disk.canonicalName,lun:e.lun,localizedLunNumber:t.formatLunNumber(e.lun),capacity:i,localizedCapacity:r(i,"B","Auto",2),vStrorage:t.formatVStorageSupport(e.disk.vStorageSupport),driveType:t.formatSSDValue(e.disk.ssd),snapshot:t.formatVmfsLabel(e),expandable:n(e.expandable),scsiDiskInfo:e,sectorFormat:t.getSectorFormatByScsiDiskType(e.disk.scsiDiskType)}})),e.datagridOptions&&(e.datagridOptions.data=i)}var c={replace:!0,scope:{devices:"=",showPager:"=?",selectedDevice:"=?",selectedDeviceChanged:"&onSelectedDeviceChanged",showSnapshotColumn:"=?",showExpandableColumn:"=?"},templateUrl:"storage-ui/resources/storage/directives/deviceList/deviceList.html",link:a};return c}angular.module("com.vmware.vsphere.client.storage").directive("deviceList",e),e.$inject=["i18nService","storageUtil","columnRenderersRegistry","bytesFilter","booleanFilter","vuiConstants"]}(),function(){"use strict";function e(e,t){function i(i,r){function o(t){if(t&&!t.isSelectConfigurationOption){var r=t.maxDatastoreSize/e.BYTES_TO_GB;i.maxSize=Math.round(100*r)/100}else i.maxSize=void 0}function s(e){e&&e.sizeToAdd?i.size=e.sizeToAdd:i.size=i.maxSize,a.isSame(i.size)&&c(i.size)}function c(e){(e>i.maxSize||void 0===e)&&(i.size=i.maxSize),i.sliderSize=Math.round(i.size),i.selectedOption.sizeToAdd=i.size,n&&i.onSelectedOptionChanged({selectedOption:i.selectedOption})}function l(){var e=i.options.slice();e.splice(0,0,{optionTitle:t.getString("StorageUi","vmfsDatastore.options.selectConfiguration"),isSelectConfigurationOption:!0}),i.options=e}function d(){if(i.selectedOption)i.size=i.selectedOption.sizeToAdd;else{var e=0;2===i.options.length&&(e=1),i.selectedOption=i.options[e]}}n=!!i.onSelectedOptionChanged,i.values={},l(),d(),i.$watch("selectedOption",function(e){o(e),s(e)}),i.onSliderSizeChanged=function(e){i.size=e},i.$watch("size",c)}function r(){var e;return{isSame:function(t){var i=t&&e===t;return e=t,i}}}var n,o={replace:!0,scope:{labels:"<",selectedOption:"=",onSelectedOptionChanged:"&",options:"=",diskPartitionInfo:"=",dsInfo:"<?",blockSizeOptions:"<?",configurationError:"=",manager:"<?"},templateUrl:"storage-ui/resources/storage/directives/partitionConfig/datastorePartitionConfig.html",
link:i},a=new r;return o}angular.module("com.vmware.vsphere.client.storage").directive("datastorePartitionConfig",e),e.$inject=["datastoreConstants","i18nService"]}();var storage_ui;!function(e){var t=function(){function e(e){this.$scope=e,this.chartApi={}}return e.prototype.$onInit=function(){var e=this;this.datastoreInfo&&_.forEach(this.diskPartitionInfo.layout.partition,function(t){_.find(e.datastoreInfo.vmfs.extent,function(e){return e.partition===t.partition})&&(t.datastoreInfo=e.datastoreInfo)}),this.$scope.$watch(function(){return e.chartPartitions},function(t){e.partitions=_.uniq(t,function(e){return e.name+e.color})})},e.prototype.resizeChart=function(){this.chartApi.reflow()},e.$inject=["$scope"],e}();angular.module("com.vmware.vsphere.client.storage").component("datastorePartitionLayout",{templateUrl:"storage-ui/resources/storage/directives/partitionConfig/layout/datastorePartitionLayoutComponent.html",bindings:{datastoreInfo:"<?",diskPartitionInfo:"<",selectedOption:"<",size:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){angular.module("com.vmware.vsphere.client.storage").constant("layoutAreaChartConstants",function(){var e=100,t={color:"#333",cursor:"default",fontSize:"12px",fontFamily:'"ProximaNova","Avenir Next","Helvetica Neue",Arial,sans-serif,"Avenir Next","Helvetica Neue",Arial,sans-serif',pointerEvents:"none",whiteSpace:"nowrap"};return{FREE_PARTITION_COLOR:"rgb(218, 218, 218)",SAME_DATASTORE_PARTITION_COLOR:"rgb(57, 105, 145)",BAR_HEIGHT:e,HIGHCHARTS_CONFIG:{tooltip:{headerFormat:"",style:t},chart:{type:"area",margin:[10,-10,10,-10],spacing:[0,0,0,0]},plotOptions:{series:{animation:!1,states:{hover:{enabled:!1}}},area:{lineWidth:0,fillOpacity:1}},xAxis:{visible:!1},yAxis:{visible:!1,max:e},title:{text:""},subTitle:{text:""},credits:{enabled:!1},legend:{enabled:!1}},LABEL_CONFIG:t}}())}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.storageUtil=t,this.constants=i,this.bytesFilter=r}return Object.defineProperty(e,"BLOCK_SIZE_DEFAULT",{get:function(){return 512},enumerable:!0,configurable:!0}),e.prototype.buildChart=function(e){var t=this;return _.extend(this.constants.HIGHCHARTS_CONFIG,{series:this.buildRectangles(e),tooltip:{formatter:function(){var e=this,i=t.bytesFilter(e.series.options.totalSizeMb,"MB","Auto",3);return!!this.point.dataLabels&&e.series.name+": "+i}},partitions:this.partitions,totalX:this.totalX})},e.calcSize=function(t){return(Number(t.end.block)-Number(t.start.block)+1)*Number(t.start.blockSize||e.BLOCK_SIZE_DEFAULT)/Math.pow(1024,2)},e.getExtentOriginalBlockRange=function(e,t){var i=null,r=t.spec;if("com.vmware.vim.binding.vim.host.VmfsDatastoreExpandSpec"!==r._type)return null;var n=_.find(t.info.layout.partition,function(e){return e.partition===r.extent.partition});return n&&(i=_.find(e.layout.partition,function(e){return e.start.block===n.start.block})),i},e.prototype.buildRectangles=function(t){var i=this;this.totalX=0,this.partitions=_.map(t.layout.partition,function(t){var r=_.clone(t);return r.totalSize=e.calcSize(t),r.visibleSize=r.totalSize,i.totalX+=r.totalSize,r});for(var r=this.totalX/this.partitions.length*.2,n=0;n<this.partitions.length;n++)this.partitions[n].totalSize<r&&(this.partitions[n].visibleSize=r);for(var o=[],a=0,n=0;n<this.partitions.length;n++)o[n]=this.buildRect(this.partitions[n],a,this.totalX),a+=this.partitions[n].visibleSize;return this.totalX=a,o},e.prototype.buildRect=function(e,t,i){var r=this,n={name:this.i18nService.getString("StorageUi","datastore.partitionType."+e.type),partitionType:e.type,data:[[t,0],[t,this.constants.BAR_HEIGHT],{x:t+e.visibleSize/2,y:this.constants.BAR_HEIGHT,width:e.visibleSize,dataLabels:{style:this.constants.LABEL_CONFIG,enabled:!0,y:this.constants.BAR_HEIGHT/2,formatter:function(){var t=6,n=r.bytesFilter(e.totalSize,"MB","Auto",1),o=this.series.name+": "+n,a=this.point.options.width/i,s=a*this.series.chart.plotWidth,c=t*o.length;return c<s?o:null}}},[t+e.visibleSize,this.constants.BAR_HEIGHT],[t+e.visibleSize,0]],totalSizeMb:e.totalSize};if(this.storageUtil.isFreePartition(e.type)&&(n.color=this.constants.FREE_PARTITION_COLOR),e.datastoreInfo){n.color=this.constants.SAME_DATASTORE_PARTITION_COLOR;var o=e.datastoreInfo;n.name=o.datastoreName+" ("+n.name+")"}return n},e.$inject=["i18nService","storageUtil","layoutAreaChartConstants","bytesFilter"],e}();e.LayoutAreaChartService=t,angular.module("com.vmware.vsphere.client.storage").service("layoutAreaChartService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=e.LayoutAreaChartService,i=function(){function e(e,t){this.i18nService=e,this.storageUtil=t}return Object.defineProperty(e,"SELECTION_MASK_CLASS",{get:function(){return"storage-partition-layout-selection-mask"},enumerable:!0,configurable:!0}),e.prototype.clearMask=function(t){var i=t.find("."+e.SELECTION_MASK_CLASS);i&&i.remove()},e.prototype.highlightSelection=function(e,i,r,n){var o=this,a=this;if(this.clearMask(i),_.isArray(r)){var s=0;_.forEach(r,function(e){e.size=t.calcSize(e),s+=e.size});var c=0;_.forEach(r,function(t){var i=o.lbaAddressMb(t.start),r=o.lbaAddressMb(t.end),s=0;n>=c&&n<=c+t.size?s=n-c:n>c+t.size&&(s=t.size),a.maskRect(e,i,r,s),c+=r-i})}else{var l=this.lbaAddressMb(r.start),d=this.lbaAddressMb(r.end);this.maskRect(e,l,d,n)}},e.prototype.maskRect=function(t,i,r,n){var o=t.userOptions.totalX,a=t.userOptions.partitions,s=t.chartWidth/o*this.mbToUnits(i,a),c=t.chartWidth/o*this.mbToUnits(r,a),l=n/(r-i)*(c-s);t.renderer.rect(s,10,c-s,80,0).attr({"stroke-width":6,stroke:"rgb(15,172,201)",fill:"rgba(255,255,255,0)",zIndex:3,"class":e.SELECTION_MASK_CLASS}).add(),t.renderer.rect(s,10,l,80,0).attr({"stroke-width":0,stroke:"rgb(15,172,201)",fill:"rgba(15,172,201, 0.6)",zIndex:3,"class":e.SELECTION_MASK_CLASS}).add()},e.prototype.mbToUnits=function(e,t){for(var i=0,r=0;r<t.length;r++){var n=this.lbaAddressMb(t[r].start),o=this.lbaAddressMb(t[r].end);if(e<=o&&e>=n){i+=e-n;break}i+=t[r].visibleSize}return i},e.prototype.lbaAddressMb=function(e){return this.storageUtil.lbaToBytes(e)/Math.pow(1024,2)},e.$inject=["i18nService","storageUtil","layoutAreaChartService"],e}();e.LayoutAreaSelectionService=i,angular.module("com.vmware.vsphere.client.storage").service("layoutAreaSelectionService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=e.LayoutAreaChartService,i=function(){function e(e,i,r,n,o,a){var s=this;this.chartService=e,this.selectionService=i,this.storageUtil=r,this.i18nService=n,this.$scope=o,this.element=a,this.chart=null,this.onSizeChange=function(){if(!s.chart||!s.selectedOption||!s.selectedOption.vmfsDatastoreOption)return void s.selectionService.clearMask(s.element);var e=s.selectedOption.vmfsDatastoreOption,i=e.info.vmfsExtent;if("com.vmware.vim.binding.vim.host.VmfsDatastoreOption$SingleExtentInfo"!==e.info._type&&"com.vmware.vim.binding.vim.host.VmfsDatastoreOption$AllExtentInfo"!==e.info._type||1!==e.info.layout.partition.length||"com.vmware.vim.binding.vim.host.VmfsDatastoreExpandSpec"===e.spec._type)if("com.vmware.vim.binding.vim.host.VmfsDatastoreExpandSpec"===e.spec._type){var r=t.getExtentOriginalBlockRange(s.diskPartitionInfo,e),n={start:{block:r.end.block+1,blockSize:i.start.blockSize},end:{block:i.end.block,blockSize:i.end.blockSize}};s.selectionService.highlightSelection(s.chart,s.element,n,1024*s.size)}else s.selectionService.highlightSelection(s.chart,s.element,i,1024*s.size);else{var o={start:{block:0,blockSize:s.diskPartitionInfo.layout.total.blockSize},end:{block:s.diskPartitionInfo.layout.total.block,blockSize:s.diskPartitionInfo.layout.total.blockSize}};s.selectionService.highlightSelection(s.chart,s.element,o,1024*s.size)}},this.drawChart=function(e){var t=s;e&&s.element.highcharts(s.chartService.buildChart(e),function(e){t.chart=e,t.chartPartitions=_.map(t.chart.series,function(e){return!t.storageUtil.isFreePartition(e.options.partitionType)&&{name:e.name,color:e.color}}).filter(function(e){return!!e})})}}return e.prototype.$onInit=function(){var e=this,t=this;this.chartApi=this.chartApi||{},this.chartApi.reflow=_.throttle(function(){t.chart.reflow(),t.onSizeChange()},300),this.drawChart(t.diskPartitionInfo),this.$scope.$watchGroup([function(){return t.size},function(){return t.selectedOption}],this.onSizeChange),this.$scope.$on("$destroy",function(){e.element.highcharts()&&e.element.highcharts().destroy()})},e.$inject=["layoutAreaChartService","layoutAreaSelectionService","storageUtil","i18nService","$scope","$element"],e}();angular.module("com.vmware.vsphere.client.storage").component("partitionLayoutChart",{controller:i,bindings:{selectedOption:"<",size:"<",diskPartitionInfo:"<",chartPartitions:"=",chartApi:"="}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){}return e}();e.VmfsBlockSizeSelectedOptions=t;var i=function(){function e(e){this.i18n=e}return e.prototype.$onInit=function(){this.initSelectedSettings()},e.prototype.populateDefaultGranularity=function(){_.contains(this.getGranularityOptionsPerBlockSize(),this.selectedSettings.granularity)||(this.selectedSettings.granularity=this.getGranularityOptionsPerBlockSize()[0])},e.prototype.getGranularityOptionsPerBlockSize=function(){return this.selectedSettings.blockSize.granularityOptions},e.prototype.updateSettings=function(){this.updateSettingsState(this.selectedSettings)},e.prototype.$onChanges=function(e){e.selectedSettings.isFirstChange()&&this.initSelectedSettings(),this.updateSettings()},e.prototype.initSelectedSettings=function(){this.selectedSettings||(this.selectedSettings=new t,this.selectedSettings.blockSize=this.blockSizeOptions[0],this.selectedSettings.granularity=this.getGranularityOptionsPerBlockSize()[0],this.selectedSettings.reclamationPriority={unmapPriority:"low"})},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.storage").component("vmfsBlockSizeOptions",{templateUrl:"storage-ui/resources/storage/directives/vmfsBlockSize/VmfsBlockSizeOptionsComponent.html",bindings:{blockSizeOptions:"<",updateSettingsState:"<",selectedSettings:"<"},controller:i})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this._type="com.vmware.vim.binding.vim.host.InternetScsiHba$IPProperties"}return e}();e.InternetScsiHba$IPProperties=t;var i=function(){function e(){this._type="com.vmware.vim.binding.vim.host.InternetScsiHba$IscsiIpv6Address"}return e}();e.InternetScsiHba$IscsiIpv6Address=i;var r=function(){function e(){this._type="com.vmware.vim.binding.vim.host.InternetScsiHba$IPv6Properties"}return e}();e.InternetScsiHba$IPv6Properties=r;var n=function(){function e(){this._type="com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterIpConfigurationUpdateSpec"}return e}();e.InternetScsiStorageAdapterIpConfigurationUpdateSpec=n}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.vuiDialogService=e,this.$rootScope=t,this.i18nService=i,this.datastoreBrowserConstants=r,this.vuiConstants=n}return e.prototype.browseFile=function(e,t){var i,r=this.datastoreBrowserConstants.fileQueryType.FOLDERS|this.datastoreBrowserConstants.fileQueryType.VM_CONFIG_FILES,n=[{label:this.i18nService.getString("Common","dsBrowser.vmConfigFile"),value:this.datastoreBrowserConstants.fileQueryType.VM_CONFIG_FILES}],o=this.$rootScope.$new();o.dsFileBrowserData={datastoreId:e,initialFileQueryType:r,filterFileQueryTypes:n,showVmImagesFolder:!1,selectedFileChanged:function(e){i=e,o.dialogOptions.confirmOptions.disabled=!i}},o.dialogOptions={title:this.i18nService.getString("Common","dsBrowser.defaultTitle"),contentUrl:"storage-ui/resources/storage/register-vm/select-vm-to-register.view.html",show:!0,width:"1000px",selectedObject:{},confirmOptions:{disabled:!0,onClick:function(){return t&&t(i),!0}}};var a={scope:o,configObjectName:"dialogOptions"};this.vuiDialogService(a)},e.$inject=["vuiDialogService","$rootScope","i18nService","datastoreBrowserConstants","vuiConstants"],e}();e.SelectVmToRegisterService=t,angular.module("com.vmware.vsphere.client.storage").service("selectVmToRegisterService",t)}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("adapterTargetsService",["dataService","hostStorageConstants","defaultUriSchemeUtil","logService","mutationService",function(e,t,i,r,n){function o(t,i){var r,n="hostBusAdapter";return i&&(r=u(n,i)),e.getProperties(t,[n],r).then(function(e){var t=e[n]||{};v.adapterKey=i,v.dynamicTargets=[],v.staticTargets=[],v.hba=t;var r={};if(t.configuredSendTarget){var o=[];t.configuredSendTarget.forEach(function(e){var t=d(e);o.push({address:t,target:e}),r[t]=e}),v.dynamicTargets=o}if(t.configuredStaticTarget){var a=[];t.configuredStaticTarget.forEach(function(e){var t=null;r.hasOwnProperty(e.parent)&&(t=r[e.parent].authenticationProperties),a.push({address:d(e),name:e.iScsiName,target:e,parentDynamicTargetAuthProperties:t})}),v.staticTargets=a}return v})}function a(e,t,i,r,o,a,s){var d=c(t,i,r,o,a,s),u=l(!0,e,t,i,[d]);return n.apply(e,u._type,u)}function s(e,t,i,r){var o=l(!1,e,t,i,r);return n.apply(e,o._type,o)}function c(e,t,i,r,n,o){return t&&i&&r||p.error("Some of mandatory parameters were null or undefined"),e||n||p.error("iscsiName is mandatory for static targets"),e?{_type:"com.vmware.vim.binding.vim.host.InternetScsiHba$SendTarget",address:r,port:i,parent:t,authenticationProperties:o}:{_type:"com.vmware.vim.binding.vim.host.InternetScsiHba$StaticTarget",address:r,port:i,iScsiName:n,parent:t,authenticationProperties:o}}function l(e,t,r,n,o){return t&&n&&o||p.error("Some of mandatory parameters were null or undefined"),r?{_type:"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterSendTargetsSpec",isAdditionOperation:e,device:n,hostRef:i.getManagedObjectReference(t),sendTargets:o}:{_type:"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterStaticTargetsSpec",isAdditionOperation:e,device:n,hostRef:i.getManagedObjectReference(t),staticTargets:o}}function d(e){var i="";if(!e)return i;var r=e.port||t.DEFAULT_PORT_VALUE;return i=i.concat(e.address,":",r)}function u(e,t){return{propertyParams:[{propertyName:e,parameterType:"java.lang.String",parameter:t}]}}var p=r("adapterTargetsService"),v={adapterKey:void 0,dynamicTargets:[],staticTargets:[]};return{retrieveIscsiAdapterTargets:o,addIscsiAdapterTargets:a,removeIscsiAdapterTargets:s}}])}(),angular.module("com.vmware.vsphere.client.storage").constant("datastoreConstants",{datastoreTypes:{VMFS:"VMFS",NFS:"NFS",NFS3:"NFS3",VVOL:"VVOL",VSAN:"VSAN"},nfsVersions:{NFS_3:"nfs",NFS_4_1:"nfs41"},datastoreSpecificType:{nfs3:"NFS",nfs41:"NFS41",vsan:"vsan",vvol:"VVol",vmfs3:"VMFS 3",vmfs5:"VMFS 5",vmfs6:"VMFS 6"},vmfsVersions:{VMFS_3:3,VMFS_5:5,VMFS_6:6},accessModes:{readOnly:"readOnly",readWrite:"readWrite"},maxNameLengthForNfsDatastore:42,maxNameLengthForNonNfsDatastore:80,BYTES_TO_GB:1073741824,MB_TO_GB:1024,vmfsSize:{DATASTORE_SIZE_STEP_IN_BYTES:10737418.24,MIN_DATASTORE_SIZE_GB:1.3,MIN_DATASTORE_V6_SIZE_GB:2},reclamationPriority:{NONE:"none",LOW:"low"},protocolEndpoint:{type:{block:"block",nas:"nas"}},scsiDiskType:{EMULATED_512:"emulated512",NATIVE_4K:"native4k",SOFTWARE_EMULATED_4K:"SoftwareEmulated4k",NATIVE_512:"native512",UNKNOWN:"unknown"},kerberosSecurityTypes:{AUTH_SYS:"AUTH_SYS",SEC_KRB5:"SEC_KRB5",SEC_KRB5I:"SEC_KRB5I"}}),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("datastoreFileService",["userSessionService","dataService","$q","defaultUriSchemeUtil","$window",function(e,t,i,r,n){function o(n,o){var s=n.serverGuid,c=r.getVsphereObjectId(n);return i.all([e.getServerInfo(s),t.getProperties(c,["name"])]).then(function(e){var t=e[0],i=e[1],r=o.map(function(e){var r=e.match(/^\[(.*?)\]\s{1}(.*)$/),n=r[1],o=r[2],s=a(t.serviceUrl,o,n,i.name);return s});return r})}function a(e,t,i,r){var n=document.createElement("a");n.href=e;var o=n.protocol.concat("//").concat(n.host).concat("/folder/").concat(t).concat("?dcPath=").concat(r).concat("&dsName=").concat(i);return o}function s(e){n.open(e,"_blank")}return{getFileUrls:o,startFileDownload:s}}])}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.clarityModalService=e,this.i18nService=t,this.mutationService=i,this.defaultUriSchemeUtil=r,this.clarityConstants=n,this.dataService=o,this.datastoreConstants=a}return e.prototype.copyFiles=function(e,t,i,r,n){var o=this,a={title:this.i18nService.getString("StorageUi","pathPicker.defaultTitle"),contentTemplate:"storage-ui/resources/storage/views/manage/files/CopyFilesDialog.html",size:"lg",dialogData:{i18n:this.i18nService.getString.bind(this,"StorageUi"),datastores:[],selectedDestination:{path:null,name:null},hasSelectedDatastore:!1,selectedDatastore:{id:e,type:null,name:null},overwriteFiles:!1},onSubmit:function(){var s=o.validateDialogData(a.dialogData);if(s.length)return a.alerts=s,!1;var c={_type:r,sourceDatacenter:t,destinationPath:a.dialogData.selectedDestination.path,destinationDatastore:o.defaultUriSchemeUtil.getManagedObjectReference(a.dialogData.selectedDatastore.id),sourcePaths:[],sourceFileTypes:[],overwrite:a.dialogData.overwriteFiles,waitTasksToComplete:!0};return _.forEach(i,function(e){c.sourcePaths.push(e.path),c.sourceFileTypes.push(e.fileType)}),o.mutationService.apply(e,r,c).then(function(){n&&n(a.dialogData.selectedDatastore.id,a.dialogData.selectedDestination.path)}),!0}};this.clarityModalService.openOkCancelModal(a),this.loadData(e).then(function(e){a.dialogData.datastores=e["storage:datastoresInVc"]})},e.prototype.loadData=function(e){var t=this.defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(e);return this.dataService.getProperties(t,["storage:datastoresInVc"])},e.prototype.validateDialogData=function(e){var t=[],i={type:this.clarityConstants.notifications.type.ERROR,text:null};return e.hasSelectedDatastore?e.selectedDestination.path?e.selectedDatastore.type.toUpperCase()===this.datastoreConstants.datastoreTypes.VSAN&&e.selectedDestination.name===e.selectedDatastore.name?i.text=this.i18nService.getString("StorageUi","pathPicker.vsanRootSelected"):e.selectedDatastore.type.toUpperCase()===this.datastoreConstants.datastoreTypes.VVOL&&e.selectedDestination.name===e.selectedDatastore.name&&(i.text=this.i18nService.getString("StorageUi","pathPicker.vvolRootSelected")):i.text=this.i18nService.getString("StorageUi","pathPicker.noLocationSelected"):i.text=this.i18nService.getString("StorageUi","pathPicker.noDatastoreSelected"),i.text&&t.push(i),t},e.$inject=["clarityModalService","i18nService","mutationService","defaultUriSchemeUtil","clarityConstants","dataService","datastoreConstants"],e}();e.FileCopyService=t,angular.module("com.vmware.vsphere.client.storage").service("fileCopyService",t)}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("fileDownloadService",["$timeout","$window","fileUrlResolverService","browserService","$http","$httpParamSerializer","defaultUriSchemeUtil","i18nService","storageUtil","dataService","$cookies","clarityModalService",function(e,t,i,r,n,o,a,s,c,l,d,u){function p(e,t,i,r,n,d){var u="datastore:isMultipleFilesDownloadSupported";l.getProperties(t,u).then(function(l){if(l[u]){P();var p={vcServerGuid:e.serverGuid,resultFileName:r,datacenterId:a.getVsphereObjectId(e),datastoreId:t,datastorePath:i,baseDatastorePath:n};d&&(p.diskFormat=E);var v=o(p);D(v)}else c.showErrorDialog(s.getString("StorageUi","fileDownload.error.noEndpointsError"))})}function v(e,t,r,n){i.resolveFileUrls(e,t,r,n).then(function(i){i&&i.fileTransferEndpoints?i.fileTransferEndpoints.forEach(function(i){if(P(),i.ticket)m(i);else{var o=C(e,t,r,n);D(o)}}):c.showErrorDialog(s.getString("StorageUi","fileDownload.error.noEndpointsError"))})}function m(e){var i=g(t,e);try{i.submit()}finally{angular.element(i).remove()}}function g(e,t,i){var r=e.document.createElement("form");if(r.action=t.url,r.target=i||"_blank",r.method="get",t.ticket){r.method="post";var n=e.document.createElement("input");n.type="hidden",n.name="vmware_cgi_ticket",n.value=t.ticket,r.appendChild(n)}return e.document.body.appendChild(r),r}function h(e,r,n,o){var a=[];n.forEach(function(){a.push(t.open("about:blank","_blank"))}),i.resolveFileUrls(e,r,n,o).then(function(t){t.fileTransferEndpoints.forEach(function(t,i){if(t.ticket){var s=g(a[i],t,"_self");s.submit()}else{var c=C(e,r,n,o);a[i].location.href=I+"?"+c}})})}function f(e){var t={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"};return t[h5.xsrfCookieName]=d.get(h5.xsrfCookieName),e+="&"+_+"=true",n({method:"POST",url:I,data:e,headers:t}).then(function(e){return e.data})}function S(e){return!r.isIe&&e.length>b||r.isIe&&e.length>w}function y(e){var t=e;return e.lastIndexOf("/")!==e.length-1&&(t+="/"),t}function P(){r.areBlockingPopupsAllowed().then(function(e){if(!e){var t={title:s.getString("StorageUi","fileDownload.blockingPopup.title"),hideCancelButton:!0,message:s.getString("StorageUi","fileDownload.blockingPopup.message"),icon:"icon-warning-32",submit:function(){return!0},preserveNewlines:!0};u.openConfirmationModal(t)}})}function C(e,t,i,r){var n={vcServerGuid:e.serverGuid,datacenterId:a.getVsphereObjectId(e),datastoreId:t,datastorePath:i};return r&&(n.diskFormat=E),o(n)}function D(e){var i=y(t.location.href)+I+"?"+e;return S(i)?void f(e).then(function(e){var i={};i[T]=e;var r=o(i);t.open(I+"?"+r,"_blank")}):void t.open(I+"?"+e,"_blank")}var w=2047,b=3e4,I="filedownload",_="requestToken",T="token",E="StreamVmdk",V={startFilesDownload:function(e,t,i,n){var o=r.isSafari;return V.startFilesDownload=o?h:v,V.startFilesDownload(e,t,i,n)},startFilesDownloadAsZip:p};return V}])}();var storage_ui;!function(e){var t=function(){function e(e){this.$q=e}return e.prototype.readFileContentAsBase64=function(e){if(!e)return this.$q.when(null);var t=this.$q.defer(),i=new FileReader;return i.onload=function(){var e=i.result;e&&e.indexOf(",")>=0?t.resolve(e.substring(e.indexOf(",")+1)):t.resolve(null)},i.addEventListener("error",function(){t.resolve(null)}),i.readAsDataURL(e),t.promise},e.$inject=["$q"],e}();e.FileReaderService=t,angular.module("com.vmware.vsphere.client.storage").service("fileReaderService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){angular.module("com.vmware.vsphere.client.storage").constant("fileUploadConstants",{event:{UPDATED:"FILE_UPLOAD_UPDATED",COMPLETE:"FILE_UPLOAD_COMPLETE"},state:{RUNNING:"RUNNING",SUCCESS:"SUCCESS",ERROR:"ERROR",CANCELED:"CANCELED"}});var t=function(){function e(){this.datastoresWithCancelledUploads={}}return e.prototype.contructor=function(){},e.prototype.add=function(e){this.datastoresWithCancelledUploads[e]=!0},e.prototype.remove=function(e){this.datastoresWithCancelledUploads[e]=!1},e.prototype.isPresent=function(e){return this.datastoresWithCancelledUploads[e]},e}(),i=function(){function e(e,i,r,n,o,a,s,c,l,d){var u=this;this.$rootScope=e,this.fileUploadConstants=i,this.fileUrlResolverService=r,this.$cookies=n,this.defaultUriSchemeUtil=o,this.i18nService=a,this.storageUtil=s,this.$interval=c,this.clarityModalService=l,this.$q=d,this.MAX_UPLOADS_AT_TIME=10,this.POLL_INTERVAL_MS=3e3,this.xhrRequestBySessionId={},this.currentUploadSessionId=0,this.pendingCancelRequestsRegistry=new t,this.onSessionExpiration=function(e){u.isUploadInProgress()&&e.preventDefault()},this.onUserLogout=function(e,t){if(u.isUploadInProgress()){var i=u.$q.defer();u.clarityModalService.openConfirmationModal({message:u.i18nService.getString("StorageUi","upload.logout.warning.message"),title:u.i18nService.getString("StorageUi","upload.logout.warning.title"),clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0,saveButtonLabel:u.i18nService.getString("Common","yes.label"),cancelButtonLabel:u.i18nService.getString("Common","no.label"),submit:function(){i.resolve(!1)},onCancel:function(){i.resolve(!0)}}),t.preventLogout=i.promise,e.preventDefault()}},this.uploadSessions=[],e.$on("sessionExpired",this.onSessionExpiration),e.$on("onUserLogout",this.onUserLogout)}return e.prototype.isUploadInProgress=function(){var e=_.findLastIndex(this.uploadSessions,{status:this.fileUploadConstants.state.RUNNING});return e!==-1},e.prototype.getUploadSessions=function(e){return this.uploadSessions.filter(function(t){return!e||t.datastoreId===e})},e.prototype.getRunningUploadSessions=function(e){var t=this;return this.uploadSessions.filter(function(i){return(!e||i.datastoreId===e)&&i.status===t.fileUploadConstants.state.RUNNING})},e.prototype.startFilesUpload=function(e,t,i,r,n,o){var a=this,s=n?" ":"/";this.slotsAvailable=this.MAX_UPLOADS_AT_TIME;var c=null,l={},d=function(){if(0===r.length||a.pendingCancelRequestsRegistry.isPresent(t))return a.$interval.cancel(c),void a.pendingCancelRequestsRegistry.remove(t);for(var n=[];a.slotsAvailable&&0!==r.length;){var d=r.pop(),u=!0;if(d.webkitRelativePath){var p=d.webkitRelativePath.lastIndexOf("/");if(p>0){var v=d.webkitRelativePath.substring(0,p);if(!l.hasOwnProperty(v)){u=!1;for(var m=v.split("/"),g="",h=0;h<m.length;h++)g&&(g+="/"),g+=m[h],l[g]=!0}}}if(n.push(d),a.slotsAvailable--,!u)break}n.length&&a.uploadBatch(n,e,t,i,s,o).then(function(e){e||a.$interval.cancel(c)})};this.pendingCancelRequestsRegistry.remove(t),c=this.$interval(function(){return d()},this.POLL_INTERVAL_MS),d()},e.prototype.cancelFilesUpload=function(e){var t=this;this.pendingCancelRequestsRegistry.add(e);var i=this.getUploadSessions(e);i.forEach(function(e){e.status===t.fileUploadConstants.state.RUNNING&&t.cancelUpload(e)})},e.prototype.uploadBatch=function(e,t,i,r,n,o){var a=this,s=_.map(e,function(e){return r+n+(e.webkitRelativePath||e.name)});return this.fileUrlResolverService.resolveFileUrls(t,i,s,o).then(function(n){if(n&&n.fileTransferEndpoints&&n.fileTransferEndpoints.length){for(var c=0;c<n.fileTransferEndpoints.length;c++){var l=void 0;l=n.fileTransferEndpoints&&n.fileTransferEndpoints.length&&n.fileTransferEndpoints[c].ticket?n.fileTransferEndpoints[c]:{url:a.getLocalProxyUploadUrl(t,i,s[c],o)},a.startXhrUpload(e[c],r,s[c],l.url,l.ticket,i)}return!0}return a.storageUtil.showErrorDialog(a.i18nService.getString("StorageUi","fileUpload.error.noEndpointsError")),!1})},e.prototype.showError=function(e){this.storageUtil.showErrorDialog(e.error,e.trustErrorMessageAsHtml)},e.prototype.finishUploadSession=function(e){this.xhrRequestBySessionId[e.id]=null,e.isCancelable=!1,e.cancel=null},e.prototype.startXhrUpload=function(e,t,i,r,n,o){function a(){c.upload&&c.upload.removeEventListener("progress",u)}var s=this,c=new XMLHttpRequest,l=new Date,d={id:this.currentUploadSessionId++,name:i,datastorePath:t,datastoreId:o,progress:0,uploadedSizeInB:0,sizeInB:e.size,status:this.fileUploadConstants.state.RUNNING,startTime:l,lastUpdated:l,isCancelable:!0,uploadUrl:r,isGeneralError:!1,error:"",trustErrorMessageAsHtml:!1};this.xhrRequestBySessionId[d.id]=c,d.showError=this.showError.bind(this,d),d.cancel=this.cancelUpload.bind(this,d),this.uploadSessions.splice(0,0,d),this.broadcastEvent(this.fileUploadConstants.event.UPDATED,d),c.addEventListener("load",function(){s.slotsAvailable++,s.uploadComplete(d,c),a()},!1),c.addEventListener("error",function(){s.slotsAvailable++,s.uploadComplete(d,c),a()},!1);var u=_.throttle(function(e){s.reportProgress(d,e)},2e3);if(c.upload&&c.upload.addEventListener("progress",u),c.open("PUT",r),c.setRequestHeader("Content-type","application/octet-stream"),n)c.setRequestHeader("vmware-cgi-ticket",n);else{var p=this.$cookies.get(h5.xsrfCookieName);p&&c.setRequestHeader(h5.xsrfHeaderName,p)}c.send(e)},e.prototype.getLocalProxyUploadUrl=function(e,t,i,r){var n={vcServerGuid:e.serverGuid,datacenterId:this.defaultUriSchemeUtil.getVsphereObjectId(e),datastoreId:t,datastorePath:i};r&&(n.diskFormat="StreamVmdk");var o=$.param(n),a=document.createElement("a");return a.href="fileupload",a.search=o,a.href},e.prototype.cancelUpload=function(e){var t=this.xhrRequestBySessionId[e.id];t&&e.isCancelable&&(t.abort(),this.finishUploadSession(e),e.status=this.fileUploadConstants.state.CANCELED,this.broadcastEvent(this.fileUploadConstants.event.UPDATED,e))},e.prototype.reportProgress=function(e,t){if(t.lengthComputable){var i=Math.floor(t.loaded/t.total*100);i!==e.progress&&(e.progress=i,e.uploadedSizeInB=t.loaded,e.lastUpdated=new Date,this.broadcastEvent(this.fileUploadConstants.event.UPDATED,e))}},e.prototype.uploadComplete=function(e,t){if(this.finishUploadSession(e),200===t.status||201===t.status)e.status=this.fileUploadConstants.state.SUCCESS,e.uploadedSizeInB=e.sizeInB;else{e.status=this.fileUploadConstants.state.ERROR;var i=t.responseText;if(!i){var r=document.createElement("a");r.href=e.uploadUrl;var n=r.protocol+"//"+r.hostname,o="<a href='http://kb.vmware.com/kb/2147256' target='_blank'>http://kb.vmware.com/kb/2147256</a>",a='<a href="'+n+'" target="_blank">'+n+"</a>";i=this.i18nService.getString("StorageUi","fileUpload.error.withUrl",a,o),e.isGeneralError=!0,e.trustErrorMessageAsHtml=!0}e.error=i}this.broadcastEvent(this.fileUploadConstants.event.UPDATED,e),this.broadcastEvent(this.fileUploadConstants.event.COMPLETE,e)},e.prototype.broadcastEvent=function(e,t){this.$rootScope.$broadcast(e,angular.copy(t))},e}();angular.module("com.vmware.vsphere.client.storage").factory("fileUploadService",["$rootScope","fileUploadConstants","fileUrlResolverService","$cookies","defaultUriSchemeUtil","i18nService","storageUtil","$interval","clarityModalService","$q",function(e,t,r,n,o,a,s,c,l,d){return new i(e,t,r,n,o,a,s,c,l,d)}])}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("fileUrlResolverService",["dataService","browserService",function(e,t){function i(i,r,n,o){var a=[{propertyName:"fileTransferEndpoints",parameterType:"com.vmware.vsphere.client.storage.DatastoreFilePathsSpecEx",parameter:{datacenter:i,datastorePaths:n,isStreamFormat:o,alwaysTransferThroughVc:t.isIe}}];return e.getProperties(r,"fileTransferEndpoints",{propertyParams:a})}return{resolveFileUrls:i}}])}(),angular.module("com.vmware.vsphere.client.storage").constant("hostStorageConstants",{hostAdapterTypes:{ISCSI:"ISCSI",FCOE:"FCOE",FIBRECHANNEL:"FIBRECHANNEL"},adapterDetailsAction:{ENABLE_SW_ISCSI_ADAPTER:"vsphere.core.host.actions.adapters.enableSoftwareIscsiAdapter",DISABLE_SW_ISCSI_ADAPTER:"vsphere.core.host.actions.adapters.disableSoftwareIscsiAdapter",EDIT_AUTH_SETTINGS:"vsphere.core.host.actions.adapters.editIscsiAuthenticationSettings",EDIT_GENERAL_SETTINGS:"vsphere.core.host.actions.adapters.editIscsiGeneralSettings"},adapterPathState:{ACTIVE:"active",STANDBY:"standby",DISABLED:"disabled",DEAD:"dead",UNKNOWN:"unknown"},operationalState:{OK:"ok",OFF:"off",LOST_COMMUNICATION:"lostCommunication",ERROR:"error",UNKNOWN_STATE:"unknownState"},DEFAULT_PORT_VALUE:3260,PATH_SELECTION_POLICY_OPTIONS_PROP:"pathSelectionPolicyOptions",STORAGE_ARRAY_TYPE_POLICY_OPTIONS_PROP:"storageArrayTypePolicyOptions",EXTENTS_MULTIPATHING_INFO_PROP:"datastore:vmfsExtentsMultipathingInfo",STORAGE_DEVICE_MULTIPATHING_INFO_PROP:"storagedevice:hostStorageDeviceMultipathingInfo",STORAGE_DEVICE_MULTIPATHING_INFO_WITH_PATHS_PROP:"storagedevice:hostStorageDeviceMultipathingInfoWithPaths",storagePolicies:{FIXED_PATH:"VMW_PSP_FIXED",LEGACY_FIXED_PATH:"fixed",MOST_RECENTLY_USED_PATH:"VMW_PSP_MRU",LEGACY_MOST_RECENTLY_USED_PATH:"mru",ROUND_ROBIN:"VMW_PSP_RR",LEGACY_ROUND_ROBIN:"rr",UNKNOWN:"VMW_PSP_UNKN"},protocolEndpoints:{BLOCK:"block",NAS:"nas"},connectionState:{CONNECTED:"connected",DISCONNECTED:"disconnected",NOT_RESPONDING:"notResponding"},deviceType:{CDROM:"cdrom",DISK:"disk"}}),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("hostStorageService",["dataService","i18nService","bytesFilter","$q","defaultUriSchemeUtil","mutationService","hostStorageConstants","$rootScope",function(e,t,i,r,n,o,a,s){
function c(r,n){var o,a="storagedevice:hostStorageDevices";return n&&(o=S(a,n)),e.getProperties(r,[a],o).then(function(e){var r=e[a]||[];return r.forEach(function(e){e.localizedState=t.getString("StorageUi","storage.adapters.devices.deviceState."+e.operationalState),e.localizedDriveType=t.getString("StorageUi",e.isFlash?"disk.ssd":"disk.nonSSD"),e.localizedLunNumber=e.lunNumber>=0?e.lunNumber:"",e.localizedCapacity=e.isScsiDisk?i(e.capacity,"B","Auto",2):"",e.disabled="ok"!==e.operationalState}),r})}function l(t,i){var n="storagedevice:partitionDetails";if(!i)return r.when({partitionFormat:"",partitions:[]});var o=S(n,i);return e.getProperties(t,[n],o).then(function(e){var t=e[n]||[];return t})}function d(t){var i="storagedevice:datastoreStorageDevices";return e.getProperties(t,[i]).then(function(e){return e[i]})}function u(t,i,r){var n="datastore:datastoreIncreaseOptions",o={propertyParams:[{propertyName:n,parameterType:"com.vmware.vsphere.client.storage.DatastoreIncreaseOptionsQuerySpec",parameter:{host:i,scsiDiskInfo:r}}]};return e.getProperties(t,[n],o).then(function(e){return e[n]})}function p(e,t){return g(e,t,"storageadapter:hostStorageAdapterPaths")}function v(e,t){return g(e,t,"storagedevice:hostStorageDevicePaths")}function m(e,t){return g(e,t,"storagedevice:hostStoragePEPaths")}function g(t,i,r){var n;return i&&(n=S(r,i)),e.getProperties(t,[r],n).then(function(e){var t=e[r]||[];return t})}function h(t,i){var r=y(a.EXTENTS_MULTIPATHING_INFO_PROP,i);return e.getProperties(t,[a.EXTENTS_MULTIPATHING_INFO_PROP,a.PATH_SELECTION_POLICY_OPTIONS_PROP,a.STORAGE_ARRAY_TYPE_POLICY_OPTIONS_PROP],r)}function f(t,i){var o={affectedHosts:[],targetName:null};if(!t||!t.length)return r.when(o);if("HostSystem"===t[0].type)return P(t,i),o.affectedHosts=t,r.when(o);var a="storageadapter:getHostsApplicableForRescan",s="name",c=n.getVsphereObjectId(t[0]);return e.getProperties(c,[a,s]).then(function(e){var t=e[a];return t&&t.length&&P(t,i),o.affectedHosts=t,o.targetName=e[s],o})}function S(e,t){return{propertyParams:[{propertyName:e,parameterType:"java.lang.String",parameter:t}]}}function y(e,t){return{propertyParams:[{propertyName:e,parameterType:"com.vmware.vim.binding.vmodl.ManagedObjectReference",parameter:n.getManagedObjectReference(t)}]}}function P(e,t){var i="com.vmware.vsphere.client.storage.adapters.StorageAdapterRescanSpec",r=e.map(n.getVsphereObjectId.bind(n));return o.applyOnMultiEntity(r,i,t).then(function(){s.$broadcast("vsphere.core.host.actions.rescan.completed",{affectedHosts:e,rescanSpec:t})})}function C(e){var t=[];_.forEach(e,function(e){var i=_.map(e.devices,function(t){return{entity:e.hostId,spec:{_type:w,devicePath:t.devicePath}}});t=t.concat(i)}),o.applyMulti(w,t)}function D(e,t,i){var r=_.pluck(t,"lunUuid"),n={_type:b,isLocal:i,diskUUID:r};o.apply(e,b,n)}var w="com.vmware.vsphere.client.storage.FormatHostDiskSpec",b="com.vmware.vsphere.client.storage.TagDiskAsLocalSpec";return{retrieveStorageDevicesData:c,retrieveStorageDevicePartitionData:l,retrieveHostStorageAdapterPathsData:p,retrieveHostProtocolEndpointsPathsData:m,retrieveHostStorageDevicePathsData:v,retrieveDatastoreStorageDevices:d,retrieveDatastoreIncreaseOptions:u,retrieveVmfsDatastoreMultipathingData:h,rescanStorageAdapters:f,erasePartitions:C,changeDiskLocalState:D}}])}();var storage_ui;!function(e){var t=function(){function e(){}return e}();e.IscsiAuthenticationSettings=t;var i=function(){function e(e){this.constants=e}return e.prototype.buildIscsiAuthenticationSettings=function(e,i){var r=new t;return r.authenticationMethod=this.getAuthenticationMethod(e),r.useInitiatorNameForOutgoing=i===e.chapName,r.outgoingName=e.chapName,r.outgoingSecret=e.chapAuthenticationType!==this.constants.authentication.PROHIBITED?e.chapSecret:null,r.useInitiatorNameForIncoming=i===e.mutualChapName,r.incomingName=e.mutualChapName,r.incomingSecret=e.mutualChapAuthenticationType!==this.constants.authentication.PROHIBITED?e.mutualChapSecret:null,r.inheritSettingsFromParent=e.chapInherited,r},e.prototype.getAuthenticationMethod=function(e){if(!e.chapAuthEnabled)return this.constants.authentication.PROHIBITED;switch(e.chapAuthenticationType){case this.constants.authentication.DISCOURAGED:case this.constants.authentication.PREFERRED:return e.chapAuthenticationType;case this.constants.authentication.REQUIRED:return e.mutualChapAuthenticationType===this.constants.authentication.PROHIBITED?this.constants.authentication.REQUIRED:this.constants.authentication.MUTUAL}return this.constants.authentication.PROHIBITED},e.$inject=["storageAdapterConstants"],e}();e.IscsiAuthenticationSettingsService=i,angular.module("com.vmware.vsphere.client.storage").service("iscsiAuthenticationSettingsService",i)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e){function t(e,t){return t.template?t.template(e).replace(o,""):e[t.field]}function i(e,t){return e[t.field]?e[t.field]:""}function r(e,n,o,a){for(var s=[],c=0;c<e.length;c++){var l=e[c],d=!!a[l.field];if(d&&l.items&&l.items.length)r(l.items,n,o,a);else{for(var u=0;u<n.length;u++){var p=n[u];p.isGrouping?s.push('"'+i(l,p)+'"'):p.hidden||s.push('"'+t(l,p)+'"')}o.push(s.join(",")),s.length=0}}}function n(t){var i=angular.element(t).data("kendoGrid"),n=i.columns,o={},a=[],s=[],c=i.options.groupOrder;c&&c.length&&angular.forEach(c,function(e){o[e.field]=e;var t=$.grep(n,function(t){return t.field===e.field})[0];a.push('"'+t.title+'"'),s.push({field:t.field,isGrouping:!0})}),angular.forEach(n,function(e){if(e&&!e.hidden){var t={field:e.field};e.template&&"string"!==e.template?t.template=kendo.template(e.template):t.template=e.template,s.push(t),a.push('"'+e.title+'"')}});var l=[];l.push(a.join(","));var d=i.dataSource.totalPages();if(d>1){for(var u=i.dataSource.page(),p=1;p<=d;p++)i.dataSource.page(p),r(i.dataSource.view(),s,l,o);i.dataSource.page(u)}else r(i.dataSource.view(),s,l,o);e.copyToClipboard(l.join("\n"))}var o=/<[^>]+>/gm;return{copyAllItems:n}}angular.module("com.vmware.vsphere.client.storage").factory("kendoGridService",["clipboardService",e])}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e,i){var r=_.map(i,function(e){return o.getManagedObjectReference(e)}),n={entities:r};t.apply(e,"com.vmware.vsphere.client.h5.storage.spec.MoveDatastoreSpec",n)}function c(e){return a.checkPrivilegesForMultipleObjects(e,["Datastore.Move"]).then(function(e){var t=[];return _.each(e,function(e,i){e["Datastore.Move"]||t.push(i)}),t})}return{moveDatastoreTo:s,checkPrivileges:c}}angular.module("com.vmware.vsphere.client.storage").service("moveDatastoreToService",e),e.$inject=["i18nService","mutationService","clarityModalService","dataService","$q","defaultUriSchemeUtil","authorizationService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("storageUtil",["i18nService","managedEntityConstants","hostStorageConstants","datastoreConstants","clarityModalService","$sce",function(e,t,i,r,n,o){function a(e,t,i){var r=Number(e[i]),n=Number(t[i]);return isNaN(r)&&isNaN(n)?0:isNaN(r)?-1:isNaN(n)?1:r<n?-1:r>n?1:0}function s(e){return e.displayName?e.displayName:e.canonicalName}function c(e){return null===e||void 0===e||e===-1?"":e}function l(e){var t=e.blockSize||O;return e.block*t}function d(t){return t&&t.toLowerCase()!==k?t.toLowerCase()===A?e.getString("StorageUi","datastore.vStorage.supported"):e.getString("StorageUi","datastore.vStorage.unknown"):e.getString("StorageUi","datastore.vStorage.notSupported")}function u(t){return t===!0?e.getString("StorageUi","disk.ssd"):e.getString("StorageUi","disk.nonSSD")}function p(t){return t.vmfsLabel&&""!==t.vmfsLabel&&t.unresolvedExtent?t.unresolvedExtent.isHeadExtent===!0?e.getString("StorageUi","headVmfsLabel.format",t.vmfsLabel):t.vmfsLabel:""}function v(t){var i=e.getString("StorageUi","partitionFormat.unknown");return"gpt"===t?i=e.getString("StorageUi","partitionFormat.gpt"):"mbr"===t&&(i=e.getString("StorageUi","partitionFormat.mbr")),i}function m(e){return e.end.block-e.start.block+1}function g(e){var t=O;e.start.blockSize&&(t=e.start.blockSize);var i=m(e);return i*t}function h(e){var t=0;return e&&e.info&&("com.vmware.vim.binding.vim.host.VmfsDatastoreOption$SingleExtentInfo"===e.info._type||"com.vmware.vim.binding.vim.host.VmfsDatastoreOption$AllExtentInfo"===e.info._type?t=g(e.info.vmfsExtent):"com.vmware.vim.binding.vim.host.VmfsDatastoreOption$MultipleExtentInfo"===e.info._type?angular.forEach(e.info.vmfsExtent.length,function(e){t+=g(e)}):t=-1),t}function f(t,i){if(!t||!t.policy)return e.getString("StorageUi","informationNotAccessible");var r=t.policy,n=_.find(i,function(e){return e.policy&&e.policy.key===r});return n?n.policy.label||r:r}function S(t,i){if(!t||!t.policy)return e.getString("StorageUi","informationNotAccessible");var r=P(t.policy,i);return D(t.policy)&&t.prefer?e.getString("StorageUi","connectivity.policyWithpreferredPath",r,t.prefer):r}function y(e){return e.scsiDiskType===r.scsiDiskType.SOFTWARE_EMULATED_4K}function P(e,t){if(!t||!t.length)return C(e);var i=_.find(t,function(t){return t.policy.key===e});return i?i.policy.label||C(e):e}function C(t){switch(t){case i.storagePolicies.FIXED_PATH:case i.storagePolicies.LEGACY_FIXED_PATH:return e.getString("StorageUi","multipathing.policy.VMW_PSP_FIXED");case i.storagePolicies.ROUND_ROBIN:case i.storagePolicies.LEGACY_ROUND_ROBIN:return e.getString("StorageUi","multipathing.policy.VMW_PSP_RR");case i.storagePolicies.MOST_RECENTLY_USED_PATH:case i.storagePolicies.LEGACY_MOST_RECENTLY_USED_PATH:return e.getString("StorageUi","multipathing.policy.VMW_PSP_MRU");case i.storagePolicies.UNKNOWN:return e.getString("StorageUi","multipathing.policy.VMW_PSP_UNKN")}return t}function D(e){return e===i.storagePolicies.FIXED_PATH||e===i.storagePolicies.LEGACY_FIXED_PATH}function w(e){return"0x00"===e||"none"===e}function b(i){var r={};if(r[t.CLUSTER]="storage.adapters.rescanForm.warningCluster",r[t.FOLDER]="storage.adapters.rescanForm.warningFolder",r[t.DATACENTER]="storage.adapters.rescanForm.warningDatacenter",r[t.HOST]="storage.adapters.rescanForm.warningHosts",r.hasOwnProperty(i))return e.getString("StorageUi",r[i])}function I(t){var i="";if(t&&t.transport){var r=t.transport;_.forEach(r,function(t,r){var n="storage.adapters.devices.transport."+t,o=e.getString("StorageUi",n);o===n&&(o=t),i&&(i+=", "),i+=o})}return i||(i=e.getString("StorageUi","storage.adapters.devices.transport.UnknownTransport")),i}function T(t){switch(t){case r.scsiDiskType.NATIVE_512:return e.getString("StorageUi","vmfsProperties.scsiDisk.scsiDiskType.native512");case r.scsiDiskType.EMULATED_512:return e.getString("StorageUi","vmfsProperties.scsiDisk.scsiDiskType.emulated512");case r.scsiDiskType.NATIVE_4K:return e.getString("StorageUi","vmfsProperties.scsiDisk.scsiDiskType.native4k");case r.scsiDiskType.SOFTWARE_EMULATED_4K:return e.getString("StorageUi","vmfsProperties.scsiDisk.scsiDiskType.softwareEmulated4k");case r.scsiDiskType.UNKNOWN:return e.getString("StorageUi","vmfsProperties.scsiDisk.scsiDiskType.unknown")}return e.getString("StorageUi","vmfsProperties.scsiDisk.scsiDiskType.unknown")}function E(t){return V(t,"OK")?e.getString("StorageUi","storage.pe.opState.accessible"):e.getString("StorageUi","storage.pe.opState.notAccessible")}function V(e,t){return!!(e&&e.underlyingLun&&e.underlyingLun.operationalState)&&e.underlyingLun.operationalState.indexOf(t)!==-1}function M(t,i){var r={title:e.getString("StorageUi","fileOperation.error.title"),hideCancelButton:!0,icon:"icon-warning-32",submit:function(){return!0},preserveNewlines:!0};i?(r.contentTemplate="storage-ui/resources/storage/views/manage/files/FileUploadErrorView.html",r.contentTemplateContext={errorMessage:o.trustAsHtml(t)}):r.message=t,n.openConfirmationModal(r)}var O=512,A="vstoragesupported",k="vstorageunsupported";return{compareNumericValues:a,formatDeviceName:s,formatLunNumber:c,lbaToBytes:l,formatVStorageSupport:d,formatSSDValue:u,formatVmfsLabel:p,formatDiskPartitionType:v,getMaxDatastoreSizeForVmfsOption:h,getRescanWarning:b,getStorageArrayTypePolicyName:f,formatPathSelectionPolicyLabel:C,getPathSelectionPolicyNameByKey:P,isFixedPolicy:D,isFreePartition:w,formatPathSelectionPolicyName:S,is4kDevice:y,getScsiPeTransport:I,getPEOperationalStateString:E,showErrorDialog:M,getSectorFormatByScsiDiskType:T}}])}();var storage_ui;!function(e){var t=function(){function e(e){this.i18nService=e,this.VALID_DNS_NAME_REG_EX=new RegExp("^[\\w.-]+$"),this.PORT_MAX_NUMBER=65535,this.FORWARD_SLASH="/",this.BACK_SLASH="\\"}return e.prototype.isValidDnsName=function(e){return this.VALID_DNS_NAME_REG_EX.test(e)},e.prototype.isValidPort=function(e){return e>0&&e<=this.PORT_MAX_NUMBER},e.prototype.validateDatastoreBrowserItemName=function(e){return e.indexOf(this.FORWARD_SLASH)!==-1?[this.i18nService.getString("StorageUi","renameFile.invalidCharsWarning",this.FORWARD_SLASH)]:e.indexOf(this.BACK_SLASH)!==-1?[this.i18nService.getString("StorageUi","renameFile.invalidCharsWarning",this.BACK_SLASH)]:[]},e.$inject=["i18nService"],e}();e.StorageValidationService=t,angular.module("com.vmware.vsphere.client.storage").service("storageValidationService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.vuiConstants=t,this.dataService=i,this.columnRenderersRegistry=r,this.storageUtil=n,this.navigation=o,this.defaultUriSchemeUtil=a,this.i18n=e.getString,this.liveRefreshProperties=["datastore","summary","host"]}return e.prototype.$onInit=function(){this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.NONE,data:[],resizable:!0},this.refresh()},e.prototype.refresh=function(){var e=this;this.deviceInfoLoading=!0,this.loading=!0,this.clusterId=this.navigation.getRoute().objectId,this.dataService.getProperties(this.clusterId,["clusterStorageAdaptersOverview"]).then(function(t){var i=t&&t.clusterStorageAdaptersOverview&&t.clusterStorageAdaptersOverview.hostStorageAdaptersData;if(e.deviceInfoLoading){var r=[];_.forEach(i,function(t){var i={};e.assignOverviewData(i,t),r.push(i)}),e.datagridOptions.data=r}else e.overrideOverviewData(i)})["finally"](function(){e.loading=!1}),this.dataService.getProperties(this.clusterId,["clusterStorageAdaptersDeviceInfo"],{skipLoadingNotification:!0}).then(function(t){var i=t&&t.clusterStorageAdaptersDeviceInfo&&t.clusterStorageAdaptersDeviceInfo.hostStorageAdaptersData;if(!i)return void e.handleMissingDeviceInfo();if(e.loading){var r=[];_.forEach(i,function(t){var i={};e.assignDeviceInfoData(i,t),r.push(i)}),e.datagridOptions.data=r}else e.overrideDeviceInfoData(i)},function(){e.handleMissingDeviceInfo()})["finally"](function(){e.deviceInfoLoading=!1})},e.prototype.getCountDetailsSignPostConfig=function(e,t,i){var r=this;if(t){var n="";return t[i]&&_.forEach(t[i],function(e){n&&(n+="<br>"),n+=r.i18n("StorageUi","cluster.adapters.list.countDetailsFormat",e.statusName,e.count)}),{title:e,message:n}}},e.prototype.getColumnDefinitions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("object-name"),i=this.columnRenderersRegistry.getColumnRenderer("text"),r=this.storageUtil.compareNumericValues,n=function(t,r,n,o){if(e.deviceInfoLoading)return'<span class="spinner spinner-sm"></span>';if(void 0===t&&void 0===r)return n[o]=e.i18nService.getString("StorageUi","cluster.adapters.list.noValue"),i([o],n);var a=i(["countData"],{countData:e.i18n("StorageUi","cluster.adapters.list.aggregatedCountFormat",t,r)});if(!n[o])return a;var s='<span class="vx-icon-info_normal" vui-sign-post="dataItem.'+o+'" </span>';return a+s},o=function(t,r){return e.deviceInfoLoading?'<span class="spinner spinner-sm"></span>':(t[r]=void 0!==t[r]?t[r]:e.i18nService.getString("StorageUi","cluster.adapters.list.noValue"),i([r],t))};return[{displayName:this.i18nService.getString("StorageUi","cluster.adapters.list.nameColumn"),field:"name",width:"200px",template:function(i){return t(["hostId","iconId","name","labelIds"],{hostId:e.defaultUriSchemeUtil.getVsphereObjectId(i.hostRef),iconId:i.iconId,name:i.name,labelIds:i.labelIds},{navigatable:!0})}},{displayName:this.i18nService.getString("StorageUi","cluster.adapters.list.adaptersColumn"),field:"numberOfStorageAdapters",width:"100px",template:function(e){return o(e,"numberOfStorageAdapters")},sortable:function(e,t){return r(e,t,"numberOfStorageAdapters")}},{displayName:this.i18nService.getString("StorageUi","cluster.adapters.list.targetsColumn"),field:"numberOfTargets",width:"100px",template:function(e){return o(e,"numberOfTargets")},sortable:function(e,t){return r(e,t,"numberOfTargets")}},{displayName:this.i18nService.getString("StorageUi","cluster.adapters.list.devicesColumn"),field:"numberOfAttachedDevices",width:"150px",template:function(e){return n(e.numberOfAttachedDevices,e.totalNumberOfDevices,e,"devicesCountDetails")},sortable:function(e,t){return r(e,t,"numberOfAttachedDevices")}},{displayName:this.i18nService.getString("StorageUi","cluster.adapters.list.pathsColumn"),field:"numberOfActivePaths",width:"150px",template:function(e){return n(e.numberOfActivePaths,e.totalNumberOfPaths,e,"pathsCountDetails")},sortable:function(e,t){return r(e,t,"numberOfActivePaths")}},{displayName:this.i18nService.getString("StorageUi","cluster.adapters.list.datastoresColumn"),field:"numberOfDatastores",width:"100px",template:function(e){return i(["numberOfDatastores"],e)},sortable:function(e,t){return r(e,t,"numberOfDatastores")}}]},e.prototype.overrideDeviceInfoData=function(e){var t=this,i=[];this.datagridOptions.data.forEach(function(r){var n=t.defaultUriSchemeUtil.getVsphereObjectId(r.hostRef),o=_.find(e,function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef)===n});o&&t.assignDeviceInfoData(r,o),i.push(Object.assign({},r))}),this.datagridOptions.data=i},e.prototype.overrideOverviewData=function(e){var t=this,i=[];this.datagridOptions.data.forEach(function(r){var n=t.defaultUriSchemeUtil.getVsphereObjectId(r.hostRef),o=_.find(e,function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef)===n});o&&t.assignOverviewData(r,o),i.push(Object.assign({},r))}),this.datagridOptions.data=i},e.prototype.assignDeviceInfoData=function(e,t){return t?(e.hostRef=t.hostRef,e.numberOfActivePaths=t.numberOfActivePaths,e.numberOfAttachedDevices=t.numberOfAttachedDevices,e.numberOfStorageAdapters=t.numberOfStorageAdapters,e.numberOfTargets=t.numberOfTargets,e.pathsCountByStatus=t.pathsCountByStatus,e.totalNumberOfDevices=t.totalNumberOfDevices,e.totalNumberOfPaths=t.totalNumberOfPaths,e.pathsCountDetails=void 0,t.numberOfActivePaths!==t.totalNumberOfPaths&&(e.pathsCountDetails=this.getCountDetailsSignPostConfig(this.i18n("StorageUi","cluster.adapters.list.pathDetails"),t,"pathsCountByStatus")),e.devicesCountDetails=void 0,void(t.numberOfAttachedDevices!==t.totalNumberOfDevices&&(e.devicesCountDetails=this.getCountDetailsSignPostConfig(this.i18n("StorageUi","cluster.adapters.list.deviceDetails"),t,"devicesCountByStatus")))):(e.numberOfActivePaths=void 0,e.numberOfAttachedDevices=void 0,e.numberOfStorageAdapters=void 0,e.numberOfTargets=void 0,e.pathsCountByStatus=void 0,e.totalNumberOfDevices=void 0,e.totalNumberOfPaths=void 0,e.pathsCountDetails=void 0,void(e.devicesCountDetails=void 0))},e.prototype.assignOverviewData=function(e,t){e.hostRef=t.hostRef,e.iconId=t.iconId,e.labelIds=t.labelIds,e.name=t.name,e.numberOfDatastores=t.numberOfDatastores},e.prototype.getNoValueString=function(){return this.i18n("StorageUi","cluster.adapters.list.noValue")},e.prototype.handleMissingDeviceInfo=function(){var e=this;this.datagridOptions.data&&this.datagridOptions.data.length&&(_.forEach(this.datagridOptions.data,function(t){e.assignDeviceInfoData(t)}),this.datagridOptions.data=[].concat(this.datagridOptions.data))},e.$inject=["i18nService","vuiConstants","dataService","columnRenderersRegistry","storageUtil","navigation","defaultUriSchemeUtil"],e}();e.ClusterStorageAdaptersOverview=t,angular.module("com.vmware.vsphere.client.storage").component("clusterStorageAdaptersOverview",{templateUrl:"storage-ui/resources/storage/views/cluster/adapters/ClusterStorageAdaptersOverview.html",controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i,this.dataService=r,this.$q=n,this.columnRenderersRegistry=o,this.vuiConstants=a,this.haAffectedClustersProperty="datastore:haHeartbeatAffectedClusters"}return e.prototype.checkForAffectedClusters=function(e,t){var i=this,r=this.$q.defer();return this.dataService.getProperties(e,[this.haAffectedClustersProperty],{propertyParams:[{propertyName:this.haAffectedClustersProperty,parameterType:"com.vmware.vsphere.client.h5.storage.spec.HeartbeatDatastoreSpec",parameter:{hostsToRemove:t}}]}).then(function(e){var t=e&&e[i.haAffectedClustersProperty]?e[i.haAffectedClustersProperty]:[];if(t.length){var n=i.columnRenderersRegistry.getColumnRenderer("icon-text"),o={title:i.i18nService.getString("StorageUi","unmountDatastoreHaWarning"),contentTemplate:"storage-ui/resources/storage/views/datastore/affectedHeartbearClusterDialog.html",dialogData:{i18n:i.i18nService.getString,gridOptions:{selectionMode:i.vuiConstants.grid.selectionMode.SINGLE,height:"100%",resizable:!0,columnDefs:[{displayName:i.i18nService.getString("StorageUi","unmountDatastoreHaGridNameColumn"),field:"name",template:function(e){var t={icon:"vsphere-icon-cluster",text:e.name};return n(["icon","text"],t)}}],data:t}},onSubmit:function(){return r.resolve(!0),!0},onCancel:function(){r.resolve(!1)}};i.clarityModalService.openOkCancelModal(o)}else r.resolve(!0);return r.promise},function(){return r.resolve(!0),r.promise})},e.$inject=["i18nService","clarityModalService","clarityConstants","dataService","$q","columnRenderersRegistry","vuiConstants"],e}();e.AffectHeartbeatDatastoreService=t,angular.module("com.vmware.vsphere.client.storage").service("affectHeartbeatDatastoreService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this.bindings={modalOptions:"<"},this.controller=i,this.templateUrl="storage-ui/resources/storage/views/datastore/DatastoreConfigIOControl.html"}return e}();e.DatastoreConfigIoControl=t;var i=function(){function e(e,t,i){this.i18nService=e,this.dialogService=t,this.clarityConstants=i,this.loading=!1,this.hasError=!1,this.i18n=this.i18nService.getString.bind(null,"StorageUi"),this.i18nCommon=this.i18nService.getString.bind(null,"Common")}return e.prototype.$onInit=function(){var e=this;e.loading=!0,e.percentageThresholdLabel=e.i18n("datastore.editCapabilitiesForm.percentPeakThroughputThreshold"),e.manualThresholdLabel=e.i18n("datastore.editCapabilitiesForm.manualThreshold"),e.modalOptions.dialogData.datastoreConfigIOControlDialogDataPromise.then(function(t){e.dialogData=t,e.modalOptions.dialogData.datastoreConfigIOControlDialogData=t,e.percentageThresholdRecommendedValues=[e.nameValuePair("datastore.editCapabilitiesForm.percentPeakThroughput.values.minimum",e.dialogService.CONGESTION_THRESHOLD_PERCENT_MIN),e.nameValuePair("datastore.editCapabilitiesForm.percentPeakThroughput.values.recommended",e.dialogService.CONGESTION_THRESHOLD_DEFAULT_PERCENT_PEAK_VALUE),e.nameValuePair("datastore.editCapabilitiesForm.percentPeakThroughput.values.maximum",e.dialogService.CONGESTION_THRESHOLD_PERCENT_MAX)],e.percentageThresholdErrorMessages={min:e.dialogService.percentThresholdValidationError(),max:e.dialogService.percentThresholdValidationError()},e.manualThresholdErrorMessages={max:e.dialogService.manualThresholdValidationError(t.minManualCongestionThreshold),min:e.dialogService.manualThresholdValidationError(t.minManualCongestionThreshold)},e.manualThresholdRecommendedValues=[e.nameValuePair("datastore.editCapabilitiesForm.customThreshold.values.minimum",t.minManualCongestionThreshold),e.nameValuePair("datastore.editCapabilitiesForm.customThreshold.values.recommended",e.dialogService.CONGESTION_THRESHOLD_DEFAULT_MANUAL_VALUE),e.nameValuePair("datastore.editCapabilitiesForm.customThreshold.values.maximum",e.dialogService.CONGESTION_THRESHOLD_MANUAL_MAX)],e.showCongestionAlert()},function(t){var i=e.i18nService.getString("StorageUi","storage.failedToRetrieveDataError");t&&t.data&&t.data.message&&(i+=" "+t.data.message),e.modalOptions.alerts=[{text:i,type:e.clarityConstants.notifications.type.ERROR}],e.dialogData=e.dialogService.getDefaultDialogData(),e.hasError=!0})["finally"](function(){e.loading=!1})},e.prototype.showCongestionAlert=function(){this.dialogData.selectedCongestionThresholdOption===this.dialogService.congestionThresholdOptions.MANUAL&&this.dialogData.selectedSiocOption===this.dialogService.siocOptions.ENABLE_SOIC_ENABLED_STATISTIC?this.modalOptions.alerts=[{text:this.i18n("datastore.editCapabilitiesForm.warning"),type:this.clarityConstants.notifications.type.WARNING}]:this.modalOptions.alerts=[]},e.prototype.resetDefaults=function(){this.dialogService.resetCongestionThresholdValues(this.dialogData),this.showCongestionAlert()},e.prototype.nameValuePair=function(e,t){return{name:this.i18n(e),value:t}},e.$inject=["i18nService","datastoreConfigIOControlDialogService","clarityConstants"],e}();angular.module("com.vmware.vsphere.client.storage").component("datastoreConfigIoControl",new t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){}return e}();e.DatastoreConfigIOControlDialogData=t;var i=function(){function e(e,t,i,r,n,o){this.$q=e,this.dataService=t,this.clarityModalService=i,this.mutationService=r,this.i18nService=n,this.clarityConstants=o,this.CONGESTION_THRESHOLD_DEFAULT_PERCENT_PEAK_VALUE=90,this.CONGESTION_THRESHOLD_PERCENT_MIN=50,this.CONGESTION_THRESHOLD_PERCENT_MAX=100,this.CONGESTION_THRESHOLD_DEFAULT_MANUAL_VALUE=30,this.CONGESTION_THRESHOLD_MANUAL_MIN=5,this.CONGESTION_THRESHOLD_MANUAL_MAX=100,this.siocOptions={ENABLE_SOIC_ENABLED_STATISTIC:"ENABLE_SOIC_ENABLED_STATISTIC",DISABLE_SOIC_ENABLE_STATISTIC:"DISABLE_SOIC_ENABLE_STATISTIC",DISABLE_SOIC_DISABLE_STATISTICS:"DISABLE_SOIC_DISABLE_STATISTICS"},this.congestionThresholdOptions={PERCENT:"CONGESTION_THRESHOLD_PERCENT",MANUAL:"CONGESTION_THRESHOLD_MANUAL"},this.PROP_MINIMUM_CONGESTION_THRESHOLD="capability/minimumCongestionThresholdInMs"}return e.prototype.getDialogData=function(e){var i=this;if(e&&e.length){var r=[this.PROP_MINIMUM_CONGESTION_THRESHOLD],n=e.length>1;return n||r.push("iormConfiguration"),this.dataService.getPropertiesForObjects(e,r).then(function(e){var r=i.getDefaultDialogData(),o=-1;if(_.each(e,function(e){!n&&e.iormConfiguration&&(r=e.iormConfiguration),e[i.PROP_MINIMUM_CONGESTION_THRESHOLD]&&e[i.PROP_MINIMUM_CONGESTION_THRESHOLD]>o&&(o=e[i.PROP_MINIMUM_CONGESTION_THRESHOLD])}),o>-1&&(r.minManualCongestionThreshold=o),n)return r;var a=new t;return r.enabled?a.selectedSiocOption=i.siocOptions.ENABLE_SOIC_ENABLED_STATISTIC:r.statsCollectionEnabled?a.selectedSiocOption=i.siocOptions.DISABLE_SOIC_ENABLE_STATISTIC:a.selectedSiocOption=i.siocOptions.DISABLE_SOIC_DISABLE_STATISTICS,a.enabledSdrsStatisticsForEnabledIoC=!r.statsAggregationDisabled,a.enabledSdrsStatisticsForDisabledIoC=!r.statsAggregationDisabled,a.manualCongestionThreshold=r.congestionThreshold,a.percentageCongestionThreshold=r.percentOfPeakThroughput,o>-1?a.minManualCongestionThreshold=o:a.minManualCongestionThreshold=i.CONGESTION_THRESHOLD_MANUAL_MIN,"manual"===r.congestionThresholdMode?a.selectedCongestionThresholdOption=i.congestionThresholdOptions.MANUAL:a.selectedCongestionThresholdOption=i.congestionThresholdOptions.PERCENT,a})}return this.$q.when(this.getDefaultDialogData())},e.prototype.resetCongestionThresholdValues=function(e){e.selectedCongestionThresholdOption=this.congestionThresholdOptions.PERCENT,e.manualCongestionThreshold=this.CONGESTION_THRESHOLD_DEFAULT_MANUAL_VALUE,e.percentageCongestionThreshold=this.CONGESTION_THRESHOLD_DEFAULT_PERCENT_PEAK_VALUE},e.prototype.getDefaultDialogData=function(){var e=new t;return e.selectedSiocOption=this.siocOptions.DISABLE_SOIC_DISABLE_STATISTICS,e.selectedCongestionThresholdOption=this.congestionThresholdOptions.PERCENT,e.enabledSdrsStatisticsForEnabledIoC=!0,e.enabledSdrsStatisticsForDisabledIoC=!0,e.manualCongestionThreshold=this.CONGESTION_THRESHOLD_DEFAULT_MANUAL_VALUE,e.percentageCongestionThreshold=this.CONGESTION_THRESHOLD_DEFAULT_PERCENT_PEAK_VALUE,e.minManualCongestionThreshold=this.CONGESTION_THRESHOLD_MANUAL_MIN,e},e.prototype.buildIORMConfigSpec=function(e){var t={_type:"com.vmware.vim.binding.vim.StorageResourceManager$IORMConfigSpec"};switch(e.selectedSiocOption){case this.siocOptions.ENABLE_SOIC_ENABLED_STATISTIC:t.enabled=!0,t.statsCollectionEnabled=!0,e.selectedCongestionThresholdOption===this.congestionThresholdOptions.PERCENT?(t.percentOfPeakThroughput=e.percentageCongestionThreshold,t.congestionThresholdMode="automatic",t.congestionThreshold=this.CONGESTION_THRESHOLD_DEFAULT_MANUAL_VALUE):(t.congestionThresholdMode="manual",t.congestionThreshold=e.manualCongestionThreshold),t.statsAggregationDisabled=!e.enabledSdrsStatisticsForEnabledIoC;break;case this.siocOptions.DISABLE_SOIC_ENABLE_STATISTIC:t.enabled=!1,t.statsCollectionEnabled=!0,t.statsAggregationDisabled=!e.enabledSdrsStatisticsForDisabledIoC;break;case this.siocOptions.DISABLE_SOIC_DISABLE_STATISTICS:t.enabled=!1,t.statsCollectionEnabled=!1,t.statsAggregationDisabled=!0;break;default:return null}return t},e.prototype.validateDatastoreConfigIOControlDialogData=function(e,t){var i=this,r=_.filter(t.alerts,function(e){return e.type===i.clarityConstants.notifications.type.WARNING});if(e.selectedSiocOption===this.siocOptions.ENABLE_SOIC_ENABLED_STATISTIC)if(e.selectedCongestionThresholdOption===this.congestionThresholdOptions.PERCENT){if(!this.numberInRange(e.percentageCongestionThreshold,this.CONGESTION_THRESHOLD_PERCENT_MIN,this.CONGESTION_THRESHOLD_PERCENT_MAX))return t.alerts=[{text:this.percentThresholdValidationError(),type:this.clarityConstants.notifications.type.ERROR}].concat(r),!1}else if(!this.numberInRange(e.manualCongestionThreshold,e.minManualCongestionThreshold,this.CONGESTION_THRESHOLD_MANUAL_MAX))return t.alerts=[{text:this.manualThresholdValidationError(e.minManualCongestionThreshold),type:this.clarityConstants.notifications.type.ERROR}].concat(r),!1;return t.alerts=r,!0},e.prototype.numberInRange=function(e,t,i){return e>=t&&e<=i},e.prototype.show=function(e){var t=this,i={contentTemplate:"storage-ui/resources/storage/views/datastore/DatastoreConfigIOControlDialog.html",title:this.i18nService.getString("StorageUi","datastore.editCapabilitiesForm.title"),defaultButton:"submit",size:"lg",onSubmit:function(){if(!i.dialogData.datastoreConfigIOControlDialogData)return!1;if(!t.validateDatastoreConfigIOControlDialogData(i.dialogData.datastoreConfigIOControlDialogData,i))return!1;var r=t.buildIORMConfigSpec(i.dialogData.datastoreConfigIOControlDialogData);return!!r&&(t.mutationService.applyOnMultiEntity(e,r._type,r),!0)},dialogData:{datastoreConfigIOControlDialogDataPromise:this.getDialogData(e)}};1===e.length&&(i.subTitle={objectId:e[0]}),this.clarityModalService.openOkCancelModal(i)},e.prototype.manualThresholdValidationError=function(e){return this.i18nService.getString("StorageUi","datastore.editCapabilitiesForm.customThreshold.errorInvalidValue",e,this.CONGESTION_THRESHOLD_MANUAL_MAX)},e.prototype.percentThresholdValidationError=function(){return this.i18nService.getString("StorageUi","datastore.editCapabilitiesForm.percentPeakThroughput.errorInvalidValue",this.CONGESTION_THRESHOLD_PERCENT_MIN,this.CONGESTION_THRESHOLD_PERCENT_MAX)},e.$inject=["$q","dataService","clarityModalService","mutationService","i18nService","clarityConstants"],e}();e.DatastoreConfigIOControlDialogService=i,angular.module("com.vmware.vsphere.client.storage").service("datastoreConfigIOControlDialogService",i)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(e,t){
var i=$("<span/>").addClass("vertical-align-cell").text(e);return t||i.addClass("disabled-text"),i[0].outerHTML}var s=this;s.datastoreId=e.modalOptions.dialogData.datastoreId,s.availableHostPropertyName=e.modalOptions.dialogData.availableHostPropertyName,s.headerHtmlUrl=e.modalOptions.dialogData.headerHtmlUrl,s.loading=!0,s.datagridOptions={resizable:!0,height:"100%",selectionMode:i.grid.selectionMode.MULTI,selectedItems:[],pageConfig:{displayMode:i.grid.displayMode.VIRTUAL_SCROLLING},columnDefs:[{displayName:r.getString("StorageUi","modifyDatastoreForm.hostColumnHeader"),field:"formattedName",template:function(e){return'<div><span class="vsphere-icon-host"></span>'+a(e.formattedName,e.isOperationAllowed)+"</div>"}},{displayName:r.getString("StorageUi","modifyDatastoreForm.clusterColumnHeader"),field:"clusterName",template:function(e){return e.clusterName?'<div><span class="vsphere-icon-cluster"></span>'+a(e.clusterName,e.isOperationAllowed)+"</div>":""}}],data:[],isItemDisabledCallback:function(e){return!e.isOperationAllowed}},e.$watch(function(){return s.datagridOptions.selectedItems},function(t,i){t!==i&&(e.modalOptions.dialogData.selectedHosts=t)}),t.getProperties(s.datastoreId,[s.availableHostPropertyName]).then(function(t){var i=t?t[s.availableHostPropertyName]||{}:{},r=i.availableHosts||[];s.datagridOptions.data=r,e.modalOptions.dialogData.allHosts=r},function(t){e.modalOptions.dialogData.errorApi.showError(t)})["finally"](function(){s.loading=!1,n(function(){var e=o.find("input");e&&e[0]&&e[0].focus()},1)})}angular.module("com.vmware.vsphere.client.storage").controller("ModifyDatastoreDialogController",e),e.$inject=["$scope","dataService","vuiConstants","i18nService","$timeout","$element"]}(),function(){"use strict";function e(e,t,i,r){function n(n,o,a,s,c){function l(t){function l(){return p.dialogData.selectedHosts&&p.dialogData.selectedHosts.length?s(p.dialogData.selectedHosts,p.dialogData.allHosts.length===p.dialogData.selectedHosts.length):(d(i.getString("StorageUi","modifyDatastoreForm.noSelection")),!1)}function d(e){p.alerts=[{text:e,type:r.notifications.type.ERROR}]}function u(){p.alerts=[]}var p={title:o,subTitle:{text:t},defaultButton:"submit",size:"lg",alerts:[],contentTemplate:"storage-ui/resources/storage/views/datastore/ModifyDatastoreDialog.html",onSubmit:l};p.dialogData={datastoreId:n,selectedHosts:[],availableHostPropertyName:a,headerHtmlUrl:c,errorApi:{showError:d,clearErrors:u}},e.openOkCancelModal(p)}t.getProperties(n,["name"]).then(function(e){var t=e?e.name:null;l(t)},function(){l(null)})}function o(t,i,r,n){var o={title:i,message:r,defaultButton:"submit",alerts:[],preserveNewlines:!0,submit:function(){return n()}};o.dialogData={datastoreIds:t},e.openConfirmationModal(o)}return{openModifyDatastoreDialog:n,openRemoveDatastoreDialog:o}}angular.module("com.vmware.vsphere.client.storage").service("modifyDatastoreDialogService",e),e.$inject=["clarityModalService","dataService","i18nService","clarityConstants"]}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.moveDatastoreToService=t,this.defaultUriSchemeUtil=i,this.dataService=r,this.vuiConstants=n,this.i18nService=o,this.loading=!0,this.datastoreIds=e.modalOptions.dialogData.objectIds,_.isEmpty(this.datastoreIds)||(this.rootObjId=this.datastoreIds[0]),e.modalOptions.onSubmit=function(){e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,a.sourcesAndTargetIds.push(a.entityToMoveDatastoreTo),a.moveDatastoreToService.checkPrivileges(a.sourcesAndTargetIds).then(function(i){if(i&&0!==i.length){var r=void 0;r=_.contains(i,a.entityToMoveDatastoreTo)?1===i.length?a.i18nService.getString("StorageUi","moveTo.noPermissionsOnTarget"):a.i18nService.getString("StorageUi","moveTo.noPermissions"):a.i18nService.getString("StorageUi","moveTo.noPermissionsOnSource"),a.$scope.modalOptions.alerts=[{type:a.vuiConstants.validationBanner.type.ERROR,text:r}],a.$scope.modalOptions.isAlertClosed=!1}else t.moveDatastoreTo(a.entityToMoveDatastoreTo,a.datastoreIds),e.closeModal()})},this.onLocationSelected=function(e){a.entityToMoveDatastoreTo=e},this.getData()}return e.prototype.getData=function(){var e=this;this.dataService.getPropertiesForObjects(this.datastoreIds,["parent"]).then(function(t){t&&(e.sourcesAndTargetIds=_.map(e.datastoreIds,function(i){return e.defaultUriSchemeUtil.getVsphereObjectId(t[i].parent)}),(i=e.sourcesAndTargetIds).push.apply(i,e.datastoreIds)),e.loading=!1;var i})},e.$inject=["$scope","moveDatastoreToService","defaultUriSchemeUtil","dataService","vuiConstants","i18nService"],e}();angular.module("com.vmware.vsphere.client.storage").controller("moveDatastoreToDialogController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("StorageUi","storage.pe.propertiesTab.header"),templateUrl:"storage-ui/resources/storage/views/datastore/protocolEndpoints/properties/ProtocolEndpointsGeneral.html",uid:"datastore.pe.generalTab"},{name:this.i18nService.getString("StorageUi","storage.pe.hostsTab.header"),templateUrl:"storage-ui/resources/storage/views/datastore/protocolEndpoints/hostMountData/ProtocolEndpointsHostMountData.html",uid:"datastore.pe.hostTab",metadata:{relevantFor:"isScsiPE"}}])}}return e.$inject=["i18nService","$q"],e}();angular.module("com.vmware.vsphere.client.storage").controller("DatastoreProtocolEndpointsMasterDetailsViewController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i){if(this.hostUrl=t||"",i){var r=i.underlyingLun;this.identifier=r.canonicalName||"",this.location=r.deviceName||"",this.lun=String(i.lunNumber),this.operationalState=e.getPEOperationalStateString(i),this.transport=e.getScsiPeTransport(i),this.owner=i.ownerPlugin||""}}return e}();e.DatastoreProtocolEndpointHostsListItem=t;var i=function(){function e(e,t,i,r,n){this.vuiConstants=e,this.i18nService=t,this.dataService=i,this.navigation=r,this.storageUtil=n,this.DATASTORE_ENDPOINTS_HOST_DATA="datastoreProtocolEndpointHostData",this.initDatagrid()}return e.prototype.$onChanges=function(){var e=this;if(this.selectedItems&&this.selectedItems.length){var i=[{propertyName:this.DATASTORE_ENDPOINTS_HOST_DATA,parameterType:"java.lang.String",parameter:this.selectedItems[0].identifier}];this.dataService.getProperties(this.navigation.getRoute().objectId,this.DATASTORE_ENDPOINTS_HOST_DATA,{propertyParams:i}).then(function(i){e.datagridOptions.data=_.map(i[e.DATASTORE_ENDPOINTS_HOST_DATA],function(i){return new t(e.storageUtil,i.hostURL,i.peData)})})}},e.prototype.initDatagrid=function(){this.datagridOptions={resizable:!0,height:"100%",columnDefs:this.getColumnDefs(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[]}},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("StorageUi","storage.pe.datastores.hostUrl"),field:"name",width:"120",template:"#:hostUrl#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.identifier"),field:"identifier",width:"180px",template:"#:identifier#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.location"),field:"location",width:"220px",template:"#:location#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.lun"),field:"lun",width:"60px",template:"#:lun#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.opState"),field:"operationalState",width:"120px",template:"#:operationalState#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.transport"),field:"transport",width:"80px",template:"#:transport#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.owner"),field:"owner",width:"80px",template:"#:owner#"}]},e.$inject=["vuiConstants","i18nService","dataService","navigation","storageUtil"],e}();angular.module("com.vmware.vsphere.client.storage").component("protocolEndpointsHostMountData",{controller:i,templateUrl:"storage-ui/resources/storage/views/datastore/protocolEndpoints/hostMountData/ProtocolEndpointsHostMountComponent.html",bindings:{selectedItems:"<"}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.dataService=t,this.vxPropertyViewService=i,this.vuiConstants=r,this.datastoreConstants=n,this.propertyViewData={}}return e.prototype.$onInit=function(){this.buildPropertyView()},e.prototype.$onChanges=function(){this.updatePropertyView()},e.prototype.buildPropertyView=function(){if(this.selectedItemData&&this.selectedItemData.length){var e=this.selectedItemData[0],t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category(this.i18nService.getString("StorageUi","storage.pe.properties.generalHeader")),r=i.section("generalSection");r.title(this.i18nService.getString("StorageUi","storage.pe.properties.generalHeader")).property(this.i18nService.getString("StorageUi","storage.pe.runtimeName"),e.name).property(this.i18nService.getString("StorageUi","storage.pe.type"),e.type).property(this.i18nService.getString("StorageUi","storage.pe.identifier"),e.identifier),e.type===this.datastoreConstants.datastoreTypes.NFS&&r.property(this.i18nService.getString("StorageUi","storage.pe.server"),e.server).property(this.i18nService.getString("StorageUi","storage.pe.folder"),e.folder),r.property(this.i18nService.getString("StorageUi","storage.pe.array"),e.storageArray),this.propertyViewData=t.build()}},e.prototype.updatePropertyView=function(){this.selectedItemData&&this.selectedItemData.length?this.buildPropertyView():this.propertyViewData={}},e.$inject=["i18nService","dataService","vxPropertyViewService","vuiConstants","datastoreConstants"],e}();angular.module("com.vmware.vsphere.client.storage").component("protocolEndpointsGeneral",{controller:t,templateUrl:"storage-ui/resources/storage/views/datastore/protocolEndpoints/properties/ProtocolEndpointsGeneralComponentView.html",bindings:{selectedItemData:"<"}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.i18nService=e,this.dataService=t,this.datastoreConstants=i,this.vuiConstants=r,this.PROPERTY_NAME="datastoreProtocolEndpointsData",this.formatRawData=function(e){var t={};switch(t.storageArray=e.storageArray||"",t.identifier=e.uuid||"",t.isScsiPE=n.datastoreConstants.protocolEndpoint.type.block===e.peType,e.peType){case n.datastoreConstants.protocolEndpoint.type.block:t.name=e.deviceId||"",t.type=n.i18nService.getString("StorageUi","storage.pe.type.block");break;case n.datastoreConstants.protocolEndpoint.type.nas:t.name=n.i18nService.getString("StorageUi","storage.pe.nas.format",e.nfsServer||"",e.nfsDir||""),t.type=n.i18nService.getString("StorageUi","storage.pe.type.nas"),t.folder=e.nfsDir,t.server=e.nfsServer}return t}}return e.prototype.$onInit=function(){var e=this;this.initDatagrid(),this.dataService.getProperties(this.datastoreRef,this.PROPERTY_NAME).then(function(t){e.datagridOptions.data=_.map(t[e.PROPERTY_NAME],e.formatRawData)})},e.prototype.initDatagrid=function(){var e=this;this.datagridOptions={resizable:!0,height:"100%",columnDefs:this.getColumnDefs(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,onChange:function(){var t=e.datagridOptions.selectedItems;t&&t.length?e.selectedItem=t:e.selectedItem=[]},selectedItems:[]}},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("StorageUi","storage.pe.name"),field:"name",width:"300px",template:"#:name#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.type"),field:"type",width:"80px",template:"#:type#"},{displayName:this.i18nService.getString("StorageUi","storage.pe.array"),field:"array",template:"#:storageArray#"}]},e.$inject=["i18nService","dataService","datastoreConstants","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.storage").component("protocolEndpoints",{controller:t,templateUrl:"storage-ui/resources/storage/views/datastore/protocolEndpoints/ProtocolEndpointsComponent.html",bindings:{datastoreRef:"<",selectedItem:"="}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.navigation=e}return e.prototype.getContextObject=function(){return this.navigation.getRoute().objectId},e.$inject=["navigation"],e}();angular.module("com.vmware.vsphere.client.storage").controller("ProtocolEndpointsController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this.bindings={showDynamicUnmapOption:"<",vmfsConfigOption:"<",unmapBandwidthSpec:"<"},this.controller=i,this.templateUrl="storage-ui/resources/storage/views/datastore/spacereclamation/DatastoreSpaceReclamationBandwidthControl.html"}return e}();e.DatastoreSpaceReclamationBandwidthControl=t;var i=function(){function e(e,t){this.i18nService=e,this.reclamationBandwidthService=t,this.selectedFixedUnmapRateItem=null,this.selectedDynamicMinRateItem=null,this.selectedDynamicMaxRateItem=null,this.FIXED_UNMAP_OPTION="fixed",this.DYNAMIC_UNMAP_OPTION="dynamic",this.DISABLED_UNMAP_OPTION="disabled",this.i18n=this.i18nService.getString}return e.prototype.updateSpec=function(){this.unmapBandwidthSpec.policy=this.selectedUnmapOption,this.selectedFixedUnmapRateItem&&(this.unmapBandwidthSpec.fixedValue=this.selectedFixedUnmapRateItem.rate),this.showDynamicUnmapOption&&(this.selectedDynamicMinRateItem&&(this.unmapBandwidthSpec.dynamicMin=this.selectedDynamicMinRateItem.rate),this.selectedDynamicMaxRateItem&&(this.unmapBandwidthSpec.dynamicMax=this.selectedDynamicMaxRateItem.rate))},e.prototype.$onChanges=function(){this.initData()},e.prototype.initData=function(){this.fixedRateItems=this.reclamationBandwidthService.generateRateItems(this.vmfsConfigOption.unmapBandwidthFixedValue,this.vmfsConfigOption.unmapBandwidthIncrement),this.selectedFixedUnmapRateItem=this.reclamationBandwidthService.findRateItem(this.fixedRateItems,this.unmapBandwidthSpec.fixedValue,!0),this.showDynamicUnmapOption&&(this.dynamicMinRateItems=this.reclamationBandwidthService.generateRateItems(this.vmfsConfigOption.unmapBandwidthDynamicMin,this.vmfsConfigOption.unmapBandwidthIncrement),this.selectedDynamicMinRateItem=this.reclamationBandwidthService.findRateItem(this.dynamicMinRateItems,this.unmapBandwidthSpec.dynamicMin,!0),this.dynamicMaxRateItems=this.reclamationBandwidthService.generateRateItems(this.vmfsConfigOption.unmapBandwidthDynamicMax,this.vmfsConfigOption.unmapBandwidthIncrement),this.selectedDynamicMaxRateItem=this.reclamationBandwidthService.findRateItem(this.dynamicMaxRateItems,this.unmapBandwidthSpec.dynamicMax,!0)),this.unmapBandwidthSpec.policy===this.FIXED_UNMAP_OPTION?this.selectedUnmapOption=this.FIXED_UNMAP_OPTION:this.unmapBandwidthSpec.policy===this.DYNAMIC_UNMAP_OPTION&&this.showDynamicUnmapOption?this.selectedUnmapOption=this.DYNAMIC_UNMAP_OPTION:this.selectedUnmapOption=this.DISABLED_UNMAP_OPTION},e.$inject=["i18nService","datastoreSpaceReclamationBandwidthService"],e}();angular.module("com.vmware.vsphere.client.storage").component("datastoreSpaceReclamationBandwidthControl",new t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.validateUnmapBandwidthSpec=function(t){if(t.policy===e.DYNAMIC_METHOD){if(!_.isNumber(t.dynamicMin))return this.i18nService.getString("StorageUi","datastore.manage.general.spaceReclamation.dynamic.invalidMinBandwidth");if(!_.isNumber(t.dynamicMax))return this.i18nService.getString("StorageUi","datastore.manage.general.spaceReclamation.dynamic.invalidMaxBandwidth");if(t.dynamicMin>t.dynamicMax)return this.i18nService.getString("StorageUi","datastore.manage.general.spaceReclamation.dynamic.minBandwidthBiggerThanMax")}else if(t.policy===e.FIXED_METHOD&&!_.isNumber(t.fixedValue))return this.i18nService.getString("StorageUi","datastore.manage.general.spaceReclamation.fixed.invalidRate");return null},e.prototype.setDefaultRatesIfMissing=function(e,t,i){e.fixedValue=this.getRateValue(e.fixedValue,t.unmapBandwidthFixedValue),i&&(e.dynamicMin=this.getRateValue(e.dynamicMin,t.unmapBandwidthDynamicMin),e.dynamicMax=this.getRateValue(e.dynamicMax,t.unmapBandwidthDynamicMax))},e.prototype.generateRateItems=function(e,t){var i=[];t=t||1;for(var r=e.min;r<=e.max;r+=t)i.push({label:this.i18nService.getString("StorageUi","datastore.manage.general.spaceReclamation.rateItemFormat",r),rate:r});return i},e.prototype.findRateItem=function(e,t,i){var r=_.find(e,function(e){return e.rate===t});return!r&&i&&e&&e.length&&(r=e[0]),r},e.prototype.getRateValue=function(e,t){return e||0===e?e:t&&t.defaultValue},e.$inject=["i18nService"],e.FIXED_METHOD="fixed",e.DYNAMIC_METHOD="dynamic",e}();e.DatastoreSpaceReclamationBandwidthService=t,angular.module("com.vmware.vsphere.client.storage").service("datastoreSpaceReclamationBandwidthService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this.bindings={spaceReclamationData:"<"},this.controller=i,this.templateUrl="storage-ui/resources/storage/views/datastore/spacereclamation/DatastoreSpaceReclamationControl.html"}return e}();e.DatastoreSpaceReclamationControl=t;var i=function(){function e(e){this.i18nService=e,this.availableUnmapPriorities=[{api:"none",displayValue:this.i18nService.getString("StorageUi","vmfs.unmapPriority.none"),description:this.i18nService.getString("StorageUi","datastore.configure.general.spaceReclamation.spaceReclamationPriorityNoneDescription")},{api:"low",displayValue:this.i18nService.getString("StorageUi","vmfs.unmapPriority.low"),description:this.i18nService.getString("StorageUi","datastore.configure.general.spaceReclamation.spaceReclamationPriorityDescription",this.i18nService.getString("StorageUi","vmfs.unmapPriority.low"),this.i18nService.getString("StorageUi","vmfs.unmapPriority.low"))}]}return e.prototype.onUnmapPriorityChanged=function(e){this.spaceReclamationData.unmapPriority=this.availableUnmapPriorities[e].api},e.prototype.$onChanges=function(e){e.spaceReclamationData&&e.spaceReclamationData.currentValue&&this.findSelectedIndex(e.spaceReclamationData.currentValue.unmapPriority)},e.prototype.findSelectedIndex=function(t){for(var i=0;i<this.availableUnmapPriorities.length;i++)if(this.availableUnmapPriorities[i].api===t)return void(this.selectedIndex=i);this.findSelectedIndex(e.DEFAULT_UNMAP_PRIORITY)},e.$inject=["i18nService"],e.DEFAULT_UNMAP_PRIORITY="low",e}();angular.module("com.vmware.vsphere.client.storage").component("datastoreSpaceReclamationControl",new t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=com.vmware.vsphere.client.h5.storage.spec.QueryReclamationOptionsSpec,i=com.vmware.vim.binding.vim.host.VmfsVolume$UnmapBandwidthSpec,r=com.vmware.vsphere.client.h5.storage.spec.UpdateVmfsUnmapBandwidthSpec,n=e.DatastoreSpaceReclamationBandwidthService,o=function(){function e(){this._type="com.vmware.vsphere.client.storage.VmfsDatastoreUnmapPrioritySpec"}return e}();e.UnmapPriorityMutationSpec=o;var a=function(){function e(){}return e}();e.EntitySpecPair=a;var s=function(){function e(e,t,i,r,n,o,a,s){this.$q=e,this.dataService=t,this.clarityModalService=i,this.mutationService=r,this.i18nService=n,this.clarityConstants=o,this.defaultUriSchemeUtil=a,this.reclamationBandwidthService=s,this.DEFAULT_PRIORITY="low",this.NONE_PRIORITY="none"}return e.prototype.show=function(e){var t=this,i={datastoreIds:e,spaceReclamationData:null,spec:null,isLoading:!0,i18n:this.i18nService.getString,entitySpecs:[]},r={contentTemplate:"storage-ui/resources/storage/views/datastore/spacereclamation/DatastoreSpaceReclamationDialog.html",title:this.i18nService.getString("StorageUi","datastore.editSpaceReclamationForm.title"),defaultButton:"submit",dialogData:i};r.onSubmit=this.onSpaceReclamationSubmitted.bind(this,i,r),i.spaceReclamationData={unmapPriority:this.DEFAULT_PRIORITY},1===e.length&&(r.subTitle={objectId:e[0]}),this.queryReclamationOptionsData(e).then(function(e){t.initializeDialogState(e,i)},function(){t.setModalErrors(r,[t.i18nService.getString("StorageUi","datastore.configure.general.spaceReclamation.responseError")])})["finally"](function(){i.isLoading=!1}),r.signPostParams={message:this.i18nService.getString("StorageUi","datastore.editSpaceReclamationForm.title")},this.clarityModalService.openOkCancelModal(r)},e.prototype.setModalErrors=function(e,t,i){var r=this;void 0===i&&(i=!0);var n=_.map(t,function(e){return{text:e,type:r.clarityConstants.notifications.type.ERROR}});e.alerts=n,i&&(e.submitDisabled=!0)},e.prototype.queryReclamationOptionsData=function(i){var r=this,n=new t;n.datastores=this.defaultUriSchemeUtil.getManagedObjectReferences(i);var o=[{propertyName:e.RECLAMATION_OPTIONS_PROPERTY,parameterType:n._type,parameter:n}];return this.dataService.getProperties(i[0],e.RECLAMATION_OPTIONS_PROPERTY,{propertyParams:o}).then(function(t){var i=t&&t[e.RECLAMATION_OPTIONS_PROPERTY];return i?!i.datastoresData||_.some(i.datastoresData,function(e){return!e.connectedHost||!e.datastoreUuid})?r.$q.reject(null):i:r.$q.reject(null)})},e.prototype.initializeDialogState=function(e,t){t.reclamationOptions=e,e.fixedReclamationSupported?(t.showBandwidthControls=!0,t.vmfsConfigOption=e.vmfsConfigOption,this.populateUnmapBandwidthSpec(e),t.unmapBandwidthSpec=e.unmapBandwidthSpec,t.showDynamicUnmapOption=e.dynamicReclamationSupported):(t.showBandwidthControls=!1,t.spaceReclamationData={unmapPriority:e.reclamationPriority})},e.prototype.populateUnmapBandwidthSpec=function(e){if(!e.unmapBandwidthSpec){var t=new i;t.policy="disabled",e.unmapBandwidthSpec=t}this.reclamationBandwidthService.setDefaultRatesIfMissing(e.unmapBandwidthSpec,e.vmfsConfigOption,e.dynamicReclamationSupported)},e.prototype.onSpaceReclamationSubmitted=function(e,t){if(e.showBandwidthControls){var i=e.unmapBandwidthSpec,r=this.reclamationBandwidthService.validateUnmapBandwidthSpec(i);if(r)return this.setModalErrors(t,[r],!1),!1;i.policy===n.FIXED_METHOD||i.policy===n.DYNAMIC_METHOD?this.updateReclamationBandwidth(e,i):this.setReclamationPriority(e,this.NONE_PRIORITY)}else this.setReclamationPriority(e,e.spaceReclamationData.unmapPriority);return!0},e.prototype.setReclamationPriority=function(e,t){var i=this,r=_.map(e.reclamationOptions.datastoresData,function(e){var r=new o;r.unmapPriority=t,r.hostRef=e.connectedHost,r.vmfsUuid=e.datastoreUuid;var n=new a;return n.spec=r,n.entity=i.defaultUriSchemeUtil.getVsphereObjectId(e.datastore),n});this.mutationService.applyMulti(r[0].spec._type,r)},e.prototype.updateReclamationBandwidth=function(e,t){var i=this,n=_.map(e.reclamationOptions.datastoresData,function(e){var n=new r;n.datastore=e.datastore,n.unmapBandwidthSpec=t,n.vmfsUuid=e.datastoreUuid;var o=new a;return o.spec=n,o.entity=i.defaultUriSchemeUtil.getVsphereObjectId(e.connectedHost),o});this.mutationService.applyMulti(n[0].spec._type,n)},e.$inject=["$q","dataService","clarityModalService","mutationService","i18nService","clarityConstants","defaultUriSchemeUtil","datastoreSpaceReclamationBandwidthService"],e.RECLAMATION_OPTIONS_PROPERTY="datastore:reclamationOptionsData",e}();e.DatastoreSpaceReclamationPriorityDialogService=s,angular.module("com.vmware.vsphere.client.storage").service("datastoreSpaceReclamationPriorityDialogService",s)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.clarityModalService=t,this.mutationService=i,this.clarityConstants=r}return e.prototype.openDialog=function(e){var t=this,i={title:this.i18nService.getString("StorageUi","datastore.upgradeVmfsDatastoreForm.title"),contentTemplate:"storage-ui/resources/storage/views/datastore/upgradeVmfsDatastoreDialog.html",dialogData:{i18n:this.i18nService.getString},onSubmit:function(){var r={_type:"com.vmware.vsphere.client.h5.storage.spec.H5VmfsDatastoreUpgradeSpec"};return t.mutationService.validate(e,r._type,r).then(function(n){return n.result?(i.alerts=[{text:n.result,type:t.clarityConstants.notifications.type.ERROR}],!1):(t.mutationService.apply(e[0],r._type,r,t.i18nService.getString("StorageUi","datastore.action.upgradeVmfsDatastore.taskName")),!0)})}};1===e.length&&(i.subTitle={objectId:e[0]}),this.clarityModalService.openOkCancelModal(i)},e.$inject=["i18nService","clarityModalService","mutationService","clarityConstants"],e}();e.UpgradeVmfsDatastoreModalService=t,angular.module("com.vmware.vsphere.client.storage").service("upgradeVmfsDatastoreModalService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.vuiConstants=e,this.i18nService=t,this.dataService=i,this.navigation=r,this.storageUtil=n,this.VVOL_STORAGE_PROVIDERS_VIEW_DATA="vvolStorageProvidersViewData"}return e.prototype.$onInit=function(){this.initDatagrid(),this.headerOptions={title:this.i18nService.getString("StorageUi","storage.storageProvidersView.title")},this.loadingTitle=this.i18nService.getString("Common","loadingTitle")},e.prototype.$onChanges=function(){this.datastoreId=this.navigation.getRoute().objectId,this.refresh()},e.prototype.refresh=function(){var e=this;this.isLoading=!0,this.dataService.getProperties(this.datastoreId,this.VVOL_STORAGE_PROVIDERS_VIEW_DATA).then(function(t){var i=t&&t[e.VVOL_STORAGE_PROVIDERS_VIEW_DATA]&&t[e.VVOL_STORAGE_PROVIDERS_VIEW_DATA].storageProviderItems;e.datagridOptions.data=i||[]})["finally"](function(){e.isLoading=!1})},e.prototype.initDatagrid=function(){this.datagridOptions={resizable:!0,height:"100%",columnDefs:this.getColumnDefs(),selectionMode:this.vuiConstants.grid.selectionMode.NONE}},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("StorageUi","datastore.monitor.storageProvidersView.priority"),field:"formattedPriority",width:"60px",template:"#:formattedPriority#",sortable:function(t,i){return e.storageUtil.compareNumericValues(t,i,"priority")}},{displayName:this.i18nService.getString("StorageUi","datastore.monitor.storageProvidersView.name"),field:"formattedName",width:"120px",template:"#:formattedName#"},{displayName:this.i18nService.getString("StorageUi","datastore.monitor.storageProvidersView.state"),field:"state",width:"60px",template:"#:state#"},{displayName:this.i18nService.getString("StorageUi","datastore.monitor.storageProvidersView.url"),field:"url",width:"220px",template:"#:url#"}]},e.$inject=["vuiConstants","i18nService","dataService","navigation","storageUtil"],e}();angular.module("com.vmware.vsphere.client.storage").component("vvolDsStorageProviders",{controller:t,template:'<div class="fill-parent flex-column" vx-refreshable watch-objects="{{$ctrl.datastoreId}}" refresh="$ctrl.refresh()">\n                  <vx-activity-indicator is-visible="$ctrl.isLoading" title="{{::$ctrl.loadingTitle}}"></vx-activity-indicator>\n                  <div vx-settings-block-header="$ctrl.headerOptions"></div>\n                  <div class="flex-grow-auto flex-grid" vui-datagrid="$ctrl.datagridOptions"></div>\n               </div>'})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",apiObj:"="},this.controller=n,this.templateUrl="storage-ui/resources/storage/views/host/adapters/add/AddSoftwareAdapterControl.html"}return e}();e.AddSoftwareAdapterControl=t;var i=function(){function e(){}return e}();e.MutationOperationSpec=i;var r=function(){function e(){}return e}();e.AddSoftwareAdapterControlApi=r;var n=function(){function e(e,t,i,r,n){var o=this;this.i18nService=e,this.clarityConstants=t,this.dataService=i,this.vxValidatorFactory=r,this.$timeout=n,this.ISCSI_ADAPTER_TYPE="ISCSI_ADAPTER_TYPE",this.FCOE_ADAPTER_TYPE="FCOE_ADAPTER_TYPE",this.VLAN_ID_MIN=0,this.VLAN_ID_MAX=4094,this.PRIORITY_CLASS_MIN=0,this.PRIORITY_CLASS_MAX=7,this.SOFTWARE_INTERNET_SCSI_ENABLED="config.storageDevice.softwareInternetScsiEnabled",this.FCOE_CAPABLE_PNICS_PROP="fcoeCapablePnics",this.validateVlanId=function(e){return o.vlanIdEnabled?o.isValidValue(e,o.VLAN_ID_MIN,o.VLAN_ID_MAX):[]},this.validatePriorityClass=function(e){return o.priorityClassEnabled?o.isValidValue(e,o.PRIORITY_CLASS_MIN,o.PRIORITY_CLASS_MAX):[]},this.validateMacAddressText=function(e){return o.macAddressTextEnabled&&!e?[o.i18n("Common","vxValidation.emptyFieldError")]:[]},this.i18n=this.i18nService.getString,this.fcoeSettingsValidator=this.vxValidatorFactory.create()}return e.prototype.$onInit=function(){this.apiObj&&(this.apiObj.validate=this.validate.bind(this),this.apiObj.createSpec=this.createSpec.bind(this),this.apiObj.isSwBasedIscsiAdapter=this.isSwBasedIscsiAdapter.bind(this)),this.requestPageData()},e.prototype.onPnicDeviceChange=function(){if(!this.selectedPnic||!this.selectedPnic.fcoeConfiguration)return this.vlanIdEnabled=!1,this.priorityClassEnabled=!1,this.macAddressTextEnabled=!1,this.vlanId=void 0,this.priorityClass=void 0,void(this.macAddressText=void 0);var e=this.selectedPnic.fcoeConfiguration;e.vlanRange&&e.vlanRange.length?this.vlanId=this.selectedPnic.fcoeConfiguration.vlanRange[0].vlanLow:this.vlanId=void 0,this.priorityClass=e.priorityClass,this.macAddressText=e.sourceMac,this.vlanIdEnabled=e.capabilities&&e.capabilities.vlanRange,this.priorityClassEnabled=e.capabilities&&e.capabilities.priorityClass,this.macAddressTextEnabled=e.capabilities&&e.capabilities.sourceMacAddress},e.prototype.requestPageData=function(){var e=this;this.loading=!0,this.canAddFcoeAdapter=!1,this.canAddIscsiAdapter=!1,this.dataService.getProperties(this.hostId,[this.SOFTWARE_INTERNET_SCSI_ENABLED,this.FCOE_CAPABLE_PNICS_PROP]).then(function(t){t&&(t[e.SOFTWARE_INTERNET_SCSI_ENABLED]===!1&&(e.canAddIscsiAdapter=!0,e.selectedAdapterType=e.ISCSI_ADAPTER_TYPE),e.pnicDevices=t[e.FCOE_CAPABLE_PNICS_PROP],e.pnicDevices&&e.pnicDevices.length&&(e.canAddFcoeAdapter=!0,e.selectedAdapterType=e.selectedAdapterType||e.FCOE_ADAPTER_TYPE,e.selectedPnic=e.pnicDevices[0],e.onPnicDeviceChange()),e.focusRadio())})["finally"](function(){e.loading=!1})},e.prototype.createSpec=function(){var e=new i;return this.selectedAdapterType===this.ISCSI_ADAPTER_TYPE?e.spec={_type:"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterActivationSpec",activate:!0}:this.selectedAdapterType===this.FCOE_ADAPTER_TYPE&&(e.spec=this.createFCoESpec(),e.operationName=this.i18n("StorageUi","storage.adapters.actions.addAdapter.fcoe.taskName")),e},e.prototype.isSwBasedIscsiAdapter=function(){return this.selectedAdapterType===this.ISCSI_ADAPTER_TYPE},e.prototype.createFCoESpec=function(){var e={_type:"com.vmware.vim.binding.vim.host.FcoeConfig$FcoeSpecification"};return e.underlyingPnic=this.selectedPnic.device,this.vlanIdEnabled&&(e.vlanRange=[{_type:"com.vmware.vim.binding.vim.host.FcoeConfig$VlanRange",vlanHigh:this.vlanId,vlanLow:this.vlanId}]),this.priorityClassEnabled&&(e.priorityClass=this.priorityClass),this.macAddressTextEnabled&&(e.sourceMac=this.macAddressText),{_type:"com.vmware.vsphere.client.storage.adapters.FcoeStorageAdapterCreationSpec",fcoeSpec:e}},e.prototype.isFloatValue=function(e){return!!(e%1)},e.prototype.isValidValue=function(e,t,i){var r=Number(e);return!e||isNaN(r)||r<t||r>i||this.isFloatValue(r)?[this.i18n("StorageUi","invalidIntegerValue.outOfRange",t,i)]:[]},e.prototype.focusRadio=function(){var e=angular.element("input[type='radio'][name='adapterType']");e&&e[0]&&this.selectedAdapterType===this.ISCSI_ADAPTER_TYPE?this.$timeout(function(){e[0].focus()},0):e&&e[1]&&this.selectedAdapterType===this.FCOE_ADAPTER_TYPE&&this.$timeout(function(){e[1].focus()},0)},e.prototype.validate=function(){return!!this.selectedAdapterType&&(this.selectedAdapterType===this.ISCSI_ADAPTER_TYPE||!this.fcoeSettingsValidator.validate().length)},e.$inject=["i18nService","clarityConstants","dataService","vxValidatorFactory","$timeout"],e}();angular.module("com.vmware.vsphere.client.storage").component("addSoftwareAdapterControl",new t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=e.AddSoftwareAdapterControlApi,i=function(){
function e(e,t,i){this.clarityModalService=e,this.mutationService=t,this.i18nService=i}return e.prototype.show=function(e,i){function r(){if(!n.validate())return!1;var t=n.createSpec();return t&&t.spec&&this.mutationService.apply(e,t.spec._type,t.spec,t.operationName).then(function(e){e&&!e.error&&i.callback&&i.callback(n.isSwBasedIscsiAdapter())}),!0}var n=new t,o={hostId:e,apiObj:n},a={contentTemplate:"storage-ui/resources/storage/views/host/adapters/add/AddSoftwareAdapterDialog.html",title:this.i18nService.getString("StorageUi","storage.adapters.actions.addAdapter.addSoftwareAdapter"),subTitle:{objectId:e},size:"lg",defaultButton:"submit",onSubmit:r.bind(this),dialogData:o};this.clarityModalService.openOkCancelModal(a)},e.$inject=["clarityModalService","mutationService","i18nService"],e}();e.AddSoftwareAdapterDialogService=i,angular.module("com.vmware.vsphere.client.storage").service("addSoftwareAdapterDialogService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){angular.module("com.vmware.vsphere.client.storage").constant("advancedOptionConstants",{optionProperties:{OPTION_PROPERTY_NAME:"option",DESCRIPTION_PROPERTY_NAME:"description",VALUE_PROPERTY_NAME:"value",INHERITED_PROPERTY_NAME:"inherited"},optionTypes:{STRING_OPTION_TYPE:"StringOption",BOOLEAN_OPTION_TYPE:"BoolOption",LONG_OPTION_TYPE:"LongOption",INT_OPTION_TYPE:"IntOption"}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){this.vuiConstants=e,this.i18nService=t,this.$scope=i,this.datagridActionBarService=r,this.initializeDataGridOptions()}return e.prototype.$onInit=function(){var e=this;this.datagridOptions.data=this.options,this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t===i||_.isEqual(t,i)||(e.selectedOptions=t)}),this.$scope.comparator=function(t){var i=_.find(e.selectedOptions,function(e){return e.option===t.option});return void 0!==i}},e.prototype.initializeDataGridOptions=function(){this.datagridOptions={columnDefs:this.getColumnDefs(),data:[],height:"100%",selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,searchable:!1,resizable:!0,selectedItems:[],pageConfig:{hidePager:!0},actionBarOptions:{actions:[]}}},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.option"),field:"option",width:"300",template:"#:option#"},{displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.description"),field:"description",width:"400",template:"#:description#"},{displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.value"),field:"value",width:"300",template:"#:value#"}]},e.prototype.$onChanges=function(){this.datagridOptions.data=this.options;var e=this;this.datagridActionBarService.updateActionBar(e.datagridOptions,[e.hostId],[{actionId:"vsphere.core.host.actions.adapters.editAdvancedOptionsForAdapter",getActionInvocationContext:function(){return{hba:e.hba}}}])},e.$inject=["vuiConstants","i18nService","$scope","datagridActionBarService"],e}();e.AdvancedOptionsList=t,angular.module("com.vmware.vsphere.client.storage").component("advancedOptionsList",{templateUrl:"storage-ui/resources/storage/views/host/adapters/advanced/AdvancedOptionsList.html",bindings:{options:"<",selectedOptions:"<?",hostId:"<",hba:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l){this.dataService=e,this.navigation=t,this.i18nService=i,this.editIscsiAdvancedOptionsService=r,this.vuiConstants=n,this.advancedOptionConstants=o,this.columnRenderersRegistry=a,this.vxValidatorFactory=s,this.$timeout=c,this.$element=l,this.ADVANCED_SETTINGS_PROPERTY=".internetScsiAdvancedSettings",this.ADVANCED_SETTINGS_INFO_PROPERTY=".internetScsiAdvancedSettings.@info",this.ADVANCED_SETTINGS_TARGET_PROPERTY="HostSystem/localizedInternetScsiTargetAdvancedSettings",this.ADVANCED_SETTINGS_TARGET_INFO_PROPERTY="HostSystem/internetScsiTargetAdvancedSettings.@info",this.vxValidator=this.vxValidatorFactory.create(),this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){var e=this;this.apiObj&&(this.apiObj.validate=function(){var t=e.vxValidator.validate();return _.forEach(e.datagridOptions.data,function(e){if(!e.readOnly){var t=e._rawItem.validate(),i=t&&t.length&&t[0];e.validationError.errorMessage=i}}),!t||!t.length},this.apiObj.getModifiedOptions=function(){var t=[];return _.forEach(e.originalOptionValues,function(i){var r=e.getOptionItemByKey(i.optionKey);r&&!e.editIscsiAdvancedOptionsService.equalOptionItems(r,i)&&t.push(r)}),t})},e.prototype.getOptionItemByKey=function(e){var t=_.find(this.datagridOptions.data,function(t){return t._rawItem.optionKey===e});return t&&t._rawItem},e.prototype.$onChanges=function(){this.requestData()},e.prototype.requestData=function(){var e=this;if(this.hostId&&this.hba){this.loading=!0;var t;t=this.targetSet?this.requestDataForTarget():this.requestDataForAdapter(),t.then(function(t){e.originalOptionValues=angular.copy(t);var i=_.map(t,function(e){return angular.merge({_rawItem:e},e)});_.forEach(i,function(e){e.validationError={errorMessage:"",message:function(){return e.validationError.errorMessage},isVisible:function(){return!!e.validationError.errorMessage}}}),e.datagridOptions={columnDefs:e.getColumnDefs(),data:i,height:"100%",selectionMode:e.vuiConstants.grid.selectionMode.SINGLE,searchable:!1,resizable:!0},e.focusGrid()})["finally"](function(){e.loading=!1})}},e.prototype.requestDataForAdapter=function(){var e=this,t=this.hba.key+this.ADVANCED_SETTINGS_PROPERTY,i=this.hba.key+this.ADVANCED_SETTINGS_INFO_PROPERTY;return this.dataService.getProperties(this.hostId,[t,i]).then(function(r){return e.editIscsiAdvancedOptionsService.parseOptionItems(r[t],r[i])})},e.prototype.requestDataForTarget=function(){var e=this,t=this.editIscsiAdvancedOptionsService.buildIscsiTargetsAdvancedSettingsRetrievalSpec(this.hba,this.targetSet);return this.dataService.getProperties(this.hostId,[this.ADVANCED_SETTINGS_TARGET_PROPERTY,this.ADVANCED_SETTINGS_TARGET_INFO_PROPERTY],{propertyParams:[{propertyName:this.ADVANCED_SETTINGS_TARGET_PROPERTY,parameterType:t._type,parameter:t},{propertyName:this.ADVANCED_SETTINGS_TARGET_INFO_PROPERTY,parameterType:t._type,parameter:t}]}).then(function(t){return t=t||{},e.editIscsiAdvancedOptionsService.parseOptionItems(t[e.ADVANCED_SETTINGS_TARGET_PROPERTY],t[e.ADVANCED_SETTINGS_TARGET_INFO_PROPERTY])})},e.prototype.getColumnDefs=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("text"),i=[{displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.option"),field:"name",width:"300",template:function(e){return t(["name"],e)}},{displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.description"),field:"description",width:"400",template:function(e){return t(["description"],e)}}];return this.targetSet&&i.push({displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.inherited"),width:"300",template:function(t){return'<label>  <input type="checkbox"      ng-model="dataItem.inherited"      ng-change="dataItem._rawItem.inherited = dataItem.inherited"      ng-disabled="dataItem.readOnly">'+e.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.inheritedEnabled")+"</label>"}}),i.push({displayName:this.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.column.value"),width:"300",template:function(t){if(t.validator=e.vxValidator,t.valueType===e.advancedOptionConstants.optionTypes.STRING_OPTION_TYPE&&t.allowedValues&&t.allowedValues.length)return'<div class="select value-cell" >\n                             <select ng-model="dataItem.value"\n                                     ng-options="option.value as option.name for option in dataItem.allowedValues"\n                                     ng-change="dataItem._rawItem.value = dataItem.value"\n                                     ng-disabled="dataItem.readOnly || dataItem.inherited"\n                                     aria-label="{{dataItem.name}}">\n                              </div>';if(t.valueType===e.advancedOptionConstants.optionTypes.BOOLEAN_OPTION_TYPE)return'<label>\n                             <input type="checkbox"\n                                ng-model="dataItem.value"\n                                ng-change="dataItem._rawItem.value = dataItem.value"\n                                ng-disabled="dataItem.readOnly || dataItem.inherited"\n                                aria-label="{{dataItem.name}}">\n                           '+e.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.booleanValue")+"\n                           </label>";var i=[];null!==t.minValue&&void 0!==t.minValue&&i.push(e.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.minValue",t.minValue)),null!==t.maxValue&&void 0!==t.maxValue&&i.push(e.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.maxValue",t.maxValue));var r=i.length?'title="'+i.join(" ")+'"':"",n='<input type="text" ng-model="dataItem.value"\n                        ng-disabled="dataItem.readOnly || dataItem.inherited"\n                        ng-change="dataItem._rawItem.value = dataItem.value"\n                        vx-error="dataItem.validationError"\n                        class="iscsi-advanced-options-input"\n                        aria-label="{{dataItem.name}}"\n                        '+r+" >";return'<div class="value-cell"><vsc-validate [validator]="dataItem.validator"\n                        [required]="false"\n                        [clr-tooltip-direction]="\'top-left\'"\n                        [custom-validation-function]="dataItem.validate"> '+n+" </vsc-validate></div>"}}),i},e.prototype.focusGrid=function(){var e=this;this.$timeout(function(){var t=e.$element.find("div[vui-datagrid] div[kendo-grid]");t&&t[0]&&(t[0].setAttribute("tabindex","-1"),t[0].focus())},0)},e.$inject=["dataService","navigation","i18nService","editIscsiAdvancedOptionsService","vuiConstants","advancedOptionConstants","columnRenderersRegistry","vxValidatorFactory","$timeout","$element"],e}();e.EditIscsiAdvancedOptionsControl=t,angular.module("com.vmware.vsphere.client.storage").component("editIscsiAdvancedOptionsControl",{templateUrl:"storage-ui/resources/storage/views/host/adapters/advanced/edit/EditIscsiAdvancedOptionsControl.html",bindings:{hba:"<",hostId:"<",targetSet:"<",apiObj:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){}return e}();e.OptionItem=t;var i=function(){function e(e,t,i,r,n){var o=this;this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i,this.mutationService=r,this.advancedOptionConstants=n,this.validateOptionValue=function(e){if(!e||e.readOnly)return[];if(e.valueType===o.advancedOptionConstants.optionTypes.LONG_OPTION_TYPE||e.valueType===o.advancedOptionConstants.optionTypes.INT_OPTION_TYPE){var t=parseInt(e.value);if(isNaN(t)||!o.isSafeInteger(t)||""+t!=""+e.value)return[o.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.invalidNumber")];if(null!==e.minValue&&void 0!==e.minValue&&t<e.minValue)return[o.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.lowerThenMinError",e.minValue)];if(null!==e.maxValue&&void 0!==e.maxValue&&t>e.maxValue)return[o.i18nService.getString("StorageUi","storage.adapters.iscsi.advancedOptions.exceedsMaxError",e.maxValue)]}return[]}}return e.prototype.showAdvancedOptionsDialogForAdapter=function(e,t){this.showAdvancedOptionsDialogForTarget(e,t,null)},e.prototype.showAdvancedOptionsDialogForTarget=function(e,t,i){var r=this,n={hostId:e,hba:t,targetSet:i,apiObj:{}},o={title:this.i18nService.getString("StorageUi","storage.adapters.tabs.advancedOptions.header"),contentTemplate:"storage-ui/resources/storage/views/host/adapters/advanced/edit/EditIscsiAdvancedOptionsDialog.html",defaultButton:"submit",dialogData:n,size:"lg",alerts:[],onSubmit:function(){if(!n.apiObj.validate())return o.alerts=[{text:r.i18nService.getString("StorageUi","form.validationError"),type:r.clarityConstants.notifications.type.ERROR}],!1;var a=n.apiObj.getModifiedOptions();if(!a.length)return!0;var s;return s=i?{_type:"com.vmware.vsphere.client.storage.adapters.impl.ApplyTargetAdvancedSettingsSpec",spec:r.buildIscsiTargetsAdvancedSettingsRetrievalSpec(t,i),changeSet:r.buildChangeSet(a)}:{_type:"com.vmware.vsphere.client.storage.adapters.impl.ApplyInternetScsiAdvancedSettingsSpec",adapterKey:t.key,changeSet:r.buildChangeSet(a)},r.mutationService.apply(e,s._type,s),!0}};this.clarityModalService.openOkCancelModal(o)},e.prototype.buildChangeSet=function(e){var t=this;return _.map(e,function(e){return{_type:"com.vmware.vsphere.client.storage.adapters.impl.AdvancedOptionChangeSpec",value:{_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.optionKey,value:[t.optionValueTypeToJavaType(e.valueType),e.value]},inherited:e.inherited}})},e.prototype.optionValueTypeToJavaType=function(e){return e===this.advancedOptionConstants.optionTypes.INT_OPTION_TYPE?"java.lang.Integer":e===this.advancedOptionConstants.optionTypes.LONG_OPTION_TYPE?"java.lang.Long":e===this.advancedOptionConstants.optionTypes.BOOLEAN_OPTION_TYPE?"java.lang.Boolean":"java.lang.String"},e.prototype.buildIscsiTargetsAdvancedSettingsRetrievalSpec=function(e,t){return{_type:"com.vmware.vsphere.client.storage.adapters.LocalizedInternetScsiTargetsAdvancedSettingsRetrievalSpec",digestCapabilities:e.digestCapabilities,targetSet:t,device:e.device,isSoftwareIScsi:e.isSoftwareBased,addapterKey:e.key}},e.prototype.isSafeInteger=function(e){return-(Math.pow(2,53)-1)<e&&e<Math.pow(2,53)-1},e.prototype.parseOptionItems=function(e,i){var r=this;if(!e||!i)return[];var n=[],o=i.properties;if(e.length!==o.length)return[];for(var a=function(i){var a=new t;if(n.push(a),a.readOnly=!1,a.validate=s.validateOptionValue.bind(s,a),a.name=s.fetchProperyValue(s.advancedOptionConstants.optionProperties.OPTION_PROPERTY_NAME,e[i].properties),a.description=s.fetchProperyValue(s.advancedOptionConstants.optionProperties.DESCRIPTION_PROPERTY_NAME,e[i].properties),a.optionKey=e[i].tag.optionKey,a.valueType=e[i].tag.optionValueType,a.inherited=s.fetchProperyValue(s.advancedOptionConstants.optionProperties.INHERITED_PROPERTY_NAME,e[i].properties),a.value=s.fetchProperyValue(s.advancedOptionConstants.optionProperties.VALUE_PROPERTY_NAME,e[i].properties),a.valueType===s.advancedOptionConstants.optionTypes.STRING_OPTION_TYPE&&a.value&&a.value.hasOwnProperty("value")&&(a.value=a.value.value),!o[i].valueType||!o[i].valueType.properties)return"continue";var c=o[i].valueType.properties,l=_.find(c,function(e){return e.name===r.advancedOptionConstants.optionProperties.VALUE_PROPERTY_NAME});l&&(a.readOnly=l.immutable,_.each(l.staticValueSpace,function(e){"MININCLUSIVE"===e.type&&(a.minValue=e.value),"MAXINCLUSIVE"===e.type&&(a.maxValue=e.value),"ENUMERATION"===e.type&&(a.allowedValues=a.allowedValues||[],a.allowedValues.push(e.value))}))},s=this,c=0;c<e.length;c++)a(c);return n},e.prototype.equalOptionItems=function(e,t){return e.inherited===t.inherited&&""+e.value==""+t.value},e.prototype.fetchProperyValue=function(e,t){var i=_.find(t,function(t){return t.name===e});return i&&i.value},e.$inject=["i18nService","clarityModalService","clarityConstants","mutationService","advancedOptionConstants"],e}();e.EditIscsiAdvancedOptionsService=i,angular.module("com.vmware.vsphere.client.storage").service("editIscsiAdvancedOptionsService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){this.dataService=e,this.navigation=t,this.i18nService=i,this.advancedOptionConstants=r,this.STORAGE_BUS_ADAPTER_PROPERTY="hostBusAdapter",this.ADVANCED_SETTINGS_PROPERTY=".internetScsiAdvancedSettings"}return e.prototype.$onChanges=function(){this.adapterKey=this.adapterItem.key,this.adapterKey&&this.requestData()},e.prototype.requestData=function(){var e=this;this.loading=!0,this.hostId=this.navigation.getRoute().objectId;var t=this.adapterKey+this.ADVANCED_SETTINGS_PROPERTY;this.dataService.getProperties(this.hostId,[t,this.STORAGE_BUS_ADAPTER_PROPERTY],{propertyParams:[{propertyName:this.STORAGE_BUS_ADAPTER_PROPERTY,parameterType:"java.lang.String",parameter:this.adapterKey}]}).then(function(i){i?(e.data=i[t]?e.parseResponse(i[t]):[],e.hba=i[e.STORAGE_BUS_ADAPTER_PROPERTY]):e.data=[]})["finally"](function(){e.loading=!1})},e.prototype.parseResponse=function(e){var t=this;return _.map(e,function(e){var i=t.fetchPropery(t.advancedOptionConstants.optionProperties.OPTION_PROPERTY_NAME,e.properties),r=t.fetchPropery(t.advancedOptionConstants.optionProperties.DESCRIPTION_PROPERTY_NAME,e.properties),n=t.fetchPropery(t.advancedOptionConstants.optionProperties.VALUE_PROPERTY_NAME,e.properties),o="";return n&&e.tag&&e.tag.optionValueType&&(o=t.getValueOfType(n.value,e.tag.optionValueType)),{option:i&&i.value||"",description:r&&r.value||"",value:o}})},e.prototype.fetchPropery=function(e,t){return _.select(t,function(t){return t.name===e})[0]},e.prototype.getValueOfType=function(e,t){return t===this.advancedOptionConstants.optionTypes.STRING_OPTION_TYPE?e.name:e},e.$inject=["dataService","navigation","i18nService","advancedOptionConstants"],e}();e.IscsiAdvancedOptions=t,angular.module("com.vmware.vsphere.client.storage").component("iscsiAdvancedOptions",{templateUrl:"storage-ui/resources/storage/views/host/adapters/advanced/IscsiAdvancedOptions.html",bindings:{adapterItem:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){}return e}();e.ValidationResult=t;var i=function(){function e(){}return e}();e.AuthenticationSettings=i;var r=function(){function e(){}return e}();e.StorageAdapterAuthenticationSettingsApi=r;var n=function(){function e(e,t,i){this.i18nService=e,this.storageAdapterConstants=t,this.i18n=e.getString,this.outgoingValidator=i.create(),this.incomingValidator=i.create()}return e.prototype.replaceDummyPassword=function(e){return e?this.storageAdapterConstants.EXISTING_PASSWORD_PLACEHOLDER:e},e.prototype.$onInit=function(){this.componentApi&&(this.componentApi.validate=this.validate.bind(this),this.componentApi.isDirty=this.isDirty.bind(this),this.componentApi.getSettings=this.getSettings.bind(this))},e.prototype.$onChanges=function(){this.buildAuthenticationMethodOptions(),this.incoming={name:this.authentication.incomingName,secret:this.authentication.authenticationMethod!==this.storageAdapterConstants.authentication.MUTUAL?"":this.replaceDummyPassword(this.authentication.incomingSecret),useInitiatorName:this.authentication.useInitiatorNameForIncoming},this.outgoing={name:this.authentication.outgoingName,secret:this.authentication.authenticationMethod===this.storageAdapterConstants.authentication.PROHIBITED?"":this.replaceDummyPassword(this.authentication.outgoingSecret),useInitiatorName:this.authentication.useInitiatorNameForOutgoing},this.authMethodSelected={id:this.authentication.authenticationMethod}},e.prototype.getSettings=function(){var e=new i;return e.authMethodSelected=this.authMethodSelected.id,e.outgoing=this.outgoing,e.incoming=this.incoming,e},e.prototype.buildAuthenticationMethodOptions=function(){this.isSoftwareBased?this.authenticationMethods=[{name:this.i18n("StorageUi","storage.adapters.iscsi.chapProhibitedchapProhibited"),id:this.storageAdapterConstants.authentication.PROHIBITED},{name:this.i18n("StorageUi","storage.adapters.iscsi.chapDiscouragedchapProhibited"),id:this.storageAdapterConstants.authentication.DISCOURAGED},{name:this.i18n("StorageUi","storage.adapters.iscsi.chapPreferredchapProhibited"),id:this.storageAdapterConstants.authentication.PREFERRED},{name:this.i18n("StorageUi","storage.adapters.iscsi.chapRequiredchapProhibited"),id:this.storageAdapterConstants.authentication.REQUIRED},{name:this.i18n("StorageUi","storage.adapters.iscsi.chapRequiredchapRequired"),id:this.storageAdapterConstants.authentication.MUTUAL}]:this.authenticationMethods=[{name:this.i18n("StorageUi","storage.adapters.iscsi.chapProhibitedchapProhibited"),id:this.storageAdapterConstants.authentication.PROHIBITED},{name:this.i18n("StorageUi","storage.adapters.iscsi.chapPreferredchapProhibited"),id:this.storageAdapterConstants.authentication.PREFERRED}]},e.prototype.isDirty=function(){return this.authentication.outgoingName!==this.outgoing.name||this.outgoing.secret&&this.outgoing.secret!==this.storageAdapterConstants.EXISTING_PASSWORD_PLACEHOLDER||this.authentication.incomingName!==this.incoming.name||this.incoming.secret&&this.incoming.secret!==this.storageAdapterConstants.EXISTING_PASSWORD_PLACEHOLDER||this.authentication.authenticationMethod!==this.authMethodSelected.id},e.prototype.validate=function(){var e=new t,i=[],r=this.authMethodSelected.id!==this.storageAdapterConstants.authentication.PROHIBITED,n=this.authMethodSelected.id===this.storageAdapterConstants.authentication.MUTUAL;return r&&(i=i.concat(this.outgoingValidator.validate())),n&&(i=i.concat(this.incomingValidator.validate())),n&&0===i.length&&this.incoming.secret===this.outgoing.secret&&this.incoming.secret!==this.storageAdapterConstants.EXISTING_PASSWORD_PLACEHOLDER?(e.errors=[this.i18nService.getString("StorageUi","storage.adapters.edit.authentication.form.secretsMatch")],e.isValid=!1,e):(e.isValid=!i.length,e)},e.$inject=["i18nService","storageAdapterConstants","vxValidatorFactory"],e}();e.StorageAdapterAuthenticationSettings=n,angular.module("com.vmware.vsphere.client.storage").component("storageAdapterAuthenticationSettings",{templateUrl:"storage-ui/resources/storage/views/host/adapters/authentication/StorageAdapterAuthenticationSettings.html",bindings:{isSoftwareBased:"<",adapterName:"<",authentication:"<",isDisabled:"<",componentApi:"="},controller:n})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i){var r=this;this.constants=t,this.validatorService=i,this.isValidSecret=function(){return r.validatorService.isValidSecret(r.secret,r.isSoftwareBased)},this.isValidName=function(){return r.validatorService.isValidName(r.name,r.isSoftwareBased)},this.i18n=e.getString}return e.prototype.onCheckboxChange=function(){this.useInitiatorName?this.name=this.iscsiName:this.name=""},e.prototype.getMaxSecretInputLength=function(){return this.isSoftwareBased?this.constants.constraints.SW_CHAP_SECRET_MAX:this.constants.constraints.HW_CHAP_SECRET_MAX},e.prototype.getMaxNameInputLength=function(){return this.isSoftwareBased?this.constants.constraints.SW_CHAP_NAME_MAX:this.constants.constraints.HW_CHAP_NAME_MAX},e.$inject=["i18nService","storageAdapterConstants","storageAdapterEditAuthenticationValidationService"],e}();angular.module("com.vmware.vsphere.client.storage").component("storageAdapterEditAuthenticationChapSection",{templateUrl:"storage-ui/resources/storage/views/host/adapters/authentication/StorageAdapterEditAuthenticationChapSection.html",bindings:{disabled:"=ngDisabled",header:"<",iscsiName:"<",name:"=",secret:"=",useInitiatorName:"=",isSoftwareBased:"<",validator:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=e.StorageAdapterAuthenticationSettingsApi,i=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i,this.mutationService=r,this.specBuilder=n,this.iscsiAuthenticationSettingsService=o}return e.prototype.editAuthSettingsIscsiTarget=function(e,i,r,n,o){function a(){return p.inheritAuthSettings!==u.inheritSettingsFromParent||!p.inheritAuthSettings&&d.isDirty()}function s(){if(!a())return!0;var t=u.outgoingSecret;if(!p.inheritAuthSettings){var n=d.validate();if(!n.isValid)return n.errors&&n.errors.length&&(v.alerts=_.map(n.errors,function(e){return{type:l.clarityConstants.notifications.type.ERROR,text:e}})),!1}var s=d.getSettings(),c=l.specBuilder.buildAuthenticationPropertiesForTarget(p.inheritAuthSettings,s.authMethodSelected,s.outgoing,s.incoming,t),m={_type:"com.vmware.vim.binding.vim.host.InternetScsiHba$TargetSet"};"com.vmware.vim.binding.vim.host.InternetScsiHba$SendTarget"===r._type?m.sendTargets=[r]:m.staticTargets=[r];var g={_type:"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterAuthenticationUpdateSpec",device:i.device,properties:c,targetSet:m};return l.mutationService.apply(e,g._type,g,l.i18nService.getString("StorageUi","storage.adapters.properties.authentication.edit.taskName")).then(function(e){e&&!e.error&&o&&o(i)}),!0}var c,l=this,d=new t,u=this.iscsiAuthenticationSettingsService.buildIscsiAuthenticationSettings(r.authenticationProperties,i.iScsiName);c=r.parent!==i.iScsiName&&n?this.iscsiAuthenticationSettingsService.buildIscsiAuthenticationSettings(n,i.iScsiName):this.iscsiAuthenticationSettingsService.buildIscsiAuthenticationSettings(i.authenticationProperties,i.iScsiName);var p={adapter:i,i18n:this.i18nService.getString,targetAuthSettings:u,parentAuthSettings:c,inheritAuthSettings:u.inheritSettingsFromParent,inheritAuthSettingsLabel:r.parent?this.i18nService.getString("StorageUi","storage.adapters.iscsiTargets.actions.authentication.form.parentInheritLabel",r.parent):this.i18nService.getString("StorageUi","storage.adapters.iscsiTargets.actions.authentication.form.noParentInheritLabel"),settingsComponentApi:d},v={title:this.i18nService.getString("StorageUi","storage.adapters.properties.authentication.edit.header",i.device),contentTemplate:"storage-ui/resources/storage/views/host/adapters/authentication/StorageAdapterEditTargetAuthentication.html",defaultButton:"submit",onSubmit:s,dialogData:p,alerts:[]};this.clarityModalService.openOkCancelModal(v)},e.prototype.openModal=function(e,i){function r(){var t=i.authenticationProperties.chapSecret;if(!o.isDirty())return!0;var r=o.validate();if(!r.isValid)return r.errors&&r.errors.length&&(s.alerts=_.map(r.errors,function(e){return{type:n.clarityConstants.notifications.type.ERROR,text:e}})),!1;var a=o.getSettings(),c=n.specBuilder.buildSpecForAdapter(a.authMethodSelected,a.outgoing,a.incoming,t,i.device);return n.mutationService.apply(e,c._type,c,n.i18nService.getString("StorageUi","storage.adapters.properties.authentication.edit.taskName")),!0}var n=this,o=new t,a={adapter:i,authenticationProperties:this.iscsiAuthenticationSettingsService.buildIscsiAuthenticationSettings(i.authenticationProperties,i.iScsiName),i18n:this.i18nService.getString,settingsComponentApi:o},s={title:this.i18nService.getString("StorageUi","storage.adapters.properties.authentication.edit.header",i.device),contentTemplate:"storage-ui/resources/storage/views/host/adapters/authentication/StorageAdapterEditAuthentication.html",defaultButton:"submit",onSubmit:r,dialogData:a,alerts:[]};this.clarityModalService.openOkCancelModal(s)},e.$inject=["i18nService","clarityModalService","clarityConstants","mutationService","storageAdapterEditAuthenticationSpecBuilderService","iscsiAuthenticationSettingsService"],e}();e.StorageAdapterEditAuthenticationService=i,angular.module("com.vmware.vsphere.client.storage").service("storageAdapterEditAuthenticationService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=com.vmware.vim.binding.vim.host.InternetScsiHba$AuthenticationProperties,i=function(){function e(e){this.constants=e,this.AUTH_PROP_CLASS_TYPE="com.vmware.vim.binding.vim.host.InternetScsiHba$AuthenticationProperties"}return e.prototype.buildSpecForAdapter=function(e,t,i,r,n){return e===this.constants.authentication.PROHIBITED?this.createSpec(this.createNoAuthenticationProperties(),n):e!==this.constants.authentication.MUTUAL?this.createSpec(this.createUniChapAuthenticationProperties(e,t,r),n):this.createSpec(this.createBiChapAuthentication(t,i,r),n)},e.prototype.buildAuthenticationPropertiesForTarget=function(e,t,i,r,n){return e?this.createAuthPropsForInheritFromParent():t===this.constants.authentication.PROHIBITED?this.createNoAuthenticationProperties():t!==this.constants.authentication.MUTUAL?this.createUniChapAuthenticationProperties(t,i,n):this.createBiChapAuthentication(i,r,n)},e.prototype.createSpec=function(e,t){var i={_type:"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterAuthenticationUpdateSpec"};return i.device=t,i.properties=e,i},e.prototype.createAuthPropsForInheritFromParent=function(){var e=new t;return e._type=this.AUTH_PROP_CLASS_TYPE,e.chapInherited=!0,e.mutualChapInherited=!0,e.chapAuthEnabled=!1,e.chapAuthenticationType="chapProhibited",e.mutualChapAuthenticationType="chapProhibited",e},e.prototype.createNoAuthenticationProperties=function(){var e=new t;return e._type=this.AUTH_PROP_CLASS_TYPE,e.chapAuthEnabled=!1,e.chapAuthenticationType=this.constants.authentication.PROHIBITED,e.mutualChapAuthenticationType=this.constants.authentication.PROHIBITED,e.chapInherited=!1,e},e.prototype.createUniChapAuthenticationProperties=function(e,i,r){var n=new t;return n._type=this.AUTH_PROP_CLASS_TYPE,n.chapAuthEnabled=!0,n.chapAuthenticationType=e,n.chapName=i.name.trim(),n.chapSecret=this.getSecret(i.secret,r),n.mutualChapAuthenticationType=this.constants.authentication.PROHIBITED,n.chapInherited=!1,n},e.prototype.createBiChapAuthentication=function(e,i,r){var n=new t;return n._type=this.AUTH_PROP_CLASS_TYPE,n.chapAuthEnabled=!0,n.chapAuthenticationType=this.constants.authentication.REQUIRED,n.chapName=e.name.trim(),n.chapSecret=this.getSecret(e.secret,r),n.mutualChapAuthenticationType=this.constants.authentication.REQUIRED,n.mutualChapName=i.name.trim(),n.mutualChapSecret=this.getSecret(i.secret,r),n.chapInherited=!1,n},e.prototype.getSecret=function(e,t){return e===this.constants.EXISTING_PASSWORD_PLACEHOLDER?t:e.trim()},e.$inject=["storageAdapterConstants"],e}();e.StorageAdapterEditAuthenticationSpecBuilderService=i,angular.module("com.vmware.vsphere.client.storage").service("storageAdapterEditAuthenticationSpecBuilderService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.constants=t}return e.prototype.isValidName=function(e,t){var i=[],r=t?this.constants.constraints.SW_CHAP_NAME_MAX:this.constants.constraints.HW_CHAP_NAME_MAX;return e&&e.trim().length?e.trim().length>r&&i.push(this.i18nService.getString("StorageUi","storage.adapters.edit.authentication.form.fieldLengthError",r)):i.push(this.i18nService.getString("StorageUi","storage.adapters.edit.authentication.form.errorMessage")),i},e.prototype.isValidSecret=function(e,t){var i=[],r=t?this.constants.constraints.SW_CHAP_SECRET_MAX:this.constants.constraints.HW_CHAP_SECRET_MAX;return e&&e.trim().length?e.trim().length>r&&i.push(this.i18nService.getString("StorageUi","storage.adapters.edit.authentication.form.fieldLengthError",r)):i.push(this.i18nService.getString("StorageUi","storage.adapters.edit.authentication.form.errorMessage")),i},e.$inject=["i18nService","storageAdapterConstants"],e}();e.StorageAdapterEditAuthenticationValidationService=t,angular.module("com.vmware.vsphere.client.storage").service("storageAdapterEditAuthenticationValidationService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.mutationService=t,this.clarityModalService=i,this.clarityConstants=r,this.$q=n}return e.prototype.disable=function(e){var t=this,i=this.getMutationData(!1,e.isIscsiAdapter,e.deviceName);this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("StorageUi","storage.adapters.iscsi.popup.disable.header"),message:this.i18nService.getString("StorageUi","storage.adapters.iscsi.disablePopup.text"),preserveNewlines:!0,defaultButton:"submit",subTitle:{objectId:e.hostId},submit:function(){return t.mutationService.apply(e.hostId,i.type,i.spec).then(function(t){e.onSuccessCallback(t)}),!0}})},e.prototype.enable=function(e){
var t=this.getMutationData(!0,e.isIscsiAdapter,e.deviceName);return this.mutationService.apply(e.hostId,t.type,t.spec)},e.prototype.getMutationData=function(e,t,i){return t?{type:"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterActivationSpec",spec:{activate:e}}:{type:"com.vmware.vsphere.client.storage.adapters.FcoeStorageAdapterRemovalSpec",spec:{mark:!e,hbaName:i}}},e.$inject=["i18nService","mutationService","clarityModalService","clarityConstants","$q"],e}();e.AdapterStatusService=t,angular.module("com.vmware.vsphere.client.storage").service("adapterStatusService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this._type="com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterSettingsUpdateSpec"}return e}();e.SwIscsiEditSettingsSpec=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.mutationService=t,this.clarityModalService=i,this.clarityConstants=r,this.vxValidatorFactory=n}return e.prototype.openModal=function(i,r){var n,o,a=new t,s=r.isSoftwareBased?e.MAX_ALIAS_LENGTH_SWISCSI:e.MAX_ALIAS_LENGTH_HWISCSI;a.device=r.device,a.name=r.iScsiName,a.alias=r.iScsiAlias,o={hostId:i,editSpec:a,i18n:this.i18nService.getString.bind(this,"StorageUi"),errors:{name:"",alias:""},validator:this.vxValidatorFactory.create(),isValidName:function(){var t=[],i=n.dialogData.editSpec.name.trim();return e.ISCSI_EUI_NAME_REGEX.test(i)||e.ISCSI_IQN_NAME_REGEX.test(i)||(t=[n.dialogData.i18n("storage.adapters.properties.general.iSCSINameError")]),(!i||i.length>e.MAX_NAME_LENGTH)&&(t=[n.dialogData.i18n("storage.adapters.properties.general.fieldLengthError",e.MAX_NAME_LENGTH)]),t},isValidAlias:function(){var e=[],t=n.dialogData.editSpec.alias.trim();return t&&t.length>s&&e.push(n.dialogData.i18n("storage.adapters.properties.general.fieldLengthError",s)),e}},n={title:this.i18nService.getString("StorageUi","storage.adapters.iscsi.general.edit.header"),contentTemplate:"storage-ui/resources/storage/views/host/adapters/iscsihba/SwIscsiEditSettingsDialog.html",defaultButton:"submit",dialogData:o,alerts:[]},n.onSubmit=this.onCommit.bind(this,n,r),r.device&&(n.subTitle=r.device),this.clarityModalService.openOkCancelModal(n)},e.prototype.onCommit=function(e,i){if(this.validate(e.dialogData)){var r=e.dialogData.editSpec.name!==i.iScsiName,n=e.dialogData.editSpec.alias!==i.iScsiAlias,o=new t;return o.device=e.dialogData.editSpec.device,!r&&!n||(r&&(o.name=e.dialogData.editSpec.name),n&&(o.alias=e.dialogData.editSpec.alias),this.mutationService.apply(e.dialogData.hostId,o._type,o),!0)}return e.alerts=[{text:e.dialogData.i18n("form.validationError"),type:this.clarityConstants.notifications.type.ERROR}],!1},e.prototype.validate=function(e){var t=e.validator.validate();return!(t&&t.length)},e.$inject=["i18nService","mutationService","clarityModalService","clarityConstants","vxValidatorFactory"],e.ISCSI_IQN_NAME_REGEX=new RegExp("^iqn.[0-9]{4}-[0-9]{2}(?:.[A-Za-z](?:[A-Za-z0-9-]*[A-Za-z0-9])?)+(?::[A-Za-z0-9-._:]*)?$"),e.ISCSI_EUI_NAME_REGEX=new RegExp("^eui.[0-9A-Fa-f]{16}$"),e.MAX_NAME_LENGTH=223,e.MAX_ALIAS_LENGTH_SWISCSI=255,e.MAX_ALIAS_LENGTH_HWISCSI=31,e}();e.SwIscsiEditSettingsDialogService=i,angular.module("com.vmware.vsphere.client.storage").service("swIscsiEditSettingsDialogService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.i18nService=e}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.storage").component("addIpAddressComponent",{templateUrl:"storage-ui/resources/storage/views/host/adapters/network/AddIpAddressModalComponent.html",bindings:{ipInput:"=",validateManually:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=e.InternetScsiHba$IscsiIpv6Address,i=function(){function e(e){this.constants=e,this.IPV6_LINK_LOCAL_PREFIX_LENGTH=64}return e.prototype.createIpv6=function(e){var i=new t;return i.address=e,i.prefixLength=this.IPV6_LINK_LOCAL_PREFIX_LENGTH,i.origin=this.constants.AddressConfigurationType.Static,i.operation=this.constants.IPv6Settings.OPERATION.ADD,i},e.prototype.getLinkLocalIPv6Address=function(e){var t=this.getLinkLocalIPv6(e);return t&&t.address?t.address:""},e.prototype.getLinkLocalIPv6=function(e){var t=this;if(e&&e.ipv6properties){var i=_.find(e.ipv6properties.iscsiIpv6Address,function(e){return e.origin!==t.constants.AddressConfigurationType.Other&&t.isLinkLocalIpv6Address(e.address,e.prefixLength)});return i||null}return null},e.prototype.isLinkLocalIpv6Address=function(e,t){if(void 0===t&&(t=64),!e||t!==this.IPV6_LINK_LOCAL_PREFIX_LENGTH||e.length<4)return!1;var i=parseInt(e.substr(0,4),16);return 65152===(65472&i)},e.prototype.getIPv6AddressesOfType=function(e,t,i){var r=this,n=[];return e&&e.ipv6properties&&e.ipv6properties.iscsiIpv6Address.length?_.filter(e.ipv6properties.iscsiIpv6Address,function(e){return e.origin===t&&!(i&&r.isLinkLocalIpv6Address(e.address,e.prefixLength))}):n},e.$inject=["StorageAdapterNetworkSettingsConstants"],e}();e.HbaNetworkingUtil=i,angular.module("com.vmware.vsphere.client.storage").service("hbaNetworkingUtil",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.vuiConstants=t,this.clarityModalService=i,this.hbaNetworkingUtil=r,this.clarityConstants=n,this.initDatagrid()}return e.prototype.initDatagrid=function(){var e=this;this.datagridOptions={height:"100%",pageConfig:{hidePager:!1},columnDefs:this.getColumnDefs(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,actionBarOptions:{actions:this.getActions()},columnMenu:{sortable:!1,messages:{columns:this.i18nService.getString("CommonUi","listview.showColumnsMenu"),filter:this.i18nService.getString("CommonUi","listview.filterMenu")}},onChange:function(){e.datagridOptions.actionBarOptions.actions[1].enabled=!!e.datagridOptions.selectedItems.length}}},e.prototype.$onInit=function(){this.datagridOptions.data=this.staticAddress},e.prototype.getActions=function(){var e=this,t=this;return[{tooltipText:this.i18nService.getString("StorageUi","IScsiIpv6SettingsPage.addButtonTooltip"),label:this.i18nService.getString("StorageUi","IScsiIpv6SettingsPage.addButtonLabel"),iconClass:"vx-icon-addIcon",enabled:!0,onClick:function(){var i={title:e.i18nService.getString("StorageUi","IScsiIpv6SettingsPage.addButtonTooltip"),contentTemplate:"storage-ui/resources/storage/views/host/adapters/network/AddIpAddress.html",defaultButton:"submit",dialogData:{ipInput:"",validateManually:null},onSubmit:function(){var e=this.dialogData.ipInput;if(this.dialogData.validateManually().length)return!1;var i="";return t.hbaNetworkingUtil.isLinkLocalIpv6Address(e)?i=t.i18nService.getString("StorageUi","Ipv6AddressPage.linkLocalForbiddenError"):_.find(t.datagridOptions.data,function(t){return t.address===e})&&(i=t.i18nService.getString("StorageUi","Ipv6AddressPage.duplicateIpv6AddressNewVnicError",this.dialogData.ipInput)),i?(this.alerts=[{type:t.clarityConstants.notifications.type.ERROR,text:i}],!1):(t.datagridOptions.data=t.datagridOptions.data.concat(t.hbaNetworkingUtil.createIpv6(this.dialogData.ipInput)),t.staticAddress=t.datagridOptions.data,!0)},alerts:[]};e.clarityModalService.openOkCancelModal(i)}},{tooltipText:this.i18nService.getString("StorageUi","IScsiIpv6SettingsPage.removeButtonTooltip"),label:this.i18nService.getString("StorageUi","IScsiIpv6SettingsPage.removeButtonLabel"),iconClass:"vx-icon-removeIcon",enabled:!0,onClick:function(){t.datagridOptions.selectedItems.length&&(t.datagridOptions.data=_.filter(t.datagridOptions.data,function(e){return e.address!==t.datagridOptions.selectedItems[0].address}),t.staticAddress=t.datagridOptions.data)}}]},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.serverColumn"),field:"serverName",template:"#:address#/64"}]},e.$inject=["i18nService","vuiConstants","clarityModalService","hbaNetworkingUtil","clarityConstants"],e}();angular.module("com.vmware.vsphere.client.storage").component("ipAddressGrid",{templateUrl:"storage-ui/resources/storage/views/host/adapters/network/IpAddressGridComponent.html",bindings:{staticAddress:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.i18nService=e,this.dnsStackBlockExpanded=!1,this.i18n=function(t){return e.getString("StorageUi",t)}}return e.prototype.$onInit=function(){this.model.isPreferedDnsSupported||(this.model.properties.primaryDnsServerAddress=this.i18n("storage.adapters.properties.notSupportedLabel")),this.model.isAlternateDnsSupported||(this.model.properties.alternateDnsServerAddress=this.i18n("storage.adapters.properties.notSupportedLabel"))},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.storage").component("storageAdapterDnsSettingsComponent",{templateUrl:"storage-ui/resources/storage/views/host/adapters/network/StorageAdapterDnsSettingsComponent.html",bindings:{model:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=e.InternetScsiStorageAdapterIpConfigurationUpdateSpec,i=e.InternetScsiHba$IPProperties,r=e.InternetScsiHba$IPv6Properties,n=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.clarityModalService=t,this.constants=i,this.vxValidatorFactory=r,this.mutationService=n,this.hbaNetworkingUtil=o,this.clarityConstants=a}return e.prototype.open=function(e,n,o){var a=this,s=new t;s.device=n.device,s.properties=_.clone(o.properties),this.dialogData={constants:this.constants,model:this.clone(o),validator:this.vxValidatorFactory.create(),spec:s,ipv4StackBlockExpanded:!0,ipv6StackBlockExpanded:!1,dnsStackBlockExpanded:!1,i18n:this.i18nService.getString,ipv6options:[{name:this.i18nService.getString("Common","enabled"),value:!0},{name:this.i18nService.getString("Common","disabled"),value:!1}],ipv6LinkLocalAddress:null};var c={title:this.i18nService.getString("StorageUi","storage.adapters.properties.ipDnsConfig.edit.h5header"),subTitle:{text:n.device},defaultButton:"submit",size:"lg",alerts:[],dialogData:this.dialogData,contentTemplate:"storage-ui/resources/storage/views/host/adapters/network/StorageAdapterEditNetworkSettingsDialog.html",onSubmit:function(){var n=a.dialogData.validator.validate();if(n.length)return c.alerts=_.map(n,function(e){return{text:e,type:a.clarityConstants.notifications.type.ERROR}}),!1;var o=new t;return o.device=s.device,o.properties=new i,o.properties.ipv6properties=new r,(a.updateIpv4PageData(o.properties)||a.updateIpv6PageData(o.properties)||a.updateDnsPageData(o.properties))&&a.mutationService.apply(e,o._type,o),!0}};this.clarityModalService.openOkCancelModal(c)},e.prototype.clone=function(e){var t=_.clone(e);return t.properties=_.clone(e.properties),t.properties.ipv6properties=_.clone(e.properties.ipv6properties),t},e.prototype.updateIpv4PageData=function(e){var t=!1,i=this.dialogData.model,r=i.properties,n=i.capabilities,o=this.dialogData.spec.properties;if(!n.ipv4EnableSettable&&!r.ipv4Enabled)return!1;if(!n.ipConfigurationMethodSettable&&r.dhcpConfigurationEnabled)return!1;if(n.ipv4EnableSettable&&(t=o.ipv4Enabled!==r.ipv4Enabled,t&&(e.ipv4Enabled=r.ipv4Enabled),!r.ipv4Enabled))return t;if(n.ipConfigurationMethodSettable&&(t=t||o.dhcpConfigurationEnabled!==r.dhcpConfigurationEnabled,t&&(e.dhcpConfigurationEnabled=r.dhcpConfigurationEnabled),r.dhcpConfigurationEnabled))return t;var a=n.subnetMaskSettable||n.addressSettable,s=e.ipv4Enabled===!0||e.dhcpConfigurationEnabled===!1,c=o.address!==r.address||o.subnetMask!==r.subnetMask||s;a&&c&&(e.address=r.address,e.subnetMask=r.subnetMask,t=!0);var l=o.defaultGateway!==r.defaultGateway||s;return n.defaultGatewaySettable&&l&&(e.defaultGateway=r.defaultGateway,e.address=r.address,e.subnetMask=r.subnetMask,t=!0),t},e.prototype.updateIpv6PageData=function(e){var t=this,i=!1,r=this.dialogData.spec.properties,n=this.dialogData.selectedOption===this.constants.IPv6Settings.LINK_LOCAL,o=this.dialogData.model.properties,a=this.dialogData.model.capabilities,s=r.ipv6properties,c=o.ipv6properties,l=e.ipv6properties;if(!a.ipv6Supported)return!1;if(!a.ipv6EnableSettable&&!o.ipv6Enabled)return!1;if(a.ipv6EnableSettable&&(i=r.ipv6Enabled!==o.ipv6Enabled,i&&(e.ipv6Enabled=o.ipv6Enabled),!o.ipv6Enabled))return i;a.ipv6DhcpConfigurationSettable&&s.ipv6DhcpConfigurationEnabled!==c.ipv6DhcpConfigurationEnabled&&(l.ipv6DhcpConfigurationEnabled=c.ipv6DhcpConfigurationEnabled,i=!0),a.ipv6RouterAdvertisementConfigurationSettable&&s.ipv6RouterAdvertisementConfigurationEnabled!==c.ipv6RouterAdvertisementConfigurationEnabled&&(l.ipv6RouterAdvertisementConfigurationEnabled=c.ipv6RouterAdvertisementConfigurationEnabled,i=!0);var d=null;if(a.ipv6LinkLocalAutoConfigurationSettable){s.ipv6LinkLocalAutoConfigurationEnabled!==c.ipv6LinkLocalAutoConfigurationEnabled&&(l.ipv6LinkLocalAutoConfigurationEnabled=c.ipv6LinkLocalAutoConfigurationEnabled,i=!0);var u=this.dialogData.ipv6LinkLocalAddress!==this.hbaNetworkingUtil.getLinkLocalIPv6Address(r);!c.ipv6LinkLocalAutoConfigurationEnabled&&u&&(d=this.hbaNetworkingUtil.createIpv6(this.dialogData.ipv6LinkLocalAddress),l.iscsiIpv6Address=[d],i=u)}var p=c.ipv6DhcpConfigurationEnabled||c.ipv6RouterAdvertisementConfigurationEnabled,v=this.getIPv6StaticAddressesList(r);if(!p){var m=this.isStaticIpv6Dirty(c.iscsiIpv6Address,v);i=i||m,(m||n)&&(l.iscsiIpv6Address=l.iscsiIpv6Address||[],_.each(v,function(e){_.find(c.iscsiIpv6Address,function(t){return e.address===t.address})||(e.operation=t.constants.IPv6Settings.OPERATION.REMOVE,l.iscsiIpv6Address.push(e))}),_.each(c.iscsiIpv6Address,function(e){_.find(v,function(t){return e.address===t.address})||(e.operation=t.constants.IPv6Settings.OPERATION.ADD,l.iscsiIpv6Address.push(e))}))}return a.ipv6DefaultGatewaySettable&&s.ipv6DefaultGateway!==c.ipv6DefaultGateway&&(l.ipv6DefaultGateway=c.ipv6DefaultGateway,i=!0),i},e.prototype.isStaticIpv6Dirty=function(e,t){return e=_.pluck(_.sortBy(e,function(e){return e.address}),"address"),t=_.pluck(_.sortBy(t,function(e){return e.address}),"address"),!_.isEqual(e,t)},e.prototype.getIPv6StaticAddressesList=function(e){var t=[];return e&&e.ipv6properties&&e.ipv6properties.iscsiIpv6Address.length?(_.each(this.hbaNetworkingUtil.getIPv6AddressesOfType(e,this.constants.AddressConfigurationType.Static,!0),function(e){t.push(e)}),e.ipv6properties.ipv6RouterAdvertisementConfigurationEnabled&&_.each(this.hbaNetworkingUtil.getIPv6AddressesOfType(e,this.constants.AddressConfigurationType.AutoConfigured,!0),function(e){t.push(e)}),e.ipv6properties.ipv6DhcpConfigurationEnabled&&_.each(this.hbaNetworkingUtil.getIPv6AddressesOfType(e,this.constants.AddressConfigurationType.DHCP,!0),function(e){t.push(e)}),t):t},e.prototype.updateDnsPageData=function(e){var t=!1,i=this.dialogData.spec.properties,r=this.dialogData.model.properties,n=this.dialogData.model.capabilities;return n.primaryDnsServerAddressSettable&&r.primaryDnsServerAddress!==i.primaryDnsServerAddress&&(e.primaryDnsServerAddress=r.primaryDnsServerAddress,t=!0),n.alternateDnsServerAddressSettable&&r.alternateDnsServerAddress!==i.alternateDnsServerAddress&&(e.alternateDnsServerAddress=r.alternateDnsServerAddress,t=!0),t},e.$inject=["i18nService","clarityModalService","StorageAdapterNetworkSettingsConstants","vxValidatorFactory","mutationService","hbaNetworkingUtil","clarityConstants"],e}();e.StorageAdapterEditNetworkSettingsDialogService=n,angular.module("com.vmware.vsphere.client.storage").service("storageAdapterEditNetworkSettingsDialogService",n)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.i18nService=e,this.constants=t,this.ipParserService=i,this.vxValidatorFactory=r,this.validateIpv4Address=function(e){return!n.isStatic()||e&&n.ipParserService.isIpv4AddressValid(e)?[]:[n.i18nService.getString("StorageUi","storage.adapters.properties.ipDnsConfig.invalidV4")]},this.validateIpv4Mask=function(e){return!n.isStatic()||e&&n.ipParserService.isSubnetMaskValid(e)?[]:[n.i18nService.getString("StorageUi","storage.adapters.properties.ipDnsConfig.invalidSubnetMask")]},this.i18n=function(t){return e.getString("StorageUi",t)}}return e.prototype.$onInit=function(){var e=this.model.properties;e.ipv4Enabled?e.ipv4Enabled&&e.dhcpConfigurationEnabled?this.selectedOption=this.constants.IPv4Settings.DHCP:e.ipv4Enabled&&!e.dhcpConfigurationEnabled&&(this.selectedOption=this.constants.IPv4Settings.STATIC):this.selectedOption=this.constants.IPv4Settings.NONE,this.validator=this.vxValidatorFactory.create()},e.prototype.isStatic=function(){return this.selectedOption===this.constants.IPv4Settings.STATIC},e.prototype.onChange=function(e){if(e)switch(e){case this.constants.IPv4Settings.NONE:this.model.properties.ipv4Enabled=!1;break;case this.constants.IPv4Settings.DHCP:this.model.properties.dhcpConfigurationEnabled=!0,this.model.properties.ipv4Enabled=!0;break;case this.constants.IPv4Settings.STATIC:this.model.properties.ipv4Enabled=!0,this.model.properties.dhcpConfigurationEnabled=!1}},e.$inject=["i18nService","StorageAdapterNetworkSettingsConstants","ipParserService","vxValidatorFactory"],e}();angular.module("com.vmware.vsphere.client.storage").component("storageAdapterIpV4SettingsComponent",{templateUrl:"storage-ui/resources/storage/views/host/adapters/network/StorageAdapterIPv4SettingsComponent.html",bindings:{model:"=",validator:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.constants=t,this.ipParserService=i,this.vxValidatorFactory=r,this.hbaNetworkingUtil=n,this.validateManually={}}return e.prototype.$onInit=function(){var e=this;this.linkLocalAddress=this.getLinkLocalAddress(),this.model.properties.ipv6properties.iscsiIpv6Address=_.filter(this.model.properties.ipv6properties.iscsiIpv6Address,function(t){return t.address!==e.linkLocalAddress})||[],this.staticIpv6Address=this.model.properties.ipv6properties.iscsiIpv6Address||[],this.populateSelection(),this.validator.validate=_.wrap(this.validator.validate,function(t){var i=t.call(e.validator);return _.each(e.validateManually,function(e){i=i.concat(e())}),e.selectedOption===e.constants.IPv6Settings.STATIC&&(e.model.properties.ipv6properties.iscsiIpv6Address.length||i.push(e.i18nService.getString("StorageUi","storage.adapters.properties.ipDnsConfig.emptyStaticV6Addresses"))),i})},e.prototype.isStatic=function(){return this.selectedOption===this.constants.IPv6Settings.STATIC},e.prototype.isLinkLocal=function(){return this.selectedOption===this.constants.IPv6Settings.LINK_LOCAL},e.prototype.getLinkLocalAddress=function(){return this.hbaNetworkingUtil.getLinkLocalIPv6Address(this.model.properties)},e.prototype.populateSelection=function(){var e=this.model.properties,t=this.constants.IPv6Settings;e.ipv6properties.ipv6DhcpConfigurationEnabled?this.selectedOption=t.DHCP:e.ipv6properties.ipv6RouterAdvertisementConfigurationEnabled?this.selectedOption=t.ROUTER:this.linkLocalAddress&&!this.staticIpv6Address.length?this.selectedOption=t.LINK_LOCAL:this.selectedOption=t.STATIC},e.prototype.changeStaticAddress=function(e){this.model.properties.ipv6properties.iscsiIpv6Address=[this.hbaNetworkingUtil.createIpv6(e)]},e.prototype.onSelectionChange=function(e){var t=this.model.properties.ipv6properties;switch(e){case this.constants.IPv6Settings.DHCP:t.ipv6DhcpConfigurationEnabled=!0,t.ipv6RouterAdvertisementConfigurationEnabled=!1;break;case this.constants.IPv6Settings.ROUTER:t.ipv6DhcpConfigurationEnabled=!1,t.ipv6RouterAdvertisementConfigurationEnabled=!0;break;case this.constants.IPv6Settings.LINK_LOCAL:var i=this.hbaNetworkingUtil.getLinkLocalIPv6(this.model.properties);t.iscsiIpv6Address=i?[i]:[],t.ipv6DhcpConfigurationEnabled=!1,t.ipv6RouterAdvertisementConfigurationEnabled=!1;break;case this.constants.IPv6Settings.STATIC:t.ipv6DhcpConfigurationEnabled=!1,t.ipv6RouterAdvertisementConfigurationEnabled=!1}},e.$inject=["i18nService","StorageAdapterNetworkSettingsConstants","ipParserService","vxValidatorFactory","hbaNetworkingUtil"],e}();angular.module("com.vmware.vsphere.client.storage").component("storageAdapterIpV6SettingsComponent",{templateUrl:"storage-ui/resources/storage/views/host/adapters/network/StorageAdapterIPv6SettingsComponent.html",bindings:{model:"=",validator:"=",linkLocalAddress:"=",selectedOption:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){angular.module("com.vmware.vsphere.client.storage").constant("StorageAdapterNetworkSettingsConstants",{IPv4Settings:{NONE:"none",DHCP:"dhcp",STATIC:"static"},IPv6Settings:{DHCP:"dhcp",ROUTER:"router",STATIC:"static",LINK_LOCAL:"linkLocal",OPERATION:{ADD:"add",REMOVE:"remove"}},AddressConfigurationType:{DHCP:"DHCP",AutoConfigured:"AutoConfigured",Static:"Static",Other:"Other"}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.tabs=[{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.properties.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/StorageAdaptersGeneralDetailsView.html",uid:"storage.adapters.generalTab"},{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.devices.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/StorageAdaptersDevicesDetailsView.html",uid:"storage.adapters.devicesTab"},{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.paths.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/StorageAdaptersPathsDetailsView.html",uid:"storage.adapters.pathsTab"},{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.iscsiDynamicTargets.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/targets/IscsiDynamicTargetsDetailsView.html",uid:"storage.adapters.dynamicTargetsTab",metadata:{relevantFor:"isIscsiAdapter"}},{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.iscsiStaticTargets.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/targets/IscsiStaticTargetsDetailsView.html",uid:"storage.adapters.staticTargetsTab",metadata:{relevantFor:"isIscsiAdapter"}},{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.networkSettings.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/StorageAdaptersNetworkSettingsView.html",uid:"storage.adapters.networkSettingsTab",metadata:{relevantFor:"isIscsiAdapter, !isSoftwareBased"}},{name:this.i18nService.getString("NetworkUi","storage.adapters.tabs.networkPortBinding.header"),templateUrl:"network-ui/resources/network/views/host/iscsi/IscsiPortBindingView.html",uid:"storage.adapters.networkPortBindingsTab",metadata:{relevantFor:"portBindableIScsi"}},{name:this.i18nService.getString("StorageUi","storage.adapters.tabs.advancedOptions.header"),templateUrl:"storage-ui/resources/storage/views/host/adapters/advanced/IscsiAdvancedOptionsDetailsView.html",uid:"storage.adapters.iscsiAdvancedOptions",metadata:{relevantFor:"isIscsiAdapter"}}],this.detailsViewData={tabsPromise:this.$q.when(this.tabs)}}return e.$inject=["i18nService","$q"],e}();e.StorageAdaptersMasterViewController=t,angular.module("com.vmware.vsphere.client.storage").controller("StorageAdaptersMasterViewController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.actionsService=t,this.$q=i,this.hostStorageConstants=r,this.mutationService=n}return e.prototype.isIscsiAdapterConfigurable=function(e,t){var i=this.$q.defer();return t.isSoftwareBased&&(_.isUndefined(t.canBeDisabled)||t.canBeDisabled)?this.mutationService.validate(e,"com.vmware.vsphere.client.storage.adapters.InternetScsiStorageAdapterActivationSpec",{activate:!0}).then(function(e){e&&(e.result||e.error)?i.resolve(!0):i.resolve(!1)})["catch"](function(){i.resolve(!1)}):i.resolve(!0),i.promise},e.prototype.getBuilder=function(e,t){if(t.type===this.hostStorageConstants.hostAdapterTypes.ISCSI){var r=this.isIscsiAdapterConfigurable(e,t);return new i(e,t,this.i18nService,this.actionsService,this.$q,this.hostStorageConstants,r)}return new i(e,t,this.i18nService,this.actionsService,this.$q,this.hostStorageConstants,this.$q.when(!1))},e.$inject=["i18nService","actionsService","$q","hostStorageConstants","mutationService"],e}(),i=function(){function e(e,t,i,r,n,o,a){var s=this;this.hostId=e,this.adapter=t,this.i18nService=i,this.actionsService=r,this.$q=n,this.hostStorageConstants=o,this.isIscsiAdapterConfigurable=a,this.actionEvaluations={},this.ACTIONS=this.initActions(this.hostStorageConstants.adapterDetailsAction);for(var c=0,l=this.ACTIONS;c<l.length;c++){var d=l[c];this.actionEvaluations[d.uid]=this.$q.defer()}r.getActions([e],_.map(this.ACTIONS,function(e){return e.uid})).then(function(e){for(var t=function(e){var t=s.findAction(e.action.uid);a.then(function(i){t.isEnabled=s.isActionEnabled(e,i)}),s.actionEvaluations[e.action.uid].resolve(e)},i=0,r=e;i<r.length;i++){var n=r[i];t(n)}})}return e.prototype.initActions=function(e){return[{uid:e.ENABLE_SW_ISCSI_ADAPTER,propertyViewActionDef:{title:this.i18nService.getString("StorageUi","storage.adapters.iscsi.button.labelEnable"),isEnabled:!0,clickHandler:this.getInvokeActionFunction(e.ENABLE_SW_ISCSI_ADAPTER)}},{uid:e.DISABLE_SW_ISCSI_ADAPTER,propertyViewActionDef:{title:this.i18nService.getString("StorageUi","storage.adapters.iscsi.button.labelDisable"),isEnabled:!0,clickHandler:this.getInvokeActionFunction(e.DISABLE_SW_ISCSI_ADAPTER)}},{uid:e.EDIT_AUTH_SETTINGS,propertyViewActionDef:{title:this.i18nService.getString("StorageUi","generalEditAction.label"),isEnabled:!0,clickHandler:this.getInvokeActionFunction(e.EDIT_AUTH_SETTINGS)}},{uid:e.EDIT_GENERAL_SETTINGS,propertyViewActionDef:{title:this.i18nService.getString("StorageUi","generalEditAction.label"),isEnabled:!0,clickHandler:this.getInvokeActionFunction(e.EDIT_GENERAL_SETTINGS)}}]},e.prototype.isActionEnabled=function(e,t){return e.action.uid===this.hostStorageConstants.adapterDetailsAction.EDIT_GENERAL_SETTINGS?e.available&&t:e.available},e.prototype.getInvokeActionFunction=function(e){var t=this;return function(){if(t.actionEvaluations[e]){var i=t.$q.defer();return t.actionEvaluations[e].promise.then(function(e){t.actionsService.invokeAction(e,{adapter:t.adapter,callback:function(e){return i.resolve(e)}})}),i.promise}return t.$q.reject()}},e.prototype.findAction=function(e){return _.find(this.ACTIONS,function(t){return t.uid===e}).propertyViewActionDef},e.prototype.setEnableActionSuccess=function(e){return this.setActionClickHandler(this.hostStorageConstants.adapterDetailsAction.ENABLE_SW_ISCSI_ADAPTER,e),this},e.prototype.setDisableActionSuccess=function(e){return this.setActionClickHandler(this.hostStorageConstants.adapterDetailsAction.DISABLE_SW_ISCSI_ADAPTER,e),this},e.prototype.setActionClickHandler=function(e,t){var i=this,r=this.findAction(e);r.clickHandler=function(){i.getInvokeActionFunction(e)().then(function(e){e&&!e.error&&t()})}},e}();angular.module("com.vmware.vsphere.client.storage").service("storageAdapterActionsService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){angular.module("com.vmware.vsphere.client.storage").constant("storageAdapterConstants",{constraints:{HW_CHAP_NAME_MAX:255,SW_CHAP_NAME_MAX:511,HW_CHAP_SECRET_MAX:100,SW_CHAP_SECRET_MAX:255},authentication:{PROHIBITED:"chapProhibited",DISCOURAGED:"chapDiscouraged",PREFERRED:"chapPreferred",REQUIRED:"chapRequired",MUTUAL:"MUTUAL"},EXISTING_PASSWORD_PLACEHOLDER:"••••••••••••"})}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i){function r(){return e.masterDetailsViewContext.selectedItem?e.masterDetailsViewContext.selectedItem.key:null}var n=this;n.storageDevicesLoading=!1,n.hostId=i.getRoute().objectId,n.viewId=i.getRoute().extensionId+"_devices",n.cache={},e.$watch(function(){return e.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&n.refresh()}),n.refresh=function(){var e=r();if(e){var i=n.hostId,o=i+"-"+e;n.cache.hasOwnProperty(o)?n.devices=n.cache[o]:n.storageDevicesLoading=!0,t.retrieveStorageDevicesData(i,e).then(function(t){n.cache[o]=t,i===n.hostId&&e===r()&&(n.devices=t)})["finally"](function(){i===n.hostId&&e===r()&&(n.storageDevicesLoading=!1)})}},n.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("StorageAdaptersDevicesDetailsViewController",e),e.$inject=["$scope","hostStorageService","navigation"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){return t.masterDetailsViewContext&&t.masterDetailsViewContext.selectedItem}function c(){var e=s();if(e)if(e.type===n.hostAdapterTypes.FCOE){v.loading=!0;var t={propertyParams:[{propertyName:p,parameterType:"java.lang.String",parameter:e.underlyingNic}]};r.getProperties(m,[p],t).then(function(t){u({adapter:e,fcoeConfig:t[p]})},function(){u({adapter:e})})["finally"](function(){v.loading=!1})}else u(e.type===n.hostAdapterTypes.ISCSI?{adapter:e,hostId:m}:{adapter:e})}function l(){var e=t.masterDetailsViewContext.alertMessenger;e.addRestartMessage(s().key)}function d(){var e=t.masterDetailsViewContext.alertMessenger;e.removeRestartMessage(s().key)}function u(r){var o=r.adapter;if(o){var s,c=!0;o.type===n.hostAdapterTypes.FCOE&&(c=!o.isMarkedForRemoval,s=c?e.getString("StorageUi","storage.adapters.iscsi.status.enabled"):e.getString("StorageUi","storage.adapters.iscsi.status.disabled")),o.type===n.hostAdapterTypes.ISCSI&&o.isSoftwareBased&&o.canBeDisabled&&(c=t.masterDetailsViewContext.hostAdaptersData.isIScsiEnabledOnHost===!0,s=c?e.getString("StorageUi","storage.adapters.iscsi.status.enabled"):e.getString("StorageUi","storage.adapters.iscsi.status.disabled"));var u=i.createPropertyViewBuilder(),p=u.category(e.getString("StorageUi","storage.devices.properties.generalHeader"),0),g=a.getBuilder(m,o).setEnableActionSuccess(d).setDisableActionSuccess(l),h=g.findAction(c?"vsphere.core.host.actions.adapters.disableSoftwareIscsiAdapter":"vsphere.core.host.actions.adapters.enableSoftwareIscsiAdapter");s&&p.section("adapterStatus").title(e.getString("StorageUi","storage.adapters.iscsi.status.sectionHeader")).property(e.getString("StorageUi","storage.adapters.iscsi.status.label"),s).action(h);var f=p.section("generalSection").title(e.getString("StorageUi","storage.devices.properties.generalHeader")).property(e.getString("StorageUi","storage.adapters.deviceName"),o.device).property(e.getString("StorageUi","storage.adapters.deviceModel"),o.model);if(o.type!==n.hostAdapterTypes.FIBRECHANNEL&&o.type!==n.hostAdapterTypes.FCOE||f.property(e.getString("StorageUi","storage.adapters.properties.general.wwnn"),o.formattedNodeWorldWideName).property(e.getString("StorageUi","storage.adapters.properties.general.wwpn"),o.formattedPortWorldWideName),o.type===n.hostAdapterTypes.ISCSI){var S=g.findAction("vsphere.core.host.actions.adapters.editIscsiGeneralSettings");f.action(S)}o.type===n.hostAdapterTypes.FCOE&&p.section("fcoeNetworkProperties").title(e.getString("StorageUi","storage.adapters.properties.netProps.sectionHeader")).property(e.getString("StorageUi","storage.adapters.properties.netProps.networkAdapter"),o.underlyingNic).property(e.getString("StorageUi","storage.adapters.properties.netProps.vlanId"),o.linkInfo?o.linkInfo.vlanId:"").property(e.getString("StorageUi","storage.adapters.properties.netProps.priorityClass"),r.fcoeConfig?r.fcoeConfig.priorityClass:"").property(e.getString("StorageUi","storage.adapters.properties.netProps.vnPortMac"),o.linkInfo?o.linkInfo.vnportMac:"").property(e.getString("StorageUi","storage.adapters.properties.netProps.fcfMac"),o.linkInfo?o.linkInfo.fcfMac:""),o.type===n.hostAdapterTypes.ISCSI&&f.property(e.getString("StorageUi","storage.adapters.properties.general.iscsiName"),o.iScsiName).property(e.getString("StorageUi","storage.adapters.properties.general.iscsiAlias"),o.iScsiAlias).property(e.getString("StorageUi","storage.adapters.properties.general.iscsiTargets"),o.formattedDiscoveryProperties),
o.type===n.hostAdapterTypes.ISCSI&&o.isSoftwareBased===!1&&p.section("networkInterface").title(e.getString("StorageUi","storage.adapters.properties.netInt.sectionHeader")).property(e.getString("StorageUi","storage.adapters.properties.netInt.currentMaximumSpeed"),e.getString("StorageUi","storage.adapters.properties.netInt.currentMaximumSpeedValueString",o.currentSpeedInMbit,o.maxSpeedInMbit)).property(e.getString("StorageUi","storage.adapters.properties.netInt.macAddress"),o.macAddress),o.type===n.hostAdapterTypes.ISCSI&&p.section("authenticationSection").title(e.getString("StorageUi","storage.adapters.properties.authentication.sectionHeader")).property(e.getString("StorageUi","storage.adapters.properties.authentication.method"),o.localizedAuthenticationMethod).action(g.findAction("vsphere.core.host.actions.adapters.editIscsiAuthenticationSettings")),v.propertyViewData=u.build()}}var p="storageadapter:fcoeConfig",v=this,m=o.getRoute().objectId;t.$watch(function(){return t.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&c()}),c()}angular.module("com.vmware.vsphere.client.storage").controller("StorageAdaptersGeneralDetailsViewController",e),e.$inject=["i18nService","$scope","vxPropertyViewService","dataService","hostStorageConstants","navigation","storageAdapterActionsService"]}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){var c=this;this.dataService=e,this.i18nService=t,this.navigation=i,this.$scope=r,this.propertyViewService=n,this.hostStorageConstants=o,this.hostConnectionState=a,this.modalService=s,this.NETWORK_SETTINGS_PROPERTY="storageadapter:networkSettings",this.isHostAvailable=function(){var e=c.navigation.getRoute().objectId,t=c.hostConnectionState;return c.dataService.getProperties(e,["runtime"]).then(function(e){var i=e.runtime;return i.connectionState===t.CONNECTED&&!i.inMaintenanceMode})},this.loadData=function(){var e=c,t=c.navigation.getRoute().objectId,i=c.$scope.masterDetailsViewContext.selectedItem.key;c.dataService.getProperties(t,[c.NETWORK_SETTINGS_PROPERTY],{propertyParams:[{propertyName:c.NETWORK_SETTINGS_PROPERTY,parameterType:"java.lang.String",parameter:i}]}).then(function(t){t[c.NETWORK_SETTINGS_PROPERTY]&&e.buildPropertyView(t[c.NETWORK_SETTINGS_PROPERTY])})["finally"](function(){e.loading=!1})},this.i18n=t;var l=r.$watch(function(){return c.$scope.masterDetailsViewContext.selectedItem},this.loadData);r.$on("$destroy",function(){l()})}return e.prototype.buildPropertyView=function(e){var t=this,i=this,r=this.$scope.masterDetailsViewContext.selectedItem,n=this.propertyViewService.createPropertyViewBuilder(),o=function(e){return t.i18nService.getString("StorageUi",e)},a=o("storage.adapters.properties.notSupportedLabel"),s=o("storage.adapters.properties.notEnabledLabel"),c=n.category("category").section("general").title(o("storage.adapters.properties.ipDnsConfig.sectionHeader"));r.type===this.hostStorageConstants.hostAdapterTypes.ISCSI&&this.isHostAvailable().then(function(n){c.action({title:t.i18nService.getString("StorageUi","generalEditAction.label"),isEnabled:n,clickHandler:function(){var t=i.navigation.getRoute().objectId;i.modalService.open(t,r,e)}})}),e.isIpv4Supported?e.isIpv4Enabled?c.property(o("storage.adapters.properties.ipDnsConfig.ipAddress"),e.ipv4Address).property(o("storage.adapters.properties.ipDnsConfig.subnetMask"),e.ipv4SubnetMask).property(o("storage.adapters.properties.ipDnsConfig.defaultGateway"),e.ipv4DefaultGateway):c.property(o("storage.adapters.properties.ipDnsConfig.ipAddress"),s):c.property(o("storage.adapters.properties.ipDnsConfig.ipAddress"),a),e.isIpv6Supported?e.isIpv6Enabled?(c.property(o("storage.adapters.properties.ipDnsConfig.ipV6Address"),e.ipv6Address),c.property(o("storage.adapters.properties.ipDnsConfig.defaultGatewayV6"),e.ipv6DefaultGateway)):c.property(o("storage.adapters.properties.ipDnsConfig.ipV6Address"),s):c.property(o("storage.adapters.properties.ipDnsConfig.ipV6Address"),a),c.property(o("storage.adapters.properties.ipDnsConfig.preferredDns"),e.isPreferedDnsSupported?e.preferedDns:a).property(o("storage.adapters.properties.ipDnsConfig.alternateDns"),e.isAlternateDnsSupported?e.alternateDns:a),this.networkSettings=n.build()},e.$inject=["dataService","i18nService","navigation","$scope","vxPropertyViewService","hostStorageConstants","hostConnectionState","storageAdapterEditNetworkSettingsDialogService"],e}();angular.module("com.vmware.vsphere.client.storage").controller("StorageAdaptersNetworkSettingsController",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i){function r(){return e.masterDetailsViewContext.selectedItem?e.masterDetailsViewContext.selectedItem.key:null}var n=this;n.loading=!1,n.hostId=i.getRoute().objectId,n.viewId=i.getRoute().extensionId+"_paths",n.cache={},e.$watch(function(){return e.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&n.refresh()}),n.refresh=function(){var e=r();if(e){var i=n.hostId,o=i+"-"+e;n.cache.hasOwnProperty(o)?n.paths=n.cache[o]:n.loading=!0,t.retrieveHostStorageAdapterPathsData(i,e).then(function(t){n.cache[o]=t,n.hostId===i&&r()===e&&(n.paths=t)})["finally"](function(){n.hostId===i&&r()===e&&(n.loading=!1)})}},n.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("StorageAdaptersPathsDetailsViewController",e),e.$inject=["$scope","hostStorageService","navigation"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d){function u(){return s.updateActionBar(P.datagridOptions,[P.hostId],[{actionId:f.ADD_ADAPTER,getActionInvocationContext:function(){return{callback:function(e){var i=p(e);i&&t.masterDetailsViewContext.alertMessenger.removeRestartMessage(i.key)}}}},{actionId:f.REFRESH_STORAGE_SYSTEM,getActionInvocationContext:function(){return{callback:function(){P.refresh()}}}},{actionId:f.RESCAN_ADAPTERS},i.actions.SEPARATOR,{actionId:f.RESCAN_HBA,isActionAvailable:function(e){return e.available&&P.datagridOptions.selectedItems.length>0},getActionInvocationContext:function(){if(P.datagridOptions.selectedItems.length>0){var e=P.datagridOptions.selectedItems[0].key;return{adapterKey:e,callback:function(){t.masterDetailsViewContext.alertMessenger.removeRescanMessage(e)}}}return{}}}])}function p(e){return _.find(P.datagridOptions.data,function(t){var i=e&&t.type===l.hostAdapterTypes.ISCSI&&t.isSoftwareBased,r=!e&&t.type===l.hostAdapterTypes.FIBRECHANNEL;return i||r})}function v(){return[{displayName:e.getString("StorageUi","storage.adapters.adapter"),field:"device",width:"150px",template:m()},{displayName:e.getString("StorageUi","storage.adapters.deviceModel"),field:"model",width:"250px",visible:!1,template:"#:model#"},{displayName:e.getString("StorageUi","storage.adapters.type"),field:"localizedType",width:"80px",template:"#:localizedType#"},{displayName:e.getString("StorageUi","storage.adapters.status"),field:"localizedStatus",width:"80px",template:"#:localizedStatus#"},{displayName:e.getString("StorageUi","storage.adapters.wwn"),field:"identifier",width:"210px",template:"#:identifier#"},{displayName:e.getString("StorageUi","storage.adapters.numberTargets"),field:"numberOfTargets",type:"number",width:"70px",sortable:function(e,t){return o.compareNumericValues(e,t,"numberOfTargets")},template:"#:numberOfTargets#"},{displayName:e.getString("StorageUi","storage.adapters.numberDevices"),field:"numberOfDevices",type:"number",width:"70px",sortable:function(e,t){return o.compareNumericValues(e,t,"numberOfDevices")},template:"#:numberOfDevices#"},{displayName:e.getString("StorageUi","storage.adapters.numberPaths"),field:"numberOfPaths",type:"number",width:"65px",sortable:function(e,t){return o.compareNumericValues(e,t,"numberOfPaths")},template:"#:numberOfPaths#"}]}function m(){return function(e){var i=n.getColumnRenderer("icon-text-ex"),r={icon:["vsphere-icon-scsi-adapter"]};return t.masterDetailsViewContext.alertMessenger.isMessageAvailable(e.key)&&(r.icon="vsphere-icon-scsi-adapter-warning"),i(["device"],e,r)}}function g(e){function t(e){return _.map(e,function(e){return e.text})}function i(){var e=_.filter(d,function(e){return e.type===s});return e.length>1?[a("StorageUi",l[s].multiple)]:1===e.length?t(e):[]}function r(){var e=_.filter(d,function(e){return e.type===c});return e.length>=1?[a("StorageUi",l[c])]:[]}function n(e,t,i){var r=_.find(d,function(e){return e.type===i&&e.key===t});return!r&&(d.push({text:e,type:i,key:t}),!0)}function o(e,t){var i=_.findIndex(d,function(i){return e===i.key&&i.type===t});i>-1&&d.splice(i,1)}var a=e,s="rescan",c="restart",l={};l[s]={single:"storage.adapters.warning.rescanNeeded",multiple:"storage.adapters.warning.rescanNeededMulti"},l[c]="storage.adapters.iscsi.warning";var d=[];return{addRescanMessage:function(e,t){return n(a("StorageUi",l[s].single,t),e,s)},addRestartMessage:function(e){return n(a("StorageUi",l[c]),e,c)},removeMessages:function(){d=[]},removeRescanMessages:function(){d=_.filter(d,function(e){return e.type!==s})},removeRescanMessage:function(e){o(e,s)},removeRestartMessage:function(e){o(e,c)},getMessages:function(){var e=i(),t=r();return[].concat(e,t)},isMessageAvailable:function(e){return!_.isUndefined(_.find(d,function(t){return e===t.key}))}}}var h=e.getString("StorageUi","storage.adapters.type.ISCSI"),f={REFRESH_STORAGE_SYSTEM:"vsphere.core.host.actions.refreshStorageSystem",RESCAN_HBA:"vsphere.core.host.actions.rescanHba",ADD_ADAPTER:"vsphere.core.host.actions.adapters.addSoftwareAdapter",RESCAN_ADAPTERS:"vsphere.core.host.actions.rescanHost"},S="storageadapter:hostStorageAdapters",y="isHostConnectedAndPoweredOn",P=this;P.hostId=c.getRoute().objectId,P.headerOptions={title:e.getString("StorageUi","storage.adapters.header"),objectId:P.hostId,actions:[]},P.storageAdaptersLoading=!1,P.liveRefreshProperties=["config.storageDevice.hostBusAdapter","config.storageDevice.softwareInternetScsiEnabled","config.storageDevice.scsiTopology.adapter","config.storageDevice.plugStoreTopology.adapter","config.firewall.ruleset","config.storageDevice.scsiLun","config.storageDevice","config.storageDevice.plugStoreTopology.device","config.storageDevice.multipathInfo.lun","config.storageDevice.plugStoreTopology.target","config.fileSystemVolume.mountInfo","config.multipathState.path"],t.preselectComparator=function(e){return!(!t.masterDetailsViewContext||!t.masterDetailsViewContext.selectedItems||1!==t.masterDetailsViewContext.selectedItems.length)&&t.masterDetailsViewContext.selectedItems[0].key===e.key},P.rescanWarningMessages=[],t.masterDetailsViewContext.alertMessenger=t.masterDetailsViewContext.alertMessenger||new g(e.getString);var C=t.$on("vsphere.core.host.actions.rescan.completed",function(e,i){if(i&&i.rescanSpec&&i.rescanSpec.rescanHbas&&i.affectedHosts&&i.affectedHosts.length)for(var r=0;r<i.affectedHosts.length;r++)if(a.compareIds(i.affectedHosts[r],P.hostId)){t.masterDetailsViewContext.alertMessenger.removeRescanMessages();break}});t.$on("$destroy",function(){C()}),P.clearWarning=function(){t.masterDetailsViewContext.alertMessenger.removeMessages()},t.$watch(function(){return t.masterDetailsViewContext.alertMessenger.getMessages()},function(){P.datagridOptions.data=P.datagridOptions.data.slice(0),t.masterDetailsViewContext.alertMessenger&&(P.rescanWarningMessages=t.masterDetailsViewContext.alertMessenger.getMessages())},!0),P.refresh=function(){P.storageAdaptersLoading=!0,r.getProperties(P.hostId,[S,y]).then(function(i){var r=i[S]&&i[S].adapters?i[S].adapters:[];r.forEach(function(t){t.type&&(t.localizedType=e.getString("StorageUi","storage.adapters.type."+t.type),t.isIscsiAdapter=t.localizedType===h,t.isIscsiAdapter&&(t.portBindableIScsi=t.isSoftwareBased)),t.status&&(t.localizedStatus=e.getString("StorageUi","storage.adapters.status."+t.status))}),P.datagridOptions.data=r,t.masterDetailsViewContext.hostAdaptersData=i[S],t.masterDetailsViewContext.isHostConnected=i[y],u()})["finally"](function(){P.storageAdaptersLoading=!1})},P.datagridOptions={height:"100%",columnDefs:v(),sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,groupOrder:[{field:"model"}],data:[],vuiFooter:{actions:[{disabled:!1,label:e.getString("StorageUi","action.copyAll"),tooltip:e.getString("StorageUi","action.copyAll"),icon:"vui-icon-action-copy",action:function(){d.copyAllItems("#storageAdaptersGrid [kendo-grid]")}}]},selectedItems:[],resizable:!0,actionBarOptions:{actions:[]}},t.$watch(function(){return P.datagridOptions.selectedItems},function(e,i){e&&e.length&&i&&i.length||(t.masterDetailsViewContext.selectedItems=e),e[0]!==i[0]&&(t.masterDetailsViewContext.selectedItems=e,u())}),P.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("StorageAdaptersViewController",e),e.$inject=["i18nService","$scope","vuiConstants","dataService","columnRenderersRegistry","storageUtil","defaultUriSchemeUtil","datagridActionBarService","navigation","hostStorageConstants","kendoGridService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(l,d,u,p,v){function m(){if(!g())return!1;if(D.dialogData.target.server&&!isNaN(D.dialogData.target.port)&&(u||D.dialogData.target.targetName)){var e=C.getSettings(),t=s.buildAuthenticationPropertiesForTarget(D.dialogData.inheritAuthSettings,e.authMethodSelected,e.outgoing,e.incoming,""),i=r.addIscsiAdapterTargets(d,u,l.device,D.dialogData.target.port,D.dialogData.target.server,D.dialogData.target.targetName,t);return i.then(function(e){e&&e.effect&&e.effect.affectedEntites&&e.effect.affectedEntites.length&&v&&v.callback&&v.callback(e,l)}),!0}return!1}function g(){var e=!0,t=D.dialogData.validator.validate();if(t&&t.length&&(S("form.validationError"),e=!1),h()&&(S("storage.adapters.edit.authentication.form.targetExists"),e=!1),!D.dialogData.inheritAuthSettings){var i=D.dialogData.authSettingsComponentApi.validate();i.isValid||(e&&(i.errors&&i.errors.length?f(i.errors):S("form.validationError")),e=!1)}return e}function h(){var e=D.dialogData.target;return _.some(p,function(t){var i=t.address.split(":");return e.server===i[0]&&e.port===Number(i[1])&&(u||t.name===e.targetName)})}function f(e){D.alerts=_.map(e,function(e){return{text:e,type:t.notifications.type.ERROR}})}function S(e){var r={text:i.getString("StorageUi",e),type:t.notifications.type.ERROR};D.alerts.length>0&&(D.alerts=[]),D.alerts=[r]}var y=i.getString("StorageUi",u?"storage.adapters.iscsiTargets.actions.addSend.h5header":"storage.adapters.iscsiTargets.actions.addStatic.h5header"),P=3260,C={},D={title:y,subTitle:{text:l.device},defaultButton:"submit",alerts:[],dialogData:{adapter:l,target:{server:"",port:P,targetName:u?null:""},options:{dynamicTarget:u,PORT_MAX_VALUE:65535,PORT_MIN_VALUE:1},authSettingsComponentApi:C,inheritAuthSettings:!0,initialAuthenticationProperties:{authenticationMethod:a.authentication.PROHIBITED},validator:c.create(),isValidServer:function(){var e=[],t=D.dialogData.target.server;return o.isIpv6AddressValid(t)||n.isValidDnsName(t)||e.push(i.getString("StorageUi","storage.adapters.edit.authentication.form.invalidSendAddress")),e},isValidPort:function(){var e=[];return n.isValidPort(D.dialogData.target.port)||e.push(i.getString("StorageUi","storage.adapters.iscsiTargets.add.form.error.invalidPort.text",D.dialogData.options.PORT_MIN_VALUE,D.dialogData.options.PORT_MAX_VALUE)),e}},contentTemplate:"storage-ui/resources/storage/views/host/adapters/targets/AddIscsiTargetDialog.html",onSubmit:m};e.openOkCancelModal(D)}return{openAddIscsiTargetDialog:l}}angular.module("com.vmware.vsphere.client.storage").service("AddIscsiTargetDialogService",e),e.$inject=["clarityModalService","clarityConstants","i18nService","adapterTargetsService","storageValidationService","ipParserService","storageAdapterConstants","storageAdapterEditAuthenticationSpecBuilderService","vxValidatorFactory"]}(),function(){"use strict";function e(e,t,i,r){var n=this;n.loading=!1,n.hostId=r.getRoute().objectId,e.$watch(function(){return e.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&e.isIscsiAdapter&&n.refresh()}),n.targetsUpdatedCallback=function(t,i){t&&!t.error&&i&&e.masterDetailsViewContext.alertMessenger.addRescanMessage(i.key,i.device)},n.refresh=function(){if(e.masterDetailsViewContext.selectedItem){n.loading=!0,n.adapter=e.masterDetailsViewContext.selectedItem;var i=e.masterDetailsViewContext.selectedItem.key;t.retrieveIscsiAdapterTargets(n.hostId,i).then(function(e){e?(n.staticTargets=e.staticTargets?e.staticTargets:[],n.dynamicTargets=e.dynamicTargets?e.dynamicTargets:[],n.hba=e.hba):(n.staticTargets=[],n.dynamicTargets=[])})["finally"](function(){n.loading=!1})}},n.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("IscsiTargetsDetailsViewController",e),e.$inject=["$scope","adapterTargetsService","i18nService","navigation"]}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.vxPropertyViewService=e,this.dataService=t,this.hostStorageConstants=i,this.storageUtil=r,this.actionsService=n,this.$q=o,this.i18nService=a,this.i18n=a.getString.bind(this,"StorageUi")}return e.prototype.requestPolicies=function(e,t,i,r){var n=this,o={};return o[this.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP]=this.dataService.getProperties(e,[this.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP],{propertyParams:[{propertyName:this.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP,parameterType:"java.lang.String",parameter:t}]}).then(function(e){e=e||{};var t=e[n.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP]||{};return{pathSelectionPolicy:t.pathSelectionPolicy,storageArrayTypePolicy:t.storageArrayTypePolicy}}),o.editAction=this.actionsService.getActions([e],["vsphere.core.host.actions.storageDevice.editMultipathingPolicy"]).then(function(e){return e&&e.length&&e[0].action?{title:e[0].action.label,isEnabled:e[0].available,clickHandler:function(){return r(e[0])}}:null}),i&&(o.hostPolicyOptions=this.dataService.getProperties(e,[this.hostStorageConstants.PATH_SELECTION_POLICY_OPTIONS_PROP,this.hostStorageConstants.STORAGE_ARRAY_TYPE_POLICY_OPTIONS_PROP])),this.$q.all(o).then(function(e){var t={};return e[n.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP]&&(e[n.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP].editAction=e.editAction,t.multipathingInfo=e[n.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_PROP]),e.hostPolicyOptions&&(t.hostPolicyOptions=e.hostPolicyOptions),t})},e.prototype.buildMulthipathingSection=function(e,t,i,r,n){i&&r&&e.section("multipathingPolicies").title(t).property(this.i18n("datastore.manage.connectivity.pathSelectionPolicy"),this.storageUtil.formatPathSelectionPolicyName(i.pathSelectionPolicy,r.pathSelectionPolicyOptions)).property(this.i18n("datastore.manage.connectivity.satp"),this.storageUtil.getStorageArrayTypePolicyName(i.storageArrayTypePolicy,r.storageArrayTypePolicyOptions)).action(n)},e.$inject=["vxPropertyViewService","dataService","hostStorageConstants","storageUtil","actionsService","$q","i18nService"],e}();e.MultipathingPoliciesService=t,angular.module("com.vmware.vsphere.client.storage").service("multipathingPoliciesService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){this.clarityModalService=e,this.mutationService=i,this.hostStorageService=r,this.i18n=t.getString.bind(this,"StorageUi")}return e.prototype.open=function(e,t){var i=1===t.length?this.i18n("storage.adapters.devices.action.format.formTitle"):this.i18n("storage.adapters.devices.action.format.formTitleMulti"),r={title:i,size:"lg",defaultButton:"submit",alerts:[],contentTemplate:"storage-ui/resources/storage/views/host/devices/erasePartitions/erasePartitionsDialog.html",onSubmit:this.onSubmit.bind(this,e,t)};1===t.length&&(r.subTitle=t[0].name),r.dialogData={hostId:e,devices:t,infoHeader:1===t.length?this.i18n("storage.adapters.devices.action.format.infoHeaderSingle"):this.i18n("storage.adapters.devices.action.format.infoHeaderMulti"),confirmationText:1===t.length?this.i18n("storage.adapters.devices.action.format.confirmationSingle"):this.i18n("storage.adapters.devices.action.format.confirmationMulti"),partitions:[]},this.clarityModalService.openOkCancelModal(r),t.length&&1===t.length&&(r.dialogData.isLoading=!0,this.hostStorageService.retrieveStorageDevicePartitionData(e,t[0].devicePath).then(function(e){r.dialogData.partitions=e.partitions})["finally"](function(){r.dialogData.isLoading=!1}))},e.prototype.onSubmit=function(e,t){return this.hostStorageService.erasePartitions([{hostId:e,devices:t}]),!0},e.$inject=["clarityModalService","i18nService","mutationService","hostStorageService"],e}();e.ErasePartitionsDialogService=t,angular.module("com.vmware.vsphere.client.storage").service("erasePartitionsDialogService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.hostStorageService=t,this.i18n=e.getString.bind(this,"StorageUi"),this.datagridOptions={data:this.partitions,pageConfig:{hidePager:!1},columnDefs:[{displayName:this.i18n("storage.devices.column.name"),field:"name",template:function(e){return o.i18n("datastore.partitionType."+e.name)}},{displayName:this.i18n("storage.devices.column.capacity"),field:"partitionCapacity",template:function(e){return r(e.partitionCapacity,"B","Auto")},sortable:function(e,t){return n.compareNumericValues(e,t,"partitionCapacity")}},{displayName:this.i18n("storage.devices.column.partitionType"),field:"isLogical",type:"boolean",template:function(e){return e.isLogical?o.i18n("storage.devices.partitionType.logical"):o.i18n("storage.devices.partitionType.primary")}}],sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.NONE,selectedItems:[],resizable:!1,columnMenu:{sortable:!1,messages:{columns:e.getString("CommonUi","listview.showColumnsMenu"),filter:e.getString("CommonUi","listview.filterMenu")}}}}return e.prototype.$onChanges=function(){this.datagridOptions.data=this.partitions},e.$inject=["i18nService","hostStorageService","vuiConstants","bytesFilter","storageUtil"],e}();e.PartitionsListController=t,angular.module("com.vmware.vsphere.client.storage").component("partitionsList",{template:"<div class='flex-grid' vui-datagrid='$ctrl.datagridOptions'><div>",bindings:{partitions:"<"},controller:t})}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){return t.masterDetailsViewContext.selectedItem}function c(){var e=s();return e&&e.identifier}function l(){var e=c();if(e){if(!t.masterDetailsViewContext.isHostConnected||"HPP"===s().ownerPlugin)return void d(null);var i=u.hostId,n=i+"-"+e;u.cache.hasOwnProperty(n)?d(u.cache[n]):(u.loading=!0,u.propertyViewData=null);var o=!1;u.hostPolicyOptions.hasOwnProperty(u.hostId)||(o=!0);var l=function(e){var t=s();t&&r.invokeAction(e,{deviceId:t.identifier,name:t.identifier})};a.requestPolicies(u.hostId,c(),o,l.bind(u)).then(function(t){u.cache[n]=t.multipathingInfo,o&&t.hostPolicyOptions&&(u.hostPolicyOptions[u.hostId]=t.hostPolicyOptions),i===u.hostId&&e===c()&&d(t.multipathingInfo)},function(){i===u.hostId&&e===c()&&d(null)})["finally"](function(){i===u.hostId&&e===c()&&(u.loading=!1)})}}function d(e){var t=s();if(t){var r=i.createPropertyViewBuilder(),n=r.category(p("storage.devices.properties.generalHeader"),0);n.section("generalSection").title(p("storage.devices.properties.generalHeader")).property(p("storage.adapters.devices.name"),t.name).property(p("storage.adapters.devices.identifier"),t.identifier).property(p("storage.adapters.devices.type"),t.type).property(p("storage.devices.properties.location"),t.devicePath).property(p("storage.adapters.devices.capacity"),t.localizedCapacity).property(p("storage.adapters.devices.driveType"),t.localizedDriveType).property(p("storage.adapters.devices.hardwareAcc"),t.hardwareAcceleration).property(p("storage.adapters.devices.transport"),t.transport).property(p("storage.adapters.devices.owner"),t.ownerPlugin).property(p("storage.adapters.devices.sectorFormat"),t.sectorFormat),e&&a.buildMulthipathingSection(n,p("storage.devices.properties.multipathingPoliciesHeader"),e,u.hostPolicyOptions[u.hostId],e.editAction),u.propertyViewData=r.build()}}var u=this,p=e.getString.bind(null,"StorageUi");u.hostId=o.getRoute().objectId,u.cache={},u.hostPolicyOptions={},t.$watch(function(){return t.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&l()}),l()}angular.module("com.vmware.vsphere.client.storage").controller("GeneralStorageDeviceDetailsViewController",e),e.$inject=["i18nService","$scope","vxPropertyViewService","actionsService","$q","navigation","multipathingPoliciesService"]}();var storage_ui;!function(e){var t=function(){function e(){this._type="com.vmware.vsphere.client.storage.adapters.ScsiLunDisplayNameUpdateSpec"}return e}();e.ScsiLunDisplayNameUpdateSpec=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i,this.vxValidatorFactory=r,this.mutationService=n}return e.prototype.show=function(e,i,r){var n=this,o=this,a={title:o.i18nService.getString("StorageUi","storage.devices.action.rename.dialogTitle"),subTitle:{text:r},defaultButton:"submit",alerts:[],contentTemplate:"storage-ui/resources/storage/views/host/devices/RenameStorageDeviceDialog.html",onSubmit:function(){if(a.dialogData.renameDeviceFormValidator.validate().length)return!1;var r=new t;return r.uuid=i,r.text=a.dialogData.name,r.text&&n.mutationService.apply(e,r._type,r),!!r.text}};a.dialogData={hostId:e,lunUuid:i,name:r,i18n:this.i18nService,renameDeviceFormValidator:this.vxValidatorFactory.create()},o.clarityModalService.openOkCancelModal(a)},e.$inject=["i18nService","clarityModalService","clarityConstants","vxValidatorFactory","mutationService"],e}();e.RenameStorageDeviceDialogService=i,angular.module("com.vmware.vsphere.client.storage").service("renameStorageDeviceDialogService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$scope=e,this.i18nService=t,this.dataService=i,this.hostStorageConstants=r,this.storageUtil=n,this.$timeout=o,this.hostId=e.modalOptions.dialogData.hostId,this.deviceId=e.modalOptions.dialogData.deviceId,this.dialogData=e.modalOptions.dialogData,this.requestData()}return e.prototype.requestData=function(){var e=this;e.isDisabled=function(){return!(e.dialogData.selectedPolicy&&e.storageUtil.isFixedPolicy(e.dialogData.selectedPolicy.id))},e.loading=!0,e.dataService.getProperties(e.hostId,[e.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_WITH_PATHS_PROP,e.hostStorageConstants.PATH_SELECTION_POLICY_OPTIONS_PROP],{propertyParams:[{propertyName:e.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_WITH_PATHS_PROP,parameterType:"java.lang.String",parameter:e.deviceId}]}).then(function(t){var i=t&&t[e.hostStorageConstants.PATH_SELECTION_POLICY_OPTIONS_PROP];i&&i.length?e.policyOptions=_.map(i,function(t){return{id:t.policy.key,label:e.storageUtil.getPathSelectionPolicyNameByKey(t.policy.key,i)}}):e.policyOptions=_.map([e.hostStorageConstants.storagePolicies.FIXED_PATH,e.hostStorageConstants.storagePolicies.MOST_RECENTLY_USED_PATH,e.hostStorageConstants.storagePolicies.ROUND_ROBIN],function(t){return{id:t,label:e.storageUtil.formatPathSelectionPolicyLabel(t)}});var r=t&&t[e.hostStorageConstants.STORAGE_DEVICE_MULTIPATHING_INFO_WITH_PATHS_PROP];e.dialogData.logicalUnitId=r&&r.logicalUnitId,r&&r.pathSelectionPolicy&&e.storageUtil.isFixedPolicy(r.pathSelectionPolicy.policy)&&(e.dialogData.selectedPath=_.find(r.paths,function(e){return e.name===r.pathSelectionPolicy.prefer}));var n=r&&r.pathSelectionPolicy&&r.pathSelectionPolicy.policy;e.dialogData.selectedPolicy=_.find(e.policyOptions,function(e){return e.id===n})||e.policyOptions[0],e.paths=r&&r.paths,e.focusPathSelectionPolicySelect()},function(t){var i=e.i18nService.getString("StorageUi","storage.failedToRetrieveDataError");t&&t.data&&t.data.message&&(i+=" "+t.data.message),e.dialogData.errorApi.showError(i)})["finally"](function(){e.loading=!1})},e.prototype.focusPathSelectionPolicySelect=function(){var e=angular.element("#storage-device-multipathing-policy-select");e&&e[0]&&this.$timeout(function(){e[0].focus()},0)},e.$inject=["$scope","i18nService","dataService","hostStorageConstants","storageUtil","$timeout"],e}();e.StorageDeviceMultipathingPolicyDialogController=t,angular.module("com.vmware.vsphere.client.storage").controller("StorageDeviceMultipathingPolicyDialogController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$rootScope=e,this.i18nService=t,this.clarityModalService=i,this.clarityConstants=r,this.storageUtil=n,this.mutationService=o}return e.prototype.show=function(e,t,i){function r(){var t=s.dialogData.selectedPolicy&&s.dialogData.selectedPolicy.id,i=s.dialogData.logicalUnitId,r=s.dialogData.selectedPath;if(t&&i){var o={_type:"com.vmware.vsphere.client.storage.MultipathLunPolicySpec",logicalUnitId:i};if(a.storageUtil.isFixedPolicy(t)){if(!r)return n(a.i18nService.getString("StorageUi","device.editMultipathingPolicy.noPreferredPath")),!1;o.policy={_type:"com.vmware.vim.binding.vim.host.MultipathInfo$FixedLogicalUnitPolicy",policy:t,prefer:r.name}}else o.policy={_type:"com.vmware.vim.binding.vim.host.MultipathInfo$LogicalUnitPolicy",policy:t};a.mutationService.apply(e,o._type,o,a.i18nService.getString("StorageUi","device.editMultipathingPolicy.taskTitle"))}return!0}function n(e){s.alerts=[{text:e,type:a.clarityConstants.notifications.type.ERROR}]}function o(){s.alerts=[]}var a=this,s={title:a.i18nService.getString("StorageUi","device.editMultipathingPolicyFormH5.title"),subTitle:{text:i},defaultButton:"submit",size:"lg",alerts:[],contentTemplate:"storage-ui/resources/storage/views/host/devices/StorageDeviceMultipathingPolicyDialog.html",onSubmit:r};s.dialogData={hostId:e,deviceId:t,errorApi:{showError:n,clearErrors:o}},a.clarityModalService.openOkCancelModal(s)},e.$inject=["$rootScope","i18nService","clarityModalService","clarityConstants","storageUtil","mutationService"],e}();e.StorageDeviceMultipathingPolicyDialogService=t,angular.module("com.vmware.vsphere.client.storage").service("storageDeviceMultipathingPolicyDialogService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.tabs=[{name:this.i18nService.getString("StorageUi","storage.devices.propertiesTab.header"),templateUrl:"storage-ui/resources/storage/views/host/devices/GeneralStorageDeviceDetailsView.html",uid:"storage.devices.propertiesTab"},{name:this.i18nService.getString("StorageUi","storage.devices.pathsTab.header"),templateUrl:"storage-ui/resources/storage/views/host/devices/StorageDevicesPathsDetailsView.html",uid:"storage.devices.pathsTab"},{name:this.i18nService.getString("StorageUi","storage.devices.properties.partitionDetailsHeader"),templateUrl:"storage-ui/resources/storage/views/host/devices/StorageDevicesPartitionDetailsView.html",uid:"storage.devices.partitionDetails",metadata:{relevantFor:"isScsiDisk"}}],this.detailsViewData={tabsPromise:this.$q.when(this.tabs)}}return e.$inject=["i18nService","$q"],e}();e.StorageDevicesMasterViewController=t,angular.module("com.vmware.vsphere.client.storage").controller("StorageDevicesMasterViewController",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r){function n(e){o.partitionFormat=i.getString("StorageUi","partitionFormat."+(e.partitionFormat||"unknown")),o.partitions=e.partitions}var o=this;o.loading=!1,o.cachedItems={},o.partitions=[],o.hostId=r.getRoute().objectId,o.viewId=r.getRoute().extensionId+"_paths",o.i18n=function(e){return i.getString("StorageUi",e)},e.$watch(function(){return e.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&o.refresh()}),o.refresh=function(){if(e.masterDetailsViewContext.selectedItem){var i=e.masterDetailsViewContext.selectedItem.devicePath;o.cachedItems.hasOwnProperty(i)?n(o.cachedItems[i]):o.loading=!0,t.retrieveStorageDevicePartitionData(o.hostId,i).then(function(t){
o.cachedItems[i]=t,e.masterDetailsViewContext.selectedItem&&e.masterDetailsViewContext.selectedItem.devicePath===i&&n(t)})["finally"](function(){o.loading=!1})}},o.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("StorageDevicesPartitionDetailsViewController",e),e.$inject=["$scope","hostStorageService","i18nService","navigation"]}(),function(){"use strict";function e(e,t,i){function r(){return e.masterDetailsViewContext.selectedItem?e.masterDetailsViewContext.selectedItem.identifier:null}var n=this;n.loading=!1,n.hostId=i.getRoute().objectId,n.viewId=i.getRoute().extensionId+"_paths",n.cache={},e.$watch(function(){return e.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&n.refresh()}),n.refresh=function(){var e=r();if(e){var i=n.hostId,o=i+"-"+e;n.cache.hasOwnProperty(o)?n.paths=n.cache[o]:(n.loading=!0,n.paths=[]),t.retrieveHostStorageDevicePathsData(i,e).then(function(t){n.cache[o]=t,i===n.hostId&&e===r()&&(n.paths=t)})["finally"](function(){i===n.hostId&&e===r()&&(n.loading=!1)})}},n.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("StorageDevicesPathsDetailsViewController",e),e.$inject=["$scope","hostStorageService","navigation"]}(),function(){"use strict";function e(e,t,i,r,n,o){var a=this;a.storageDevicesLoading=!1,a.hostId=o.getRoute().objectId,a.headerOptions={title:e.getString("StorageUi","storage.devices.listView.header"),objectId:a.hostId,actions:[]},a.viewId=o.getRoute().extensionId,a.liveRefreshProperties=["config.storageDevice","config.storageDevice.scsiLun","config.storageDevice.plugStoreTopology.device","config.storageDevice.multipathInfo.lun","config.storageDevice.plugStoreTopology.target","config.fileSystemVolume.mountInfo","config.multipathState.path","datastore"],a.refresh=function(){a.storageDevicesLoading=!0;var e={storageDevices:i.retrieveStorageDevicesData(a.hostId),isHostConnected:r.getProperties(a.hostId,["runtime.connectionState"]).then(function(e){return e&&"connected"===e["runtime.connectionState"]})};a.lastRefreshRequest=e,n.all(e).then(function(t){a.lastRefreshRequest===e&&(a.storageDevicesLoading=!1,a.devices=t.storageDevices,a.isHostConnected=t.isHostConnected)})},t.$watch(function(){return a.selectedDevices},function(e,i){e!==i&&(a.selectedDevices?(t.masterDetailsViewContext.selectedItems=a.selectedDevices,t.masterDetailsViewContext.isHostConnected=a.isHostConnected):t.masterDetailsViewContext.selectedItems=[])}),a.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("StorageDevicesViewController",e),e.$inject=["i18nService","$scope","hostStorageService","dataService","$q","navigation"]}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.vuiConstants=e,this.i18nService=t,this.dataService=i,this.navigation=r,this.hostStorageService=n,this.viewId="datastore.pe.pathsTab"}return e.prototype.$onChanges=function(){var e=this;this.hostId=this.navigation.getRoute().objectId,this.hostId&&this.selectedItems&&this.selectedItems.length&&this.hostStorageService.retrieveHostProtocolEndpointsPathsData(this.hostId,this.selectedItems[0].identifier).then(function(t){e.paths=t})},e.$inject=["vuiConstants","i18nService","dataService","navigation","hostStorageService"],e}();angular.module("com.vmware.vsphere.client.storage").component("protocolEndpointsPathsComponentController",{controller:t,templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/paths/ProtocolEndpointsPathsComponent.html",bindings:{selectedItems:"<"}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.vxPropertyViewService=t,this.hostStorageConstants=i,this.navigation=r,this.dataService=n,this.multipathingPoliciesService=o,this.actionsService=a,this.$q=s,this.hostPolicyOptions={},this.multhipathingCache={},this.i18n=e.getString}return e.prototype.$onChanges=function(){this.hostId=this.navigation.getRoute().objectId,this.selectedItem&&(this.selectedItem.peType===this.hostStorageConstants.protocolEndpoints.BLOCK&&this.isHostConnected()?this.buildPropertyViewWithMulthipathingData():this.buildPropertyView(this.selectedItem,null))},e.prototype.isHostConnected=function(){return this.hostConnectionState===this.hostStorageConstants.connectionState.CONNECTED},e.prototype.buildPropertyViewWithMulthipathingData=function(){var e=this,t=this.selectedItem.identifier;if(t){if(!this.isHostConnected())return void this.buildPropertyView(this.selectedItem,null);var i=this.hostId,r=i+"-"+t;this.multhipathingCache.hasOwnProperty(r)?this.buildPropertyView(this.selectedItem,this.multhipathingCache[r]):(this.loading=!0,this.propertyViewData=null);var n=!1;this.hostPolicyOptions.hasOwnProperty(this.hostId)||(n=!0);var o=function(t){e.selectedItem&&e.actionsService.invokeAction(t,{deviceId:e.selectedItem.identifier,name:e.selectedItem.identifier})};this.multipathingPoliciesService.requestPolicies(this.hostId,this.selectedItem.identifier,n,o.bind(this)).then(function(o){e.multhipathingCache[r]=o.multipathingInfo,n&&o.hostPolicyOptions&&(e.hostPolicyOptions[e.hostId]=o.hostPolicyOptions),i===e.hostId&&t===e.selectedItem.identifier&&e.buildPropertyView(e.selectedItem,o.multipathingInfo)},function(){i===e.hostId&&t===e.selectedItem.identifier&&e.buildPropertyView(e.selectedItem,null)})["finally"](function(){i===e.hostId&&t===e.selectedItem.identifier&&(e.loading=!1)})}},e.prototype.buildPropertyView=function(e,t){var i=this.vxPropertyViewService.createPropertyViewBuilder(),r=i.category(this.i18n("StorageUi","storage.pe.properties.generalHeader"),0),n=r.section("generalSection").title(this.i18n("StorageUi","storage.pe.properties.generalHeader")).property(this.i18n("StorageUi","storage.pe.runtimeName"),e.name).property(this.i18n("StorageUi","storage.pe.type"),e.type).property(this.i18n("StorageUi","storage.pe.identifier"),e.identifier);switch(e.peType){case this.hostStorageConstants.protocolEndpoints.BLOCK:n.property(this.i18n("StorageUi","storage.pe.location"),e.location).property(this.i18n("StorageUi","storage.pe.lun"),e.lun).property(this.i18n("StorageUi","storage.pe.opState"),e.operationalState).property(this.i18n("StorageUi","storage.pe.transport"),e.transport).property(this.i18n("StorageUi","storage.pe.owner"),e.owner);break;case this.hostStorageConstants.protocolEndpoints.NAS:n.property(this.i18n("StorageUi","storage.pe.server"),e.server).property(this.i18n("StorageUi","storage.pe.folder"),e.folder).property(this.i18n("StorageUi","storage.pe.opState"),e.operationalState)}n.property(this.i18n("StorageUi","storage.pe.array"),e.storageArray),t&&this.multipathingPoliciesService.buildMulthipathingSection(r,this.i18n("StorageUi","storage.pe.properties.multipathingPoliciesHeader"),t,this.hostPolicyOptions[this.hostId],t.editAction),this.propertyViewData=i.build()},e.$inject=["i18nService","vxPropertyViewService","hostStorageConstants","navigation","dataService","multipathingPoliciesService","actionsService","$q"],e}();e.HostProtocolEndpointsPropertiesComponent=t,angular.module("com.vmware.vsphere.client.storage").component("hostProtocolEndpointProperties",{templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/propertiesDetailsTab/HostProtocolEndpointsPropertiesView.html",bindings:{selectedItem:"<",hostConnectionState:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.$scope=t,this.vuiConstants=i,this.columnRenderersRegistry=r,this.storageUtil=n,this.navigation=o,this.dataService=a,this.hostStorageConstants=s,this.PROTOCOL_ENDPOINT_DATA_PROP="hostProtocolEndpointsData",this.CONNECTION_STATE_PROP="runtime.connectionState",this.i18n=e.getString,this.liveRefreshProperties=["config.fileSystemVolume.mountInfo","config.storageDevice.scsiLun"]}return e.prototype.$onInit=function(){var e=this;this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,data:[],resizable:!0,vuiFooter:{showCopy:!0},selectedItems:[],actionBarOptions:{actions:[]}},this.headerOptions={title:this.i18n("StorageUi","storage.pe.listView.header"),actions:[]},this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t===i||_.isEqual(t,i)||(e.masterDetailsViewContext.selectedItems=t)}),this.$scope.preselectComparator=function(t){if(!e.masterDetailsViewContext.selectedItems||!e.masterDetailsViewContext.selectedItems.length||!t)return!1;var i=_.find(e.masterDetailsViewContext.selectedItems,function(e){return e.identifier===t.identifier});return!!i},this.refresh()},e.prototype.refresh=function(){var e=this;this.loading=!0,this.hostId=this.navigation.getRoute().objectId;var t=[this.PROTOCOL_ENDPOINT_DATA_PROP,this.CONNECTION_STATE_PROP];this.dataService.getProperties(this.hostId,t).then(function(t){e.datagridOptions.data=_.map(t[e.PROTOCOL_ENDPOINT_DATA_PROP],function(t){return e.formatProtocolEndpointItem(t)}),e.masterDetailsViewContext.hostConnectionState=t[e.CONNECTION_STATE_PROP]})["finally"](function(){e.loading=!1})},e.prototype.getColumnDefinitions=function(){var e=this.columnRenderersRegistry.getColumnRenderer("text"),t=this.storageUtil.compareNumericValues;return[{displayName:this.i18nService.getString("StorageUi","storage.pe.name"),field:"name",template:function(t){return e(["name"],t)}},{displayName:this.i18nService.getString("StorageUi","storage.pe.type"),field:"type",template:function(t){return e(["type"],t)}},{displayName:this.i18nService.getString("StorageUi","storage.pe.array"),field:"storageArray",template:function(t){return e(["storageArray"],t)}},{displayName:this.i18nService.getString("StorageUi","storage.pe.location"),field:"location",template:function(t){return e(["location"],t)}},{displayName:this.i18nService.getString("StorageUi","storage.pe.lun"),field:"lun",template:function(t){return e(["lun"],t)},sortable:function(e,i){return t(e,i,"lunNumber")}},{displayName:this.i18nService.getString("StorageUi","storage.pe.opState"),field:"operationalState",template:function(t){return e(["operationalState"],t)}}]},e.prototype.formatProtocolEndpointItem=function(t){var i={},r=t.protocolEndpoint,n=r.peType;switch(n){case this.hostStorageConstants.protocolEndpoints.BLOCK:var o=t.underlyingLun;i.name=this.getStringValue(o.displayName),i.storageArray=this.getStringValue(r.storageArray),i.identifier=this.getStringValue(o.canonicalName),i.location=this.getStringValue(o.deviceName),i.lun=t.lunNumber.toString(),i.type=this.i18n("StorageUi","storage.pe.type.block"),i.operationalState=this.deviceStateMatches(t,e.OPERATIONAL_STATE_OK)?this.i18n("StorageUi","storage.pe.opState.accessible"):this.i18n("StorageUi","storage.pe.opState.notAccessible"),i.transport=this.storageUtil.getScsiPeTransport(t),i.owner=this.getStringValue(t.ownerPlugin),i.isScsiPE=!0;break;case this.hostStorageConstants.protocolEndpoints.NAS:i.name=this.i18n("StorageUi","storage.pe.runtimeName.nfs",this.getStringValue(r.nfsServer)),i.storageArray=this.getStringValue(r.storageArray),i.identifier=this.getStringValue(r.uuid),i.location=this.getStringValue(r.nfsServer)+this.getStringValue(r.nfsDir),i.server=this.getStringValue(r.nfsServer),i.folder=this.getStringValue(r.nfsDir),i.lun=this.i18n("StorageUi","informationNotAccessible"),i.type=this.i18n("StorageUi","storage.pe.type.nas"),i.operationalState=t.accessible?this.i18n("StorageUi","storage.pe.opState.accessible"):this.i18n("StorageUi","storage.pe.opState.notAccessible")}return i.uuid=r.uuid,i.lunNumber=t.lunNumber,i.peType=n,i},e.prototype.deviceStateMatches=function(e,t){return!!(e&&e.underlyingLun&&e.underlyingLun.operationalState)&&!(e.underlyingLun.operationalState.indexOf(t)<0)},e.prototype.getStringValue=function(e){return e?e:""},e.OPERATIONAL_STATE_OK="ok",e.$inject=["i18nService","$scope","vuiConstants","columnRenderersRegistry","storageUtil","navigation","dataService","hostStorageConstants"],e}();e.ProtocolEndpointList=t,angular.module("com.vmware.vsphere.client.storage").component("protocolEndpointList",{templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/ProtocolEndpointListView.html",bindings:{masterDetailsViewContext:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i){this.vuiConstants=t,this.$timeout=i,this.filterParams=[],this.hostId=e.getRoute().objectId}return e.prototype.$onChanges=function(){var e=this;this.filterParams=[],this.selectedProtocolEndpoints&&1===this.selectedProtocolEndpoints.length&&this.$timeout(function(){e.filterParams=[e.selectedProtocolEndpoints[0].uuid]},0)},e.$inject=["navigation","vuiConstants","$timeout"],e}();e.ProtocolEndpointsDatastoreListController=t,angular.module("com.vmware.vsphere.client.storage").component("protocolEndpointsDatastoresList",{templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/ProtocolEndpointsDatastoresListComponent.html",bindings:{selectedProtocolEndpoints:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.$q=e,this.i18nService=t,this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("StorageUi","storage.pe.propertiesTab.header"),templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/propertiesDetailsTab/HostProtocolEndpointProperties.html",uid:"storage.hostProtocolEndpoints.propertiesTab"},{name:t.getString("StorageUi","storage.pe.pathsTab.header"),templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/paths/ProtocolEndpointsPaths.html",uid:"datastore.pe.pathsTab",metadata:{relevantFor:"isScsiPE"}},{name:this.i18nService.getString("StorageUi","storage.pe.datastoresTab.header"),templateUrl:"storage-ui/resources/storage/views/host/protocolEndpoints/ProtocolEndpointsDatastores.html",uid:"storage.protocolEndpoints.datastoresTab"}])}}return e.$inject=["$q","i18nService"],e}();e.ProtocolEndpointsMasterDetailsViewController=t,angular.module("com.vmware.vsphere.client.storage").controller("ProtocolEndpointsMasterDetailsViewController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.defaultUriSchemeUtil=t,this.storageUtil=i,this.managedEntityConstants=r,this.clarityConstants=n,this.hostStorageService=o,this.clarityModalService=a}return e.prototype.open=function(e){var t={contentTemplate:"storage-ui/resources/storage/views/host/adapters/StorageAdaptersRescanDialog.html",title:this.i18nService.getString("StorageUi","storage.adapters.rescanForm.titleH5"),defaultButton:"submit",alerts:[],dialogData:{i18n:this.i18nService.getString,spec:{rescanHbas:!0,rescanVmfs:!0}}};if(1===e.length&&(t.subTitle={objectId:this.defaultUriSchemeUtil.getVsphereObjectId(e[0])}),e[0].type!==this.managedEntityConstants.HOST||e.length>1){var i=this.storageUtil.getRescanWarning(e[0].type);i&&this.addModalWarning(t,i)}t.onSubmit=this.onSubmit.bind(this,t,e),this.clarityModalService.openOkCancelModal(t)},e.prototype.addModalWarning=function(e,t){e._warnings=e._warnings||[],e._warnings.push({type:this.clarityConstants.notifications.type.WARNING,text:t}),e.alerts=e._warnings},e.prototype.onSubmit=function(e,t){var i=this,r=e.dialogData.spec;if(!r.rescanHbas&&!r.rescanVmfs)return this.setModalError(e,this.i18nService.getString("StorageUi","storage.adapters.rescanForm.noTagretSelected")),!1;e.dialogData.loading=!0;var n=this.hostStorageService.rescanStorageAdapters(t,e.dialogData.spec);return n=n.then(function(t){return!(!t.affectedHosts||0===t.affectedHosts.length)||(i.setModalError(e,i.i18nService.getString("StorageUi","storage.adapters.rescanForm.noAvailableHosts",t.targetName)),!1)})["finally"](function(){e.dialogData.loading=!1})},e.prototype.setModalError=function(e,t){var i=angular.copy(e._warnings||[]);i.splice(0,0,{type:this.clarityConstants.notifications.type.ERROR,text:t}),e.alerts=i},e.$inject=["i18nService","defaultUriSchemeUtil","storageUtil","managedEntityConstants","clarityConstants","hostStorageService","clarityModalService"],e}();e.RescanStorageDialogService=t,angular.module("com.vmware.vsphere.client.storage").service("rescanStorageDialogService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$scope=t}return e.prototype.$onInit=function(){var e=this;this.$scope.$watch(function(){return e.size.allocatedSpace},function(t){(void 0===t||t>e.size.maxSize)&&(e.size.allocatedSpace=e.size.maxSize),e.sliderSize=Math.round(e.size.allocatedSpace)})},e.prototype.onSliderSizeChanged=function(e){this.size.allocatedSpace=e},e.$inject=["i18nService","$scope"],e}();e.AllocateSpaceController=t,angular.module("com.vmware.vsphere.client.storage").component("allocateSpace",{templateUrl:"storage-ui/resources/storage/views/host/swapToSsd/AllocateSpaceViewComponent.html",bindings:{size:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.mutationService=t,this.datastoreConstants=i,this.defaultUriSchemeUtil=r,this.clarityModalService=n}return e.prototype.openSpaceAllocationDialog=function(e,t){var i=this,r=e.cacheSpace/this.datastoreConstants.MB_TO_GB+e.freeSpace/this.datastoreConstants.BYTES_TO_GB,n=e.capacity/this.datastoreConstants.BYTES_TO_GB,o={title:this.i18nService.getString("StorageUi","storage.swapToSsd.editCacheConfiguration.title"),contentTemplate:"storage-ui/resources/storage/views/host/swapToSsd/AllocateSpaceDialog.html",dialogData:{i18n:this.i18nService.getString,cacheConfig:{allocatedSpace:e.cacheSpace/this.datastoreConstants.MB_TO_GB,maxSize:r>n?n:r}},onSubmit:function(){var r=o.dialogData.cacheConfig.allocatedSpace<o.dialogData.cacheConfig.maxSize?o.dialogData.cacheConfig.allocatedSpace:o.dialogData.cacheConfig.maxSize;return i.updateCacheConfiguration(e,t,r*i.datastoreConstants.MB_TO_GB),!0}};this.clarityModalService.openOkCancelModal(o)},e.prototype.updateCacheConfiguration=function(e,t,i){var r={_type:"com.vmware.vim.binding.vim.host.CacheConfigurationManager$CacheConfigurationSpec",datastore:this.defaultUriSchemeUtil.getManagedObjectReference(e.datastoreId),swapSize:i};this.mutationService.apply(t,r._type,r,this.i18nService.getString("StorageUi","storage.swapToSsd.editCacheConfiguration.title"))},e.$inject=["i18nService","mutationService","datastoreConstants","defaultUriSchemeUtil","clarityModalService"],e}();e.AllocateSpaceDialogService=t,angular.module("com.vmware.vsphere.client.storage").service("allocateSpaceDialogService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){var c=this;this.i18nService=e,this.$scope=t,this.vuiConstants=i,this.swapToSsdService=r,this.columnRenderersRegistry=n,this.storageUtil=o,this.navigation=a,this.datagridActionBarService=s,this.hasAdvancedConfigPrivilege=!0,this.updateActionBar=function(){return c.datagridActionBarService.updateActionBar(c.datagridOptions,[c.hostId],[{actionId:c.ACTIONS.EDIT_CACHE_CONFIGURATION,isActionAvailable:function(e){return e.available&&c.selectedItem&&c.selectedItem.canBeUsedForCache},getActionInvocationContext:function(){return{selectedDatastore:c.selectedItem}}},{actionId:c.ACTIONS.REFRESH_STORAGE_SYSTEM},{actionId:c.ACTIONS.RESCAN_ADAPTERS}])},this.i18n=e.getString,this.ACTIONS={EDIT_CACHE_CONFIGURATION:"vsphere.core.host.actions.vFlash.editCacheConfiguration",REFRESH_STORAGE_SYSTEM:"vsphere.core.host.actions.refreshStorageSystem",RESCAN_ADAPTERS:"vsphere.core.host.actions.rescanHost"},this.liveRefreshProperties=["config.cacheConfigurationInfo","config.fileSystemVolume.mountInfo","datastore"]}return e.prototype.$onInit=function(){var e=this;this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],resizable:!0,selectedItems:[],actionBarOptions:{actions:[]}},this.headerOptions={title:this.i18n("StorageUi","storage.swapToSsd.title"),actions:[]},this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t[0]!==i[0]&&(e.selectedItem=t[0],e.updateActionBar())}),this.refresh()},e.prototype.refresh=function(){var e=this;this.loading=!0,this.hostId=this.navigation.getRoute().objectId,this.swapToSsdService.getHostSwapToSsdData(this.hostId).then(function(t){e.hasAdvancedConfigPrivilege=t.hasAdvancedConfigPrivilege,e.datagridOptions.data=t.ssdDatastores,e.updateActionBar()})["finally"](function(){e.loading=!1})},e.prototype.getColumnDefinitions=function(){function e(e,t){var i="vertical-aligned-text";return t===!0&&(i+=" disabled-text"),'<span class="'+i+'">'+e+"</span>"}var t=this.columnRenderersRegistry.getColumnRenderer("object-link"),i=this.storageUtil.compareNumericValues;return[{displayName:this.i18nService.getString("StorageUi","storage.swapToSsd.list.nameColumn"),field:"datastoreName",template:function(e){return t(["datastoreId","datastoreName","vsphere-icon-datastore",null,e.canBeUsedForCache],e)}},{displayName:this.i18nService.getString("StorageUi","storage.swapToSsd.list.capacityColumn"),field:"formattedCapacity",template:function(t){return e(t.formattedCapacity,!t.canBeUsedForCache)},sortable:function(e,t){return i(e,t,"capacity")}},{displayName:this.i18nService.getString("StorageUi","storage.swapToSsd.list.hostCacheSpaceColumn"),field:"formattedCacheSpace",template:function(t){return e(t.formattedCacheSpace,!t.canBeUsedForCache)},sortable:function(e,t){return i(e,t,"cacheSpace")}},{displayName:this.i18nService.getString("StorageUi","storage.swapToSsd.list.freeSpaceColumn"),field:"formattedFreeSpace",template:function(t){return e(t.formattedFreeSpace,!t.canBeUsedForCache)},sortable:function(e,t){return i(e,t,"freeSpace")}}]},e.$inject=["i18nService","$scope","vuiConstants","swapToSsdService","columnRenderersRegistry","storageUtil","navigation","datagridActionBarService"],e}();e.SwapToSsdDatastoresList=t,angular.module("com.vmware.vsphere.client.storage").component("swapToSsdDatastoresList",{templateUrl:"storage-ui/resources/storage/views/host/swapToSsd/SwapToSsdDatastoresList.html",controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){}return e}();e.SwapToSsdDatastoreItem=t;var i=function(){function e(){}return e}();e.HostSwapToSsdData=i;var r=function(){function e(e,t,i,r){this.i18nService=e,this.dataService=t,this.bytesFilter=i,this.defaultUriSchemeUtil=r,this.HOST_SWAP_TO_SSD_PROP="storage:hostSwapToSsdData"}return e.prototype.getHostSwapToSsdData=function(e){var r=this;return this.dataService.getProperties(e,[this.HOST_SWAP_TO_SSD_PROP]).then(function(e){var n=new i,o=e&&e[r.HOST_SWAP_TO_SSD_PROP];return o?(n.hasAdvancedConfigPrivilege=o.hasAdvancedConfigPrivilege,n.ssdDatastores=_.map(o.ssdDatastores,function(e){var i=new t;return i.datastoreName=e.formattedName,i.datastoreId=r.defaultUriSchemeUtil.getVsphereObjectId(e.dsRef),i.canBeUsedForCache=e.canBeUsedForCache,i.capacity=e.capacity,i.formattedCapacity=r.bytesFilter(e.capacity,"B","Auto",2),i.freeSpace=e.freeSpace,i.formattedFreeSpace=r.bytesFilter(e.freeSpace,"B","Auto",2),e.hostCacheSpaceInMb||0===e.hostCacheSpaceInMb?(i.cacheSpace=e.hostCacheSpaceInMb,i.formattedCacheSpace=r.bytesFilter(1024*e.hostCacheSpaceInMb*1024,"B","Auto",2)):(i.formattedCacheSpace="",i.cacheSpace=0),i})):(n.hasAdvancedConfigPrivilege=!0,n.ssdDatastores=[]),n})},e.$inject=["i18nService","dataService","bytesFilter","defaultUriSchemeUtil"],e}();e.SwapToSsdService=r,angular.module("com.vmware.vsphere.client.storage").service("swapToSsdService",r)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.navigation=e}return Object.defineProperty(e.prototype,"hostId",{get:function(){return this.navigation.getRoute().objectId},enumerable:!0,configurable:!0}),e.$inject=["navigation"],e}();e.HostIoFilterViewController=t,angular.module("com.vmware.vsphere.client.storage").controller("HostIoFilterViewController",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n){function o(){var r=i.createPropertyViewBuilder(),n=r.category("category"),o=e.masterDetailsViewContext.selectedItem;return n.section("general").title("").property(t.getString("StorageUi","datastore.manage.deviceBacking.device"),o.deviceName).property(t.getString("StorageUi","datastore.manage.deviceBacking.partitionCapacity"),o.formattedDeviceCapacity||t.getString("Common","unknown")).property(t.getString("StorageUi","datastore.manage.deviceBacking.devicePartitionFormat"),t.getString("StorageUi","partitionFormat."+(o.devicePartitionFormat||"unknown"))).property(t.getString("StorageUi","deviceList.columns.driveType"),t.getString("StorageUi",o.isSsd?"disk.ssd":"disk.nonSSD")).property(t.getString("StorageUi","deviceList.columns.sectorFormat"),o.sectorFormat),r.build()}function a(){return[{displayName:t.getString("StorageUi","storage.devices.column.name"),field:"name",template:function(e){return t.getString("StorageUi","datastore.partitionType."+e.name)}},{displayName:t.getString("StorageUi","storage.devices.column.capacity"),field:"partitionCapacity",template:function(e){return r(e.partitionCapacity,"B","Auto")}},{displayName:t.getString("StorageUi","storage.devices.column.partitionType"),field:"isLogical",template:function(e){return e.isLogical?t.getString("StorageUi","storage.devices.partitionType.logical"):t.getString("StorageUi","storage.devices.partitionType.primary")}}]}function s(){c.summaryData=o();var t=e.masterDetailsViewContext.selectedItem.partitions.slice(0);c.datagridOptions.data=t}var c=this;this.datagridOptions={pageConfig:{hidePager:!1},columnDefs:a(),sortMode:n.grid.sortMode.SINGLE,selectionMode:n.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,columnMenu:{sortable:!1,messages:{columns:t.getString("CommonUi","listview.showColumnsMenu"),filter:t.getString("CommonUi","listview.filterMenu")}}},e.$watch(function(){return e.masterDetailsViewContext.selectedItem},function(e,t){e!==t&&e&&s()}),s()}angular.module("com.vmware.vsphere.client.storage").controller("DeviceBackingDetailsViewController",e),e.$inject=["$scope","i18nService","vxPropertyViewService","bytesFilter","vuiConstants"]}();var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.tabs=[{name:this.i18nService.getString("StorageUi","storage.devices.detailsView.header"),templateUrl:"storage-ui/resources/storage/views/manage/backing/DeviceBackingDetailsView.html",uid:"storage.deviceBacking.detailsTab"}],this.detailsViewData={tabsPromise:this.$q.when(this.tabs)}}return e.$inject=["i18nService","$q"],e}();e.DeviceBackingMasterViewController=t,angular.module("com.vmware.vsphere.client.storage").controller("DeviceBackingMasterViewController",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n){function o(){l.datastoreId&&(l.deviceBackingLoading=!0,r.getData(l.datastoreId,s).then(function(e){e&&e[c]&&(l.datagridOptions.data=e[c])})["finally"](function(){l.deviceBackingLoading=!1}))}function a(){return[{displayName:i.getString("StorageUi","datastore.manage.deviceBacking.extentColumn"),field:"formattedName",template:"#:formattedName#"},{displayName:i.getString("StorageUi","datastore.manage.deviceBacking.capacityColumn"),field:"capacityInB",template:function(e){var t=e.formattedCapacity?e.formattedCapacity:i.getString("Common","unknown");return'<span class="vertical-aligned-text">'+t+"</span>"},sortable:!0}]}var s="com.vmware.vsphere.client.h5.storage.data.datastore.VmfsDatastoreExtentData",c="datastoreExtentItems",l=this;l.datastoreId=n.getRoute().objectId,l.headerOptions={title:i.getString("StorageUi","datastore.manage.deviceBacking")},l.deviceBackingLoading=!1,l.liveRefreshProperties=["host","summary.capacity"],l.datagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:a(),sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!0},l.refresh=o,l.refresh(),e.$watch(function(){return l.datagridOptions.selectedItems},function(t,i){t&&t.length&&i&&i.length||(e.masterDetailsViewContext.selectedItems=t),t[0]!==i[0]&&(e.masterDetailsViewContext.selectedItems=t)})}angular.module("com.vmware.vsphere.client.storage").controller("DeviceBackingViewController",e),e.$inject=["$scope","vuiConstants","i18nService","dataService","navigation"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){var e=l();return e?void s.updateActionBar(h.datagridOptions,[e],[{actionId:"vsphere.core.datastore.actions.mountVmfsSingleHost",getActionInvocationContext:function(){return{datastoreId:h.datastoreId}},isActionAvailable:function(e){var t=p();return!h.isForceMountedVmfsDatastore&&e.available&&t&&!t.isMounted&&t.isHostConnected}},{actionId:"vsphere.core.datastore.actions.unmountVmfsSingleHost",getActionInvocationContext:function(){return{datastoreId:h.datastoreId}},isActionAvailable:function(e){var t=p();return!h.isForceMountedVmfsDatastore&&e.available&&t&&t.isMounted&&t.isHostConnected&&t.isAccessible}}]):void(h.datagridOptions.actionBarOptions={actions:[]})}function l(){return u()||d()}function d(){return h.datagridOptions.data&&h.datagridOptions.data.length>0?o.getVsphereObjectId(h.datagridOptions.data[0].hostRef):null}function u(){var e=p();return e?o.getVsphereObjectId(e.hostRef):null}function p(){return h.datagridOptions.selectedItems&&1===h.datagridOptions.selectedItems.length?h.datagridOptions.selectedItems[0]:null}function v(){return[{displayName:i.getString("StorageUi","datastore.manage.connectivity.hostList.name"),field:"hostFormattedName",width:"150px",template:function(e){var t=n.getColumnRenderer("object-link"),i={hostName:e.hostFormattedName,hostId:o.getVsphereObjectId(e.hostRef)};return t(["hostId","hostName","vsphere-icon-host"],i)}},{displayName:i.getString("StorageUi","datastore.manage.connectivity.hostList.mounted"),field:"isMounted",width:"150px",type:"boolean",template:function(e){var t=e.isMounted===!0?"datastore.mounted":"datastore.unmounted";return i.getString("StorageUi",t)}},{displayName:i.getString("StorageUi","datastore.manage.connectivity.hostList.datastoreConnectivity"),field:"isAccessible",width:"150px",type:"boolean",template:function(e){var t=e.isAccessible===!0?"datastore.connected":"datastore.notConnected";return i.getString("StorageUi",t)}},{displayName:i.getString("StorageUi","datastore.manage.connectivity.hostList.mountPoint"),field:"mountPoint",width:"150px",template:"#:mountPoint#"}]}var m="connectivityWithHost:vmfsDatastoreConnectivity",g="datastore:isForceMountedVmfsDatastore",h=this;h.datastoreId=a.getRoute().objectId,h.isForceMountedVmfsDatastore=!1,h.headerOptions={title:i.getString("StorageUi","datastore.manage.connectivity.connectivityAndMultipathing")},h.hostConnectivityLoading=!1,h.liveRefreshProperties=["host"],h.datagridOptions={height:"100%",columnDefs:v(),sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!0,actionBarOptions:{actions:[]}},e.$watch(function(){return h.datagridOptions.selectedItems},function(t,i){if(t!==i){if(t&&t.length){var r=o.getVsphereObjectId(t[0].hostRef);e.masterDetailsViewContext.selectedItems=[r],e.masterDetailsViewContext.isSelectedHostConnected=t[0].isHostConnected,e.masterDetailsViewContext.isDatastoreAccessible=t[0].isAccessible}else e.masterDetailsViewContext.selectedItems=null;c()}}),e.preselectComparator=function(t){return!!(e.masterDetailsViewContext.selectedItems&&e.masterDetailsViewContext.selectedItems.length&&t)&&o.getVsphereObjectId(t.hostRef)===e.masterDetailsViewContext.selectedItems[0]},h.refresh=function(){h.hostConnectivityLoading=!0,r.getProperties(h.datastoreId,[m,g]).then(function(e){e&&e[m]&&(h.datagridOptions.data=e[m]),h.isForceMountedVmfsDatastore=e&&e[g],c()})["finally"](function(){h.hostConnectivityLoading=!1})},h.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("ConnectivityAndMultipathingViewController",e),
e.$inject=["$scope","vuiConstants","i18nService","dataService","columnRenderersRegistry","defaultUriSchemeUtil","navigation","datagridActionBarService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(e){var i=r.getColumnRenderer("text-with-custom-tooltip"),o=[{displayName:t.getString("StorageUi","datastore.manage.connectivity.hostList.name"),field:"hostFormattedName",width:"150px",template:function(e){var t=r.getColumnRenderer("object-link"),i={hostName:e.hostFormattedName,hostId:n.getVsphereObjectId(e.hostRef)};return t(["hostId","hostName","vsphere-icon-host"],i)}},{displayName:t.getString("StorageUi","datastore.manage.connectivity.hostList.datastoreConnectivity"),field:"isAccessible",width:"150px",type:"boolean",template:function(e){var r=e.isAccessible===!0?"datastore.connected":"datastore.notConnected",n=t.getString("StorageUi",r);return i(["text","title"],{text:n,title:n})}},{displayName:t.getString("StorageUi","datastore.manage.connectivity.hostList.accessMode"),field:"accessMode",width:"150px",template:function(e){return i(["accessMode","accessMode"],e)}},{displayName:t.getString("StorageUi","datastore.manage.connectivity.hostList.mountPoint"),field:"mountPoint",width:"150px",template:function(e){return i(["mountPoint","mountPoint"],e)}}];if(e&&e.length&&e[0].kerberosAuthentication){var a={displayName:t.getString("StorageUi","datastore.manage.connectivity.hostList.kerberosAuthentication"),field:"accessMode",width:"150px",template:function(e){return i(["kerberosAuthentication","kerberosAuthentication"],e)}};o.splice(3,0,a)}return o}var s="connectivityWithHost:nfsVvolDatastoreConnectivity",c=this;c.datastoreId=o.getRoute().objectId,c.headerOptions={title:t.getString("StorageUi","datastore.manage.connectivity.connectivityWithHosts")},c.hostConnectivityLoading=!1,c.liveRefreshProperties=["host"],c.refresh=function(){c.hostConnectivityLoading=!0,i.getProperties(c.datastoreId,[s]).then(function(t){t&&t[s]&&(c.datagridOptions={height:"100%",columnDefs:a(t[s]),sortMode:e.grid.sortMode.SINGLE,selectionMode:e.grid.selectionMode.SINGLE,data:t[s],selectedItems:[],resizable:!0})})["finally"](function(){c.hostConnectivityLoading=!1})},c.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("DatastoreConnectivityViewController",e),e.$inject=["vuiConstants","i18nService","dataService","columnRenderersRegistry","defaultUriSchemeUtil","navigation"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(){m.isDatastoreAccessible=e.masterDetailsViewContext.isDatastoreAccessible,m.hostId=v()}function d(){return m.isDatastoreAccessible!==e.masterDetailsViewContext.isDatastoreAccessible||m.hostId!==v()}function u(e){var t=e?e[n.EXTENTS_MULTIPATHING_INFO_PROP]:null;return t&&t.length?(m.showNoDetailsAvailableMsg=!1,m.deviceMultipathingInfos=t,m.selectedDeviceCanonicalName?m.selectedDeviceMultipathingInfo=t.find(function(e){return e.canonicalName===m.selectedDeviceCanonicalName})||t[0]:m.selectedDeviceMultipathingInfo=t[0],m.pathSelectionPolicyOptions=e[n.PATH_SELECTION_POLICY_OPTIONS_PROP],m.storageArrayTypePolicyOptions=e[n.STORAGE_ARRAY_TYPE_POLICY_OPTIONS_PROP],void p()):void(m.showNoDetailsAvailableMsg=!0)}function p(){if(m.selectedDeviceMultipathingInfo){var e,t=v()+"-"+m.datastoreId,r=m.cachedActions[t];r&&(e={title:r.action.label,isEnabled:r.available,clickHandler:function(){var e=m.selectedDeviceMultipathingInfo.canonicalName;e&&a.invokeAction(r,{deviceId:e,name:m.selectedDeviceMultipathingInfo.deviceName})}});var n=o.formatPathSelectionPolicyName(m.selectedDeviceMultipathingInfo.pathSelectionPolicy,m.pathSelectionPolicyOptions),s=o.getStorageArrayTypePolicyName(m.selectedDeviceMultipathingInfo.storageArrayTypePolicy,m.storageArrayTypePolicyOptions),c=i.createPropertyViewBuilder(),l=c.category(m.i18n("datastore.manage.connectivity.multipathingDetails"),0),d=l.section("generalSection").title(m.i18n("datastore.manage.connectivity.multipathingPolicies"));"HPP"===m.selectedDeviceMultipathingInfo.ownerPlugin?d.property(m.i18n("datastore.manage.connectivity.owner"),m.selectedDeviceMultipathingInfo.ownerPlugin):d.property(m.i18n("datastore.manage.connectivity.pathSelectionPolicy"),n).property(m.i18n("datastore.manage.connectivity.satp"),s).property(m.i18n("datastore.manage.connectivity.owner"),m.selectedDeviceMultipathingInfo.ownerPlugin).action(e),m.propertyViewData=c.build(),m.paths=m.selectedDeviceMultipathingInfo.paths,m.hostId=v()}}function v(){return e.masterDetailsViewContext.selectedItems&&e.masterDetailsViewContext.selectedItems.length?e.masterDetailsViewContext.selectedItems[0]:null}var m=this;m.datastoreId=c.getRoute().objectId,m.viewId=c.getRoute().extensionId+"_paths",m.loading=!1,m.cachedItems={},m.cachedActions={},m.i18n=r.getString.bind(null,"StorageUi"),m.selectedDeviceCanonicalName=null,m.liveRefreshProperties=["config.storageDevice","config.storageDevice.scsiLun","config.storageDevice.plugStoreTopology.device","config.storageDevice.multipathInfo.lun","config.storageDevice.plugStoreTopology.target","config.fileSystemVolume.mountInfo","config.multipathState.path","datastore"],l(),e.$watch(function(){return e.masterDetailsViewContext.selectedItems},function(e,t){e!==t&&d()&&(l(),m.refresh())}),e.$watch(function(){return e.masterDetailsViewContext.isDatastoreAccessible},function(e,t){e!==t&&d()&&(l(),m.refresh())}),e.$watch(function(){return m.selectedDeviceMultipathingInfo},function(e,t){e!==t&&p()}),m.refresh=function(){if(!e.masterDetailsViewContext.isSelectedHostConnected||!e.masterDetailsViewContext.isDatastoreAccessible)return m.showNoDetailsAvailableMsg=!0,m.loading=!1,void(m.currentPromise=null);m.showNoDetailsAvailableMsg=!1;var i=v();if(i){var r=m.datastoreId,n=i+"-"+r;m.selectedDeviceCanonicalName=m.selectedDeviceMultipathingInfo?m.selectedDeviceMultipathingInfo.canonicalName:m.selectedDeviceCanonicalName,m.cachedItems.hasOwnProperty(n)?(u(m.cachedItems[n]),m.loading=!1):(m.deviceMultipathingInfos=null,m.loading=!0);var o=a.getActions([i],["vsphere.core.host.actions.storageDevice.editMultipathingPolicy"]),c=t.retrieveVmfsDatastoreMultipathingData(i,m.datastoreId),l=s.all([c,o]).then(function(e){var t=e[0],i=e[1];m.cachedItems[n]=t,i&&i.length&&(m.cachedActions[n]=i[0]),l===m.currentPromise&&u(t)},function(){l===m.currentPromise&&(m.showNoDetailsAvailableMsg=!0)})["finally"](function(){m.currentPromise===l&&(m.loading=!1)});m.currentPromise=l}},m.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("MultipathingDetailsViewController",e),e.$inject=["$scope","hostStorageService","vxPropertyViewService","i18nService","hostStorageConstants","storageUtil","actionsService","$q","navigation"]}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.i18nService=e,this.storageUtil=t,this.columnRenderersRegistry=i,this.fileUploadConstants=r,this.renderText=function(e,t,i){var r=$("<span ng-non-bindable></span>").addClass("vertical-align-cell").text(e);return t&&_.forEach(t,function(e){r.addClass(e)}),i&&r.attr("title",i),r[0].outerHTML},this.formatStatusColumn=function(e){if(e.status===n.fileUploadConstants.state.SUCCESS)return n.renderIconWithText("vsphere-icon-status-ok",n.i18nService.getString("Common","success"));if(e.status===n.fileUploadConstants.state.ERROR){if(e.isGeneralError){var t='<span class="vsphere-icon-status-error"></span>',i=n.renderText(n.i18nService.getString("StorageUi","fileUpload.error.generalError")),r=n.renderText(n.i18nService.getString("StorageUi","fileUpload.error.details")),o='<a class="datastore-upload-error-details-link" ng-click="dataItem.showError()">'+r+"</a>";return"<div>"+t+i+o+"</div>"}return n.renderIconWithText("vsphere-icon-status-error",e.error)}if(e.status===n.fileUploadConstants.state.CANCELED)return n.renderIconWithText("vsphere-icon-status-error",n.i18nService.getString("StorageUi","fileUpload.status.canceled"));if(e.status===n.fileUploadConstants.state.RUNNING){var a=n.columnRenderersRegistry.getColumnRenderer("progress-bar-cancel-link");return a(e.progress,e.isCancelable,!1,"dataItem.cancel()")}},this.renderIconWithText=function(e,t){var i='<span class="'+e+'"></span>',r=n.renderText(t,null,t);return"<div>"+i+r+"</div>"}}return e.prototype.getDatastoreBrowserColumnConfig=function(e){var t=this,i=[{displayName:t.i18nService.getString("StorageUi","dsExplorer.colName"),field:"formattedName",sortable:function(e,i){return t.storageUtil.compareNumericValues(e,i,"nameSortOrder")},template:function(e){return'<div><span class="'+e.spriteCssClass+'"></span>'+t.renderText(e.formattedName)+"</div>"}},{displayName:t.i18nService.getString("StorageUi","dsExplorer.colSize"),field:"formattedSize",sortable:function(e,i){return t.storageUtil.compareNumericValues(e,i,"size")},template:function(e){return t.renderText(e.formattedSize,["right-align-cell"])}},{displayName:t.i18nService.getString("StorageUi","dsExplorer.colModified"),field:"lastModifiedFormatted",sortable:function(e,i){return t.storageUtil.compareNumericValues(e,i,"lastModified")},template:function(e){return t.renderText(e.lastModifiedFormatted)}},{displayName:t.i18nService.getString("StorageUi","dsExplorer.colType"),field:"localizedType",template:function(e){return t.renderText(e.localizedType)}},{displayName:t.i18nService.getString("StorageUi","dsExplorer.colPath"),field:"path",template:function(e){return t.renderText(e.path)}}];return e&&i.push({displayName:t.i18nService.getString("StorageUi","dsExplorer.colUuid"),field:"name",template:function(e){var i=e.friendlyName?e.name:"";return t.renderText(i)}}),i},e.prototype.getUploadSessionsGridColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("StorageUi","dsFileTransferView.colName"),field:"name",template:function(t){return'<div><span class="vx-icon-dsUpload"></span>\n                        '+e.renderText(t.name)+"</div>"}},{displayName:this.i18nService.getString("StorageUi","dsFileTransferView.colStatus"),field:"progress",template:this.formatStatusColumn},{displayName:this.i18nService.getString("StorageUi","dsFileTransferView.startTime"),field:"startTimeFormatted",template:"#:startTimeFormatted#"},{displayName:this.i18nService.getString("StorageUi","dsFileTransferView.lastUpdated"),field:"lastUpdatedFormatted",template:"#:lastUpdatedFormatted#"}]},e.$inject=["i18nService","storageUtil","columnRenderersRegistry","fileUploadConstants"],e}();e.DatastoreFileBrowserGridColumnConfigService=t,angular.module("com.vmware.vsphere.client.storage").service("datastoreFileBrowserGridColumnConfigService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.$scope=t,this.vuiConstants=i,this.columnRenderersRegistry=r,this.listUtil=n,this.bytesFilter=o,this.defaultUriSchemeUtil=a,this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],resizable:!0,selectedItems:[],actionBarOptions:{actions:[]}}}return e.prototype.$onChanges=function(e){var t=this;e.datastores&&(this.selectedTargets=_.filter(this.datastores,function(e){var i=t.defaultUriSchemeUtil.createVmomiUri(e.ref.type,e.ref.value,e.ref.serverGuid);return i===t.selectedDatastore.id&&(t.selectedDatastore.name=e.name,t.selectedDatastore.type=e.type,!0)}),this.datagridOptions.data=this.datastores),this.$scope.$watch(function(){return t.datagridOptions.selectedItems},function(e,i){if(e[0]){if(e[0]!==i[0]&&!_.isEqual(e,i)){var r=e[0].ref;t.selectedDatastore.id=t.defaultUriSchemeUtil.createVmomiUri(r.type,r.value,r.serverGuid),t.selectedDatastore.name=e[0].name,t.selectedDatastore.type=e[0].type,t.hasSelectedDatastore=!0}}else t.selectedDatastore.name=null,t.selectedDatastore.type=null,t.hasSelectedDatastore=!1}),this.$scope.comparator=function(e){var i=_.find(t.selectedTargets,function(t){return t.name===e.name});return!!i&&(t.selectedTargets=[],!0)}},e.prototype.getColumnDefinitions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("icon-text"),i=this.listUtil.compareNumericValues;return[{displayName:this.i18nService.getString("StorageUi","pathPicker.nameColumnTitle"),field:"name",template:function(e){var i={name:e.name,icon:"vsphere-icon-datastore"};return t(["icon","name"],i)}},{displayName:this.i18nService.getString("StorageUi","pathPicker.spaceColumnTitle"),field:"freeSpace",template:function(t){return e.bytesFilter(t.freeSpace,"B","Auto")},sortable:function(e,t){return i(e,t,"freeSpace")}}]},e.$inject=["i18nService","$scope","vuiConstants","columnRenderersRegistry","listUtil","bytesFilter","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.storage").component("copyFileDatastoreList",{templateUrl:"storage-ui/resources/storage/views/manage/files/copyFileComponents/copyFileDatastoreList.html",controller:t,bindings:{datastores:"<",selectedDatastore:"=",hasSelectedDatastore:"="}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.i18nService=e,this.accessor={}}return e.prototype.$onChanges=function(e){e.rootId&&e.rootId.currentValue&&e.rootId.currentValue!==e.rootId.previousValue&&this.accessor.reloadData&&this.accessor.reloadData()},e.prototype.onSelectionChange=function(e){e&&(this.selectedDestination.path=e.path,this.selectedDestination.name=e.name)},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.storage").component("copyFilePathPicker",{templateUrl:"storage-ui/resources/storage/views/manage/files/copyFileComponents/copyFilePathPickerView.html",controller:t,bindings:{rootId:"<",selectedDestination:"="}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.actionDefinitions=e,this.actionsService=t,this.vuiConstants=i,this.isActionAvailable=r,this.actionBarItems=[],this.contextGetters={},this.onClickHandler=function(e,t){var i=t.actionId,r=n.actionDefinitions[i],o=n.contextGetters[i]();n.actionsService.invokeAction(r,o)}}return e.prototype.addAction=function(e,t,i){void 0===i&&(i=null);var r=this.actionDefinitions[e];this.contextGetters[e]=t;var n={actionId:r.action.uid,tooltipText:r.action.description,label:r.action.label,enabled:this.isActionAvailable(e,r),iconClass:r.action.icon,onClick:i||this.onClickHandler};return this.actionBarItems.push(n),this},e.prototype.addSeparator=function(){return this.actionBarItems.push(this.vuiConstants.actions.SEPARATOR),this},e.prototype.build=function(){return this.actionBarItems},e}();e.DatastoreFileBrowserActionBarBuilder=t;var i=function(){function e(e,t){this.actionsService=e,this.vuiConstants=t,this.ACTIONS={CREATE_FOLDER:"vsphere.core.datastore.actions.createFolder",UPLOAD_FILE:"vsphere.core.datastore.actions.uploadToDatastore",UPLOAD_FOLDER:"vsphere.core.datastore.actions.uploadFolderToDatastore",DOWNLOAD_FILE:"vsphere.core.datastore.actions.downloadFromDatastore",DELETE_FILE:"vsphere.core.datastore.actions.deleteFile",REGISTER_VM:"vsphere.core.datastore.file.actions.registerVm",RENAME_FILE:"vsphere.core.datastore.actions.renameFile",INFLATE_THIN_DISK:"vsphere.core.datastore.inflateDiskAction",COPY_FILE:"vsphere.core.datastore.actions.copyFile",MOVE_FILE:"vsphere.core.datastore.actions.moveFile"}}return e.prototype.requestActions=function(e,t){void 0===t&&(t=null);var i=_.values(this.ACTIONS);if(h5&&h5.isDatastoreBrowserPopUpWindow){var r=i.indexOf(this.ACTIONS.REGISTER_VM);i.splice(r,1)}return this.actionsService.getActions([e],t||i).then(function(e){var t={};return e.forEach(function(e){t[e.action.uid]=e}),t})},e.prototype.buildActionBarItems=function(e,i){var r=this;return this.requestActions(e).then(function(e){return new t(e,r.actionsService,r.vuiConstants,i)})},e.prototype.updateActionBar=function(e,t,i){var r=this;this.requestActions(e).then(function(e){t.forEach(function(t){if(t!==r.vuiConstants.actions.SEPARATOR){var n=t.actionId,o=e[n];o&&(t.enabled=i(n,o))}})})},e.prototype.disableAll=function(e){var t=this;e.forEach(function(e){e!==t.vuiConstants.actions.SEPARATOR&&(e.enabled=!1)})},e.$inject=["actionsService","vuiConstants"],e}();e.DatastoreFileBrowserActionsService=i,angular.module("com.vmware.vsphere.client.storage").service("datastoreFileBrowserActionsService",i)}(storage_ui||(storage_ui={})),function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D,w,b,I,T,E){function V(){function t(){j.isInSearchState?ce():j.isSearchResultsDirty=!0}function a(t){var i=t.data[0],r=e.$new();r.menuDescriptor={label:o.getString("StorageUi","actionMenuFileTransfer"),iconClass:"vx-icon-dsUpload",items:[{id:"cancel_upload_id",label:o.getString("StorageUi","actionCancelFileTransfer"),iconClass:"vx-icon-removeIcon",enabled:i.isCancelable,onClick:function(){var e=t.data[0];e.cancel()}}]};var n=t.currentTarget;!n&&t&&(n=t.target);var a={scope:r,configObjectName:"menuDescriptor",target:n,coordinates:{x:t.clientX,y:t.clientY},menuContainerId:"applicationMenuContainer"};g.showMenu(a)}function P(e){return w.getDatastoreBrowserColumnConfig(e)}function b(){var e=r.find(".datastoreUploadFileInput")[0];j.isVsanDatastore?E(e):V(e)}function I(){var e=r.find(".datastoreUploadFolderInput")[0];j.isVsanDatastore?E(e):V(e)}function E(e){T.openStreamVmdkWarningDialog().then(function(t){null!==t&&V(e)})}function V(e){n(function(){e.click()},0)}function M(){c.safeApply(e,function(){j.uploadProgressExpand=!0;var t=v.getUploadSessions(e.datastoreId)||[];t.forEach(function(e){j.uploadBatch.updateItem(e),i.formatDate(e.lastUpdated).then(function(t){e.lastUpdatedFormatted=t}),i.formatDate(e.startTime).then(function(t){e.startTimeFormatted=t})}),j.uploadSessionsDatagridOptions.data=t})}function A(e,i){var r=j.selectedItem.path,n=me(e.selectedItems),o=_.every(e.selectedItems,function(e){return e.type===R});return{targetFileNames:_.pluck(e.selectedItems,"formattedName"),spec:n,callback:function(){if(t(),o)return void de(r);if(i)return void ue();var e=j.selectedItem.path;_.some(n.targetFiles,function(t){return e===t||e.length>t.length&&t+"/"===e.substring(0,t.length+1)})?ue():pe(r)}}}function B(e,i){var r=j.selectedItem.path,n=e.selectedItems[0];return{spec:ve(n),callback:function(){t(),n.type===N?i?ue():pe(r):de(r)}}}function q(i,r){var n=j.selectedItem.path,o=_.every(i.selectedItems,function(e){return e.type===R});return{datastoreId:e.datastoreId,datastoreDcRef:e.dc,selectedFiles:i.selectedItems,callback:function(i,a){r===fe.COPY_FILE?i===e.datastoreId&&(t(),o?de(n):ue()):(t(),o?(de(n),i===e.datastoreId&&de(a)):ue())}}}function K(t){return{datastoreId:e.datastoreId,datastoreDcRef:e.dc,selectedFiles:t.selectedItems,zipFileName:X(t),isStreamFormat:j.isVsanDatastore}}function X(t){return t.selectedItems.length>1?e.isInSearchState?j.rootItem.name+"_files.zip":j.selectedItem.name+"_files.zip":1===t.selectedItems.length&&t.selectedItems[0].type===N?t.selectedItems[0].formattedName+".zip":null}function Q(e){e.forEach(function(e){null===e.size||void 0===e.size?e.formattedSize="":e.formattedSize=u(e.size,"B","KB"),e.lastModified&&i.formatDate(e.lastModified).then(function(t){e.lastModifiedFormatted=t}),e.formattedName=e.friendlyName?e.friendlyName:e.name})}function Z(){var e=r.find(".datastoreUploadFileInput");e.on("change",function(){J(this.files,!1),this.value=null});var t=r.find(".datastoreUploadFolderInput");t.on("change",function(){J(this.files,!0),this.value=null})}function J(t,i){function r(){D.requestActions(e.datastoreId,[fe.UPLOAD_FILE]).then(function(t){j.selectedItem&&j.selectedItem.path&&(j.uploadBatch.init(n),l.invokeAction(t[fe.UPLOAD_FILE],{datastoreId:e.datastoreId,datastoreDcRef:e.dc,path:j.selectedItem.path,files:n,isDatastoreSelected:"datastore"===j.selectedItem.type,isStreamFormat:j.isVsanDatastore&&_.some(n,function(e){return e&&e.name&&e.name.toLocaleLowerCase().indexOf(".vmdk")===e.name.length-5})}))})}var n=_.map(t,function(e){return e}),a=0,s=0;if(_.forEach(n,function(e){e.size&&(a+=e.size,s=Math.max(s,e.size))}),a>k)return void f.error(o.getString("StorageUi","upload.errorTitle"),o.getString("StorageUi","upload.errorFileSizeExceedsFreeSpace"));if(y.isIe&&s>G)return void f.error(o.getString("StorageUi","upload.errorTitle"),o.getString("StorageUi","upload.errorFileSizeExceedsIeLimit"));var c,d=!1,u=[];_.forEach(n,function(e){var t=null;if(e.webkitRelativePath){var i=e.webkitRelativePath.indexOf("/");i>0&&(t=e.webkitRelativePath.substring(0,i))}var r=t||e.name,n=he(j.datagridOptions.data,r);n&&(n.type===R?(d=!0,u.push(n.name)):c=n.name)});var p=_.partial(o.getString,"StorageUi");c?f.error(p(i?"uploadFolderAction.confirmation.title":"uploadAction.confirmation.title"),p(i?"uploadFolderAction.confirmation.directorylreadyExistsError":"uploadAction.confirmation.directorylreadyExistsError",c)):d?i?f.error(p("uploadFolderAction.confirmation.title"),p("uploadFolderAction.confirmation.fileAlreadyExistsError")):h.showConfirmationDialog({title:p("uploadAction.confirmation.title"),message:p("uploadAction.confirmation.fileAlreadyExists",_.map(u,function(e){return"• "+e}).join("\n")),yesHandler:r}):r()}function ee(e){return e&&e.selectedItems&&0!==e.selectedItems.length&&e.selectedItems[0].type!==N?e.selectedItems[0]:null}function te(t){j.selectedItem?D.updateActionBar(e.datastoreId,t.actionBarOptions.actions,ie.bind({gridOptions:t})):D.disableAll(t.actionBarOptions.actions)}function ie(e,t){var i=this.gridOptions;if(!e||!t||!i)return!1;var r=t.available&&!!j.selectedItem&&!j.isFileSetLoading;if(!r)return!1;switch(e){case fe.CREATE_FOLDER:return ne();case fe.INFLATE_THIN_DISK:return 1===i.selectedItems.length&&!!i.selectedItems[0].isInflatable;case fe.DELETE_FILE:return i.selectedItems&&i.selectedItems.length;case fe.COPY_FILE:case fe.MOVE_FILE:return(!se()||!re())&&(i.selectedItems&&i.selectedItems.length);case fe.DOWNLOAD_FILE:return oe(i);case fe.REGISTER_VM:return ae(i);case fe.RENAME_FILE:return(!se()||!re())&&(i.selectedItems&&1===i.selectedItems.length);case fe.UPLOAD_FILE:return!(se()&&re());case fe.UPLOAD_FOLDER:return!(j.isVsanDatastore&&se());default:return!1}}function re(){return j.isVsanDatastore||j.isVvolDatastore}function ne(){return!se()||(e.topLevelDirectoryCreateSupported||j.hasDsCongidPrivilege)}function oe(e){return 1===e.selectedItems.length&&e.selectedItems[0].type===N||e.selectedItems.length>0&&!_.find(e.selectedItems,function(e){return e.type!==R})}function ae(e){var t=e.selectedItems,i=[U,L],r=1===t.length&&t[0].type===R&&_.includes(i,t[0].className);return r}function se(){if(!j.selectedItem||!j.selectedItem.path)return!1;var e=j.selectedItem.path.trim();return e.length&&"]"===e[e.length-1]}function ce(){O(),j.curretSearchRequestCanceller=C.defer(),j.isSearchResultsDirty=!1,j.searchDatagridOptions.data=[],le(),j.searchFilesLoading=!0,p.searchResults(e.datastoreId,j.rootItem.path,j.currentSearchTerm,j.curretSearchRequestCanceller.promise).then(function(e){Q(e),j.searchDatagridOptions.data=e,te(j.searchDatagridOptions)})["finally"](function(){j.searchFilesLoading=!1})}function le(){var t=j.searchDatagridOptions.actionBarOptions.actions;t&&D.buildActionBarItems(e.datastoreId,ie).then(function(e){e.addAction(fe.DOWNLOAD_FILE,K.bind(j,j.searchDatagridOptions)).addAction(fe.COPY_FILE,q.bind(j,j.searchDatagridOptions,fe.COPY_FILE)).addAction(fe.MOVE_FILE,q.bind(j,j.searchDatagridOptions,fe.MOVE_FILE)).addAction(fe.DELETE_FILE,A.bind(j,j.searchDatagridOptions,!0)).addAction(fe.RENAME_FILE,B.bind(j,j.searchDatagridOptions,!0)),j.searchDatagridOptions.actionBarOptions.actions=e.build()})}function de(t){t===j.selectedItem.path&&e.dsBrowserTreeAccessor.reloadContentFiles&&e.dsBrowserTreeAccessor.reloadContentFiles()}function ue(){e.dsBrowserTreeAccessor.refreshTree&&e.dsBrowserTreeAccessor.refreshTree()}function pe(t){e.dsBrowserTreeAccessor.refreshTreeNode&&e.dsBrowserTreeAccessor.refreshTreeNode(t)}function ve(e){return{sourcePath:e.path,destinationName:e.name}}function me(t){return{sourceDatacenter:e.dc,targetFiles:_.pluck(t,"path"),fileTypes:_.pluck(t,"fileType")}}function ge(t){return{sourceDatacenter:e.dc,targetFile:t.path,waitTaskToComplete:!0}}function he(e,t){if(e)return _.find(e,function(e){return e.name===t})}var fe=D.ACTIONS;j.splitterOptions={orientation:s.splitter.orientation.HORIZONTAL,panes:[{min:"250px",size:"25%"},{min:"250px",size:"100%"}]},j.progressSplitterOptions={orientation:s.splitter.orientation.VERTICAL,panes:[{min:"250px",size:"75%"},{min:"100px",size:"25%",collapsible:!0,collapsed:!0}]},j.isViewAvailabilityResolved=!1;var Se={privilegeCheck:S.checkPrivileges(e.datastoreId,["Datastore.Browse","Datastore.Config"]),datastoreProperties:d.getProperties(e.datastoreId,[z,H])};C.all(Se).then(function(e){e.privilegeCheck[0]!==!0?(j.viewUnavailableReason=o.getString("StorageUi","datastore.fileManager.noDatastoreBrowsePermision"),j.isViewAvailable=!1):e.datastoreProperties[z]!==!0?(j.viewUnavailableReason=o.getString("StorageUi","datastore.fileManager.datastoreInaccessible"),j.isViewAvailable=!1,j.uploadProgressExpand=v.getRunningUploadSessions().length>0):(j.hasDsCongidPrivilege=e.privilegeCheck[1],j.isViewAvailable=!0),k=e.datastoreProperties[H]},function(){j.isViewAvailable=!0})["finally"](function(){j.isViewAvailabilityResolved=!0}),j.showUploadMenu=a,j.uploadSessionsDatagridOptions={resizable:!0,height:"100%",selectionMode:s.grid.selectionMode.SINGLE,selectedItems:[],columnDefs:w.getUploadSessionsGridColumnDefs(),data:v.getUploadSessions(e.datastoreId),pageConfig:{hidePager:!0}};var ye=v.getRunningUploadSessions(e.datastoreId);ye.length>0&&j.uploadBatch.init(ye),j.uploadProgressExpand=!1,e.$on(m.event.UPDATED,M),e.$on(m.event.COMPLETE,function(e,i){j.uploadBatch.updateItem(i),pe(i.datastorePath),t()}),e.$on(x,function(e,t){j.uploadProgressExpand&&!t&&M()}),j.datagridOptions={resizable:!0,height:"100%",selectionMode:s.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],pageConfig:{displayMode:s.grid.displayMode.VIRTUAL_SCROLLING},columnDefs:P(j.isVsanDatastore&&j.is65VcOrLater),actionBarOptions:{actions:[]},data:[]},j.searchDatagridOptions=angular.copy(j.datagridOptions),j.datagridOptions.dataBound=function(){j.datagridOptions.data&&j.datagridOptions.data.length>0&&$("#dsFilesGrid tbody tr").on("dblclick",function(){if(j.datagridOptions.selectedItems&&1===j.datagridOptions.selectedItems.length&&j.datagridOptions.selectedItems[0].type===N){var t=j.datagridOptions.selectedItems[0].path;e.dsBrowserTreeAccessor.selectChildItem(t)}})},j.refreshView=function(){t(),j.isFileSetLoading||ue()},e.$watch(function(){return j.datagridOptions.selectedItems},function(e,t){_.isEqual(e,t)||(e&&e.length&&(W=e),te(j.datagridOptions))}),e.$watch(function(){return j.searchDatagridOptions.selectedItems},function(e,t){_.isEqual(e,t)||(e&&e.length&&(Y=e),te(j.searchDatagridOptions))}),j.keyPress=function(e){13===e.keyCode&&(e.preventDefault(),j.doSearch())},j.toggleSearchState=function(){j.isInSearchState=!j.isInSearchState,j.isInSearchState&&j.isSearchResultsDirty&&ce()},j.doSearch=function(){j.searchTerm&&""!==j.searchTerm&&j.rootItem?(j.currentSearchTerm=j.searchTerm,j.isSearchTriggered=!0,j.isInSearchState=!0,ce()):!j.searchTerm&&j.rootItem&&(j.isSearchTriggered=!1,j.isInSearchState=!1),Y=[]},j.currentSearchTerm=null,D.buildActionBarItems(e.datastoreId,ie).then(function(i){i.addAction(fe.CREATE_FOLDER,function(){var i=j.selectedItem.path;return{currentPath:i,topLevelDirectoryCreateSupported:e.topLevelDirectoryCreateSupported,isRootFolder:se(),datastoreDatacenter:e.dc,callback:function(){t(),pe(i)}}}).addAction(fe.UPLOAD_FILE,{},b),y.isWebkitDirectorySupported()&&i.addAction(fe.UPLOAD_FOLDER,{},I);var r=i.addSeparator();h5&&!h5.isDatastoreBrowserPopUpWindow&&r.addAction(fe.REGISTER_VM,function(){var e=ee(j.datagridOptions),t=e.name,i=t.substring(t.lastIndexOf(".")+1);return{vmName:t.substring(0,t.lastIndexOf(".")),vmFilePath:e.path,isTemplate:i===F}}),r.addAction(fe.DOWNLOAD_FILE,K.bind(j,j.datagridOptions)).addAction(fe.COPY_FILE,q.bind(j,j.datagridOptions,fe.COPY_FILE)).addAction(fe.MOVE_FILE,q.bind(j,j.datagridOptions,fe.MOVE_FILE)).addAction(fe.RENAME_FILE,B.bind(j,j.datagridOptions)).addAction(fe.DELETE_FILE,A.bind(j,j.datagridOptions)),j.isVsanDatastore||r.addAction(fe.INFLATE_THIN_DISK,function(){var e=j.selectedItem.path;return{spec:ge(j.datagridOptions.selectedItems[0]),callback:function(){t(),de(e)}}}),j.datagridOptions.actionBarOptions.actions=i.build(),Z()}),d.getProperties(e.datastoreId,["capability.topLevelDirectoryCreateSupported","dc"]).then(function(t){e.topLevelDirectoryCreateSupported=t["capability.topLevelDirectoryCreateSupported"]!==!1,e.dc=t.dc}),j.selectedTreeItemChanged=function(e){e&&(j.isFileSetLoading=!0,j.selectedItem&&e.id!==j.selectedItem.id&&(W=[])),j.selectedItem=e,j.datagridOptions.data=[],te(j.datagridOptions)},j.selectedTreeItemFilesLoaded=function(e){Q(e),j.datagridOptions.data=e,te(j.datagridOptions),j.isFileSetLoading=!1},j.onDsTreeInitialized=function(e){if(e&&e.length>0){var t=j.rootItem?j.rootItem.path:null;j.rootItem=e[0],t&&j.rootItem&&t!==j.rootItem.path&&j.isInSearchState&&ce()}}}function M(){var e=0,t=0,i=0,r=0,n={},o=0,a=!1,s=!1,c=function(e){return _.keys(e).length},l=function(e){return _.values(e).map(function(e){return e.uploadedSizeInB}).reduce(function(e,t){return e+t},0)},d=function(l){0===c(n)?(a=!0,s=!0,e=0,i=l.length,r=l.map(function(e){return e.sizeInB||e.size}).reduce(function(e,t){return e+t},0),o=0,t=0):(i+=l.length,r+=l.map(function(e){return e.size}).reduce(function(e,t){return e+t},0))},u=function(t){v.cancelFilesUpload(t),n={},s=!1,e=i},p=function(r){r.status===m.state.CANCELED||r.status===m.state.SUCCESS||r.status===m.state.ERROR?(n[r.id]&&(e++,t+=r.uploadedSizeInB,delete n[r.id]),0===c(n)&&e===i&&(n={},s=!1)):r.status===m.state.RUNNING&&(n[r.id]=r)};return{getShowUploads:function(){return a},isUploadRunning:function(){return s},getTotalUploadSessionsCount:function(){return i},getRunningUploadSessionsSizeInB:function(){return t+l(n)},getFinishedUploadSessionsCount:function(){return e},getUploadSessionsSizeInB:function(){return r},init:d,cancel:u,updateItem:p}}function O(){j.curretSearchRequestCanceller&&j.curretSearchRequestCanceller.resolve()}function A(){var t=d.getProperties(e.datastoreId,[B]),i=P.is65VcOrLater(e.datastoreId);C.all([t,i]).then(function(e){j.isVsanDatastore=e[0][B]===b.VSAN,j.isVvolDatastore=e[0][B]===b.VVOL,j.is65VcOrLater=e[1],V()})}var k,R="file",N="folder",U="VmConfigInfo",L="TemplateVmConfigInfo",F="vmtx",x="dataRefreshInvocationEvent",z="summary/accessible",H="info/freeSpace",B="summary/type",G=4294967296,j=this,W=[],Y=[];if(j.searchFilesLoading=!1,j.isFileSetLoading=!1,j.isSearchResultsDirty=!1,j.curretSearchRequestCanceller=null,j.uploadBatch=new M,j.popupActionBarOptions={actions:[]},h5.isDatastoreBrowserPopUpWindow){var q=E.search();e.datastoreId=q.datastoreId}else e.datastoreId=e._route.objectId,I.updateActionBar(j.popupActionBarOptions,"actions",[e.datastoreId],[{actionId:"vsphere.core.datastore.actions.popupDsBrowser"}]);e.i18nService=o,e.fileQuery=a.fileQueryType.ALL_FILES,e.dsBrowserTreeAccessor={},e.isInSearchState=!1,e.isSearchTriggered=!1,e.comparator=function(e){var t=_.find(W,function(t){return t.path===e.path});return void 0!==t},e.searchComparator=function(e){var t=_.find(Y,function(t){return t.path===e.path});return void 0!==t},e.$on("$destroy",function(){O()}),A()}angular.module("com.vmware.vsphere.client.storage").controller("DatastoreFileBrowserController",e),e.$inject=["$scope","$rootScope","timeFormatterService","$element","$timeout","i18nService","datastoreBrowserConstants","vuiConstants","vuiUtils","actionsService","dataService","bytesFilter","datastoreBrowserTreeService","fileUploadService","fileUploadConstants","vuiActionsMenuService","actionConfirmationService","alertService","authorizationService","browserService","vcService","$q","datastoreFileBrowserActionsService","datastoreFileBrowserGridColumnConfigService","datastoreTypeConstants","commonActionBarService","streamVmdkService","$location"];
}();var storage_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.mutationService=t,this.clarityModalService=i}return e.prototype.openDeleteFilesDialog=function(e,t,i,r){var n=this,o=this.i18nService.getString("StorageUi","actionDeleteFilesConfirmationText");1===t.length&&(o=this.i18nService.getString("StorageUi","actionDeleteFileConfirmationText",t[0]));var a={title:this.i18nService.getString("StorageUi","actionDeleteFileConfirmationTitle"),subTitle:{objectId:e},defaultButton:"close",message:o,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},saveButtonLabel:this.i18nService.getString("Common","yes.label"),cancelButtonLabel:this.i18nService.getString("Common","no.label"),submit:function(){return n.mutationService.apply(e,"com.vmware.vsphere.client.h5.storage.spec.DatastoreDeleteFileSpec",i).then(function(e){r&&r(e)}),!0}};this.clarityModalService.openConfirmationModal(a)},e.$inject=["i18nService","mutationService","clarityModalService"],e}();e.DeleteFilesService=t,angular.module("com.vmware.vsphere.client.storage").service("deleteFilesService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i,this.$q=r,this.datastoreBrowserTreeService=n,this.bytesFilter=o}return e.prototype.getFolderChildren=function(t,i){var r=this,n=this.$q.defer(),o=[],a={title:this.i18nService.getString("StorageUi","downloadFolderDialog.title"),subTitle:i.formattedName,defaultButton:"submit",submitButtonTitle:this.i18nService.getString("StorageUi","downloadFolderDialog.downloadButton"),submitDisabled:!0,contentTemplate:"storage-ui/resources/storage/views/manage/files/DownloadFolderDialog.html",onSubmit:function(){return n.resolve(o),!0},onCancel:function(){return n.resolve(null),!0}};a.dialogData={loading:!0,loadingText:this.i18nService.getString("StorageUi","downloadFolderDialog.calculating"),confirmationText:""},this.clarityModalService.openOkCancelModal(a);var s=0,c=0;return this.datastoreBrowserTreeService.searchResults(t,i.path,"").then(function(t){_.forEach(t,function(t){t.type!==e.FOLDER_TYPE?(o.push(t),t.size&&(s+=t.size)):c++})})["finally"](function(){a.dialogData.loading=!1,o.length?(a.dialogData.confirmationText=r.i18nService.getString("StorageUi","downloadFolderDialog.folderInfo",o.length.toString(),c.toString(),r.bytesFilter(s,"B")),a.dialogData.icon="info-standard",a.dialogData.iconClass="is-info",a.submitDisabled=!1):(a.dialogData.confirmationText=r.i18nService.getString("StorageUi","downloadFolderDialog.emptyFolderMsg"),a.dialogData.icon="error-standard",a.dialogData.iconClass="is-error")}),n.promise},e.FOLDER_TYPE="folder",e.$inject=["i18nService","clarityModalService","clarityConstants","$q","datastoreBrowserTreeService","bytesFilter"],e}();e.FolderDownloadService=t,angular.module("com.vmware.vsphere.client.storage").service("folderDownloadService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e}return e.prototype.$onInit=function(){},e.$inject=["i18nService","bytesFilter"],e}();e.DatastoreFileBrowserFooterController=t,angular.module("com.vmware.vsphere.client.storage").component("datastoreFileBrowserFooter",{controller:t,bindings:{showUploads:"<",isUploadRunning:"<",uploadedItems:"<",enqueuedItems:"<",uploadedItemsSizeInB:"<",enqueuedItemsSizeInB:"<",onCancelUploadClicked:"&"},templateUrl:"storage-ui/resources/storage/views/manage/files/footer/DatastoreFileBrowserFooterComponent.html"})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r){this.$document=e,this.$location=t,this.i18nService=i,this.dataService=r}return e.prototype.$onInit=function(){var e=this;h5.isDatastoreBrowserPopUpWindow=!0;var t=this.$location.search(),i=t.datastoreId;this.dataService.getProperties(i,["name"]).then(function(t){t&&(e.$document[0].title=e.i18nService.getString("StorageUi","popupDatastoreBrowser.title",t.name))})},e.prototype.$onDestroy=function(){delete h5.isDatastoreBrowserPopUpWindow},e.$inject=["$document","$location","i18nService","dataService"],e}(),i={controller:t,templateUrl:"storage-ui/resources/storage/views/manage/files/popup/datastoreBrowserPopUp.html"};angular.module("com.vmware.vsphere.client.storage").component("datastoreBrowserPopUp",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.mutationService=t,this.datastoreConstants=i,this.defaultUriSchemeUtil=r,this.clarityModalService=n,this.vxValidatorFactory=o,this.storageValidationService=a}return e.prototype.openRenameFileDialog=function(e,t,i){var r=this,n=this.vxValidatorFactory.create(),o={contentTemplate:"storage-ui/resources/storage/views/manage/files/RenameFileView.html",title:this.i18nService.getString("StorageUi","renameFile.title"),subTitle:{objectId:e},defaultButton:"submit",dialogData:{spec:t,getStorageString:this.i18nService.getString.bind(this,"StorageUi"),validator:n,isValidName:this.storageValidationService.validateDatastoreBrowserItemName.bind(this.storageValidationService)},alerts:[],onSubmit:function(){var o=n.validate();return(!o||!o.length)&&(r.mutationService.apply(e,"com.vmware.vsphere.client.storage.DatastoreFileRenameSpec",t).then(function(){i&&i()}),!0)}};this.clarityModalService.openOkCancelModal(o)},e.$inject=["i18nService","mutationService","datastoreConstants","defaultUriSchemeUtil","clarityModalService","vxValidatorFactory","storageValidationService"],e}();e.RenameFileService=t,angular.module("com.vmware.vsphere.client.storage").service("renameFileService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.clarityModalService=t,this.$q=i}return e.prototype.openStreamVmdkWarningDialog=function(e){var t=this.$q.defer(),i={contentTemplate:"storage-ui/resources/storage/views/manage/files/StreamVmdkWarningDialog.html",defaultButton:"submit",dialogData:{},onSubmit:function(){return t.resolve(e),!0},onCancel:function(){return t.resolve(null),!1}};return e?(i.title=this.i18nService.getString("StorageUi","vsanVmdkDownloadWarningDialog.title"),i.dialogData.warningDialogText=this.i18nService.getString("StorageUi","vsanVmdkDownloadWarningDialog.text"),i.submitButtonTitle=this.i18nService.getString("StorageUi","vsanVmdkDownloadWarningDialog.submitButtonTitle")):(i.title=this.i18nService.getString("StorageUi","vsanVmdkUploadWarningDialog.title"),i.dialogData.warningDialogText=this.i18nService.getString("StorageUi","vsanVmdkUploadWarningDialog.text"),i.submitButtonTitle=this.i18nService.getString("StorageUi","vsanVmdkUploadWarningDialog.submitButtonTitle")),this.clarityModalService.openOkCancelModal(i),t.promise},e.$inject=["i18nService","clarityModalService","$q"],e}();e.StreamVmdkService=t,angular.module("com.vmware.vsphere.client.storage").service("streamVmdkService",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(){return[{displayName:i.getString("StorageUi","datastore.manage.hardwareAcceleration.list.columnHeader.hostName"),field:"hostName",width:"150px",template:function(e){var t=n.getColumnRenderer("object-link"),i={hostName:e.hostName,hostId:o.getVsphereObjectId(e.hostRef)};return t(["hostId","hostName","vsphere-icon-host"],i)}},{displayName:i.getString("StorageUi","datastore.manage.hardwareAcceleration.list.columnHeader.hardwareAcceleration"),field:"hardwareAccelerationSupport",width:"150px",template:function(e){var t=c[e.hardwareAccelerationSupport];return i.getString("StorageUi",t)}}]}var s="storage:hostHardwareAccelerationForDatastore",c={vStorageSupported:"datastore.vStorage.supported",vStorageUnsupported:"datastore.vStorage.notSupported",vStorageUnknown:"datastore.vStorage.unknown",SUPPORTED_ON_ALL_HOSTS:"datastore.manage.hardwareAcceleration.vStorageSupportedOnAll",SUPPORTED_ON_SOME_HOSTS:"datastore.manage.hardwareAcceleration.vStorageSupportedOnSome",NOT_SUPPORTED_ON_ANY_HOST:"datastore.manage.hardwareAcceleration.vStorageSupportedNotSupported"},l=this;l.datastoreId=e._route.objectId,l.hostConnectivityLoading=!1,l.liveRefreshProperties=["host"],l.datagridOptions={height:"100%",columnDefs:a(),sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!1},l.headerOptions={title:""},l.refresh=function(){l.hostConnectivityLoading=!0,r.getProperties(l.datastoreId,[s]).then(function(e){if(e&&e[s]){l.datagridOptions.data=e[s].hostHardwareAccelerationItems;var t=c[e[s].summary];l.headerOptions.title=i.getString("StorageUi",t)}})["finally"](function(){l.hostConnectivityLoading=!1})},l.refresh()}angular.module("com.vmware.vsphere.client.storage").controller("HardwareAccelerationViewController",e),e.$inject=["$scope","vuiConstants","i18nService","dataService","columnRenderersRegistry","defaultUriSchemeUtil"]}();var storage_ui;!function(e){var t=function(){function e(){}return e}();e.AddStorageProviderSettingsApi=t;var i=function(){function e(){}return e}();e.StorageProviderSettings=i;var r=function(){function e(e,t,i,r,n,o,a,s,c){this.i18nService=e,this.clarityModalService=t,this.clarityConstants=i,this.mutationService=r,this.vuiConstants=n,this.timeFormatterService=o,this.$q=a,this.fileReaderService=s,this.$rootScope=c}return e.prototype.showAddStorageProviderDialog=function(e,r){function n(){if(u.dialogData.loading)return!1;u.alerts=[];var e=null;if("function"==typeof d.addStorageProviderSettingsApi.validate&&(e=d.addStorageProviderSettingsApi.validate()),e&&!e.result)return!1;var t={_type:"com.vmware.vsphere.client.sms.StorageProviderRegisterSpec",providerName:c.name,username:c.username,providerUrl:c.providerUrl,password:c.password};return u.dialogData.loading=!0,u.dialogData.loadingMsg=s.i18nService.getString("StorageUi","storage.storageProviders.newStorageProviderForm.registering"),c.customCertificateFile?s.fileReaderService.readFileContentAsBase64(c.customCertificateFile).then(function(e){return e?(t.certificate=e,o(t)["finally"](function(){u.dialogData.loading=!1})):(u.alerts=[{text:s.i18nService.getString("StorageUi","storage.storageProviders.newStorageProviderForm.invalidFile"),type:s.vuiConstants.notifications.type.ERROR}],u.dialogData.loading=!1,!1)})["finally"](function(){return u.dialogData.loading=!1,!1}):o(t)["finally"](function(){u.dialogData.loading=!1})}function o(t){return s.mutationService.apply(e,t._type,t).then(function(e){return!!e&&(e&&e.error&&e.result&&e.result.certificate&&e.result.sslThumbprint?a(e.result).then(function(i){return!!i&&(t.certificate=e.result.certificate,o(t))}):e.error&&e.error.localizedMessage?(u.alerts=[{text:e.error.localizedMessage,type:s.vuiConstants.notifications.type.ERROR}],!1):(s.$rootScope.$broadcast("vsphere.core.storage.storageProviders.providersList.refreshProvidersList"),!0))})}function a(e){var t;if(e.details){var i={validFrom:s.timeFormatterService.formatDate(e.details.validFrom),validTo:s.timeFormatterService.formatDate(e.details.validTo)};t=s.$q.all(i).then(function(t){return s.i18nService.getString("StorageUi","h5.storage.storageProviders.newStorageProviderForm.sslWithDetailsVerifyWarningMsgFormat",e.sslThumbprint,e.details.issuerName,e.details.subjectName,t.validFrom,t.validTo)})}else t=s.$q.when(s.i18nService.getString("StorageUi","h5.storage.storageProviders.newStorageProviderForm.sslVerifyWarningMsgFormat",e.sslThumbprint));var r=s.$q.defer();return t.then(function(e){var t={title:s.i18nService.getString("StorageUi","storage.storageProviders.newStorageProviderForm.sslVerifyWarningTitle"),message:e,icon:"vx-icon-warning-32x32",size:"lg",saveButtonLabel:s.i18nService.getString("Common","yes.label"),cancelButtonLabel:s.i18nService.getString("Common","no.label"),preserveNewlines:!0,submit:function(){return r.resolve(!0),!0},onCancel:function(){r.resolve(!1)}};s.clarityModalService.openConfirmationModal(t)}),r.promise}var s=this,c=new i,l=new t,d={providerSettings:c,providerNames:r,addStorageProviderSettingsApi:l},u={title:this.i18nService.getString("StorageUi","storage.storageProviders.newStorageProviderForm.title"),subTitle:{objectId:e},contentTemplate:"storage-ui/resources/storage/views/storageProviders/actions/AddStorageProviderDialog.html",defaultButton:"submit",onSubmit:n,dialogData:d,alerts:[]};this.clarityModalService.openOkCancelModal(u)},e.$inject=["i18nService","clarityModalService","clarityConstants","mutationService","vuiConstants","timeFormatterService","$q","fileReaderService","$rootScope"],e}();e.AddStorageProviderDialogService=r,angular.module("com.vmware.vsphere.client.storage").service("addStorageProviderDialogService",r)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.i18nService=e,this.$element=t,this.$timeout=i,this.vxValidatorFactory=r,this.idGeneratorService=n,this.PROVIDER_NAME_MAX_CHARS=80,this.USERNAME_MAX_CHARS=255,this.PASSWORD_MAX_CHARS=255,this.useCustomCertificate=!1,this.INVALID_CHARACTERS=/!|@|#|%|\^|\&|\*/,this.validateName=function(e){var t=[];return o.validateInvalidCharacters(e)?o.validateIsProviderNameUnique(e)||t.push(o.i18n("StorageUi","storage.storageProviders.newStorageProviderForm.providerNameExists")):t.push(o.i18n("StorageUi","storage.storageProviders.newStorageProviderForm.invalidChars")),t},this.validateUsername=function(e){var t=[];return o.validateInvalidCharacters(e)||t.push(o.i18n("StorageUi","storage.storageProviders.newStorageProviderForm.invalidChars")),t},this.i18n=e.getString,this.validator=this.vxValidatorFactory.create()}return e.prototype.$onInit=function(){this.componentApi&&(this.componentApi.validate=this.validate.bind(this));var e=this,t=this.$element.find(".storage-provider-certificate-upload-file-input");t.on("change",function(t){t.target.files&&t.target.files.length&&e.setCertificateFile(t.target.files[0]),this.value=null}),this.nameInputId=this.idGeneratorService.nextId(),this.urlInputId=this.idGeneratorService.nextId(),this.usernameInputId=this.idGeneratorService.nextId(),this.passwordInputId=this.idGeneratorService.nextId(),this.certificateLocationLabelId=this.idGeneratorService.nextId()},e.prototype.setCertificateFile=function(e){this.customCertificateFile=e,this.certificateFileLocation=e.name,this.updateCertificateFile()},e.prototype.unsetCertificateFile=function(){this.certificateFileLocation&&(this.customCertificateFile=null,this.certificateFileLocation="",this.updateCertificateFile())},e.prototype.updateCertificateFile=function(){this.useCustomCertificate?this.providerSettings.customCertificateFile=this.customCertificateFile:this.providerSettings.customCertificateFile=null},e.prototype.onBrowseCertificate=function(){var e=this.$element.find(".storage-provider-certificate-upload-file-input");this.$timeout(function(){e.click()})},e.prototype.validate=function(){var e=this.validator.validate();return{result:!(e&&e.length),errors:e}},e.prototype.validateInvalidCharacters=function(e){return!(e&&this.INVALID_CHARACTERS.test(e))},e.prototype.validateIsProviderNameUnique=function(e){return!(this.providerNames&&this.providerNames.indexOf(e)>=0)},e.$inject=["i18nService","$element","$timeout","vxValidatorFactory","idGeneratorService"],e}();e.AddStorageProviderSettings=t,angular.module("com.vmware.vsphere.client.storage").component("addStorageProviderSettings",{templateUrl:"storage-ui/resources/storage/views/storageProviders/actions/AddStorageProviderSettings.html",bindings:{providerSettings:"=",providerNames:"<",componentApi:"="},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.storageProvidersItemBuilderService=e}return e.prototype.$onChanges=function(){this.refresh()},e.prototype.refresh=function(){var e=this;this.storageProviderListItem&&(this.propertyViewData=null,this.storageProvidersItemBuilderService.getStorageProviderCertificateDetails(this.storageProviderListItem).then(function(t){e.propertyViewData=t}))},e.$inject=["storageProvidersItemBuilderService"],e}();e.StorageProviderCertificateDetails=t,angular.module("com.vmware.vsphere.client.storage").component("storageProviderCertificateDetails",{template:'<vx-property-view data="$ctrl.propertyViewData"></vx-property-view>',bindings:{storageProviderListItem:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e){this.storageProvidersItemBuilderService=e}return e.prototype.$onChanges=function(){this.refresh()},e.prototype.refresh=function(){this.storageProviderListItem&&(this.storageProviderListItem._isStorageProviderItem?this.propertyViewData=this.storageProvidersItemBuilderService.getStorageProviderGeneralDetails(this.storageProviderListItem):this.storageProviderListItem._isStorageArrayItem&&(this.propertyViewData=this.storageProvidersItemBuilderService.getStorageArrayGeneralDetails(this.storageProviderListItem)))},e.$inject=["storageProvidersItemBuilderService"],e}();e.StorageProviderItemGeneralDetails=t,angular.module("com.vmware.vsphere.client.storage").component("storageProviderItemGeneralDetails",{template:'<vx-property-view data="$ctrl.propertyViewData"></vx-property-view>',bindings:{storageProviderListItem:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i){this.storageProvidersItemBuilderService=e,this.vuiConstants=t,this.i18nService=i}return e.prototype.$onChanges=function(){this.refresh()},e.prototype.getColumnDefinitions=function(){return[{displayName:this.i18nService.getString("StorageUi","storage.storageProviders.supportedVendorIdsView.vendorIdsColumn"),field:"vendorId",template:"#:vendorId#"},{displayName:this.i18nService.getString("StorageUi","storage.storageProviders.supportedVendorIdsView.modelIdsColumn"),field:"modelId",template:"#:modelId#"}]},e.prototype.refresh=function(){var e=[];this.storageProviderListItem&&(e=this.storageProvidersItemBuilderService.getSupportedVendorIdItems(this.storageProviderListItem)),this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.NONE,data:e,resizable:!0}},e.$inject=["storageProvidersItemBuilderService","vuiConstants","i18nService"],e}();e.StorageProviderSupportedVendorIds=t,angular.module("com.vmware.vsphere.client.storage").component("storageProviderSupportedVendorIds",{template:'<div vui-datagrid="$ctrl.datagridOptions" class="fill-parent vui-grid-cell-ellipsis"></div>',bindings:{storageProviderListItem:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){angular.module("com.vmware.vsphere.client.storage").constant("storageProviderConstants",{vasaProviderStatus:{offline:"offline",online:"online",syncError:"syncError",connected:"connected",disconnected:"disconnected"},certificateStatus:{expired:"expired",expirySoftLimitReached:"expirySoftLimitReached",expiryHardLimitReached:"expiryHardLimitReached",valid:"valid"},vasaProviderInfoType:{PERSISTENCE:"PERSISTENCE"},vasaProviderInfoCategory:{internal:"internal"},actions:{ADD:"vsphere.core.storage.storageProviders.addNew",RESYNC_INTERNAL_PROVIDER:"vsphere.core.storage.storageProviders.resyncInternalVasaProvider",REMOVE:"vsphere.core.storage.storageProviders.remove",SYNC:"vsphere.core.storage.storageProviders.sync",REFRESH_CERTIFICATE:"vsphere.core.storage.storageProviders.refreshCertificate"}})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.storageProvidersItemBuilderService=e,this.storageProviderConstants=t,this.VASA_API_VERSION_1_0="1.0",this.VASA_API_VERSION_1_5="1.5"}return e.prototype.isVasaProviderItem=function(e){return e&&e._isStorageProviderItem&&e._data&&this.storageProvidersItemBuilderService.isVasaProviderInfo(e._data.providerInfo)},e.prototype.isRemoveProviderActionAvailable=function(e){return!!this.isVasaProviderItem(e)&&e._data.providerInfo.category!==this.storageProviderConstants.vasaProviderInfoCategory.internal},e.prototype.isSyncProviderActionAvailable=function(e){if(!this.isVasaProviderItem(e))return!1;var t=e._data.providerInfo,i=t.arrayIndependentProvider;if(i||t.vasaVersion===this.VASA_API_VERSION_1_0)return!0;var r=_.find(t.relatedStorageArray,function(e){return e&&e.active});return!!r},e.prototype.isRefreshCertificateActionAvailable=function(e){if(!this.isVasaProviderItem(e))return!1;var t=e._data.providerInfo;return t.vasaVersion!==this.VASA_API_VERSION_1_0&&t.vasaVersion!==this.VASA_API_VERSION_1_5&&(t.retainVasaProviderCertificate!==!0&&t.category!==this.storageProviderConstants.vasaProviderInfoCategory.internal)},e.$inject=["storageProvidersItemBuilderService","storageProviderConstants"],e}();e.StorageProvidersActionService=t,angular.module("com.vmware.vsphere.client.storage").service("storageProvidersActionService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(){this._isStorageProviderItem=!1,this._isStorageArrayItem=!1}return e}();e.StorageProviderListItem=t;var i=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.defaultUriSchemeUtil=t,this.storageProviderConstants=i,this.timeFormatterService=r,this.vxPropertyViewService=n,this.$q=o,this.STORAGE_SUPPORTED_PROFILES_PREFIX="storage.storageProviders.storageArrayView.supportedProfile.",this.NA_STRING=e.getString("StorageUi","informationNotAccessible")}return e.prototype.getProviderCentricData=function(e){function t(){return"itemId_"+r++}var i=this,r=0,n=[],o={},a=[];return _.forEach(e,function(e){_.forEach(e.storageProviderInfoList,function(r){var s=r.provider.value;if(!o.hasOwnProperty(s)){var c=i.createStorageProviderItem(r,s,a);o[s]=c,n.push(c)}var l=i.createStorageArrayItem(e,r,t(),s);n.push(l)})}),this.$q.all(a).then(function(){return n})},e.prototype.createStorageArrayItem=function(e,i,r,n){var o=new t;return o.id=this.generateStorageArrayItemId(e,n,r),o.parentId=n,o.nameFormatted=this.formatStorageArrayName(e,i),o.providerStatusFormatted="",o.activeStandbyFormatted=this.formatStorageArrayActiveStandby(i),o.priorityFormatted=this.formatStorageArrayPriority(e,i),o.urlFormatted="",o.lastSyncTime=0,o.lastSyncTimeFormatted="",o.certificateExpiryTime=0,o.certificateExpiryTimeFormatted="",o.vasaApiVersionFormatted="",o._data=e,o._isStorageArrayItem=!0,o},e.prototype.formatStorageArrayPriority=function(e,t){if(!e.storageArray||!e.storageArray.uuid||!this.isVasaProviderInfo(t.providerInfo))return this.NA_STRING;var i=_.find(t.providerInfo.relatedStorageArray,function(t){return t&&t.arrayId===e.storageArray.uuid});return i?""+i.priority:this.NA_STRING},e.prototype.formatStorageArrayActiveStandby=function(e){return e?e.isActive===!0?this.i18nService.getString("StorageUi","storage.storageProviders.providersList.activeColumn.activeValue"):e.isActive===!1?this.i18nService.getString("StorageUi","storage.storageProviders.providersList.activeColumn.standbyValue"):this.NA_STRING:this.NA_STRING},e.prototype.generateStorageArrayItemId=function(e,t,i){return e.storageArray?e.storageArray.uuid+"_"+t:i},e.prototype.formatStorageArrayName=function(e,t){var i=e.storageProviderInfoList?e.storageProviderInfoList.length:0,r=e.numOnlineStorageProviders;if(e.storageArray){var n=e.storageArrayFriendlyName||e.storageArray.name;return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.nameColumn.storageArrayTitleFormat",n,r,i)}return this.isIndependentPersistentProvider(t)?this.i18nService.getString("StorageUi","storage.storageProviders.providersList.nameColumn.internallyManagedStorageArray"):this.i18nService.getString("StorageUi","storage.storageProviders.providersList.nameColumn.undefinedStorageArrayTitleFormat",r,i)},e.prototype.isIndependentPersistentProvider=function(e){if(!e||!this.isVasaProviderInfo(e.providerInfo))return!1;var t=e.providerInfo,i=!!t.arrayIndependentProvider,r=t.type===this.storageProviderConstants.vasaProviderInfoType.PERSISTENCE,n=t.category===this.storageProviderConstants.vasaProviderInfoCategory.internal;return i&&r&&n},e.prototype.isVasaProviderInfo=function(e){return e&&"com.vmware.vim.binding.sms.provider.VasaProviderInfo"===e._type},e.prototype.formatActivationMode=function(e){return this.isVasaProviderInfo(e)?e.needsExplicitActivation===!0?this.i18nService.getString("StorageUi","storage.storageProviders.providersList.activation.manual"):this.i18nService.getString("StorageUi","storage.storageProviders.providersList.activation.auto"):this.NA_STRING},e.prototype.formatNamespace=function(e){return this.isVasaProviderInfo(e)?e.namespace||this.NA_STRING:this.NA_STRING},e.prototype.formatProviderId=function(e){return this.isVasaProviderInfo(e)?e.providerId||this.NA_STRING:this.NA_STRING},e.prototype.formatSupportedProfiles=function(e){var t=this;if(e){var i=[];if(_.forEach(e,function(e){if(e){var r=t.i18nService.getString("StorageUi",t.STORAGE_SUPPORTED_PROFILES_PREFIX+e);0===r.indexOf(t.STORAGE_SUPPORTED_PROFILES_PREFIX)&&(r=e),r&&i.push(r)}}),i.length)return i}return[this.NA_STRING]},e.prototype.formatArrayProperty=function(e){return e&&0!==e.length&&e.join(" ").trim()?e:this.NA_STRING},e.prototype.getStorageArrayGeneralDetails=function(e){var t=e&&e._data&&e._data.storageArray;if(!t)return null;var i=this.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("general"),n=r.section("generalSection");return n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.arrayName"),e._data.storageArrayFriendlyName||t.name||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.uuid"),t.uuid||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.vendorId"),t.vendorId||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.modelId"),t.modelId||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.firmware"),t.firmware||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.alternateName"),this.formatArrayProperty(t.alternateName)),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.supportedBlockInterface"),this.formatArrayProperty(t.supportedBlockInterface)),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.supportedFileSystemInterface"),this.formatArrayProperty(t.supportedFileSystemInterface)),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.supportedProfile"),this.formatSupportedProfiles(t.supportedProfile)),i.build()},e.prototype.getStorageProviderGeneralDetails=function(e){var t=e&&e._data&&e._data.providerInfo;if(!t)return null;var i=this.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("general"),n=r.section("generalSection");return n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.providerName"),t.name||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.providerStatus"),e.providerStatusFormatted),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.activeStandbyStatus"),e.activeStandbyFormatted),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.needsExplicitActivation"),this.formatActivationMode(t)),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.url"),e.urlFormatted),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.providerVersion"),t.version||this.NA_STRING),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.apiVersion"),e.vasaApiVersionFormatted),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.defaultNamespace"),this.formatNamespace(t)),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.providerId"),this.formatProviderId(t)),n.property(this.i18nService.getString("StorageUi","storage.storageProviders.storageArrayView.supportedProfile"),this.isVasaProviderInfo(t)?this.formatSupportedProfiles(t.supportedProviderProfile):this.NA_STRING),i.build()},e.prototype.getStorageProviderCertificateDetails=function(e){var t=this;if(!e||!e._data)return this.$q.when(null);var i=e._data.certificateDetailsInfo||{},r={validFrom:this.timeFormatterService.formatDate(i.validFrom),validTo:this.timeFormatterService.formatDate(i.validTo)};return this.$q.all(r).then(function(e){var r=t.vxPropertyViewService.createPropertyViewBuilder(),n=r.category("general"),o=n.section("generalSection");return o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.subject"),i.subjectName||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.issuer"),i.issuerName||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.version"),i.version||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.kind"),i.kind||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.validFrom"),e.validFrom||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.validTo"),e.validTo||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.algorithm"),i.algorithmName||t.NA_STRING),o.property(t.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.publicKeyAlgorithm"),i.publicKeyAlgorithmName||t.NA_STRING),r.build()})},e.prototype.getSupportedVendorIdItems=function(e){var t=e&&e._data&&e._data.providerInfo;return t&&this.isVasaProviderInfo(t)?_.map(t.supportedVendorModelMapping,function(e){return{vendorId:e.vendorId,modelId:e.modelId}}):[]},e.prototype.createStorageProviderItem=function(e,i,r){var n=new t;return n.id=i,n.parentId=null,n.nameFormatted=e.providerInfo.name,n._data=e,n._isStorageProviderItem=!0,this.isVasaProviderInfo(e.providerInfo)&&(n.urlFormatted=e.providerInfo.url||this.NA_STRING,n.vasaApiVersionFormatted=e.providerInfo.vasaVersion||this.NA_STRING,n.providerStatusFormatted=this.formatProviderStatus(e.providerInfo.status),n.statusFault=e.providerInfo.statusFault,n.lastSyncTime=moment(e.providerInfo.lastSyncTime).valueOf(),n.lastSyncTimeFormatted=this.NA_STRING,e.providerInfo.lastSyncTime&&!isNaN(n.lastSyncTime)&&r.push(this.timeFormatterService.formatDate(n.lastSyncTime).then(function(e){n.lastSyncTimeFormatted=e})),n.certificateExpiryTime=moment(e.providerInfo.certificateExpiryDate).valueOf(),n.certificateExpiryTimeFormatted=this.formatCertificateExpiryTime(e.providerInfo.certificateStatus,e.providerInfo.certificateExpiryDate),n.certificateExpiryTimeIcon=this.getCertificateExpiryTimeIcon(e.providerInfo.certificateStatus),n.activeStandbyFormatted=this.NA_STRING,n.priorityFormatted=this.NA_STRING),n},e.prototype.getCertificateExpiryTimeIcon=function(e){switch(e){case this.storageProviderConstants.certificateStatus.expired:case this.storageProviderConstants.certificateStatus.expiryHardLimitReached:return"vsphere-icon-status-error";case this.storageProviderConstants.certificateStatus.expirySoftLimitReached:return"vsphere-icon-status-warning"}return null},e.prototype.formatCertificateExpiryTime=function(e,t){if(e===this.storageProviderConstants.certificateStatus.expired)return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.certificateExpiryColumn.certificateExpired");if(!t)return this.NA_STRING;var i=moment(t);if(isNaN(i.valueOf()))return this.NA_STRING;var r=moment(),n=i.diff(r,"days");
return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.certificateExpiryColumn.daysRemaining",n)},e.prototype.formatProviderStatus=function(e){switch(e){case this.storageProviderConstants.vasaProviderStatus.offline:return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.statusColumn.offlineValue");case this.storageProviderConstants.vasaProviderStatus.online:return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.statusColumn.onlineValue");case this.storageProviderConstants.vasaProviderStatus.syncError:return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.statusColumn.syncErrorValue");case this.storageProviderConstants.vasaProviderStatus.connected:return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.statusColumn.connectedValue");case this.storageProviderConstants.vasaProviderStatus.disconnected:return this.i18nService.getString("StorageUi","storage.storageProviders.providersList.statusColumn.disconnectedValue");default:return this.NA_STRING}},e.$inject=["i18nService","defaultUriSchemeUtil","storageProviderConstants","timeFormatterService","vxPropertyViewService","$q"],e}();e.StorageProvidersItemBuilderService=i,angular.module("com.vmware.vsphere.client.storage").service("storageProvidersItemBuilderService",i)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.i18nService=e,this.$scope=t,this.storageUtil=i,this.storageProvidersService=r,this.storageProvidersItemBuilderService=n,this.columnRenderersRegistry=o,this.$timeout=a,this.commonActionBarService=s,this.storageProviderConstants=c,this.vuiConstants=l,this.storageProvidersActionService=d,this.defaultUriSchemeUtil=u,this.vcService=p,this.vuiLocale=v,this.CUSTOM_TEXT_FILTER={extra:!1,messages:{info:this.vuiLocale.datagrid.colFilterInfo,filter:this.vuiLocale.datagrid.filter,clear:this.vuiLocale.datagrid.clear},operators:{string:{contains:this.vuiLocale.datagrid.contains}},ui:function(e){for(var t=e.parent();t.children().length>1;)$(t.children()[0]).remove();t.prepend('<input data-bind="value:filters[0].value" class="k-textbox" type="text">')}},this.i18n=e.getString,this.providerStatusDetailsMap={},this.treeListWidget=null,this.providerListColumns=this.treeListColumns(),this.providerListMessages={noRows:""},this.actionBarOptions={actions:[]}}return e.prototype.$onInit=function(){var e=this;this.vcService.is65VcOrLater(this.vcId).then(function(t){t||e.$scope.$on("vsphere.core.storage.storageProviders.providersList.refreshProvidersList",function(){e.refresh()})})},e.prototype.$onChanges=function(){this.refresh()},e.prototype.$onDestroy=function(){kendo.destroy($("#storage-providers-list-tree"))},e.prototype.setTreeListOptions=function(e){this.providerListDataSource=new kendo.data.TreeListDataSource({data:e,schema:{model:{id:"id",expanded:!0}}}),this.updateActionBar()},e.prototype.findTreeListItem=function(e){if(!e||!this.providerListDataSource)return null;var t=this.providerListDataSource;if(e._isStorageProviderItem)return _.find(t.rootNodes(),function(t){return t.id===e.id});if(e._isStorageArrayItem){var i=_.find(t.rootNodes(),function(t){return t.id===e.parentId});if(i)return _.find(t.childNodes(i),function(t){return t.id===e.id})}return null},e.prototype.onTreeListDataBound=function(){var e=this;this.itemToSelect&&this.$timeout(function(){if(e.treeListWidget){var t=e.findTreeListItem(e.itemToSelect);if(t){var i=e.treeListWidget.itemFor(t);i&&e.treeListWidget.select(i)}}},0)},e.prototype.onSelectionChanged=function(){if(this.treeListWidget){var e=this.treeListWidget.dataItem(this.treeListWidget.select());if(e)return this.masterDetailsViewContext.selectedItems=[e],void this.updateActionBar()}this.masterDetailsViewContext.selectedItems=[],this.updateActionBar()},e.prototype.refresh=function(){if(this.vcId&&this.defaultUriSchemeUtil.isRootFolder(this.vcId)){this.loading||(this.itemToSelect=this.masterDetailsViewContext.selectedItems&&this.masterDetailsViewContext.selectedItems.length&&this.masterDetailsViewContext.selectedItems[0]),this.loading=!0,this.actionsCache=null,this.providerListDataSource||this.setTreeListOptions([]),this.masterDetailsViewContext.selectedItems=[];var e=this;this.lastDataRequestPromise=this.storageProvidersService.getStorageProviderSystemInfoEx(this.vcId);var t=this.lastDataRequestPromise;t.then(function(i){t===e.lastDataRequestPromise&&e.storageProvidersItemBuilderService.getProviderCentricData(i).then(function(t){e.setTreeListOptions(t),e.providerNames=_.map(_.filter(t,function(e){return e._isStorageProviderItem}),function(e){return e._data&&e._data.providerInfo&&e._data.providerInfo.name}),_.each(t,function(t){t.statusFault&&t.statusFault.message&&(e.providerStatusDetailsMap[t.id]={title:e.i18n("StorageUi","storage.storageProviders.providersList.detailsDialog.title"),message:t.statusFault.message})})})})["finally"](function(){t===e.lastDataRequestPromise&&(e.loading=!1)})}},e.prototype.getStatusDetailsSignPostConfig=function(e){return this.providerStatusDetailsMap[e]},e.prototype.updateActionBar=function(){var e=this;this.commonActionBarService.updateActionBar(this.actionBarOptions,"actions",[this.vcId],this.getActions(),this.actionsCache).then(function(t){e.actionsCache=t})},e.prototype.getSelectedItem=function(){return this.masterDetailsViewContext&&this.masterDetailsViewContext.selectedItems&&1===this.masterDetailsViewContext.selectedItems.length?this.masterDetailsViewContext.selectedItems[0]:null},e.prototype.getActions=function(){var e=this,t=[];return t.push({actionId:this.storageProviderConstants.actions.ADD,getActionInvocationContext:function(){return{providerNames:e.providerNames}}}),t.push({actionId:this.storageProviderConstants.actions.RESYNC_INTERNAL_PROVIDER}),t.push(this.vuiConstants.actions.SEPARATOR),t.push({actionId:this.storageProviderConstants.actions.SYNC,getActionInvocationContext:function(){var t=e.getSelectedItem();return t&&t._data},isActionAvailable:function(t){var i=e.getSelectedItem();return!(!i||!t.available)&&e.storageProvidersActionService.isSyncProviderActionAvailable(i)}}),t.push({actionId:this.storageProviderConstants.actions.REMOVE,getActionInvocationContext:function(){var t=e.getSelectedItem();return t&&t._data},isActionAvailable:function(t){var i=e.getSelectedItem();return!(!i||!t.available)&&e.storageProvidersActionService.isRemoveProviderActionAvailable(i)}}),t.push({actionId:this.storageProviderConstants.actions.REFRESH_CERTIFICATE,getActionInvocationContext:function(){var t=e.getSelectedItem();return t&&t._data},isActionAvailable:function(t){var i=e.getSelectedItem();return!(!i||!t.available)&&e.storageProvidersActionService.isRefreshCertificateActionAvailable(i)}}),t},e.prototype.treeListColumns=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("icon-text"),i=this.columnRenderersRegistry.getColumnRenderer("text");return[{title:this.i18n("StorageUi","storage.storageProviders.providersList.nameColumn.groupTitleProviderSystem"),field:"nameFormatted",template:"#:nameFormatted#",width:"220px",filterable:this.CUSTOM_TEXT_FILTER},{title:this.i18n("StorageUi","storage.storageProviders.providersList.statusColumn"),field:"providerStatusFormatted",template:function(t){if(t.statusFault&&t.statusFault.message){var r=e.i18n("StorageUi","storage.storageProviders.providersList.statusColumn.details"),n='<a class="storage-providers-mode-details-link" vui-sign-post="$ctrl.getStatusDetailsSignPostConfig(\''+t.id+"')\" >"+r+"</a>";return i(["providerStatusFormatted"],t)+n}return i(["providerStatusFormatted"],t)},filterable:this.CUSTOM_TEXT_FILTER},{title:this.i18n("StorageUi","storage.storageProviders.providersList.activeColumn"),field:"activeStandbyFormatted",template:"#:activeStandbyFormatted#",filterable:this.CUSTOM_TEXT_FILTER},{title:this.i18n("StorageUi","storage.storageProviders.providersList.priorityColumn"),field:"priorityFormatted",template:"#:priorityFormatted#",filterable:!1},{title:this.i18n("StorageUi","storage.storageProviders.providersList.urlColumn"),field:"urlFormatted",template:"#:urlFormatted#",filterable:this.CUSTOM_TEXT_FILTER},{title:this.i18n("StorageUi","storage.storageProviders.providersList.lastSyncTimeColumn"),field:"lastSyncTimeFormatted",template:"#:lastSyncTimeFormatted#",sortable:{compare:function(t,i){return e.storageUtil.compareNumericValues(t,i,"lastSyncTime")}},filterable:!1},{title:this.i18n("StorageUi","storage.storageProviders.providersList.apiVersionColumn"),field:"vasaApiVersionFormatted",template:"#:vasaApiVersionFormatted#",filterable:!1},{title:this.i18n("StorageUi","storage.storageProviders.providersList.certificateExpiryColumn"),field:"certificateExpiryTimeFormatted",template:function(e){return e.certificateExpiryTimeIcon?t(["certificateExpiryTimeIcon","certificateExpiryTimeFormatted"],e):i(["certificateExpiryTimeFormatted"],e)},sortable:{compare:function(t,i){return e.storageUtil.compareNumericValues(t,i,"certificateExpiryTime")}},filterable:!1}]},e.$inject=["i18nService","$scope","storageUtil","storageProvidersService","storageProvidersItemBuilderService","columnRenderersRegistry","$timeout","commonActionBarService","storageProviderConstants","vuiConstants","storageProvidersActionService","defaultUriSchemeUtil","vcService","vuiLocale"],e}();e.StorageProvidersList=t,angular.module("com.vmware.vsphere.client.storage").component("storageProvidersList",{templateUrl:"storage-ui/resources/storage/views/storageProviders/StorageProvidersList.html",bindings:{vcId:"<",masterDetailsViewContext:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.tabs=[{name:this.i18nService.getString("StorageUi","storage.storageProviders.generalSettingsView.label"),templateUrl:"storage-ui/resources/storage/views/storageProviders/details/StorageProviderItemGeneralDetailsView.html",uid:"storage.providers.generalTab"},{name:this.i18nService.getString("StorageUi","storage.storageProviders.supportedVendorIdsView.label"),templateUrl:"storage-ui/resources/storage/views/storageProviders/details/StorageProviderSupportedVendorIdsView.html",uid:"storage.providers.supportedVendorIdsTab",metadata:{relevantFor:"_isStorageProviderItem"}},{name:this.i18nService.getString("StorageUi","storage.storageProviders.certificateDetailsView.label"),templateUrl:"storage-ui/resources/storage/views/storageProviders/details/StorageProviderCertificateDetailsView.html",uid:"storage.providers.certificateDetailsTab",metadata:{relevantFor:"_isStorageProviderItem"}}],this.detailsViewData={tabsPromise:this.$q.when(this.tabs)}}return e.$inject=["i18nService","$q"],e}();e.StorageProvidersMasterViewController=t,angular.module("com.vmware.vsphere.client.storage").controller("StorageProvidersMasterViewController",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.dataService=t,this.mutationService=i,this.storageProviderConstants=r,this.clarityModalService=n,this.$rootScope=o}return e.prototype.getStorageProviderSystemInfoEx=function(t){return this.dataService.getProperties(t,[e.STORAGE_PROVIDER_SYSTEM_PROPERTY]).then(function(t){return t&&t[e.STORAGE_PROVIDER_SYSTEM_PROPERTY]})},e.prototype.resyncInternalVasaProviders=function(e){var t=this,i={_type:"com.vmware.vsphere.client.sms.ResyncVsanProvidersSpec"};this.mutationService.apply(e,i._type,i).then(function(){t.$rootScope.$broadcast("vsphere.core.storage.storageProviders.providersList.refreshProvidersList")})},e.prototype.refreshCertificate=function(e,t){var i=this;if(e&&t&&t.providerInfo){if(t.providerInfo.certificateStatus===this.storageProviderConstants.certificateStatus.expired){var r={title:this.i18nService.getString("StorageUi","storage.storageProviders.actions.refresh.certificateExpiredTitle"),hideCancelButton:!0,message:this.i18nService.getString("StorageUi","storage.storageProviders.actions.refresh.certificateExpiredWarning"),icon:"icon-warning-32",submit:function(){return!0},preserveNewlines:!0};return void this.clarityModalService.openConfirmationModal(r)}var n={vasaStorageProvider:t.provider};t.providerInfo.status===this.storageProviderConstants.vasaProviderStatus.disconnected?n._type="com.vmware.vsphere.client.sms.ReconnectStorageProviderSpec":n._type="com.vmware.vsphere.client.sms.RefreshStorageProviderCertificateSpec",this.mutationService.apply(e,n._type,n).then(function(){i.$rootScope.$broadcast("vsphere.core.storage.storageProviders.providersList.refreshProvidersList")})}},e.prototype.syncProvider=function(e,t){var i=this;if(t&&t.provider){var r={_type:"com.vmware.vsphere.client.sms.StorageProviderSyncSpec",vasaStorageProvider:t.provider};this.mutationService.apply(e,r._type,r).then(function(){i.$rootScope.$broadcast("vsphere.core.storage.storageProviders.providersList.refreshProvidersList")})}},e.prototype.removeStorageProvider=function(e,t){var i=this;if(t&&t.providerInfo&&t.providerInfo.uid){var r={_type:"com.vmware.vsphere.client.sms.StorageProviderUnregisterSpec",uid:t.providerInfo.uid};this.mutationService.apply(e,r._type,r,this.i18nService.getString("StorageUi","storage.storageProviders.actions.remove.taskName")).then(function(){i.$rootScope.$broadcast("vsphere.core.storage.storageProviders.providersList.refreshProvidersList")})}},e.$inject=["i18nService","dataService","mutationService","storageProviderConstants","clarityModalService","$rootScope"],e.STORAGE_PROVIDER_SYSTEM_PROPERTY="vasa:storageProviderSystemInfoEx",e}();e.StorageProvidersService=t,angular.module("com.vmware.vsphere.client.storage").service("storageProvidersService",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D){return{showWizard:function(w){function b(){var e=d.build(T),t=m.build(T),i=v.build(T),r=p.build(T);return[e,t,r,i,M]}function I(e,t){var i,r=g.build(T);if(e)i=[r,M];else{var n=f.build(T);i=[r,n,M]}if(t){var o=h.build(T),a=D.build(T);i.unshift(o),i.splice(2,0,a)}return i}function _(e){var t=P.build(T);if(e)return[t,M];var i=C.build(T);return[t,i,M]}var T=i.$new(),E=[n.datastoreTypes.VMFS,n.datastoreTypes.NFS,n.datastoreTypes.NFS3,n.datastoreTypes.VVOL],V=l.build(T,E),M=u.build(T),O=S.getEntityType(w)===y.HOST,A=[{id:n.datastoreTypes.VMFS,pages:b()},{id:n.datastoreTypes.NFS,pages:I(O,!0)},{id:n.datastoreTypes.NFS3,pages:I(O,!1)},{id:n.datastoreTypes.VVOL,pages:_(O)}],k=[V];T.wizardConfig={pages:r.initializePageStates(k),flows:r.initializeFlowStates(A)},T.wizardConfig.iconClass="storage-ui-icon-create-datastore",T.wizardConfig.title=t.getString("StorageUi","addDatastoreWizard.title"),T.wizardConfig.cssClass="new-datastore-wizard",T.commonWizardManager=new o(w,T.wizardConfig),T.vmfsWizardManager=new a(T.commonWizardManager),T.nfsWizardManager=new s(T.commonWizardManager),T.vvolWizardManager=c.build(T.commonWizardManager),T.activeWizardManager=T.vmfsWizardManager,T.removeLoadingAndShowError=function(e){T.wizardConfig.loading=!1,e&&e.data&&e.data.message&&r.markPageIncompleteWithError(T.wizardConfig,e.data.message)},e({scope:T,configObjectName:"wizardConfig"}).show(),T.commonWizardManager.prepareUniqueDatastoreName()}}}angular.module("com.vmware.vsphere.client.storage").service("addDatastoreWizardService",e),e.$inject=["vuiWizardService","i18nService","$rootScope","wizardPageService","datastoreConstants","CommonWizardManager","VmfsWizardManager","NfsWizardManager","vvolWizardManagerFactory","datastoreTypePageService","vmfsNameAndDevicePageService","addDatastoreReadyToCompletePageService","vmfsVersionPageService","vmfsPartitionConfigurationPageService","vmfsMountOptionsPageService","nfsNameAndConfigurationPageService","nfsVersionPageService","nfsSelectHostsPageService","defaultUriSchemeUtil","managedEntityConstants","vvolNameAndContainerSelectionPageService","vvolSelectHostsPageService","nfsKerberosAuthenticationPageService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("CommonWizardManager",["i18nService","dataService","$q","defaultUriSchemeUtil","managedEntityConstants","datastoreConstants",function(e,t,i,r,n,o){return function(e,a){var s="newUniqueDatastoreName",c="storage:availableHostsForCreateDatastore",l={datastoreName:null,datastoreType:null},d={uniqueNamePromise:null,availableHosts:null},u={getUniqueDatastoreName:function(){return d.uniqueNamePromise||(d.uniqueNamePromise=t.getProperties(e,[s]).then(function(e){return e[s]})),d.uniqueNamePromise},prepareUniqueDatastoreName:function(){this.getUniqueDatastoreName()},setDatastoreType:function(e){l.datastoreType=e},getDatastoreType:function(){return l.datastoreType?l.datastoreType:o.datastoreTypes.VMFS},setDatastoreName:function(e){l.datastoreName=e},getDatastoreName:function(){return l.datastoreName},getContextObject:function(){return e},isHostContextObject:function(){return r.getEntityType(e)===n.HOST},getStorageFolder:function(){return r.getEntityType(e)===n.FOLDER?r.getManagedObjectReference(e):null},getWizardConfig:function(){return a},getAvailableHosts:function(){return d.availableHosts?i.when(d.availableHosts):t.getProperties(e,[c]).then(function(e){var t=e?e[c]||[]:[];return _.forEach(t,function(e){e.hostId=r.getVsphereObjectId(e.hostRef)}),d.availableHosts=t,t})}};return u}}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("NfsWizardManager",["i18nService","vxPropertyViewService","defaultUriSchemeUtil","mutationService","datastoreConstants","storageValidationService","ipParserService","dataService","$q",function(e,t,i,r,n,o,a,s,c){return function(l){function d(){return z.folderName}function u(e){z.folderName=e}function p(){return z.serverName}function v(e){z.nfs41ServerNames=e}function m(){return z.nfs41ServerNames||[]}function g(){if(E()===n.nfsVersions.NFS_4_1){var e=_.find(m(),function(e){return a.isIpv6AddressValid(e)});return!!e}return a.isIpv6AddressValid(p())}function h(e){return _.map(e.split(/[\s,;]+/),function(e){return e.trim()}).filter(function(e){return!/\s/.test(e)&&e.length>0})}function f(){var e=p();if(!P(e)){var t=h(e);if(t&&0!==t.length){var i=[];if(t.forEach(function(e){y(e)||i.push(e)}),i.length>0){var r=m().concat(i);v(r)}}}}function S(){var t=253,i=p(),r=P(i),s=[];switch(E()){case n.nfsVersions.NFS_3:r||(s=[i]);break;case n.nfsVersions.NFS_4_1:s=m(),r||(s=s.concat(h(i)))}if(!s||0===s.length)return e.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.serverListEmptyString");var c=_.filter(s,function(e){var i=!o.isValidDnsName(e)&&!a.isIpv6AddressValid(e);return e.length>t||i});return c&&c.length>0?e.getString("StorageUi","addDatastoreWizard.nfsServerName.invalid",c[0]):null}function y(e){var t=m();if(t){var i=_.find(t,function(t){return t===e});return void 0!==i}return!1}function P(e){return!e||""===e.trim()}function C(e){z.serverName=e}function D(){return z.existingDatastoreId}function w(e){z.existingDatastoreId=e}function b(){return z.existingDatastoreId?(H.existingDsHostsPromise&&H.existingDsId===z.existingDatastoreId||(H.existingDsId=z.existingDatastoreId,H.existingDsHostsPromise=s.getProperties(z.existingDatastoreId,["hostKey"]).then(function(e){var t={};return e&&e.hostKey&&_.forEach(e.hostKey,function(e){if(e){var r=i.getVsphereObjectId(e);r&&(t[r]=!0)}}),t})),H.existingDsHostsPromise):c.when({})}function I(){var i=_.partial(e.getString,"StorageUi"),r=t.createPropertyViewBuilder(),n=r.category("category"),o=n.section("general").title(i("addDatastoreWizard.vmfsReadyToCompletePage.general"));o.property(i("addDatastoreWizard.vmfsReadyToCompletePage.name"),l.getDatastoreName()),o.property(i("addDatastoreWizard.vmfsReadyToCompletePage.type"),L());var a=n.section("nfsSettings").title(i("addDatastoreWizard.nfsReadyToCompletePage.nfsSettings"));if(a.property(i("addDatastoreWizard.nfsSettingsPage.server"),F()),a.property(i("addDatastoreWizard.nfsSettingsPage.folder"),d()),a.property(i("addDatastoreWizard.nfsReadyToCompletePage.accessMode"),i("datastore.accessMode."+U())),V()&&a.property(i("addDatastoreWizard.nfsReadyToCompletePage.kerberos"),T()),!l.isHostContextObject()){var s=n.section("nfsHostsSettings").title(i("addDatastoreWizard.nfsReadyToCompletePage.hostsTitle")),c=s.propertyBuilder();c.keyBuilder().text(i("addDatastoreWizard.nfsReadyToCompletePage.hosts")).exit(),O().forEach(function(e){c.valueBuilder().text(e.formattedName).icon("vsphere-icon-host")})}return r.build()}function T(){var t=k();return t===n.kerberosSecurityTypes.AUTH_SYS?e.getString("StorageUi","addDatastoreWizard.nfsReadyToCompletePage.kerbDisabled"):t===n.kerberosSecurityTypes.SEC_KRB5?e.getString("StorageUi","datastore.manage.connectivity.hostList.kerberosAuthentication.enabledKrb5"):t===n.kerberosSecurityTypes.SEC_KRB5I?e.getString("StorageUi","datastore.manage.connectivity.hostList.kerberosAuthentication.enabledKrb5i"):void 0}function E(){return z.nfsVersion?z.nfsVersion:n.nfsVersions.NFS_3}function V(){return E()===n.nfsVersions.NFS_4_1}function M(e){z.nfsVersion=e}function O(){return z.selectedHosts}function A(e){z.selectedHosts=e}function k(){return z.kerbereosAuthentication}function R(e){z.kerbereosAuthentication=e}function N(e){z.accessMode=e}function U(){return z.accessMode||n.accessModes.readWrite}function L(){return E()===n.nfsVersions.NFS_4_1?e.getString("StorageUi","datastore.nfs.nfs41"):e.getString("StorageUi","datastore.nfs.nfs")}function F(){return E()===n.nfsVersions.NFS_4_1?m().join(", "):p()}function x(){var e=[];if(l.isHostContextObject()){var t=i.getManagedObjectReference(l.getContextObject());e.push($(t))}else O().forEach(function(t){e.push($(t.hostRef))});return e.length>0&&(r.addMulti("com.vmware.vsphere.client.storage.NfsDatastoreCreateSpec",e),!0)}function $(e){var t={_type:"com.vmware.vsphere.client.storage.NfsDatastoreCreateSpec",host:e,storageFolder:l.getStorageFolder(),nfsDatastoreCreateSpec:{_type:"com.vmware.vim.binding.vim.host.NasVolume$Specification",type:E().toUpperCase(),remoteHost:p(),remotePath:d(),localPath:l.getDatastoreName(),accessMode:U()}};if(E()===n.nfsVersions.NFS_4_1){var i=m();t.nfsDatastoreCreateSpec.remoteHostNames=i,t.nfsDatastoreCreateSpec.remoteHost=i[i.length-1],t.nfsDatastoreCreateSpec.securityType=k()}return t}var z={},H={existingDsHostsPromise:null,existingDsId:null},B={getNfsVersion:E,setNfsVersion:M,isNfsVersion41:V,getFolderName:d,setFolderName:u,getServerName:p,setSelectedAccessMode:N,getSelectedAccessMode:U,getServerNamesArray:m,setServerNamesArray:v,hasIpV6Servers:g,splitServerNames:h,validateServerNames:S,addServerNamesAction:f,setServerName:C,getExistingDatastoreId:D,setExistingDatastoreId:w,requestExistingDatastoreHosts:b,getSelectedHosts:O,setSelectedHosts:A,getKerberosAuthenticationType:k,setKerberosAuthenticationType:R,getReadyToCompletePageData:I,submit:x};return B}}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("VmfsWizardManager",["i18nService","defaultUriSchemeUtil","dataService","$q","bytesFilter","storageUtil","datastoreConstants","mutationService","wizardPageService","vxPropertyViewService",function(e,t,i,r,n,o,a,s,c,l){return function(d){function u(){return Z.isVmfs6Supported}function p(e){Z.isVmfs6Supported=e}function v(){return Z.selectedDiskInfo}function m(e){x(e,Z.selectedDiskInfo)||(Z.selectedDiskInfo=e,b(null),C(null),$())}function g(){return d.isHostContextObject()?d.getContextObject():Z.selectedHostId}function h(e){Z.selectedHostId=e}function f(){return Z.datastoreSizeInGB}function S(e){Z.datastoreSizeInGB=e}function y(){var e=I(),t=0;e&&(t=e.maxDatastoreSize);var i=Z.datastoreSizeInGB*a.BYTES_TO_GB;return i>t&&(i=t),t-i<a.vmfsSize.DATASTORE_SIZE_STEP_IN_BYTES&&(i=t),i}function P(){return Z.selectedMountOption}function C(e){Z.selectedMountOption!==e&&(Z.selectedMountOption=e,H())}function D(){return Z.selectedVmfsVersion}function w(e){Z.selectedVmfsVersion=e}function b(e){Z.selectedVmfsDatastoreOptionItem=e}function I(){return Z.selectedVmfsDatastoreOptionItem}function T(){return Z.selectedVmfsBlockSizeOptions}function E(e){Z.selectedVmfsBlockSizeOptions=e}function V(){var e=g();return J.hostRefForDiskInfos===e&&J.diskInfos?r.when(J.diskInfos):i.getProperties(e,[G]).then(function(t){var i=t?t[G]||[]:[];return J.hostRefForDiskInfos=e,J.diskInfos=i,i})}function M(){var e=v().disk.devicePath,t=D();return J.devicePathForDatastoreOptions===e&&J.vmfsMajorVersionForDatastoreOptions===t&&J.vmfsDatastoreOptionItems?r.when({optionItems:J.vmfsDatastoreOptionItems,diskPartitionInfo:J.diskPartitionInfo,blockSizeOptions:J.blockSizeOptions,reclamationPriority:J.reclamationPriority}):i.getProperties(g(),[j],{propertyParams:[{propertyName:j,parameterType:"com.vmware.vsphere.client.h5.storage.spec.VmfsDatastoreCreateOptionQuerySpec",parameter:{_type:"com.vmware.vsphere.client.h5.storage.spec.VmfsDatastoreCreateOptionQuerySpec",devicePath:e,vmfsMajorVersion:t}}]}).then(function(i){var r=i?i[j]||{}:{},n=r.optionItems||[],o=r.partitionInfo||{},a=r.blockSizeOptions,s={unmapPriority:W};return J.vmfsDatastoreOptionItems=n,J.diskPartitionInfo=o,J.vmfsMajorVersionForDatastoreOptions=t,J.devicePathForDatastoreOptions=e,J.blockSizeOptions=a,J.reclamationPriority=s,{optionItems:n,diskPartitionInfo:o,blockSizeOptions:a,reclamationPriority:s}})}function O(t){B(e.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.title"),t)}function A(e){var t=e.isVMFS6Supported;O(!t);var i=t?a.vmfsVersions.VMFS_6:a.vmfsVersions.VMFS_5;w(i)}function k(){return z()?P()===Y.ASSIGN_NEW_SIGNATURE?U():L():N()}function R(){function e(e){e.property(K("addDatastoreWizard.vmfsReadyToCompletePage.type"),K("addDatastoreWizard.vmfsReadyToCompletePage.typeVmfs"))}function t(e){e.property(K("addDatastoreWizard.vmfsReadyToCompletePage.diskLun"),o.formatDeviceName(v().disk))}function i(e){var t=T();e.property(K("addDatastoreWizard.vmfsReadyToCompletePage.blockSize"),t.blockSize.formattedValue),e.property(K("addDatastoreWizard.vmfsReadyToCompletePage.spaceReclamationGranularity"),t.granularity.formattedValue);var i=t.reclamationPriority.unmapPriority,r=K("informationNotAccessible");if(i===a.reclamationPriority.NONE)r=K("addDatastoreWizard.vmfsReadyToCompletePage.spaceReclamationPriorityNoneDescription");else if(i===a.reclamationPriority.LOW){var n=K("vmfs.unmapPriority.low");r=K("addDatastoreWizard.vmfsReadyToCompletePage.spaceReclamationPriorityDescription",n,n.toLowerCase())}e.property(K("addDatastoreWizard.vmfsReadyToCompletePage.spaceReclamationPriority"),r)}var r=l.createPropertyViewBuilder(),s=r.category("category");if(z()){var c=s.section("headless");e(c),t(c),c.property(K("addDatastoreWizard.vmfsReadyToCompletePage.mountOption"),K(P()===Y.ASSIGN_NEW_SIGNATURE?"vmfsMountOptions.newSignature":"vmfsMountOptions.keepSignature"))}else{var u=s.section("general").title(K("addDatastoreWizard.vmfsReadyToCompletePage.general"));u.property(K("addDatastoreWizard.vmfsReadyToCompletePage.name"),d.getDatastoreName()),e(u),u.property(K("addDatastoreWizard.vmfsReadyToCompletePage.size"),n(y(),"B","Auto",2));var p=s.section("deviceAndFormatting").title(K("addDatastoreWizard.vmfsReadyToCompletePage.deviceAndFormatting"));t(p),p.property(K("addDatastoreWizard.vmfsReadyToCompletePage.partitionFormat"),o.formatDiskPartitionType(F())),p.property(K("addDatastoreWizard.vmfsReadyToCompletePage.vmfsVersion"),K("vmfsDatastore.version.format",D())),D()===a.vmfsVersions.VMFS_6&&i(p)}return r.build()}function N(){var e=I(),i=e.vmfsDatastoreOption,r=i.spec;if(r.vmfs.volumeName=d.getDatastoreName(),D()===a.vmfsVersions.VMFS_6){var n=T();r.vmfs.blockSize=n.blockSize.value,r.vmfs.unmapGranularity=n.granularity.value,r.vmfs.unmapPriority=n.reclamationPriority.unmapPriority}var o={_type:"com.vmware.vsphere.client.storage.VmfsDatastoreCreateSpec",host:t.getManagedObjectReference(g()),storageFolder:d.getStorageFolder(),vmfsDatastoreCreateSpec:r,datastoreSize:y(),disk:v(),createOption:i};return s.add("com.vmware.vsphere.client.storage.VmfsDatastoreCreateSpec",o),!0}function U(){var e={_type:"com.vmware.vim.binding.vim.host.UnresolvedVmfsResignatureSpec",extentDevicePath:[v().unresolvedExtent.devicePath]},i={_type:"com.vmware.vsphere.client.storage.VmfsDatastoreResignatureSpec",host:t.getManagedObjectReference(g()),storageFolder:d.getStorageFolder(),vmfsDatastoreResignatureSpec:e};return s.add("com.vmware.vsphere.client.storage.VmfsDatastoreResignatureSpec",i),!0}function L(){var e={_type:"com.vmware.vim.binding.vim.host.UnresolvedVmfsResolutionSpec",extentDevicePath:[v().unresolvedExtent.devicePath],uuidResolution:"forceMount"},i={_type:"com.vmware.vsphere.client.storage.VmfsForceMountSpec",host:t.getManagedObjectReference(g()),storageFolder:d.getStorageFolder(),vmfsDatastoreForceMountSpec:e};return s.add("com.vmware.vsphere.client.storage.VmfsForceMountSpec",i),!0}function F(){return I()?I().vmfsDatastoreOption.spec.partition.partitionFormat:null}function x(e,t){return e===t||(!e&&!t||!(!e||!t)&&e.disk.devicePath===t.disk.devicePath)}function $(){var e=v(),t=e&&e.vmfsLabel;B(X,!t)}function z(){var e=P();return e===Y.ASSIGN_NEW_SIGNATURE||e===Y.KEEP_SIGNATURE}function H(){var e=z();B(Q,e)}function B(e,t){var i=d.getWizardConfig().flows,r=_.find(i,function(e){return e.id===d.getDatastoreType()}),n=r.pages;t?c.markPageSkipped(n,e,t):c.markPageDisabled(n,e,t),c.invalidateNextPages(d.getWizardConfig(),d.getDatastoreType(),e)}var G="availableDisksForVmfs",j="datastore:vmfsDatastoreCreateOptionsData",W=a.reclamationPriority.LOW,Y={KEEP_SIGNATURE:"keepSignature",ASSIGN_NEW_SIGNATURE:"assignNewSignature",FORMAT_DISK:"formatDisk"},q=[{title:e.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.vmfs6"),description:e.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.vmfs6Description"),value:a.vmfsVersions.VMFS_6},{title:e.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.vmfs5"),description:e.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.vmfs5Description"),value:a.vmfsVersions.VMFS_5}],K=_.partial(e.getString,"StorageUi"),X=K("addDatastoreWizard.vmfsMountOptionsPage.title"),Q=K("addDatastoreWizard.vmfsPartitionConfigPage.title"),Z={isVmfs6Supported:!0,selectedHostId:null,selectedDiskInfo:null,selectedVmfsDatastoreOptionItem:null,datastoreSizeInGB:null,selectedMountOption:null,selectedVmfsVersion:null,selectedVmfsBlockSizeOptions:null},J={hostRefForDiskInfos:null,diskInfos:null,devicePathForDatastoreOptions:null,vmfsMajorVersionForDatastoreOptions:null,vmfsDatastoreOptionItems:null,blockSizeOptions:null,reclamationPriority:null},ee={submit:k,getReadyToCompletePageData:R,mountOptions:Y,vmfsVersions:q,getSelectedHostId:g,setSelectedHostId:h,getIsVmfs6Supported:u,setIsVmfs6Supported:p,setSelectedScsiDiskInfo:m,getSelectedScsiDiskInfo:v,getDatastoreSizeInGb:f,setDatastoreSizeInGb:S,getSelectedVmfsVersion:D,setSelectedVmfsVersion:w,getSelectedMountOption:P,setSelectedMountOption:C,setSelectedVmfsDatastoreOptionItem:b,getSelectedVmfsDatastoreOptionItem:I,getSelectedVmfsBlockSizeOptions:T,setSelectedVmfsBlockSizeOptions:E,requestAvailableScsiDiskInfos:V,requestVmfsCreateOptionItems:M,updateVmfsVersionPageVisibility:A,skipVmfsVersionPage:O};return ee}}])}();var storage_ui;!function(e){var t=com.vmware.vsphere.client.storage.vvol.CreateVvolDatastoreSpec,i=com.vmware.vim.binding.vim.host.DatastoreSystem$VvolDatastoreSpec,r=function(){function e(e,t,i,r,n,o){this.commonWizardManager=e,this.i18nService=t,this.vxPropertyViewService=i,this.defaultUriSchemeUtil=r,this.mutationService=n,this.$log=o,this.availableContainers=[]}return e.prototype.getContainerInUse=function(){var e=this;return _.find(this.availableContainers,function(t){return t.info.datastoreInfo&&t.info.datastoreInfo.name===e.commonWizardManager.getDatastoreName()})},e.prototype.isNameInUse=function(){var e=this.commonWizardManager.getDatastoreName();return!!_.find(this.availableContainers,function(t){return t.info.datastoreInfo&&t.info.datastoreInfo.name===e;
})},e.prototype.getReadyToCompletePageData=function(){var e=this;if(this.container){var t=function(t){return e.i18nService.getString("StorageUi",t)},i=this.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("category"),n=r.section("general").title(t("addDatastoreWizard.vvolReadyToComplete.general"));n.property(t("addDatastoreWizard.vvolReadyToComplete.name"),this.commonWizardManager.getDatastoreName()),n.property(t("addDatastoreWizard.vvolReadyToComplete.type"),t("addDatastoreWizard.vvolReadyToComplete.typeVvol"));var o=r.section("vvolSettings").title(t("addDatastoreWizard.vvolReadyToComplete.storageContainer.details"));if(o.property(t("addDatastoreWizard.vvolReadyToComplete.storageContainer.name"),this.container.name),o.property(t("addDatastoreWizard.vvolReadyToComplete.storageContainer.uuid"),this.container.identifier),o.property(t("addDatastoreWizard.vvolReadyToComplete.storageContainer.storageArray"),this.container.storageArrays),o.property(t("addDatastoreWizard.vvolReadyToComplete.storageContainer.storageProvider"),this.container.storageProviders),!this.commonWizardManager.isHostContextObject()){var a=r.section("hostsSettings").title(t("addDatastoreWizard.vvolReadyToComplete.hostConnectivity")),s=a.propertyBuilder();s.keyBuilder().text(t("addDatastoreWizard.vvolReadyToCompletePage.hosts")).exit(),this.selectedHosts.forEach(function(e){s.valueBuilder().text(e.formattedName).icon("vsphere-icon-host")})}return i.build()}},e.prototype.submit=function(){var e=this,t=[];if(this.commonWizardManager.isHostContextObject()){var i=this.defaultUriSchemeUtil.getManagedObjectReference(this.commonWizardManager.getContextObject());t.push(this.buildVvolDatastoreCreateSpec(i))}else this.selectedHosts.forEach(function(i){t.push(e.buildVvolDatastoreCreateSpec(i.hostRef))});return t.length>0&&(this.mutationService.addMulti("com.vmware.vsphere.client.storage.vvol.CreateVvolDatastoreSpec",t),!0)},e.prototype.buildVvolDatastoreCreateSpec=function(e){if(!this.container)return void this.$log.warn("VvolWizardManager.container can't be undefined");var r=new t;r.host=e,r.storageFolder=this.commonWizardManager.getStorageFolder();var n=new i;return n.name=this.commonWizardManager.getDatastoreName(),n.scId=this.container.identifier,r.vvolDatastoreSpec=n,r},e}();e.VvolWizardManager=r,angular.module("com.vmware.vsphere.client.storage").factory("vvolWizardManagerFactory",["i18nService","vxPropertyViewService","defaultUriSchemeUtil","mutationService","$log",function(e,t,i,n,o){return{build:function(a){return new r(a,e,t,i,n,o)}}}])}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("AddDatastoreReadyToCompletePageController",["$scope","i18nService",function(e,t){var i=this;i.summaryData=e.activeWizardManager.getReadyToCompletePageData(),i.summaryTitle=t.getString("StorageUi","addDatastoreWizard.readyToComplete.summaryTitle")}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("DatastoreTypePageController",["$scope","i18nService","datastoreConstants","wizardPageService",function(e,t,i,r){function n(){s.nfsType=i.datastoreTypes.NFS3,s.nfsTypeLabel=t.getString("StorageUi","datastore.nfs.nfs")}function o(){s.nfsType=i.datastoreTypes.NFS,s.nfsTypeLabel=t.getString("StorageUi","datastore.nfs")}function a(e){var t=e.filter(function(e){return void 0!==e.isNfs4Supported&&e.isNfs4Supported===!0});return t.length>0}e.wizardConfig.loading=!0;var s=this;s.vmfsType=i.datastoreTypes.VMFS,s.vvolType=i.datastoreTypes.VVOL,s.isVvolSupported=!0,n(),e.commonWizardManager.getAvailableHosts().then(function(t){a(t)&&o(),e.commonWizardManager.isHostContextObject()&&1===t.length&&(s.isVvolSupported=t[0].isVvolSupported)})["finally"](function(){e.wizardConfig.loading=!1}),s.selectDatastoreType=e.commonWizardManager.getDatastoreType(),e.$watch("ctrl.selectDatastoreType",function(t,i){t!==i&&(e.wizardConfig.currentPage.decisionOptions.selectedFlowId=t,e.commonWizardManager.setDatastoreType(t),r.initializeFlowStates(e.wizardConfig.flows))})}])}();var storage_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.datastoreConstants=t,this.noKerberos=this.datastoreConstants.kerberosSecurityTypes.AUTH_SYS,this.authenticaionOnly=this.datastoreConstants.kerberosSecurityTypes.SEC_KRB5,this.authenticationAndIntegrity=this.datastoreConstants.kerberosSecurityTypes.SEC_KRB5I,this.i18n=this.i18nService.getString.bind(this,"StorageUi")}return e.prototype.$onInit=function(){var e=this;this.isHostContextObject=this.commonWizardManager.isHostContextObject(),this.commonWizardManager.getAvailableHosts().then(function(t){var i=t;e.isHostContextObject&&1===i.length?(e.isKrb5iOptionEnabled=i[0].isKerberos5iSupported,e.isKrbOptionEnabled=i[0].isInDomain&&i[0].areKerberosCredentialsSet):(e.isKrb5iOptionEnabled=!0,e.isKrbOptionEnabled=!0),e.selectedOption=e.selectedOption||e.noKerberos,e.onSelectionChanged(e.selectedOption),e.isKrbOption=e.isHostContextObject&&!e.isKrbOptionEnabled,e.isKrb5iOption=e.isHostContextObject&&(!e.isKrbOptionEnabled||!e.isKrb5iOptionEnabled)})},e.$inject=["i18nService","datastoreConstants"],e}();angular.module("com.vmware.vsphere.client.storage").component("nfsKerberosAuthenticationPage",{controller:t,bindings:{commonWizardManager:"<",onSelectionChanged:"<",selectedOption:"<"},templateUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/nfs/NfsKerberosAuthenticationPage.html"})}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("NfsNameAndConfigurationPageController",["$scope","datastoreConstants","vuiConstants","i18nService","$timeout",function(e,t,i,r,n){function o(){p.isReadOnly=e.nfsWizardManager.getSelectedAccessMode()===t.accessModes.readOnly,p.folderName=e.nfsWizardManager.getFolderName(),p.serverName=e.nfsWizardManager.getServerName(),a()}function a(){p.datagridOptions={height:"100%",pageConfig:{hidePager:!1},columnDefs:d(),sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,data:_.map(e.nfsWizardManager.getServerNamesArray(),c),actionBarOptions:{actions:[u()]},columnMenu:{sortable:!1,messages:{columns:r.getString("CommonUi","listview.showColumnsMenu"),filter:r.getString("CommonUi","listview.filterMenu")}}}}function s(e){e?(p.serverNameTooltipError=e,p.serverNameTooltipValidity="invalid"):(p.serverNameTooltipError="",p.serverNameTooltipValidity="valid")}function c(e){return{serverName:e}}function l(e){return e.serverName}function d(){return[{displayName:r.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.serverColumn"),field:"serverName",template:"#:serverName#"}]}function u(){return{tooltipText:r.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.server.remove"),label:r.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.server.remove"),iconClass:"vx-icon-removeIcon",enabled:!0,onClick:function(){p.datagridOptions.data=_.filter(p.datagridOptions.data,function(e){return e.serverName!==p.datagridOptions.selectedItems[0].serverName}),e.nfsWizardManager.setServerNamesArray(_.map(p.datagridOptions.data,l))}}}var p=this;p.datastoreNameMaxLength=t.maxNameLengthForNfsDatastore,p.serverNameTooltipError="",p.serverNameTooltipValidity="valid",p.isNfs4_1=function(){return e.nfsWizardManager.getNfsVersion()===t.nfsVersions.NFS_4_1},e.commonWizardManager.getDatastoreName()?p.datastoreName=e.commonWizardManager.getDatastoreName():(e.wizardConfig.loading=!0,e.commonWizardManager.getUniqueDatastoreName().then(function(t){p.datastoreName=t,e.commonWizardManager.setDatastoreName(t)})["finally"](function(){e.wizardConfig.loading=!1})),o(),n(function(){var e=$("div.nfs-servers-grid .k-grid");if(e){var t=e.data("kendoGrid");t&&t.resize()}},0),p.addServer=function(){var t=e.nfsWizardManager.validateServerNames();t||(e.nfsWizardManager.addServerNamesAction(),p.serverName="",$("input#serverField").focus(),p.datagridOptions.data=_.map(e.nfsWizardManager.getServerNamesArray(),c)),s(t)},p.addServerIfSpace=function(e){32===e.keyCode&&p.addServer()},e.$watch(function(){return p.datastoreName},function(t){e.commonWizardManager.setDatastoreName(t)}),e.$watch(function(){return p.folderName},function(t){e.nfsWizardManager.setFolderName(t)}),e.$watch(function(){return p.serverName},function(t,i){t!==i&&(e.nfsWizardManager.setServerName(t),s(null))}),e.$watch(function(){return p.datagridOptions.selectedItems},function(e){var t=e.length>0;p.datagridOptions.actionBarOptions.actions[0].enabled=t}),e.$watch(function(){return p.isReadOnly},function(i){var r=i?t.accessModes.readOnly:t.accessModes.readWrite;e.nfsWizardManager.setSelectedAccessMode(r)}),e.nfsWizardManager.isNfsVersion41()&&e.$watch(function(){return e.nfsWizardManager.getServerNamesArray().join(",")},function(t,i){t!==i&&t&&(p.datagridOptions.data=_.map(e.nfsWizardManager.getServerNamesArray(),c))})}])}();var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.datastoreConstants=r,this.defaultUriSchemeUtil=n,this.$q=o,this.onSelectionChanged=function(e){a.nfsWizardManager.setSelectedHosts(e)},this.preselectComparator=function(e){var t=a.nfsWizardManager.getSelectedHosts();return!(!t||!e)&&!!t.find(function(t){return t.formattedName===e.formattedName})},this.isHostValidForSelection=function(e){return e.isHostConnected&&e.hasConfigStoragePrivilege&&!a.hasNfs4_1SupportIssue(e)&&!a.hasIpV6SupportIssue(e)&&!a.isHostAlreadyMounted(e)&&!a.hasActiveDirectoryIssue(e)&&!a.hasAuthenticationCredentialsIssue(e)&&!a.hasKrb5iSupportIssue(e)},this.formatHostName=function(e){var t=e.formattedName;return e.isHostConnected&&(a.hasIpV6SupportIssue(e)&&(t=a.i18nService.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.hostDoesNotSupportIpv6Nfs",e.formattedName)),a.hasNfs4_1SupportIssue(e)&&(t=a.i18nService.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.nfsv41NotSupported",e.formattedName)),a.nfsWizardManager.getNfsVersion()===a.datastoreConstants.nfsVersions.NFS_4_1&&a.isKerberosEnabled()&&(a.hasKrb5iSupportIssue(e)&&(t=a.i18nService.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.krb5iNotSupported",e.formattedName)),a.hasAuthenticationCredentialsIssue(e)&&(t=a.i18nService.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.noCredentials",e.formattedName)),a.hasActiveDirectoryIssue(e)&&(t=a.i18nService.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.hostNotInDomain",e.formattedName))),a.isHostAlreadyMounted(e)&&(t=a.i18nService.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.hostAlreadyMounted",e.formattedName)),e.hasConfigStoragePrivilege||(t=a.i18nService.getString("StorageUi","addDatastoreWizard.notEnoughPrivileges",e.formattedName))),t}}return e.prototype.$onInit=function(){var e=this;this.wizardConfig.loading=!0,this.mountedHosts={};var t={availableHosts:this.commonWizardManager.getAvailableHosts(),mountedHosts:this.nfsWizardManager.requestExistingDatastoreHosts()};this.$q.all(t).then(function(t){t&&(e.mountedHosts=t.mountedHosts,e.hostsData=t.availableHosts)})["finally"](function(){e.wizardConfig.loading=!1})},e.prototype.hasNfs4_1SupportIssue=function(e){return this.nfsWizardManager.getNfsVersion()===this.datastoreConstants.nfsVersions.NFS_4_1&&!e.isNfs4Supported},e.prototype.hasIpV6SupportIssue=function(e){return this.nfsWizardManager.hasIpV6Servers()&&!e.isIpV6NfsSupported},e.prototype.hasActiveDirectoryIssue=function(e){return this.isKerberosEnabled()&&!e.isInDomain},e.prototype.hasAuthenticationCredentialsIssue=function(e){return this.isKerberosEnabled()&&!e.areKerberosCredentialsSet},e.prototype.hasKrb5iSupportIssue=function(e){var t=this.nfsWizardManager.getKerberosAuthenticationType();return t===this.datastoreConstants.kerberosSecurityTypes.SEC_KRB5I&&!e.isKerberos5iSupported},e.prototype.isHostAlreadyMounted=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef);return!!this.mountedHosts&&this.mountedHosts.hasOwnProperty(t)},e.prototype.isKerberosEnabled=function(){var e=this.nfsWizardManager.getKerberosAuthenticationType();return e===this.datastoreConstants.kerberosSecurityTypes.SEC_KRB5||e===this.datastoreConstants.kerberosSecurityTypes.SEC_KRB5I},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry","datastoreConstants","defaultUriSchemeUtil","$q"],e}();e.NfsSelectHostsPageController=t,angular.module("com.vmware.vsphere.client.storage").component("nfsSelectHostsPage",{controller:t,bindings:{wizardConfig:"<",nfsWizardManager:"<",commonWizardManager:"<"},templateUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/nfs/NfsSelectHostsPageComponent.html"})}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("NfsVersionPageController",["$scope","i18nService","datastoreConstants","wizardPageService",function(e,t,i,r){var n=this;n.nfsV3=i.nfsVersions.NFS_3,n.nfsV41=i.nfsVersions.NFS_4_1,n.selectNfsVersion=e.nfsWizardManager.getNfsVersion(),e.$watch("ctrl.selectNfsVersion",function(i,o){if(i!==o){e.nfsWizardManager.setNfsVersion(i);var a=e.wizardConfig.flows,s=_.find(a,function(t){return t.id===e.commonWizardManager.getDatastoreType()}),c=s?s.pages:[];i===n.nfsV41?r.markPageDisabled(c,t.getString("StorageUi","addDatastoreWizard.nfsKerberosPage.title")):r.markPageSkipped(c,t.getString("StorageUi","addDatastoreWizard.nfsKerberosPage.title")),r.invalidateNextPages(e.wizardConfig,e.commonWizardManager.getDatastoreType(),e.wizardConfig.currentPage.title)}})}])}();var storage_ui;!function(e){var t=function(){function e(e,t,i){var r=this;this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.onPreSelect=function(e){return!!r.preSelectComparator&&r.preSelectComparator(e)}}return e.prototype.$onInit=function(){this.initDatagridOptions()},e.prototype.initDatagridOptions=function(){var e=this,t=this;this.datagridOptions={resizable:!0,height:"100%",selectionMode:this.vuiConstants.grid.selectionMode.MULTI,selectedItems:[],pageConfig:{displayMode:this.vuiConstants.grid.displayMode.VIRTUAL_SCROLLING},columnDefs:this.getColumnDefs(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,data:this.hosts,isItemDisabledCallback:function(t){return!e.isHostValidForSelection(t)},columnMenu:{sortable:!1,messages:{columns:this.i18nService.getString("CommonUi","listview.showColumnsMenu"),filter:this.i18nService.getString("CommonUi","listview.filterMenu")}}};var i=!0;this.onSelectionChange&&(this.datagridOptions.onChange=function(){t.onSelectionChange(e.datagridOptions.selectedItems,i),i=!1})},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("StorageUi","addDatastoreWizard.selectHostsPage.hostColumnTitle"),field:"formattedName",width:"150px",template:function(t){return e.getTemplate("vsphere-icon-host",t.formattedName,t)}},{displayName:this.i18nService.getString("StorageUi","addDatastoreWizard.selectHostsPage.clusterColumnTitle"),field:"clusterName",width:"150px",template:function(t){return t.clusterName?e.renderIconText("vsphere-icon-cluster",t.clusterName,e.isHostValidForSelection(t)):""}}]},e.prototype.isHostValidForSelection=function(e){var t=e.isHostConnected;return this.isHostValidForSelectionCustom?t&&this.isHostValidForSelectionCustom(e):t},e.prototype.getTemplate=function(e,t,i){var r=t;return this.formatName&&(r=this.formatName(i)),this.renderIconText(e,r,this.isHostValidForSelection(i))},e.prototype.renderIconText=function(e,t,i){return'<div><span class="'+e+'"></span>'+this.getDisabledTextRenderer(t,i)+"</div>"},e.prototype.getDisabledTextRenderer=function(e,t){var i=this.columnRenderersRegistry.getColumnRenderer("disabled-text");return i(["text","disabled"],{text:e,disabled:!t})},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry"],e}();angular.module("com.vmware.vsphere.client.storage").component("selectHostsPageComponent",{controller:t,templateUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/SelectHostsPageComponent.html",bindings:{isHostValidForSelectionCustom:"<?",preSelectComparator:"<?",hosts:"<",onSelectionChange:"<?",formatName:"<?"}})}(storage_ui||(storage_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("VmfsMountOptionsPageController",["$scope","i18nService",function(e,t){var i=this;i.getString=_.partial(t.getString,"StorageUi"),i.mountOptions=e.vmfsWizardManager.mountOptions;var r=e.vmfsWizardManager.getSelectedScsiDiskInfo();i.isVmfsVolumeResolvable=r&&r.unresolvedExtent&&r.unresolvedExtent.isHeadExtent===!0&&r.resolveStatus&&r.resolveStatus.resolvable===!0,i.mountOptionItems=[{label:i.getString("addDatastoreWizard.vmfsMountOptionsPage.newSignature"),description:i.getString("addDatastoreWizard.vmfsMountOptionsPage.newSignatureDescription"),value:i.mountOptions.ASSIGN_NEW_SIGNATURE,isEnabled:i.isVmfsVolumeResolvable},{label:i.getString("addDatastoreWizard.vmfsMountOptionsPage.keepSignature"),description:i.getString("addDatastoreWizard.vmfsMountOptionsPage.keepSignatureDescription"),value:i.mountOptions.KEEP_SIGNATURE,isEnabled:i.isVmfsVolumeResolvable},{label:i.getString("addDatastoreWizard.vmfsMountOptionsPage.formatDisk"),description:i.getString("addDatastoreWizard.vmfsMountOptionsPage.formatDiskDescription"),value:i.mountOptions.FORMAT_DISK,isEnabled:!0}];var n=e.vmfsWizardManager.getSelectedScsiDiskInfo().volumeSignature;i.signatureInfoText=i.getString("addDatastoreWizard.vmfsMountOptionsPage.signatureInfo",n),i.selectedMountOption=null,i.isVmfsVolumeResolvable?i.selectedMountOption=e.vmfsWizardManager.getSelectedMountOption()||i.mountOptions.KEEP_SIGNATURE:i.selectedMountOption=i.mountOptions.FORMAT_DISK,e.$watch(function(){return i.selectedMountOption},function(t){e.vmfsWizardManager.setSelectedMountOption(t)})}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("VmfsNameAndDevicePageController",["$scope","i18nService","$q","datastoreConstants","wizardPageService","storageUtil",function(e,t,i,r,n,o){function a(t){t&&t.isHostConnected&&t.hasConfigStoragePrivilege&&(s.availableDiskInfos=[],e.wizardConfig.loading=!0,e.vmfsWizardManager.requestAvailableScsiDiskInfos().then(function(t){e.wizardConfig.loading=!1,s.availableDiskInfos=t},e.removeLoadingAndShowError))}var s=this;s.getString=t.getString,s.datastoreName="",s.showHostSelector=!e.commonWizardManager.isHostContextObject();var c={formattedName:s.getString("StorageUi","addDatastoreWizard.vmfsSelectDevicePage.selectHostItem"),isPlaceholderOptionItem:!0};s.selectedHost=c;var l=[];e.commonWizardManager.getDatastoreName()?s.datastoreName=e.commonWizardManager.getDatastoreName():l.push(e.commonWizardManager.getUniqueDatastoreName().then(function(t){s.datastoreName=t,e.commonWizardManager.setDatastoreName(t)})),s.showHostSelector?l.push(e.commonWizardManager.getAvailableHosts().then(function(t){var i=t.slice();i.splice(0,0,c),s.availableHosts=i,e.vmfsWizardManager.getSelectedHostId()&&(s.selectedHost=_.find(i,function(t){return t.hostId===e.vmfsWizardManager.getSelectedHostId()}),a(s.selectedHost))})):(l.push(e.vmfsWizardManager.requestAvailableScsiDiskInfos().then(function(e){s.availableDiskInfos=e})),l.push(e.commonWizardManager.getAvailableHosts().then(function(t){t&&t.length&&(e.vmfsWizardManager.updateVmfsVersionPageVisibility(t[0]),e.vmfsWizardManager.setIsVmfs6Supported(t[0].isVMFS6Supported))}))),s.selectedDiskInfo=e.vmfsWizardManager.getSelectedScsiDiskInfo(),e.wizardConfig.loading=!0,i.all(l).then(function(){e.wizardConfig.loading=!1},e.removeLoadingAndShowError),s.onSelectedDeviceChanged=function(i){e.vmfsWizardManager.getSelectedScsiDiskInfo()!==i&&(e.vmfsWizardManager.setSelectedScsiDiskInfo(i),s.selectedDiskInfo=e.vmfsWizardManager.getSelectedScsiDiskInfo(),n.clearErrors(e.wizardConfig),s.selectedDiskInfo&&o.is4kDevice(s.selectedDiskInfo.disk)?e.vmfsWizardManager.getIsVmfs6Supported()?(e.vmfsWizardManager.skipVmfsVersionPage(!0),e.vmfsWizardManager.setSelectedVmfsVersion(r.vmfsVersions.VMFS_6)):n.markPageIncompleteWithError(e.wizardConfig,t.getString("StorageUi","datastoreWizards.selectDevicePage.incompatibleSelection")):e.vmfsWizardManager.updateVmfsVersionPageVisibility({isVMFS6Supported:e.vmfsWizardManager.getIsVmfs6Supported()}))},s.getFormattedNameWithPrivilege=function(e){return!e.isHostConnected||e.hasConfigStoragePrivilege||e.isPlaceholderOptionItem?e.formattedName:t.getString("StorageUi","addDatastoreWizard.notEnoughPrivileges",e.formattedName)},e.$watch(function(){return s.datastoreName},function(t){e.commonWizardManager.setDatastoreName(t)}),e.$watch(function(){return s.selectedHost},function(t,i){t!==i&&(e.vmfsWizardManager.setSelectedScsiDiskInfo(null),e.vmfsWizardManager.updateVmfsVersionPageVisibility(t),s.availableDiskInfos=[],!t||t.isPlaceholderOptionItem?(e.vmfsWizardManager.setSelectedHostId(null),e.vmfsWizardManager.setIsVmfs6Supported(!1)):(e.vmfsWizardManager.setSelectedHostId(t.hostId),e.vmfsWizardManager.setIsVmfs6Supported(t.isVMFS6Supported),a(t)))})}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("VmfsPartitionConfigurationPageController",["$scope","i18nService","$q",function(e,t){var i=this;i.getString=t.getString,i.configurationItems=[],i.selectedConfigurationItem=e.vmfsWizardManager.getSelectedVmfsDatastoreOptionItem(),i.labels={comboBox:t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.partitionConfiguration"),slider:t.getString("StorageUi","addDatastoreWizard.vmfsPartitionConfigPage.datastoreSize"),gb:t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.gb")},i.isDataLoaded=!1,i.configurationError=null,e.wizardConfig.loading=!0,e.vmfsWizardManager.requestVmfsCreateOptionItems().then(function(r){i.configurationItems=r.optionItems,i.diskPartitionInfo=r.diskPartitionInfo,i.vmfsBlockSizeOptions=r.blockSizeOptions,i.isDataLoaded=!0,i.configurationItems.length||(i.configurationError=t.getString("StorageUi","storage.wizards.vmfsDiskError")),i.selectedConfigurationItem&&(i.selectedConfigurationItem=i.configurationItems.find(function(e){return e.id&&_.isEqual(e.id,i.selectedConfigurationItem.id)})),e.wizardConfig.loading=!1},e.removeLoadingAndShowError),i.onSelectedOptionChanged=function(t){t===e.vmfsWizardManager.getSelectedVmfsDatastoreOptionItem()&&t&&t.sizeToAdd===e.vmfsWizardManager.getDatastoreSizeInGb()||(t&&t.isSelectConfigurationOption!==!0?(e.vmfsWizardManager.setSelectedVmfsDatastoreOptionItem(t),e.vmfsWizardManager.setDatastoreSizeInGb(t.sizeToAdd)):e.vmfsWizardManager.setSelectedVmfsDatastoreOptionItem(null))}}])}();var storage_ui;!function(e){var t=function(){function e(){}return e.prototype.$onInit=function(){this.selectedOption=this.selectedOption||this.options[0].value,this.onSelectionChanged(this.selectedOption)},e}();angular.module("com.vmware.vsphere.client.storage").component("vmfsVersionWizardPage",{templateUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vmfs/VmfsVersionPageComponent.html",bindings:{options:"<",selectedOption:"<",onSelectionChanged:"<"},controller:t})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=com.vmware.vsphere.client.h5.storage.data.datastore.StorageContainerInfoItem,i=function(){function e(e,i,r,n,o){var a=this;this.i18nService=e,this.vuiConstants=i,this.dataService=r,this.columnRenderersRegistry=n,this.vxPropertyViewService=o,this.NO_SELECTION_DETAILS=new t,this.STORAGE_CONTAINERS_INFO="datastore:filteredStorageContainerInfos",this.preselectComparator=function(e){return!(a.datagridOptions.selectedItems.length||!a.datagridOptions.data)&&(a.vvolWizardManager.container?a.vvolWizardManager.container.identifier===e.identifier:a.datagridOptions.data[0].identifier===e.identifier)}}return e.prototype.$onInit=function(){var e=this;this.commonWizardManager.getDatastoreName()?this.datastoreName=this.commonWizardManager.getDatastoreName():this.commonWizardManager.getUniqueDatastoreName().then(function(t){e.datastoreName=t,e.onDatastoreNameChange()}),this.initDatagridOptions(),this.dataService.getProperties(this.commonWizardManager.getContextObject(),[this.STORAGE_CONTAINERS_INFO]).then(function(t){e.datagridOptions.data=t[e.STORAGE_CONTAINERS_INFO],e.vvolWizardManager.availableContainers=e.datagridOptions.data})},e.prototype.onDatastoreNameChange=function(){this.commonWizardManager.setDatastoreName(this.datastoreName)},e.prototype.initDatagridOptions=function(){var e=this,t=!0;this.datagridOptions={height:"100%",columnDefs:this.getColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!0,onChange:function(){if(t)return void(t=!1);if(e.datagridOptions.selectedItems.length&&e.datagridOptions.selectedItems[0]){var i=e.datagridOptions.selectedItems[0];e.populateDetailsView(i),e.vvolWizardManager.container=i}else e.populateDetailsView(e.NO_SELECTION_DETAILS),e.vvolWizardManager.container=null}}},e.prototype.populateDetailsView=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("category");i.section("general").property(this.i18nService.getString("StorageUi","datastore.manage.general.backing.storageArray"),e.storageArrays||this.i18nService.getString("StorageUi","informationNotAccessible")).property(this.i18nService.getString("StorageUi","datastore.manage.general.backing.storageProvider"),e.storageProviders||this.i18nService.getString("StorageUi","informationNotAccessible")),this.detailsViewConfig=t.build()},e.prototype.deviceRenderer=function(){var e=this;return function(t){if(t.existingDatastoreName===e.i18nService.getString("StorageUi","informationNotAccessible"))return e.columnRenderersRegistry.getColumnRenderer("text")(["existingDatastoreName"],t);var i=e.columnRenderersRegistry.getColumnRenderer("icon-text-ex"),r={icon:["vsphere-icon-datastore"]};return i(["existingDatastoreName"],t,r)}},e.prototype.getColumnDefinitions=function(){return[{displayName:this.i18nService.getString("StorageUi","storageContainerList.columns.name"),field:"name",width:"200px",template:function(e){return e.name}},{displayName:this.i18nService.getString("StorageUi","storageContainerList.columns.identifier"),field:"identifier",template:function(e){return e.identifier}},{displayName:this.i18nService.getString("StorageUi","storageContainerList.columns.maxDiskSize"),field:"capacity",width:"80px",sortable:!1,template:function(e){return e.capacity}},{displayName:this.i18nService.getString("StorageUi","storageContainerList.columns.datastore"),field:"dsColumn",sortable:function(e,t){return e.existingDatastoreName>t.existingDatastoreName},template:this.deviceRenderer()}]},e.$inject=["i18nService","vuiConstants","dataService","columnRenderersRegistry","vxPropertyViewService"],e}();angular.module("com.vmware.vsphere.client.storage").component("vvolNameAndContainerSelectionPage",{controller:i,bindings:{commonWizardManager:"<",vvolWizardManager:"<"},templateUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vvol/VvolNameAndContainerSelectionComponent.html"})}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){var i=this;this.i18nService=e,this.defaultUriSchemeUtil=t,this.onSelectionChanged=function(e,t){t||(i.vvolWizardManager.selectedHosts=e)},this.preSelectComparator=function(e){var t=i.vvolWizardManager.selectedHosts;return!(!t||!t.length)&&!!_.find(t,function(t){return e.hostId===t.hostId})}}return e.prototype.$onInit=function(){var e=this;this.commonWizardManager.getAvailableHosts().then(function(t){e.hostsData=e.updateAvailableHosts(t)})},e.prototype.updateAvailableHosts=function(e){var t=this;if(!this.vvolWizardManager.container)return[];var i=this.vvolWizardManager.container;return i.info.hosts?_.filter(e,function(e){return!_.find(i.info.hosts,function(i){var r=t.defaultUriSchemeUtil.getVsphereObjectId(i);return r===e.hostId})}):e},e.prototype.formatHostName=function(e){var t=e.formattedName;return e.isHostConnected&&(e.isVvolSupported||(t=this.i18nService.getString("StorageUi","addDatastoreWizard.vvolSelectHostsPage.vvolNotSupported",t)),e.hasConfigStoragePrivilege||(t=this.i18nService.getString("StorageUi","addDatastoreWizard.notEnoughPrivileges",t))),t},e.prototype.isHostSupported=function(e){return!(!e.isVvolSupported||!e.hasConfigStoragePrivilege)},e.$inject=["i18nService","defaultUriSchemeUtil"],e}();e.VvolSelectHostsPageComponentController=t,angular.module("com.vmware.vsphere.client.storage").component("vvolSelectHostPageComponent",{controller:t,bindings:{commonWizardManager:"<",vvolWizardManager:"<"},templateUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vvol/VvolSelectHostsPageComponent.html"})}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i){var r="datastore:datastoreInfoByDatastoreName",n="datastore:validateNfsNameAndConfiguration";return{validate:function(n,o,a,s){return o?o.length>a?i.when(t.getString("StorageUi","addDatastoreWizard.nameValidator.nameTooLong",a)):e.getProperties(n,[r],{propertyParams:[{propertyName:r,parameterType:"java.lang.String",parameter:o}]}).then(function(e){var i=e?e[r]||[]:[],n=_.find(i,function(e){return o===e.name});return n?s?s(n):t.getString("StorageUi","addDatastoreWizard.nameValidator.default.duplicateName"):null}):i.when(t.getString("StorageUi","addDatastoreWizard.nameValidator.noDatastoreName"))},validateNfsNameAndConfiguration:function(t,i,r,o,a){return e.getProperties(t,[n],{propertyParams:[{propertyName:n,parameterType:"com.vmware.vsphere.client.h5.storage.spec.NfsDatastoreConfigurationSpec",parameter:{_type:"com.vmware.vsphere.client.h5.storage.spec.NfsDatastoreConfigurationSpec",datastoreName:i,folderName:r,serverNames:o,type:a}}]}).then(function(e){return e[n]||""})}}}angular.module("com.vmware.vsphere.client.storage").service("addDatastoreNameValidatorService",e),e.$inject=["dataService","i18nService","$q"]}(),function(){"use strict";function e(e,t){return{build:function(i){return{title:e.getString("CommonUi","SummaryPage.title"),description:e.getString("CommonUi","SummaryPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/AddDatastoreReadyToCompletePage.html",state:void 0,onCommit:function(){return i.wizardConfig.currentPage.state=t.wizard.pageState.COMPLETED,i.activeWizardManager.submit()}}}}}angular.module("com.vmware.vsphere.client.storage").service("addDatastoreReadyToCompletePageService",e),e.$inject=["i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r,n){return{build:function(o,a){return{title:e.getString("StorageUi","addDatastoreWizard.datastoreTypePage.title"),description:e.getString("StorageUi","addDatastoreWizard.datastoreTypePage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/DatastoreTypePage.html",decisionOptions:{flowIds:a,selectedFlowId:i.datastoreTypes.VMFS},defaultState:t.wizard.pageState.SKIPPED,onCommit:function(){var e=o.commonWizardManager.getDatastoreType();switch(e){case i.datastoreTypes.VMFS:o.activeWizardManager=o.vmfsWizardManager;break;case i.datastoreTypes.NFS:case i.datastoreTypes.NFS3:o.activeWizardManager=o.nfsWizardManager;break;case i.datastoreTypes.VVOL:o.activeWizardManager=o.vvolWizardManager;break;default:n.warn("No activeWizardManager was found for "+e)}return r.markPageComplete(o.wizardConfig,e),!0}}}}}angular.module("com.vmware.vsphere.client.storage").service("datastoreTypePageService",e),e.$inject=["i18nService","vuiConstants","datastoreConstants","wizardPageService","$log"]}();var storage_ui;!function(e){var t=function(){function e(e,t,i){this.wizardPageService=e,this.i18nService=t,this.vuiConstants=i}return e.prototype.validate=function(e){return this.wizardPageService.markPageComplete(e.wizardConfig,e.commonWizardManager.getDatastoreType()),
!0},e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("StorageUi","addDatastoreWizard.nfsKerberosPage.title"),description:this.i18nService.getString("StorageUi","addDatastoreWizard.nfsKerberosPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/nfs/NfsKerberousAuthenticationComponentPage.html",defaultState:this.vuiConstants.wizard.pageState.SKIPPED,onCommit:function(){return t.validate(e)}}},e.$inject=["wizardPageService","i18nService","vuiConstants"],e}();e.NfsKerberosAuthenticationPageService=t,angular.module("com.vmware.vsphere.client.storage").service("nfsKerberosAuthenticationPageService",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n){function o(t){var i=[];t.nfsWizardManager.setExistingDatastoreId(null),t.commonWizardManager.getDatastoreName()||i.push(e.getString("StorageUi","addDatastoreWizard.nameValidator.noDatastoreName")),t.nfsWizardManager.getFolderName()||i.push(e.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.folderNameEmpty"));var n=t.nfsWizardManager.validateServerNames();return n&&i.push(n),i.length?r.when(i):a(t)}function a(e){e.nfsWizardManager.isNfsVersion41()&&(e.nfsWizardManager.addServerNamesAction(),e.nfsWizardManager.setServerName(""));var t=i.validateNfsNameAndConfiguration(e.commonWizardManager.getContextObject(),e.commonWizardManager.getDatastoreName(),e.nfsWizardManager.getFolderName(),e.nfsWizardManager.isNfsVersion41()?e.nfsWizardManager.getServerNamesArray():[e.nfsWizardManager.getServerName()],e.nfsWizardManager.getNfsVersion());return t.then(function(t){return t&&t.validationError?[t.validationError]:(t&&t.existingDatastore&&e.nfsWizardManager.setExistingDatastoreId(n.getVsphereObjectId(t.existingDatastore)),[])})}return{build:function(i){return{title:e.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.title"),description:e.getString("StorageUi","addDatastoreWizard.nfsSettingsPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/nfs/NfsNameAndConfigurationPage.html",state:void 0,onCommit:function(){return o(i).then(function(e){return e&&e.length>0?(t.markPageIncompleteWithErrors(i.wizardConfig,e),!1):(i.wizardConfig.validationBanner.messages=[],t.markPageComplete(i.wizardConfig,i.commonWizardManager.getDatastoreType()),!0)})}}}}}angular.module("com.vmware.vsphere.client.storage").service("nfsNameAndConfigurationPageService",e),e.$inject=["i18nService","wizardPageService","addDatastoreNameValidatorService","$q","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t){return{build:function(i){return{title:e.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.title"),description:e.getString("StorageUi","addDatastoreWizard.nfsSelectHostsPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/nfs/NfsSelectHostsPage.html",state:void 0,onCommit:function(){var r=i.nfsWizardManager.getSelectedHosts();return r&&0!==r.length?(i.wizardConfig.validationBanner.messages=[],t.markPageComplete(i.wizardConfig,i.commonWizardManager.getDatastoreType()),!0):(t.markPageIncompleteWithErrors(i.wizardConfig,[e.getString("StorageUi","addDatastoreWizard.selectHostsPage.noSelection")]),!1)}}}}}angular.module("com.vmware.vsphere.client.storage").service("nfsSelectHostsPageService",e),e.$inject=["i18nService","wizardPageService"]}(),function(){"use strict";function e(e,t){return{build:function(i){return{title:e.getString("StorageUi","addDatastoreWizard.nfsVersionPage.title"),description:e.getString("StorageUi","addDatastoreWizard.nfsVersionPage.nfsVersionLabel"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/nfs/NfsVersionPage.html",state:void 0,onCommit:function(){return t.markPageComplete(i.wizardConfig,i.commonWizardManager.getDatastoreType()),!0}}}}}angular.module("com.vmware.vsphere.client.storage").service("nfsVersionPageService",e),e.$inject=["i18nService","wizardPageService"]}(),function(){"use strict";function e(e,t,i){return{build:function(r){return{title:e.getString("StorageUi","addDatastoreWizard.vmfsMountOptionsPage.title"),description:e.getString("StorageUi","addDatastoreWizard.vmfsMountOptionsPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vmfs/VmfsMountOptionsPage.html",defaultState:i.wizard.pageState.SKIPPED,onCommit:function(){return t.markPageComplete(r.wizardConfig,r.commonWizardManager.getDatastoreType()),!0}}}}}angular.module("com.vmware.vsphere.client.storage").service("vmfsMountOptionsPageService",e),e.$inject=["i18nService","wizardPageService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(a){var s=a.vmfsWizardManager.getSelectedScsiDiskInfo();return s?o.is4kDevice(s.disk)&&!a.vmfsWizardManager.getIsVmfs6Supported()?(t.markPageIncompleteWithError(a.wizardConfig,e.getString("StorageUi","datastoreWizards.selectDevicePage.incompatibleSelection")),n.when(!1)):i.validate(a.commonWizardManager.getContextObject(),a.commonWizardManager.getDatastoreName(),r.maxNameLengthForNonNfsDatastore).then(function(e){return e?(t.markPageIncompleteWithError(a.wizardConfig,e),!1):(a.wizardConfig.validationBanner.messages=[],t.markPageComplete(a.wizardConfig,a.commonWizardManager.getDatastoreType()),!0)}):(t.markPageIncompleteWithError(a.wizardConfig,e.getString("StorageUi","datastoreWizards.selectDevicePage.noSelection")),n.when(!1))}return{build:function(t){return{title:e.getString("StorageUi","addDatastoreWizard.vmfsSelectDevicePage.title"),description:e.getString("StorageUi","addDatastoreWizard.vmfsSelectDevicePage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vmfs/VmfsNameAndDevicePage.html",state:void 0,onCommit:function(){return t.wizardConfig.loading=!0,a(t).then(function(e){return t.wizardConfig.loading=!1,e},function(e){return t.removeLoadingAndShowError(e),!1})}}}}}angular.module("com.vmware.vsphere.client.storage").service("vmfsNameAndDevicePageService",e),e.$inject=["i18nService","wizardPageService","addDatastoreNameValidatorService","datastoreConstants","$q","storageUtil"]}(),function(){"use strict";function e(e,t,i,r){function n(n){if(!n.vmfsWizardManager.getSelectedVmfsDatastoreOptionItem())return t.markPageIncompleteWithError(n.wizardConfig,e.getString("StorageUi","addDatastoreWizard.vmfsPartitionConfigPage.noSelection")),!1;var o=n.vmfsWizardManager.getDatastoreSizeInGb(),a=i.vmfsSize.MIN_DATASTORE_SIZE_GB;return n.vmfsWizardManager.getSelectedVmfsVersion()>=i.vmfsVersions.VMFS_6&&(a=i.vmfsSize.MIN_DATASTORE_V6_SIZE_GB),o<a?(t.markPageIncompleteWithError(n.wizardConfig,e.getString("StorageUi","addDatastoreWizard.vmfsPartitionConfigPage.invalidSizeError",r(a,"GB","GB",2))),!1):(n.wizardConfig.validationBanner.messages=[],t.markPageComplete(n.wizardConfig,n.commonWizardManager.getDatastoreType()),!0)}return{build:function(t){return{title:e.getString("StorageUi","addDatastoreWizard.vmfsPartitionConfigPage.title"),description:e.getString("StorageUi","addDatastoreWizard.vmfsPartitionConfigPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vmfs/VmfsPartitionConfigurationPage.html",state:void 0,onCommit:function(){return n(t)}}}}}angular.module("com.vmware.vsphere.client.storage").service("vmfsPartitionConfigurationPageService",e),e.$inject=["i18nService","wizardPageService","datastoreConstants","bytesFilter"]}();var storage_ui;!function(e){var t=function(){function e(e,t){this.wizardPageService=e,this.i18nService=t}return e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.title"),description:this.i18nService.getString("StorageUi","addDatastoreWizard.vmfsSelectVersionPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vmfs/VmfsVersionPage.html",state:void 0,onCommit:function(){return t.wizardPageService.markPageComplete(e.wizardConfig,e.commonWizardManager.getDatastoreType()),!0}}},e.$inject=["wizardPageService","i18nService"],e}();e.VmfsVersionPageService=t,angular.module("com.vmware.vsphere.client.storage").service("vmfsVersionPageService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.wizardPageService=e,this.i18nService=t,this.addDatastoreNameValidatorService=i,this.datastoreConstants=r,this.$q=n,this.vvolDatastoreNameAndContainerValidation=function(e,t){if(!e.container)return null;var i=e.isNameInUse(),r=e.getContainerInUse();return!i&&e.container.info.datastoreInfo?o.i18nService.getString("StorageUi","addDatastoreWizard.nameValidator.vvol.differentNameSameContainer",e.container.info.datastoreInfo.name):!i||!r||e.container.info.datastoreInfo&&e.container.info.datastoreInfo.name===t?null:o.i18nService.getString("StorageUi","addDatastoreWizard.nameValidator.vvol.duplicateNameDifferentContainer",r.name)}}return e.prototype.validate=function(e){var t=this,i=!!e.vvolWizardManager.container,r=this.vvolDatastoreNameAndContainerValidation(e.vvolWizardManager,e.commonWizardManager.getDatastoreName()),n=i&&!r;if(!n){var o=r||this.i18nService.getString("StorageUi","addDatastoreWizard.vvolNameAndContainerPage.noSelection");return this.invalidateWizard(e,o),this.$q.when(!1)}var a=this,s=function(t){return"com.vmware.vim.binding.vim.host.VvolDatastoreInfo"!==t._type?a.i18nService.getString("StorageUi","addDatastoreWizard.nameValidator.default.duplicateNameDifferentType"):e.vvolWizardManager.isNameInUse()?null:a.i18nService.getString("StorageUi","addDatastoreWizard.nameValidator.default.duplicateName")};return this.addDatastoreNameValidatorService.validate(e.commonWizardManager.getContextObject(),e.commonWizardManager.getDatastoreName(),this.datastoreConstants.maxNameLengthForNonNfsDatastore,s).then(function(i){return i?(t.invalidateWizard(e,i),!1):(e.wizardConfig.validationBanner.messages=[],t.wizardPageService.markPageComplete(e.wizardConfig,e.commonWizardManager.getDatastoreType()),!0)})},e.prototype.invalidateWizard=function(e,t){this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,t),this.wizardPageService.invalidateNextPages(e.wizardConfig,e.commonWizardManager.getDatastoreType(),e.wizardConfig.currentPage.title)},e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("StorageUi","addDatastoreWizard.vvolNameAndContainerPage.title"),description:this.i18nService.getString("StorageUi","addDatastoreWizard.vvolNameAndContainerPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vvol/VvolNameAndContainerSelectionPage.html",state:void 0,onCommit:function(){return e.wizardConfig.loading=!0,t.validate(e).then(function(t){return e.wizardConfig.loading=!1,t},function(t){return e.removeLoadingAndShowError(t),!1})}}},e.$inject=["wizardPageService","i18nService","addDatastoreNameValidatorService","datastoreConstants","$q"],e}();e.VvolNameAndContainerSelectionPageService=t,angular.module("com.vmware.vsphere.client.storage").service("vvolNameAndContainerSelectionPageService",t)}(storage_ui||(storage_ui={}));var storage_ui;!function(e){var t=function(){function e(e,t){this.wizardPageService=e,this.i18nService=t}return e.prototype.validate=function(e){var t=!(!e.vvolWizardManager.selectedHosts||!e.vvolWizardManager.selectedHosts.length);return t?this.wizardPageService.markPageComplete(e.wizardConfig,e.commonWizardManager.getDatastoreType()):(this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,this.i18nService.getString("StorageUi","addDatastoreWizard.selectHostsPage.noSelection")),this.wizardPageService.invalidateNextPages(e.wizardConfig,e.commonWizardManager.getDatastoreType(),e.wizardConfig.currentPage.title)),t},e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("StorageUi","addDatastoreWizard.vvolSelectHostsPage.title"),description:this.i18nService.getString("StorageUi","addDatastoreWizard.vvolSelectHostsPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/createDatastore/pages/vvol/VvolSelectHostsPage.html",state:void 0,onCommit:function(){return t.validate(e)}}},e.$inject=["wizardPageService","i18nService"],e}();e.VvolSelectHostsPageService=t,angular.module("com.vmware.vsphere.client.storage").service("vvolSelectHostsPageService",t)}(storage_ui||(storage_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a,s){return{showWizard:function(c){var l=i.$new();l.manager=new s,l.manager.setDatastoreRef(c);var d=[n.build(l),o.build(l),a.build(l)];l.wizardConfig={pages:r.initializePageStates(d),title:t.getString("StorageUi","increaseDatastoreWizard.title"),iconClass:"storage-ui-icon-increase_datastore"},e({scope:l,configObjectName:"wizardConfig"}).show()}}}angular.module("com.vmware.vsphere.client.storage").service("increaseDatastoreCapacityWizardService",e),e.$inject=["vuiWizardService","i18nService","$rootScope","wizardPageService","selectDevicePageService","specifyConfigurationPageService","readyToCompletePageService","IncreaseDatastoreCapacityWizardManager"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").factory("IncreaseDatastoreCapacityWizardManager",["i18nService","dataService","bytesFilter","hostStorageService","storageUtil","$q",function(e,t,i,r,n,o){return function(){function o(){return t.getProperties(w.datastoreRef,[D]).then(function(e){return w=_.extend(w,{datastoreInfo:e[D]}),!0})}function a(){var t=w.selectedOption.vmfsDatastoreOption;return{datastoreName:w.datastoreInfo.datastoreName,capacityIncrease:S(w.selectedOption),futureSize:C(w.datastoreInfo,w.selectedOption.sizeToAdd),formattedDeviceName:n.formatDeviceName(w.selectedDevice.disk),partitionFormat:n.formatDiskPartitionType(t.spec.partition.partitionFormat),maximumFileSize:i(w.datastoreInfo.maxFileSizeInB,"B","Auto",2),vmfsVersion:w.datastoreInfo.vmfs.version,blockSize:e.getString("StorageUi","vmfsDatastore.blockSize.format",w.datastoreInfo.vmfs.blockSizeMb)}}function s(e){w.datastoreRef=e}function c(){return w.datastoreInfo}function l(){return w.datastoreRef}function d(){return r.retrieveDatastoreStorageDevices(w.datastoreRef).then(function(e){w.connectedHost=e.connectedHost,w.devices=e.scsiDiskInfos})}function u(){return w.devices}function p(){return w.selectedDevice}function v(e){w.selectedDevice=e}function m(){return{_type:"com.vmware.vsphere.client.storage.DatastoreIncreaseSpec",host:w.connectedHost,disk:w.selectedDevice,sizeToAdd:w.selectedOption.sizeToAdd*Math.pow(1024,3),increaseOption:w.selectedOption.vmfsDatastoreOption}}function g(){return r.retrieveDatastoreIncreaseOptions(w.datastoreRef,w.connectedHost,w.selectedDevice).then(function(e){w.options=w.options||{};var t=e.optionItems;return w.options[w.selectedDevice.disk.uuid]=t,w.diskPartitionInfos[w.selectedDevice.disk.uuid]=e.partitionInfo,!0})}function h(){return w.selectedDevice?w.diskPartitionInfos[w.selectedDevice.disk.uuid]:void 0}function f(){return w.selectedDevice?w.options[w.selectedDevice.disk.uuid]:void 0}function S(e){var t=e.sizeToAdd;return i(t,"GB","Auto",2)}function y(){return w.selectedOption}function P(e){w.selectedOption=e}function C(e,t){var r=e.vmfs.capacity,n=t*Math.pow(1024,3);return i(r+n,"B","Auto",2)}var D="datastore:increaseDatastoreDetailsData",w={options:{},diskPartitionInfos:{}},b={fetchVmfsDatastoreOptions:g,getReadyToCompleteModel:a,getDatastoreInfo:c,getDatastoreRef:l,getDevices:u,getOptionsForSelectedDevice:f,getDiskPartitionInfoForSelectedDevice:h,getSelectedOption:y,setSelectedOption:P,getSelectedDevice:p,loadDatastoreInfo:o,loadDevices:d,setDatastoreRef:s,setSelectedDevice:v,buildSpec:m};return b}}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("IncreaseDatastoreCapacityReadyToCompletePageController",["$scope","hostStorageService","vxPropertyViewService","i18nService",function(e,t,i,r){function n(){var t=e.manager,r=t.getReadyToCompleteModel(),n=i.createPropertyViewBuilder(),a=n.category("category");return a.section("general").title(o("increaseDatastoreWizard.readyToCompletePage.general")).property(o("increaseDatastoreWizard.readyToCompletePage.name"),r.datastoreName).property(o("increaseDatastoreWizard.readyToCompletePage.increaseSizeBy"),r.capacityIncrease).property(o("increaseDatastoreWizard.readyToCompletePage.totalSize"),r.futureSize),a.section("device").title(o("increaseDatastoreWizard.readyToCompletePage.deviceAndFormatting")).property(o("increaseDatastoreWizard.readyToCompletePage.diskLun"),r.formattedDeviceName).property(o("increaseDatastoreWizard.readyToCompletePage.partitionFormat"),r.partitionFormat).property(o("increaseDatastoreWizard.readyToCompletePage.vmfsVersion"),r.vmfsVersion).property(o("increaseDatastoreWizard.readyToCompletePage.maximumFileSize"),r.maximumFileSize).property(o("increaseDatastoreWizard.readyToCompletePage.blockSize"),r.blockSize),n.build()}function o(e,t){return r.getString("StorageUi",e,t)}var a=this;a.summaryData=n(),a.i18n=o}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("SelectDevicePageController",["$scope","i18nService","hostStorageService","wizardPageService",function(e,t,i,r){function n(e){angular.forEach(e,function(e){e.sizeToAdd=void 0})}var o=this,a=e.manager;r.showLoadingIndicator(e.wizardConfig),o.selectedDevice=a.getSelectedDevice(),o.onSelectedDeviceChanged=function(t){(!t||a.getSelectedDevice()&&t.disk.uuid!==a.getSelectedDevice().disk.uuid)&&(a.setSelectedOption(void 0),n(a.getOptionsForSelectedDevice()),r.invalidateNextPages(e.wizardConfig,null,e.wizardConfig.currentPage.title)),a.setSelectedDevice(t)},o.devices=a.getDevices(),o.devices?r.hideLoadingIndicator(e.wizardConfig):e.manager.loadDevices().then(function(){o.devices=a.getDevices()})["finally"](function(){r.hideLoadingIndicator(e.wizardConfig)})}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.storage").controller("SpecifyConfigurationPageController",["$scope","i18nService",function(e,t){this.labels={comboBox:t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.partitionConfiguration"),slider:t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.increaseSize"),gb:t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.gb")},this.selectedOption=e.manager.getSelectedOption(),this.options=e.manager.getOptionsForSelectedDevice(),this.diskPartitionInfo=e.manager.getDiskPartitionInfoForSelectedDevice(),this.dsInfo=e.manager.getDatastoreInfo(),e.manager.getSelectedDevice().expandable?this.deviceDetails=t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.expandableTip"):this.deviceDetails=t.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.nonExpandableTip"),this.onSelectedOptionChanged=function(t){t&&!t.isSelectConfigurationOption?e.manager.setSelectedOption(t):e.manager.setSelectedOption(void 0)}}])}(),function(){"use strict";function e(e,t){return{build:function(i){return{title:e.getString("StorageUi","increaseDatastoreWizard.readyToCompletePage.title"),description:e.getString("StorageUi","increaseDatastoreWizard.readyToCompletePage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/increaseDatastoreCapacity/pages/ReadyToCompletePage.html",state:void 0,onCommit:function(){var e=i.manager;return t.apply(e.getDatastoreRef(),"com.vmware.vsphere.client.storage.DatastoreIncreaseSpec",e.buildSpec()),!0}}}}}angular.module("com.vmware.vsphere.client.storage").service("readyToCompletePageService",e),e.$inject=["i18nService","mutationService"]}(),function(){"use strict";function e(e,t){return{build:function(i){return{title:e.getString("StorageUi","increaseDatastoreWizard.selectDevicePage.title"),description:e.getString("StorageUi","increaseDatastoreWizard.selectDevicePage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/increaseDatastoreCapacity/pages/SelectDevicePage.html",state:void 0,onCommit:function(){var r=i.manager;return r.getSelectedDevice()?r.getOptionsForSelectedDevice()?(t.markPageComplete(i.wizardConfig),!0):(t.showLoadingIndicator(i.wizardConfig),r.loadDatastoreInfo().then(r.fetchVmfsDatastoreOptions).then(function(){return t.markPageComplete(i.wizardConfig),t.hideLoadingIndicator(i.wizardConfig),!0})):(t.markPageIncompleteWithError(i.wizardConfig,e.getString("StorageUi","datastoreWizards.selectDevicePage.noSelection")),!1)}}}}}angular.module("com.vmware.vsphere.client.storage").service("selectDevicePageService",e),e.$inject=["i18nService","wizardPageService"]}(),function(){"use strict";function e(e,t){return{build:function(i){return{title:e.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.title"),description:e.getString("StorageUi","increaseDatastoreWizard.partitionConfigurationPage.description"),contentUrl:"storage-ui/resources/storage/views/wizard/increaseDatastoreCapacity/pages/SpecifyConfigurationPage.html",state:void 0,onCommit:function(){var r=i.manager,n=r.getSelectedOption();return n&&n.sizeToAdd?(t.markPageComplete(i.wizardConfig),!0):(t.markPageIncompleteWithError(i.wizardConfig,e.getString("StorageUi","form.validationError")),!1)}}}}}angular.module("com.vmware.vsphere.client.storage").service("specifyConfigurationPageService",e),e.$inject=["i18nService","wizardPageService"]}(),h5=h5||{},h5.network={angularModule:angular.module("com.vmware.vsphere.client.network",["com.vmware.platform.ui","com.vmware.vsphere.client.networkLibUi"])},angular.module("com.vmware.vsphere.client.network").run(["mutationService","addHostNetworkingWizardService","i18nService","editPortGroupDialogService","clarityModalService","clarityConstants","networkUiConstants","editVmkernelAdapterDialogService","manageVssPnicsDialogService","iscsiPortBindingService","logService","iscsiPortBindingDetailsDialogService","netStackEditDialogService","editVirtualSwitchDialogService","vmMigrateWizardService","editPnicDialogService","manageProxySwitchPnicsDialogService","migrateVmkToVssWizardService","ghostDvsProxySwitchDetailsService","moveNetworkToService","removeVnicService","$injector","proxySwitchDetailsDialogService",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D){function w(t,r){if(r&&1===r.length){var n="com.vmware.vsphere.client.network.NetworkSystemRefreshSpec",o={_type:n};e.apply(r[0],n,o,i.getString("NetworkUi","removeVirtualSwitch.refreshNetworkSystem.operationName"))}}h5.actions[a.actions.EDIT_DVS_NOTES]=function(t,i){var r=function(t,i,r,n){var o={_type:"com.vmware.vim.binding.vim.dvs.VmwareDistributedVirtualSwitch$ConfigSpec",description:i,configVersion:n},a="com.vmware.vsphere.client.dvs.api.spec.DvsConfigSpec",s={configSpec:o};return e.apply(t,a,s,r),!0},o={notesPropName:"config.description",additionalPropForEdit:"config.configVersion",onUpdateNotesCallback:r};n.openModal(t,i,o,"common-module-ui/resources/common-module/views/notes/NotesDialog.html")},h5.actions[a.actions.EDIT_DVPG_NOTES]=function(t,i){var r=function(t,i,r,n){var o="com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroup$ConfigSpec",a={_type:o,description:i,configVersion:n};return e.apply(t,o,a),!0},o={notesPropName:"config.description",additionalPropForEdit:"config.configVersion",onUpdateNotesCallback:r};n.openModal(t,i,o,"common-module-ui/resources/common-module/views/notes/NotesDialog.html")},h5.actions[a.actions.ADD_NETWORKING]=function(e,i,r){r=r||{},t.showWizard(i[0],r.selectedSwitch,r.connectionType)},h5.actions[a.actions.EDIT_VSWITCH]=function(e,t,i){i=i||{},v.show(t[0],i.selectedSwitch,e)},h5.actions[a.actions.REMOVE_VSWITCH]=function(t,r,o){var a="com.vmware.vsphere.client.h5.network.host.virtualswitch.spec.RemoveVirtualSwitchSpec",s={_type:a,vSwitchName:o.selectedSwitch.name},c={preserveNewlines:!0,submitDisabled:!0,title:i.getString("NetworkUi","removeVirtualSwitch.dialogCaption")};n.openConfirmationModal(c),e.validate(r[0],a,s).then(function(t){c.submitDisabled=!1,t.result?_.extend(c,{title:i.getString("NetworkUi","removeVirtualSwitch.messageDialogCaption"),message:t.result,clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"},hideCancelButton:!0,submit:function(){return!0}}):_.extend(c,{message:i.getString("NetworkUi","removeVirtualSwitch.confirmWarning",o.selectedSwitch.name),saveButtonLabel:i.getString("NetworkUi","NetworkUtil.labelYes"),cancelButtonLabel:i.getString("NetworkUi","NetworkUtil.labelNo"),clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},submit:function(){e.apply(r[0],a,s)}})})},h5.actions[a.actions.EDIT_VNIC]=function(e,t,i){s.show(e,t[0],i.vnic)},h5.actions[a.actions.MANAGE_PNICS]=function(e,t,i){i.selectedSwitch.type===a.switchType.STANDARD?c.show(t[0],i.selectedSwitch.name):h.show(t[0],i.selectedSwitch.dvsRef,i.selectedSwitch.key,i.selectedSwitch.name)},h5.actions[a.actions.MIGRATE_VMK_TO_VSWITCH]=function(e,t,i){i=i||{},f.show(t[0],i.selectedSwitch.name)},h5.actions[a.actions.REFRESH_NETWORK]=w,h5.actions[a.actions.REMOVE_VNIC]=function(e,t,i){P.openConfirmationDialog(t[0],i.vnic)},h5.actions[a.actions.EDIT_PORTGROUP]=function(e,t,i){r.show(i.hostId,e,i.portgroupKey,i.portgroupName)},h5.actions[a.actions.REMOVE_PORTGROUP]=function(t,r,o){var a={title:i.getString("NetworkUi","removePortgroup.dialogCaption"),submitDisabled:!0,preserveNewlines:!0};n.openConfirmationModal(a),e.validate(r[0],"com.vmware.vsphere.client.h5.network.host.portgroup.model.PortGroupRemoveSpec",o.spec).then(function(t){a.submitDisabled=!1,t.result?_.extend(a,{title:i.getString("NetworkUi","removePortgroup.messageDialogCaption"),message:t.result,clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"},hideCancelButton:!0,submit:function(){return!0}}):_.extend(a,{message:i.getString("NetworkUi","removePortgroup.confirmWarning",o.spec.portgroupName),saveButtonLabel:i.getString("NetworkUi","NetworkUtil.labelYes"),cancelButtonLabel:i.getString("NetworkUi","NetworkUtil.labelNo"),clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},submit:function(){e.apply(r[0],"com.vmware.vsphere.client.h5.network.host.portgroup.model.PortGroupRemoveSpec",o.spec)}})})},h5.actions[a.actions.SHOW_ISCSI_PORT_BINDING_DETAILS]=function(e,t,i){u.show(t[0],i.iscsiPortInfoItem)},h5.actions[a.actions.ADD_PORT_BINDING_FOR_ISCSI]=function(e,t,r){var a=d("addPortBindingForIscsi");r.iscsiHbaName||a.error("No iSCSI adapter selected.");var s={},c={contentTemplate:"network-ui/resources/network/views/host/iscsi/add/IscsiPortBindingDialog.html",title:i.getString("H5NetworkUi","portbinding.addDialog.title",r.iscsiHbaName),defaultButton:"submit",alerts:[],size:"lg",dialogData:{portBindingData:{hostId:t[0],iscsiHbaName:r.iscsiHbaName,onSubmitWrapper:s}},subTitle:{objectId:t[0]},onSubmit:function(){return s.submit(r.onSuccessCallback).then(function(e){return e.errors&&e.errors.length&&(c.alerts=_.map(e.errors,function(e){return{type:o.notifications.type.ERROR,text:e}})),e.isSuccessful})}};n.openOkCancelModal(c)},h5.actions[a.actions.REMOVE_PORT_BINDING_FROM_ISCSI]=function(e,t,i){var r=d("removePortBindingFromIscsi");i.iscsiHbaName||r.error("No iSCSI adapter selected.");var o=l.getPortBindingRemovalUserMessages(i.selectedAdapters,i.adapters),a={title:o.title,message:o.description,submit:function(){return l.removeIscsiPortInfos(t[0],i.iscsiHbaName,i.selectedAdapters).then(function(e){i.onSuccessCallback&&i.onSuccessCallback(e)}),!0}};n.openConfirmationModal(a)},h5.actions[a.actions.EDIT_DNS_AND_ROUTING]=function(e,t,i){p.show(t[0],i.selectedNetStack.key,i.selectedNetStack.name,i.multipleNetworkStackInstanceSupported)},h5.actions[a.actions.EDIT_IPV6_SUPPORT]=function(e,t,r){var o={},a={contentTemplate:"network-ui/resources/network/views/host/editIpv6SupportView.html",title:i.getString("NetworkUi","IPv6SupportView.ipv6SupportedDialogTitle"),defaultButton:"submit",alerts:[],size:"md",dialogData:{hostId:t[0],onSubmitWrapper:o},subTitle:{objectId:t[0]},onSubmit:function(){return o.submit(r.onSuccessCallback)}};n.openOkCancelModal(a)},h5.actions[a.actions.VM_MIGRATE]=function(e,t,i){m.show(t[0])},h5.actions[a.actions.EDIT_PNIC]=function(e,t,i){g.show(t[0],i.pnic)},h5.actions[a.actions.GHOST_DVS_PROXY_SWITCH_DETACHED]=function(e,t,i){t&&t.length&&i&&i.details&&S.show(t[0],i.details.switchUuid)},h5.actions[a.actions.NETWORK_MOVE_TO_ACTION]=function(e,t,i){y.openMoveToDialog(t)},h5.actions[a.actions.NETWORK_MOVE_TO_DRAG_AND_DROP_ACTION]=function(e,t,i){t&&t.length&&i&&y.moveNetworkTo(t,i.dropTarget)},h5.actions[a.actions.VSS_VIEW_SETTINGS]=function(e,t,i){C.get("virtualSwitchDetailsDialogService").showVssDetailsDialog(i.selectedSwitch,t[0])},h5.actions[a.actions.PROXY_SWITCH_VIEW_SETTINGS]=function(e,t,i){C.get("virtualSwitchDetailsDialogService").showProxySwitchDetailsDialog(i.selectedSwitch,t[0])}}]);var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"="},this.controller=i,this.templateUrl="network-ui/resources/network/views/moveTo/moveNetworkToComponentTemplate.html"}return e}();e.MoveNetworkToComponent=t;var i=function(){function e(){}return e.prototype.$onInit=function(){var e=this;this.networkIds=this.pageModel.objectIds,this.onLocationSelected=function(t){e.pageModel.entityToMoveNetworkTo=t}},e.$inject=[],e}();angular.module("com.vmware.vsphere.client.network").component("moveNetworkToComponent",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={onLoad:"&"},this.controller=i,this.template='<div ng-if="$ctrl.isInternetExplorer" style="display: none"\n                               ng-include="\'/ui/resources/img/svg-sprite.svg\'"\n                               onload="$ctrl.onLoad()">\n                          </div>'}return e}();e.PreloadSpriteComponent=t;var i=function(){function e(){}return e.prototype.$onInit=function(){this.isInternetExplorer||this.onLoad()},Object.defineProperty(e.prototype,"isInternetExplorer",{get:function(){return"undefined"==typeof SVGForeignObjectElement},enumerable:!0,configurable:!0}),e}();angular.module("com.vmware.vsphere.client.network").component("preloadSpriteComponent",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",dvsRef:"<",proxySwitchKey:"<",onUplinkMappingCreated:"&"},this.controller=i,this.templateUrl="network-ui/resources/network/components/proxyswitch/configProxySwitchPnicsTemplate.html"}return e}();e.ConfigProxySwitchPnicsComponent=t;var i=function(){function e(e){this.physicalAdaptersListService=e}return e.prototype.$onInit=function(){var e=this;this.loading=!0,this.physicalAdaptersListService.getProxySwitchUplinkData(this.hostId,this.dvsRef,this.proxySwitchKey).then(function(t){e.portMapping=t,e.portMapping.addedMappings={},e.onUplinkMappingCreated({uplinkData:e.portMapping}),e.loading=!1})},e.$inject=["physicalAdaptersListService"],e}();angular.module("com.vmware.vsphere.client.network").component("configProxySwitchPnics",new t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(e,t){var r=[],n={field:"uplinkPort",displayName:i.getString("NetworkUi","UplinkPortMappingEditor.column.nic"),width:"150px",template:function(t){var r,n='<span ng-non-bindable class="uplink-name">'+c(t.uplink,e)+"</span> </br>";return r=t.pnic?'<span class="network-lib-ui-icon-physicalAdapter"></span><span ng-non-bindable>'+s(t)+"</span>":"<span ng-non-bindable>"+i.getString("NetworkUi","UplinkPortMappingEditor.noNic")+"</span>",n+r}},o={field:"uplinkPortgroup",displayName:i.getString("NetworkUi","UplinkPortMappingEditor.column.portGroup"),width:"150px"};return r.push(n),t.length>1&&r.push(o),r}function s(e){return e.isNew?i.getString("NetworkUi","UplinkPortMappingEditor.newNicFormat",e.pnic):e.pnic}function c(e,t){var r=l(e,t);return r?i.getString("NetworkUi","UplinkPortMappingEditor.lagPortFormat",e,r):e}function l(e,t){var i=null;for(var r in t)t.hasOwnProperty(r)&&_.indexOf(t[r],e)!==-1&&(i=r);
return i}function d(e){return _.some(e,function(e){return null===e.pnicName})}function u(e,t){var i=[];return _.each(e,function(e){if(null===e.pnicName){var r=c(e.uplinkPort.name,t);i.push({key:e.uplinkPort.name,value:r})}}),_.sortBy(i,"value")}function p(e){var t=[];return _.each(e,function(e){t.push({key:e.key,value:e.name})}),_.sortBy(t,"value")}function v(e){return e?e.name:null}function m(e,t){return _.find(e,function(e){return e.key===t})}return{restrict:"E",template:'<div class="fill-parent uplink-port-mapping"vx-stretch-grid vui-datagrid="datagridOptions"vx-datagrid-preselect-item="true" reselect-on-change="true" preselect-comparator="preselectComparator"></div>',scope:{portMapping:"=",unclaimedPnics:"=",pnicDetails:"=",onSelectionChange:"=",allowOldMappingsRemoval:"=?"},replace:!1,link:{pre:function(s){function c(){T.enabled=d(s.portMapping.uplinkPortMapping);var e=!1;M&&M.length>0&&(e=s.allowOldMappingsRemoval?_.some(M,I):D().length>0),E.enabled=e}function l(e){return _.contains(O,e.uplink)}function g(){if(s.portMapping.unclaimedPnics.length>0){var e=[{id:"uplink",title:i.getString("NetworkUi","UplinkPortMappingAssignDialog.uplinkPort"),items:u(s.portMapping.uplinkPortMapping,s.portMapping.lagMapping),selectedItem:P(M,s.portMapping.uplinkPortMapping).uplinkPort.name}];if(s.portMapping.uplinkPortgroups.length>1){var o=p(s.portMapping.uplinkPortgroups);e.push({id:"portgroup",title:i.getString("NetworkUi","UplinkPortMappingAssignDialog.uplinkPortGroup"),items:o,selectedItem:o[0].key})}r.createPnicSelectorDialog(s.portMapping.unclaimedPnics,s.portMapping.pnicDetails,t.grid.selectionMode.SINGLE,e,f)}else{var a={message:i.getString("NetworkUi","FailoverOrderEditor.noFreeNics"),title:i.getString("H5NetworkUi","failoverOrder.notification.warning"),icon:"vx-icon-warning-32x32",hideCancelButton:!0,preserveNewlines:!0,submit:function(){}};n.openConfirmationModal(a)}}function h(){var e;e=s.allowOldMappingsRemoval?_.filter(M,I):D();var t=_.map(e,w);s.portMapping.unclaimedPnics=s.portMapping.unclaimedPnics.concat(t),s.portMapping.addedMappings=_.omit(s.portMapping.addedMappings,e),_.each(e,function(e){var t=C(e);t.pnicName=null,t.uplinkPortgroup=null}),s.datagridOptions.data=S()}function f(e,t){var i=t.uplink;if(M=[i],e&&1===e.length){var r=e[0],n=_.indexOf(s.portMapping.unclaimedPnics,r);s.portMapping.unclaimedPnics.splice(n,1),s.portMapping.addedMappings[i]=r;var o=C(i);o.pnicName=r;var a=t.portgroup,c=a?m(s.portMapping.uplinkPortgroups,a):s.portMapping.uplinkPortgroups[0];o.uplinkPortgroup=c,s.datagridOptions.data=S()}}function S(){return O=M,y()}function y(){var e=[];return _.forEach(s.portMapping.uplinkPortMapping,function(t){e.push({uplink:t.uplinkPort.name,pnic:t.pnicName,isNew:!!s.portMapping.addedMappings[t.uplinkPort.name],uplinkPortgroup:v(t.uplinkPortgroup)})}),_.sortBy(e,"uplink")}function P(e,t){var i;if(1===e.length&&b(e[0]))i=C(e[0]);else{var r=_.sortBy(t,function(e){return e.uplinkPort.name});i=_.find(r,function(e){return null===e.pnicName})}return i}function C(e){return _.find(s.portMapping.uplinkPortMapping,function(t){return t.uplinkPort.name===e})}function D(){return _.intersection(_.keys(s.portMapping.addedMappings),M)}function w(e){return C(e).pnicName}function b(e){return null===w(e)}function I(e){return null!==w(e)}void 0===s.allowOldMappingsRemoval&&(s.allowOldMappingsRemoval=!1);var T={id:o.failoverOrderActions.ADD,iconClass:"vsphere-icon-add",tooltipText:i.getString("NetworkUi","FailoverOrder.add"),onClick:g},E={id:o.failoverOrderActions.REMOVE,iconClass:"vsphere-icon-remove",tooltipText:i.getString("NetworkUi","FailoverOrder.remove"),onClick:h},V=[T,E];s.datagridOptions={columnDefs:a(s.portMapping.lagMapping,s.portMapping.uplinkPortgroups),data:y(),pageConfig:{hidePager:!0},selectedItems:[],resizable:!0,height:"100%",sortMode:t.grid.sortMode.NONE,searchable:!1,selectionMode:t.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,actionBarOptions:{actions:V}},s.preselectComparator=l;var M,O;s.$watch(function(){return s.datagridOptions.selectedItems},function(e){s.onSelectionChange&&s.onSelectionChange(e),M=e?_.pluck(e,"uplink"):[],c()}),e(function(){var e=$("div.uplink-port-mapping .k-grid");if(e){var t=e.data("kendoGrid");t&&t.resize()}},0)}}}}angular.module("com.vmware.vsphere.client.network").directive("uplinkPortMapping",e),e.$inject=["$timeout","vuiConstants","i18nService","pnicSelectorDialogService","clarityModalService","networkUiConstants"]}(),function(){"use strict";function e(e,t){var i={restrict:"E",templateUrl:"network-ui/resources/network/components/uplinkPortMapping/uplinkPortMappingWithDetails.html",scope:{portMapping:"=",allowOldMappingsRemoval:"=?"},replace:!0,link:{pre:function(i){i.noItemsSelectedMessage=t.getString("NetworkUi","UplinkPortMappingEditor.detailsPrompt"),i.showPnicDetails=function(t){if(t&&1===t.length&&t[0].pnic){var r=i.portMapping.pnicDetails[t[0].pnic];i.selectedPnicDetails=e.build(r)}else i.selectedPnicDetails=null},i.splitterOptions={resizable:!0,panes:[{size:"210px"},{}]}}}};return i}angular.module("com.vmware.vsphere.client.network").directive("uplinkPortMappingWithDetails",e),e.$inject=["physicalAdapterDetailsViewService","i18nService"]}();var network_ui;!function(e){var t=function(){function e(){}return e.prototype.havePortgroupPropertiesChanged=function(e,t){return e.portgroupName!==t.portgroupName||e.portgroupVlanId!==t.portgroupVlanId},e.prototype.haveVirtualSwitchPropertiesChanged=function(e,t){return e.mtu!==t.mtu||e.numPorts!==t.numPorts},e.prototype.hasTrafficShapingPolicyChanged=function(e,t,i){return(!i||e.overridden!==!1||t.overridden!==!1)&&(e.overridden!==t.overridden||e.enabled!==t.enabled||e.enabled&&t.enabled&&(e.averageBandwidth!==t.averageBandwidth||e.peakBandwidth!==t.peakBandwidth||e.burstSize!==t.burstSize))},e.prototype.hasSecurityPolicyChanged=function(e,t,i){return i?this.diffOverridablePolicy(e.isPromiscuousModeOverriden,e.allowPromiscuousMode,t.isPromiscuousModeOverriden,t.allowPromiscuousMode)||this.diffOverridablePolicy(e.isMacChangesOverriden,e.macChanges,t.isMacChangesOverriden,t.macChanges)||this.diffOverridablePolicy(e.isForgedTransmitsOverriden,e.forgedTransmits,t.isForgedTransmitsOverriden,t.forgedTransmits):e.allowPromiscuousMode!==t.allowPromiscuousMode||e.macChanges!==t.macChanges||e.forgedTransmits!==t.forgedTransmits},e.prototype.hasFailoverPolicyChanged=function(e,t,i){return i?this.diffOverridablePolicy(e.loadBalancingOverridden,e.loadBalancing,t.loadBalancingOverridden,t.loadBalancing)||this.diffOverridablePolicy(e.failureDetectionOverridden,e.checkBeacon,t.failureDetectionOverridden,t.checkBeacon)||this.diffOverridablePolicy(e.notifySwitchesOverridden,e.notifySwitches,t.notifySwitchesOverridden,t.notifySwitches)||this.diffOverridablePolicy(e.failbackOverridden,e.rollingOrder,t.failbackOverridden,t.rollingOrder):e.loadBalancing!==t.loadBalancing||e.checkBeacon!==t.checkBeacon||e.notifySwitches!==t.notifySwitches||e.rollingOrder!==t.rollingOrder},e.prototype.hasFailoverOrderChanged=function(e,t,i){return(!i||e.failoverOrderOverridden!==!1||t.failoverOrderOverridden!==!1)&&(!!e.failoverOrderOverridden!=!!t.failoverOrderOverridden||!(!e.pnics&&!t.pnics)&&(!!(e.pnics&&!t.pnics||!e.pnics&&t.pnics)||(this.diffArrays(e.pnics.active,t.pnics.active)||this.diffArrays(e.pnics.standby,t.pnics.standby))))},e.prototype.diffArrays=function(e,t){if(!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!0;return!1},e.prototype.diffOverridablePolicy=function(e,t,i,r){return e&&i?t!==r:!!e!=!!i},e}();e.EditPortgroupService=t,angular.module("com.vmware.vsphere.client.network").service("editPortgroupService",t)}(network_ui||(network_ui={}));var network_ui;!function(e){angular.module("com.vmware.vsphere.client.network").constant("iscsiPortBindingConstants",{backingType:{STANDARD_VNIC_BACKING_TYPE:"standard",DISTRIBUTED_VNIC_BACKING_TYPE:"distributed",OPAQUE_VNIC_BACKING_TYPE:"opaque"}})}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){}return e}();e.IscsiPortBindingDetailsViewData=t;var i=function(){function e(e){this.retrieveData=e}return e}();e.IscsiPortBindingDetailsViewDataRetriever=i;var r=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.dataService=e,this.i18nService=t,this.$q=i,this.networkDetailsViewService=r,this.physicalAdaptersListService=n,this.physicalAdapterDetailsViewService=o,this.vmKernelAdapterService=a,this.dvPortgroupPropertiesService=s,this.vxPropertyViewService=c,this.distributedPortgroupPoliciesViewService=l,this.iscsiPortBindingConstants=d,this.standardSwitchPropertiesViewService=u,this.standardSwitchPoliciesViewService=p,this.dvsDetailsViewService=v}return e.prototype.requestPortgroupDetailsViewData=function(e,t){if(e&&t)switch(t.vnicBackingType){case this.iscsiPortBindingConstants.backingType.STANDARD_VNIC_BACKING_TYPE:return this.requestPortgroupDetailsViewDataForStandardPg(e,t);case this.iscsiPortBindingConstants.backingType.DISTRIBUTED_VNIC_BACKING_TYPE:return this.requestPortgroupDetailsViewDataForDvpg(e,t)}return this.$q.when(null)},e.prototype.requestSwitchDetailsViewData=function(e,t){if(e&&t)switch(t.vnicBackingType){case this.iscsiPortBindingConstants.backingType.STANDARD_VNIC_BACKING_TYPE:return this.requestSwitchDetailsViewDataForStandardSwitch(e,t);case this.iscsiPortBindingConstants.backingType.DISTRIBUTED_VNIC_BACKING_TYPE:return this.requestSwitchDetailsViewDataForDvs(e,t)}return this.$q.when(null)},e.prototype.requestSwitchDetailsViewDataForStandardSwitch=function(e,i){var r=this;if(!i.switchName)return this.$q.when(null);var n={switchProperties:this.standardSwitchPropertiesViewService.getDataByName(e,i.switchName),switchPolicies:this.standardSwitchPoliciesViewService.getDataByName(e,i.switchName)};return this.$q.all(n).then(function(e){if(!e||!e.switchProperties)return null;var n=r.vxPropertyViewService.createPropertyViewBuilder(),o=n.category("properties").title(r.i18nService.getString("NetworkUi","VSwitchSettingsView.properties"));if(r.standardSwitchPropertiesViewService.addPropertiesToCategory(e.switchProperties,o),e.switchPolicies){var a=n.category("policies").title(r.i18nService.getString("NetworkUi","VSwitchSettingsView.policy"));r.standardSwitchPoliciesViewService.addPropertiesToCategory(e.switchPolicies,a),n.generateAllCategory()}var s=new t;return s.propertiesData=n.build(),s.viewTitle=r.i18nService.getString("NetworkUi","VSwitchSettingsView.title",i.switchName),s})},e.prototype.requestSwitchDetailsViewDataForDvs=function(e,i){var r=this;if(!i.dvSwitchUuid)return this.$q.when(null);var n="dvswitchproperties:configDataByUuid";return this.dataService.getProperties(e,[n],{propertyParams:[{propertyName:n,parameterType:"java.lang.String",parameter:i.dvSwitchUuid}]}).then(function(e){var o=e&&e[n];if(!o)return null;var a=new t;return a.propertiesData=r.dvsDetailsViewService.build(o,!0),a.viewTitle=r.i18nService.getString("NetworkUi","HostProxySwitchDetailsView.titleFormat",i.switchName),a})},e.prototype.requestPortgroupDetailsViewDataForStandardPg=function(i,r){var n=this;return n.dataService.getProperties(i,[e.STANDARD_PORT_GROUP_DETAILS],{propertyParams:[{propertyName:e.STANDARD_PORT_GROUP_DETAILS,parameterType:"java.lang.String",parameter:r.vnicSpec.portgroup}]}).then(function(i){var r=i&&i[e.STANDARD_PORT_GROUP_DETAILS];if(!r)return null;var o=new t;return o.propertiesData=n.networkDetailsViewService.build(r),o.viewTitle=n.i18nService.getString("NetworkUi","PortgroupSettingsView.title",r.networkLabel),o})},e.prototype.requestPortgroupDetailsViewDataForDvpg=function(e,i){if(!i.vnicSpec||!i.vnicSpec.distributedVirtualPort||!i.vnicSpec.distributedVirtualPort.portgroupKey)return this.$q.when(null);var r=this;return this.dvPortgroupPropertiesService.requestDvPortgroupPropertiesAndPolicy(e,i.vnicSpec.distributedVirtualPort.portgroupKey).then(function(e){if(!e||!e.properties)return null;var i=r.vxPropertyViewService.createPropertyViewBuilder(),n=i.category("properties").title(r.i18nService.getString("NetworkUi","dvpg.manage.settings.propertiesHeader"));r.dvPortgroupPropertiesService.addPropertiesToSection(e.properties,n),e.policy&&r.distributedPortgroupPoliciesViewService.build(e.policy,i);var o=new t;return i.generateAllCategory(),o.propertiesData=i.build(),e.isUplink?o.viewTitle=r.i18nService.getString("NetworkUi","DvPortgroupProperties.uplinkTitleFormat",e.properties.name):o.viewTitle=r.i18nService.getString("NetworkUi","DvPortgroupProperties.titleFormat",e.properties.name),o})},e.prototype.requestPnicDetailsViewData=function(e,i){var r=this;return i&&i.pnicDevice?this.physicalAdaptersListService.getPhysicalAdapterDetailsItem(e,i.pnicDevice).then(function(e){if(!e)return null;var n=new t;return n.propertiesData=r.physicalAdapterDetailsViewService.build(e),n.viewTitle=r.i18nService.getString("NetworkUi","PnicPropertiesView.title",i.pnicDevice),n}):this.$q.when(null)},e.prototype.requestVnicDetailsViewData=function(e,i){var r=this;return i&&i.vnicDevice?this.vmKernelAdapterService.getVnicDetailsData(e,i.vnicDevice).then(function(e){if(!e)return null;var n=new t;return n.propertiesData=r.networkDetailsViewService.build(e),n.viewTitle=r.i18nService.getString("NetworkUi","VnicDetailsView.title",i.vnicDevice),n}):this.$q.when(null)},e.STANDARD_PORT_GROUP_DETAILS="virtualswitch:portGroupPropertyViewDataByName",e.$inject=["dataService","i18nService","$q","networkDetailsViewService","physicalAdaptersListService","physicalAdapterDetailsViewService","vmKernelAdapterService","dvPortgroupPropertiesService","vxPropertyViewService","distributedPortgroupPoliciesViewService","iscsiPortBindingConstants","standardSwitchPropertiesViewService","standardSwitchPoliciesViewService","dvsDetailsViewService"],e}();e.IscsiPortBindingDetailsService=r,angular.module("com.vmware.vsphere.client.network").service("iscsiPortBindingDetailsService",r)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){}return e}();e.ImageLabel=t;var i=function(){function e(){}return e}();e.IscsiPortInfoItem=i;var r=function(){function e(){}return e}();e.IscsiPortInfoData=r;var n=function(){function e(){}return e}();e.CandidateIscsiPortInfoData=n;var o=function(){function e(e,t,i,r,n,o){this.dataService=e,this.mutationService=t,this.i18nService=i,this.logService=r,this.$q=n,this.iscsiPortBindingConstants=o,this.log=r("iscsiPortBindingService")}return e.prototype.getBoundIscsiPortInfoData=function(t,i){var n=this;return this.dataService.getProperties(t,[e.BOUND_ISCSI_PORT_INFO_DATA],{propertyParams:[{propertyName:e.BOUND_ISCSI_PORT_INFO_DATA,parameterType:"java.lang.String",parameter:i}]}).then(function(t){var i=new r;return t&&t[e.BOUND_ISCSI_PORT_INFO_DATA]&&(i.hasPrivileges=t[e.BOUND_ISCSI_PORT_INFO_DATA].hasPrivileges,t[e.BOUND_ISCSI_PORT_INFO_DATA].portInfoItems&&(i.items=_.map(t[e.BOUND_ISCSI_PORT_INFO_DATA].portInfoItems,function(e){return n.createIscsiPortInfoItem(e)}))),i})},e.prototype.getCandidateIscsiPortInfoData=function(t,i){var r=this;return this.dataService.getProperties(t,[e.CANDIDATE_ISCSI_PORT_INFO_DATA],{propertyParams:[{propertyName:e.CANDIDATE_ISCSI_PORT_INFO_DATA,parameterType:"java.lang.String",parameter:i}]}).then(function(t){var i=new n;return t&&t[e.CANDIDATE_ISCSI_PORT_INFO_DATA]&&(i.items=_.map(t[e.CANDIDATE_ISCSI_PORT_INFO_DATA].candidatePortInfoItems,function(e){return r.createIscsiPortInfoItem(e)})),i})},e.prototype.addCandidateIscsiPortInfo=function(e,t,i){var r="com.vmware.vsphere.client.network.host.iscsi.specs.IscsiPortBindingAddSpec",n={_type:r,params:_.map(i,function(e){return{iscsiHbaName:t,vnicDevice:e.vmKernelAdapter.label}})};return this.mutationService.apply(e,r,n)},e.prototype.removeIscsiPortInfos=function(e,t,i){var r="com.vmware.vsphere.client.network.host.iscsi.specs.IscsiPortBindingRemoveSpec",n={_type:r,params:_.map(i,function(e){return{iscsiHbaName:t,vnicDevice:e.vmKernelAdapter.label,forceRemoval:!0}})};return this.mutationService.apply(e,r,n)},e.prototype.getPortBindingRemovalUserMessages=function(t,i){t&&t.length||this.log.error("No selected port infos provided"),i&&i.length||this.log.error("No port infos provided");var r={title:this.i18nService.getString("NetworkUi","portbinding.list.remove.confirmationTitle"),description:this.i18nService.getString("NetworkUi","portbinding.list.remove.confirmationTextFormat",t[0].vmKernelAdapter.label)};if(1===t.length)t[0].pathStatus.label===e.LAST_ACTIVE_STATUS&&(r.title=this.i18nService.getString("NetworkUi","portbinding.list.confirmRemoveLastActivePathTitle"),r.description=this.i18nService.getString("NetworkUi","portbinding.list.confirmRemoveLastActivePath",t[0].vmKernelAdapter.label));else{var n=_.find(i,function(i){return t.indexOf(i)===-1&&(i.pathStatus.label===e.LAST_ACTIVE_STATUS||i.pathStatus.label===e.ACTIVE_STATUS)});n?(r.title=this.i18nService.getString("NetworkUi","portbinding.list.remove.multiple.confirmationTitle"),r.description=this.i18nService.getString("NetworkUi","portbinding.list.remove.multiple.confirmationText")):(r.title=this.i18nService.getString("NetworkUi","portbinding.list.confirmRemoveAllActivePathsTitle"),r.description=this.i18nService.getString("NetworkUi","portbinding.list.confirmRemoveAllActivePaths"))}return r},e.prototype.createIscsiPortInfoItem=function(e){var t=new i;return t.portgroupName=this.formatPortGroupName(e.portGroupName,e.vnicBackingType),t.vmKernelAdapter=this.formatVmKernelAdapter(e.vmKernelAdapter),t.policyComplianceStatus=this.formatComplianceStatus(e.isCompliant),t.pathStatus=this.formatPathStatus(e.pathStatus),t.physicalNetworkAdapterInfo=this.formatPhysicalNetworkAdapterInfo(e.physicalNetworkAdapterInfo),t.pnicDevice=e.pnicDevice,t.vnicDevice=e.vmKernelAdapter,t.complianceErrors=e.complianceErrors,t.isCompliant=e.isCompliant,t.vnicSpec=e.vnicSpec,t.vnicBackingType=e.vnicBackingType,t.switchName=e.switchName,t.dvSwitchUuid=e.dvSwitchUuid,t},e.prototype.formatPathStatus=function(i){var r=new t;switch(i){case e.ACTIVE_STATUS:r.label=this.i18nService.getString("NetworkUi","portbinding.activeStatusHeader"),r.icon="network-lib-ui-icon-path-active";break;case e.STAND_BY_STATUS:r.label=this.i18nService.getString("NetworkUi","portbinding.standbyHeader"),r.icon="network-lib-ui-icon-path-standby";break;case e.NOT_USED_STATUS:r.label=this.i18nService.getString("NetworkUi","portbinding.notUsedHeader"),r.icon="network-lib-ui-icon-path-dead";break;case e.LAST_ACTIVE_STATUS:r.label=this.i18nService.getString("NetworkUi","portbinding.lastActiveHeader"),r.icon="network-lib-ui-icon-path-disabled";break;default:r.label=this.i18nService.getString("NetworkUi","portbinding.defaultString")}return r},e.prototype.formatComplianceStatus=function(e){var i=new t;return e?(i.label=this.i18nService.getString("NetworkUi","portbinding.compliantLabel"),i.icon="network-lib-ui-icon-statusGreen"):(i.label=this.i18nService.getString("NetworkUi","portbinding.notCompliantLabel"),i.icon="vsphere-icon-status-warning"),i},e.prototype.formatPortGroupName=function(e,i){var r=new t;if(e)switch(r.label=e,i){case this.iscsiPortBindingConstants.backingType.STANDARD_VNIC_BACKING_TYPE:r.icon="vsphere-icon-network";break;case this.iscsiPortBindingConstants.backingType.OPAQUE_VNIC_BACKING_TYPE:r.icon="vsphere-icon-cloud-network";break;case this.iscsiPortBindingConstants.backingType.DISTRIBUTED_VNIC_BACKING_TYPE:r.icon="vsphere-icon-virtual-port-group"}else r.label=this.i18nService.getString("NetworkUi","portbinding.defaultString");return r},e.prototype.formatVmKernelAdapter=function(e){var i=new t;return e?(i.label=e,i.icon="network-lib-ui-icon-virtualAdapter"):i.label=this.i18nService.getString("NetworkUi","portbinding.defaultString"),i},e.prototype.formatPhysicalNetworkAdapterInfo=function(e){var i=new t;return e?(i.label=e,i.icon="network-lib-ui-icon-physicalAdapter"):i.label=this.i18nService.getString("NetworkUi","portbinding.defaultString"),i},e.BOUND_ISCSI_PORT_INFO_DATA="iscsiPortBinding:boundIscsiPortInfoData",e.CANDIDATE_ISCSI_PORT_INFO_DATA="iscsiPortBinding:candidateIscsiPortInfoData",e.ACTIVE_STATUS="active",e.STAND_BY_STATUS="standBy",e.NOT_USED_STATUS="notUsed",e.LAST_ACTIVE_STATUS="lastActive",e.$inject=["dataService","mutationService","i18nService","logService","$q","iscsiPortBindingConstants"],e}();e.IscsiPortBindingService=o,angular.module("com.vmware.vsphere.client.network").service("iscsiPortBindingService",o)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i){this.dataService=e,this.i18nService=t,this.propertyViewService=i}return e.prototype.getNetStackDetails=function(t,i){var r={};r.netStackInstanceKey=i;var n={propertyParams:[{propertyName:e.DATA_PROPERTY,parameterType:"com.vmware.vsphere.client.h5.network.host.netstack.model.NetStackConfigSpec",parameter:r}]};return this.dataService.getProperties(t,[e.DATA_PROPERTY],n).then(function(t){return t[e.DATA_PROPERTY]})},e.prototype.buildDnsPropertiesView=function(e,t){if(e){var i=this.propertyViewService.createPropertyViewBuilder();return this.buildDnsCategory(i,e,t),i.build()}},e.prototype.buildRoutingPropertiesView=function(e){if(e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildRoutingCategory(t,e),t.build()}},e.prototype.buildAdvancedPropertiesView=function(e){if(e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildAdvancedCategory(t,e),t.build()}},e.prototype.buildDnsCategory=function(e,t,i){var r=e.category("dns"),n=t.isDhcpEnabled?this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.dhcp",t.selectedVnic):this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.static"),o=this.i18nService.getString("H5NetworkUi","NetStackInstanceList.noData"),a=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.dnsMethod");if(r.section("general").property(a,n),i){var s=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.hostNameLabel"),c=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.hostDomainLabel");r.section("general").property(s,t.hostName).property(c,t.domainName)}var l=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.preferredDnsServerLabel"),d=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.alternateDnsServerLabel"),u=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.searchDomain");r.section("general").property(l,t.preferredDns||o).property(d,t.alternateDns||o).property(u,t.searchDomains||o)},e.prototype.buildRoutingCategory=function(e,t){var i=e.category("routing"),r=this.i18nService.getString("H5NetworkUi","NetStackInstanceList.noData"),n=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.ipv4VmkernelGateway");if(i.section("general").property(n,t.defaultGateway||r),t.isIpv6Enabled){var o=this.i18nService.getString("H5NetworkUi","DnsAndRoutingView.ipv6VmkernelGateway");i.section("general").property(o,t.ipV6DefaultGateway||r)}},e.prototype.buildAdvancedCategory=function(e,t){var i=e.category("advanced"),r=i.section("general"),n=this.i18nService.getString("H5NetworkUi","NetStackInstanceList.noData"),o=this.i18nService.getString("NetworkUi","AdvancedNetStackSettingsView.congestionControl"),a="";"newreno"===t.congestionControlAlgorithm&&(a=this.i18nService.getString("NetworkUi","AdvancedNetStackPage.newReno")),"cubic"===t.congestionControlAlgorithm&&(a=this.i18nService.getString("NetworkUi","AdvancedNetStackPage.cubic")),r.property(o,a||n);var s=this.i18nService.getString("NetworkUi","AdvancedNetStackSettingsView.maxNumberOfConnections");r.property(s,t.maxNumberOfConnections||n),t.runtimeMaxNumberOfConnections!==t.maxNumberOfConnections&&t.isRuntimeInfoActive&&r.message(this.i18nService.getString("NetworkUi","AdvancedNetStackPage.restartWarning"),"network-lib-ui-icon-restartWarning")},e.$inject=["dataService","i18nService","vxPropertyViewService"],e.DATA_PROPERTY="netstack:netStackConfig",e}();e.NetStackDetailsViewService=t,angular.module("com.vmware.vsphere.client.network").service("netStackDetailsViewService",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i){function r(t,i,r,o){return{columnDefs:n(r),sortMode:e.grid.sortMode.SINGLE,selectionMode:e.grid.selectionMode.SINGLE,selectedItems:[],data:t,resizable:!0,height:"100%",pageConfig:{hidePager:!0},actionBarOptions:i,onChange:o}}function n(e){var r=[{displayName:t.getString("H5NetworkUi","NetStackInstanceList.tcpIpInstance"),field:"name",width:"120px"},{displayName:t.getString("H5NetworkUi","NetStackInstanceList.type"),field:"type",width:"100px"},{displayName:t.getString("H5NetworkUi","NetStackInstanceList.assignedAdapters"),field:"virtualNicCount",width:"100px",template:function(e){return'<span class="right-align-cell">'+e.virtualNicCount+"</span>"},sortable:function(e,t){return i.compareNumericValues(e,t,"virtualNicCount")}},{displayName:t.getString("H5NetworkUi","NetStackInstanceList.ipv4GatewayAddress"),field:"ipv4GatewayAddress",width:"100px"}];return e&&r.push({displayName:t.getString("H5NetworkUi","NetStackInstanceList.ipv6GatewayAddress"),field:"ipv6GatewayAddress",width:"180px"}),r.push({displayName:t.getString("H5NetworkUi","NetStackInstanceList.preferredDnsServer"),field:"preferredDnsServer",width:"150px"},{displayName:t.getString("H5NetworkUi","NetStackInstanceList.alternateDnsServer"),field:"alternateDnsServer",width:"150px"}),r}return{createDatagridOptions:r}}angular.module("com.vmware.vsphere.client.network").service("netStackListService",e),e.$inject=["vuiConstants","i18nService","networkUtil"]}(),function(){"use strict";function e(e,t,i){return[{displayName:e.getString("NetworkUi","PnicDataGridView.pnicDeviceColumnHeader"),field:"device",width:"150px",sortable:function(e,t){return i.compareNumericValues(e,t,"pnicIndex")},template:function(e){return t.getColumnRenderer("object-link")([void 0,"device","network-lib-ui-icon-physicalAdapter"],e)}},{displayName:e.getString("NetworkUi","PnicDataGridView.pnicActualSpeedColumnHeader"),field:"actualSpeedLabel",sortable:function(e,t){return i.compareNumericValues(e,t,"actualSpeed")},template:function(e){return'<span class="right-align-cell">'+e.actualSpeedLabel+"</span>"},width:"150px"},{displayName:e.getString("NetworkUi","PnicDataGridView.pnicConfigSpeedColumnHeader"),field:"configuredSpeedLabel",sortable:function(e,t){return i.compareNumericValues(e,t,"configuredSpeed")},template:function(e){return'<span class="right-align-cell">'+e.configuredSpeedLabel+"</span>"},width:"150px"},{displayName:e.getString("NetworkUi","PnicDataGridView.pnicSwitchColumnHeader"),field:"virtualSwitch.switchName",width:"150px",template:function(e){var i=e.virtualSwitch;return t.getColumnRenderer("icon-text")(["iconId","switchName"],i)}},{displayName:e.getString("NetworkUi","PnicDataGridView.pnicMacColumnHeader"),field:"mac",width:"150px"},{displayName:e.getString("NetworkUi","PnicDataGridView.pnicNetworksColumnHeader"),field:"networkHint",width:"150px",template:function(e){return t.getColumnRenderer("text")(["networkHint"],e)}},{displayName:e.getString("NetworkUi","PnicDataGridView.pnicWakeOnLanColumnHeader"),field:"wakeOnLanSupportedLabel",width:"150px"},{displayName:e.getString("NetworkUi","PnicDataGridView.SriovStatusColumnHeader"),field:"sriovStatusLabel",width:"150px"},{displayName:e.getString("NetworkUi","PnicDataGridView.SriovNumVfsColumnHeader"),field:"sriovNumVirtuanFunctionsLabel",width:"150px"}]}angular.module("com.vmware.vsphere.client.network").factory("physicalAdaptersListColumns",e),e.$inject=["i18nService","columnRenderersRegistry","networkUtil"]}();var network_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.dataService=t,this.dvsDetailsViewService=i}return e.prototype.getData=function(t){var i=this;return this.dataService.getProperties(t,[e.CONFIG_DATA_PROPERTY_NAME]).then(function(t){var r=t&&t[e.CONFIG_DATA_PROPERTY_NAME];if(r&&r.name){var n=r.name.trim(),o=n.replace(/%25/g,"%").replace(/%2f/g,"/").replace(/%5c/g,"\\");r.name=o}return i.dvsDetailsViewService.build(r,!0)})},e.$inject=["i18nService","dataService","dvsDetailsViewService"],e.CONFIG_DATA_PROPERTY_NAME="dvswitchproperties:configdata",e}();e.ProxySwitchDetailsDialogService=t,angular.module("com.vmware.vsphere.client.network").service("proxySwitchDetailsDialogService",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.clarityModalService=t,this.mutationService=i}return e.prototype.openConfirmationDialog=function(e,t){var i=this,r="com.vmware.vsphere.client.modules.api.network.VirtualNicRemoveSpec",n="standardNetwork"===t.connectedTo?t.networkLabel:null,o={virtualNicName:t.device,portgroupName:n,isServiceConsoleVirtualNic:!1},a={title:this.i18nService.getString("H5NetworkUi","removeVnicDialog.confirmRemoveTitle"),submitDisabled:!0,preserveNewlines:!0,saveButtonLabel:this.i18nService.getString("H5NetworkUi","removeButtonLabel")};this.clarityModalService.openConfirmationModal(a),this.mutationService.validate(e,r,o).then(function(t){if(t.error)_.extend(a,{message:i.i18nService.getString("H5NetworkUi","removeVnicDialog.validationError"),clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"}});else if(a.submitDisabled=!1,"error"===t.result.messageType)_.extend(a,{message:t.result.message,saveButtonLabel:i.i18nService.getString("Common","saveButtonLabel"),clarityIcon:{"class":"is-error",shape:"error-standard",size:"32"},submit:function(){return!0},hideCancelButton:!0});else{var n=t.result.message?t.result.message:i.i18nService.getString("H5NetworkUi","removeVnicDialog.confirmRemoveMessage",o.virtualNicName);_.extend(a,{message:n,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},submit:function(){i.mutationService.apply(e,r,o)}})}})},e.$inject=["i18nService","clarityModalService","mutationService"],e}();e.RemoveVnicService=t,angular.module("com.vmware.vsphere.client.network").service("removeVnicService",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i){function r(e,t){var i={_type:"com.vmware.vsphere.client.h5.network.host.virtualswitch.spec.VirtualSwitchIdSpec",key:t};return o(e,i,!0)}function n(e,t){var i={_type:"com.vmware.vsphere.client.h5.network.host.virtualswitch.spec.VirtualSwitchIdSpec",name:t};return o(e,i,!1)}function o(t,i,r){var n={propertyParams:[{propertyName:c,parameterType:i._type,parameter:i}]},o=e.getProperties(t,[c],n);return o.then(function(e){var t=e&&e[c];return r?a(t):t})}function a(e){var i=t.createPropertyViewBuilder(),r=i.category("general");return s(e,r),i.build()}function s(e,t){e&&i.fillPoliciesCategory(t,e)}var c="virtualswitch:policiesViewData";return{getData:r,getDataByName:n,addPropertiesToCategory:s}}angular.module("com.vmware.vsphere.client.network").service("standardSwitchPoliciesViewService",e),e.$inject=["dataService","vxPropertyViewService","networkUtil"]}(),function(){"use strict";function e(e,t,i){function r(e,t){var i={_type:"com.vmware.vsphere.client.h5.network.host.virtualswitch.spec.VirtualSwitchIdSpec",key:t};return o(e,i,!0)}function n(e,t){var i={_type:"com.vmware.vsphere.client.h5.network.host.virtualswitch.spec.VirtualSwitchIdSpec",name:t};return o(e,i,!1)}function o(t,i,r){var n="virtualswitch:propertiesViewData",o={propertyParams:[{propertyName:n,parameterType:i._type,parameter:i}]},s=e.getProperties(t,[n],o);return s.then(function(e){var t=e&&e[n];return r?a(t):t})}function a(e){var i=t.createPropertyViewBuilder(),r=i.category("general");return s(e,r),i.build()}function s(e,t){var r=t.section("generalSection");r.title(i.getString("H5NetworkUi","standardSwitchDetailsView.properties.section")),e&&(e.name&&r.property(i.getString("NetworkUi","VSwitchPropertiesView.standardSwitch"),e.name),e.numberOfPorts&&(r.property(i.getString("NetworkUi","VSwitchPropertiesView.numPorts"),e.numberOfPorts),e.showRestartWarning&&r.message(i.getString("NetworkUi","VSwitchPropertiesView.numPortDesc"),"vx-icon-restartWarning")),e.mtu&&r.property(i.getString("NetworkUi","VSwitchPropertiesView.mtu"),e.mtu));
}return{getData:r,getDataByName:n,addPropertiesToCategory:s}}angular.module("com.vmware.vsphere.client.network").service("standardSwitchPropertiesViewService",e),e.$inject=["dataService","vxPropertyViewService","i18nService"]}(),function(){"use strict";function e(e,t,i,r){function n(t,i,r){return{columnDefs:o(i),sortMode:e.grid.sortMode.SINGLE,selectionMode:e.grid.selectionMode.SINGLE,selectedItems:[],data:t,resizable:!0,height:"100%",pageConfig:{hidePager:!0},onChange:r}}function o(e){return[{displayName:i.getString("NetworkUi","HostSwitchList.column.switch"),field:"name",width:"150px",template:a("name",{distributedSwitch:"vsphere-icon-dv-switch",standardSwitch:"network-lib-ui-icon-vswitch"})},{displayName:i.getString("NetworkUi","HostSwitchList.column.discoveredIssues"),field:"issueType",width:"150px",visible:e,template:s("issueType",{alert:"vsphere-icon-status-error",warning:"vsphere-icon-status-warning",none:null},{alert:i.getString("NetworkUi","HostSwitchList.column.status.alert"),warning:i.getString("NetworkUi","HostSwitchList.column.status.warning"),none:i.getString("NetworkUi","HostSwitchList.column.status.noIssues")})}]}function a(e,i){return function(r){var n=i[r.type]||null,o=t.getColumnRenderer("object-link");return o([null,e,n],r)}}function s(e,i,r){return function(n){var o=i[n[e]]||null,a=r[n[e]]||null,s=t.getColumnRenderer("object-link");return s([null,"text",o],{text:a})}}return{createDatagridOptions:n}}angular.module("com.vmware.vsphere.client.network").service("virtualSwitchListService",e),e.$inject=["vuiConstants","columnRenderersRegistry","i18nService","networkUtil"]}();var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.MoveNetworkSpec,i=function(){function e(e,t,i,r){this.clarityModalService=e,this.i18nService=t,this.mutationService=i,this.defaultUriSchemeUtil=r}return e.prototype.openMoveToDialog=function(e){var t=this,i={title:this.i18nService.getString("NetworkUi","moveto.dialog.title"),subTitle:{objectId:e[0]},defaultButton:"submit",dialogData:{objectIds:e},contentTemplate:"network-ui/resources/network/views/moveTo/moveNetworkToDialog.html"};i.onSubmit=function(){return t.moveNetworkTo(i.dialogData.objectIds,i.dialogData.entityToMoveNetworkTo),!0},this.clarityModalService.openOkCancelModal(i)},e.prototype.moveNetworkTo=function(e,i){var r=this,n=e.map(function(e){return r.defaultUriSchemeUtil.getManagedObjectReference(e)}),o=new t;return o.entities=n,this.mutationService.apply(i,o._type,o).then(function(){}),!0},e.$inject=["clarityModalService","i18nService","mutationService","defaultUriSchemeUtil"],e}();e.MoveNetworkToService=i,angular.module("com.vmware.vsphere.client.network").service("moveNetworkToService",i)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i){function r(t){var r=[];return t&&0!==t.trim().length?t.trim().length>i.NETWORK_LABEL_MAX_LENGTH?r.push(e.getString("NetworkUi","VnicData.networkLabelTooLong")):t.indexOf('"')>=0&&r.push(e.getString("H5NetworkUi","VnicData.networkLabelInvalidCharacter")):r.push(e.getString("NetworkUi","VnicData.emptyNetworkLabel")),r}function n(e,i){return t.validate(e,"com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.StandardNetworkLabelValidateSpec",{_type:"com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.StandardNetworkLabelValidateSpec",label:i.trim()}).then(function(e){var t=[];return e.result&&t.push(e.result),t})}return{getNetworkLabelClientSideValidationErrors:r,getNetworkLabelServerSideValidationErrors:n}}angular.module("com.vmware.vsphere.client.network").service("networkLabelValidator",e),e.$inject=["i18nService","mutationService","networkUtil"]}(),function(){"use strict";function e(e){function i(i,r){var n=i;return e.getProperties(r,[t],{propertyParams:[{propertyName:t,parameterType:"java.lang.String",parameter:n}]})}return{isSystemTrafficEnabledOnDefaultStack:i}}angular.module("com.vmware.vsphere.client.network").service("tcpIpStackServicesValidator",e),e.$inject=["dataService"];var t="vnic:isSystemTrafficEnabled"}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u){function p(e){e.vSwitchSpec={},e.addNetworkingSpec={},e.addNetworkingSpec.dhcpEnabled=!0,e.addNetworkingSpec.ipv4Address="",e.addNetworkingSpec.subnetMask="",e.addNetworkingSpec.overrideGateway=!1,e.addNetworkingSpec.ipv4DefaultGateway="",e.addNetworkingSpec.ipv6DhcpEnabled=!1,e.addNetworkingSpec.routerAdvertisementEnabled=!1,e.addNetworkingSpec.ipv6Addresses=[],e.addNetworkingSpec.overrideIpv6Gateway=!1,e.addNetworkingSpec.ipv6DefaultGateway="",e.addNetworkingSpec.isGatewayFeatureSupported=!1,e.selectTargetNetworkPageModel={},e.selectTargetNetworkPageModel.isOpaqueNetworkSelected=!1,e.selectTargetNetworkPageModel.targetType=e.selectConnectionTypePageModel.connectionType===a.connectionType.VMKERNEL?a.targetType.EXISTING_NETWORK:a.targetType.EXISTING_STANDARD_SWITCH,e.addPnicPageModel={},e.addPnicPageModel.isInitialized=!1,e.addPnicToDvsPageModel={},e.addPnicToDvsPageModel.isInitialized=!1,e.connectionSettingsPageModel={},e.connectionSettingsPageModel.vlanIds=null,e.connectionSettingsPageModel.isInitialized=!1,e.ipv4SettingsPageModel={},e.ipv4SettingsPageModel.validateIpAddress={},e.ipv4SettingsPageModel.validateSubnetMask={},e.ipv4SettingsPageModel.validateIpv4DefaultGateway={},e.ipv6SettingsPageModel={},e.ipv6SettingsPageModel.validateIpv6DefaultGateway={},e.portPropertiesPageModel={ipSettingsType:a.ipSettingsMode.IP_V4},e.bindPnicPageModel={bindToPnic:!1,selectedPnic:null,availablePnicsData:null,onPnicSelectionChange:function(e){this.selectedPnic=e},onBindToPnicChange:function(e){this.bindToPnic=e},onAvailablePnicsDataChange:function(e){this.availablePnicsData=e}}}function v(e){e.vSwitchSpec.pnics&&(e.vSwitchSpec.pnics=null),e.vSwitchSpec.pnicsDetails&&(e.vSwitchSpec.pnicsDetails=null),e.addPnicPageModel.isInitialized=!1,e.addPnicToDvsPageModel.isInitialized=!1}return{showWizard:function(m,g,h){function f(){var t;switch(y.selectConnectionTypePageModel.connectionType){case a.connectionType.VMKERNEL:t=s.createNewVnicSpec(y.addNetworkingSpec,y.vSwitchSpec,y.portPropertiesPageModel.ipSettingsType,y.selectTargetNetworkPageModel.targetType,y.bindPnicPageModel);break;case a.connectionType.VM_PORTGROUP:t=s.createNewPortgroupSpec(y.addNetworkingSpec,y.vSwitchSpec,y.selectTargetNetworkPageModel.targetType);break;case a.connectionType.PNIC:t=y.selectTargetNetworkPageModel.targetType===a.targetType.NEW_STANDARD_SWITCH?s.createNewPnicToNewStandardSwitchSpec(y.vSwitchSpec):y.addNetworkingSpec.selectedStandardSwitch.type===d.switchType.DISTRIBUTED?s.createNewPnicToDistributedSwitchSpec(y.addPnicToDvsPageModel.portMapping.uplinkPortMapping,y.addNetworkingSpec.selectedStandardSwitch):s.createNewPnicToExistingStandardSwitchSpec(y.addNetworkingSpec,y.vSwitchSpec)}return e.when(t).then(function(e){o.apply(y.hostId,e._type,e)}),!0}var S="com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.HostStandardSwitchData",y=n.$new();y.addNetworkingWizardConstants=a,y.hostId=m,y.preselectedSwitch=g,y.hostCapability={},y.hostVnicIpRoutingInfo={isIpv4Set:!1,isIpv6Set:!1,value:null},y.selectConnectionTypePageModel={},y.selectConnectionTypePageModel.connectionType=h?h:a.connectionType.VMKERNEL,y.wizardConfig={cssClass:"add-networking-wizard",loading:!0,updateLoadingState:function(e){this.loading=e}},y.wizardConfig.title=i.getString("NetworkUi","AddNetworkingWizard.title"),y.wizardConfig.onFinish=f,y.wizardConfig.pages=c.createWizardPages(y),u.initWizardValidation(y),l.initFlowManager(y),t({scope:y,configObjectName:"wizardConfig"}).show(),y.$watch(function(){return y.selectConnectionTypePageModel.connectionType},function(){p(y),y.selectTargetNetworkPageModel.retrieveAllSwitches=y.selectConnectionTypePageModel.connectionType===a.connectionType.PNIC}),y.$watch(function(){return y.selectTargetNetworkPageModel.targetType},function(e,t){e!==t&&v(y)}),y.$watch(function(){return y.addNetworkingSpec.selectedStandardSwitch},function(){v(y)}),r.getData(m,S).then(function(e){y.wizardConfig.iconClass="host-ui-icon-default",y.wizardConfig.title=i.getString("NetworkUi","AddNetworkingWizard.updatedTitle",e.name),y.hostCapability.switchAutoScaleSupported=e.switchAutoScaleSupported,y.hostCapability.availablePortsNumber=e.availablePortsNumber,y.wizardConfig.loading=!1})}}}angular.module("com.vmware.vsphere.client.network").service("addHostNetworkingWizardService",e),e.$inject=["$q","vuiWizardService","i18nService","dataService","$rootScope","mutationService","addNetworkingWizardConstants","addNetworkingSpecificationFactory","addNetworkingPages","addNetworkingFlowManager","networkUiConstants","wizardValidationService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(e,i,r,n,o){var c=t.pages,l=i===t.targetType.NEW_STANDARD_SWITCH;s(c.CREATE_STANDARD_SWITCH,l);var d=e===t.connectionType.VMKERNEL,u=d&&r!==t.ipSettingsMode.IP_V6,p=d&&r!==t.ipSettingsMode.IP_V4,v=o&&i===t.targetType.EXISTING_NETWORK;s(c.IPV4_SETTINGS,u),s(c.IPV6_SETTINGS,p),s(c.PORT_PROPERTIES,d),s(c.BIND_TO_PNIC,v);var m=e===t.connectionType.VM_PORTGROUP;s(c.CONNECTION_SETTINGS,m);var g=e===t.connectionType.PNIC,h=a(n),f=g&&!l&&h,S=g&&!l&&!h;s(c.ADD_PNIC,f),s(c.ADD_PNIC_DVS,S)}function a(e){var t=!0;return e&&(t=e.type===i.switchType.STANDARD),t}function s(t,i){var r=_.findWhere(c,{id:t});i?r.state===e.wizard.pageState.SKIPPED&&(r.state=e.wizard.pageState.DISABLED):r.state=e.wizard.pageState.SKIPPED}var c;this.initFlowManager=function(e){c=e.wizardConfig.pages,r.registerWizardForDefaultStateManagementStrategy(e),e.$watchGroup(["selectConnectionTypePageModel.connectionType","selectTargetNetworkPageModel.targetType","portPropertiesPageModel.ipSettingsType","addNetworkingSpec.selectedStandardSwitch","selectTargetNetworkPageModel.isOpaqueNetworkSelected"],function(e){o.apply(null,e)})}}angular.module("com.vmware.vsphere.client.network").service("addNetworkingFlowManager",e),e.$inject=["vuiConstants","addNetworkingWizardConstants","networkUiConstants","pageStateManagementService","featureFlagsService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.createWizardPages=function(p){var m={id:e.pages.SELECT_CONNECTION_TYPE,title:l.getString("NetworkUi","AddNetworkingWizard.conTypePage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.conTypePage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/selectConnectionTypePage.html",validationParams:["selectConnectionTypePageModel.connectionType"],onCommit:function(){return p.wizardConfig.currentPage.state=d.wizard.pageState.COMPLETED,!0}},g={id:e.pages.SELECT_TARGET_TYPE,title:l.getString("NetworkUi","AddNetworkingWizard.conTargetPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.conTargetPage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/SelectTargetNetworkPage.html",validationParams:["hostCapability","selectTargetNetworkPageModel.targetType","addNetworkingSpec.selectedStandardSwitch","addNetworkingSpec.selectedNetwork","vSwitchSpec.mtu","vSwitchSpec.numPorts"],validationFunction:function(){return t.getValidationErrors(p)}},h={id:e.pages.ADD_PNIC,title:l.getString("NetworkUi","AddNetworkingWizard.physicalNicPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.physicalNicPage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/addPnicPage.html",validationParams:["vSwitchSpec.pnics.active","vSwitchSpec.pnics.standby","vSwitchSpec.pnics.unused"],validationFunction:function(){return i.getValidationErrorsAndWarnings(p.vSwitchSpec.pnics,p.vSwitchSpec.pnicsDetails)}},f={id:e.pages.ADD_PNIC_DVS,title:l.getString("NetworkUi","AddNetworkingWizard.physicalNicPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.physicalNicPage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/addPnicToDvsPage.html",validationParams:["addPnicToDvsPageModel.portMapping.addedMappings"],validationFunction:r.getValidationErrors},S={id:e.pages.CREATE_STANDARD_SWITCH,title:l.getString("NetworkUi","AddNetworkingWizard.newSwitchPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.newSwitchPage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/CreateStandardSwitchPage.html",defaultState:d.wizard.pageState.SKIPPED,validationParams:["vSwitchSpec.pnics.active.length","vSwitchSpec.pnics.standby.length","vSwitchSpec.pnics.unused.length"],validationFunction:function(){return o.getValidationErrorsAndWarnings(p.vSwitchSpec.pnics,p.vSwitchSpec.pnicsDetails)}},y={id:e.pages.CONNECTION_SETTINGS,title:l.getString("NetworkUi","AddNetworkingWizard.vmNetworkingPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.vmNetworkingPage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/connectionSettingsPage.html",validationParams:["hostId","addNetworkingSpec.networkLabel","addNetworkingSpec.vlanId"],validationFunction:a.getValidationErrors},P={id:e.pages.PORT_PROPERTIES,title:l.getString("NetworkUi","AddNetworkingWizard.portPropPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.portPropPage.descVmkernel"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/PortPropertiesPage.html",validationParams:["hostId","addNetworkingSpec.networkLabel","selectTargetNetworkPageModel.targetType","addNetworkingSpec.vlanId","addNetworkingSpec.mtuSelectedType","addNetworkingSpec.mtu","addNetworkingSpec.netStackName.stackName"],validationFunction:function(){var e;return p.addNetworkingSpec.isTcpIpStackSupported&&(e=p.addNetworkingSpec.netStackName.netStackInstanceKey),v.when(n.getValidationErrorsAndWarnings(p.hostId,p.addNetworkingSpec.networkLabel,p.selectTargetNetworkPageModel.targetType,p.addNetworkingSpec.vlanId,p.addNetworkingSpec.mtuSelectedType,p.addNetworkingSpec.mtu,e)).then(function(e){return e})}},C={id:e.pages.IPV4_SETTINGS,title:l.getString("NetworkUi","AddNetworkingWizard.ipv4Settings.title"),description:l.getString("NetworkUi","AddNetworkingWizard.ipv4Settings.descVmkernel"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/Ipv4SettingsPage.html",validationParams:["hostId","addNetworkingSpec.dhcpEnabled","addNetworkingSpec.ipv4Address","addNetworkingSpec.subnetMask","addNetworkingSpec.overrideGateway","addNetworkingSpec.ipv4DefaultGateway"],validationFunction:function(){p.ipv4SettingsPageModel.validateIpAddress(),p.ipv4SettingsPageModel.validateSubnetMask(),p.addNetworkingSpec.isGatewayFeatureSupported&&p.addNetworkingSpec.overrideGateway&&p.ipv4SettingsPageModel.validateIpv4DefaultGateway();var e={hostId:p.hostId,dhcpEnabled:p.addNetworkingSpec.dhcpEnabled,ipv4Address:p.addNetworkingSpec.ipv4Address,subnetMask:p.addNetworkingSpec.subnetMask,isGatewayFeatureSupported:p.addNetworkingSpec.isGatewayFeatureSupported,overrideGateway:p.addNetworkingSpec.overrideGateway,ipv4DefaultGateway:p.addNetworkingSpec.ipv4DefaultGateway};return s.getValidationErrors(e)}},D={id:e.pages.IPV6_SETTINGS,title:l.getString("NetworkUi","AddNetworkingWizard.ipv6Settings.title"),description:l.getString("NetworkUi","AddNetworkingWizard.ipv6Settings.descVmkernel"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/Ipv6SettingsPage.html",validationParams:["addNetworkingSpec.ipv6DhcpEnabled","addNetworkingSpec.routerAdvertisementEnabled","addNetworkingSpec.staticAddressesEnabled","addNetworkingSpec.ipv6Addresses.length","addNetworkingSpec.overrideIpv6Gateway","addNetworkingSpec.ipv6DefaultGateway",function(e){if(e.addNetworkingSpec&&e.addNetworkingSpec.ipv6Addresses){var t=_.map(e.addNetworkingSpec.ipv6Addresses,function(e){return e.address+e.prefixLength});return t.toString()}}],validationFunction:function(){return p.addNetworkingSpec.isGatewayFeatureSupported&&p.addNetworkingSpec.overrideIpv6Gateway&&p.ipv6SettingsPageModel.validateIpv6DefaultGateway(),c.getValidationErrors(p.addNetworkingSpec.ipv6DhcpEnabled,p.addNetworkingSpec.routerAdvertisementEnabled,p.addNetworkingSpec.staticAddressesEnabled,p.addNetworkingSpec.ipv6Addresses.length,p.addNetworkingSpec.overrideIpv6Gateway,p.addNetworkingSpec.ipv6DefaultGateway)}},w={id:e.pages.BIND_TO_PNIC,title:l.getString("NetworkUi","AddNetworkingWizard.physicalNicBindingPage.title"),description:l.getString("NetworkUi","AddNetworkingWizard.physicalNicBindingPage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/BindToPhysicalAdapterPage.html",validationParams:["bindPnicPageModel.bindToPnic","bindPnicPageModel.selectedPnic"],validationFunction:u.getValidationErrors},b={id:e.pages.RTC,title:l.getString("H5NetworkUi","AddNetworkingWizard.readyToCompletePage.title"),description:l.getString("H5NetworkUi","AddNetworkingWizard.readyToCompletePage.description"),contentUrl:"network-ui/resources/network/views/host/addnetworking/pages/ReadyToCompletePage.html"},I=[m,g,h,f,S,y,P,C,D,w,b];return I}}angular.module("com.vmware.vsphere.client.network").service("addNetworkingPages",e),e.$inject=["addNetworkingWizardConstants","selectTargetNetworkPageValidator","addHostNetworkingAddPnicPageValidator","addPnicToDvsPageValidator","portPropertiesPageValidator","addHostNetworkingCreateStandardSwitchPageValidator","connectionSettingsPageValidator","ipv4SettingsPageValidator","ipv6SettingsPageValidator","i18nService","vuiConstants","bindToPnicPageValidator","featureFlagsService","$q"]}(),function(){"use strict";function e(e,t,i,r){function n(e,t){var i=new O,r=h(t.pnics);return i.activeNic=r.activeNic,i.standbyNic=r.standbyNic,i.bridge=r.bridge,i.vSwitchName=e.selectedStandardSwitch.name,i}function o(e){var t=m(e),i=new y;return i.vswitch.push(t),new S(i)}function a(e,t){return new A(e,t.key)}function s(e,t,i){var r=l(e,t,i);return new S(r)}function c(i,r,n,o,a){var s=new D(i.mtu,i.netStackInstanceKey);if(s.spec.ip=p(n,i),s.spec.ipRouteSpec=v(n,i),o===t.targetType.EXISTING_NETWORK)return d(s,i,i.selectedNetwork,a);if(o===t.targetType.EXISTING_STANDARD_SWITCH||o===t.targetType.NEW_STANDARD_SWITCH){s.portgroup=i.networkLabel;var c=l(i,r,o);c.vnic.push(s);var u=new S(c);return g(i),u.vmkernelSettingsSpec=i.vmkernelSettingsSpec,e.when(u)}}function l(e,i,r){var n,o=new y;if(r===t.targetType.EXISTING_STANDARD_SWITCH)n=new P(e.networkLabel,e.selectedStandardSwitch.name,e.vlanId);else if(r===t.targetType.NEW_STANDARD_SWITCH){var a=m(i);o.vswitch.push(a),n=new P(e.networkLabel,i.name,e.vlanId)}return o.portgroup.push(n),o}function d(e,t,n,o){g(t);var a=new w(e,t.vmkernelSettingsSpec);return n.isDistributedPortgroup?i.getData(r.getVsphereObjectId(n.networkRef),"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupTargetData").then(function(t){return e.spec.distributedVirtualPort=new V(t.key,t.dvSwitchUuid),a}):n.isOpaqueNetwork?i.getData(r.getVsphereObjectId(n.networkRef),"com.vmware.vsphere.client.h5.network.opaquenetwork.model.OpaqueNetworkTargetData").then(function(t){return e.spec.opaqueNetwork=new M(t.opaqueNetworkId,t.opaqueNetworkType),o&&o.bindToPnic&&o.selectedPnic&&(e.spec.pinnedPnic=o.selectedPnic),a}):void 0}function u(e){var t=[];return _.forEach(e,function(e){var i=new E(e.address,e.prefixLength);t.push(i)}),t}function p(e,i){var r=new b,n=e!==t.ipSettingsMode.IP_V6,o=e!==t.ipSettingsMode.IP_V4;return n&&(r.dhcp=i.dhcpEnabled,i.dhcpEnabled||(r.ipAddress=i.ipv4Address,r.subnetMask=i.subnetMask)),o&&(r.ipV6Config=new T(i.ipv6DhcpEnabled,i.routerAdvertisementEnabled),i.staticAddressesEnabled&&(r.ipV6Config.ipV6Address=u(i.ipv6Addresses))),r}function v(e,i){if(!i.isGatewayFeatureSupported)return null;var r=new I,n=!i.dhcpEnabled&&i.overrideGateway,o=i.staticAddressesEnabled&&i.overrideIpv6Gateway;return e!==t.ipSettingsMode.IP_V6&&n&&(r.ipRouteConfig.defaultGateway=i.ipv4DefaultGateway),e!==t.ipSettingsMode.IP_V4&&o&&(r.ipRouteConfig.ipV6DefaultGateway=i.ipv6DefaultGateway),r}function m(e){var t=new f(e.name,e.mtu,e.numPorts),i=h(e.pnics);return t.spec.policy.nicTeaming.nicOrder.activeNic=i.activeNic,t.spec.policy.nicTeaming.nicOrder.standbyNic=i.standbyNic,i.bridge&&(t.spec.bridge=i.bridge),t}function g(e){e.netStackInstanceKey&&e.netStackInstanceKey!==t.defaultNetStackKey&&(e.vmkernelSettingsSpec.isVmotionEnabled=!1,e.vmkernelSettingsSpec.isProvisioningNfcTrafficEnabled=!1)}function h(e){var t={},i=e.active;t.activeNic=i;var r=e.standby;t.standbyNic=r;var n=e.unused,o=[];return o=o.concat(i,r,n),o.length>0&&(t.bridge=new C(o)),t}function f(e,t,i){this._type="com.vmware.vim.binding.vim.host.VirtualSwitch$Config",this.name=e,this.changeOperation="add",this.spec={},this.spec._type="com.vmware.vim.binding.vim.host.VirtualSwitch$Specification",this.spec.mtu=t,this.spec.numPorts=i,this.spec.bridge=null,this.spec.policy={},this.spec.policy._type="com.vmware.vim.binding.vim.host.NetworkPolicy",this.spec.policy.nicTeaming={},this.spec.policy.nicTeaming._type="com.vmware.vim.binding.vim.host.NetworkPolicy$NicTeamingPolicy",this.spec.policy.nicTeaming.nicOrder={},this.spec.policy.nicTeaming.nicOrder._type="com.vmware.vim.binding.vim.host.NetworkPolicy$NicOrderPolicy",this.spec.policy.nicTeaming.nicOrder.activeNic=[],this.spec.policy.nicTeaming.nicOrder.standbyNic=[]}function S(e){this._type="com.vmware.vsphere.client.network.HostNetworkingAddSpec",this.networkConfig=e}function y(){this._type="com.vmware.vim.binding.vim.host.NetworkConfig",this.vnic=[],this.portgroup=[],this.vswitch=[]}function P(e,t,i){this._type="com.vmware.vim.binding.vim.host.PortGroup$Config",this.changeOperation="add",this.spec={},this.spec._type="com.vmware.vim.binding.vim.host.PortGroup$Specification",this.spec.name=e.trim(),this.spec.vlanId=i,this.spec.vswitchName=t,this.spec.policy={},this.spec.policy._type="com.vmware.vim.binding.vim.host.NetworkPolicy"}function C(e){this._type="com.vmware.vim.binding.vim.host.VirtualSwitch$BondBridge",this.nicDevice=e}function D(e,t){this._type="com.vmware.vim.binding.vim.host.VirtualNic$Config",this.portgroup=null,this.spec={},this.spec._type="com.vmware.vim.binding.vim.host.VirtualNic$Specification",this.spec.ip=null,this.spec.ipRouteSpec=null,this.spec.mtu=e,this.spec.netStackInstanceKey=t,this.changeOperation="add"}function w(e,t){this._type="com.vmware.vsphere.client.network.VirtualNicAddSpec",this.vnicConfig=e,this.vmkernelSettingsSpec=t,this.isServiceConsoleVnic=!1}function b(){this._type="com.vmware.vim.binding.vim.host.IpConfig",this.dhcp=!1,this.ipAddress="",this.subnetMask="",this.ipV6Config=null}function I(){this._type="com.vmware.vim.binding.vim.host.VirtualNic$IpRouteSpec",this.ipRouteConfig={},this.ipRouteConfig._type="com.vmware.vim.binding.vim.host.IpRouteConfig"}function T(e,t){this._type="com.vmware.vim.binding.vim.host.IpConfig$IpV6AddressConfiguration",this.dhcpV6Enabled=e,this.autoConfigurationEnabled=t,this.ipV6Address=[]}function E(e,t){this._type="com.vmware.vim.binding.vim.host.IpConfig$IpV6Address",this.ipAddress=e,this.prefixLength=t,this.operation="add"}function V(e,t){this._type="com.vmware.vim.binding.vim.dvs.PortConnection",this.portgroupKey=e,this.switchUuid=t}function M(e,t){this._type="com.vmware.vim.binding.vim.host.VirtualNic$OpaqueNetworkSpec",this.opaqueNetworkId=e,this.opaqueNetworkType=t}function O(){this._type="com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.HostPnicAddSpec"}function A(e,t){this._type="com.vmware.vsphere.client.h5.network.host.proxyswitch.spec.UpdateProxySwitchUplinkMappingSpec",this.uplinkPortMappings=e,this.proxySwitchKey=t}return{createNewPortgroupSpec:s,createNewPnicToExistingStandardSwitchSpec:n,createNewPnicToNewStandardSwitchSpec:o,createNewPnicToDistributedSwitchSpec:a,createNewVnicSpec:c}}angular.module("com.vmware.vsphere.client.network").factory("addNetworkingSpecificationFactory",e),e.$inject=["$q","addNetworkingWizardConstants","dataService","defaultUriSchemeUtil","networkUiConstants"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.network").constant("addNetworkingWizardConstants",{connectionType:{VMKERNEL:"0",VM_PORTGROUP:"1",PNIC:"2"},targetType:{EXISTING_NETWORK:"existingNetwork",EXISTING_STANDARD_SWITCH:"existingStandardSwitch",NEW_STANDARD_SWITCH:"newStandardSwitch"},ipSettingsMode:{IP_V4:"ipv4",IP_V6:"ipv6",MIXED:"mixed"},switchType:{STANDARD:"standardSwitch",DISTRIBUTED:"distributedSwitch"},pages:{SELECT_CONNECTION_TYPE:"selectConnectionTypePage",SELECT_TARGET_TYPE:"selectTargetNetworkPage",ADD_PNIC:"addPnicPage",ADD_PNIC_DVS:"addPnicToDvsPage",CREATE_STANDARD_SWITCH:"createStandardSwitchPage",CONNECTION_SETTINGS:"addHostNetworkingConnectionSettingsPag",PORT_PROPERTIES:"portPropertiesPag",IPV4_SETTINGS:"addHostNetworkingIpv4SettingsPag",IPV6_SETTINGS:"addHostNetworkingIpv6SettingsPag",BIND_TO_PNIC:"bindToPhysicalAdapterPage",RTC:"addVnicReadyToCompletePage"},defaultNetStackKey:"defaultTcpipStack",provisioningNetStackKey:"vSphereProvisioning",vmotionNetStackKey:"vmotion"})}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){var o=r.createPropertyViewBuilder(),a=o.category("general"),s=a.section("generalSection");e.selectTargetNetworkPageModel.targetType===t.targetType.EXISTING_STANDARD_SWITCH&&(s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.vmNetworking"),e.addNetworkingSpec.networkLabel),s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.virtualSwitch"),e.addNetworkingSpec.selectedStandardSwitch.name)),e.selectTargetNetworkPageModel.targetType===t.targetType.NEW_STANDARD_SWITCH&&(s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newVirtualSwitch"),e.vSwitchSpec.name),s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.vmNetworking"),e.addNetworkingSpec.networkLabel),s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.assignedAdapters"),p(e.vSwitchSpec.pnics)),e.hostCapability.switchAutoScaleSupported===!1&&s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newVirtualSwitch.numPorts"),e.vSwitchSpec.numPorts),s.property(i.getString("H5NetworkUi","AddNetworkingWizard.summary.switchMtu"),e.vSwitchSpec.mtu)),s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.vlanId"),n.formatVlanId(e.addNetworkingSpec.vlanId)),e.summaryData=o.build()}function c(){var a=r.createPropertyViewBuilder(),s=a.category("general"),c=s.section("generalSection");e.selectTargetNetworkPageModel.targetType===t.targetType.EXISTING_NETWORK&&(e.addNetworkingSpec.selectedNetwork.isDistributedPortgroup&&(c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.dvPortGroup"),e.addNetworkingSpec.selectedNetwork.name),c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.dvs"),e.addNetworkingSpec.selectedNetwork.dvsName)),e.addNetworkingSpec.selectedNetwork.isOpaqueNetwork&&(e.addNetworkingSpec.selectedNetwork.isNsxNetwork?c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.nsxOpaqueNetworkName"),e.addNetworkingSpec.selectedNetwork.name):c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.opaqueNetworkName"),e.addNetworkingSpec.selectedNetwork.name))),e.selectTargetNetworkPageModel.targetType===t.targetType.EXISTING_STANDARD_SWITCH&&(c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newPortgroup"),e.addNetworkingSpec.networkLabel),c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.virtualSwitch"),e.addNetworkingSpec.selectedStandardSwitch.name),c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.vlanId"),n.formatVlanId(e.addNetworkingSpec.vlanId))),e.selectTargetNetworkPageModel.targetType===t.targetType.NEW_STANDARD_SWITCH&&(c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newVirtualSwitch"),e.vSwitchSpec.name),c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.assignedAdapters"),p(e.vSwitchSpec.pnics)),e.hostCapability.switchAutoScaleSupported===!1&&c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newVirtualSwitch.numPorts"),e.vSwitchSpec.numPorts),c.property(i.getString("H5NetworkUi","AddNetworkingWizard.summary.switchMtu"),e.vSwitchSpec.mtu),c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newPortgroup"),e.addNetworkingSpec.networkLabel),c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.vlanId"),n.formatVlanId(e.addNetworkingSpec.vlanId)));var l=o.pickServiceSettings(e.addNetworkingSpec.vmkernelSettingsSpec),v=o.getServiceDescriptions(e.portPropertiesPageModel.hostVnicFeatures);_.forEach(l,function(e,t){var i=v[t];c.property(i.summaryLabel,d(e))}),e.selectTargetNetworkPageModel.targetType===t.targetType.EXISTING_NETWORK&&e.addNetworkingSpec.selectedNetwork.isOpaqueNetwork&&e.bindPnicPageModel.bindToPnic&&e.bindPnicPageModel.selectedPnic&&c.property(i.getString("NetworkUi","AddNetworkingWizard.summary.boundPnic"),e.bindPnicPageModel.selectedPnic);var m=s.section("nicSettings").title(i.getString("H5NetworkUi","AddNetworkingWizard.summary.nicSettings"));if(m.property(i.getString("H5NetworkUi","AddNetworkingWizard.summary.mtu"),e.addNetworkingSpec.mtu),e.addNetworkingSpec.netStackName&&e.addNetworkingSpec.netStackName.stackName&&m.property(i.getString("H5NetworkUi","AddNetworkingWizard.summary.netStack"),e.addNetworkingSpec.netStackName.stackName),e.portPropertiesPageModel.ipSettingsType===t.ipSettingsMode.IP_V4||e.portPropertiesPageModel.ipSettingsType===t.ipSettingsMode.MIXED){var g=s.section("ipv4Settings").title(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv4Settings"));e.addNetworkingSpec.dhcpEnabled?g.property(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv4Dhcp"),i.getString("NetworkUi","AddNetworkingWizard.summary.enabled")):(g.property(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv4Address"),i.getString("H5NetworkUi","AddNetworkingWizard.readyToCompletePage.staticIpAddressFormat",e.addNetworkingSpec.ipv4Address)),g.property(i.getString("NetworkUi","AddNetworkingWizard.summary.subnetMask"),e.addNetworkingSpec.subnetMask),e.addNetworkingSpec.overrideGateway&&g.property(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv4Gateway"),e.addNetworkingSpec.ipv4DefaultGateway))}if(e.portPropertiesPageModel.ipSettingsType===t.ipSettingsMode.IP_V6||e.portPropertiesPageModel.ipSettingsType===t.ipSettingsMode.MIXED){var h=s.section("ipv6Settings").title(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv6Settings"));h.property(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv6Dhcp"),d(e.addNetworkingSpec.ipv6DhcpEnabled)),h.property(i.getString("NetworkUi","AddNetworkingWizard.summary.routerAdv"),d(e.addNetworkingSpec.routerAdvertisementEnabled)),e.addNetworkingSpec.staticAddressesEnabled&&e.addNetworkingSpec.ipv6Addresses.length>0&&(h.property(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv6Addresses"),u(e.addNetworkingSpec.ipv6Addresses)),e.addNetworkingSpec.overrideIpv6Gateway&&h.property(i.getString("NetworkUi","AddNetworkingWizard.summary.ipv6Gateway"),e.addNetworkingSpec.ipv6DefaultGateway))}e.summaryData=a.build()}function l(){var n=r.createPropertyViewBuilder(),o=n.category("general"),s=o.section("generalSection");e.selectTargetNetworkPageModel.targetType===t.targetType.NEW_STANDARD_SWITCH?(s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newVirtualSwitch"),e.vSwitchSpec.name),s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.assignedAdapters"),p(e.vSwitchSpec.pnics)),e.hostCapability.switchAutoScaleSupported===!1&&s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.newVirtualSwitch.numPorts"),e.vSwitchSpec.numPorts),s.property(i.getString("H5NetworkUi","AddNetworkingWizard.summary.switchMtu"),e.vSwitchSpec.mtu)):e.selectTargetNetworkPageModel.targetType===t.targetType.EXISTING_STANDARD_SWITCH&&(e.addNetworkingSpec.selectedStandardSwitch.type===a.switchType.STANDARD?(s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.virtualSwitch"),e.addNetworkingSpec.selectedStandardSwitch.name),s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.assignedAdapters"),v(m(e.vSwitchSpec.pnics)))):e.addNetworkingSpec.selectedStandardSwitch.type===a.switchType.DISTRIBUTED&&(s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.dvs"),e.addNetworkingSpec.selectedStandardSwitch.name),
s.property(i.getString("NetworkUi","AddNetworkingWizard.summary.assignedAdapters"),v(_.values(e.addPnicToDvsPageModel.portMapping.addedMappings))))),e.summaryData=n.build()}function d(e){return i.getString("NetworkUi",e?"AddNetworkingWizard.summary.enabled":"AddNetworkingWizard.summary.disabled")}function u(e){return _.map(e,function(e){return e.address+"/"+e.prefixLength+" "+i.getString("NetworkUi","VnicView.ipAddrStaticTypeFormat")})}function p(e){var t=[];return e&&(e.active&&e.active.length>0&&(t=t.concat(e.active)),e.standby&&e.standby.length>0&&(t=t.concat(e.standby)),e.unused&&e.unused.length>0&&(t=t.concat(e.unused))),t.length>0?t.join(", "):i.getString("NetworkUi","AddNetworkingWizard.summary.noData")}function v(e){return e.join(", ")}function m(e){var t=[];return t.push.apply(t,_.filter(e.active,function(t){return _.indexOf(e.unclaimedInitial,t)!==-1})),t.push.apply(t,_.filter(e.standby,function(t){return _.indexOf(e.unclaimedInitial,t)!==-1})),t.push.apply(t,_.filter(e.unused,function(t){return _.indexOf(e.unclaimedInitial,t)!==-1})),t}switch(e.selectConnectionTypePageModel.connectionType){case t.connectionType.VMKERNEL:c();break;case t.connectionType.VM_PORTGROUP:s();break;case t.connectionType.PNIC:l()}return this}angular.module("com.vmware.vsphere.client.network").controller("AddHostNetworkingReadyToCompletePageController",e),e.$inject=["$scope","addNetworkingWizardConstants","i18nService","vxPropertyViewService","networkUtil","hostVnicServiceFactory","networkUiConstants"]}(),function(){"use strict";function e(e,t,i){function r(e,i){return{connectees:e,connecteesDetails:i,labels:{active:t.getString("NetworkUi","FailoverOrderEditor.active"),standby:t.getString("NetworkUi","FailoverOrderEditor.standby"),unused:t.getString("NetworkUi","FailoverOrderEditor.unused")}}}function n(){e.wizardConfig.loading=!0,e.vSwitchSpec.pnics={active:[],standby:[],unused:[],unclaimed:[]},i.getPhysicalAdaptersWithDetails(e.hostId,e.addNetworkingSpec.selectedStandardSwitch.name).then(function(t){e.vSwitchSpec.pnics.active=t.active||[],e.vSwitchSpec.pnics.standby=t.standby||[],e.vSwitchSpec.pnics.unused=t.unused||[],e.vSwitchSpec.pnics.unclaimed=t.unclaimed,e.vSwitchSpec.pnicsDetails=t.pnicDetails,e.failoverOrder=r(e.vSwitchSpec.pnics,e.vSwitchSpec.pnicsDetails),e.addPnicPageModel.isInitialized=!0,e.wizardConfig.loading=!1})}return e.noItemsSelectedMessage=t.getString("NetworkUi","FailoverOrderEditor.detailsPrompt"),e.headerOptions={title:t.getString("NetworkUi","FailoverOrderEditor.failoverOrder")},e.addPnicPageModel.isInitialized?e.failoverOrder=r(e.vSwitchSpec.pnics,e.vSwitchSpec.pnicsDetails):n(),this}angular.module("com.vmware.vsphere.client.network").controller("AddPnicPageController",e),e.$inject=["$scope","i18nService","physicalAdaptersListService"]}(),function(){"use strict";function e(e,t,i){function r(){e.wizardConfig.loading=!0,i.getProxySwitchUplinkData(e.hostId,e.addNetworkingSpec.selectedStandardSwitch.dvsRef,e.addNetworkingSpec.selectedStandardSwitch.key).then(function(t){e.addPnicToDvsPageModel.portMapping=t,e.addPnicToDvsPageModel.portMapping.addedMappings={},e.addPnicToDvsPageModel.isInitialized=!0,e.wizardConfig.loading=!1})}return e.addPnicToDvsPageModel.isInitialized||r(),this}angular.module("com.vmware.vsphere.client.network").controller("AddPnicToDvsPageController",e),e.$inject=["$scope","i18nService","physicalAdaptersListService"]}();var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",opaqueNetworkRef:"<?",opaqueNetworkId:"<?",opaqueNetworkType:"<?",bindToPnicEnabled:"<",selectedPnicForBinding:"<",availablePnicsData:"<",onPnicSelectionChange:"&",onBindToPnicChange:"&",onAvailablePnicsDataChange:"&",onLoadingStateUpdate:"&"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/addnetworking/pages/BindToPhysicalAdapterComponent.html"}return e}();e.BindToPhysicalAdapterComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.dataService=r,this.physicalAdaptersListService=n,this.physicalAdapterDetailsViewService=o,this.$element=a,this.bindToPhysicalAdapterService=s,this.pnicsDetailsData={},this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){var e=this;this.noItemsSelectedMessage=this.i18nService.getString("NetworkUi","PhysicalNicBindingEditor.detailsPrompt"),this.datagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],resizable:!0,selectedItems:[],onChange:this.onSelectionChange.bind(this),selectedPnic:null,onBindedPnicChange:function(){e.selectPnicRow()}},this.bindToPnic=this.bindToPnicEnabled,this.datagridOptions.selectedPnic=this.selectedPnicForBinding,this.availablePnicsData&&(this.datagridOptions.data=this.availablePnicsData),this.initPnicSelection=!0},e.prototype.selectPnic=function(e){this.datagridOptions.selectedPnic=e,this.onPnicSelectionChange({selectedPnic:e})},e.prototype.selectPnicRow=function(){var e=this;if(this.datagridOptions.selectedPnic){var t=this.$element.find("[kendo-grid]").data("kendoGrid");t&&t.items&&t.items().each(function(i,r){t.dataItem(r).device===e.datagridOptions.selectedPnic&&t.select(r)})}},e.prototype.$onChanges=function(e){this.bindToPnic&&e.availablePnicsData&&e.availablePnicsData.currentValue&&!e.availablePnicsData.isFirstChange()&&(this.datagridOptions.data=e.availablePnicsData.currentValue,this.updatePnicSelection())},e.prototype.bindToPnicChangeHandler=function(){var e=this;this.onBindToPnicChange({bindToPnic:this.bindToPnic}),this.bindToPnic&&(this.availablePnicsData?this.updatePnicSelection():(this.onLoadingStateUpdate({loading:!0}),this.opaqueNetworkRef?this.bindToPhysicalAdapterService.getDataByOpaqueNetworkRef(this.hostId,this.opaqueNetworkRef).then(function(t){e.updateAvailablePnicsData(t)})["finally"](function(){e.onLoadingStateUpdate({loading:!1})}):this.opaqueNetworkId&&this.opaqueNetworkType&&this.bindToPhysicalAdapterService.getDataByOpaqueNetworkSpec(this.hostId,this.opaqueNetworkId,this.opaqueNetworkType).then(function(t){e.updateAvailablePnicsData(t)})["finally"](function(){e.onLoadingStateUpdate({loading:!1})})))},e.prototype.onSelectionChange=function(e){var t=this,i=e&&e.length>0?e[0].device:null;null===i?this.detailsData=null:(this.selectPnic(i),this.pnicsDetailsData[i]?this.detailsData=this.physicalAdapterDetailsViewService.build(this.pnicsDetailsData[i]):this.physicalAdaptersListService.getPhysicalAdapterDetailsItem(this.hostId,i).then(function(e){t.pnicsDetailsData[i]=e,t.detailsData=t.physicalAdapterDetailsViewService.build(t.pnicsDetailsData[i])})),this.initPnicSelection&&(this.initPnicSelection=!1,this.selectPnicRow())},e.prototype.updatePnicSelection=function(){var e=null;this.selectedPnicForBinding?e=this.selectedPnicForBinding:this.availablePnicsData&&this.availablePnicsData.length>0&&(e=this.availablePnicsData[0].device),this.selectPnic(e),this.selectPnicRow()},e.prototype.updateAvailablePnicsData=function(e){this.onAvailablePnicsDataChange({availablePnicsData:e}),this.datagridOptions.data=e,e&&e.length&&(this.selectPnic(e[0].device),this.selectPnicRow())},e.prototype.getColumnDefinitions=function(){var e=this.columnRenderersRegistry.getColumnRenderer("icon-text");return[{width:"35px",template:function(e){return'<input type="radio" ng-model="datagridOptions.selectedPnic" \n                                 ng-change="datagridOptions.onBindedPnicChange()" \n                                 name="bindPnic" value="'+e.device+'">'}},{displayName:this.i18nService.getString("NetworkUi","PhysicalNicBindingEditor.pnicColumnHeader"),field:"device",template:function(t){var i={name:t.device,icon:"network-lib-ui-icon-physicalAdapter"};return e(["icon","name"],i)}}]},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry","dataService","physicalAdaptersListService","physicalAdapterDetailsViewService","$element","bindToPhysicalAdapterService"],e}();angular.module("com.vmware.vsphere.client.network").component("bindToPhysicalAdapterComponent",new t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i){var r="portgroup:hostStandardPortgroupInfo";e.connectionSettingsPageModel.isInitialized||(e.wizardConfig.loading=!0,t.getProperties(e.hostId,[r],{propertyParams:[{propertyName:r,parameterType:"java.lang.String",parameter:i.getString("NetworkUi","AddNetworkingWizard.vmNetwork")}]}).then(function(t){e.wizardConfig.loading=!1,t&&t[r]&&(e.addNetworkingSpec.networkLabel=t[r].uniquePortGroupName,e.connectionSettingsPageModel.vlanIds=t[r].vlanIds),e.connectionSettingsPageModel.isInitialized=!0}))}angular.module("com.vmware.vsphere.client.network").controller("ConnectionSettingsPageController",e),e.$inject=["$scope","dataService","i18nService"]}(),function(){"use strict";function e(e,t,i){function r(){return{connectees:e.vSwitchSpec.pnics,connecteesDetails:e.vSwitchSpec.pnicsDetails,labels:{active:t.getString("NetworkUi","FailoverOrderEditor.active"),standby:t.getString("NetworkUi","FailoverOrderEditor.standby"),unused:t.getString("NetworkUi","FailoverOrderEditor.unused")}}}return this.noItemsSelectedMessage=t.getString("NetworkUi","FailoverOrderEditor.detailsPrompt"),this.headerOptions={title:t.getString("NetworkUi","FailoverOrderEditor.failoverOrder")},"undefined"==typeof e.vSwitchSpec.pnics||null===e.vSwitchSpec.pnics?(e.vSwitchSpec.pnics={active:[],standby:[],unused:[],unclaimed:[]},i.getUnclaimedPhysicalAdapters(e.hostId).then(function(t){e.vSwitchSpec.pnics.unclaimed=t.unclaimed,e.vSwitchSpec.pnicsDetails=t.pnicDetails,this.failoverOrder=r()}.bind(this))):this.failoverOrder=r(),this}angular.module("com.vmware.vsphere.client.network").controller("CreateStandardSwitchPageController",e),e.$inject=["$scope","i18nService","physicalAdaptersListService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){var t="";e.addNetworkingSpec.isTcpIpStackSupported&&(t=e.addNetworkingSpec.netStackName.netStackInstanceKey),i.getProperties(e.hostId,[c],{propertyParams:[{propertyName:c,parameterType:"java.lang.String",parameter:t}]}).then(function(t){e.hostVnicIpRoutingInfo.value=t[c],s(e.hostVnicIpRoutingInfo.value)})["finally"](function(){e.wizardConfig.loading=!1})}function s(i){e.defaultGateway=i&&i.ipv4DefaultGateway?i.ipv4DefaultGateway:t.getString("NetworkUi","NetworkUtil.noData"),e.hostVnicIpRoutingInfo.isIpv4Set||(e.addNetworkingSpec.overrideGateway=!1,e.addNetworkingSpec.ipv4DefaultGateway=i.ipv4DefaultGateway,e.hostVnicIpRoutingInfo.isIpv4Set=!0),e.addNetworkingSpec.isTcpIpStackSupported?e.showDnsAddresses=e.addNetworkingSpec.netStackName.netStackInstanceKey===o.defaultNetStackKey:e.showDnsAddresses=!0,e.addNetworkingSpec.isGatewayFeatureSupported=i.isGatewayFeatureSupported,e.dnsAddresses=[],i&&i.dnsAddresses&&e.showDnsAddresses&&(e.dnsAddresses=_.filter(i.dnsAddresses,function(e){return r.isIpv4AddressValid(e)})),e.dnsAddresses.length<1&&(e.dnsAddresses=[t.getString("NetworkUi","NetworkUtil.noData")]),e.wizardConfig.loading=!1}var c="vnic:virtualAdapterIpRouting";return this.ipv4PropertyType=n.IPV4.IP_ADDRESS,this.subnetMaskPropertyType=n.IPV4.SUBNET_MASK,this.defaultIpv4GatewayPropertyType=n.IPV4.DEFAULT_GATEWAY,this.ipv4ValidationMessage=t.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.invalidIpAddress"),this.subnetMaskValidationMessage=t.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.invalidSubnetMask"),this.defaultGatewayValidationMessage=t.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.invalidDefaultGatewayAddress"),e.wizardConfig.loading=!0,e.hostVnicIpRoutingInfo.isIpv4Set?s(e.hostVnicIpRoutingInfo.value):a(),this}angular.module("com.vmware.vsphere.client.network").controller("Ipv4SettingsPageController",e),e.$inject=["$scope","i18nService","dataService","ipParserService","staticIpInputTypes","addNetworkingWizardConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(){var i="";e.addNetworkingSpec.isTcpIpStackSupported&&(i=e.addNetworkingSpec.netStackName.netStackInstanceKey);var r="vnic:virtualAdapterIpRouting";return t.getProperties(e.hostId,[r],{propertyParams:[{propertyName:r,parameterType:"java.lang.String",parameter:i}]}).then(function(t){e.hostVnicIpRoutingInfo.value=t[r]})}return this.defaultIpv6GatewayPropertyType=i.IPV6.DEFAULT_GATEWAY,this.initPage=function(){var t=e.hostVnicIpRoutingInfo.value;e.defaultGateway=t&&t.ipv6DefaultGateway?t.ipv6DefaultGateway:r.getString("NetworkUi","NetworkUtil.noData"),e.hostVnicIpRoutingInfo.isIpv6Set||(e.addNetworkingSpec.overrideIpv6Gateway=!1,e.addNetworkingSpec.ipv6DefaultGateway=t.ipv6DefaultGateway,e.hostVnicIpRoutingInfo.isIpv6Set=!0),e.addNetworkingSpec.isGatewayFeatureSupported=t.isGatewayFeatureSupported,this.listData={},this.listData.ipv6List=e.addNetworkingSpec.ipv6Addresses,this.listData.defaultGateway=t.ipv6DefaultGateway,this.listData.hostIpv6Addresses=t.hostIpv6Addresses}.bind(this),e.hostVnicIpRoutingInfo.isIpv6Set?this.initPage():n().then(function(){this.initPage()}.bind(this)),this}angular.module("com.vmware.vsphere.client.network").controller("Ipv6SettingsPageController",e),e.$inject=["$scope","dataService","staticIpInputTypes","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(t){e.addNetworkingSpec.mtuSelectTypes=[],t?(e.addNetworkingSpec.mtuSelectTypes.push({id:"getMtuFromSwitch",name:i.getString("H5NetworkUi","AddNetworkingWizard.conPropPage.mtuSelectTypes.getMtuFromSwitch")}),e.addNetworkingSpec.defaultMtu=t):e.addNetworkingSpec.defaultMtu=1500,e.addNetworkingSpec.mtuSelectTypes.push({id:"custom",name:i.getString("H5NetworkUi","AddNetworkingWizard.conPropPage.mtuSelectTypes.custom")}),e.addNetworkingSpec.mtuSelectedType||(e.addNetworkingSpec.mtuSelectedType=e.addNetworkingSpec.mtuSelectTypes[0]),e.addNetworkingSpec.mtu&&"custom"===e.addNetworkingSpec.mtuSelectedType.id||(e.addNetworkingSpec.mtu=e.addNetworkingSpec.defaultMtu)}function d(){r.getProperties(e.hostId,[m,p,g,h],{propertyParams:[{propertyName:m,parameterType:"java.lang.String",parameter:i.getString("NetworkUi","AddNetworkingWizard.vmkernel")}]}).then(function(t){t&&(t[m]&&(e.addNetworkingSpec.networkLabel=t[m].uniquePortGroupName,e.addNetworkingSpec.vlanIds=t[m].vlanIds),e.addNetworkingSpec.isIpv6Enabled=t[p],e.addNetworkingSpec.isTcpIpStackSupported=t[g],e.portPropertiesPageModel.netStackName||u(t[h]),e.wizardConfig.loading=!1)})}function u(t){e.addNetworkingSpec.isTcpIpStackSupported&&t&&(e.addNetworkingSpec.netStackName={},t.netStackItems&&t.netStackItems.length>0&&(e.addNetworkingSpec.netStackItems=[],t.netStackItems.forEach(function(t){var i={stackName:t.name,netStackInstanceKey:t.key};e.addNetworkingSpec.netStackItems.push(i),t.key===o.defaultNetStackKey&&(e.addNetworkingSpec.netStackName=i,e.portPropertiesPageModel.netStackName=i)})))}var p="config.network.ipV6Enabled",v="vnic:portgroupMtuData",m="portgroup:hostStandardPortgroupInfo",g="capability.multipleNetworkStackInstanceSupported",h="netstack:netStackData";if(e.addNetworkingWizardConstants=o,e.portPropertiesPageModel.ipSettingsType=e.portPropertiesPageModel.ipSettingsType||o.ipSettingsMode.IP_V4,e.wizardConfig.loading=!0,e.selectTargetNetworkPageModel.targetType===o.targetType.EXISTING_NETWORK){var f=[];if(e.addNetworkingSpec.selectedNetwork.isDistributedPortgroup){e.addNetworkingSpec.selectedNetwork.dvsName?e.addNetworkingSpec.networkLabel=i.getString("H5NetworkUi","VnicPortPropertiesPage.dvPortgroupFormat",e.addNetworkingSpec.selectedNetwork.name,e.addNetworkingSpec.selectedNetwork.dvsName):e.addNetworkingSpec.networkLabel=e.addNetworkingSpec.selectedNetwork.name,e.portPropertiesPageModel.existingNetworkGeneratedNetworkLabel=e.addNetworkingSpec.networkLabel;var S=n.getVsphereObjectId(e.addNetworkingSpec.selectedNetwork.networkRef),y=r.getProperties(S,[v]).then(function(e){l(e[v])});f.push(y)}else e.addNetworkingSpec.networkLabel=e.addNetworkingSpec.selectedNetwork.name,e.portPropertiesPageModel.existingNetworkGeneratedNetworkLabel=e.addNetworkingSpec.networkLabel,l();var P=r.getProperties(e.hostId,[p]).then(function(t){t&&(e.addNetworkingSpec.isIpv6Enabled=t[p])});if(!e.portPropertiesPageModel.netStackName){var C=r.getProperties(e.hostId,[g,h]).then(function(t){t&&(e.addNetworkingSpec.isTcpIpStackSupported=t[g],u(t[h]))});f.push(C)}f.push(P);var D=r.getProperties(e.hostId,[g]).then(function(t){t&&(e.addNetworkingSpec.isTcpIpStackSupported=t[g])});f.push(D),t.all(f).then(function(){e.wizardConfig.loading=!1})}else if(e.selectTargetNetworkPageModel.targetType){var w=e.portPropertiesPageModel.existingNetworkGeneratedNetworkLabel!==e.addNetworkingSpec.networkLabel&&null!==e.addNetworkingSpec.networkLabel;w?e.wizardConfig.loading=!1:d(),e.selectTargetNetworkPageModel.targetType===o.targetType.EXISTING_STANDARD_SWITCH?l(e.addNetworkingSpec.selectedStandardSwitch.mtu):e.selectTargetNetworkPageModel.targetType===o.targetType.NEW_STANDARD_SWITCH&&l(e.vSwitchSpec.mtu)}return e.portPropertiesPageModel.hostVnicFeatures||(e.addNetworkingSpec.vmkernelSettingsSpec={_type:"com.vmware.vsphere.client.modules.api.network.VmkernelSettingsSpec"},r.getData(e.hostId,"com.vmware.vsphere.client.h5.network.host.vnic.model.HostVnicServicesData").then(function(t){e.portPropertiesPageModel.hostVnicFeatures={},e.portPropertiesPageModel.hostVnicFeatures=_.pick(t.hostVnicFeatures,s.featureFlags.TCP_IP_STACK,s.featureFlags.PROVISIONING,s.featureFlags.VR,s.featureFlags.VR_NFC,s.featureFlags.VSAN);var i={};i[s.featureFlags.VMOTION_CONFIGURABLE]=t[s.options.VMOTION_ENABLED],i[s.featureFlags.PROVISIONING_CONFIGURABLE]=t[s.options.PROVISIONING_ENABLED],i[s.featureFlags.TCP_IP_STACK_DEFAULT]=!0,_.extend(e.portPropertiesPageModel.hostVnicFeatures,i);var r=c.getServiceSettings(e.portPropertiesPageModel.hostVnicFeatures);_.extend(e.addNetworkingSpec.vmkernelSettingsSpec,r)})),e.mtuValidator={message:i.getString("H5NetworkUi","AddNetworkingWizard.conPropPage.mtu.inputErrorMessage"),isVisible:!1},e.validateMtu=function(){e.mtuValidator.isVisible=!a.isMtuValid(e.addNetworkingSpec.mtu)},e.resetMtu=function(){e.addNetworkingSpec.mtu=e.addNetworkingSpec.defaultMtu,e.mtuValidator.isVisible=!a.isMtuValid(e.addNetworkingSpec.mtu)},e.setNetStackInstanceKey=function(){e.addNetworkingSpec.netStackItems.forEach(function(t){t.stackName===e.addNetworkingSpec.netStackName.stackName&&(e.addNetworkingSpec.netStackInstanceKey=t.netStackInstanceKey)}),e.portPropertiesPageModel.netStackName=e.addNetworkingSpec.netStackName;var t={};t[s.featureFlags.TCP_IP_STACK_DEFAULT]=e.addNetworkingSpec.netStackName.netStackInstanceKey===o.defaultNetStackKey,t[s.featureFlags.TCP_IP_STACK_PROVISIONING]=e.addNetworkingSpec.netStackName.netStackInstanceKey===o.provisioningNetStackKey,t[s.featureFlags.TCP_IP_STACK_VMOTION]=e.addNetworkingSpec.netStackName.netStackInstanceKey===o.vmotionNetStackKey,_.extend(e.portPropertiesPageModel.hostVnicFeatures,t),e.portPropertiesPageModel.hostVnicFeatures=_.clone(e.portPropertiesPageModel.hostVnicFeatures);var i=c.getServiceSettings(e.portPropertiesPageModel.hostVnicFeatures);_.extend(e.addNetworkingSpec.vmkernelSettingsSpec,i),e.hostVnicIpRoutingInfo.isIpv4Set=!1,e.hostVnicIpRoutingInfo.isIpv6Set=!1},this}angular.module("com.vmware.vsphere.client.network").controller("PortPropertiesPageController",e),e.$inject=["$scope","$q","i18nService","dataService","defaultUriSchemeUtil","addNetworkingWizardConstants","networkUtil","hostVnicServiceConstants","hostVnicServiceFactory"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){e.networkSelectorMode=r.SINGLE_SELECTION_BROWSE_INPUT,e.networkSelectorFilterSpec=n.createNetworkSelectorFilterSpec(!1,!0,!0,!1,!0),e.networkSelectorDialogSpec=n.createNetworkSelectorDialogSpec(["Network.Assign"],t.getString("NetworkUi","AddNetworkingWizard.conTargetPage.noDvpgPrivilegeMessage")),p.onSelectNetworks=function(t){var i=t[0];e.addNetworkingSpec.selectedNetwork=i,e.addNetworkingSpec.selectedNetwork.isDistributedPortgroup=!i.isStandardNetwork&&!i.isOpaqueNetwork&&!i.isUplink,e.selectTargetNetworkPageModel.isOpaqueNetworkSelected=i.isOpaqueNetwork,p.resetPortPropertiesValues()}}function l(){p.onSelectSwitch=function(){a.openSwitchSelectorDialog(e.hostId,e.selectConnectionTypePageModel.connectionType,null,e.selectTargetNetworkPageModel.retrieveAllSwitches,function(t){e.addNetworkingSpec.selectedStandardSwitch=t[0]})}}function d(){for(var e=[i.NumPorts.MIN];_.last(e)<i.NumPorts.MAX;)e.push(2*_.last(e));return e}function u(e,t,i){return e&&!t&&(e.type===o.switchType.STANDARD||i===o.connectionType.PNIC)}var p=this;return e.addNetworkingWizardConstants=o,c(),l(),e.portsNumbers=d(),"undefined"==typeof e.vSwitchSpec.numPorts&&(e.vSwitchSpec.numPorts=i.NumPorts.DEFAULT),"undefined"==typeof e.vSwitchSpec.mtu&&(e.vSwitchSpec.mtu=i.Mtu.DEFAULT),e.selectConnectionTypePageModel.connectionType===o.connectionType.PNIC?e.existingSwitchLabel=t.getString("NetworkUi","AddNetworkingWizard.conTargetPage.existingSwitchWithDvs"):e.existingSwitchLabel=t.getString("NetworkUi","AddNetworkingWizard.conTargetPage.existingSwitch"),u(e.preselectedSwitch,e.addNetworkingSpec.selectedStandardSwitch,e.selectConnectionTypePageModel.connectionType)&&(e.addNetworkingSpec.selectedStandardSwitch=e.preselectedSwitch,e.selectTargetNetworkPageModel.targetType=o.targetType.EXISTING_STANDARD_SWITCH),p.mtuValidator={message:t.getString("H5NetworkUi","AddNetworkingWizard.conPropPage.mtu.inputErrorMessage"),isVisible:!1},p.validateMtu=function(){p.mtuValidator.isVisible=!s.isMtuValid(e.vSwitchSpec.mtu)},p.showExistingNetwork=e.selectConnectionTypePageModel.connectionType===o.connectionType.VMKERNEL,p.resetPortPropertiesValues=function(){e.addNetworkingSpec&&(e.addNetworkingSpec.vlanId&&(e.addNetworkingSpec.vlanId=null),e.addNetworkingSpec.networkLabel&&(e.addNetworkingSpec.networkLabel=null),e.portPropertiesPageModel.existingNetworkGeneratedNetworkLabel&&(e.portPropertiesPageModel.existingNetworkGeneratedNetworkLabel=null),e.portPropertiesPageModel.netStackName&&(e.portPropertiesPageModel.netStackName=null),e.addNetworkingSpec.netStackName&&(e.addNetworkingSpec.netStackName=null),e.addNetworkingSpec.mtuSelectedType&&(e.addNetworkingSpec.mtuSelectedType=null),e.addNetworkingSpec.mtu&&(e.addNetworkingSpec.mtu=null),e.portPropertiesPageModel.hostVnicFeatures&&(e.portPropertiesPageModel.hostVnicFeatures=null),e.portPropertiesPageModel.hostVnicSettings&&(e.portPropertiesPageModel.hostVnicSettings=null))},this}angular.module("com.vmware.vsphere.client.network").controller("SelectTargetNetworkPageController",e),e.$inject=["$scope","i18nService","networkUiConstants","NetworkSelectorMode","networkSelectorDialogService","addNetworkingWizardConstants","switchSelectorDialogService","networkUtil"]}();var PnicBindingDataItem=com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.PnicBindingDataItem,network_ui;!function(e){var t=function(){function e(e){this.dataService=e,this.availablePnicsPropertyByRef="vnic:availablePnicsForBinding",this.availablePnicsPropertyBySpec="vnic:availablePnicsForBindingBySummary"}return e.prototype.getDataByOpaqueNetworkRef=function(e,t){var i=[];return i.push({propertyName:this.availablePnicsPropertyByRef,parameterType:"com.vmware.vim.binding.vmodl.ManagedObjectReference",parameter:t}),this.getData(e,this.availablePnicsPropertyByRef,i)},e.prototype.getDataByOpaqueNetworkSpec=function(e,t,i){var r=[];return r.push({propertyName:this.availablePnicsPropertyBySpec,parameterType:"java.util.Map",parameter:{opaqueNetworkId:t,opaqueNetworkType:i}}),this.getData(e,this.availablePnicsPropertyBySpec,r)},e.prototype.getData=function(e,t,i){return this.dataService.getProperties(e,[t],{propertyParams:i}).then(function(e){return e[t]})},e.$inject=["dataService"],e}();e.BindToPhysicalAdapterService=t,angular.module("com.vmware.vsphere.client.network").service("bindToPhysicalAdapterService",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t){function i(t){var i=[];return n(t)||("undefined"==typeof t.unclaimed||0===t.unclaimed.length?i.push(e.getString("NetworkUi","PhysicalNicFailoverOrderPage.error.noUnclaimedNics")):t.unclaimed.length>0&&i.push(e.getString("NetworkUi","PhysicalNicFailoverOrderPage.error.noNics"))),i}function r(t,i){var r,n=t.active;return a(t.active)?o(n,i)&&(r={},r.dialogTitle=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.allActiveNicsDisconnected.title"),r.warningMessage=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.allActiveNicsDisconnected.text")):(r={},r.dialogTitle=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.noActiveNics.title"),r.warningMessage=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.noActiveNics.text")),r}function n(e){if(!e.unclaimedInitial||0===e.unclaimedInitial.length)return!1;var t=_.some(e.active,function(t){return _.indexOf(e.unclaimedInitial,t)!==-1}),i=_.some(e.standby,function(t){return _.indexOf(e.unclaimedInitial,t)!==-1}),r=_.some(e.unused,function(t){return _.indexOf(e.unclaimedInitial,t)!==-1});return t||i||r}function o(e,t){return!_.some(e,function(e){if(null!==e&&t[e]&&t[e].isConnected)return!0})}function a(e){return e&&e.length>0}this.getValidationErrorsAndWarnings=function(e,n){var o=i(e),a=r(e,n);if(o&&o.length>0)return o;if(a){var s={title:a.dialogTitle,message:a.warningMessage,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0};return t.openConfirmationModal(s)}return!0}}angular.module("com.vmware.vsphere.client.network").service("addHostNetworkingAddPnicPageValidator",e),e.$inject=["i18nService","clarityModalService"]}(),function(){"use strict";function e(e,t){function i(e,t){return!_.some(e,function(e){if(e&&t[e]&&t[e].isConnected)return!0})}this.getValidationErrorsAndWarnings=function(r,n){var o=null,a=null,s=!1,c=r.active;if(c&&0!==c.length?i(c,n)&&(o=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.allActiveNicsDisconnected.title"),a=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.allActiveNicsDisconnected.text"),s=!0):(o=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.noActiveNics.title"),a=e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.noActiveNics.text"),s=!0),s){var l={title:o,message:a,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0};return t.openConfirmationModal(l)}return!0}}angular.module("com.vmware.vsphere.client.network").service("addHostNetworkingCreateStandardSwitchPageValidator",e),e.$inject=["i18nService","clarityModalService"]}(),function(){"use strict";function e(e){this.getValidationErrors=function(t){var i=[];return Object.keys(t).length||i.push(e.getString("NetworkUi","AddNetworkingWizard.physicalNicPage.error.noNics")),i}}angular.module("com.vmware.vsphere.client.network").service("addPnicToDvsPageValidator",e),e.$inject=["i18nService"]}();var network_ui;!function(e){var t=function(){function e(e){var t=this;this.i18nService=e,this.getValidationErrors=function(e,i){var r=[];return e&&!i&&r.push(t.i18nService.getString("NetworkUi","VnicToPnicBindingPage.error.noNic")),r}}return e.$inject=["i18nService"],e}();e.BindToPnicPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("bindToPnicPageValidator",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i){this.getValidationErrors=function(r,n,o){var a=[];return t.isVlanIdValid(o)||a.push(e.getString("NetworkUi","VnicData.invalidVlanId")),a=a.concat(i.getNetworkLabelClientSideValidationErrors(n)),0===a.length?i.getNetworkLabelServerSideValidationErrors(r,n):a}}angular.module("com.vmware.vsphere.client.network").service("connectionSettingsPageValidator",e),e.$inject=["i18nService","networkUtil","networkLabelValidator"]}(),function(){"use strict";function e(e,t,i){function r(e,t,r){var n={ipv4Address:t};return r&&(n.vnicName=r),i.validate(e,"com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.HostVnicIpv4SettingsSpec",n).then(function(e){var t=[];return e&&e.result&&t.push(e.result),t})}function n(i,r){var n=[];return i.isGatewayFeatureSupported&&i.overrideGateway?(i.ipv4DefaultGateway?t.isIpv4AddressValid(i.ipv4DefaultGateway.trim())?0!==r||t.isSameIpv4Subnet(i.ipv4DefaultGateway,i.ipv4Address,i.subnetMask)||n.push(e.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.invalidDefaultGateway")):n.push(e.getString("NetworkUi","VnicData.invalidGateway")):n.push(e.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.emptyDefaultGateway")),n):n}this.getValidationErrors=function(i){var o=[];if(!i.dhcpEnabled){var a=i.ipv4Address&&i.ipv4Address.trim();a?t.isIpv4AddressValid(a)||o.push(e.getString("NetworkUi","VnicData.invalidIPAddress")):o.push(e.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.emptyIpAddress"));var s=i.subnetMask&&i.subnetMask.trim();if(s?t.isSubnetMaskValid(s)||o.push(e.getString("NetworkUi","VnicData.invalidSubnet")):o.push(e.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.emptySubnetMask")),o=o.concat(n(i,o.length)),0===o.length)return r(i.hostId,a,i.vnicName)}return o}}angular.module("com.vmware.vsphere.client.network").service("ipv4SettingsPageValidator",e),e.$inject=["i18nService","ipParserService","mutationService"]}(),function(){"use strict";function e(e,t){this.getValidationErrors=function(i,r,n,o,a,s){var c=[];return n?(o||c.push(e.getString("NetworkUi","AddNetworkingWizard.ipv6Settings.noIpv6ManualAddressError")),a&&(t.isIpv6AddressValid(s)||c.push(e.getString("NetworkUi","Ipv6GatewayDialog.defaultGateway.error")),(i||r)&&c.push(e.getString("H5NetworkUi","VnicIpv6SettingsPage.invalidIpConfiguration")))):i||r||c.push(e.getString("NetworkUi","AddNetworkingWizard.ipv6Settings.noIpv6SettingsError")),c}}angular.module("com.vmware.vsphere.client.network").service("ipv6SettingsPageValidator",e),e.$inject=["i18nService","ipParserService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(n,o,a,s,c){var l=[];return r.isMtuValid(o)||l.push(e.getString("H5NetworkUi","AddNetworkingWizard.conPropPage.mtu.validationErrorMessage")),n!==i.targetType.EXISTING_STANDARD_SWITCH&&n!==i.targetType.NEW_STANDARD_SWITCH||(r.isVlanIdValid(a)||l.push(e.getString("NetworkUi","VnicData.invalidVlanId")),l=l.concat(t.getNetworkLabelClientSideValidationErrors(s)),0!==l.length)?l:t.getNetworkLabelServerSideValidationErrors(c,s)}function c(e,t){var r=e;if(r===i.vmotionNetStackKey||r===i.provisioningNetStackKey){var n=a.isSystemTrafficEnabledOnDefaultStack(e,t);return n}}function l(t){var r,n;return t===i.vmotionNetStackKey&&(r=e.getString("NetworkUi","NetStackInstanceSelector.vmotion.title"),n=e.getString("NetworkUi","NetStackInstanceSelector.vmotion.warning")),t===i.provisioningNetStackKey&&(r=e.getString("NetworkUi","NetStackInstanceSelector.provisioning.title"),n=e.getString("NetworkUi","NetStackInstanceSelector.provisioning.warning")),{warningTitle:r,warningMsg:n}}function d(e,t){var i=n.defer();return t.then(function(t){if(t&&t[p]){var r=e,n=l(r),a={title:n.warningTitle,message:n.warningMsg,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0,submit:function(){i.resolve(!0)},onCancel:function(){i.resolve(!1)}};o.openConfirmationModal(a)}else i.resolve(!0)}),i.promise}function u(e,t,i){return _.isArray(t)&&t.length>0?t:n.when(t).then(function(r){return r&&r.length>0?t:!i||d(e,i)})}var p="vnic:isSystemTrafficEnabled";this.getValidationErrorsAndWarnings=function(e,t,i,r,n,o,a){var l=s(i,o,r,t,e),d=c(a,e);return!l||u(a,l,d)}}angular.module("com.vmware.vsphere.client.network").service("portPropertiesPageValidator",e),e.$inject=["i18nService","networkLabelValidator","addNetworkingWizardConstants","networkUtil","$q","clarityModalService","tcpIpStackServicesValidator"]}(),function(){"use strict";function e(e,i,r,n){var o="host:uniqueStandardSwitchName";this.getValidationErrors=function(a){var s=[];if(a.selectTargetNetworkPageModel.targetType===n.targetType.EXISTING_NETWORK)a.addNetworkingSpec.selectedNetwork||s.push(e.getString("H5NetworkUi","AddNetworkingWizard.conTargetPage.noSelectedTargetError"));else if(a.selectTargetNetworkPageModel.targetType===n.targetType.EXISTING_STANDARD_SWITCH)a.addNetworkingSpec.selectedStandardSwitch||s.push(e.getString("NetworkUi","AddNetworkingWizard.conTargetPage.noSwitchTargetError"));else if(a.selectTargetNetworkPageModel.targetType===n.targetType.NEW_STANDARD_SWITCH)return r.isMtuValid(a.vSwitchSpec.mtu)||s.push(e.getString("H5NetworkUi","AddNetworkingWizard.conPropPage.mtu.validationErrorMessage")),
a.hostCapability.switchAutoScaleSupported!==!1||t(a.hostCapability,a.vSwitchSpec.numPorts)||s.push(e.getString("NetworkUi","AddNetworkingWizard.conTargetPage.availablePortsExceeded",a.hostCapability.availablePortsNumber)),0!==s.length?s:i.getProperties(a.hostId,[o]).then(function(e){return a.vSwitchSpec.name=e[o],[]});return s}}function t(e,t){return"undefined"!=typeof t&&e.availablePortsNumber>t}angular.module("com.vmware.vsphere.client.network").service("selectTargetNetworkPageValidator",e),e.$inject=["i18nService","dataService","networkUtil","addNetworkingWizardConstants"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.network").constant("hostVnicServiceConstants",{keys:{VMOTION:"isVmotionEnabled",PROVISIONING:"isProvisioningNfcTrafficEnabled",FT_LOGGING:"isFtEnabled",MANAGEMENT:"isHaEnabled",VR:"isVRTrafficEnabled",VR_NFC:"isVrNfcTrafficEnabled",VSAN:"isVsanEnabled"},featureFlags:{VMOTION_CONFIGURABLE:"isVmotionConfigurable",PROVISIONING_CONFIGURABLE:"isProvisioningConfigurable",PROVISIONING:"isProvisioningNfcTrafficSupported",VR:"isVrTrafficSupported",VR_NFC:"isVrNfcTrafficSupported",VSAN:"isVsanSupported",TCP_IP_STACK:"isTcpIpStackSupported",TCP_IP_STACK_DEFAULT:"isTcpIpStackTheDefaultOne",TCP_IP_STACK_PROVISIONING:"isTcpIpStackTheProvisioningOne",TCP_IP_STACK_VMOTION:"isTcpIpStackTheVmotionOne"},options:{VMOTION_ENABLED:"isVmotionTrafficEnabledForDefaultStack",PROVISIONING_ENABLED:"isProvisioningTrafficEnabledForDefaultStack"}})}(),function(){"use strict";function e(e,t){function i(e,i){var r=t.keys,n=t.featureFlags,o=e||{},l=i||{},d=!o[n.TCP_IP_STACK]||!!o[n.TCP_IP_STACK_DEFAULT],u=d&&!!o[n.VMOTION_CONFIGURABLE],p=d&&!!o[n.PROVISIONING_CONFIGURABLE],v={};return v[r.VMOTION]={includeInLayout:!0,isEnabled:u,label:c("VnicPortPropertiesPage.vMotion"),summaryLabel:c("AddNetworkingWizard.summary.vmotion"),tooltip:s(u,!!l[r.VMOTION],d)},v[r.PROVISIONING]={includeInLayout:!!o[n.PROVISIONING],isEnabled:p,label:c("VnicPortPropertiesPage.provisioningNfcTraffic"),summaryLabel:c("AddNetworkingWizard.summary.provisioningNfcTraffic"),tooltip:s(p,!!l[r.PROVISIONING],d)},v[r.FT_LOGGING]={includeInLayout:!0,isEnabled:d,label:c("VnicPortPropertiesPage.ftLogging"),summaryLabel:c("AddNetworkingWizard.summary.ftLogging"),tooltip:a(d,!!l[r.FT_LOGGING])},v[r.MANAGEMENT]={includeInLayout:!0,isEnabled:d,label:c("VnicPortPropertiesPage.mngTraffic"),summaryLabel:c("AddNetworkingWizard.summary.managementTraffic"),tooltip:a(d,!!l[r.MANAGEMENT])},v[r.VR]={includeInLayout:!!o[n.VR],isEnabled:d,label:c("VnicPortPropertiesPage.vRTraffic"),summaryLabel:c("AddNetworkingWizard.summary.vRTraffic"),tooltip:a(d,!!l[r.VR])},v[r.VR_NFC]={includeInLayout:!!o[n.VR_NFC],isEnabled:d,label:c("VnicPortPropertiesPage.vrNfcTraffic"),summaryLabel:c("AddNetworkingWizard.summary.vrNfcTraffic"),tooltip:a(d,!!l[r.VR_NFC])},v[r.VSAN]={includeInLayout:!!o[n.VSAN],isEnabled:d,label:c("VnicPortPropertiesPage.vsan"),summaryLabel:c("AddNetworkingWizard.summary.vsan"),tooltip:a(d,!!l[r.VSAN])},v}function r(e){var i=t.keys,r=t.featureFlags,n={};return n[i.FT_LOGGING]=!1,n[i.MANAGEMENT]=!1,e?(e[r.PROVISIONING]&&e[r.TCP_IP_STACK_PROVISIONING]?n[i.PROVISIONING]=!0:e[r.PROVISIONING]&&(n[i.PROVISIONING]=!1),e[r.TCP_IP_STACK_VMOTION]?n[i.VMOTION]=!0:n[i.VMOTION]=!1,e[r.VR]&&(n[i.VR]=!1),e[r.VR_NFC]&&(n[i.VR_NFC]=!1),e[r.VSAN]&&(n[i.VSAN]=!1),n):n}function n(e){var i=t.keys;return _.pick(e,i.VMOTION,i.PROVISIONING,i.FT_LOGGING,i.MANAGEMENT,i.VR,i.VR_NFC,i.VSAN)}function o(e){var i=t.featureFlags;return _.pick(e,i.VMOTION_CONFIGURABLE,i.PROVISIONING_CONFIGURABLE,i.PROVISIONING,i.FT_LOGGING,i.VR,i.VR_NFC,i.VSAN,i.TCP_IP_STACK,i.TCP_IP_STACK_DEFAULT,i.TCP_IP_STACK_PROVISIONING,i.TCP_IP_STACK_VMOTION)}function a(e,t){var i=!1;return s(e,t,i)}function s(e,t,i){if(e===!1){var r=c(i?"VnicPortPropertiesPage.cannotBeEnabledOnDefaultStackServiceTooltip":"VnicPortPropertiesPage.disabledUnCheckedServiceTooltip");return t?c("VnicPortPropertiesPage.disabledCheckedServiceTooltip"):r}return""}function c(t){return e.getString("NetworkUi",t)}return{getServiceDescriptions:i,getServiceSettings:r,pickServiceFeatures:o,pickServiceSettings:n}}angular.module("com.vmware.vsphere.client.network").factory("hostVnicServiceFactory",e),e.$inject=["i18nService","hostVnicServiceConstants"]}(),function(){"use strict";function e(){var e={restrict:"E",scope:{hostVnicFeatures:"=?",hostVnicSettings:"=?"},templateUrl:"network-ui/resources/network/views/host/common/hostVnicServices/hostVnicServices.html",controller:t};return e}function t(e,t,i){function r(e){return t.getString("NetworkUi",e)}e.getString=r,e.hostVnicSettings=e.hostVnicSettings||i.getServiceSettings(e.hostVnicFeatures),e.$watch("hostVnicFeatures",function(t){e.services=i.getServiceDescriptions(t,e.hostVnicSettings)})}angular.module("com.vmware.vsphere.client.network").directive("hostVnicServices",e),e.$inject=[],t.$inject=["$scope","i18nService","hostVnicServiceFactory"]}();var network_ui;!function(e){var t=function(){function e(){this.bindings={listData:"<",isEnabled:"<"},this.controller=n,this.templateUrl="network-ui/resources/network/views/host/common/ipv6List/ipv6List.html"}return e}();e.Ipv6ListComponent=t;var i=function(){function e(){}return e}();e.Ipv6ListData=i;var r=function(){function e(){}return e}();e.Ipv6ListItem=r;var n=function(){function e(e,t,i,r,n){this.$scope=e,this.vuiConstants=t,this.i18nService=i,this.networkUiConstants=r,this.ipv6DialogService=n,this.datagridOptions=this.createDatagridOptions()}return e.prototype.$onInit=function(){var e=this;this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t){e.updateActionBar(t.length)})},e.prototype.$onChanges=function(){this.datagridOptions&&this.listData&&(this.datagridOptions.data=this.listData.ipv6List||[],this.updateActionBar(this.datagridOptions.selectedItems.length))},e.prototype.createDatagridOptions=function(){return{height:"100%",pageConfig:{hidePager:!0},columnDefs:this.initializeColumnDefs(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:[],selectedItems:[],actionBarOptions:{actions:this.initializeActions()}}},e.prototype.initializeColumnDefs=function(){return[{displayName:this.i18nService.getString("NetworkUi","VnicIpv6SettingsPage.ipv6Address"),field:"address",template:"#:address#"},{displayName:this.i18nService.getString("NetworkUi","VnicIpv6SettingsPage.prefixLength"),field:"prefixLength",template:"#:prefixLength#"}]},e.prototype.initializeActions=function(){return[{actionId:this.networkUiConstants.DatagridActions.ADD,enabled:this.isEnabled,visible:!0,iconClass:"vsphere-icon-add",onClick:this.openAddIpv6Dialog.bind(this)},this.vuiConstants.actions.SEPARATOR,{actionId:this.networkUiConstants.DatagridActions.EDIT,enabled:!1,visible:!0,iconClass:"vsphere-icon-toolbar-edit",onClick:this.openEditIpv6Dialog.bind(this)},{actionId:this.networkUiConstants.DatagridActions.DELETE,enabled:!1,visible:!0,iconClass:"vsphere-icon-toolbar-remove",onClick:this.removeSelectedItem.bind(this)}]},e.prototype.updateActionBar=function(e){var t=this;_.each(this.datagridOptions.actionBarOptions.actions,function(i){i.actionId===t.networkUiConstants.DatagridActions.EDIT||i.actionId===t.networkUiConstants.DatagridActions.DELETE?i.enabled=!!t.isEnabled&&e>0:i.actionId===t.networkUiConstants.DatagridActions.ADD&&(i.enabled=!!t.isEnabled)})},e.prototype.removeSelectedItem=function(){var e=this.indexOfSelectedAddress();this.listData.ipv6List.splice(e,1),this.datagridOptions.data=this.listData.ipv6List.slice()},e.prototype.openAddIpv6Dialog=function(){var e={};e.defaultGateway=this.listData.defaultGateway,this.ipv6DialogService.openIpv6AddressesDialog(this.i18nService.getString("NetworkUi","Ipv6AddressPage.addTitle"),e,this.createUsedAddressInfo(),this.addOkHandler.bind(this))},e.prototype.openEditIpv6Dialog=function(){var e={};e.address=this.datagridOptions.selectedItems[0].address,e.prefixLength=this.datagridOptions.selectedItems[0].prefixLength,e.defaultGateway=this.listData.defaultGateway,this.ipv6DialogService.openIpv6AddressesDialog(this.i18nService.getString("NetworkUi","Ipv6AddressPage.editTitle"),e,this.createUsedAddressInfo(),this.editOkHandler.bind(this))},e.prototype.addOkHandler=function(e){var t=new r;t.address=e.address,t.prefixLength=e.prefixLength,this.listData.ipv6List.push(t),this.datagridOptions.data=this.listData.ipv6List.slice()},e.prototype.editOkHandler=function(e){var t=this.indexOfSelectedAddress();this.listData.ipv6List[t].address=e.address,this.listData.ipv6List[t].prefixLength=e.prefixLength,this.datagridOptions.data=this.listData.ipv6List.slice()},e.prototype.indexOfSelectedAddress=function(){var e=-1;if(this.datagridOptions.selectedItems&&1===this.datagridOptions.selectedItems.length){var t=this.datagridOptions.selectedItems[0];_.forEach(this.listData.ipv6List,function(i,r){i.address===t.address&&(e=r)})}return e},e.prototype.createUsedAddressInfo=function(){var e={};return e.hostAddresses=this.listData.hostIpv6Addresses,e.vmknicAddresses=this.getVmnicAddressesInUse(),e},e.prototype.getVmnicAddressesInUse=function(){return _.map(this.listData.ipv6List,function(e){return e.address})},e.$inject=["$scope","vuiConstants","i18nService","networkUiConstants","ipv6DialogService"],e}();angular.module("com.vmware.vsphere.client.network").component("ipv6List",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",onSubmitWrapper:"="},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/editIpv6SupportTemplate.html"}return e}();e.EditIpv6SupportComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.dataService=t,this.$scope=i,this.$q=r,this.mutationService=n,this.atBootIpV6EnabledProperty="config.network.atBootIpV6Enabled",this.ipv6EnabledProperty="config.network.ipV6Enabled",this.supportStateLabel=e.getString("NetworkUi","IPv6SupportView.ipv6SupportedDialogTitle"),this.buttonLabel=e.getString("NetworkUi","IPv6SupportView.enableIPv6SupportButtonLabel"),this.changeLabel=e.getString("NetworkUi","IPv6SupportView.changeLabel")}return e.prototype.$onInit=function(){var e=this;this.onSubmitWrapper&&(this.onSubmitWrapper.submit=this.submit.bind(this)),this.dataService.getProperties(this.hostId,[this.atBootIpV6EnabledProperty,this.ipv6EnabledProperty]).then(function(t){e.savedSupportState=t[e.atBootIpV6EnabledProperty];var i=t[e.ipv6EnabledProperty]!==e.savedSupportState,r=e.i18nService.getString("NetworkUi","IPv6SupportView.enabled"),n=e.i18nService.getString("NetworkUi","IPv6SupportView.disabled");e.supportStateValueLabel=i?e.savedSupportState?n:r:e.savedSupportState?r:n,e.supportButtonState=e.savedSupportState})},e.prototype.submit=function(){if(this.savedSupportState!==this.supportButtonState){var e={_type:"com.vmware.vsphere.client.network.NetworkConfigSpec",config:{_type:"com.vmware.vim.binding.vim.host.NetworkConfig",ipV6Enabled:this.supportButtonState}};this.mutationService.apply(this.hostId,e._type,e)}return!0},e.$inject=["i18nService","dataService","$scope","$q","mutationService"],e}();angular.module("com.vmware.vsphere.client.network").component("editIpv6Support",new t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(e,i,o,a){function d(){var e,t=i&&i.address!==p.dialogData.newIpv6Address.address;return t&&(e=s(p.dialogData.newIpv6Address.address,o)),e||(e=c(p.dialogData.newIpv6Address.prefixLength)),e?(l(e,p),!1):(a&&a(p.dialogData.newIpv6Address),!0)}var u={address:i&&i.address?i.address:"",prefixLength:i&&i.prefixLength?i.prefixLength:n.Ipv6PrefixLength.DEFAULT,defaultGateway:i&&i.defaultGateway?i.defaultGateway:r.getString("NetworkUi","NetworkUtil.noData")},p={title:e,defaultButton:"submit",size:"lg",alerts:[],dialogData:{newIpv6Address:u},contentTemplate:"network-ui/resources/network/views/host/ipv6Address/ipv6Dialog.html",onSubmit:d};t.openOkCancelModal(p)}function s(e,t){var i="::",n="::1";if(!o.isIpv6AddressValid(e)||o.equalIpv6Addresses(e,i)||o.equalIpv6Addresses(e,n))return r.getString("NetworkUi","Ipv6AddressPage.invalidIpAddressError");if(u(e,t.vmknicAddresses))return r.getString("NetworkUi","Ipv6AddressPage.duplicateIpv6AddressNewVnicError",e);var a=d(e,t.hostAddresses);return null!==a?r.getString("NetworkUi","Ipv6AddressPage.duplicateIpv6AddressDvsError",e,a):void 0}function c(e){if(!o.isSubnetPrefixValid(e))return r.getString("NetworkUi","Ipv6AddressPage.invalidPrefixError")}function l(e,t){t.alerts=[{text:e,type:i.notifications.type.ERROR}]}function d(e,t){var i=null;return _.forEach(t,function(t,r){u(e,t)&&(i=r)}),i}function u(e,t){return _.some(t,function(t){return o.equalIpv6Addresses(t,e)})}return{openIpv6AddressesDialog:a}}angular.module("com.vmware.vsphere.client.network").service("ipv6DialogService",e),e.$inject=["$rootScope","clarityModalService","clarityConstants","i18nService","networkUiConstants","ipParserService"]}();var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",iscsiHbaName:"<",onSubmitWrapper:"="},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/iscsi/add/IscsiAddPortBinding.html"}return e}();e.IscsiAddPortBinding=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.iscsiPortBindingService=t,this.$q=i,this.vuiConstants=r,this._iscsiPortBindingCandidatesData={items:[]},this.selectedPortGroups=[],this.loading=!1}return e.prototype.$onInit=function(){this.onSubmitWrapper&&(this.onSubmitWrapper.submit=this.submit.bind(this));var e=this;e.splitterOptions={orientation:e.vuiConstants.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"50%"},{min:"150px",size:"50%"}]},this.loading=!0,this.iscsiPortBindingService.getCandidateIscsiPortInfoData(this.hostId,this.iscsiHbaName).then(function(t){t&&(e._iscsiPortBindingCandidatesData=t)})["finally"](function(){e.loading=!1})},Object.defineProperty(e.prototype,"candidateIscsiPortBindingItem",{get:function(){return this.selectedPortGroups&&1===this.selectedPortGroups.length?this.selectedPortGroups[0]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"noDetailsMessage",{get:function(){return this.selectedPortGroups&&this.selectedPortGroups.length>1?this.i18nService.getString("Common","ListPreviewSplitView.multipleItemsSelected"):this.i18nService.getString("Common","ListPreviewSplitView.noItemsSelected")},enumerable:!0,configurable:!0}),e.prototype.submit=function(e){var t={isSuccessful:!0,errors:[]};if(!this.selectedPortGroups||!this.selectedPortGroups.length)return t.isSuccessful=!1,t.errors.push(this.i18nService.getString("NetworkUi","portbinding.addForm.notSelected")),this.$q.when(t);var i=this.iscsiPortBindingService.addCandidateIscsiPortInfo(this.hostId,this.iscsiHbaName,this.selectedPortGroups);return e&&i.then(e),this.$q.when(t)},Object.defineProperty(e.prototype,"iscsiPortBindingCandidatesData",{get:function(){return this._iscsiPortBindingCandidatesData},enumerable:!0,configurable:!0}),e.$inject=["i18nService","iscsiPortBindingService","$q","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.network").component("iscsiAddPortBinding",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={candidatePortGroupsData:"<",selectedPortGroups:"=?"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/iscsi/add/IscsiAddPortBindingCandidatesList.html"}return e}();e.IscsiAddPortBindingCandidatesList=t;var i=function(){function e(e,t,i,r,n){this.$scope=e,this.i18nService=t,this.iscsiPortBindingService=i,this.vuiConstants=r,this.columnRenderersRegistry=n}return e.prototype.$onInit=function(){this.datagridOptions={height:"100%",pageConfig:{hidePager:!1},columnDefs:this.getColumnDefs(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,selectedItems:[],resizable:!0,actionBarOptions:{actions:[]},isItemDisabledCallback:function(e){return!e.isCompliant}},this.candidatePortGroupsData&&this.initGridData();var e=this;this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t===i||_.isEqual(t,i)||(e.selectedPortGroups=t)})},e.prototype.$onChanges=function(e){this.datagridOptions&&e.candidatePortGroupsData&&this.initGridData()},e.prototype.getColumnDefs=function(){var e=this.columnRenderersRegistry.getColumnRenderer("icon-text"),t=this.columnRenderersRegistry.getColumnRenderer("text"),i=function(i){return i.icon?e(["icon","label"],i):t(["label"],i)};return[{displayName:this.i18nService.getString("NetworkUi","portbinding.list.portgroup.label"),field:"portgroupName.label",width:"180px",template:function(e){return i(e.portgroupName)}},{displayName:this.i18nService.getString("NetworkUi","portbinding.list.vMKernel.label"),field:"vmKernelAdapter.label",width:"180px",template:function(e){return i(e.vmKernelAdapter)}},{displayName:this.i18nService.getString("NetworkUi","portbinding.list.physicalNetworkAdapter.label"),field:"physicalNetworkAdapterInfo.label",width:"180px",template:function(e){return i(e.physicalNetworkAdapterInfo)}}]},e.prototype.initGridData=function(){this.datagridOptions.data=this.candidatePortGroupsData.items},e.$inject=["$scope","i18nService","iscsiPortBindingService","vuiConstants","columnRenderersRegistry"],e}();angular.module("com.vmware.vsphere.client.network").component("iscsiAddPortBindingCandidatesList",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i){this.$rootScope=e,this.clarityModalService=t,this.i18nService=i}return e.prototype.show=function(e,t){if(e&&t){var i=this.$rootScope.$new();i.modalOptions={contentUrl:"network-ui/resources/network/views/host/iscsi/details/IscsiPortBindingDetailsDialog.html",title:this.i18nService.getString("H5NetworkUi","portbinding.detailsDialog.title",t.vnicDevice),size:"lg",dialogData:{hostId:e,iscsiPortBindingItem:t}},this.clarityModalService.openPopUp(i)}},e.$inject=["$rootScope","clarityModalService","i18nService"],e}();e.IscsiPortBindingDetailsDialogService=t,angular.module("com.vmware.vsphere.client.network").service("iscsiPortBindingDetailsDialogService",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",iscsiPortBindingItem:"<",isBoundPortBinding:"<",detailsRetriever:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/iscsi/details/IscsiPortBindingDetailsTab.html"}return e}();e.IscsiPortBindingDetailsTab=t;var i=function(){function e(e){this.i18nService=e,this.loading=!1,this.i18n=e.getString}return e.prototype.$onChanges=function(){this.populatePropertyData()},e.prototype.populatePropertyData=function(){var e=this;if(!e.hostId||!e.iscsiPortBindingItem||!e.detailsRetriever)return e.loading=!1,void(e.noDetailsAvailable=!0);e.loading=!0,e.noDetailsAvailable=!0;var t=e.detailsRetriever.retrieveData(e.hostId,e.iscsiPortBindingItem,e.isBoundPortBinding);e._lastDataRequest=t,t.then(function(i){t===e._lastDataRequest&&i&&i.propertiesData&&(e.propertiesData=i.propertiesData,e.header=i.viewTitle,e.noDetailsAvailable=!1)})["finally"](function(){t===e._lastDataRequest&&(e.loading=!1)})},e.$inject=["i18nService","physicalAdaptersListService","physicalAdapterDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.network").component("iscsiPortBindingDetailsTab",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=e.IscsiPortBindingDetailsViewDataRetriever,i=function(){function e(){this.bindings={hostId:"<",iscsiPortBindingItem:"<",isBoundPortBinding:"<"},this.controller=r,this.templateUrl="network-ui/resources/network/views/host/iscsi/details/IscsiPortBindingDetailsView.html"}return e}();e.IscsiPortBindingDetailsView=i;var r=function(){function e(e,i){this.i18nService=e,this.iscsiPortBindingDetailsService=i,this.i18n=e.getString,this.portGroupDetailsRetriever=new t(i.requestPortgroupDetailsViewData.bind(i)),this.pnicDetailsRetriever=new t(i.requestPnicDetailsViewData.bind(i)),this.vnicDetailsRetriever=new t(i.requestVnicDetailsViewData.bind(i)),this.switchDetailsRetriever=new t(i.requestSwitchDetailsViewData.bind(i))}return e.$inject=["i18nService","iscsiPortBindingDetailsService"],e}();angular.module("com.vmware.vsphere.client.network").component("iscsiPortBindingDetailsView",new i)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",iscsiPortBindingItem:"<",isBoundPortBinding:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/iscsi/details/IscsiPortBindingDetailsTab.html"}return e}();e.IscsiPortBindingStatusDetailsView=t;var i=function(){function e(e,t){this.i18nService=e,this.vxPropertyViewService=t,this.loading=!1,this.i18n=e.getString}return e.prototype.$onChanges=function(){this.populatePropertyData()},e.prototype.populatePropertyData=function(){if(!this.iscsiPortBindingItem)return void(this.noDetailsAvailable=!0);var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("general"),i=t.section("generalSection");this.addPropertyValue(i,this.i18nService.getString("NetworkUi","portbinding.portGroupPolicyCompliance"),this.iscsiPortBindingItem.policyComplianceStatus),this.addComplianceErrors(i),this.isBoundPortBinding&&this.addPropertyValue(i,this.i18nService.getString("NetworkUi","portbinding.pathStatus"),this.iscsiPortBindingItem.pathStatus),this.propertiesData=e.build(),this.noDetailsAvailable=!1},e.prototype.addComplianceErrors=function(e){this.iscsiPortBindingItem.isCompliant||(this.isBoundPortBinding||this.iscsiPortBindingItem.vnicDevice&&this.iscsiPortBindingItem.pnicDevice?_.forEach(this.iscsiPortBindingItem.complianceErrors,function(t){e.warning(t.localizedMessage||t.message)}):e.messageBuilder().text(this.i18nService.getString("NetworkUi","portbinding.pnicNotAssociatedToVnicMessage")).icon("vsphere-icon-status-warning").renderAsHtml(!0))},e.prototype.addPropertyValue=function(e,t,i){return e.propertyBuilder().keyBuilder().text(t).exit().valueBuilder().icon(i.icon).text(i.label).exit().exit()},e.$inject=["i18nService","vxPropertyViewService"],e}();angular.module("com.vmware.vsphere.client.network").component("iscsiPortBindingStatusDetailsView",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",iscsiHba:"<",adapterWarnings:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/iscsi/IscsiPortBindingList.html"}return e}();e.IscsiPortBindingList=t;var i=function(){function e(e,t,i,r,n,o,a){this.iscsiPortBindingService=t,this.vuiConstants=i,this.columnRenderersRegistry=r,this.datagridActionBarService=n,this.$scope=o,this.networkUiConstants=a,this.i18n=e.getString,this.loading=!1,this.noPermissions=!1}return e.prototype.$onInit=function(){var e=this;this.datagridOptions={height:"100%",pageConfig:{hidePager:!0},columnDefs:this.getColumnDefs(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,selectedItems:[],resizable:!0,actionBarOptions:{actions:[]}},this.updateActionBar(),this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t===i||_.isEqual(t,i)||(e.$scope.cachedItems=t,e.updateActionBar())}),this.$scope.comparator=function(t){var i=_.find(e.$scope.cachedItems,function(e){return e.pnicDevice===t.pnicDevice&&e.vnicDevice===t.vnicDevice&&e.switchName===t.switchName});return void 0!==i}},e.prototype.$onChanges=function(){this.requestData()},e.prototype.requestData=function(){var e=this;e.hostId&&e.iscsiHba&&e.iscsiHba.device&&(e.loading=!0,e.iscsiPortBindingService.getBoundIscsiPortInfoData(e.hostId,e.iscsiHba.device).then(function(t){t&&(e.noPermissions=!t.hasPrivileges,e.datagridOptions.data=t.items)})["finally"](function(){e.loading=!1}))},e.prototype.getColumnDefs=function(){var e=this.columnRenderersRegistry.getColumnRenderer("icon-text"),t=this.columnRenderersRegistry.getColumnRenderer("text"),i=function(i){return i.icon?e(["icon","label"],i):t(["label"],i)};return[{displayName:this.i18n("NetworkUi","portbinding.list.portgroup.label"),field:"portgroupName.label",width:"180px",template:function(e){return i(e.portgroupName)}},{displayName:this.i18n("NetworkUi","portbinding.list.vMKernel.label"),field:"vmKernelAdapter.label",width:"180px",template:function(e){return i(e.vmKernelAdapter)}},{displayName:this.i18n("NetworkUi","portbinding.list.portgroupPolicy.label"),field:"policyComplianceStatus.label",width:"180px",template:function(e){return i(e.policyComplianceStatus)}},{displayName:this.i18n("NetworkUi","portbinding.list.pathStatus.label"),field:"pathStatus.label",width:"180px",template:function(e){return i(e.pathStatus)}},{displayName:this.i18n("NetworkUi","portbinding.list.physicalNetworkAdapter.label"),field:"physicalNetworkAdapterInfo.label",width:"180px",template:function(e){return i(e.physicalNetworkAdapterInfo)}}]},e.prototype.getActionDefs=function(){var e=this,t=this;return[{actionId:t.networkUiConstants.actions.ADD_PORT_BINDING_FOR_ISCSI,getActionInvocationContext:function(){return{iscsiHbaName:t.iscsiHba.device,onSuccessCallback:e.onOperationCompleted.bind(t,t.iscsiHba.key,t.iscsiHba.device)}}},{actionId:t.networkUiConstants.actions.REMOVE_PORT_BINDING_FROM_ISCSI,getActionInvocationContext:function(){return{iscsiHbaName:t.iscsiHba.device,adapters:t.datagridOptions.data,selectedAdapters:t.datagridOptions.selectedItems,onSuccessCallback:e.onOperationCompleted.bind(t,t.iscsiHba.key,t.iscsiHba.device)}},isActionAvailable:function(e){return e.available&&0!==t.datagridOptions.selectedItems.length}},{actionId:t.networkUiConstants.actions.SHOW_ISCSI_PORT_BINDING_DETAILS,isActionAvailable:function(e){return e.available&&t.datagridOptions.selectedItems&&1===t.datagridOptions.selectedItems.length},getActionInvocationContext:function(){return{iscsiPortInfoItem:t.datagridOptions.selectedItems[0]}}}]},e.prototype.updateActionBar=function(){this.datagridActionBarService.updateActionBar(this.datagridOptions,[this.hostId],this.getActionDefs())},e.prototype.onOperationCompleted=function(e,t,i){i&&!i.error&&this.adapterWarnings.addRescanMessage(e,t),this.requestData()},e.$inject=["i18nService","iscsiPortBindingService","vuiConstants","columnRenderersRegistry","datagridActionBarService","$scope","networkUiConstants"],e}();angular.module("com.vmware.vsphere.client.network").component("iscsiPortBindingList",new t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t){this.i18n=e.getString,this.hostId=t.getRoute().objectId}angular.module("com.vmware.vsphere.client.network").controller("IscsiPortBindingViewController",e),e.$inject=["i18nService","navigation"]}();var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.host.migratevmkadapter.model.DestinationStandardPortGroupInitialInfo,i=function(){function e(){this.bindings={model:"<"},this.templateUrl="network-ui/resources/network/views/host/migratevmkadapter/components/configureSettingsPageTemplate.html",this.controller=r}return e}();e.ConfigureSettingsComponent=i;var r=function(){function e(e,t,i,r){this.dataService=e,this.i18nService=t,this.vxValidatorFactory=i,this.networkLabelValidator=r,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.validator=this.vxValidatorFactory.create(),this.validateNetworkLabel=this.newNetworkLabelValidator.bind(this),this.model.newNetworkName&&this.model.vlanId&&this.model.vlanIds||this.initSettingsFields()},e.prototype.initSettingsFields=function(){var i=this;this.configSettingsLoading=!0;var r={};r.portGroupUniquePreffix=this.i18nService.getString("NetworkUi","AddNetworkingWizard.vmkernel"),r.vmkDevice=this.model.selectedVmkAdapter;var n=new t,o=this.dataService.getProperties(this.model.hostId,[e.HOST_STANDARD_PORT_GROUP_INFO_PROPERTY],{propertyParams:[{propertyName:e.HOST_STANDARD_PORT_GROUP_INFO_PROPERTY,parameterType:n._type,parameter:r}]});o.then(function(t){t&&(i.model.newNetworkName||(i.model.newNetworkName=t[e.HOST_STANDARD_PORT_GROUP_INFO_PROPERTY].networkLabel),i.model.vlanIds||(i.model.vlanIds=t[e.HOST_STANDARD_PORT_GROUP_INFO_PROPERTY].vlanIds),i.model.vlanId||(i.model.vlanId=t[e.HOST_STANDARD_PORT_GROUP_INFO_PROPERTY].sourcePortGroupVlanId)),i.configSettingsLoading=!1})},e.prototype.newNetworkLabelValidator=function(){var e=this.networkLabelValidator.getNetworkLabelClientSideValidationErrors(this.model.newNetworkName);return 0===e.length&&(e=this.networkLabelValidator.getNetworkLabelServerSideValidationErrors(this.model.newNetworkName,this.model.hostId)),e},e.HOST_STANDARD_PORT_GROUP_INFO_PROPERTY="vmkmigratewizard:standardPortGroupInfo",e.$inject=["dataService","i18nService","vxValidatorFactory","networkLabelValidator"],e}();angular.module("com.vmware.vsphere.client.network").component("configureSettingsPage",new i)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/migratevmkadapter/components/readyToCompletePageTemplate.html"}return e}();e.ReadyToCompleteMigarteVmkPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.propertyViewService=t,this.networkUtil=i}return e.prototype.$onInit=function(){this.buildProperties()},e.prototype.buildProperties=function(){var e=this.propertyViewService.createPropertyViewBuilder(),t=e.category("general"),i=t.section("generalSection");i.property(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.nic.vmkernel"),this.model.selectedVmkAdapter);var r=t.section("currentSettings");r.title(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.currentDetails")),r.property(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.currentSwitch"),this.model.sourceSwitchName),r.property(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.currentPortGroup"),this.model.sourceNetworkName);var n=t.section("targetSettings");n.title(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.newDetails")),n.property(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.newSwitch"),this.model.targetStandardSwitch),n.property(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.newPortGroup"),this.model.newNetworkName),n.property(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.newVlan"),this.networkUtil.formatVlanId(this.model.vlanId)),this.summaryData=e.build()},e.$inject=["i18nService","vxPropertyViewService","networkUtil"],e}();angular.module("com.vmware.vsphere.client.network").component("readyToCompleteMigarteVmkPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={model:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/migratevmkadapter/components/selectVmkAdaptersToMigratePageTemplate.html"}return e}();e.SelectVmkAdaptersToMigratePageComponent=t;var i=function(){function e(e,t,i,r,n){var o=this;this.$scope=e,this.$rootScope=t,this.vuiConstants=i,this.vmKernelAdapterService=r,this.migrateVmkWizardConstants=n,this.virtualAdaptersDataProperty="vnic:virtualAdaptersData",this.preselectComparator=function(e){return!!o.model.selectedVmkAdapter&&o.model.selectedVmkAdapter===e.device},this.$scope.hostUri=this.$rootScope._route.objectId,this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{min:"125px",size:"60%"},{min:"225px",size:"40%"}]}}return e.prototype.$onInit=function(){this.getVnicsDataGridData()},e.prototype.getVnicsDataGridData=function(){var e=this;this.vmkernelAdaptersLoading=!0;var t=!1,i=this.vmKernelAdapterService.getVnics(this.$scope.hostUri,t);i.then(function(t){var i=t[e.virtualAdaptersDataProperty]?t[e.virtualAdaptersDataProperty].items:[],r=_.filter(i,function(t){return t.virtualSwitch!==e.model.targetStandardSwitch;
});e.datagridOptions?e.datagridOptions.data=i:e.datagridOptions=e.createDatagridOptions(r,t.vnicColumnDefs),e.ingnoreVmkDeviceItemSelection=!0,e.vmkernelAdaptersLoading=!1})},e.prototype.createDatagridOptions=function(e,t){var i={height:"100%",pageConfig:{hidePager:!0},columnDefs:t,sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,data:e,selectedItems:[],resizable:!0,filterable:!1,searchable:!1,actionBarOptions:{actions:[]},onChange:this.onSelectionChange.bind(this)};return i},e.prototype.onSelectionChange=function(e){return this.model.selectedVmkAdapter&&this.ingnoreVmkDeviceItemSelection?void(this.ingnoreVmkDeviceItemSelection=!1):(e&&e.length>0?(this.$scope.selectedVmkDevice=e[0].device,this.model.selectedVmkAdapter!==e[0].device&&(this.model.sourceNetworkName=e[0].networkLabel,this.model.sourceSwitchName=e[0].virtualSwitch,e[0].dvPortGroupVlanId?this.model.vlanId=e[0].dvPortGroupVlanId:this.model.vlanId="0",e[0].connectedTo===this.migrateVmkWizardConstants.connectedToStandardSwitch&&(this.model.networkNameToRemove=e[0].networkLabel))):this.$scope.selectedVmkDevice=null,void(this.model.selectedVmkAdapter=this.$scope.selectedVmkDevice))},e.$inject=["$scope","$rootScope","vuiConstants","vmKernelAdapterService","migrateVmkWizardConstants"],e}();angular.module("com.vmware.vsphere.client.network").component("selectVmkAdapterToMigratePage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){}return e}();e.MigrateVmkToVssWizardModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.host.migratevmkadapter.model.MigrateVmkToVssSpec,i=function(){function i(e,t,i,r,n,o,a,s,c){this.$rootScope=e,this.i18nService=t,this.migrateVmkWizardPages=i,this.wizardValidationService=r,this.pageStateManagementService=n,this.defaultUriSchemeUtil=o,this.vuiWizardService=a,this.dataService=s,this.mutationService=c}return i.prototype.show=function(t,r){var n=this,o=this.$rootScope.$new();o.model=new e.MigrateVmkToVssWizardModel,o.model.hostId=t,this.dataService.getProperties(t,i.VMK_MIGRATE_HOST_NAME_PROPERTY).then(function(e){var t=e[i.VMK_MIGRATE_HOST_NAME_PROPERTY];o.wizardConfig={title:n.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.titleFormat",t,r),loadingMessage:n.i18nService.getString("CommonUi","wizard.loading"),cssClass:"migrate-vmk-to-vss-wizard",onFinish:function(){var e=n.buildSpec(o.model);return n.mutationService.apply(o.model.hostId,e._type,e),!0}},o.model.targetStandardSwitch=r,o.wizardConfig.pages=n.migrateVmkWizardPages.createPages(o.model),n.wizardValidationService.initWizardValidation(o),n.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(o),n.invokeWizard(o)})},i.prototype.invokeWizard=function(e){this.vuiWizardService({scope:e,configObjectName:"wizardConfig"}).show()},i.prototype.buildSpec=function(e){var i=new t;return i.vmkDevice=e.selectedVmkAdapter,i.networkName=e.newNetworkName,i.strandardSwitchName=e.targetStandardSwitch,i.vlanId=parseInt(e.vlanId),i.networkToRemoveName=e.networkNameToRemove,i},i.$inject=["$rootScope","i18nService","migrateVmkWizardPages","wizardValidationService","pageStateManagementService","defaultUriSchemeUtil","vuiWizardService","dataService","mutationService"],i.VMK_MIGRATE_HOST_NAME_PROPERTY="vmkmigratewizard:hostName",i}();e.MigrateVmkToVssWizardService=i,angular.module("com.vmware.vsphere.client.network").service("migrateVmkToVssWizardService",i)}(network_ui||(network_ui={}));var network_ui;!function(e){angular.module("com.vmware.vsphere.client.network").constant("migrateVmkWizardConstants",{pages:{SELECT_VMK_NETWORK_ADAPTER:"selectVmkToMigrate",CONFIGURE_SETTINGS:"configureSettings",READY_TO_COMPLETE:"readyToComplete"},connectedToStandardSwitch:"standardNetwork"})}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.migrateVmkWizardConstants=t,this.selectVmkAdapterToMigratePageValidator=i,this.configureSettingsPageValidator=r}return e.prototype.createPages=function(e){var t=this,i={id:this.migrateVmkWizardConstants.pages.SELECT_VMK_NETWORK_ADAPTER,title:this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.list.title"),description:this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.list.description"),contentUrl:"network-ui/resources/network/views/host/migratevmkadapter/views/selectVmkAdaptersToMigratePage.html",validationParams:["model.selectedVmkAdapter"],validationFunction:function(){return t.selectVmkAdapterToMigratePageValidator.getValidationError(e.selectedVmkAdapter)}},r={id:this.migrateVmkWizardConstants.pages.CONFIGURE_SETTINGS,title:this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.config.title"),description:this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.config.description"),contentUrl:"network-ui/resources/network/views/host/migratevmkadapter/views/configureSettingsPage.html",validationParams:["model.newNetworkName","model.vlanId"],validationFunction:function(){return t.configureSettingsPageValidator.getValidationError(e.newNetworkName,e.vlanId,e.hostId)}},n={id:this.migrateVmkWizardConstants.pages.READY_TO_COMPLETE,title:this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.title"),description:this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.summary.description"),contentUrl:"network-ui/resources/network/views/host/migratevmkadapter/views/readyToCompletePage.html",validationParams:[],validationFunction:function(){return!0}};return[i,r,n]},e.$inject=["i18nService","migrateVmkWizardConstants","selectVmkAdapterToMigratePageValidator","configureSettingsPageValidator"],e}();e.MigrateVmkWizardPages=t,angular.module("com.vmware.vsphere.client.network").service("migrateVmkWizardPages",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.networkUtil=t,this.networkLabelValidator=i}return e.prototype.getValidationError=function(e,t,i){var r=[];return this.networkUtil.isVlanIdValid(t)||r.push(this.i18nService.getString("NetworkUi","VnicData.invalidVlanId")),r=r.concat(this.networkLabelValidator.getNetworkLabelClientSideValidationErrors(e)),0===r.length?this.networkLabelValidator.getNetworkLabelServerSideValidationErrors(i,e):r},e.$inject=["i18nService","networkUtil","networkLabelValidator"],e}();e.ConfigureSettingsPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("configureSettingsPageValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.getValidationError=function(e){var t=[];return e||t.push(this.i18nService.getString("NetworkUi","VssVirtualNicMigrateWizard.error.selectNic")),t},e.$inject=["i18nService"],e}();e.SelectVmkAdapterToMigratePageValidator=t,angular.module("com.vmware.vsphere.client.network").service("selectVmkAdapterToMigratePageValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e){var t=this;this.$scope=e,this.customizedSettings={noPoliciesIncluded:!0,addAllTab:!1},this.hostUri=this.$scope.hostUri,this.registerRefreshCallback=function(e){t.refresh=e}}return e.$inject=["$scope"],e}();angular.module("com.vmware.vsphere.client.network").controller("SelectedVmkDetailsViewController",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e){this.congestionControlAlgorithm=e.congestionControlAlgorithm,this.maxNumberOfConnections=e.maxNumberOfConnections,this.runtimeMaxNumberOfConnections=e.runtimeMaxNumberOfConnections,this.isRuntimeInfoActive=e.isRuntimeInfoActive}return e.prototype.buildSpec=function(e){var t={};return t.maxNumberOfConnections=this.maxNumberOfConnections,t.congestionControlAlgorithm=this.congestionControlAlgorithm,t},e}();e.NetStackEditAdvancedPageModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.host.netstack.model.NetStackReconfigureSpec$DnsReconfigureSpec,i=function(){function e(e){this.isDhcpEnabled=e.isDhcpEnabled,this.vnicsWithDhcpEnabled=e.vnicsWithDhcpEnabled,this.selectedVnic=e.selectedVnic,this.hostName=e.hostName,this.domainName=e.domainName,this.preferredDns=e.preferredDns,this.alternateDns=e.alternateDns,this.searchDomains=e.searchDomains,this.isIpv6Enabled=e.isIpv6Enabled,this.isDefaultNetStack=e.isDefaultNetStack}return e.prototype.buildSpec=function(e){var i=new t;return e.isDhcpEnabled!==this.isDhcpEnabled&&(i.isDhcpEnabled=this.isDhcpEnabled),this.isDhcpEnabled?e.selectedVnic!==this.selectedVnic&&(i.selectedVnic=this.selectedVnic):(e.hostName!==this.hostName&&(i.hostName=this.hostName),e.domainName!==this.domainName&&(i.domainName=this.domainName),e.preferredDns!==this.preferredDns&&(i.preferredDns=this.preferredDns),e.alternateDns!==this.alternateDns&&(i.alternateDns=this.alternateDns),e.searchDomains!==this.searchDomains&&(i.searchDomains=this.searchDomains)),this.hasChanges(i)?i:null},e.prototype.hasChanges=function(e){var t=Object.keys(e);return t.length>1},e}();e.NetStackEditDnsConfigPageModel=i}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e){this.isSystemNetStack=e.isSystemNetStack,this.name=e.name}return e.prototype.buildSpec=function(e){return e&&e.name===this.name?null:this.name},e}();e.NetStackEditNamePageModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=com.vmware.vim.binding.vim.host.IpRouteConfig,i=function(){function e(e){this.defaultGateway=e.defaultGateway,this.ipV6DefaultGateway=e.ipV6DefaultGateway,this.hasVnicWithIpv4Settings=e.hasVnicWithIpv4Settings,this.hasVnicWithIpv6Settings=e.hasVnicWithIpv6Settings,this.isIpv6Enabled=e.isIpv6Enabled,this.vnicsWithDhcpEnabled=e.vnicsWithDhcpEnabled,this.isDefaultNetStack=e.isDefaultNetStack,this.isDefaultGatewaySet=!!e.defaultGateway,this.isIpV6DefaultGatewaySet=!!e.ipV6DefaultGateway}return e.prototype.buildSpec=function(e){var i=new t;return this.isEmptyValue(this.defaultGateway)||e.defaultGateway===this.defaultGateway||(i.defaultGateway=this.defaultGateway),this.isEmptyValue(this.ipV6DefaultGateway)||e.ipV6DefaultGateway===this.ipV6DefaultGateway||(i.ipV6DefaultGateway=this.ipV6DefaultGateway),i.defaultGateway||i.ipV6DefaultGateway?i:null},e.prototype.isEmptyValue=function(e){return""===e},e}();e.NetStackEditRoutingPageModel=i}(network_ui||(network_ui={}));var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.host.netstack.model.NetStackReconfigureSpec,i=function(){function e(e,t){this.dialogScope=e,this.mutationService=t}return e.prototype.submitDialog=function(){var e=this.dialogScope.dnsConfigPageModel?this.dialogScope.dnsConfigPageModel.buildSpec(this.dialogScope.initialDnsConfigPageModel):null,i=this.dialogScope.routingPageModel.buildSpec(this.dialogScope.initialRoutingPageModel),r=this.dialogScope.namePageModel.buildSpec(this.dialogScope.initialNamePageModel),n=this.dialogScope.advancedPageModel.buildSpec(this.dialogScope.initialAdvancedPageModel);if(e||i||r||n){var o=new t;o.netStackInstanceKey=this.dialogScope.netStackKey,e&&(o.dnsConfig=e),i&&(o.ipRouteConfig=i),r&&(o.name=r),n&&(n.maxNumberOfConnections&&(o.requestedMaxNumberOfConnections=n.maxNumberOfConnections),n.congestionControlAlgorithm&&(o.congestionControlAlgorithm=n.congestionControlAlgorithm)),this.mutationService.apply(this.dialogScope.hostId,o._type,o)}return!0},e}();e.NetStackEditDialogManager=i}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function t(e){this.mutationService=e}return t.prototype.createManager=function(t){return new e.NetStackEditDialogManager(t,this.mutationService)},t.$inject=["mutationService"],t}();e.NetStackEditDialogManagerFactory=t,angular.module("com.vmware.vsphere.client.network").service("netStackEditDialogManagerFactory",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.vuiConstants=t,this.networkUiConstants=i,this.dnsConfigPageValidator=r,this.routingPageValidator=n,this.advancedPageValidator=o}return e.prototype.createPages=function(e){var t=[];return e.netStackKey===this.networkUiConstants.TcpIpStack.DEFAULT_NET_STACK_KEY&&t.push({title:this.i18nService.getString("NetworkUi","EditDnsAndRoutingView.dnsSettingsView"),contentUrl:"network-ui/resources/network/views/host/netstack/edit/pages/netStackEditDnsConfigPage.html",onCommit:this.buildDnsConfigPageOnCommit(e)}),t.push({title:this.i18nService.getString("NetworkUi","EditDnsAndRoutingView.routingSettingsView"),contentUrl:"network-ui/resources/network/views/host/netstack/edit/pages/netStackEditRoutingPage.html",onCommit:this.buildRoutingPageOnCommit(e)},{title:this.i18nService.getString("NetworkUi","EditDnsAndRoutingView.name"),contentUrl:"network-ui/resources/network/views/host/netstack/edit/pages/netStackEditNamePage.html"}),e.multipleNetworkStackInstanceSupported&&t.push({title:this.i18nService.getString("NetworkUi","EditDnsAndRoutingView.advancedProperties"),contentUrl:"network-ui/resources/network/views/host/netstack/edit/pages/netStackEditAdvancedPage.html",onCommit:this.buildAdvancedPageOnCommit(e)}),t},e.prototype.buildDnsConfigPageOnCommit=function(e){var t=this;return function(){var i=e.dialogOptions,r=e.dnsConfigPageModel;if(i.validationBanner.messages=[],r.isDhcpEnabled){var n=t.dnsConfigPageValidator.getNoVirtualNicsValidationMessage(r.vnicsWithDhcpEnabled);t.updateValidationBanner(n,i.validationBanner.messages);var o=t.dnsConfigPageValidator.getNoVnicSelectedValidationMessage(r.vnicsWithDhcpEnabled,r.selectedVnic);t.updateValidationBanner(o,i.validationBanner.messages)}else{if(r.isDefaultNetStack){var a=t.dnsConfigPageValidator.getHostNameValidationMessage(r.hostName);t.updateValidationBanner(a,i.validationBanner.messages);var s=t.dnsConfigPageValidator.getDomainNameValidationMessage(r.domainName);t.updateValidationBanner(s,i.validationBanner.messages)}var c=t.dnsConfigPageValidator.getSearchDomainsValidationMessage(r.searchDomains);t.updateValidationBanner(c,i.validationBanner.messages);var l=t.dnsConfigPageValidator.getPreferredDnsValidationMessage(r.preferredDns,r.isIpv6Enabled);t.updateValidationBanner(l,i.validationBanner.messages);var d=t.dnsConfigPageValidator.getAlternateDnsValidationMessage(r.alternateDns,r.isIpv6Enabled);t.updateValidationBanner(d,i.validationBanner.messages)}return 0===i.validationBanner.messages.length}},e.prototype.buildRoutingPageOnCommit=function(e){var t=this;return function(){var i=e.dialogOptions,r=e.routingPageModel;i.validationBanner.messages=[];var n=t.routingPageValidator.getIpv4GatewayValidationMessage(r.defaultGateway);n&&t.updateValidationBanner(n,i.validationBanner.messages);var o=t.routingPageValidator.getIpv6GatewayValidationMessage(r.ipV6DefaultGateway);if(o){t.i18nService.getString("NetworkUi","DnsAndRoutingPage.ipv4VmkernelGateway.error");t.updateValidationBanner(o,i.validationBanner.messages)}return 0===i.validationBanner.messages.length}},e.prototype.buildAdvancedPageOnCommit=function(e){var t=this;return function(){var i=e.dialogOptions,r=e.advancedPageModel;i.validationBanner.messages=[];var n=t.advancedPageValidator.getMaxNumberOfConnectionsValidationMessage(r.maxNumberOfConnections);return n&&t.updateValidationBanner(n,i.validationBanner.messages),0===i.validationBanner.messages.length}},e.prototype.updateValidationBanner=function(e,t){e&&t.push({type:this.vuiConstants.validationBanner.type.ERROR,text:e})},e.$inject=["i18nService","vuiConstants","networkUiConstants","netStackEditDnsConfigPageValidator","netStackEditRoutingPageValidator","netStackEditAdvancedPageValidator"],e}();e.NetStackEditDialogPages=t,angular.module("com.vmware.vsphere.client.network").service("netStackEditDialogPages",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.host.netstack.model.NetStackConfigSpec,i=function(){function i(e,t,i,r,n,o){this.$rootScope=e,this.vxMultiPageDialogService=t,this.i18nService=i,this.dataService=r,this.managerFactory=n,this.netStackEditDialogPages=o}return i.prototype.show=function(e,t,i,r){var n=this.$rootScope.$new();n.hostId=e,n.netStackKey=t,n.multipleNetworkStackInstanceSupported=r;var o=this.managerFactory.createManager(n);n.dialogOptions=this.createDialogOptions(i),n.dialogOptions.pages=this.netStackEditDialogPages.createPages(n),n.dialogOptions.confirmOptions={onClick:function(){return o.submitDialog()}};var a={scope:n,configObjectName:"dialogOptions"};this.requestData(n),this.vxMultiPageDialogService(a)},i.prototype.requestData=function(r){var n=new t;n.netStackInstanceKey=r.netStackKey;var o=[{propertyName:i.DATA_PROPERTY,parameterType:n._type,parameter:n}];this.dataService.getProperties(r.hostId,[i.DATA_PROPERTY],{propertyParams:o}).then(function(t){if(t&&t[i.DATA_PROPERTY]){var n=t[i.DATA_PROPERTY];n.isDefaultNetStack&&(r.dnsConfigPageModel=new e.NetStackEditDnsConfigPageModel(n),r.initialDnsConfigPageModel=angular.copy(r.dnsConfigPageModel)),r.routingPageModel=new e.NetStackEditRoutingPageModel(n),r.namePageModel=new e.NetStackEditNamePageModel(n),r.advancedPageModel=new e.NetStackEditAdvancedPageModel(n),r.initialRoutingPageModel=angular.copy(r.routingPageModel),r.initialNamePageModel=angular.copy(r.namePageModel),r.initialAdvancedPageModel=angular.copy(r.advancedPageModel),r.dialogOptions.loading=!1}})},i.prototype.createDialogOptions=function(e){return{title:this.i18nService.getString("NetworkUi","EditDnsAndRoutingView.updatedTitle",e),show:!0,loading:!0,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0}},i.$inject=["$rootScope","vxMultiPageDialogService","i18nService","dataService","netStackEditDialogManagerFactory","netStackEditDialogPages"],i.DATA_PROPERTY="netstack:netStackConfig",i}();e.NetStackEditDialogService=i,angular.module("com.vmware.vsphere.client.network").service("netStackEditDialogService",i)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/netstack/edit/pages/netStackEditAdvancedPageComponentTemplate.html"}return e}();e.NetStackEditAdvancedPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.netStackEditAdvancedPageValidator=t,this.vxValidatorFactory=i,this.algTypes=[],this.validator=i.create()}return e.prototype.$onInit=function(){this.initValidationCallbacks();var e="newreno",t="cubic";this.algTypes=[{key:e,label:this.i18nService.getString("NetworkUi","AdvancedNetStackPage.newReno")},{key:t,label:this.i18nService.getString("NetworkUi","AdvancedNetStackPage.cubic")}]},e.prototype.initValidationCallbacks=function(){var e=this;this.validateMaxNumOfConnections=function(){var t=e.netStackEditAdvancedPageValidator.getMaxNumberOfConnectionsValidationMessage(e.pageModel.maxNumberOfConnections);return t?[t]:[]}},e.$inject=["i18nService","netStackEditAdvancedPageValidator","vxValidatorFactory"],e}();angular.module("com.vmware.vsphere.client.network").component("netStackEditAdvancedPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/netstack/edit/pages/netStackEditDnsConfigPageComponentTemplate.html"}return e}();e.NetStackEditDnsConfigPageComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.netStackEditDnsConfigPageValidator=i,this.vxValidatorFactory=r}return e.prototype.$onInit=function(){this.validator=this.vxValidatorFactory.create(),this.updateNoVnicsValidationMessage(),this.initValidationCallbacks();var e=this.pageModel.vnicsWithDhcpEnabled&&this.pageModel.vnicsWithDhcpEnabled.length>0,t=_.contains(this.pageModel.vnicsWithDhcpEnabled,this.pageModel.selectedVnic);this.pageModel.isDhcpEnabled||!e||t||(this.pageModel.selectedVnic=this.pageModel.vnicsWithDhcpEnabled[0])},e.prototype.initValidationCallbacks=function(){var e=this;this.validateHostName=function(){var t=e.netStackEditDnsConfigPageValidator.getHostNameValidationMessage(e.pageModel.hostName);return!e.pageModel.isDhcpEnabled&&t?[t]:[]},this.validateDomainName=function(){var t=e.netStackEditDnsConfigPageValidator.getDomainNameValidationMessage(e.pageModel.domainName);return!e.pageModel.isDhcpEnabled&&t?[t]:[]},this.validateSearchDomains=function(){var t=e.netStackEditDnsConfigPageValidator.getSearchDomainsValidationMessage(e.pageModel.searchDomains);return!e.pageModel.isDhcpEnabled&&t?[t]:[]},this.validatePreferredDns=function(){var t=e.netStackEditDnsConfigPageValidator.getPreferredDnsValidationMessage(e.pageModel.preferredDns,e.pageModel.isIpv6Enabled);return!e.pageModel.isDhcpEnabled&&t?[t]:[]},this.validateAlternateDns=function(){var t=e.netStackEditDnsConfigPageValidator.getAlternateDnsValidationMessage(e.pageModel.alternateDns,e.pageModel.isIpv6Enabled);return!e.pageModel.isDhcpEnabled&&t?[t]:[]}},e.prototype.onDhcpChange=function(){this.updateNoVnicsValidationMessage(),this.validator.validate()},e.prototype.updateNoVnicsValidationMessage=function(){this.noVnicsValidationMessage=this.pageModel.isDhcpEnabled?this.netStackEditDnsConfigPageValidator.getNoVirtualNicsValidationMessage(this.pageModel.vnicsWithDhcpEnabled):null},e.$inject=["i18nService","vuiConstants","netStackEditDnsConfigPageValidator","vxValidatorFactory"],e}();angular.module("com.vmware.vsphere.client.network").component("netStackEditDnsConfigPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/netstack/edit/pages/netStackEditNamePageComponentTemplate.html"}return e}();e.NetStackEditNamePageComponent=t;var i=function(){function e(e){this.i18nService=e}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.network").component("netStackEditNamePage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/netstack/edit/pages/netStackEditRoutingPageComponentTemplate.html"}return e}();e.NetStackEditRoutingPageComponent=t;var i=function(){function e(e,t,i){this.vxValidatorFactory=e,this.netStackEditRoutingPageValidator=t,this.i18nService=i,this.validator=e.create()}return e.prototype.$onInit=function(){this.initValidationCallbacks()},e.prototype.initValidationCallbacks=function(){var e=this;this.ivp4ValidationCallback=function(){var t=e.netStackEditRoutingPageValidator.getIpv4GatewayValidationMessage(e.pageModel.defaultGateway);return t?[t]:[]},this.ivp6ValidationCallback=function(){var t=e.netStackEditRoutingPageValidator.getIpv6GatewayValidationMessage(e.pageModel.ipV6DefaultGateway);return t?[t]:[]}},e.$inject=["vxValidatorFactory","netStackEditRoutingPageValidator","i18nService"],e}();angular.module("com.vmware.vsphere.client.network").component("netStackEditRoutingPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.networkUiConstants=t}return e.prototype.getMaxNumberOfConnectionsValidationMessage=function(e){var t=!this.isEmptyValue(e);return(e>this.networkUiConstants.HOST_MAX_NUMBER_OT_CONNECTIONS_MAX||e<this.networkUiConstants.HOST_MAX_NUMBER_OT_CONNECTIONS_MIN)&&(t=!1),t?null:this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidMaxNumberOfConnectionsLength")},e.prototype.isEmptyValue=function(e){return void 0===e||null===e||""===e},e.$inject=["i18nService","networkUiConstants"],e}();e.NetStackEditAdvancedPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("netStackEditAdvancedPageValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.networkUtil=t,this.networkUiConstants=i,this.ipParserService=r}return e.prototype.getNoVirtualNicsValidationMessage=function(e){return e&&0!==e.length?null:this.i18nService.getString("NetworkUi","DnsAndRoutingData.noDhcpVmkernelAdapters")},e.prototype.getNoVnicSelectedValidationMessage=function(e,t){return e&&e.length>0&&(!t||e.indexOf(t)===-1)?this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidDhcpVmkernelAdapter"):null},e.prototype.getHostNameValidationMessage=function(e){return e?e.length>this.networkUiConstants.MAX_HOST_NAME_LENGTH?this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidHostNameLength"):this.networkUtil.isHostNameValid(e)?null:e.indexOf(".")===-1?this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidHostNameFormat"):this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidHostNameWithPeriod"):this.i18nService.getString("NetworkUi","DnsAndRoutingData.hostNameNotSpecified")},e.prototype.getDomainNameValidationMessage=function(e){if(!e)return this.i18nService.getString("NetworkUi","DnsAndRoutingData.domainNameNotSpecified");if(e.length>this.networkUiConstants.FQDN_MAX_LENGTH)return this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidFqdnLength");var t=e.split(".");return this.areDomainLabelsLengthsValid(t)?this.networkUtil.isDomainNameValid(e)?null:this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidDomainNameFormat"):this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidDomainLabelLength")},e.prototype.getSearchDomainsValidationMessage=function(t){if(!t||!t.trim())return null;var i=e.splitSearchDomains(t);if(i.length>this.networkUiConstants.MAX_NUMBER_SEARCH_DOMAINS)return this.i18nService.getString("NetworkUi","DnsAndRoutingData.searchDomainsMaxNumber",this.networkUiConstants.MAX_NUMBER_SEARCH_DOMAINS);for(var r=0,n=i;r<n.length;r++){var o=n[r];if(o.length>this.networkUiConstants.FQDN_MAX_LENGTH)return this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidSearchDomainsNameLength");var a=o.split(".");if(!this.areDomainLabelsLengthsValid(a))return this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidSearchDomainsLabelLength");if(!this.networkUtil.isDomainNameValid(o))return this.i18nService.getString("NetworkUi","DnsAndRoutingData.invalidSearchDomainsFormat")}return null},e.prototype.getPreferredDnsValidationMessage=function(e,t){return this.isDnsValid(e,t)?null:this.i18nService.getString("NetworkUi","DnsAndRoutingData.preferredDnsError")},e.prototype.getAlternateDnsValidationMessage=function(e,t){return this.isDnsValid(e,t)?null:this.i18nService.getString("NetworkUi","DnsAndRoutingData.alternateDnsError")},e.prototype.isDnsValid=function(e,t){if(!e)return!0;var i=this.ipParserService.isIpv4AddressValid(e);return!i&&t&&(i=this.ipParserService.isIpv6AddressValid(e)),i},e.prototype.areDomainLabelsLengthsValid=function(e){var t=this;return!(!e||0===e.length)&&!_.any(e,function(e){return e.length>t.networkUiConstants.MAX_DOMAIN_NAME_LENGTH})},e.splitSearchDomains=function(e){return e.trim().split(/\s+/)},e.$inject=["i18nService","networkUtil","networkUiConstants","ipParserService"],e}();e.NetStackEditDnsConfigPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("netStackEditDnsConfigPageValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.ipParserService=t}return e.prototype.getIpv4GatewayValidationMessage=function(e){var t=this.isEmptyValue(e)||this.ipParserService.isIpv4AddressValid(e);return t?null:this.i18nService.getString("NetworkUi","DnsAndRoutingPage.ipv4VmkernelGateway.error")},e.prototype.getIpv6GatewayValidationMessage=function(e){var t=this.isEmptyValue(e)||this.ipParserService.isIpv6AddressValid(e,!0);return t?null:this.i18nService.getString("NetworkUi","DnsAndRoutingPage.ipv6VmkernelGateway.error")},e.prototype.isEmptyValue=function(e){return void 0===e||null===e||""===e},e.$inject=["i18nService","ipParserService"],e}();e.NetStackEditRoutingPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("netStackEditRoutingPageValidator",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t){var i=this,r=!0;i.hostId=e._route.objectId,i.liveRefreshProperties=["config.network.netStackInstance","config.network.dnsConfig.dhcp","config.network.dnsConfig.address","config.network.dnsConfig.searchDomain","config.network.dnsConfig.domainName","config.network.dnsConfig.hostName","config.network.dnsConfig.virtualNicDevice","config.network.ipRouteConfig.ipV6GatewayDevice","config.network.ipRouteConfig.ipV6DefaultGateway","config.network.ipRouteConfig.defaultGateway","config.network.routeTableInfo.ipv6Route","config.network.routeTableInfo.ipRoute"],e.loadingData=!1;var n="defaultTcpipStack";i.refresh=function(o){e.isDefaultNetStack=o===n,e.loadingData=!0,r?(e.isDnsTabSelected=e.isDefaultNetStack,e.isRoutingTabSelected=!e.isDefaultNetStack,e.isAdvancedTabSelected=!1):!e.isDefaultNetStack&&e.isDnsTabSelected?(e.isDnsTabSelected=!1,e.isRoutingTabSelected=!0,e.isAdvancedTabSelected=!1):e.isAdvancedTabSelected&&(e.isDnsTabSelected=!1,e.isRoutingTabSelected=!1,e.isAdvancedTabSelected=!0);var a=t.getNetStackDetails(i.hostId,o);i.lastRequestPromise=a,a.then(function(r){a===i.lastRequestPromise&&(e.netStackDnsData=e.isDefaultNetStack?t.buildDnsPropertiesView(r,e.isDefaultNetStack):null,e.netStackRoutingData=t.buildRoutingPropertiesView(r),e.netStackAdvancedData=t.buildAdvancedPropertiesView(r),r&&(e.ipv4RoutingTableData=r.ipv4RouteTableEntries,e.ipv6RoutingTableData=r.ipv6RouteTableEntries))})["finally"](function(){a===i.lastRequestPromise&&(e.loadingData=!1)}),r=!1},e.onTabIndexChanged=function(t){e.isDnsTabSelected=0===t,e.isRoutingTabSelected=1===t,e.isAdvancedTabSelected=4===t},e.$watch("lastSelectedNetStackKey",function(e){i.refresh(e)})}angular.module("com.vmware.vsphere.client.network").controller("NetStackDetailsViewController",e),e.$inject=["$scope","netStackDetailsViewService"]}();var network_lib_ui;!function(e){var t=function(){function e(){this.bindings={tableEntries:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/netStackRoutingTableViewTemplate.html"}return e}();e.NetStackIpv4RoutingTableViewComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.$scope=r,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.datagridOptions.data=this.tableEntries,this.createDatagridOptions()},e.prototype.$onChanges=function(){this.datagridOptions.data=this.tableEntries},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.NONE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){return[{displayName:this.i18nService.getString("NetworkUi","routingtableview.networkHeader"),field:"network",width:"150px"},{displayName:this.i18nService.getString("NetworkUi","routingtableview.subnetMask"),field:"subnetMask",width:"150px"},{displayName:this.i18nService.getString("NetworkUi","routingtableview.gatewayHeader"),field:"gateway",width:"150px"},{displayName:this.i18nService.getString("NetworkUi","routingtableview.deviceHeader"),field:"deviceName",width:"150px"}]},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry"],e}();angular.module("com.vmware.vsphere.client.network").component("netStackIpv4RoutingTableView",new t)}(network_lib_ui||(network_lib_ui={}));var network_lib_ui;!function(e){var t=function(){function e(){this.bindings={tableEntries:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/netStackRoutingTableViewTemplate.html";
}return e}();e.NetStackIpv6RoutingTableViewComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.$scope=r,this.createDatagridOptions()}return e.prototype.$onInit=function(){this.datagridOptions.data=this.tableEntries,this.createDatagridOptions()},e.prototype.$onChanges=function(){this.datagridOptions.data=this.tableEntries},e.prototype.createDatagridOptions=function(){this.datagridOptions={columnDefs:this.createColumnDefinitions(),sortMode:this.vuiConstants.grid.sortMode.NONE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.tableEntries,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}},e.prototype.createColumnDefinitions=function(){return[{displayName:this.i18nService.getString("NetworkUi","routingtableview.networkHeader"),field:"network",width:"150px"},{displayName:this.i18nService.getString("NetworkUi","routingtableview.prefixHeader"),field:"prefixLength",width:"150px"},{displayName:this.i18nService.getString("NetworkUi","routingtableview.gatewayHeader"),field:"gateway",width:"150px"},{displayName:this.i18nService.getString("NetworkUi","routingtableview.deviceHeader"),field:"deviceName",width:"150px"}]},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry"],e}();angular.module("com.vmware.vsphere.client.network").component("netStackIpv6RoutingTableView",new t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){return n.getProperties(u.hostId,[p])}function l(e){e.forEach(function(e){e.type=e.isSystemStack?i.getString("H5NetworkUi","NetStackInstanceList.systemSingle"):i.getString("H5NetworkUi","NetStackInstanceList.customSingle")})}function d(e){return u.datagridOptions.actionBarOptions.actions&&u.datagridOptions.actionBarOptions.actions.length>0&&(u.datagridOptions.actionBarOptions.actions[0].enabled=e&&e.length>0&&m),u.ingnoreNextItemSelection?void(u.ingnoreNextItemSelection=!1):(e&&e.length>0?(t.lastSelectedNetStackKey=e[0].key,u.evaluationContext.selectedNetStack=e[0],u.evaluationContext.multipleNetworkStackInstanceSupported=t.multipleNetworkStackInstanceSupported,u.netstackDetailsHeader=i.getString("NetworkUi","DnsAndRoutingView.tcpIpInstance",e[0].name)):(u.evaluationContext.selectedNetStack=null,t.lastSelectedNetStackKey=null,u.evaluationContext.multipleNetworkStackInstanceSupported=!1),void(u.showNoItemSelected=null===t.lastSelectedNetStackKey))}var u=this,p="netstack:netStackData",v=[o.actions.EDIT_DNS_AND_ROUTING],m=!1;u.liveRefreshProperties=["config.network.ipRouteConfig.ipV6GatewayDevice","config.network.ipRouteConfig.ipV6DefaultGateway","config.network.ipRouteConfig.defaultGateway","config.network.dnsConfig.address","config.network.vnic","config.network.netStackInstance"],u.netstacksLoading=!1,u.showNoItemSelected=!0,u.netstackDetailsHeader=null,u.hostId=t._route.objectId,u.headerOptions={title:i.getString("H5NetworkUi","NetStackInstanceList.tcpIpTitleLabel"),objectId:u.hostId,actions:[{actionUid:"vsphere.core.host.network.editIpv6SupportAction",customLabel:i.getString("H5NetworkUi","NetStackInstanceList.editLabel")}]},u.watchForObjects=[u.hostId],u.evaluationContext={},u.splitterOptions={orientation:r.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"45%"},{min:"250px",size:"55%"}]},t.multipleNetworkStackInstanceSupported=!1,t.preselectComparator=function(e){return e.key===t.lastSelectedNetStackKey},u.refresh=function(){var i=c(),r=a.createActionbarOptions([u.hostId],v,u.evaluationContext);u.netstacksLoading=!0,e.all([i,r]).then(function(e){var i=e[0],r=e[1];r&&r.actions&&r.actions.length>0&&(m=r.actions[0].enabled);var n=i?i[p]:{},o=n.netStackItems||[];l(o),i&&i[p]&&(t.multipleNetworkStackInstanceSupported=i[p].multipleNetworkStackInstanceSupported),u.datagridOptions?(u.ingnoreNextItemSelection=!0,u.datagridOptions.data=o):u.datagridOptions=s.createDatagridOptions(o,r,n.ipv6Enabled,d),u.netstacksLoading=!1})},u.refresh()}angular.module("com.vmware.vsphere.client.network").controller("NetStackViewController",e),e.$inject=["$q","$scope","i18nService","vuiConstants","dataService","networkUiConstants","actionToolbarFactory","netStackListService"]}(),function(){"use strict";function e(e){var t=this;t.liveRefreshProperties=["config.network.pnic","config.sriovDevicePool","config.pciPassthruInfo"],t.hostId=e._route.objectId,t.registerRefreshCallback=function(e){t.refresh=e}}angular.module("com.vmware.vsphere.client.network").controller("PhysicalAdapterDetailsViewController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(i){return p.ingnoreNextItemSelection?(u(),void(p.ingnoreNextItemSelection=!1)):(p.showNoItemSelected=!i||0===i.length,p.showNoItemSelected?(t.selectedPhysicalAdapterDevice=null,v.pnic=null):(t.selectedPhysicalAdapterDevice=i[0].device,v.pnic=i[0].device,p.adapterDetailsHeader=e.getString("NetworkUi","PnicPropertiesView.title",t.selectedPhysicalAdapterDevice)),void u())}function d(e){return{height:"100%",pageConfig:{hidePager:!0},columnDefs:r,sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,data:[],selectedItems:[],resizable:!0,actionBarOptions:e,onChange:l}}function u(){p.datagridOptions.actionBarOptions.actions.forEach(function(e){e!==i.actions.SEPARATOR&&(e.enabled=m[e.actionId]&&(p.datagridOptions.selectedItems.length>0||e.actionId!==o.actions.EDIT_PNIC))})}var p=this;p.liveRefreshProperties=["config.network.pnic","config.network.vswitch","config.network.proxySwitch","config.network.opaqueSwitch","config.sriovDevicePool","config.pciPassthruInfo"],p.physicalAdaptersLoading=!1,p.showNoItemSelected=!0,p.hostId=t._route.objectId,p.headerOptions={title:e.getString("NetworkUi","host.manage.pnicHeader"),objectId:p.hostId,actions:[]},p.splitterOptions={orientation:i.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"45%"},{min:"250px",size:"55%"}]};var v={pnic:null},m={};v.connectionType=c.connectionType.PNIC,p.refresh=function(){p.errorRetrievingData=null;var t=[o.actions.ADD_NETWORKING,o.actions.REFRESH_NETWORK,i.actions.SEPARATOR,o.actions.EDIT_PNIC],r=n.getPhysicalAdapterItems(p.hostId),c=a.createActionbarOptions([p.hostId],t,v);p.physicalAdaptersLoading=!0,s.all([r,c]).then(function(e){var t=e[0],r=e[1];p.ingnoreNextItemSelection=!0,p.datagridOptions||(p.datagridOptions=d(r)),p.datagridOptions.data=t,_.forEach(r.actions,function(e){e!==i.actions.SEPARATOR&&(m[e.actionId]=e.enabled)}),p.physicalAdaptersLoading=!1},function(t){p.physicalAdaptersLoading=!1;var i=t&&t.data&&t.data.message?t.data.message:"";p.errorRetrievingData=e.getString("NetworkUi","PnicView.error",i)})},p.refresh(),t.preselectComparator=function(e){return!!t.selectedPhysicalAdapterDevice&&t.selectedPhysicalAdapterDevice===e.device}}angular.module("com.vmware.vsphere.client.network").controller("PhysicalAdaptersViewController",e),e.$inject=["i18nService","$scope","vuiConstants","physicalAdaptersListColumns","physicalAdaptersListService","networkUiConstants","actionToolbarFactory","$q","addNetworkingWizardConstants"]}();var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<",validator:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/pnic/edit/editPnicDialogTemplate.html"}return e}();e.EditPnicDialogComponent=t;var i=function(){function e(e){var t=this;this.i18nService=e,this.validateNumberOfVirtualFunctions=function(){var e=[];return t.pageModel.sriovEnabled?((t.pageModel.numVirtualFunctionsRequested<1||t.pageModel.numVirtualFunctionsRequested>t.pageModel.maxVirtualFunctionSupported)&&e.push(t.i18n("H5NetworkUi","EditPnicView.sriov.errorMessage",t.pageModel.maxVirtualFunctionSupported)),e):[]}}return e.prototype.$onInit=function(){this.i18n=this.i18nService.getString,this.linkSpecificationOptions=this.buildLinkSpecificationOptions(),this.sriovOptions=this.buildSriovOptions()},e.prototype.onSriovStatusChanged=function(){this.pageModel.sriovEnabled&&!this.pageModel.numVirtualFunctionsRequested&&(this.pageModel.numVirtualFunctionsRequested=1)},e.prototype.buildLinkSpecificationOptions=function(){var e=this,t=[];return this.pageModel.linkSpecification&&this.pageModel.linkSpecification.forEach(function(i){t.push({label:e.buildLinkSpeedLabel(i),value:i})}),t},e.prototype.buildSriovOptions=function(){var e=[];return this.pageModel.sriovCapable&&(e.push({label:this.i18n("H5NetworkUi","EditPnicView.sriov.status.enabled"),value:!0}),e.push({label:this.i18n("H5NetworkUi","EditPnicView.sriov.status.disabled"),value:!1})),e},e.prototype.buildLinkSpeedLabel=function(e){return e.duplex?this.i18n("NetworkUi","PnicView.mbFullDuplex",e.speedMb):!e.duplex&&e.speedMb>0?this.i18n("NetworkUi","PnicView.mbHalfDuplex",e.speedMb):this.i18n("NetworkUi","PnicView.autonegotiate")},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.network").component("editPnicDialog",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=com.vmware.vsphere.client.network.PhysicalNicEditSpec,i=com.vmware.vim.binding.vim.host.PhysicalNic$LinkSpeedDuplex,r=com.vmware.vim.binding.vim.host.SriovConfig,n=function(){function e(e){var t=this;e&&(this.name=e.name,e.linkSpeed&&(this.linkSpeed=new i,this.linkSpeed.duplex=e.linkSpeed.duplex,this.linkSpeed.speedMb=e.linkSpeed.speedMb),e.linkSpecification&&(this.linkSpecification=[],e.linkSpecification.forEach(function(e){t.equals(e,t.linkSpeed)?t.linkSpecification.push(t.linkSpeed):t.linkSpecification.push(e)})),e.sriovInfoItem&&e.sriovInfoItem.sriovCapable&&(this.sriovCapable=e.sriovInfoItem.sriovCapable,this.sriovActive=e.sriovInfoItem.sriovActive,this.sriovEnabled=e.sriovInfoItem.sriovEnabled,this.numVirtualFunction=e.sriovInfoItem.numVirtualFunction,this.numVirtualFunctionsRequested=e.sriovInfoItem.numVirtualFunctionsRequested,this.maxVirtualFunctionSupported=e.sriovInfoItem.maxVirtualFunctionSupported,this.pnicPci=e.pci))}return e.prototype.buildSpec=function(e){var i=new t;i.device=this.name;var n=!this.equals(this.linkSpeed,e.linkSpeed),o=e.sriovEnabled!==this.sriovEnabled||this.sriovEnabled&&e.numVirtualFunctionsRequested!==this.numVirtualFunctionsRequested;if(n&&!this.isAutoNegotiate(this.linkSpeed)&&(i.linkSpeed=this.linkSpeed),o){var a=new r;a.sriovEnabled=this.sriovEnabled,a.numVirtualFunction=this.sriovEnabled?this.numVirtualFunctionsRequested:0,a.id=this.pnicPci,i.sriovConfig=a}return o||n?i:null},e.prototype.isAutoNegotiate=function(e){return 0===e.speedMb&&e.duplex===!1},e.prototype.equals=function(e,t){return!(!e||!t)&&(e.speedMb===t.speedMb&&e.duplex===t.duplex)},e}();e.EditPnicDialogModel=n}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function t(e,t,i,r,n,o){this.dataService=e,this.i18nService=t,this.clarityModalService=i,this.mutationService=r,this.vxValidatorFactory=n,this.vuiConstants=o,this.i18n=this.i18nService.getString}return t.prototype.show=function(i,r){function n(){if(s){if(o.dialogData.validator.validate().length)return o.alerts=[{text:this.i18n("H5NetworkUi","EditPnicView.sriov.errorMessage",o.dialogData.pageModel.maxVirtualFunctionSupported),type:this.vuiConstants.validationBanner.type.ERROR}],!1;var e=o.dialogData.pageModel.buildSpec(s);e&&this.mutationService.apply(i,e._type,e)}return!0}var o={title:this.i18nService.getString("H5NetworkUi","PnicView.editTitle"),defaultButton:"submit",alerts:[],dialogData:{validator:this.vxValidatorFactory.create()},contentTemplate:"network-ui/resources/network/views/host/pnic/edit/editPnicDialog.html",onSubmit:n.bind(this)},a=this.getEditPnicDialogData(i,r),s=null;a.then(function(i){var r=i[t.EDIT_PNIC_DATA_MODEL];r&&(o.subTitle=r.name,s=new e.EditPnicDialogModel(r)),o.dialogData.pageModel=new e.EditPnicDialogModel(r)}),this.clarityModalService.openOkCancelModal(o)},t.prototype.getEditPnicDialogData=function(e,i){var r=[{propertyName:t.EDIT_PNIC_DATA_MODEL,parameterType:"java.lang.String",parameter:i}],n=this.dataService.getProperties(e,[t.EDIT_PNIC_DATA_MODEL],{propertyParams:r});return n},t.$inject=["dataService","i18nService","clarityModalService","mutationService","vxValidatorFactory","vuiConstants"],t.EDIT_PNIC_DATA_MODEL="pnic:editPhysicalAdapterModel",t}();e.EditPnicDialogService=t,angular.module("com.vmware.vsphere.client.network").service("editPnicDialogService",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i,r,n){function o(o,a,s,c){var l="portgroup:portgroupDialogData",d={propertyParams:[{propertyName:l,parameterType:"java.lang.String",parameter:s}]},u={properties:{},securityPolicies:{},trafficShapingPolicies:{},teamingAndFailover:{}},p=t.$new();p.dialogOptions={};var v=new n(u,p.dialogOptions);p.manager=v,_.extend(p.dialogOptions,{title:i.getString("NetworkUi","EditPortgroupSettingsView.title",""),iconClass:a.action.icon,height:"676px",width:"1000px",actionDetails:{actionEval:a,availableTargets:[o]},pages:v.getPageDefinitions(),show:!0,loading:!0,loadingMessage:i.getString("CommonUi","wizard.loading"),confirmOptions:{onClick:v.submit},validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0});var m={scope:p,configObjectName:"dialogOptions"};r(m),e.getProperties(o,[l],d).then(function(e){_.extend(u,e[l]),u.hostId=e.id,p.dialogOptions.title=i.getString("NetworkUi","EditPortgroupSettingsView.title",c),p.dialogOptions.loading=!1,p.initialData=angular.copy(p.manager.portgroupData)})}return{show:o}}angular.module("com.vmware.vsphere.client.network").service("editPortGroupDialogService",e),e.$inject=["dataService","$rootScope","i18nService","vxMultiPageDialogService","PortGroupDialogManager"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){var i=e.manager.portgroupData.teamingAndFailover;if(e.manager.pageDirtyFlags.isFailoverPolicyPageDirty=n.hasFailoverPolicyChanged(a,i,!0)||n.hasFailoverOrderChanged(a,i,!0),e.manager.pageDirtyFlags.isFailoverPolicyPageDirty){if(this.failureDetectionValidator.message)return e.manager.showDialogErrors([this.failureDetectionValidator.message]),!1;if(this.hasBeenTouched){var r=t.getFailoverOrderWarnMessage(i.failoverOrderOverridden,i.pnics),o=_.find(this.loadBalancingMessages,function(e){return"vsphere-icon-status-warning"===e.iconClass});if(o||r){var s=[];return o&&s.push(o),r&&s.push(r),t.confirmWarningModal(s)}}}return!0}var a=e.initialData.teamingAndFailover;return this.signPostConfig={message:null,title:i.getString("PortFailoverPolicyPage.lb.loadbalance_ip.popup.title"),"class":"edit-standard-pg-signpost"},this.loadBalancingOptions=i.createNicTeamingPolicyOptions(e.manager.portgroupData.teamingAndFailover.nicTeamingPolicy),this.failureDetectionValidator={message:null,isVisible:!0},this.failureDetectionOptions=[{val:!1,label:i.getString("PortFailoverPolicyPage.linkStatus")},{val:!0,label:i.getString("PortFailoverPolicyPage.beaconProbing")}],this.notifySwitchesOptions=[{val:!1,label:i.getString("PortFailoverPolicyPage.notifyOff")},{val:!0,label:i.getString("PortFailoverPolicyPage.notifyOn")}],this.failbackOptions=[{val:!0,label:i.getString("PortFailoverPolicyPage.failbackOff")},{val:!1,label:i.getString("PortFailoverPolicyPage.failbackOn")}],this.notifySwitches="notifySwitches",this.failback="failback",this.failoverOrderHeaderTitle=i.getString("PortFailoverPolicyPage.orderLabel"),this.failoverOrderActions=[r.failoverOrderActions.MOVE_UP,r.failoverOrderActions.MOVE_DOWN],this.failoverOrder={connectees:e.manager.portgroupData.teamingAndFailover.pnics,connecteesDetails:e.manager.portgroupData.teamingAndFailover.pnics?e.manager.portgroupData.teamingAndFailover.pnics.pnicDetails:null,labels:{active:i.getString("FailoverOrderEditor.active"),standby:i.getString("FailoverOrderEditor.standby"),unused:i.getString("FailoverOrderEditor.unused")}},this.noItemsSelectedMessage=i.getString("FailoverOrderEditor.detailsPrompt"),e.$watchCollection(function(){var t=[e.manager.portgroupData.teamingAndFailover.loadBalancingOverridden,e.manager.portgroupData.teamingAndFailover.loadBalancing,e.manager.portgroupData.teamingAndFailover.failureDetectionOverridden,e.manager.portgroupData.teamingAndFailover.checkBeacon,e.manager.portgroupData.teamingAndFailover.notifySwitchesOverridden,e.manager.portgroupData.teamingAndFailover.notifySwitches,e.manager.portgroupData.teamingAndFailover.failbackOverridden,e.manager.portgroupData.teamingAndFailover.rollingOrder,e.manager.portgroupData.teamingAndFailover.failoverOrderOverridden];return e.manager.portgroupData.teamingAndFailover.pnics&&(t.push(e.manager.portgroupData.teamingAndFailover.pnics.active.length),t.push(e.manager.portgroupData.teamingAndFailover.pnics.standby.length),t.push(e.manager.portgroupData.teamingAndFailover.pnics.unused.length)),t},function(){this.hasBeenTouched=void 0!==this.hasBeenTouched,this.loadBalancingMessages=t.getLoadBalancingMessages(e.manager.portgroupData.teamingAndFailover),this.signPostConfig.message=this.loadBalancingMessages?t.formatMessages(this.loadBalancingMessages):null,this.signPostConfig.message&&(this.signPostIcon=3===this.loadBalancingMessages.length?"exclamation-triangle":"info-circle");var i=t.getFailureDetectionValidationMessage(e.manager.portgroupData.teamingAndFailover);this.failureDetectionValidator.message=i,this.failureDetectionValidator.isVisible=!!i,e.failoverPolicies.checkBeacon&&(this.failureDetectionValidator.isVisible=null!==this.failureDetectionValidator.message)}.bind(this)),e.manager.commitPageCallbacks.commitPortFailoverPolicyPage=o.bind(this),this}angular.module("com.vmware.vsphere.client.network").controller("PortFailoverPolicyPageController",e),e.$inject=["$scope","portFailoverPolicyPageService","networkUtil","networkUiConstants","editPortgroupService"]}(),function(){"use strict";function e(e,t,i,r){function n(e){if(e.failureDetectionOverridden){var t=0;if(e.pnics&&(e.pnics.active&&(t+=e.pnics.active.length),e.pnics.standby&&(t+=e.pnics.standby.length),e.pnics.unused&&(t+=e.pnics.unused.length)),e.checkBeacon&&t<2)return i.getString("PortPolicyData.failover.error.beaconProbingSingleNic")}return null}function o(e){if(!e||0===e.length)return null;var t=[];return _.each(e,function(e){t.push(a(e))}),t.length>0?t.join("<br>"):null}function a(e){return"<div class='row'><span class='col-md-1'><span class='"+e.iconClass+" failover-icon'></span></span><span class='col-md-11 info-msg-color'>"+e.text+"</span></div>"}function s(r){var n=t.defer(),o={title:i.getString("PortPolicyData.failover.lb.loadbalance_ip.confirmation.title"),size:"md",defaultButton:"submit",alerts:[],dialogData:{messages:[],dialogInfo:i.getString("IssuesConfirmationDialog.tip")},contentTemplate:"network-lib-ui/resources/network-lib/dvpg/edit/portgroupFailoverErrorWarningDialog.html",onSubmit:function(){return n.resolve(!0),!0}};return _.forEach(r,function(e){o.dialogData.messages.push(v(e.text,!0))}),e.openOkCancelModal(o),n.promise.then(function(e){return e})}function c(e){if(!e.loadBalancingOverridden||e.loadBalancing!==r.LoadBalancingPolicy.IP)return null;var t=u(),i=e.failureDetectionOverridden?e.checkBeacon:null,n=e.failoverOrderOverridden&&e.pnics?e.pnics.standby:[],o=d(n,i);return o&&(t=[o].concat(t)),t}function l(e,t){return e&&t&&t.active&&0===t.active.length?v(i.getString("PortPolicyData.failover.error.noActiveAdapters")):null}function d(e,t){if(e&&e.length>0){var r=t?"PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbingAndStandbyUplinks":"PortPolicyData.failover.lb.loadbalance_ip.warn.standbyUplinks";return v(i.getString(r))}return t?v(i.getString("PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbing")):null}function u(){var e=[p(i.getString("PortPolicyData.failover.lb.loadbalance_ip.info.etherChannel")),p(i.getString("PortPolicyData.failover.lb.loadbalance_ip.info.portGroupPolicies"))];return e}function p(e){return{text:e,iconClass:"vsphere-icon-info"}}function v(e,t){return{text:e,iconClass:t?"warning":"vsphere-icon-status-warning"}}return{getFailureDetectionValidationMessage:n,getLoadBalancingMessages:c,getFailoverOrderWarnMessage:l,formatMessages:o,confirmWarningModal:s}}angular.module("com.vmware.vsphere.client.network").service("portFailoverPolicyPageService",e),e.$inject=["clarityModalService","$q","networkUtil","networkUiConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){return e.manager.pageDirtyFlags.isPorpertiesPageDirty=o.havePortgroupPropertiesChanged(l,e.manager.portgroupData.properties),!e.manager.pageDirtyFlags.isPorpertiesPageDirty||s().then(function(t){var n=[];return t&&(n.push(t),c(t)),i.isVlanIdValid(e.manager.portgroupData.properties.portgroupVlanId)||(t=r.getString("NetworkUi","VnicData.invalidVlanId"),n.push(t)),n.length>0&&e.manager.showDialogErrors(n),0===n.length})}function s(){var i=n.getInvalidNameError(e.manager.portgroupData.properties.portgroupName);if(i)return t.resolve(i);var r=e.manager.portgroupData.properties;return r.oldPortgroupName===r.portgroupName?t.resolve(null):n.getDuplicateNameError(e.manager.portgroupData.hostId,e.manager.portgroupData.properties.portgroupName)}function c(t){e.nameValidator={message:t,isVisible:null!==t}}e.nameValidator={message:null,isVisible:!1},e.onNameChange=function(){var t=n.getInvalidNameError(e.manager.portgroupData.properties.portgroupName);c(t)},e.manager.commitPageCallbacks.commitPortgroupPage=a;var l=e.initialData.properties;return this}angular.module("com.vmware.vsphere.client.network").controller("PortGroupPropertiesPageController",e),e.$inject=["$scope","$q","networkUtil","i18nService","portGroupPropertiesPageService","editPortgroupService"]}(),function(){"use strict";function e(e,t){function i(t){return 0===t.trim().length?e.getString("NetworkUi","VnicData.emptyNetworkLabel"):t.length>127?e.getString("NetworkUi","VnicData.networkLabelTooLong"):t.indexOf('"')!==-1?e.getString("H5NetworkUi","VnicData.networkLabelInvalidCharacter"):null}function r(e,i){return t.validate(e,"com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.StandardNetworkLabelValidateSpec",{_type:"com.vmware.vsphere.client.h5.network.host.wizard.addnetworking.model.StandardNetworkLabelValidateSpec",label:i.trim()}).then(function(e){return e.error&&e.error.localizedMessage?e.error.localizedMessage:e.result?e.result:null},function(){return null})}return{getInvalidNameError:i,getDuplicateNameError:r}}angular.module("com.vmware.vsphere.client.network").service("portGroupPropertiesPageService",e),e.$inject=["i18nService","mutationService"]}(),function(){"use strict";function e(e,t,i){function r(){return e.manager.pageDirtyFlags.isSecurityPageDirty=i.hasSecurityPolicyChanged(n,e.manager.portgroupData.securityPolicies,!0),!0}e.options=[{label:t.getString("PortSecurityPolicyPage.accept"),val:!0},{label:t.getString("PortSecurityPolicyPage.reject"),val:!1}];var n=e.initialData.securityPolicies;return e.manager.commitPageCallbacks.commitSecurityPage=r,this}angular.module("com.vmware.vsphere.client.network").controller("PortSecurityPolicyPageController",e),e.$inject=["$scope","networkUtil","editPortgroupService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){var i=[];if(e.manager.pageDirtyFlags.isTrafficShapingPageDirty=n.hasTrafficShapingPolicyChanged(l,e.manager.portgroupData.trafficShapingPolicies,!0),e.manager.pageDirtyFlags.isTrafficShapingPageDirty&&e.manager.portgroupData.trafficShapingPolicies.overridden&&e.manager.portgroupData.trafficShapingPolicies.enabled&&(_.forEach(c,function(t){var n=e.manager.portgroupData.trafficShapingPolicies[t],o=r.getTrafficShapingErrorMessage(n,t);null!==o&&i.push(s(o))}),0===i.length&&e.manager.portgroupData.trafficShapingPolicies.averageBandwidth>e.manager.portgroupData.trafficShapingPolicies.peakBandwidth)){var o=t.getString("PortPolicyData.shaping.error.avgBwGreaterThanPeakBw");i.push(s(o))}return i}function s(e){return{type:o.validationBanner.type.ERROR,text:e}}var c=[i.TrafficShapingSetting.AVERAGE_BANDWIDTH,i.TrafficShapingSetting.PEAK_BANDWIDTH,i.TrafficShapingSetting.BURST_SIZE],l=e.initialData.trafficShapingPolicies;return this.options=[{label:t.getString("PortTrafficShapingPolicyPage.statusOn"),val:!0},{label:t.getString("PortTrafficShapingPolicyPage.statusOff"),val:!1}],this.validators={averageBandwidth:{message:null,isVisible:!1},peakBandwidth:{message:null,isVisible:!1},burstSize:{message:null,isVisible:!1}},e.manager.commitPageCallbacks.commitTrafficShapingPolicyPage=a,e.$watchCollection(function(){return[e.manager.portgroupData.trafficShapingPolicies.enabled,e.manager.portgroupData.trafficShapingPolicies.overridden]},function(){_.forEach(c,function(e){this.onTrafficShapingChange(e)}.bind(this))}.bind(this)),this.onTrafficShapingChange=function(t){var i=e.manager.portgroupData.trafficShapingPolicies[t],n=r.getTrafficShapingErrorMessage(i,t);this.validators[t].message=n,this.validators[t].isVisible=e.manager.portgroupData.trafficShapingPolicies.overridden&&e.manager.portgroupData.trafficShapingPolicies.enabled&&null!==n},this}angular.module("com.vmware.vsphere.client.network").controller("PortTrafficShapingPolicyPageController",e),e.$inject=["$scope","networkUtil","networkUiConstants","trafficShapingPolicyValidator","editPortgroupService","vuiConstants"]}(),function(){"use strict";function e(e,i,r){return function(n,o){function a(){u={page:{title:e.getString("NetworkUi","PortgroupSettingsView.properties"),contentUrl:"network-ui/resources/network/views/host/portgroup/pages/portGroupPropertiesPage.html",onCommit:function(){return t(h.commitPortgroupPage)}}},p={page:{title:e.getString("NetworkUi","PortSecurityPolicyView.title"),contentUrl:"network-ui/resources/network/views/host/portgroup/pages/portSecurityPolicyPage.html",onCommit:function(){return t(h.commitSecurityPage)}}},v={page:{title:e.getString("NetworkUi","PortTrafficShapingPolicyView.title"),contentUrl:"network-ui/resources/network/views/host/portgroup/pages/portTrafficShapingPolicyPage.html",onCommit:function(){return t(h.commitTrafficShapingPolicyPage)}}},m={page:{title:e.getString("NetworkUi","PortFailoverPolicyView.title"),contentUrl:"network-ui/resources/network/views/host/portgroup/pages/portFailoverPolicyPage.html",onCommit:function(){return t(h.commitPortFailoverPolicyPage)}}}}function s(){var e=[];return e.push(u.page),e.push(p.page),e.push(v.page),e.push(m.page),e}function c(){return(f.isPorpertiesPageDirty||f.isSecurityPageDirty||f.isTrafficShapingPageDirty||f.isFailoverPolicyPageDirty)&&(n.trafficShapingPolicies.overridden&&n.trafficShapingPolicies.enabled||(n.trafficShapingPolicies.averageBandwidth=null,n.trafficShapingPolicies.peakBandwidth=null,n.trafficShapingPolicies.burstSize=null),i.apply(n.hostId,g,n)),!0}function l(e){!e||e.length<1||(d(),o.validationBanner.messages=_.map(e,function(e){return{type:r.validationBanner.type.ERROR,text:e}}))}function d(){o.validationBanner.messages=[]}var u,p,v,m,g="com.vmware.vsphere.client.h5.network.host.portgroup.model.EditPortgroupDialogData",h={commitPortgroupPage:function(){return!0},commitSecurityPage:function(){return!0},commitTrafficShapingPolicyPage:function(){return!0},commitPortFailoverPolicyPage:function(){return!0}},f={isPorpertiesPageDirty:!1,isSecurityPageDirty:!1,isTrafficShapingPageDirty:!1,isFailoverPolicyPageDirty:!1};return a(),{portgroupData:n,commitPageCallbacks:h,pageDirtyFlags:f,getPageDefinitions:s,showDialogErrors:l,submit:c}}}function t(e){if("function"==typeof e)return e()}angular.module("com.vmware.vsphere.client.network").factory("PortGroupDialogManager",e),e.$inject=["i18nService","mutationService","vuiConstants"]}();var network_ui;!function(e){var t=com.vmware.vsphere.client.h5.network.host.proxyswitch.spec.UpdateProxySwitchUplinkMappingSpec,i=function(){function e(e,t,i,r,n){this.i18nService=e,this.clarityModalService=t,this.mutationService=i,this.clarityConstants=r,this.$q=n}return e.prototype.show=function(e,i,r,n){var o,a=this,s={title:this.i18nService.getString("H5NetworkUi","manageVssPnicsDialog.title"),subTitle:{text:n},contentTemplate:"network-ui/resources/network/views/host/proxyswitch/manageProxySwitchPnicsDialogTemplate.html",defaultButton:"submit",dialogData:{hostId:e,dvsRef:i,proxySwitchKey:r,onUplinkMappingCreated:function(e){o=e}},alerts:[],size:"lg",modalClass:"manage-pnic-modal",onSubmit:function(){var i=new t;i.uplinkPortMappings=o.uplinkPortMapping,i.proxySwitchKey=r;var n;return n=a.areAllUplinksFreeOrDisconnected(o)?a.mutationService.validate(e,i._type,i).then(function(e){var t;return e.result?(s.alerts=[{type:a.clarityConstants.notifications.type.ERROR,text:e.result}],t=a.$q.when(!1)):t=a.clarityModalService.openConfirmationModal({title:a.i18nService.getString("DvsUi","HpsPhysicalNicEditor.warn.noActiveNics.title"),message:a.i18nService.getString("DvsUi","HpsPhysicalNicEditor.warn.noActiveNics.text"),clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0}),t}):a.$q.when(!0),n.then(function(t){t&&a.mutationService.apply(e,i._type,i)}),n}};this.clarityModalService.openOkCancelModal(s)},e.prototype.areAllUplinksFreeOrDisconnected=function(e){return _.all(e.uplinkPortMapping,function(t){return null===t.pnicName||!e.pnicDetails[t.pnicName].actualSpeed})},e.$inject=["i18nService","clarityModalService","mutationService","clarityConstants","$q"],e}();e.ManageProxySwitchPnicsDialogService=i,angular.module("com.vmware.vsphere.client.network").service("manageProxySwitchPnicsDialogService",i)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={dvsId:"<"},this.controller=i,this.template='\n               <vx-activity-indicator is-visible="$ctrl.loading"\n                             title="{{i18n(\'Common\', \'loadingTitle\')}}"></vx-activity-indicator>\n               <vx-property-view data="$ctrl.data"\n                                 class="network-ui-fixed-size-vx-property-view"\n                                 ng-if="!$ctrl.loading"/>\n               '}return e}();e.ProxySwitchDetailsDialogContent=t;var i=function(){function e(e,t){this.i18nService=e,this.proxySwitchDetailsDialogService=t,this.i18n=e.getString}return e.prototype.$onInit=function(){var e=this;this.proxySwitchDetailsDialogService.getData(this.dvsId).then(function(t){e.data=t})},Object.defineProperty(e.prototype,"loading",{get:function(){return!this.data},enumerable:!0,configurable:!0}),e.$inject=["i18nService","proxySwitchDetailsDialogService"],e}();angular.module("com.vmware.vsphere.client.network").component("proxySwitchDetailsDialogContent",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",switchKey:"<"},this.controller=i,this.template='\n               <vx-activity-indicator is-visible="$ctrl.loading"\n                             title="{{i18n(\'Common\', \'loadingTitle\')}}"></vx-activity-indicator>\n               <clr-tabs ng-if="!$ctrl.loading">\n\n                  <clr-tab-link>{{$ctrl.i18n("H5NetworkUi", "standardSwitchDetailsView.tabs.all")}}</clr-tab-link>\n                  <clr-tab-link>{{$ctrl.i18n("H5NetworkUi", "standardSwitchDetailsView.tabs.properties")}}</clr-tab-link>\n                  <clr-tab-link>{{$ctrl.i18n("H5NetworkUi", "standardSwitchDetailsView.tabs.policies")}}</clr-tab-link>\n\n                  <clr-tab-content>\n                     <div class="standard-switch-details-dialog-tab">\n                        <vx-property-view\n                           data="$ctrl.propertiesData"\n                           class="vx-property-view-standard-fixed-label-column">\n                        </vx-property-view>\n                        <vx-property-view\n                           data="$ctrl.policiesData"\n                           class="vx-property-view-standard-fixed-label-column">\n                        </vx-property-view>\n                     </div>\n                  </clr-tab-content>\n\n                  <clr-tab-content>\n                     <div class="standard-switch-details-dialog-tab">\n                        <vx-property-view\n                           data="$ctrl.propertiesData"\n                           class="vx-property-view-standard-fixed-label-column">\n                        </vx-property-view>\n                     </div>\n                  </clr-tab-content>\n\n                  <clr-tab-content>\n                     <div class="standard-switch-details-dialog-tab">\n                        <vx-property-view\n                           data="$ctrl.policiesData"\n                           class="vx-property-view-standard-fixed-label-column">\n                        </vx-property-view>\n                     </div>\n                  </clr-tab-content>\n               </clr-tabs>\n               ';
}return e}();e.StandardSwitchDetailsDialogContent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.standardSwitchPropertiesViewService=t,this.standardSwitchPoliciesViewService=i,this.i18n=e.getString}return e.prototype.$onInit=function(){var e=this;this.standardSwitchPropertiesViewService.getData(this.hostId,this.switchKey).then(function(t){e.propertiesData=t}),this.standardSwitchPoliciesViewService.getData(this.hostId,this.switchKey).then(function(t){e.policiesData=t})},Object.defineProperty(e.prototype,"loading",{get:function(){return!this.propertiesData||!this.policiesData},enumerable:!0,configurable:!0}),e.$inject=["i18nService","standardSwitchPropertiesViewService","standardSwitchPoliciesViewService"],e}();angular.module("com.vmware.vsphere.client.network").component("standardSwitchDetailsDialogContent",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e){this.$scope=e,this.dialogData=e.modalOptions.dialogData;var t=e.$on("vxRouteChangeSuccess",function(){e.modalOptions.modalOpen=!1});e.$on("$destroy",function(){t()})}return e.$inject=["$scope"],e}();e.GhostDvsProxySwitchDetailsController=t,angular.module("com.vmware.vsphere.client.network").controller("GhostDvsProxySwitchDetailsController",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.clarityModalService=e,this.i18nService=t,this.dataService=i,this.columnRenderersRegistry=r,this.defaultUriSchemeUtil=n,this.SEPARATOR=", ",this.DVS_UUID_SEPARATOR="; ",this.DOUBLE_QUOTE='"'}return e.prototype.show=function(t,i){var r=this,n={title:this.i18nService.getString("NetworkUi","ghostDvsProxySwitchDetectedEvent.dialog.title"),subTitle:{objectId:t},size:"lg",defaultButton:"close",hideSubmitButton:!0,closeButtonTitle:this.i18nService.getString("NetworkUi","ghostDvsProxySwitchDetectedEvent.dialog.okButton"),alerts:[],dialogData:{loading:!0,issueDesc:this.buildIssueDesc(i),generalContent:this.i18nService.getString("NetworkUi","ghostDvsProxySwitchDetectedEvent.generalWarning")},contentTemplate:"network-ui/resources/network/views/host/summary/GhostDvsProxySwitchDetailsDialog.html"},o={propertyParams:[{propertyName:e.GHOST_DVS_PROXY_SWITCH_DETAILS_PROP,parameterType:"java.util.List",parameter:i}]};this.dataService.getProperties(t,[e.GHOST_DVS_PROXY_SWITCH_DETAILS_PROP],o).then(function(t){var i=t[e.GHOST_DVS_PROXY_SWITCH_DETAILS_PROP];n.dialogData.rejoinDesc=r.buildRejoinDesc(i)})["finally"](function(){n.dialogData.loading=!1}),this.clarityModalService.openOkCancelModal(n)},e.prototype.buildIssueDesc=function(e){var t=this,i="";return _.forEach(e,function(r,n){i=i.concat(t.DOUBLE_QUOTE+r+t.DOUBLE_QUOTE),n!==e.length-1&&(i=i.concat(t.DVS_UUID_SEPARATOR))}),this.i18nService.getString("NetworkUi","ghostDvsProxySwitchDetectedEvent.info",i)},e.prototype.buildRejoinDesc=function(e){var t=this;if(!e||!e.length)return null;var i=this.columnRenderersRegistry.getColumnRenderer("link-and-text"),r="";return _.forEach(e,function(n,o){r=r.concat(i(t.defaultUriSchemeUtil.getVsphereObjectId(n.dvsRef),n.name,null,"",!0,"ghost-dvs-proxy-switch-link")),o!==e.length-1&&(r=r.concat(t.SEPARATOR))}),this.i18nService.getString("NetworkUi","ghostDvsProxySwitchDetectedEvent.rejoinWarning",r)},e.GHOST_DVS_PROXY_SWITCH_DETAILS_PROP="hostNetworkingIssue:ghostDvsProxySwitchDetails",e.$inject=["clarityModalService","i18nService","dataService","columnRenderersRegistry","defaultUriSchemeUtil"],e}();e.GhostDvsProxySwitchDetailsService=t,angular.module("com.vmware.vsphere.client.network").service("ghostDvsProxySwitchDetailsService",t)}(network_ui||(network_ui={})),angular.module("com.vmware.vsphere.client.network").factory("switchSelectorDialogService",["i18nService","virtualSwitchListService","clarityModalService","clarityConstants","addNetworkingWizardConstants","dataService",function(e,t,i,r,n,o){function a(r,a,c,l,d){function u(){var t=p.datagridOptions.selectedItems;return 0===t.length?(s(e.getString("H5NetworkUi","HostSwitchSelectorDialog.noNetworksSelected"),g),!1):(d&&d(t),!0)}var p={},v=l?"virtualswitch:proxyAndStandardSwitches":"virtualswitch:virtualStandardSwitches",m=o.getProperties(r,[v]);m.then(function(e){var i=[],r=e&&e[v];r&&(i=e[v].switchItems||[]);var o=(r&&e[v].showNumberOfPortsColumn,a===n.connectionType.PNIC);p.datagridOptions=t.createDatagridOptions(i,o)});var g={title:c||e.getString("NetworkUi","HostSwitchSelectorDialog.title"),contentTemplate:"network-ui/resources/network/views/host/switchselector/switchSelectorDialog.html",defaultButton:"submit",dialogData:p,alerts:[],onSubmit:u};i.openOkCancelModal(g)}function s(e,t){t.alerts=[{text:e,type:r.notifications.type.ERROR}]}return{openSwitchSelectorDialog:a}}]);var network_ui;!function(e){var t=function(){function e(){this.bindings={},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/virtualswitches/VirtualSwitchesViewTemplate.html"}return e}();e.VirtualSwitchesViewComponent=t;var i=function(){function e(e,t){this.navigation=e,this.i18nService=t,this.headerOptions={objectId:this.navigation.getRoute().objectId,actions:[{actionUid:"vsphere.core.network.actions.addNetworking"},{actionUid:"vsphere.core.host.network.refreshNetworkAction"}],title:this.i18nService.getString("NetworkUi","host.manage.vswitchHeader")}}return e.$inject=["navigation","i18nService"],e}();angular.module("com.vmware.vsphere.client.network").component("virtualSwitchesView",new t)}(network_ui||(network_ui={})),function(){"use strict";function e(e){var t=this;t.hostId=e._route.objectId,t.liveRefreshProperties=["config.network.vnic","config.virtualNicManagerInfo.netConfig","config.network.vswitch","config.network.proxySwitch","config.network.opaqueSwitch","config.network.netStackInstance","config.network.portgroup","config.network.dnsConfig.address"],t.registerRefreshCallback=function(e){t.refresh=e},t.customizedSettings={noPoliciesIncluded:!1,addAllTab:!0}}angular.module("com.vmware.vsphere.client.network").controller("VmKernelAdapterDetailsViewController",e),e.$inject=["$scope"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){var e=[o.actions.ADD_NETWORKING,o.actions.REFRESH_NETWORK,i.actions.SEPARATOR,o.actions.EDIT_VNIC,o.actions.REMOVE_VNIC];return a.createActionbarOptions([t._route.objectId],e,g)}function c(){m.datagridOptions.actionBarOptions.actions.forEach(function(e){e!==i.actions.SEPARATOR&&(e.enabled=h[e.actionId]&&(m.datagridOptions.selectedItems.length>0||!l(e)))})}function l(e){return e.actionId===o.actions.EDIT_VNIC||e.actionId===o.actions.REMOVE_VNIC}function d(e){return!_.some(e,function(e){return e.device===t.lastSelectedVmKernelAdapterDevice})}function u(i){return c(),m.ingnoreNextItemSelection?void(m.ingnoreNextItemSelection=!1):void(i&&i.length>0?(m.adapterDetailsHeader=e.getString("NetworkUi","VnicDetailsView.title",i[0].device),t.lastSelectedVmKernelAdapterDevice=i[0].device,g.vnic=i[0]):(g.vnic=null,t.lastSelectedVmKernelAdapterDevice=null))}function p(e,t){return{height:"100%",pageConfig:{hidePager:!0},columnDefs:t,sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,data:e,selectedItems:[],resizable:!0,actionBarOptions:{actions:[]},onChange:u}}var v="vnic:virtualAdaptersData",m=this;m.liveRefreshProperties=["config.network.vnic","config.virtualNicManagerInfo.netConfig","config.network.vswitch","config.network.proxySwitch","config.network.opaqueSwitch","config.network.netStackInstance","config.network.portgroup"];var g={vnic:null},h={};m.hostId=t._route.objectId,m.headerOptions={title:e.getString("NetworkUi","host.manage.vnicHeader"),objectId:m.hostId,actions:[]},m.splitterOptions={orientation:i.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"45%"},{min:"250px",size:"55%"}]},m.vmkernelAdaptersLoading=!1,m.ingnoreNextItemSelection=!1,t.preselectComparator=function(e){return e.device===t.lastSelectedVmKernelAdapterDevice},m.refresh=function(){m.vmkernelAdaptersLoading=!0;var e=!0,o=r.getVnics(m.hostId,e),a=s();n.all([o,a]).then(function(e){var r=e[0],n=r[v]?r[v].items:[];m.datagridOptions?m.datagridOptions.data=n:m.datagridOptions=p(n,r.vnicColumnDefs),m.datagridOptions.actionBarOptions=e[1],_.forEach(m.datagridOptions.actionBarOptions.actions,function(e){e!==i.actions.SEPARATOR&&(h[e.actionId]=e.enabled)}),d(n)&&(t.lastSelectedVmKernelAdapterDevice=null),m.ingnoreNextItemSelection=!0,m.vmkernelAdaptersLoading=!1},function(){m.datagridOptions&&(m.datagridOptions.data=[]),m.vmkernelAdaptersLoading=!1})},m.refresh()}angular.module("com.vmware.vsphere.client.network").controller("VmKernelAdaptersViewController",e),e.$inject=["i18nService","$scope","vuiConstants","vmKernelAdapterService","$q","networkUiConstants","actionToolbarFactory"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){return function(s,c){function l(){var t={title:e.getString("NetworkUi","VnicView.properties"),contentUrl:"network-ui/resources/network/views/host/vnic/pages/editVnicPortPropertiesPage.html",onCommit:function(){return s.portPropertiesPageModel.onCommit()}},i={title:e.getString("NetworkUi","VnicView.ipv4Settings"),contentUrl:"network-ui/resources/network/views/host/vnic/pages/editVnicIpv4Page.html",onCommit:function(){return s.ipv4PageModel.onCommit()}};return[t,i]}function d(){var t={title:e.getString("NetworkUi","VnicView.ipv6Settings"),contentUrl:"network-ui/resources/network/views/host/vnic/pages/editVnicIpv6Page.html",onCommit:function(){return s.ipv6PageModel.onCommit()}};c.pages.push(t)}function u(){var t={title:e.getString("NetworkUi","AddNetworkingWizard.physicalNicBindingPage.title"),contentUrl:"network-ui/resources/network/views/host/vnic/pages/editBindToPhysicalAdapterPage.html",onCommit:function(){return s.bindToPnicPageModel.onCommit()}};c.pages.push(t)}function p(){if(!y())return c.validationBanner.messages=[],c.validationBanner.messages.push({text:e.getString("NetworkUi","EditVnicView.noIpSettingsError"),type:r.validationBanner.type.ERROR}),!1;var t=v(),i=m(),n=g();if(null!==i&&_.extend(t.spec,{ip:i}),s.ipv6PageModel.dirty){var o=h(!0);null===t.spec.ip&&(t.spec.ip=S()),_.extend(t.spec.ip,{ipV6Config:o})}null!==n&&_.extend(t.spec,{ipRouteSpec:n});var l=s.portPropertiesPageModel.dirty||t.changedVmkSettings.length>0,d=s.ipv4PageModel.dirty,u=s.ipv6PageModel.dirty,p=s.bindToPnicPageModel.dirty;return!(l||d||u||p)||C(t).then(function(e){return e&&a.apply(s.hostId,t._type,t),e})}function v(){var e=t.keys,r=i.serviceKeyToNicTypeMap,n=_.pick(s.portPropertiesPageModel.hostVnicSettings,e.VMOTION,e.PROVISIONING,e.FT_LOGGING,e.MANAGEMENT,e.VR,e.VR_NFC,e.VSAN);return n._type="com.vmware.vsphere.client.modules.api.network.VirtualNicEditSpec",n.spec={_type:"com.vmware.vim.binding.vim.host.VirtualNic$Specification"},s.portPropertiesPageModel.dirty&&(n.spec.mtu=s.portPropertiesPageModel.mtuInBytes),s.bindToPnicPageModel.dirty&&(s.bindToPnicPageModel.componentData.bindToPnicEnabled?n.spec.pinnedPnic=s.bindToPnicPageModel.componentData.selectedPnicForBinding:n.spec.pinnedPnic=""),n.virtualNicName=s.vnicDevice,n.changedVmkSettings=[],_.forEach(s.portPropertiesPageModel.hostVnicSettings,function(e,t){e!==s.portPropertiesPageModel.initialHostVnicSettings[t]&&n.changedVmkSettings.push(r[t])}),n}function m(){if(!s.ipv4PageModel.dirty&&!s.ipv6PageModel.dirty)return null;var e=i.ipSettingsOption,t=S();return t.dhcp=s.ipv4PageModel.ipSettingsOption===e.dhcp,s.ipv4PageModel.ipSettingsOption===e.unset?(t.ipAddress="",t.subnetMask="",t.ipV6Config=h(!0)):s.ipv4PageModel.ipSettingsOption===e.staticIp&&(t.ipAddress=s.ipv4PageModel.ipAddress,t.subnetMask=s.ipv4PageModel.subnetMask),s.ipv4PageModel.ipv6Enabled&&(t.ipV6Config=h()),t}function g(){if(!s.ipv4PageModel.isGatewayFeatureSupported||!s.ipv4PageModel.dirty&&!s.ipv6PageModel.dirty)return null;var e=P();return s.ipv4PageModel.ipSettingsOption===i.ipSettingsOption.staticIp&&s.ipv4PageModel.isGatewayOverriden?e.ipRouteConfig.defaultGateway=s.ipv4PageModel.defaultGateway:e.ipRouteConfig.defaultGateway=null,s.ipv4PageModel.ipv6Enabled&&s.ipv6PageModel.staticIpEnabled&&s.ipv6PageModel.isGatewayOverridden?e.ipRouteConfig.ipV6DefaultGateway=s.ipv6PageModel.defaultGateway:e.ipRouteConfig.ipV6DefaultGateway=null,e}function h(e){return{_type:"com.vmware.vim.binding.vim.host.IpConfig$IpV6AddressConfiguration",autoConfigurationEnabled:s.ipv6PageModel.autoConfigEnabled,dhcpV6Enabled:s.ipv6PageModel.dhcpEnabled,ipV6Address:e?f():[]}}function f(){var e=s.ipv6PageModel.staticIpv6Addresses,t=s.ipv6PageModel.staticIpEnabled;return _.map(e,function(e){return{_type:"com.vmware.vim.binding.vim.host.IpConfig$IpV6Address",ipAddress:e.address,prefixLength:e.prefixLength,operation:t?e.operation:i.changeOperation.remove}})}function S(){return{_type:"com.vmware.vim.binding.vim.host.IpConfig"}}function y(){var e=i.ipSettingsOption.staticIp,t=i.ipSettingsOption.dhcp;return s.ipv4PageModel.ipSettingsOption===e||s.ipv4PageModel.ipSettingsOption===t||s.ipv6PageModel.autoConfigEnabled||s.ipv6PageModel.dhcpEnabled||s.ipv6PageModel.staticIpEnabled}function P(){return{_type:"com.vmware.vim.binding.vim.host.VirtualNic$IpRouteSpec",ipRouteConfig:{_type:"com.vmware.vim.binding.vim.host.IpRouteConfig"}}}function C(t){c.loading=!0,c.loadingMessage=e.getString("CommonUi","wizard.validating");var i=o.defer();return a.validate(s.hostId,t._type,t).then(function(t){if(t.result){var r={title:e.getString("H5NetworkUi","EditVMkernel.confirmEditTitle"),message:t.result,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0,submit:function(){i.resolve(!0)},onCancel:function(){i.resolve(!1)}};n.openConfirmationModal(r)}else i.resolve(!0)})["finally"](function(){c.loading=!1}),i.promise}return{vnicData:s,getPageDefinitions:l,loadIpv6Page:d,loadBindToPnicPage:u,submit:p}}}angular.module("com.vmware.vsphere.client.network").factory("editVmkernelAdapterDialogManager",e),e.$inject=["i18nService","hostVnicServiceConstants","vnicConstants","vuiConstants","clarityModalService","$q","mutationService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(a,s,c){var l="vnic:editHostVnicModel",d=[{propertyName:l,parameterType:"java.lang.String",parameter:c.device}],u={};u.hostId=s,u.vnicDevice=c.device;var p={},v=e.$new(),m=new n(u,p);_.extend(p,{title:t.getString("NetworkUi","EditVnicView.title",c.device),iconClass:a.action.icon,actionDetails:{actionEval:a,availableTargets:[]},pages:m.getPageDefinitions(),show:!0,loading:!0,loadingMessage:t.getString("CommonUi","wizard.loading"),confirmOptions:{onClick:m.submit},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0}),v.dialogOptions=p,v.manager=m,v.dialogOptions.loading=!0;var g={scope:v,configObjectName:"dialogOptions"};r(g),i.getProperties(s,[l],{propertyParams:d}).then(function(e){var t=e[l].editPortPropertiesPageModel;u.portPropertiesPageModel={},u.ipv4PageModel=e[l].editIpv4PageModel,u.ipv6PageModel=e[l].editIpv6PageModel,u.bindToPnicPageModel=e[l].editBindToPnicPageModel,u.portPropertiesPageModel.tcpIpStackName=t.tcpIpStackName,u.portPropertiesPageModel.mtuInBytes=t.mtuInBytes,u.portPropertiesPageModel.hostVnicFeatures=o.pickServiceFeatures(t),u.portPropertiesPageModel.hostVnicSettings=o.pickServiceSettings(t),u.portPropertiesPageModel.initialHostVnicSettings=o.pickServiceSettings(t)})["finally"](function(){u.ipv4PageModel.ipv6Enabled&&m.loadIpv6Page(),u.bindToPnicPageModel.opaqueNetworkSpec&&m.loadBindToPnicPage(),v.dialogOptions.loading=!1})}return{show:a}}angular.module("com.vmware.vsphere.client.network").service("editVmkernelAdapterDialogService",e),e.$inject=["$rootScope","i18nService","dataService","vxMultiPageDialogService","editVmkernelAdapterDialogManager","hostVnicServiceFactory"]}(),function(){"use strict";function e(e,t,i,r,n){function o(t,i,o,s){return n(function(n){var c={};if(a(o.active,s))if(o.standby.length+o.unused.length>0)c.result=e.getString("NetworkUi","VssPhysicalNicEditor.warn.noActiveNics.text"),n(c);else{var l={};l.vSwitchName=i;var d=r.validate(t,"com.vmware.vsphere.client.h5.network.host.managepnic.model.ManagePnicValidateSpec",l);n(d)}else n(c)})}function a(e,t){return!_.some(e,function(e){if(null!==e&&t[e]&&t[e].isConnected)return!0})}function s(e,t,i,r){this._type="com.vmware.vsphere.client.h5.network.host.managepnic.model.VssPnicReconfigureSpec",this.vSwitchName=e,this.activeNic=t,this.standbyNic=i,this.unusedNic=r}this.show=function(a,c){function l(){var t=n.defer();return o(a,c,p.dialogData.failoverOrderOptions.connectees,p.dialogData.failoverOrderOptions.connecteesDetails).then(function(r){if(r&&r.result){var n={title:e.getString("NetworkUi","PhysicalNicFailoverOrderPage.warn.noActiveNics.title"),message:r.result,clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0,submit:function(){d(),t.resolve(!0)},onCancel:function(){t.resolve(!1)}};i.openConfirmationModal(n)}else d(),t.resolve(!0)}),t.promise.then(function(e){return e})}function d(){var e=new s(c,p.dialogData.failoverOrderOptions.connectees.active,p.dialogData.failoverOrderOptions.connectees.standby,p.dialogData.failoverOrderOptions.connectees.unused);r.apply(a,e._type,e)}var u={};u.noItemsSelectedMessage=e.getString("NetworkUi","FailoverOrderEditor.detailsPrompt"),u.headerOptions={title:e.getString("NetworkUi","FailoverOrderEditor.failoverOrder")},u.loading=!0;var p={title:e.getString("H5NetworkUi","manageVssPnicsDialog.title"),subTitle:{text:c},contentTemplate:"network-ui/resources/network/views/host/vnic/manageVssPnicsDialog.html",defaultButton:"submit",dialogData:u,alerts:[],size:"lg",modalClass:"manage-pnic-modal",onSubmit:l};i.openOkCancelModal(p),t.getPhysicalAdaptersWithDetails(a,c).then(function(t){var i={};i.active=t.active||[],i.standby=t.standby||[],i.unused=t.unused||[],i.unclaimed=t.unclaimed,p.dialogData.failoverOrderOptions={},p.dialogData.failoverOrderOptions.connectees=i,p.dialogData.failoverOrderOptions.connecteesDetails=t.pnicDetails,p.dialogData.failoverOrderOptions.labels={active:e.getString("NetworkUi","FailoverOrderEditor.active"),standby:e.getString("NetworkUi","FailoverOrderEditor.standby"),unused:e.getString("NetworkUi","FailoverOrderEditor.unused")},p.dialogData.editAllItems=!0,p.dialogData.loading=!1})}}angular.module("com.vmware.vsphere.client.network").service("manageVssPnicsDialogService",e),e.$inject=["i18nService","physicalAdaptersListService","clarityModalService","mutationService","$q"]}();var network_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;if(this.$scope=e,this.i18nService=t,this.bindToPhysicalAdapterService=i,this.vuiConstants=r,this.i18n=this.i18nService.getString.bind(this.i18nService,"NetworkUi"),this.$scope.manager.vnicData.bindToPnicPageModel.onCommit=function(){var e=n.$scope.manager.vnicData.bindToPnicPageModel.pinnedPnic,t=n.$scope.manager.vnicData.bindToPnicPageModel.componentData;return t.bindToPnicEnabled&&!t.selectedPnicForBinding?[{type:n.vuiConstants.validationBanner.type.ERROR,text:n.i18n("VnicToPnicBindingPage.error.noNic")}]:(t.bindToPnicEnabled?t.selectedPnicForBinding!==e&&(n.$scope.manager.vnicData.bindToPnicPageModel.dirty=!0):e&&(n.$scope.manager.vnicData.bindToPnicPageModel.dirty=!0),[])},!this.$scope.manager.vnicData.bindToPnicPageModel.componentData){var o=this.$scope.manager.vnicData.bindToPnicPageModel.opaqueNetworkSpec,a=this.$scope.manager.vnicData.bindToPnicPageModel.pinnedPnic,s={hostId:this.$scope.manager.vnicData.hostId,opaqueNetworkId:o.opaqueNetworkId,opaqueNetworkType:o.opaqueNetworkType,bindToPnicEnabled:null!==a,selectedPnicForBinding:a,availablePnicsData:null,onPnicSelectionChange:function(e){s.selectedPnicForBinding=e},onBindToPnicChange:function(e){s.bindToPnicEnabled=e},onAvailablePnicsDataChange:function(e){s.availablePnicsData=e},onLoadingStateUpdate:function(e){n.$scope.dialogOptions.loading=e}};this.$scope.manager.vnicData.bindToPnicPageModel.componentData=s,null!==this.$scope.manager.vnicData.bindToPnicPageModel.componentData.selectedPnicForBinding&&(this.$scope.dialogOptions.loading=!0,this.bindToPhysicalAdapterService.getDataByOpaqueNetworkSpec(this.$scope.manager.vnicData.hostId,o.opaqueNetworkId,o.opaqueNetworkType).then(function(e){n.$scope.manager.vnicData.bindToPnicPageModel.componentData.availablePnicsData=e})["finally"](function(){n.$scope.dialogOptions.loading=!1}))}this.bindToPnicModel=this.$scope.manager.vnicData.bindToPnicPageModel.componentData}return e.$inject=["$scope","i18nService","bindToPhysicalAdapterService","vuiConstants"],e}();e.EditBindToPhysicalAdapterController=t,angular.module("com.vmware.vsphere.client.network").controller("EditBindToPhysicalAdapterController",t)}(network_ui||(network_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(){e.manager.vnicData.ipv4PageModel.dirty=e.manager.vnicData.ipv4PageModel.dirty||e.nwEditVnicIpv4PageForm.$dirty;var i=e.manager.vnicData.ipv4PageModel.ipSettingsOption===r.ipSettingsOption.staticIp;if(e.manager.vnicData.ipv4PageModel.dirty&&i){e.validateIpAddress(),e.validateSubnetMask(),e.manager.vnicData.ipv4PageModel.isGatewayFeatureSupported&&e.manager.vnicData.ipv4PageModel.isGatewayOverriden&&e.manager.vnicData.ipv4PageModel.validateIpv4DefaultGateway();var n=e.manager.vnicData.ipv4PageModel.ipSettingsOption===r.ipSettingsOption.dhcp,o={hostId:e.manager.vnicData.hostId,dhcpEnabled:n,ipv4Address:e.manager.vnicData.ipv4PageModel.ipAddress,subnetMask:e.manager.vnicData.ipv4PageModel.subnetMask,isGatewayFeatureSupported:e.manager.vnicData.ipv4PageModel.isGatewayFeatureSupported,overrideGateway:e.manager.vnicData.ipv4PageModel.isGatewayOverriden,ipv4DefaultGateway:e.manager.vnicData.ipv4PageModel.defaultGateway,vnicName:e.manager.vnicData.vnicDevice},a=t.getValidationErrors(o);return a instanceof Array?s(a):a.then(function(e){return s(e)})}return!0}function s(e){return _.map(e,function(e){return{type:i.validationBanner.type.ERROR,text:e}})}return e.manager.vnicData.ipv4PageModel.onCommit=a,e.manager.vnicData.ipv4PageModel.validateIpv4DefaultGateway={},this.pageModel=e.manager.vnicData.ipv4PageModel,this.pageModel.isGatewayFeatureSupported=this.pageModel.isGatewayFeatureSupported,this.pageModel.dnsServers&&0===this.pageModel.dnsServers.length&&(this.pageModel.dnsServers=[o.getString("NetworkUi","NetworkUtil.noData")]),e.defaultGateway=this.pageModel&&this.pageModel.defaultGateway?this.pageModel.defaultGateway:o.getString("NetworkUi","NetworkUtil.noData"),this.ipv4PropertyType=n.IPV4.IP_ADDRESS,this.subnetMaskPropertyType=n.IPV4.SUBNET_MASK,this.defaultIpv4GatewayPropertyType=n.IPV4.DEFAULT_GATEWAY,this.defaultGatewayValidationMessage=o.getString("H5NetworkUi","AddNetworkingWizard.ipv4SettingsPage.invalidDefaultGatewayAddress"),this}angular.module("com.vmware.vsphere.client.network").controller("EditVnicIpv4PageController",e),e.$inject=["$scope","ipv4SettingsPageValidator","vuiConstants","vnicConstants","staticIpInputTypes","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(e){return $.extend(!0,[],_.filter(e,function(e){return e.operation!==i.changeOperation.remove}))}function s(e,t){var i=[];return _.forEach(e,function(e){l(t,e)&&i.push(e)}),i}function c(e,t){var i=[];return _.forEach(e,function(e){l(t,e)||i.push(e)}),i}function l(e,t){return _.some(e,function(e){return d(e,t)})}function d(e,t){return r.equalIpv6Addresses(e.address,t.address)&&e.prefixLength===t.prefixLength}function u(t){var i=[];return e.manager.vnicData.ipv6PageModel.staticIpEnabled&&(_.isEmpty(t)&&i.push(n.getString("NetworkUi","EditVnicView.noIpv6ManualAddressError")),e.manager.vnicData.ipv6PageModel.isGatewayOverridden&&(r.isIpv6AddressValid(e.manager.vnicData.ipv6PageModel.defaultGateway)||i.push(n.getString("NetworkUi","Ipv6GatewayDialog.defaultGateway.error")),(e.manager.vnicData.ipv6PageModel.dhcpEnabled||e.manager.vnicData.ipv6PageModel.autoConfigEnabled)&&i.push(n.getString("H5NetworkUi","VnicIpv6SettingsPage.invalidIpConfiguration")))),i.length?p(i):[]}function p(e){return _.map(e,function(e){return{type:t.validationBanner.type.ERROR,text:e}})}return this.defaultIpv6GatewayPropertyType=o.IPV6.DEFAULT_GATEWAY,this.pageModel=e.manager.vnicData.ipv6PageModel,e.defaultGateway=this.pageModel&&this.pageModel.defaultGateway?this.pageModel.defaultGateway:n.getString("NetworkUi","NetworkUtil.noData"),this.pageModel.isGatewayFeatureSupported=e.manager.vnicData.ipv4PageModel&&e.manager.vnicData.ipv4PageModel.isGatewayFeatureSupported,this.listData={},this.listData.defaultGateway=this.pageModel.defaultGateway,this.listData.hostIpv6Addresses=this.pageModel.hostIpAddresses,this.listData.ipv6List=this.pageModel.staticIpv6Addresses?a(this.pageModel.staticIpv6Addresses):[],this.onCommit=function(){var t=c(this.pageModel.staticIpv6Addresses,this.listData.ipv6List),r=c(this.listData.ipv6List,this.pageModel.staticIpv6Addresses),n=s(this.pageModel.staticIpv6Addresses,this.listData.ipv6List);return _.forEach(t,function(e){e.operation=i.changeOperation.remove}),_.forEach(r,function(e){e.operation=i.changeOperation.add}),e.manager.vnicData.ipv6PageModel.isGatewayFeatureSupported&&e.manager.vnicData.ipv6PageModel.isGatewayOverridden&&e.manager.vnicData.ipv6PageModel.validateIpv6DefaultGateway(),e.manager.vnicData.ipv6PageModel.dirty=!!e.manager.vnicData.ipv6PageModel.dirty||e.nwEditVnicIpv6PageForm.$dirty||r.length>0||t.length>0,this.pageModel.staticIpv6Addresses=n.concat(r,t),u(this.listData.ipv6List)},e.manager.vnicData.ipv6PageModel.onCommit=this.onCommit.bind(this),this}angular.module("com.vmware.vsphere.client.network").controller("EditVnicIpv6PageController",e),e.$inject=["$scope","vuiConstants","vnicConstants","ipParserService","i18nService","staticIpInputTypes"]}(),function(){"use strict";function e(e,t,i,r){function n(){a.errorTooltip.isVisible=!t.isMtuValid(a.pageModel.mtuInBytes)}function o(){var i=e.nwEditVnicPortPropertiesPageForm.mtu.$dirty;return e.manager.vnicData.portPropertiesPageModel.dirty=!!e.manager.vnicData.portPropertiesPageModel.dirty||i,i&&!t.isMtuValid(a.pageModel.mtuInBytes)?[{type:r.validationBanner.type.ERROR,text:s}]:[]}var a=this,s=i.getString("NetworkUi","AddNetworkingWizard.conPropPage.mtu.inputErrorMessage");return e.manager.vnicData.portPropertiesPageModel.onCommit=o,a.pageModel=e.manager.vnicData.portPropertiesPageModel,a.isTcpIpStackSupported=a.pageModel.hostVnicFeatures.isTcpIpStackSupported,a.errorTooltip={message:s,isVisible:!t.isMtuValid(a.pageModel.mtuInBytes)},a.validateMtu=n,a}angular.module("com.vmware.vsphere.client.network").controller("EditVnicPortPropertiesPageController",e),e.$inject=["$scope","networkUtil","i18nService","vuiConstants"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.network").constant("vnicConstants",{serviceKeyToNicTypeMap:{isVmotionEnabled:"vmotion",isProvisioningNfcTrafficEnabled:"vSphereProvisioning",isFtEnabled:"faultToleranceLogging",isHaEnabled:"management",isVRTrafficEnabled:"vSphereReplication",isVrNfcTrafficEnabled:"vSphereReplicationNFC",isVsanEnabled:"vsan"},ipSettingsOption:{unset:"unset",dhcp:"dhcp",staticIp:"staticIp"},changeOperation:{add:"add",remove:"remove"}})}();var network_ui;!function(e){var t=function(){function e(){this.dirty=!1}return e}();e.PropertiesPageModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.dirty=!1}return e}();e.SecurityPageModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.dirty=!1}return e.prototype.setPnics=function(e){e&&(this.pnics=new Object,this.pnics.active=e.active,this.pnics.standby=e.standby,this.pnics.unused=e.unused)},e}();e.TeamingAndFailoverPageModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.dirty=!1}return e}();e.TrafficShapingPageModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.dialogScope=e,this.i18nService=t,this.mutationService=i,this.editVirtualSwitchDialogValidator=r,this.portFailoverPolicyPageService=n,this.editPortgroupService=o,this.propertiesPageModel=e.propertiesPageModel,this.securityPageModel=e.securityPageModel,this.trafficShapingPageModel=e.trafficShapingPageModel,this.teamingAndFailoverPageModel=e.teamingAndFailoverPageModel}return e.prototype.getPageDefinitions=function(){this.initDialogPages();var e=[this.propertiesPage,this.securityPage,this.trafficShapingPage,this.teamingAndFailoverPage];return e},e.prototype.submit=function(){return(this.propertiesPageModel.dirty||this.securityPageModel.dirty||this.trafficShapingPageModel.dirty||this.teamingAndFailoverPageModel.dirty)&&this.mutationService.apply(this.dialogScope.hostId,e.EDIT_STANDARD_SWITCH_DIALOG_SPEC,this.buildSpec()),!0},e.prototype.buildSpec=function(){var e={propertiesData:{name:this.propertiesPageModel.name,mtu:this.propertiesPageModel.mtu,numberOfPorts:this.propertiesPageModel.numPorts,availableNumberOfPorts:this.propertiesPageModel.availableNumPorts,showRestartWarning:this.propertiesPageModel.showRestartWarning},securityPolicies:{allowPromiscuousMode:this.securityPageModel.allowPromiscuousMode,macChanges:this.securityPageModel.macChanges,forgedTransmits:this.securityPageModel.forgedTransmits},trafficShapingPolicies:{enabled:this.trafficShapingPageModel.enabled,averageBandwidth:null,peakBandwidth:null,burstSize:null},teamingAndFailover:{loadBalancing:this.teamingAndFailoverPageModel.loadBalancing,checkBeacon:this.teamingAndFailoverPageModel.checkBeacon,notifySwitches:this.teamingAndFailoverPageModel.notifySwitches,rollingOrder:this.teamingAndFailoverPageModel.rollingOrder,pnics:this.teamingAndFailoverPageModel.pnics}};return this.trafficShapingPageModel.enabled&&(e.trafficShapingPolicies.averageBandwidth=this.trafficShapingPageModel.averageBandwidth,e.trafficShapingPolicies.peakBandwidth=this.trafficShapingPageModel.peakBandwidth,e.trafficShapingPolicies.burstSize=this.trafficShapingPageModel.burstSize),e},e.prototype.initDialogPages=function(){var e=this;this.propertiesPage={title:this.i18nService.getString("NetworkUi","VSwitchPropertiesView.title"),contentUrl:"network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchPropertiesPage.html",onCommit:function(){if(e.propertiesPageModel.dirty=e.editPortgroupService.haveVirtualSwitchPropertiesChanged(e.propertiesPageModel.initialState,e.propertiesPageModel),e.propertiesPageModel.dirty){var t=e.editVirtualSwitchDialogValidator.getNumPortsError(e.dialogScope),i=e.editVirtualSwitchDialogValidator.getMtuError(e.dialogScope);return t.concat(i)}return[]}},this.securityPage={title:this.i18nService.getString("NetworkUi","PortSecurityPolicyView.title"),contentUrl:"network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchSecurityPage.html",onCommit:function(){return e.securityPageModel.dirty=e.editPortgroupService.hasSecurityPolicyChanged(e.securityPageModel.initialState,e.securityPageModel,!1),[]}},this.trafficShapingPage={title:this.i18nService.getString("NetworkUi","PortTrafficShapingPolicyView.title"),contentUrl:"network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchTrafficShapingPage.html",onCommit:function(){return e.trafficShapingPageModel.dirty=e.editPortgroupService.hasTrafficShapingPolicyChanged(e.trafficShapingPageModel.initialState,e.trafficShapingPageModel,!1),e.trafficShapingPageModel.dirty?e.editVirtualSwitchDialogValidator.getTrafficShapingInputsError(e.dialogScope):[]}},this.teamingAndFailoverPage={title:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.title"),contentUrl:"network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchTeamingAndFailoverPage.html",onCommit:function(){if(e.teamingAndFailoverPageModel.dirty=e.editPortgroupService.hasFailoverPolicyChanged(e.teamingAndFailoverPageModel.initialState,e.teamingAndFailoverPageModel,!1)||e.editPortgroupService.hasFailoverOrderChanged(e.teamingAndFailoverPageModel.initialState,e.teamingAndFailoverPageModel,!1),e.teamingAndFailoverPageModel.dirty){var t=e.editVirtualSwitchDialogValidator.getTeamingAndFailureInputsError(e.dialogScope.teamingAndFailoverPageModel),i=e.editVirtualSwitchDialogValidator.getTeamingAndFailoverWarnings(e.dialogScope.teamingAndFailoverPageModel);
if(t.length>0)return t;if(i.length>0)return e.portFailoverPolicyPageService.confirmWarningModal(i)}return!0}}},e.EDIT_STANDARD_SWITCH_DIALOG_SPEC="com.vmware.vsphere.client.h5.network.host.virtualswitch.model.EditStandardSwitchDialogData",e}();e.EditVirtualSwitchDialogManager=t,angular.module("com.vmware.vsphere.client.network").service("editVirtualSwitchDialogManager",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=e.EditVirtualSwitchDialogManager,i=function(){function e(e,t,i,r,n){this.i18nService=e,this.mutationService=t,this.editVirtualSwitchDialogValidator=i,this.portFailoverPolicyPageService=r,this.editPortgroupService=n}return e.prototype.createManager=function(e){return new t(e,this.i18nService,this.mutationService,this.editVirtualSwitchDialogValidator,this.portFailoverPolicyPageService,this.editPortgroupService)},e.$inject=["i18nService","mutationService","editVirtualSwitchDialogValidator","portFailoverPolicyPageService","editPortgroupService"],e}();e.EditVirtualSwitchDialogManagerFactory=i,angular.module("com.vmware.vsphere.client.network").service("editVirtualSwitchDialogManagerFactory",i)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=e.PropertiesPageModel,i=e.SecurityPageModel,r=e.TrafficShapingPageModel,n=e.TeamingAndFailoverPageModel,o=function(){function e(e,t,i,r,n){this.$rootScope=e,this.i18nService=t,this.dataService=i,this.editVirtualSwitchDialogManagerFactory=r,this.vxMultiPageDialogService=n,this.vSwitchProp="virtualswitch:editDialogData",this.i18n=t}return e.prototype.show=function(e,o){var a,s=this,c=this.$rootScope.$new();c.dialogOptions={},c.propertiesPageModel=new t,c.securityPageModel=new i,c.trafficShapingPageModel=new r,c.teamingAndFailoverPageModel=new n,c.dialogOptions.confirmOptions={onClick:function(){return a.submit()}},a=this.editVirtualSwitchDialogManagerFactory.createManager(c),_.extend(c.dialogOptions,{title:this.i18n.getString("NetworkUi","EditVSwitchSettingsView.title",o.name),pages:a.getPageDefinitions(),show:!0,loading:!0,loadingMessage:this.i18n.getString("CommonUi","wizard.loading"),validationBanner:{},rejectOptions:{rejectOnEsc:!0},resizable:!0,draggable:!0,maximizable:!0,height:"676px",width:"1000px"});var l={scope:c,configObjectName:"dialogOptions"};this.vxMultiPageDialogService(l),this.getVirtualSwitchDialogDataPromise(e,o.key).then(function(t){c.hostId=e,s.buildGeneralPageModel(t[s.vSwitchProp],c),c.dialogOptions.loading=!1})},e.prototype.buildGeneralPageModel=function(e,t){e&&(e.propertiesData&&(t.propertiesPageModel.name=e.propertiesData.name,t.propertiesPageModel.mtu=e.propertiesData.mtu,t.propertiesPageModel.numPorts=e.propertiesData.numberOfPorts,t.propertiesPageModel.availableNumPorts=e.propertiesData.availableNumberOfPorts+e.propertiesData.numberOfPorts,t.propertiesPageModel.showRestartWarning=e.propertiesData.showRestartWarning,t.propertiesPageModel.initialState=angular.copy(t.propertiesPageModel)),e.securityPolicies&&(t.securityPageModel.allowPromiscuousMode=e.securityPolicies.allowPromiscuousMode,t.securityPageModel.forgedTransmits=e.securityPolicies.forgedTransmits,t.securityPageModel.macChanges=e.securityPolicies.macChanges,t.securityPageModel.initialState=angular.copy(t.securityPageModel)),e.trafficShapingPolicies&&(t.trafficShapingPageModel.enabled=e.trafficShapingPolicies.enabled,t.trafficShapingPageModel.averageBandwidth=e.trafficShapingPolicies.averageBandwidth,t.trafficShapingPageModel.peakBandwidth=e.trafficShapingPolicies.peakBandwidth,t.trafficShapingPageModel.burstSize=e.trafficShapingPolicies.burstSize,t.trafficShapingPageModel.initialState=angular.copy(t.trafficShapingPageModel)),e.teamingAndFailover&&(t.teamingAndFailoverPageModel.loadBalancing=e.teamingAndFailover.loadBalancing,t.teamingAndFailoverPageModel.nicTeamingPolicy=e.teamingAndFailover.nicTeamingPolicy,t.teamingAndFailoverPageModel.checkBeacon=e.teamingAndFailover.checkBeacon,t.teamingAndFailoverPageModel.notifySwitches=e.teamingAndFailover.notifySwitches,t.teamingAndFailoverPageModel.rollingOrder=e.teamingAndFailover.rollingOrder,t.teamingAndFailoverPageModel.setPnics(e.teamingAndFailover.pnics),t.teamingAndFailoverPageModel.pnicDetails=e.teamingAndFailover.pnics?e.teamingAndFailover.pnics.pnicDetails:null,t.teamingAndFailoverPageModel.initialState=angular.copy(t.teamingAndFailoverPageModel)))},e.prototype.getVirtualSwitchDialogDataPromise=function(e,t){var i={_type:"com.vmware.vsphere.client.h5.network.host.virtualswitch.spec.VirtualSwitchIdSpec",key:t},r={propertyParams:[{propertyName:this.vSwitchProp,parameterType:i._type,parameter:i}]};return this.dataService.getProperties(e,[this.vSwitchProp],r)},e.$inject=["$rootScope","i18nService","dataService","editVirtualSwitchDialogManagerFactory","vxMultiPageDialogService"],e}();e.EditVirtualSwitchDialogService=o,angular.module("com.vmware.vsphere.client.network").service("editVirtualSwitchDialogService",o)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.networkUiConstants=t,this.networkUtil=i,this.vuiConstants=r,this.portFailoverPolicyPageService=n,this.trafficShapingPolicyValidator=o}return e.prototype.getNumPortsError=function(e){var t=[];return e&&e.propertiesPageModel&&e.propertiesPageModel.numPorts&&"number"==typeof e.propertiesPageModel.availableNumPorts&&e.propertiesPageModel.numPorts>e.propertiesPageModel.availableNumPorts&&t.push(this.createError(this.i18nService.getString("NetworkUi","VSwitchPropertiesView.availablePortsExceeded",e.propertiesPageModel.availableNumPorts))),t},e.prototype.getMtuError=function(e){var t=[];return e&&e.propertiesPageModel&&!this.networkUtil.isMtuValid(e.propertiesPageModel.mtu)&&t.push(this.createError(this.i18nService.getString("H5NetworkUi","VSwitchPropertiesPage.mtu.errorMessage",this.networkUiConstants.Mtu.MIN,this.networkUiConstants.Mtu.MAX))),t},e.prototype.getTrafficShapingInputsError=function(e){var t=this,i=[],r=["averageBandwidth","peakBandwidth","burstSize"];return e&&e.trafficShapingPageModel&&e.trafficShapingPageModel.enabled&&(_.forEach(r,function(r){var n=e.trafficShapingPageModel[r],o=t.trafficShapingPolicyValidator.getTrafficShapingErrorMessage(n,r);null!==o&&i.push(t.createError(o))}),0===i.length&&e.trafficShapingPageModel.averageBandwidth>e.trafficShapingPageModel.peakBandwidth&&i.push(this.createError(this.i18nService.getString("NetworkUi","PortPolicyData.shaping.error.avgBwGreaterThanPeakBw")))),i},e.prototype.getTeamingAndFailureInputsError=function(e){var t=[];return e&&!this.isFailureDetectionValid(e.checkBeacon,e.pnics)&&t.push(this.createError(this.i18nService.getString("NetworkUi","PortPolicyData.failover.error.beaconProbingSingleNic"))),t},e.prototype.getIpHashWarnings=function(e){var t=[],i=!1;if(!e)throw new Error("Invalid parameter");e.pnics&&(i=this.getNicLength(e.pnics.standby)>0);var r=e.loadBalancing===this.networkUiConstants.LoadBalancingPolicy.IP;return r&&i&&e.checkBeacon?t.push(this.createWarning(this.i18nService.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbingAndStandbyUplinks"))):r&&i?t.push(this.createWarning(this.i18nService.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.standbyUplinks"))):r&&e.checkBeacon&&t.push(this.createWarning(this.i18nService.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbing"))),t},e.prototype.getTeamingAndFailoverWarnings=function(e){var t=this.getIpHashWarnings(e),i=!1;if(!e)throw"Invalid parameter.";return e.pnics&&(i=this.getNicLength(e.pnics.active)>0),i||t.push(this.createWarning(this.i18nService.getString("NetworkUi","PortPolicyData.failover.error.noActiveAdapters"))),t},e.prototype.isFailureDetectionValid=function(e,t){var i=0;return t&&(i=this.getNicLength(t.active)+this.getNicLength(t.standby)+this.getNicLength(t.unused)),!(e&&i<2)},e.prototype.getLoadBalancingInfoMessages=function(){return[this.createInfo(this.i18nService.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.info.etherChannel")),this.createInfo(this.i18nService.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.info.portGroupPolicies"))]},e.prototype.getNicLength=function(e){var t=0;return e&&(t=e.length),t},e.prototype.createError=function(e){return{type:this.vuiConstants.validationBanner.type.ERROR,text:e}},e.prototype.createWarning=function(e){return{iconClass:"vsphere-icon-status-warning",text:e}},e.prototype.createInfo=function(e){return{iconClass:"vsphere-icon-info",text:e}},e.$inject=["i18nService","networkUiConstants","networkUtil","vuiConstants","portFailoverPolicyPageService","trafficShapingPolicyValidator"],e}();e.EditVirtualSwitchDialogValidator=t,angular.module("com.vmware.vsphere.client.network").service("editVirtualSwitchDialogValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.controller=i,this.templateUrl="network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchPropertiesPageComponent.html"}return e}();e.EditVirtualSwitchPropertiesPageComponent=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.$scope=t,this.networkUiConstants=i,this.networkUtil=r}return e.prototype.$onInit=function(){this.pageModel.portNumbers=this.getPortNumbers(),this.mtuValidator={message:this.i18nService.getString("H5NetworkUi","VSwitchPropertiesPage.mtu.errorMessage",this.networkUiConstants.Mtu.MIN,this.networkUiConstants.Mtu.MAX),isVisible:!1}},e.prototype.getPortNumbers=function(){for(var e=[this.networkUiConstants.NumPorts.MIN];_.last(e)<this.networkUiConstants.NumPorts.MAX;)e.push(2*_.last(e));return e},e.prototype.validateMtu=function(){this.mtuValidator.isVisible=!this.networkUtil.isMtuValid(this.pageModel.mtu)},e.$inject=["i18nService","$scope","networkUiConstants","networkUtil"],e}();angular.module("com.vmware.vsphere.client.network").component("editVirtualSwitchPropertiesPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.templateUrl="network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchSecurityPageComponent.html",this.controller=i}return e}();e.EditVirtualSwitchSecurityPageComponent=t;var i=function(){function e(e,t){this.i18nService=e,this.$scope=t,this.options=this.getOptions()}return e.prototype.getOptions=function(){var e=[{label:this.i18nService.getString("NetworkUi","PortSecurityPolicyPage.accept"),val:!0},{label:this.i18nService.getString("NetworkUi","PortSecurityPolicyPage.reject"),val:!1}];return e},e.$inject=["i18nService","$scope"],e}();angular.module("com.vmware.vsphere.client.network").component("editVirtualSwitchSecurityPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.templateUrl="network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchTeamingAndFailoverPageComponent.html",this.controller=i}return e}();e.EditVirtualSwitchTeamingAndFailoverPageComponent=t;var i=function(){function e(e,t,i,r,n,o){this.$scope=e,this.networkUtil=t,this.i18nService=i,this.networkUiConstants=r,this.editVirtualSwitchDialogValidator=n,this.portFailoverPolicyPageService=o}return e.prototype.$onInit=function(){this.loadBalancingOptions=this.networkUtil.createNicTeamingPolicyOptions(this.pageModel.nicTeamingPolicy),this.validators=this.getValidators(),this.failureDetectionOptions=this.getFailureDetectionOptions(),this.notifySwitchesOptions=this.getNotifySwitchesOptions(),this.rollingOrderOptions=this.getRollingOrderOptions(),this.failoverOrder={connectees:this.pageModel.pnics,connecteesDetails:this.pageModel.pnicDetails,labels:{active:this.networkUtil.getString("FailoverOrderEditor.active"),standby:this.networkUtil.getString("FailoverOrderEditor.standby"),unused:this.networkUtil.getString("FailoverOrderEditor.unused")}},this.datagridHeaderOptions={title:this.networkUtil.getString("PortFailoverPolicyPage.orderLabel")},this.noItemsSelectedMessage=this.networkUtil.getString("FailoverOrderEditor.detailsPrompt"),this.failoverOrderActions=[this.networkUiConstants.failoverOrderActions.MOVE_UP,this.networkUiConstants.failoverOrderActions.MOVE_DOWN],this.signPostConfig={message:null,title:this.networkUtil.getString("PortFailoverPolicyPage.lb.loadbalance_ip.popup.title"),"class":"edit-standard-vswitch-signpost"},this.initWatch()},e.prototype.initWatch=function(){var e=this;this.$scope.$watchCollection(function(){var t=[e.pageModel.checkBeacon,e.pageModel.loadBalancing];return e.pageModel.pnics&&(t.push(e.pageModel.pnics.active.length),t.push(e.pageModel.pnics.standby.length),t.push(e.pageModel.pnics.unused.length)),t},function(){e.updateSignPostConfig()})},e.prototype.updateSignPostConfig=function(){var e=[];if(this.pageModel.loadBalancing===this.networkUiConstants.LoadBalancingPolicy.IP){var t=this.editVirtualSwitchDialogValidator.getIpHashWarnings(this.pageModel),i=this.editVirtualSwitchDialogValidator.getLoadBalancingInfoMessages();e=e.concat(t),e=e.concat(i),this.signPostIcon=t.length>0?"exclamation-triangle":"info-circle"}this.signPostConfig.message=this.portFailoverPolicyPageService.formatMessages(e)},e.prototype.onFailureDetectionChange=function(){this.validators.failureDetection.isVisible=!this.editVirtualSwitchDialogValidator.isFailureDetectionValid(this.pageModel.checkBeacon,this.pageModel.pnics)},e.prototype.getValidators=function(){var e=new Object;return e.failureDetection={message:this.i18nService.getString("NetworkUi","PortPolicyData.failover.error.beaconProbingSingleNic"),isVisible:!1},e},e.prototype.getFailureDetectionOptions=function(){return[{label:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.linkStatus"),val:!1},{label:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.beaconProbing"),val:!0}]},e.prototype.getNotifySwitchesOptions=function(){return[{label:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.notifyOff"),val:!1},{label:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.notifyOn"),val:!0}]},e.prototype.getRollingOrderOptions=function(){return[{label:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.failbackOff"),val:!0},{label:this.i18nService.getString("NetworkUi","PortFailoverPolicyView.failbackOn"),val:!1}]},e.$inject=["$scope","networkUtil","i18nService","networkUiConstants","editVirtualSwitchDialogValidator","portFailoverPolicyPageService"],e}();angular.module("com.vmware.vsphere.client.network").component("editVirtualSwitchTeamingAndFailoverPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){this.bindings={pageModel:"<"},this.templateUrl="network-ui/resources/network/views/host/vswitch/edit/views/editVirtualSwitchTrafficShapingPageComponent.html",this.controller=i}return e}();e.EditVirtualSwitchTrafficShapingPageComponent=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$scope=t,this.trafficShapingPolicyValidator=i,this.networkUtil=r,this.networkUiConstants=n,this.options=this.getOptions(),this.minValue=1,this.validators={averageBandwidth:{message:"",isVisible:!1},peakBandwidth:{message:"",isVisible:!1},burstSize:{message:"",isVisible:!1}}}return e.prototype.getOptions=function(){var e=[{label:this.i18nService.getString("NetworkUi","PortTrafficShapingPolicyView.statusOn"),val:!0},{label:this.i18nService.getString("NetworkUi","PortTrafficShapingPolicyView.statusOff"),val:!1}];return e},e.prototype.onStatusChange=function(){this.validateTrafficShaping("averageBandwidth",this.pageModel.averageBandwidth,this.validators.averageBandwidth),this.validateTrafficShaping("peakBandwidth",this.pageModel.peakBandwidth,this.validators.peakBandwidth),this.validateTrafficShaping("burstSize",this.pageModel.burstSize,this.validators.burstSize)},e.prototype.validateTrafficShaping=function(e,t,i){var r=this.trafficShapingPolicyValidator.getTrafficShapingErrorMessage(t,e);i.message=r,i.isVisible=this.pageModel.enabled&&null!==r},e.prototype.onTrafficShapingChange=function(e){switch(e){case"averageBandwidth":this.validateTrafficShaping("averageBandwidth",this.pageModel.averageBandwidth,this.validators.averageBandwidth);break;case"peakBandwidth":this.validateTrafficShaping("peakBandwidth",this.pageModel.peakBandwidth,this.validators.peakBandwidth);break;case"burstSize":this.validateTrafficShaping("burstSize",this.pageModel.burstSize,this.validators.burstSize)}},e.$inject=["i18nService","$scope","trafficShapingPolicyValidator","networkUtil","networkUiConstants"],e}();angular.module("com.vmware.vsphere.client.network").component("editVirtualSwitchTrafficShapingPage",new t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){}return e}();e.VmMigrateWizardFlags=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(){}return e}();e.VmMigrateWizardModel=t}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t}return e.prototype.getValidationError=function(e){var t=[];return e.flags.noSourceNetworkSelected||e.model.sourceNetwork||t.push(this.i18nService.getString("NetworkUi","SelectSourceDestinationNetworkPage.noSourceSelected")),e.model.destinationNetwork||t.push(this.i18nService.getString("NetworkUi","SelectSourceDestinationNetworkPage.noDestinationSelected")),!e.flags.noSourceNetworkSelected&&this.areNetworksEqual(e.model.sourceNetwork,e.model.destinationNetwork)&&t.push(this.i18nService.getString("NetworkUi","SelectSourceDestinationNetworkPage.invalidDestinationError")),this.$q.resolve(t)},e.prototype.areNetworksEqual=function(e,t){return e&&t&&e.networkRef&&t.networkRef&&e.networkRef.type===t.networkRef.type&&e.networkRef.value===t.networkRef.value&&e.networkRef.serverGuid===t.networkRef.serverGuid},e.$inject=["i18nService","$q"],e}();e.VmMigrateSelectNetworksPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("vmMigrateSelectNetworksPageValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.$q=t,this.wizardConstants=i}return e.prototype.getValidationError=function(e){var t=[];return this.hasSelectedItem(e.model.vmListItems)||t.push(this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.noAdaptersSelected")),this.$q.resolve(t)},e.prototype.hasSelectedItem=function(e){if(!e)return!1;for(var t=0,i=e;t<i.length;t++){var r=i[t];if(r.isChecked)return!0}return!1},e.$inject=["i18nService","$q","vmMigrateWizardConstants"],e}();e.VmMigrateSelectVmsPageValidator=t,angular.module("com.vmware.vsphere.client.network").service("vmMigrateSelectVmsPageValidator",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r){this.$wizardScope=e,this.i18nService=t,this.wizardConstants=i,this.vxPropertyViewService=r;var n=r.createPropertyViewBuilder(),o=n.category("general"),a=o.section("generalSection");this.$wizardScope.flags.noSourceNetworkSelected?a.property(this.i18nService.getString("H5NetworkUi","VmMigrateWizard.summary.source"),this.i18nService.getString("H5NetworkUi","VmMigrateWizard.summary.noNetwork")):a.property(this.i18nService.getString("H5NetworkUi","VmMigrateWizard.summary.sourceNetwork"),this.$wizardScope.model.sourceNetwork.name),a.property(this.i18nService.getString("H5NetworkUi","VmMigrateWizard.summary.destinationNetwork"),this.$wizardScope.model.destinationNetwork.name),a.property(this.i18nService.getString("H5NetworkUi","VmMigrateWizard.summary.numberOfVmsToMigrate"),this.getNumVms(this.$wizardScope.model.vmListItems)),a.property(this.i18nService.getString("H5NetworkUi","VmMigrateWizard.summary.numberOfAdaptersToMigrate"),this.getNumVnics(this.$wizardScope.model.vmListItems)),this.$wizardScope.model.summaryData=n.build()}return e.prototype.getNumVms=function(e){for(var t={},i=0,r=0,n=e;r<n.length;r++){var o=n[r];!t[o.vmId]&&o.isChecked&&(i++,t[o.vmId]=o)}return String(i)},e.prototype.getNumVnics=function(e){var t=0;if(e){var i=_.filter(e,function(e){return e.isChecked&&e.virtualEthernetCard});t=i.length}return t.toString()},e.$inject=["$scope","i18nService","vmMigrateWizardConstants","vxPropertyViewService"],e}();angular.module("com.vmware.vsphere.client.network").controller("VmMigrateReadyToCompletePageController",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$wizardScope=e,this.i18nService=t,this.selectorMode=i,this.networkSelectorDialogService=r,this.wizardConstants=n,this.defaultUriSchemeUtil=o,this.dataService=a,!e.flags.isSelectNetworksPageInitialized&&this.$wizardScope.flags.isSourceNetworkPreselected&&this.requestProperties(),this.networkSelectorMode=this.selectorMode.SINGLE_SELECTION_BROWSE_INPUT,this.networkSelectorFilterSpec=this.networkSelectorDialogService.createNetworkSelectorFilterSpec(!0,!0,!0,!1,!1),this.networkSelectorDialogSpec=this.networkSelectorDialogService.createNetworkSelectorDialogSpec(["Network.Assign"],this.i18nService.getString("NetworkUi","SelectSourceDestinationNetworkPage.noNetworkAssignPrivilegeError")),this.onSourceNetworksChanged=function(e){s.$wizardScope.model.sourceNetwork!==e[0]&&(s.$wizardScope.model.sourceNetwork=e[0],s.clearFlags())},this.onDestinationNetworksChanged=function(e){s.$wizardScope.model.destinationNetwork!==e[0]&&(s.$wizardScope.model.destinationNetwork=e[0],s.clearFlags())},this.$wizardScope.$watch(function(){return s.$wizardScope.flags.noSourceNetworkSelected},function(e,t){e!==t&&s.clearFlags()})}return e.prototype.clearFlags=function(){this.$wizardScope.flags.isSelectVmsPageInitialized=!1,this.$wizardScope.flags.inaccessibilityWarningShown=!1},e.prototype.requestProperties=function(){var e=this;this.$wizardScope.wizardConfig.loading=!0,this.dataService.getProperties(this.$wizardScope.model.contextObjId,[this.wizardConstants.properties.NAME_PROPERTY,this.wizardConstants.properties.ICON_PROPERTY]).then(function(t){e.$wizardScope.model.sourceNetwork={name:t[e.wizardConstants.properties.NAME_PROPERTY],icon:t[e.wizardConstants.properties.ICON_PROPERTY],networkRef:e.defaultUriSchemeUtil.getManagedObjectReference(e.$wizardScope.model.contextObjId)},e.$wizardScope.wizardConfig.loading=!1,e.$wizardScope.flags.isSelectNetworksPageInitialized=!0})},e.$inject=["$scope","i18nService","NetworkSelectorMode","networkSelectorDialogService","vmMigrateWizardConstants","defaultUriSchemeUtil","dataService"],e}();angular.module("com.vmware.vsphere.client.network").controller("VmMigrateSelectNetworksPageController",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.$wizardScope=e,this.i18nService=t,this.columnRenderersRegistry=i,this.wizardConstants=r,this.dataService=n,this.clarityModalService=o,this.defaultUriSchemeUtil=a,this.vuiConstants=s,this.filterDatagridDataDebounced=_.debounce(this.filterDatagridData.bind(this),500),this.$wizardScope.flags.isSelectVmsPageInitialized?this.initialize(e.model.vmListItems):this.requestProperties(),this.selectVmsInfo=this.$wizardScope.flags.noSourceNetworkSelected?this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.selectVmsLabelNoSource",this.$wizardScope.model.destinationNetwork.name):this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.selectVmsLabel",this.$wizardScope.model.sourceNetwork.name,this.$wizardScope.model.destinationNetwork.name)}return Object.defineProperty(e.prototype,"searchTerm",{get:function(){return this._searchTerm},set:function(e){this._searchTerm=e,this.filterDatagridDataDebounced()},enumerable:!0,configurable:!0}),e.prototype.requestProperties=function(){var e=this;this.$wizardScope.wizardConfig.loading=!0;var t=this.defaultUriSchemeUtil.getVsphereObjectId(this.$wizardScope.model.destinationNetwork.networkRef),i={sourceNetworkRef:this.$wizardScope.flags.noSourceNetworkSelected?null:this.$wizardScope.model.sourceNetwork.networkRef,datacenterRef:this.defaultUriSchemeUtil.getManagedObjectReference(this.$wizardScope.model.datacenterId)};this.dataService.getProperties(t,[this.wizardConstants.properties.VM_NETWORKS_PROPERTY],{propertyParams:[{propertyName:this.wizardConstants.properties.VM_NETWORKS_PROPERTY,parameterType:this.wizardConstants.specs.VM_MIGRATE_PROPERTY_SPEC,parameter:i}]}).then(function(t){var i=t[e.wizardConstants.properties.VM_NETWORKS_PROPERTY];e.$wizardScope.model.destinationNetworkData=i.destinationNetwork,e.$wizardScope.model.vmListItems=i.vmListItems,e.$wizardScope.wizardConfig.loading=!1,e.$wizardScope.flags.isSelectVmsPageInitialized=!0,e.initialize(i.vmListItems)})},e.prototype.initialize=function(e){this.items=e,this.itemsById={};for(var t=0,i=e;t<i.length;t++){var r=i[t],n=r.vmId+"_"+r.adapter;this.itemsById[n]=r,r.isAccessibleLabel=r.isAccessible?this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.accessible"):this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.inaccessible")}this.initDatagridOptions(e),this.evaluateMasterCheckboxState()},e.prototype.filterDatagridData=function(){var e=this;this._searchTerm?this.datagridOptions.data=_.filter(this.items,function(t){return e.isItemMatchingSearchTerm(t)}):this.datagridOptions.data=this.items,this.evaluateMasterCheckboxState()},e.prototype.isItemMatchingSearchTerm=function(e){var t=this,i=_.pluck(this.datagridOptions.columnDefs,"field");return _.some(i,function(i){return!!e[i]&&(!t._searchTerm||e[i].toLowerCase().indexOf(t._searchTerm.toLowerCase())!==-1)})},e.prototype.onItemCheckboxClick=function(e,t){this.itemsById[e].isChecked=t.currentTarget.checked,this.evaluateMasterCheckboxState()},e.prototype.onMasterCheckboxClick=function(e){var t=e.currentTarget.checked;this._isMasterCheckboxChecked=t;for(var i=!1,r=t?this.datagridOptions.data:this.items,n=0,o=r;n<o.length;n++){var a=o[n];a.isAccessible?a.isChecked=t:i=!0}t&&i&&!this.$wizardScope.flags.inaccessibilityWarningShown&&this.showWarningDialog()},e.prototype.isItemChecked=function(e){return this.itemsById[e].isChecked},e.prototype.getIsMasterCheckboxChecked=function(){return this._isMasterCheckboxChecked},e.prototype.evaluateMasterCheckboxState=function(){var e=!1,t=!1;this.datagridOptions.data.length>0&&(e=_.all(this.datagridOptions.data,function(e){return t=t||e.isAccessible,!e.isAccessible||e.isChecked})),this._isMasterCheckboxChecked=e&&t},e.prototype.showWarningDialog=function(){var e=this;this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.vmsWithInaccessibleDestinationSelected.title"),message:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.vmsWithInaccessibleDestinationSelected.description"),submit:function(){e.$wizardScope.flags.inaccessibilityWarningShown=!0},clarityIcon:{"class":"is-warning",shape:"warning-standard",size:"32"},preserveNewlines:!0,saveButtonLabel:this.i18nService.getString("Common","alert.ok"),cancelButtonLabel:null,hideCancelButton:!0})},e.prototype.initDatagridOptions=function(e){this.datagridOptions={columnDefs:this.getColumnDefs(),sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.NONE,selectedItems:[],data:e,resizable:!0,height:"100%",pageConfig:{hidePager:!0,displayMode:this.vuiConstants.grid.displayMode.VIRTUAL_SCROLLING},isMasterCheckboxDisabled:_.all(e,function(e){return!e.isAccessible}),getIsMasterCheckboxChecked:this.getIsMasterCheckboxChecked.bind(this),onItemCheckboxClick:this.onItemCheckboxClick.bind(this),onMasterCheckboxClick:this.onMasterCheckboxClick.bind(this),isItemChecked:this.isItemChecked.bind(this)}},e.prototype.getColumnDefs=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("disabled-text-icon-with-tooltip");return[this.getCheckboxColumnDef(),{field:"name",displayName:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.vmNameColumnHeader"),width:"165px",searchable:!1,template:function(e){return t(["icon","label","disabled","tooltip"],{icon:e.iconId,label:e.name,disabled:!e.isAccessible,tooltip:e.itemTooltip})}},{field:"adapter",displayName:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.vmNicColumnHeader"),width:"165px",searchable:!1,template:function(e){return t(["icon","label","disabled","tooltip"],{icon:"network-lib-ui-icon-virtualAdapter",label:e.adapter,disabled:!e.isAccessible,tooltip:e.itemTooltip})}},{field:"hostName",displayName:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.hostColumnHeader"),searchable:!1,template:function(e){return t(["icon","label","disabled","tooltip"],{icon:e.hostName?"vsphere-icon-host":null,label:e.hostName,disabled:!e.isAccessible,tooltip:e.itemTooltip})}},{field:"isAccessibleLabel",displayName:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.destNetworkColumnHeader"),searchable:!1,template:function(i){var r="";return r=i.isAccessible?e.i18nService.getString("NetworkUi","SelectVmsToMigratePage.accessible"):e.i18nService.getString("NetworkUi","SelectVmsToMigratePage.inaccessible"),t(["icon","label","disabled","tooltip"],{icon:null,label:r,disabled:!i.isAccessible,tooltip:i.itemTooltip})}}]},e.prototype.getCheckboxColumnDef=function(){var e='<input type="checkbox"\n                       ng-disabled="datagridOptions.isMasterCheckboxDisabled"\n                       ng-checked="datagridOptions.getIsMasterCheckboxChecked()"\n                       ng-click="datagridOptions.onMasterCheckboxClick($event)"/>';return{filterable:!1,sortable:!1,groupable:!1,searchable:!1,width:"30px",headerTemplate:e,template:function(e){var t=e.vmId+"_"+e.adapter;return'<input type="checkbox"\n                                 ng-disabled="'+!e.isAccessible+'"\n                                 ng-checked="datagridOptions.isItemChecked(\''+t+"')\"\n                                 ng-click=\"datagridOptions.onItemCheckboxClick('"+t+"', $event)\"/>"}}},e.$inject=["$scope","i18nService","columnRenderersRegistry","vmMigrateWizardConstants","dataService","clarityModalService","defaultUriSchemeUtil","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.network").controller("VmMigrateSelectVmsPageController",t)}(network_ui||(network_ui={}));var network_ui;!function(e){angular.module("com.vmware.vsphere.client.network").constant("vmMigrateWizardConstants",{pages:{VM_SELECT_NETWORKS_PAGE:"selectNetworksPage",VM_SELECT_VMS_TO_MIGRATE_PAGE:"selectVmsToMigratePage",VM_MIGRATE_READY_TO_COMPLETE_PAGE:"readyToCompletePage"},properties:{NAME_PROPERTY:"name",ICON_PROPERTY:"primaryIconId",DATACENTER_PROPERTY:"dc",VM_NETWORKS_PROPERTY:"migratevms:vmsNetworkProperties"},objectType:{DATACENTER_TYPE:"Datacenter"},specs:{VM_MIGRATE_PROPERTY_SPEC:"com.vmware.vsphere.client.h5.network.vm.migrate.specs.MigrateVmPropertySpec",VM_MIGRATE_VM_VNICS_SPEC:"com.vmware.vsphere.client.h5.network.vm.migrate.specs.MigrateVmVnicsSpec",VM_MIGRATE_NETWORKING_SPEC:"com.vmware.vsphere.client.h5.network.vm.migrate.specs.MigrateVmNetworkingSpec",VM_NETWORK_PROPERTIES_SPEC:"com.vmware.vsphere.client.h5.network.vm.migrate.model.VmNetworkProperties"}})}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.wizardConstants=t,this.selectNetworksPageValidator=i,this.selectVmsPageValidator=r,this.simpleValidationCommit=n}return e.prototype.createPages=function(e){var t=this,i={id:this.wizardConstants.pages.VM_SELECT_NETWORKS_PAGE,title:this.i18nService.getString("NetworkUi","SelectSourceDestinationNetworkPage.title"),description:this.i18nService.getString("NetworkUi","SelectSourceDestinationNetworkPage.description"),contentUrl:"network-ui/resources/network/views/vm/migrate/views/vmMigrateSelectNetworksPage.html",onCommit:this.simpleValidationCommit(function(){return t.selectNetworksPageValidator.getValidationError(e)},e.wizardConfig),validationParams:[]},r={id:this.wizardConstants.pages.VM_SELECT_VMS_TO_MIGRATE_PAGE,
title:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.title"),description:this.i18nService.getString("NetworkUi","SelectVmsToMigratePage.description"),contentUrl:"network-ui/resources/network/views/vm/migrate/views/vmMigrateSelectVmsPage.html",onCommit:this.simpleValidationCommit(function(){return t.selectVmsPageValidator.getValidationError(e)},e.wizardConfig),validationParams:["flags.isSelectVmsPageInitialized"]},n={id:this.wizardConstants.pages.VM_MIGRATE_READY_TO_COMPLETE_PAGE,title:this.i18nService.getString("H5NetworkUi","vmMigrateWizard.readyToCompletePage.title"),description:this.i18nService.getString("H5NetworkUi","vmMigrateWizard.readyToCompletePage.description"),contentUrl:"network-ui/resources/network/views/vm/migrate/views/vmMigrateReadyToCompletePage.html",onCommit:function(){return!0},validationParams:[]};return[i,r,n]},e.$inject=["i18nService","vmMigrateWizardConstants","vmMigrateSelectNetworksPageValidator","vmMigrateSelectVmsPageValidator","simpleValidationCommit"],e}();e.VmMigrateWizardPages=t,angular.module("com.vmware.vsphere.client.network").service("vmMigrateWizardPages",t)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=e.VmMigrateWizardModel,i=e.VmMigrateWizardFlags,r=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.pageStateManagementService=r,this.mutationService=n,this.wizardConstants=o,this.vmMigrateWizardPages=a,this.dataService=s,this.defaultUriSchemeUtil=c,this.wizardValidationService=l,this.vmMigrateWizardSpecFactory=d}return e.prototype.show=function(e){var t=this,i=this.$rootScope.$new();i.model=this.initWizardModel(e),i.flags=this.initWizardFlags(),i.wizardConfig={title:this.i18nService.getString("NetworkUi","VmMigrateWizard.title"),loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),cssClass:"migrate-vm-networking-wizard",onFinish:function(){var e=t.vmMigrateWizardSpecFactory.buildVmMigrateSpec(i.model);return t.mutationService.apply(i.model.contextObjId,t.wizardConstants.specs.VM_MIGRATE_NETWORKING_SPEC,e),!0}},i.wizardConfig.pages=this.vmMigrateWizardPages.createPages(i),this.wizardValidationService.initWizardValidation(i),this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(i);var r=this.defaultUriSchemeUtil.getManagedObjectReference(e);r&&r.type!==this.wizardConstants.objectType.DATACENTER_TYPE?(i.flags.isSourceNetworkPreselected=!0,this.dataService.getProperties(e,[this.wizardConstants.properties.DATACENTER_PROPERTY]).then(function(e){var r=e[t.wizardConstants.properties.DATACENTER_PROPERTY];r&&(i.model.datacenterId=t.defaultUriSchemeUtil.getVsphereObjectId(r)),t.invokeWizard(i)})):(i.model.datacenterId=e,this.invokeWizard(i))},e.prototype.invokeWizard=function(e){this.vuiWizardService({scope:e,configObjectName:"wizardConfig"}).show()},e.prototype.initWizardModel=function(e){var i=new t;return i.contextObjId=e,i},e.prototype.initWizardFlags=function(){var e=new i;return e.isSelectVmsPageInitialized=!1,e.isSelectNetworksPageInitialized=!1,e.inaccessibilityWarningShown=!1,e.noSourceNetworkSelected=!1,e.isSourceNetworkPreselected=!1,e},e.$inject=["$rootScope","i18nService","vuiWizardService","pageStateManagementService","mutationService","vmMigrateWizardConstants","vmMigrateWizardPages","dataService","defaultUriSchemeUtil","wizardValidationService","vmMigrateWizardSpecFactory"],e}();e.VmMigrateWizardService=r,angular.module("com.vmware.vsphere.client.network").service("vmMigrateWizardService",r)}(network_ui||(network_ui={}));var network_ui;!function(e){var t=function(){function e(e,t){this.defaultUriSchemeUtil=e,this.wizardConstants=t}return e.prototype.buildVmMigrateSpec=function(e){for(var t=e.vmListItems,i={},r={},n=0,o=t;n<o.length;n++){var a=o[n];if(a.isChecked){r[a.vmId]=a.changeVersion,i[a.vmId]||(i[a.vmId]=[]);var s=i[a.vmId];s.push(a.virtualEthernetCard)}}var c=[];for(var l in i){var d={_type:this.wizardConstants.specs.VM_MIGRATE_VM_VNICS_SPEC,vmRef:this.defaultUriSchemeUtil.getManagedObjectReference(l),vmChangeVersion:r[l],vnics:i[l]};c.push(d)}return{vmVnicsSpecs:c,destinationNetwork:e.destinationNetworkData}},e.$inject=["defaultUriSchemeUtil","vmMigrateWizardConstants"],e}();e.VmMigrateWizardSpecFactory=t,angular.module("com.vmware.vsphere.client.network").service("vmMigrateWizardSpecFactory",t)}(network_ui||(network_ui={})),h5=h5||{},h5.cluster={angularModule:angular.module("com.vmware.vsphere.client.cluster",["com.vmware.platform.ui","com.vmware.vsphere.client.commonModule","com.vmware.vsphere.client.licenseLibUi"])},angular.module("com.vmware.vsphere.client.cluster").run(["mutationService","i18nService","$rootScope","vuiConstants","haDialogService","clarityModalService","clusterGroupsService","clusterRulesService","clusterRulesConstants","alertService","clusterVmOverridesService","clusterConfigVmOverrideService","assignLicenseService","editDrsDialogService","moveResourcePoolToService","featureFlagsService","scheduleDrsWizardService","quickstartRefreshService","moveClusterToService",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S){function y(e,i){var r=g.HCIEnabled()?"cluster-ui/resources/cluster/views/create_cluster/CreateNewCluster.html":"cluster-ui/resources/cluster/views/create_cluster/CreateCluster.html",n={title:t.getString("ClusterUi","createClusterDialog.title"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:r,size:"md",modalClass:"create-cluster-dialog",dialogData:{availableTargets:i,objectId:i[0]}};o.openOkCancelModal(n)}function P(e,i){var r="cluster-ui/resources/cluster/views/edit_cluster/EditCluster.html",n={title:t.getString("ClusterUi","editClusterDialog.title"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:r,size:"md",modalClass:"create-cluster-dialog",dialogData:{availableTargets:i,objectId:i[0]}};Z.run(function(){o.openOkCancelModal(n)})}function C(e,t,i){v.show(t[0],i&&i.focusTarget)}function D(e,t,i){h.show(e,t[0],i&&i.focusTarget)}function w(e,t,i){n.show(t[0],i&&i.focusTarget)}function b(e,i,r){var n={title:t.getString("ClusterUi","editDialog.proHa.title"),subTitle:{objectId:i[0]},defaultButton:"submit",submitButtonTitle:t.getString("ClusterUi","editDialog.proHa.saveButton.title"),contentTemplate:"cluster-ui/resources/cluster/views/settings/services/proactiveHa/editProactiveHaDialog.html",size:"lg",modalClass:"cluster-edit-proactive-ha-dialog-modal",focusTarget:r&&r.focusTarget,dialogData:{availableTargets:i,objectId:i[0]}};o.openOkCancelModal(n)}function I(e,i){var r={title:t.getString("ClusterUi","evc.config.formTitle"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:"cluster-ui/resources/cluster/views/settings/configuration/EditEvcDialog.html",size:"lg",modalClass:"edit-cluster-evc-dialog",dialogData:{availableTargets:i,objectId:i[0]}};o.openOkCancelModal(r)}function T(e,t){i._navigateToViewAndObject("vsphere.core.cluster.manage",t[0])}function E(e,i,r){var n={title:t.getString("HostUi","defaultVmCompatibilityDialog.title"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/EditDefaultVmCompatibility.html",focusTarget:r&&r.focusTarget,dialogData:{availableTargets:i}};o.openOkCancelModal(n)}function V(e,i,r){var n={title:t.getString("ClusterUi","editClusterSettingsDialog.title"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:"cluster-ui/resources/cluster/views/settings/configuration/EditSwapfileLocationDialog.html",focusTarget:r&&r.focusTarget,dialogData:{availableTargets:i,objectId:i[0]}};o.openOkCancelModal(n)}function M(e,i,r){var n={title:t.getString("RpUi","actionCreateRPDefaultName"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:"cluster-ui/resources/cluster/views/create_resource_pool/createResourcePool.html",focusTarget:r&&r.focusTarget,dialogData:{availableTargets:i,objectId:i[0]},modalClass:"cluster-resource-pool-modal"};o.openOkCancelModal(n)}function O(e,i){var r={title:t.getString("RpUi","settings.edit.title"),subTitle:{objectId:i[0]},defaultButton:"submit",contentTemplate:"cluster-ui/resources/cluster/views/edit_resource_pool/editResourcePool.html",dialogData:{objectId:i[0]},modalClass:"edit-cluster-resource-pool-modal"};e&&e.additionalData&&e.additionalData.isScheduledTask&&(r.contentTemplate="cluster-ui/resources/cluster/views/edit_resource_pool_scheduled_task/editResourcePoolScheduledTaskDialog.html",r.actionEval=e,0===r.actionEval.additionalData.schedulingData.scheduleTaskOperationMode?r.title=t.getString("ClusterUi","st.new.scheduled.task",t.getString("ScheduledOpsUi","Wizard.scheduleTask.ResourceConfigForm.title")):r.title=t.getString("ClusterUi","st.edit.scheduled.task",t.getString("ScheduledOpsUi","Wizard.scheduleTask.ResourceConfigForm.title"))),o.openOkCancelModal(r)}function A(e,i){if(i&&i.length){var r={title:t.getString("RpUi","moveTo.title"),defaultButton:"submit",dialogData:{objectIds:i},contentTemplate:"cluster-ui/resources/cluster/views/move_to_resource_pool/moveResourcePoolToDialog.html"};o.openOkCancelModal(r)}}function k(e,i,r){o.openOkCancelModal({title:t.getString("ClusterUi","groups.config.title.create"),subTitle:{objectId:i[0]},defaultButton:"submit",modalClass:"cluster-add-vm-host-group-modal",contentTemplate:"cluster-ui/resources/cluster/views/settings/configuration/groups/AddClusterGroup.html",focusTarget:r&&r.focusTarget})}function R(e,t,i){a.removeGroup(t[0],i.selectedGroup)}function N(e,i,r){var n={objects:r.memberObjects,objectType:r.memberObjectsType,objectId:i[0],onSubmit:function(){return r.addMembersCallback(n.selectedItems)}};o.openOkCancelModal({title:t.getString("ClusterUi","groups.members.dialog.title"),subTitle:{objectId:i[0]},dialogData:n,defaultButton:"submit",size:"lg",modalClass:"cluster-add-group-members-selector-dialog",contentTemplate:"cluster-ui/resources/cluster/views/settings/configuration/groups/addGroupMembersSelectorDialog.html",focusTarget:r&&r.focusTarget})}function U(e,t,i){i.removeMembersCallback()}function L(e,i){o.openOkCancelModal({title:t.getString("ClusterUi","rules.config.title.create"),subTitle:{objectId:i[0]},defaultButton:"submit",modalClass:"cluster-add-vm-host-rule-modal",contentTemplate:"cluster-ui/resources/cluster/views/settings/rules/addClusterRule.html"})}function F(e,t,i){s.deleteRule(t[0],i.selectedRule)}function x(e,i,r){o.openOkCancelModal({title:t.getString("ClusterUi","rules.config.title.edit"),subTitle:{objectId:i[0]},dialogData:{rule:r.selectedRule},defaultButton:"submit",modalClass:"cluster-add-vm-host-rule-modal",contentTemplate:"cluster-ui/resources/cluster/views/settings/rules/addClusterRule.html"})}function $(e,i,r){var n={title:t.getString("ClusterUi","rules.add.affinity.rule.dialog.title"),subTitle:r.dialogSubTitleObject,size:"lg",defaultButton:"submit",modalClass:"cluster-add-affinity-rule-member-dialog",contentTemplate:"cluster-ui/resources/cluster/views/settings/rules/addClusterRuleMember.html",dialogData:{selectedVms:r.selectedMembers,objectId:i[0]},onSubmit:function(){return r.submitCallback(n)}};o.openOkCancelModal(n)}function z(e,i,r){var n=r.isExistingRule,a=r.rule,s=r.membersToRemove,d=r.confirmCallback;if(n&&a.members.length-s.length<c.affinityRuleMinimumMembers)l.error(t.getString("ClusterUi","rules.members.action.remove.confirmationTitle"),t.getString("ClusterUi","rules.members.action.remove.error.cannotDeleteAllRuleMembers"));else{var u={title:t.getString("ClusterUi","rules.members.action.remove.confirmationTitle"),message:t.getString("ClusterUi","rules.members.action.remove.confirmationTextOne"),submit:function(){return d()}};o.openConfirmationModal(u)}}function H(e,i,r){o.openModal(angular.merge({},e,{action:{label:t.getString("ClusterUi","rules.members.detailsPopupTitle")}}),i,{rule:r.selectedRule,member:r.selectedMember},"cluster-ui/resources/cluster/views/settings/rules/viewDetailsClusterRuleMember.html")}function B(e,i,r){o.openOkCancelModal({title:t.getString("ClusterUi","hostOptions.edit.dialogTitle"),subTitle:{objectId:r.selectedHost},dialogData:{selectedHost:r.selectedHost,clusterRef:r.clusterRef},size:"lg",defaultButton:"submit",modalClass:"edit-host-options-dialog",contentTemplate:"cluster-ui/resources/cluster/views/settings/hostOptions/editHostOptions.html"})}function G(e,t,i){d.deleteVmOverride(t[0],i.selectedOverrides,i&&i.focusTarget)}function j(e,t,i){u.openAddVmOverrideWizard(t[0],i&&i.focusTarget)}function W(e,i,r){var n=1===r.selectedOverrides.length?r.selectedOverrides[0].vm.name:t.getString("ClusterUi","vm.overrides.config.edit.dialog.title.vms",r.selectedOverrides.length);o.openOkCancelModal({title:t.getString("ClusterUi","vm.overrides.config.edit.dialog.title",n),subTitle:{objectId:i[0]},dialogData:{selectedOverrides:r.selectedOverrides,objectId:i[0]},size:"lg",defaultButton:"submit",modalClass:"cluster-edit-vm-override-modal",contentTemplate:"cluster-ui/resources/cluster/views/settings/configuration/overrides/editVmOverrideDialog.html"})}function Y(e,i,r){var n={title:t.getString("ClusterUi","restore.rp.tree.dialog.title"),subTitle:{objectId:i[0]},defaultButton:"submit",size:"lg",contentTemplate:"cluster-ui/resources/cluster/views/restore_resource_pool_tree/restoreResourcePoolTreeDialog.html",focusTarget:r&&r.focusTarget,objectId:i[0]};o.openOkCancelModal(n)}function q(e,t){_.isEmpty(t)||p.showAssignLicenseForm(t)}function K(e,t){S.showMoveCluster(t)}function X(t,i){1===i.length?e.remove(i[0]):i.length>1&&e.removeOnMultiEntity(i)}function Q(e,t,i){t&&t.length&&i&&S.moveCluster(i.dropTarget,t)}var Z=window.Zone.current;h5&&h5.configuration&&h5.configuration.featureStates&&"ENABLED"===h5.configuration.featureStates.HCI&&f.init(),h5.actions["vsphere.core.resourcePool.actions.createResourcePool"]=M,h5.actions["vsphere.core.resourcePool.actions.editResourcePool"]=O,h5.actions["vsphere.core.resourcePool.actions.moveTo"]=A,h5.actions["vsphere.core.cluster.actions.create"]=y,h5.actions["vsphere.core.cluster.actions.edit"]=P,h5.actions["vsphere.core.cluster.actions.editDrs"]=C,h5.actions["vsphere.core.cluster.actions.scheduleDrs"]=D,h5.actions["vsphere.core.cluster.actions.editHa"]=w,h5.actions["vsphere.core.cluster.actions.editProactiveHa"]=b,h5.actions["vsphere.core.cluster.actions.editEvcMode"]=I,h5.actions["vsphere.core.cluster.actions.settings"]=T,h5.actions["vsphere.core.cluster.actions.editDefaultHwVersionAction"]=E,h5.actions["vsphere.core.cluster.actions.editSwapfileLocationAction"]=V,h5.actions["vsphere.core.cluster.assignLicenseKeyAction"]=q,h5.actions["vsphere.core.cluster.actions.group.add"]=k,h5.actions["vsphere.core.cluster.actions.group.remove"]=R,h5.actions["vsphere.core.cluster.actions.group.members.add"]=N,h5.actions["vsphere.core.cluster.actions.group.members.remove"]=U,h5.actions["vsphere.core.cluster.actions.rule.add"]=L,h5.actions["vsphere.core.cluster.actions.rule.remove"]=F,h5.actions["vsphere.core.cluster.actions.rule.edit"]=x,h5.actions["vsphere.core.cluster.actions.rule.members.add"]=$,h5.actions["vsphere.core.cluster.actions.rule.members.remove"]=z,h5.actions["vsphere.core.cluster.actions.rule.members.details"]=H,h5.actions["vsphere.core.cluster.actions.hostOptions.edit"]=B,h5.actions["vsphere.core.cluster.actions.vmOverride.delete"]=G,h5.actions["vsphere.core.cluster.actions.vmOverride.add"]=j,h5.actions["vsphere.core.cluster.actions.vmOverride.edit"]=W,h5.actions["vsphere.core.cluster.actions.restoreRpTree"]=Y,h5.actions["vsphere.core.rp.actions.delete"]=X,h5.actions["vsphere.core.cluster.actions.delete"]=X,h5.actions["vsphere.core.cluster.actions.moveTo"]=K,h5.actions["vsphere.core.cluster.actions.moveClusterToDrag"]=Q}]),angular.module("com.vmware.vsphere.client.cluster").directive("deviationMeter",function(){"use strict";return{replace:!0,scope:{getCurrentDeviation:"&currentDeviation",getTargetDeviation:"&targetDeviation"},templateUrl:"cluster-ui/resources/cluster/components/deviationMeter.html",link:function(e){function t(e){return("number"!=typeof e||isNaN(e)||e<0||1<e)&&(e=0),100*e}e.currentDeviation=0,e.targetDeviation=0,e.$watch("getCurrentDeviation()",function(){e.currentDeviation=t(e.getCurrentDeviation())}),e.$watch("getTargetDeviation()",function(){e.targetDeviation=t(e.getTargetDeviation())})}}}),angular.module("com.vmware.vsphere.client.cluster").directive("resourceConfigControl",["i18nService","resourceTypesConstants","bytesFilter","cpuClockFilter","numberFormatterService",function(e,t,i,r,n){"use strict";return{scope:{resourceType:"@",resourceAllocationInfo:"=",reservationOptions:"=",limitOptions:"=",unitOptions:"=",reservationValueErrorMessages:"=",limitValueErrorMessages:"=",defaultUnit:"@?",expandableReservation:"=",reservationUsed:"=",actionType:"@",hasAutofocus:"@"},templateUrl:"cluster-ui/resources/cluster/components/resourceConfigControl.html",controller:["$scope",function(o){var a=1e3,s=10240,c=4,l=16;o.i18n=function(t){return e.getString("RpUi",t)},o.expanded=!0,o.currentReservationUnit={},o.currentLimitUnit={};var d=o.reservationOptions.maximum.value,u=!1;o.$watch("reservationOptions.maximum.value",function(e){e===-1||u||(d=e,u=!0),o.printReservationMaxLabel()}),o.$watch("limitOptions.maximum.value",function(){o.printLimitMaxLabel()}),o.$watch("currentReservationUnit",function(){o.printReservationMaxLabel()}),o.$watch("currentLimitUnit",function(){o.printLimitMaxLabel()}),o.printReservationMaxLabel=function(){o.currentReservationUnit.multiplier?o.resourceType===t.CPU?o.reservationMaxLabel=n.format(o.reservationOptions.maximum.value/o.currentReservationUnit.multiplier,{suffix:o.currentReservationUnit.label}):o.reservationMaxLabel=i(o.reservationOptions.maximum.value,"MB",o.currentReservationUnit.label):o.resourceType===t.CPU?o.reservationMaxLabel=r(o.reservationOptions.maximum.value,e.getString("RpUi","rpCpu.MHz")):o.reservationMaxLabel=i(o.reservationOptions.maximum.value,"MB","MB")},o.printLimitMaxLabel=function(){o.currentLimitUnit.multiplier?o.resourceType===t.CPU?o.limitMaxLabel=n.format(o.limitOptions.maximum.value/o.currentLimitUnit.multiplier,{suffix:o.currentLimitUnit.label}):o.limitMaxLabel=i(o.limitOptions.maximum.value,"MB",o.currentLimitUnit.label):o.resourceType===t.CPU?o.limitMaxLabel=r(o.limitOptions.maximum.value,e.getString("RpUi","rpCpu.MHz")):o.limitMaxLabel=i(o.limitOptions.maximum.value,"MB","MB")},o.$watch("resourceAllocationInfo.reservation",function(n){"undefined"!=typeof n&&("edit"!==o.actionType?o.limitOptions.minimum.value=n:o.limitOptions.minimum.value=Math.max(n,o.limitOptions.current.value),o.resourceType===t.CPU?o.limitOptions.minimum.formattedValue=r(o.limitOptions.minimum.value,e.getString("RpUi","rpCpu.MHz")):o.limitOptions.minimum.formattedValue=i(o.limitOptions.minimum.value,"MB"))}),o.$watch("resourceAllocationInfo.limit",function(n){if("undefined"!=typeof n&&n>=o.limitOptions.minimum.value){var a=d;n<=a&&n!==-1&&(a=n),o.reservationOptions.maximum.value=a,o.resourceType===t.CPU?o.reservationOptions.maximum.formattedValue=r(a,e.getString("RpUi","rpCpu.MHz")):o.reservationOptions.maximum.formattedValue=i(a,"MB"),o.printReservationMaxLabel()}}),o.$watchGroup(["expandableReservation","reservationUsed"],function(){if(void 0!==o.expandableReservation&&void 0!==o.reservationUsed){o.reservationOptions.minimum.value=o.expandableReservation?0:o.reservationUsed;var a;a=o.currentReservationUnit.multiplier?o.resourceType===t.CPU?n.format(o.reservationOptions.minimum.value/o.currentReservationUnit.multiplier,{suffix:o.currentReservationUnit.label}):i(o.reservationOptions.minimum.value,"MB",o.currentReservationUnit.label):o.resourceType===t.CPU?r(o.reservationOptions.minimum.value,e.getString("RpUi","rpCpu.MHz")):i(o.reservationOptions.minimum.value,"MB",o.currentReservationUnit.label),o.reservationOptions.minimum.formattedValue=a}}),o.getMultiplier=function(){return o.resourceType===t.CPU?c:l},o.getDefaultShares=function(){return o.resourceType===t.CPU?a:s}}]}}]),angular.module("com.vmware.vsphere.client.cluster").directive("thresholdBarChart",function(){"use strict";return{replace:!0,restrict:"E",scope:{getData:"&data",getMarkers:"&markers",getMaxValue:"&maxValue",signPostParams:"="},templateUrl:"cluster-ui/resources/cluster/components/thresholdBarChart.html",link:function(e){function t(e){return e?e=e.map(function(e){var t=angular.merge({},e,{usage:r(e.usage),reservation:r(e.reservation)});return t}):[]}function i(e){return e?e=e.map(function(e){var t=angular.merge({},e,{value:r(e.value)});return t}):[]}function r(t){("number"!=typeof t||isNaN(t)||!isFinite(t)||t<0)&&(t=0);var i=e.getMaxValue();return("number"!=typeof i||isNaN(i)||!isFinite(i)||i<0)&&(i=0),i<t&&(t=i),0!==i?t/=i:t=0,100*t}e.data=[],e.markers=[],e.$watchGroup(["getData()","getMaxValue()"],function(){e.data=t(e.getData())}),e.$watchGroup(["getMarkers()","getMaxValue()"],function(){e.markers=i(e.getMarkers())})}}});var cluster_ui;!function(e){var t=function(){function e(e,t){this.browserLanguage=e,this.i18nService=t}return e.prototype.format=function(e,t,i){var r=this.formatPercent(i);return this.i18nService.getString("ClusterUi","capacityToolTipFormat",e,t,r)},e.prototype.formatPercent=function(e){var t=e;t||(t=0);var i=this.browserLanguage.get(),r={maximumFractionDigits:2},n=t.toLocaleString(i,r);return n},e.$inject=["browserLanguage","i18nService"],e}();e.CapacityFormatterService=t,angular.module("com.vmware.vsphere.client.cluster").service("capacityFormatterService",t)}(cluster_ui||(cluster_ui={})),angular.module("com.vmware.vsphere.client.cluster").constant("clusterConstants",{vmSwapPlacementType:{VM_DIRECTORY:"vmDirectory",HOST_DATASTORE:"hostLocal"},editClusterErrorCodes:{DRS_OFF_WITH_RESOURCE_POOLS:"DRS_OFF_WITH_RESOURCE_POOLS",DPM_ON_WITH_HOSTS_STANDBY:"DPM_ON_WITH_HOSTS_STANDBY",HA_APD_PDL_WITH_FT_VMS:"HA_APD_PDL_WITH_FT_VMS"},MAX_INTEGER:2147483647,proactiveHaAutomationLevel:{AUTOMATED:"Automated",MANUAL:"Manual"},proactiveHaRemediationLevel:{QUARANTINE:"quarantine",BALANCED:"balanced",MAINTENANCE:"maintenance"},proactiveHaRemediationMode:{QUARANTINE_MODE:"QuarantineMode",MAINTENANCE_MODE:"MaintenanceMode"},proactiveHaBlockAtTypes:{CLUSTER_LEVEL:"clusterLevel",INDIVIDUAL_HOSTS:"individualHosts"},memoryUtilizationTypes:{ACTIVE:"active",CONSUMED:"consumed"}}),angular.module("com.vmware.vsphere.client.cluster").constant("clusterGroupsConstants",{groupType:{VM_GROUP:"com.vmware.vim.binding.vim.cluster.VmGroup",HOST_GROUP:"com.vmware.vim.binding.vim.cluster.HostGroup"},operationType:{ADD:"add",REMOVE:"remove",EDIT:"edit"}}),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(e,i){var r,n;return i?(r="groupsData",n={propertyParams:[{propertyName:"groupsData",parameterType:"java.lang.String",parameter:i}]}):r="ClusterComputeResource/configurationEx/group",t.getProperties(e,[r],n).then(function(e){return e?m(e[r]):[]})}function u(e,i){var r={propertyParams:y(i)};return t.getProperties(e,["clusterGroups"],r).then(function(e){return e?m(e.clusterGroups):[]})}function p(e){return t.getPropertiesForObjects(e.members,["name","primaryIconId"]).then(function(e){return _.map(e,function(e,t){return{id:t,name:e.name,icon:e.primaryIconId}})})}function v(e,t){var i=null;return e.forEach(function(e){e.name===t&&(i=e)}),i}function m(e){return _.map(e,function(e){var t,n,o;switch(e._type){case i.groupType.VM_GROUP:t=E("groups.list.type.vm"),n="vx-icon-vm-drs-group",o=e.vm;break;case i.groupType.HOST_GROUP:t=E("groups.list.type.host"),n="vx-icon-host-drs-group",o=e.host}return o||(o=[]),{name:e.name,type:t,icon:n,members:o.map(function(e){return r.getVsphereObjectId(e)}),rawType:e._type}})}function g(){return _.map(i.groupType,function(e){var t="";switch(e){case i.groupType.VM_GROUP:t=E("groups.list.type.vm");break;case i.groupType.HOST_GROUP:t=E("groups.list.type.host")}return{id:e,label:t}})}function h(e,t,r){var n={name:t};switch(e){case i.groupType.VM_GROUP:n=_.extend({vm:r,_type:i.groupType.VM_GROUP},n);break;case i.groupType.HOST_GROUP:n=_.extend({host:r,_type:i.groupType.HOST_GROUP},n);break;default:T.warn("Unexpected group type: "+e)}return n}function f(e,t){var r={_type:"com.vmware.vim.binding.vim.cluster.GroupSpec",operation:t,info:e};return i.operationType.REMOVE===t&&(r.removeKey=r.info.name),r}function S(e,t,i,r){var n=[];i&&(n=i.source);var o=h(e,t.trim(),n);return f(o,r)}function y(e){var t=[];e.type===c.ruleType.VM_DEPENDENCY_RULE_TYPE?(null!==e.vmDependencyRuleProperties.vmGroup&&t.push(e.vmDependencyRuleProperties.vmGroup),null!==e.vmDependencyRuleProperties.dependsOnVmGroup&&t.push(e.vmDependencyRuleProperties.dependsOnVmGroup)):e.type===c.ruleType.VM_HOST_GROUP_RULE&&(null!==e.vmToHostRuleProperties.vmGroupName&&t.push(e.vmToHostRuleProperties.vmGroupName),null!==e.vmToHostRuleProperties.hostGroupName&&t.push(e.vmToHostRuleProperties.hostGroupName));var i=[{propertyName:"clusterGroups",parameterType:"com.vmware.vsphere.client.cluster.groups.GroupsFilterByNameSpec",parameter:{names:t}}];return i}function P(e){return{source:e.map(function(e){return r.getManagedObjectReference(e)})}}function C(e,t){var r=S(t.rawType,t.name,t.members,i.operationType.REMOVE);a.validate(e,"com.vmware.vim.binding.vim.cluster.GroupSpec",r).then(function(i){var n,o=!!i&&(i.result||!!i.error);n=o?E("groups.action.remove.confirmationGroupInUse",t.name):E("groups.action.remove.confirmationTextOne");var a={title:E("groups.action.remove.confirmationTitle"),message:n,submit:function(){D(e,r)}};s.openConfirmationModal(a)})}function D(e,t){var i=o.buildClusterComputeResourceSpec({group:t},!0);a.apply(e,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",i)}function w(e,t,i){if(t&&t.members&&i&&t.members.length===i.length)l.error(E("groups.members.action.remove.confirmationTitle"),E("groups.members.action.remove.error.CannotDeleteAllGroupMembers"));else{var r={title:E("groups.members.action.remove.confirmationTitle"),message:E("groups.members.action.remove.confirmationTextOne"),submit:function(){b(e,t,i)}};s.openConfirmationModal(r)}}function b(e,t,r){var n=_.map(r,"id"),s=_.difference(t.members,n),c=P(s),l=S(t.rawType,t.name,c,i.operationType.EDIT),d=o.buildClusterComputeResourceSpec({group:l},!0);a.apply(e,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",d)}function I(e){return e.map(function(e){return e.id})}var T=n("clusterGroupsService"),E=_.bind(e.getString,e,"ClusterUi");return{DEFAULT_GROUP_TYPE:i.groupType.VM_GROUP,getGroupsData:d,getRuleGroupsData:u,getGroupMembers:p,getGroupByName:v,buildTypesOptions:g,buildGroupSpec:S,buildGroupMembersSpec:P,removeGroup:C,removeGroupMembers:w,getSelectedItemsIds:I}}angular.module("com.vmware.vsphere.client.cluster").service("clusterGroupsService",e),e.$inject=["i18nService","dataService","clusterGroupsConstants","defaultUriSchemeUtil","logService","clusterSpecBuilderService","mutationService","clarityModalService","clusterRulesConstants","alertService"]}(),angular.module("com.vmware.vsphere.client.cluster").constant("clusterHelpConstants",{DRS_FAULT_TROUBLESHOOT_GUIDE_ID:"IDH_TSMAIN"}),angular.module("com.vmware.vsphere.client.cluster").constant("clusterRulesConstants",{ruleType:{VM_AFFINITY_RULE:"VM_AFFINITY_RULE_TYPE",VM_ANTIAFFINITY_RULE:"VM_ANTIAFFINITY_RULE_TYPE",VM_HOST_GROUP_RULE:"VM_HOST_GROUP_RULE_TYPE",VM_DEPENDENCY_RULE:"VM_DEPENDENCY_RULE_TYPE"},optionType:{VM_ANTIAFFINITY_RULES:"das.respectVmVmAntiAffinityRules",VM_HOST_AFFINITY_RULES:"das.respectVmHostSoftAffinityRules"},ruleSpec:{VM_AFFINITY_RULE:"com.vmware.vim.binding.vim.cluster.AffinityRuleSpec",VM_ANTIAFFINITY_RULE:"com.vmware.vim.binding.vim.cluster.AntiAffinityRuleSpec",VM_HOST_GROUP_RULE:"com.vmware.vim.binding.vim.cluster.VmHostRuleInfo",VM_DEPENDENCY_RULE:"com.vmware.vim.binding.vim.cluster.DependencyRuleInfo"},operationType:{ADD:"add",REMOVE:"remove",EDIT:"edit"},affinityRuleMinimumMembers:2,conflictType:{AFFINITY_AFFINITY:"AFFINITY_AFFINITY",AFFINITY_ANTIAFFINITY:"AFFINITY_ANTIAFFINITY",ANTIAFFINITY_ANTIAFFINITY:"ANTIAFFINITY_ANTIAFFINITY"}}),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(e){var i="ClusterComputeResource/configurationEx/dasConfig/option",r="ClusterComputeResource/configurationEx/dasConfig/enabled";return t.getProperties(e,["rulesData",i,r]).then(function(e){return{rules:e?v(e.rulesData):[],options:e?m(e[i]):[],haEnabled:!!e&&(e[r]||!1)}})}function u(e){var i={},r=_.map(e.members,function(e){var t=n.getVsphereObjectId(e.entity);return i[t]=e.conflicts.length,t});return t.getPropertiesForObjects(r,["name","primaryIconId"]).then(function(e){return _.map(e,function(e,t){return{id:t,name:e.name,icon:e.primaryIconId,conflictsCount:i[t]}})})}function p(e){return _.map(e,function(e){return{name:e.rule.name,icon:"vx-icon-rule-conflict"}})}function v(t){return _.map(t,function(t){var i;switch(t.ruleType){case r.ruleType.VM_AFFINITY_RULE:i=e.getString("ClusterUi","rules.list.type.vmAffinity");break;case r.ruleType.VM_ANTIAFFINITY_RULE:i=e.getString("ClusterUi","rules.list.type.vmAntiAffinity");break;case r.ruleType.VM_HOST_GROUP_RULE:i=e.getString("ClusterUi","rules.list.type.vmHostGroup");break;case r.ruleType.VM_DEPENDENCY_RULE:i=e.getString("ClusterUi","rules.list.type.vmDependency")}return{name:t.rule.name,icon:g(t),type:t.ruleType,key:t.rule.key,typeText:i,enabled:t.rule.enabled,userCreated:t.rule.userCreated,members:t.members,conflictingRules:t.conflictingRules,vmToHostRuleProperties:{vmGroupName:t.rule.vmGroupName,hostGroupName:h(t.rule),isAffineHostGroupName:f(t.rule),isMandatory:t.rule.mandatory},vmDependencyRuleProperties:{dependsOnVmGroup:t.rule.dependsOnVmGroup,vmGroup:t.rule.vmGroup}}})}function m(e){return _.map(e,function(e){return{key:e.key,value:e.value}})}function g(e){return 0===e.conflictingRules.length?"vx-icon-rule":"vx-icon-rule-conflict"}function h(e){return null!==e.affineHostGroupName?e.affineHostGroupName:e.antiAffineHostGroupName}function f(e){return void 0!==e.affineHostGroupName&&null!==e.affineHostGroupName}function S(t,i){var r={title:e.getString("ClusterUi","rules.action.remove.confirmationTitle"),message:e.getString("ClusterUi","rules.action.remove.confirmationTextOne"),submit:function(){y(t,i.key)}};o.openConfirmationModal(r)}function y(e,t){var n={_type:"com.vmware.vim.binding.vim.cluster.RuleSpec",operation:r.operationType.REMOVE,removeKey:t},o=a.buildClusterComputeResourceSpec({rule:n},!0);i.apply(e,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",o)}function P(t,o,s){var d=_.map(o.members,function(e){return n.getVsphereObjectId(e.entity)}),u=_.map(s,"id"),p=_.union(d,u),v=D(p),m=E(w(o.type),o.name,o.enabled,v,null,r.operationType.EDIT,o.key);return i.validate(t,"com.vmware.vim.binding.vim.cluster.RuleSpec",m).then(function(t){if(t&&(t.result||t.error)){if("RULE_CONFLICT_ERROR"===t.result){var i=l.defer();return c.okCancel(e.getString("ClusterUi","rules.error.ruleConflictsConfirmationTitle"),e.getString("ClusterUi","rules.error.ruleConflicts"),function(){i.resolve()},function(){i.reject()}),i.promise}}else;}).then(function(){var e=a.buildClusterComputeResourceSpec({rule:m},!0);i.apply(t,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",e)})}function C(e,t,o){var s=_.map(o,"id"),c=_.map(t.members,function(e){return n.getVsphereObjectId(e.entity)}),l=_.difference(c,s),d=D(l),u=E(w(t.type),t.name,t.enabled,d,null,r.operationType.EDIT,t.key),p=a.buildClusterComputeResourceSpec({rule:u},!0);i.apply(e,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",p)}function D(e){return e.map(function(e){return n.getManagedObjectReference(e)})}function w(e){var t=null;switch(e){case r.ruleType.VM_AFFINITY_RULE:t=r.ruleSpec.VM_AFFINITY_RULE;break;case r.ruleType.VM_ANTIAFFINITY_RULE:t=r.ruleSpec.VM_ANTIAFFINITY_RULE;break;case r.ruleType.VM_HOST_GROUP_RULE:t=r.ruleSpec.VM_HOST_GROUP_RULE;break;case r.ruleType.VM_DEPENDENCY_RULE:t=r.ruleSpec.VM_DEPENDENCY_RULE;break;default:M.warn("Unexpected rule type: "+e)}return t}function b(t){var i=[{id:r.ruleSpec.VM_AFFINITY_RULE,label:e.getString("ClusterUi","rules.config.type.vmAffinity.name")},{id:r.ruleSpec.VM_ANTIAFFINITY_RULE,
label:e.getString("ClusterUi","rules.config.type.vmAntiAffinity.name")},{id:r.ruleSpec.VM_HOST_GROUP_RULE,label:e.getString("ClusterUi","rules.config.type.vmToHost.name")}];return t&&i.push({id:r.ruleSpec.VM_DEPENDENCY_RULE,label:e.getString("ClusterUi","rules.config.type.vmToVM.name")}),i}function I(e,t,i,n,o,a){var s={name:t,enabled:i,userCreated:!0,key:a};switch(e){case r.ruleSpec.VM_AFFINITY_RULE:case r.ruleSpec.VM_ANTIAFFINITY_RULE:s=_.extend({vm:n,_type:e},s);break;case r.ruleSpec.VM_HOST_GROUP_RULE:s=_.extend({vmGroupName:o.vmGroupName,affineHostGroupName:o.isAffineHostGroupName?o.hostGroupName:null,antiAffineHostGroupName:o.isAffineHostGroupName?null:o.hostGroupName,mandatory:o.isMandatory,_type:e},s);break;case r.ruleSpec.VM_DEPENDENCY_RULE:s=_.extend({vmGroup:o.vmGroup,dependsOnVmGroup:o.dependsOnVmGroup,_type:e},s);break;default:M.warn("Unexpected rule type: "+e)}return s}function T(e,t){var i={_type:"com.vmware.vim.binding.vim.cluster.RuleSpec",operation:t,info:e};return i}function E(e,t,i,r,n,o,a){var s=I(e,t.trim(),!!i,r,n,a);return T(s,o)}function V(e){var i=_.map(e,function(e){return n.getVsphereObjectId(e.entity)});return t.getPropertiesForObjects(i,["name"])}var M=s("clusterRulesService");return{DEFAULT_TYPE:r.ruleSpec.VM_AFFINITY_RULE,getRulesData:d,getAffinityRulesMembersData:u,getConflictingRulesData:p,deleteRule:S,getRuleTypes:b,buildRuleSpec:E,removeRuleMembers:C,getSpecTypeByRuleType:w,addRuleMembers:P,getVmNames:V}}angular.module("com.vmware.vsphere.client.cluster").service("clusterRulesService",e),e.$inject=["i18nService","dataService","mutationService","clusterRulesConstants","defaultUriSchemeUtil","clarityModalService","clusterSpecBuilderService","logService","alertService","$q","$rootScope"]}(),function(){"use strict";function e(e,t,i,r){function n(n,a,s){var c={configSpecEx:{_type:"com.vmware.vim.binding.vim.cluster.ConfigSpecEx",drsConfig:{_type:"com.vmware.vim.binding.vim.cluster.DrsConfigInfo"},dpmConfig:{_type:"com.vmware.vim.binding.vim.cluster.DpmConfigInfo"}},modify:a};if(a&&!angular.isDefined(n.clusterName)||(c.name=n.clusterName),a&&!angular.isDefined(n.parent)||(c.parent=n.parent),n.currentEvcMode&&angular.isDefined(n.currentEvcMode.key)&&(c.evcModeKey=n.currentEvcMode.key),s&&(c.configSpecEx.inHciWorkflow=!!s),angular.isDefined(n.vmSwapPlacement)&&(c.configSpecEx.vmSwapPlacement=n.vmSwapPlacement),angular.isDefined(n.drsEnabled)&&(c.configSpecEx.drsConfig.enabled=!!n.drsEnabled),angular.isDefined(n.drsAutomation)&&(angular.isDefined(n.drsAutomation.automationLevel)&&(c.configSpecEx.drsConfig.defaultVmBehavior=n.drsAutomation.automationLevel.id),angular.isDefined(n.drsAutomation.migrationThreshold)&&(c.configSpecEx.drsConfig.vmotionRate=e.getDrsMigrationRate(n.drsAutomation.migrationThreshold)),angular.isDefined(n.drsAutomation.vmAutomation)&&(c.configSpecEx.drsConfig.enableVmBehaviorOverrides=!!n.drsAutomation.vmAutomation),n.drsAutomation.is65VcOrLater&&angular.isDefined(n.drsAutomation.proactiveDrsEnabled)&&(c.configSpecEx.proactiveDrsConfig={_type:"com.vmware.vim.binding.vim.cluster.ProactiveDrsConfigInfo",enabled:n.drsAutomation.proactiveDrsEnabled})),angular.isDefined(n.dpmAutomation)&&(angular.isDefined(n.dpmAutomation.automationLevel)&&(n.dpmAutomation.automationLevel.id===t.dpmAutomationLevel.DISABLED?c.configSpecEx.dpmConfig.enabled=!1:(c.configSpecEx.dpmConfig.enabled=!0,c.configSpecEx.dpmConfig.defaultDpmBehavior=n.dpmAutomation.automationLevel.id)),angular.isDefined(n.dpmAutomation.dpmThreshold))){var l=r.reverseDpmRateAndThreshold(n.dpmAutomation.dpmThreshold);c.configSpecEx.dpmConfig.hostPowerActionRate=l}if(angular.isDefined(n.advancedOptionsBuilder)&&(c.configSpecEx.drsConfig.option=n.advancedOptionsBuilder.buildOptions()),angular.isDefined(n.drsPolicies)){if(n.drsAutomation.is65VcOrLater&&(n.drsPolicies.evenDistribution||angular.isDefined(n.advancedOptionsBuilder))){var d=n.drsPolicies.evenDistribution?t.drsPolicies.EVEN_DISTRIBUTION_VALUE:null;c.configSpecEx.drsConfig.option=o(c.configSpecEx.drsConfig.option,t.drsPolicies.EVEN_DISTRIBUTION_OPTION,d)}if(n.drsPolicies.cpuOvercommitment||angular.isDefined(n.advancedOptionsBuilder)){var u=n.drsPolicies.cpuOvercommitment?n.drsPolicies.cpuOvercommitmentValue.toString():null;c.configSpecEx.drsConfig.option=o(c.configSpecEx.drsConfig.option,t.drsPolicies.CPU_OVERCOMMITMENT_OPTION,u)}}if(angular.isDefined(n.haEnabled)){if(c.configSpecEx.dasConfig={_type:"com.vmware.vim.binding.vim.cluster.DasConfigInfo",enabled:!!n.haEnabled},angular.isDefined(n.haConfiguration)){var p=n.haConfiguration;if(angular.isDefined(p.defaultVmSettings)&&(c.configSpecEx.dasConfig.defaultVmSettings={_type:"com.vmware.vim.binding.vim.cluster.DasVmSettings"},angular.isDefined(p.defaultVmSettings.isolationResponse)&&(c.configSpecEx.dasConfig.defaultVmSettings.isolationResponse=p.defaultVmSettings.isolationResponse),angular.isDefined(p.defaultVmSettings.restartPriority)&&(c.configSpecEx.dasConfig.defaultVmSettings.restartPriority=p.defaultVmSettings.restartPriority),n.is65VcOrLater&&angular.isDefined(p.defaultVmSettings.restartPriorityTimeout)&&(c.configSpecEx.dasConfig.defaultVmSettings.restartPriorityTimeout=p.defaultVmSettings.restartPriorityTimeout),angular.isDefined(p.defaultVmSettings.vmToolsMonitoringSettings))){c.configSpecEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings={_type:"com.vmware.vim.binding.vim.cluster.VmToolsMonitoringSettings"};var v=p.defaultVmSettings.vmToolsMonitoringSettings;angular.isDefined(v.vmToolsMonitorFailureInt)&&(c.configSpecEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.failureInterval=v.vmToolsMonitorFailureInt),angular.isDefined(v.vmToolsMonitorMinUpTime)&&(c.configSpecEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.minUpTime=v.vmToolsMonitorMinUpTime),angular.isDefined(v.vmToolsMonitorMaxFailures)&&(c.configSpecEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.maxFailures=v.vmToolsMonitorMaxFailures),angular.isDefined(v.vmToolsMonitorMaxFailureWindow)&&(v.vmToolsMonitorHasFailureWindow?c.configSpecEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.maxFailureWindow=3600*v.vmToolsMonitorMaxFailureWindow:c.configSpecEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.maxFailureWindow=i.vmMonitoringSensitivity.NO_FAILURE_WINDOW)}if(angular.isDefined(p.admissionControlEnabled)&&(c.configSpecEx.dasConfig.admissionControlEnabled=!!p.admissionControlEnabled),angular.isDefined(p.hostMonitoringEnabled)&&(c.configSpecEx.dasConfig.hostMonitoring=p.hostMonitoringEnabled?i.hostMonitoringState.ENABLED:i.hostMonitoringState.DISABLED),angular.isDefined(p.vmMonitoringState)&&(c.configSpecEx.dasConfig.vmMonitoring=p.vmMonitoringState),angular.isDefined(p.admissionControl)&&(p.admissionControl.policy._type===i.admissionControlPolicy.FAILOVER_RESOURCES_TYPE?c.configSpecEx.dasConfig.admissionControlPolicy={_type:p.admissionControl.policy._type}:c.configSpecEx.dasConfig.admissionControlPolicy={_type:p.admissionControl.policy._type,failoverLevel:p.admissionControl.policy.failoverLevel}),angular.isDefined(p.vmcpSettings)){var m=c.configSpecEx.dasConfig;m.defaultVmSettings||(m.defaultVmSettings={_type:"com.vmware.vim.binding.vim.cluster.DasVmSettings"});var g=p.vmcpEnabled;angular.isDefined(p.vmcpSettings.apdResponse)&&(p.vmcpSettings.apdResponse!==i.storageVmReaction.DISABLED&&(g=!0),m.defaultVmSettings.vmComponentProtectionSettings||(m.defaultVmSettings.vmComponentProtectionSettings={_type:"com.vmware.vim.binding.vim.cluster.VmComponentProtectionSettings"}),m.defaultVmSettings.vmComponentProtectionSettings.vmStorageProtectionForAPD=p.vmcpSettings.apdResponse),angular.isDefined(p.vmcpSettings.pdlResponse)&&(p.vmcpSettings.pdlResponse!==i.storageVmReaction.DISABLED&&(g=!0),m.defaultVmSettings.vmComponentProtectionSettings||(m.defaultVmSettings.vmComponentProtectionSettings={_type:"com.vmware.vim.binding.vim.cluster.VmComponentProtectionSettings"}),m.defaultVmSettings.vmComponentProtectionSettings.vmStorageProtectionForPDL=p.vmcpSettings.pdlResponse),g?m.vmComponentProtecting=i.serviceState.ENABLED:m.vmComponentProtecting=i.serviceState.DISABLED;var h=p.vmcpSettings.vmReactionOnAPDCleared;angular.isDefined(h)&&(m.defaultVmSettings.vmComponentProtectionSettings||(m.defaultVmSettings.vmComponentProtectionSettings={_type:"com.vmware.vim.binding.vim.cluster.VmComponentProtectionSettings"}),m.defaultVmSettings.vmComponentProtectionSettings.vmReactionOnAPDCleared=h);var f=p.vmcpSettings.apdRecoveryDelayMinutes;angular.isDefined(f)&&(m.defaultVmSettings.vmComponentProtectionSettings||(m.defaultVmSettings.vmComponentProtectionSettings={_type:"com.vmware.vim.binding.vim.cluster.VmComponentProtectionSettings"}),m.defaultVmSettings.vmComponentProtectionSettings.vmTerminateDelayForAPDSec=f*i.SECONDS_IN_A_MINUTE)}}if(angular.isDefined(n.hbDatastoreCandidatePolicy)){var S=n.hbDatastoreCandidatePolicy;c.configSpecEx.dasConfig.hBDatastoreCandidatePolicy=S;var y=[],P=angular.isDefined(n.hbDatastoreCandidates);if(S!==i.hbDatastoreCandidatePolicy.AUTO_SELECT&&P){for(var C=n.hbDatastoreCandidates?n.hbDatastoreCandidates:[],D=0;D<C.length;D++)C[D].isPreferred&&y.push(C[D].provider);c.configSpecEx.dasConfig.heartbeatDatastore=y}}if(angular.isDefined(n.haAdvancedOptionsBuilder)&&(c.configSpecEx.dasConfig.option=n.haAdvancedOptionsBuilder.buildOptions()),angular.isDefined(n.admissionControlPolicy)&&(c.configSpecEx.dasConfig.admissionControlEnabled=n.admissionControlPolicy.type!==i.admissionControlPolicy.DISABLED_TYPE,c.configSpecEx.dasConfig.admissionControlEnabled)){switch(n.admissionControlPolicy.type){case i.admissionControlPolicy.FAILOVER_LEVEL_TYPE:c.configSpecEx.dasConfig.admissionControlPolicy={_type:i.admissionControlPolicy.FAILOVER_LEVEL_TYPE,failoverLevel:n.failoverLevel},n.slotSizePolicy===i.slotSizePolicy.FIXED_SIZE&&(c.configSpecEx.dasConfig.admissionControlPolicy.slotPolicy={_type:"com.vmware.vim.binding.vim.cluster.FixedSizeSlotPolicy",cpu:n.fixedSlotSizeCpu,memory:n.fixedSlotSizeMemory});break;case i.admissionControlPolicy.FAILOVER_RESOURCES_TYPE:c.configSpecEx.dasConfig.admissionControlPolicy={_type:i.admissionControlPolicy.FAILOVER_RESOURCES_TYPE,cpuFailoverResourcesPercent:n.cpuFailoverPercent,memoryFailoverResourcesPercent:n.memoryFailoverPercent},n.is65VcOrLater&&(c.configSpecEx.dasConfig.admissionControlPolicy.autoComputePercentages=n.autoComputePercentages);break;case i.admissionControlPolicy.FAILOVER_HOSTS_TYPE:var w=_.map(n.failoverHosts,function(e){return e.provider});c.configSpecEx.dasConfig.admissionControlPolicy={_type:i.admissionControlPolicy.FAILOVER_HOSTS_TYPE,failoverHosts:w}}n.is65VcOrLater&&(c.configSpecEx.dasConfig.admissionControlPolicy.failoverLevel=n.failoverLevel,c.configSpecEx.dasConfig.admissionControlPolicy.resourceReductionToToleratePercent=n.resourceReductionToToleratePercent)}}return angular.isDefined(n.vsanEnabled)&&(c.configSpecEx.vsanConfig={_type:"com.vmware.vim.binding.vim.vsan.cluster.ConfigInfo",enabled:n.vsanEnabled}),n.is65VcOrLater&&angular.isDefined(n.orchestration)&&(c.configSpecEx.orchestration={_type:"com.vmware.vim.binding.vim.cluster.OrchestrationInfo"},angular.isDefined(n.orchestration.defaultVmReadiness)&&(c.configSpecEx.orchestration.defaultVmReadiness={_type:"com.vmware.vim.binding.vim.cluster.VmReadiness"},c.configSpecEx.orchestration.defaultVmReadiness.postReadyDelay=n.orchestration.defaultVmReadiness.postReadyDelay,c.configSpecEx.orchestration.defaultVmReadiness.readyCondition=n.orchestration.defaultVmReadiness.readyCondition)),angular.isDefined(n.group)&&angular.isDefined(n.group.info)&&(c.configSpecEx.groupSpec=[n.group]),angular.isDefined(n.rule)&&(c.configSpecEx.rulesSpec=[n.rule]),angular.isDefined(n.dasVmOverride)&&(c.configSpecEx.dasVmConfigSpec=n.dasVmOverride),angular.isDefined(n.drsVmOverride)&&(c.configSpecEx.drsVmConfigSpec=n.drsVmOverride),angular.isDefined(n.orchestrationVmOverride)&&(c.configSpecEx.vmOrchestrationSpec=n.orchestrationVmOverride),angular.isDefined(n.infraUpdateHaConfig)&&(c.configSpecEx.infraUpdateHaConfig=n.infraUpdateHaConfig,_.extend(c.configSpecEx.infraUpdateHaConfig,{_type:"com.vmware.vim.binding.vim.cluster.InfraUpdateHaConfigInfo"})),c}function o(e,t,i){return void 0===e&&(e=[]),e=_.reject(e,function(e){return e.key===t}),e.push({_type:"com.vmware.vim.binding.vim.option.OptionValue",key:t,value:i}),e}return{buildClusterComputeResourceSpec:n}}angular.module("com.vmware.vsphere.client.cluster").service("clusterSpecBuilderService",e),e.$inject=["drsMigrationThresholdService","drsConstants","haConstants","dpmThresholdService"]}(),function(){"use strict";function e(e,t,i){function r(){return{id:e.vmSwapPlacementType.VM_DIRECTORY,label:o("general.config.swapPlacementType.vmDirectory"),description:o("general.config.swapPlacementType.vmDirectory.description")}}function n(){return{id:e.vmSwapPlacementType.HOST_DATASTORE,label:o("general.config.swapPlacementType.hostLocal"),description:o("general.config.swapPlacementType.hostLocal.description")}}function o(e){return t.getString("ClusterUi",e)}function a(e){return i.getData(e,"com.vmware.vsphere.client.clusterui.model.GeneralConfigData").then(function(e){return e.vmSwapPlacement})}function s(i){return i===e.vmSwapPlacementType.VM_DIRECTORY?t.getString("ClusterUi","general.config.swapPlacementType.vmDirectory"):i===e.vmSwapPlacementType.HOST_DATASTORE?t.getString("ClusterUi","general.config.swapPlacementType.hostLocal"):""}return{WARNING:o("general.config.swapPlacementType.hostLocal.warning"),getVmDirectoryData:r,getHostDatastoreData:n,getSwapFilePlacement:a,getVmSwapFileLocation:s}}angular.module("com.vmware.vsphere.client.cluster").service("clusterSwapFileLocationService",e),e.$inject=["clusterConstants","i18nService","dataService"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i){this.vxPropertyViewService=e,this.i18nService=t,this.capacityFormatterService=i}return e.prototype.buildCpuPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","consumed")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-light-blue").exit().valueBuilder().text(e.cpuConsumedFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","active")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-blue").exit().valueBuilder().text(e.cpuActiveFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity")).exit().valueBuilder().text(e.cpuCapacityFormatted),t.build()},e.prototype.buildMemoryPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","consumed")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-light-blue").exit().valueBuilder().text(e.memoryConsumedFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","overhead")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-desaturated-blue").exit().valueBuilder().text(e.memoryOverheadFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity")).exit().valueBuilder().text(e.memoryCapacityFormatted),t.build()},e.prototype.buildGuestMemoryPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","activeGuestMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-light-green").exit().valueBuilder().text(e.activeGuestMemoryFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","privateMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-green").exit().valueBuilder().text(e.privateMemoryFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","sharedMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-dark-blue").exit().valueBuilder().text(e.sharedMemoryFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","compressedMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-blue").exit().valueBuilder().text(e.compressedMemoryFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","swappedMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-orange").exit().valueBuilder().text(e.swappedMemoryFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","balloonedMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-yellow").exit().valueBuilder().text(e.balloonedMemoryFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","unaccessedMemory")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-gray").exit().valueBuilder().text(e.unaccessedMemoryFormatted),t.build()},e.prototype.buildLimitReservationSection=function(e,t){e.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","reservation")).icon("vx-property-view-key-legend-icon vm-utilization-reservation-arrow-icon").exit().valueBuilder().text(t.reservation),e.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","limit")).icon("vx-property-view-key-legend-icon vm-utilization-limit-arrow-icon").exit().valueBuilder().text(t.limit)},e.prototype.buildSharesWorstCaseAllocationSection=function(e,t){e.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","shares")).exit().valueBuilder().text(t.sharesInfo),t.clusterDrsEnabled&&e.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","worstCaseAllocation")).icon("vx-property-view-key-legend-icon vm-utilization-worst-case-allocation-arrow-icon").exit().valueBuilder().text(t.staticEntitlement)},e.prototype.buildVmMemoryPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","vmConsumed")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-light-blue").exit().valueBuilder().text(e.consummation),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","vmOverheadConsumed")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-desaturated-blue").exit().valueBuilder().text(e.overheadMemory),this.buildLimitReservationSection(i,e),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","configuredMemory")).exit().valueBuilder().text(e.resourceSize),this.buildSharesWorstCaseAllocationSection(i,e),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","overheadReservation")).exit().valueBuilder().text(e.overheadAllocation),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","vmUsedReservation")).exit().valueBuilder().text(e.usedReservation),t.build()},e.prototype.buildResourcePoolMemoryPropertyViewData=function(e){var t=e.provider&&"ResourcePool"===e.provider.type,i=this.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("").section(""),n=this.i18nService.getString("ClusterUi","vAppConsumed"),o=this.i18nService.getString("ClusterUi","vAppOverheadConsumed");if(t&&(n=this.i18nService.getString("ClusterUi","consumed"),o=this.i18nService.getString("ClusterUi","overhead")),r.propertyBuilder().keyBuilder().text(n).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-light-blue").exit().valueBuilder().text(e.consummation),r.propertyBuilder().keyBuilder().text(o).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-desaturated-blue").exit().valueBuilder().text(e.overheadMemory),this.buildLimitReservationSection(r,e),t){var a=this.i18nService.getString("ClusterUi","hostCapacity");e.parentCluster&&(a=this.i18nService.getString("ClusterUi","clusterCapacity")),r.propertyBuilder().keyBuilder().text(a).exit().valueBuilder().text(e.ownerCapacity)}return this.buildSharesWorstCaseAllocationSection(r,e),i.build()},e.prototype.buildResourcePoolCpuPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","consumed")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-light-blue").exit().valueBuilder().text(e.consummation),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","active")).icon("vx-property-view-key-legend-icon cluster-utilization-icon-color-normal-blue").exit().valueBuilder().text(e.overallCpuDemand),this.buildLimitReservationSection(i,e),this.buildSharesWorstCaseAllocationSection(i,e),t.build()},e.prototype.getCpuMetersData=function(e){return[{colorClass:"cluster-utilization-light-blue",value:e.cpuConsumedPercentage,label:this.capacityFormatterService.format(e.cpuConsumedFormatted,e.cpuCapacityFormatted,e.cpuConsumedPercentage)},{colorClass:"cluster-utilization-normal-blue",value:e.cpuActivePercentage,label:this.capacityFormatterService.format(e.cpuActiveFormatted,e.cpuCapacityFormatted,e.cpuActivePercentage)}]},e.prototype.getMemoryMetersData=function(e){return[{colorClass:"cluster-utilization-light-blue",value:e.memoryConsumedPercentage,label:this.capacityFormatterService.format(e.memoryConsumedFormatted,e.memoryCapacityFormatted,e.memoryConsumedPercentage)},{colorClass:"cluster-utilization-desaturated-blue",value:e.memoryOverheadPercentage,label:this.capacityFormatterService.format(e.memoryOverheadFormatted,e.memoryCapacityFormatted,e.memoryOverheadPercentage)}]},e.prototype.getGuestMemoryMetersData=function(e){return[{colorClass:"cluster-utilization-light-green",value:e.activeGuestMemoryPercentage,label:this.capacityFormatterService.format(e.activeGuestMemoryFormatted,e.guestMemorySizeFormatted,e.activeGuestMemoryPercentage)}]},e.prototype.getGuestMemoryGroupedMetersData=function(e){return[{colorClass:"cluster-utilization-normal-green",value:e.privateMemoryPercentage,label:""},{colorClass:"cluster-utilization-dark-blue",value:e.sharedMemoryPercentage,label:""},{colorClass:"cluster-utilization-normal-blue",value:e.compressedMemoryPercentage,label:""},{colorClass:"cluster-utilization-normal-orange",value:e.swappedMemoryPercentage,label:""},{colorClass:"cluster-utilization-normal-yellow",value:e.balloonedMemoryPercentage,label:""},{colorClass:"cluster-utilization-normal-gray",value:e.unaccessedMemoryPercentage,label:""}]},e.prototype.getMemoryConsumedMetersData=function(e){return[{colorClass:"cluster-utilization-light-blue",value:e.consumedMemoryPercentage,label:this.capacityFormatterService.format(e.consummation,e.maxValue,e.consumedMemoryPercentage)},{colorClass:"cluster-utilization-desaturated-blue",value:e.overheadConsumedMemoryPercentage,label:this.capacityFormatterService.format(e.overheadMemory,e.maxValue,e.overheadConsumedMemoryPercentage)}]},e.prototype.getUtilizationPointersData=function(e){var t=[{colorClass:"cluster-utilization-icon-color-normal-black",value:e.reservationPercentage,icon:"vm-utilization-reservation-arrow-icon"}];return e.clusterDrsEnabled&&t.push({colorClass:"cluster-utilization-icon-color-normal-orange ",value:e.worstCaseAllocationPercentage,icon:"vm-utilization-worst-case-allocation-arrow-icon"}),null!==e.limitPercentage&&t.push({colorClass:"cluster-utilization-icon-color-normal-black",value:e.limitPercentage,icon:"vm-utilization-limit-arrow-icon"}),t},e.$inject=["vxPropertyViewService","i18nService","capacityFormatterService"],e}();e.ClusterUtilizationService=t,angular.module("com.vmware.vsphere.client.cluster").service("clusterUtilizationService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(){}return e.prototype.setClusterId=function(e){this.clusterId=e},e.prototype.getClusterId=function(){return this.clusterId},e.prototype.setClusterName=function(e){this.clusterName=e},e.prototype.getClusterName=function(){return this.clusterName},e.prototype.setSelectedVms=function(e){this.selectedVms=e},e.prototype.getSelectedVms=function(){return this.selectedVms},e.prototype.setVmSettingsSpec=function(e){this.vmSettingsSpec=e},e.prototype.getVmSettingsSpec=function(){return this.vmSettingsSpec},e.prototype.setSelectedVmsSpec=function(e){this.selectedVmsSpec=e},e.prototype.getSelectedVmsSpec=function(){return this.selectedVmsSpec},e}();e.AddClusterVmOverridesManager=t,angular.module("com.vmware.vsphere.client.cluster").factory("AddClusterVmOverridesManager",[function(){return Function.prototype.bind.apply(t,[void 0])}])}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$rootScope=e,this.dataService=t,this.vuiClusterAddVmOverridesWizard=i,this.clusterVmOverridesPageService=r}return e.prototype.invokeWizard=function(e,t,i){var r=this;t.setClusterId(e),t.setSelectedVms([]),this.wizardScope=this.$rootScope.$new();var n=this.createWizardPages(this.wizardScope);this.dataService.getProperties(e,["name"]).then(function(e){if(e&&e.name){var o=e.name;t.setClusterName(o),r.vuiClusterAddVmOverridesWizard.show(n,r.wizardScope,t,i)}})},e.prototype.createWizardPages=function(e){var t=[];return t.push(this.clusterVmOverridesPageService.buildSelectVmsPage(e)),t.push(this.clusterVmOverridesPageService.buildAddVmOverridesPage(e)),t},e.$inject=["$rootScope","dataService","vuiClusterAddVmOverridesWizard","clusterVmOverridesPageService"],e}();e.AddClusterVmOverridesWizardService=t,angular.module("com.vmware.vsphere.client.cluster").service("addClusterVmOverridesWizardService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.clusterVmOverridesConstants=t,this.drsConstants=i,this.drsAutomationLevelService=r,this.addClusterVmOverridesWizardService=n,this.AddClusterVmOverridesManager=o}return e.prototype.openAddVmOverrideWizard=function(e,t){var i=new this.AddClusterVmOverridesManager;this.addClusterVmOverridesWizardService.invokeWizard(e,i,t)},e.prototype.getGridOptions=function(){var e={actionBarOptions:{actions:[]},pageConfig:{hidePager:!0},searchable:!1,resizable:!1,data:[],columnDefs:this.getAllColumnDefs(),height:"100%"};return e},e.prototype.getDrsAutomationLevels=function(){return[{id:this.drsConstants.AUTOMATION_LEVEL_DISABLED,label:this.i18nService.getString("ClusterUi","vm.overrides.DRS.behavior.disabled")}].concat(this.drsAutomationLevelService.getLevels())},e.prototype.isClusterDefault=function(e){return e===this.clusterVmOverridesConstants.CLUSTER_DEFAULT||e===this.clusterVmOverridesConstants.OVERRIDE_NA||e===this.clusterVmOverridesConstants.RESTART_PRIORITY_CLUSTER_DEFAULT||e===this.clusterVmOverridesConstants.ISOLATION_RESPONSE_CLUSTER_DEFAULT||e===this.clusterVmOverridesConstants.RESPONSE_RECOVERY_CLUSTER_DEFAULT},e.prototype.getTooltipParams=function(e,t,i){var r=this,n=[];return _.each(e,function(e){var o;o=r.isClusterDefault(e.value)?r.i18nService.getString("ClusterUi","vm.overrides.config.clusterDefault",r.getOverrideValueLocalizedString(i,t)):r.getOverrideValueLocalizedString(e.value,t),n.push(r.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.tooltip.separator",e.vm.name,o))}),this.buildTooltipParams(n)},e.prototype.getValuesInSecondsTooltipParams=function(e,t){var i=this,r=[];return _.each(e,function(e){var n;n=i.isClusterDefault(e.value)?i.i18nService.getString("ClusterUi","vm.overrides.config.clusterDefault",t+" "+i.i18nService.getString("ClusterUi","vm.overrides.HA.restart.orchestration.seconds")):e.value+" "+i.i18nService.getString("ClusterUi","vm.overrides.HA.restart.orchestration.seconds"),r.push(i.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.tooltip.separator",e.vm.name,n))}),this.buildTooltipParams(r)},e.prototype.getApdDelayTooltipParams=function(e,t,i){var r=this,n=[];return _.each(e,function(e){var o;if(e.value)o=r.i18nService.getString("ClusterUi","vm.overrides.config.clusterDefault",r.i18nService.getString("ClusterUi","vmOverrides.intervalBeforeVmcpReaction.format",i));else{var a=_.find(t,function(t){return t.vm.name===e.vm.name});o=r.i18nService.getString("ClusterUi","vmOverrides.intervalBeforeVmcpReaction.format",a.value)}n.push(r.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.tooltip.separator",e.vm.name,o))}),this.buildTooltipParams(n)},e.prototype.hasMultipleValues=function(e){return e===this.clusterVmOverridesConstants.INITIAL_VALUES},e.prototype.getUniqueValue=function(e){var t=_.uniq(e,!1,function(e){return e.value});return 1===t.length?t[0].value:this.clusterVmOverridesConstants.INITIAL_VALUES},e.prototype.addInitialValuesOption=function(e){e.push({id:this.clusterVmOverridesConstants.INITIAL_VALUES,label:this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues")})},e.prototype.containsValue=function(e,t){return _.some(e,function(e){return e.value===t})},e.prototype.buildTooltipParams=function(e){var t=this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.signPost.title");return{title:t,message:e.join("<br>")}},e.prototype.getOverrideValueLocalizedString=function(e,t){var i=_.find(t,function(t){return String(t.id)===String(e)});return i.label},e.prototype.getAllColumnDefs=function(){return[{displayName:this.i18nService.getString("ClusterUi","vm.overrides.config.vm.selection.name.column"),field:"name",type:"string",template:"<span class='object' title='#:name#'><i class='#:icon#')></i>#:name#</span>"}]},e.$inject=["i18nService","clusterVmOverridesConstants","drsConstants","drsAutomationLevelService","addClusterVmOverridesWizardService","AddClusterVmOverridesManager"],e}();e.ClusterConfigVmOverrideService=t,angular.module("com.vmware.vsphere.client.cluster").service("clusterConfigVmOverrideService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){angular.module("com.vmware.vsphere.client.cluster").constant("clusterVmOverridesConstants",{overrideSpec:{DAS_VM_CONFIG_SPEC:"com.vmware.vim.binding.vim.cluster.DasVmConfigSpec",DRS_VM_CONFIG_SPEC:"com.vmware.vim.binding.vim.cluster.DrsVmConfigSpec",ORCH_VM_CONFIG_SPEC:"com.vmware.vim.binding.vim.cluster.VmOrchestrationSpec",ORCH_VM_INFO_SPEC:"com.vmware.vim.binding.vim.cluster.VmOrchestrationInfo",ORCH_VM_READINESS_SPEC:"com.vmware.vim.binding.vim.cluster.VmReadiness"},operationType:{ADD:"add",EDIT:"edit",REMOVE:"remove"},CLUSTER_DEFAULT:"clusterDefault",RESTART_PRIORITY_CLUSTER_DEFAULT:"clusterRestartPriority",ISOLATION_RESPONSE_CLUSTER_DEFAULT:"clusterIsolationResponse",RESPONSE_RECOVERY_CLUSTER_DEFAULT:"useClusterDefault",OVERRIDE_NA:"VmOverrideNA_S",INITIAL_VALUES:"useInitialValues",APD_DELAY_CLUSTER_DEFAULT:-1})}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l){this.vuiClusterAddVmOverridesWizard=e,this.i18nService=t,this.mutationService=i,this.defaultUriSchemeUtil=r,this.clusterVmOverridesConstants=n,this.clusterSpecBuilderService=o,this.haVmMonitoringService=a,this.drsConstants=s,this.haConstants=c,this.dataService=l}return e.prototype.buildSelectVmsPage=function(e){var t=this;return{title:this.i18nService.getString("ClusterUi","vm.overrides.config.vm.selection.title"),contentUrl:"cluster-ui/resources/cluster/views/settings/configuration/overrides/selectClusterVmOverrideMemberView.html",onCommit:function(){var i=e.manager.getSelectedVms();return i&&i.length>0?(t.vuiClusterAddVmOverridesWizard.markPageComplete(),!0):(t.vuiClusterAddVmOverridesWizard.markPageIncompleteWithError(t.i18nService.getString("ClusterUi","vm.overrides.selection.error.title")),!1)},disableNext:function(){
return e.wizardConfig.loading}}},e.prototype.buildAddVmOverridesPage=function(e){var t=this;return{title:this.i18nService.getString("ClusterUi","vm.overrides.config.add.page.title"),contentUrl:"cluster-ui/resources/cluster/views/settings/configuration/overrides/selectClusterVmOverridesView.html",onCommit:function(){var i=e.manager.getClusterId(),r=e.manager.getVmSettingsSpec(),n=e.manager.getSelectedVmsSpec(),o=!1;if(t.hasOverrides(r)){var a=_.map(n.vms,function(e){return{skipFromOrchestrationSpec:e.skipFromOrchestrationSpec,arrayOperation:e.arrayOperation,key:t.defaultUriSchemeUtil.getManagedObjectReference(e.id),haOverrides:{overridesHaOptions:!1},drsOverrides:{overridesDrsOptions:!1,drsAutomationLevelEditable:!1}}});t.applyOverrides(i,a,r),t.vuiClusterAddVmOverridesWizard.markPageComplete(),o=!0}else t.vuiClusterAddVmOverridesWizard.markPageIncompleteWithError(t.i18nService.getString("ClusterUi","vm.overrides.config.noChangesValidationError"));return o},finishReady:function(){return!e.wizardConfig.loading}}},e.prototype.applyOverrides=function(e,t,i){var r=this,n={};i.drsAutomationOverrideEnabled?_.each(t,function(e){var t=r.buildDrsVmOverridesSpec(i.drsAutomationLevel,e);null!==t&&(angular.isUndefined(n.drsVmOverride)&&(n.drsVmOverride=[]),n.drsVmOverride.push(t))}):_.each(t,function(e){e.drsOverrides.overridesDrsOptions&&e.drsOverrides.drsAutomationLevelEditable&&(angular.isUndefined(n.drsVmOverride)&&(n.drsVmOverride=[]),n.drsVmOverride.push(r.buildRemoveDrsVmOverridesSpec(e)))}),_.each(t,function(e){(i.haRestartPriorityEnabled||i.haRestartPriorityTimeoutEnabled||i.haIsolationResponseEnabled||i.haPdlProtectionEnabled||i.haApdProtectionEnabled||i.haApdDelayEnabled||i.haApdVmRecoveryEnabled||i.haVmMonitoringEnabled||i.mode===r.clusterVmOverridesConstants.operationType.EDIT&&e.haOverrides.overridesHaOptions)&&(angular.isUndefined(n.dasVmOverride)&&(n.dasVmOverride=[]),n.dasVmOverride.push(r.buildDasVmOverridesSpec(i,e)))});var o;o=i.haRestartOrchestrationEnabled||i.haRestartOrchestrationAdditionalDelayEnabled?this.buildAddVmOrchestrationSpec(t,i):this.buildRemoveVmOrchestrationSpec(t,n),o&&o.length>0&&(angular.isUndefined(n.orchestrationVmOverride)&&(n.orchestrationVmOverride=[]),n.orchestrationVmOverride=o);var a=this.clusterSpecBuilderService.buildClusterComputeResourceSpec(n,!0);this.mutationService.apply(e,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",a)},e.prototype.hasOverrides=function(e){return e.drsAutomationOverrideEnabled||e.haRestartPriorityTimeoutEnabled||e.haRestartOrchestrationEnabled||e.haRestartOrchestrationAdditionalDelayEnabled||e.haIsolationResponseEnabled||e.haPdlProtectionEnabled||e.haApdProtectionEnabled||e.haApdDelayEnabled||e.haApdVmRecoveryEnabled||e.haVmMonitoringEnabled},e.prototype.populateVmFtRole=function(e){var t=_.pluck(e,"id");return this.dataService.getPropertiesForObjects(t,["ftRole","isVmcpSupportedForVm"]).then(function(t){return _.each(e,function(e){e.vm={ftVm:!_.isNull(t[e.id].ftRole),isVmcpSupportedForVm:t[e.id].isVmcpSupportedForVm}}),e})},e.prototype.buildDrsVmOverridesSpec=function(e,t){var i=!0;if(this.isInitalValue(e)){if(this.isClusterDefault(t.drsOverrides.drsAutomationLevel))return null;e=t.drsOverrides.drsAutomationLevel}e===this.drsConstants.AUTOMATION_LEVEL_DISABLED&&(i=!1,e=null);var r={_type:"com.vmware.vim.binding.vim.cluster.DrsVmConfigInfo",key:t.key,behavior:e,enabled:i},n=t.drsOverrides.overridesDrsOptions?this.clusterVmOverridesConstants.operationType.EDIT:this.clusterVmOverridesConstants.operationType.ADD;return{_type:this.clusterVmOverridesConstants.overrideSpec.DRS_VM_CONFIG_SPEC,info:r,operation:n}},e.prototype.buildRemoveDrsVmOverridesSpec=function(e){return{_type:this.clusterVmOverridesConstants.overrideSpec.DRS_VM_CONFIG_SPEC,removeKey:e.key,operation:this.clusterVmOverridesConstants.operationType.REMOVE}},e.prototype.buildDasVmOverridesSpec=function(e,t){var i={_type:"com.vmware.vim.binding.vim.cluster.DasVmConfigInfo",key:t.key};i.dasSettings={_type:"com.vmware.vim.binding.vim.cluster.DasVmSettings"},e.haRestartPriorityEnabled?this.isInitalValue(e.haRestartPriority)?i.dasSettings.restartPriority=t.haOverrides.haRestartPriority:i.dasSettings.restartPriority=e.haRestartPriority:i.dasSettings.restartPriority=this.clusterVmOverridesConstants.RESTART_PRIORITY_CLUSTER_DEFAULT,e.haRestartPriorityTimeoutEnabled?this.isInitalValue(e.haRestartPriorityTimeout)?i.dasSettings.restartPriorityTimeout=t.haOverrides.haRestartPriorityTimeout:i.dasSettings.restartPriorityTimeout=e.haRestartPriorityTimeout:i.dasSettings.restartPriorityTimeout=this.clusterVmOverridesConstants.APD_DELAY_CLUSTER_DEFAULT,e.haIsolationResponseEnabled?this.isInitalValue(e.haIsolationResponse)?i.dasSettings.isolationResponse=t.haOverrides.haIsolationResponse:i.dasSettings.isolationResponse=e.haIsolationResponse:i.dasSettings.isolationResponse=this.clusterVmOverridesConstants.ISOLATION_RESPONSE_CLUSTER_DEFAULT,this.buildVmcpSettingsSpec(e,i,t),this.buildVmMonitoringSettingsSpec(e,i,t);var r=t.haOverrides.overridesHaOptions?this.clusterVmOverridesConstants.operationType.EDIT:this.clusterVmOverridesConstants.operationType.ADD;return{_type:this.clusterVmOverridesConstants.overrideSpec.DAS_VM_CONFIG_SPEC,info:i,operation:r}},e.prototype.isClusterDefault=function(e){return e===this.clusterVmOverridesConstants.CLUSTER_DEFAULT||e===this.clusterVmOverridesConstants.OVERRIDE_NA||e===this.clusterVmOverridesConstants.RESTART_PRIORITY_CLUSTER_DEFAULT||e===this.clusterVmOverridesConstants.ISOLATION_RESPONSE_CLUSTER_DEFAULT||e===this.clusterVmOverridesConstants.RESPONSE_RECOVERY_CLUSTER_DEFAULT},e.prototype.isInitalValue=function(e){return e===this.clusterVmOverridesConstants.INITIAL_VALUES||e===this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues")},e.prototype.buildAddVmOrchestrationSpec=function(e,t){var i=this,r=[];return _.each(e,function(e){var n={_type:i.clusterVmOverridesConstants.overrideSpec.ORCH_VM_CONFIG_SPEC,operation:e.arrayOperation,info:{_type:i.clusterVmOverridesConstants.overrideSpec.ORCH_VM_INFO_SPEC,vm:e.key,vmReadiness:{_type:i.clusterVmOverridesConstants.overrideSpec.ORCH_VM_READINESS_SPEC}}};i.isInitalValue(t.restartOrchestration.readyCondition)||_.extend(n.info.vmReadiness,{readyCondition:t.haRestartOrchestrationEnabled?t.restartOrchestration.readyCondition:"useClusterDefault"}),i.isInitalValue(t.restartOrchestration.postReadyDelay)||_.extend(n.info.vmReadiness,{postReadyDelay:t.restartOrchestration.postReadyDelay}),(n.info.vmReadiness.readyCondition||n.info.vmReadiness.postReadyDelay)&&r.push(n)}),r},e.prototype.buildRemoveVmOrchestrationSpec=function(e,t){var i=this,r=[];return _.each(e,function(e){e.skipFromOrchestrationSpec||e.arrayOperation!==i.clusterVmOverridesConstants.operationType.REMOVE||r.push({_type:i.clusterVmOverridesConstants.overrideSpec.ORCH_VM_CONFIG_SPEC,removeKey:e.key,operation:i.clusterVmOverridesConstants.operationType.REMOVE})}),r},e.prototype.buildVmcpSettingsSpec=function(e,t,i){(e.haPdlProtectionEnabled||e.haApdProtectionEnabled||e.haApdDelayEnabled||e.haApdVmRecoveryEnabled||e.mode===this.clusterVmOverridesConstants.operationType.EDIT)&&(t.dasSettings.vmComponentProtectionSettings={_type:"com.vmware.vim.binding.vim.cluster.VmComponentProtectionSettings"},e.haPdlProtectionEnabled?this.isInitalValue(e.haPdlProtection)?t.dasSettings.vmComponentProtectionSettings.vmStorageProtectionForPDL=i.haOverrides.pdlProtectionLevel:t.dasSettings.vmComponentProtectionSettings.vmStorageProtectionForPDL=e.haPdlProtection:t.dasSettings.vmComponentProtectionSettings.vmStorageProtectionForPDL=this.clusterVmOverridesConstants.CLUSTER_DEFAULT,e.haApdProtectionEnabled?this.isInitalValue(e.haApdProtection)?t.dasSettings.vmComponentProtectionSettings.vmStorageProtectionForAPD=i.haOverrides.apdProtectionLevel:t.dasSettings.vmComponentProtectionSettings.vmStorageProtectionForAPD=e.haApdProtection:t.dasSettings.vmComponentProtectionSettings.vmStorageProtectionForAPD=this.clusterVmOverridesConstants.CLUSTER_DEFAULT,e.haApdDelayEnabled?this.isInitalValue(e.haApdDelay)?t.dasSettings.vmComponentProtectionSettings.vmTerminateDelayForAPDSec=i.haOverrides.intervalBeforeVmcpReaction*this.haConstants.SECONDS_IN_A_MINUTE:t.dasSettings.vmComponentProtectionSettings.vmTerminateDelayForAPDSec=e.haApdDelay*this.haConstants.SECONDS_IN_A_MINUTE:t.dasSettings.vmComponentProtectionSettings.vmTerminateDelayForAPDSec=this.clusterVmOverridesConstants.APD_DELAY_CLUSTER_DEFAULT,e.haApdVmRecoveryEnabled?this.isInitalValue(e.haApdVmRecovery)?t.dasSettings.vmComponentProtectionSettings.vmReactionOnAPDCleared=i.haOverrides.vmRemediationOnApdRecover:t.dasSettings.vmComponentProtectionSettings.vmReactionOnAPDCleared=e.haApdVmRecovery:t.dasSettings.vmComponentProtectionSettings.vmReactionOnAPDCleared=this.clusterVmOverridesConstants.RESPONSE_RECOVERY_CLUSTER_DEFAULT)},e.prototype.buildVmMonitoringSettingsSpec=function(e,t,i){(e.haVmMonitoringEnabled||e.mode===this.clusterVmOverridesConstants.operationType.EDIT)&&(t.dasSettings.vmToolsMonitoringSettings={_type:"com.vmware.vim.binding.vim.cluster.VmToolsMonitoringSettings"},e.haVmMonitoringEnabled?(t.dasSettings.vmToolsMonitoringSettings.clusterSettings=!1,this.setVmMonitoringSettings(e,t,i)):t.dasSettings.vmToolsMonitoringSettings.clusterSettings=!0)},e.prototype.setVmMonitoringSettings=function(e,t,i){if(this.isInitalValue(e.haVmMonitoring)){if(this.isClusterDefault(i.haOverrides.vmMonitoring))return void(t.dasSettings.vmToolsMonitoringSettings.clusterSettings=!0);t.dasSettings.vmToolsMonitoringSettings.vmMonitoring=i.haOverrides.vmMonitoring}else t.dasSettings.vmToolsMonitoringSettings.vmMonitoring=e.haVmMonitoring;this.setVmMonitoringSensitivitySettings(e,t,i)},e.prototype.setVmMonitoringSensitivitySettings=function(e,t,i){if(this.isInitalValue(e.haVmMonitoringSensitivity))this.setVmMonitoringSettingsValues(t,i.haOverrides.vmFailureIntervalValue,i.haOverrides.vmMinUptimeValue,i.haOverrides.vmMaxFailuresValue,i.haOverrides.vmMaxFailureWindowValue);else if(e.haVmMonitoringSensitivity===this.haVmMonitoringService.getPresetLevels().CUSTOM){var r=e.vmToolsMonitorHasFailureWindow?3600*e.vmToolsMonitorMaxFailureWindow:this.haConstants.vmMonitoringSensitivity.NO_FAILURE_WINDOW;this.setVmMonitoringSettingsValues(t,e.vmToolsMonitorFailureInt,e.vmToolsMonitorMinUpTime,e.vmToolsMonitorMaxFailures,r)}else{var n=this.haVmMonitoringService.getSensitivityLevelValues(e.haVmMonitoringSensitivity);this.setVmMonitoringSettingsValues(t,n.failure_interval,n.min_uptime,n.max_failures,3600*n.failure_window)}},e.prototype.setVmMonitoringSettingsValues=function(e,t,i,r,n){e.dasSettings.vmToolsMonitoringSettings.failureInterval=t,e.dasSettings.vmToolsMonitoringSettings.minUpTime=i,e.dasSettings.vmToolsMonitoringSettings.maxFailures=r,e.dasSettings.vmToolsMonitoringSettings.maxFailureWindow=n},e.$inject=["vuiClusterAddVmOverridesWizard","i18nService","mutationService","defaultUriSchemeUtil","clusterVmOverridesConstants","clusterSpecBuilderService","haVmMonitoringService","drsConstants","haConstants","dataService"],e}();e.ClusterVmOverridesPageService=t,angular.module("com.vmware.vsphere.client.cluster").service("clusterVmOverridesPageService",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a){function s(t){return e.getData(t,"com.vmware.vsphere.client.clusterui.model.configuration.VmOverridesData").then(function(e){return{overrides:e?e.vmOverrides:[]}})}function c(e,r,n){var o=_.map(r,function(e){return angular.merge({_type:"com.vmware.vim.binding.vmodl.ManagedObjectReference"},e.vm.provider)}),a={title:t.getString("ClusterUi","actionDeleteVmOverrideCaption"),message:t.getString("ClusterUi","actionDeleteVmOverrideConfirmation"),focusTarget:n,submit:function(){l(e,r,o)}};i.openConfirmationModal(a)}function l(e,a,s){var c={},l=!1;c.dasVmOverride=[],_.each(s,function(e,t){a[t].haOverrides.overridesHaOptions&&c.dasVmOverride.push({_type:o.overrideSpec.DAS_VM_CONFIG_SPEC,operation:o.operationType.REMOVE,removeKey:e})}),c.drsVmOverride=[],_.each(s,function(e,t){a[t].drsOverrides.overridesDrsOptions&&(a[t].drsOverrides.drsAutomationLevelEditable?c.drsVmOverride.push({_type:o.overrideSpec.DRS_VM_CONFIG_SPEC,operation:o.operationType.REMOVE,removeKey:e}):l=!0)}),c.orchestrationVmOverride=[],_.each(s,function(e,t){a[t].haOverrides.overridesResOrchOptions&&c.orchestrationVmOverride.push({_type:o.overrideSpec.ORCH_VM_CONFIG_SPEC,operation:o.operationType.REMOVE,removeKey:e})});var d=r.buildClusterComputeResourceSpec(c,!0);n.apply(e,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",d),l&&i.openConfirmationModal({title:t.getString("ClusterUi","actionDeleteVmOverridesCaption"),message:t.getString("ClusterUi","actionDeleteVmOverridesSomeOverridesWontBeDeleted"),icon:"vx-icon-warning-32x32",saveButtonLabel:t.getString("Common","alert.ok"),hideCancelButton:!0,submit:function(){return!0}})}function d(e){var t=a.createPropertyViewBuilder();return u(t,e),p(t,e.pdlProtectionLevelText),v(t,e),m(t,e),t.build()}function u(e,i){e.category("restartCondition").title(t.getString("ClusterUi","vm.overrides.restart.condition.tab.label")).section("restartConditionSection").property(t.getString("ClusterUi","vm.overrides.restart.condition.label"),i.haRestartConditionsText).property(t.getString("ClusterUi","vm.overrides.restart.condition.delay.label"),i.haRestartConditionDelay).property(t.getString("ClusterUi","vm.overrides.restart.condition.timeout.label"),i.haRestartPriorityTimeout)}function p(e,i){e.category("pdlProtection").title(t.getString("ClusterUi","vm.overrides.pdl.tab.label")).section("pdlProtectionSection").title(t.getString("ClusterUi","vm.overrides.pdl.protection.title")).property(t.getString("ClusterUi","vm.overrides.pdlAndAdp.failure.response.protection.label"),i)}function v(e,i){e.category("apdProtection").title(t.getString("ClusterUi","vm.overrides.apd.tab.label")).section("apdProtectionSection").title(t.getString("ClusterUi","vm.overrides.apd.protection.title")).property(t.getString("ClusterUi","vm.overrides.pdlAndAdp.failure.response.protection.label"),i.apdProtectionLevelText).property(t.getString("ClusterUi","vm.overrides.apd.failover.delay.label"),i.intervalBeforeVmcpReactionText).property(t.getString("ClusterUi","vm.overrides.apd.response.recovery.label"),i.vmRemediationOnApdRecoverText)}function m(e,i){e.category("vmMonitoring").title(t.getString("ClusterUi","vmOverrides.vmMonitoringHeaderText")).section("vmMonitoringSection").property(t.getString("ClusterUi","vmOverrides.vmMonitoringHeaderText"),i.vmMonitoringText).property(t.getString("ClusterUi","vmOverrides.vmMonitoringSensitivityHeaderText"),i.vmMonitoringSensitivityText).property(t.getString("ClusterUi","vm.overrides.failure.interval.label"),i.vmFailureInterval).property(t.getString("ClusterUi","vm.overrides.minimum.uptime.label"),i.vmMinUptime).property(t.getString("ClusterUi","vm.overrides.max.resests.label"),i.vmMaxFailures).property(t.getString("ClusterUi","vm.overrides.max.reset.time.window.label"),i.vmMaxFailureWindow)}return{getVmOverridesData:s,deleteVmOverride:c,buildPropertyView:d}}angular.module("com.vmware.vsphere.client.cluster").service("clusterVmOverridesService",e),e.$inject=["dataService","i18nService","clarityModalService","clusterSpecBuilderService","mutationService","clusterVmOverridesConstants","vxPropertyViewService"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.wizardPageService=e,this.vuiWizardService=t,this.$rootScope=i,this.i18nService=r}return e.prototype.show=function(e,t,i,r){this.wizardConfig={title:this.i18nService.getString("ClusterUi","vm.overrides.config.add.dialog.title",i.getClusterName()),pages:this.wizardPageService.initializePageStates(e),cssClass:"add-vm-overrides-wizard",resizeMinHeight:500,onFinish:function(){return!0}},this.wizardScope=t,this.wizardScope.manager=i,this.wizardScope.wizardConfig=this.wizardConfig,t.modalOptions={focusTarget:r},this.vuiWizardService({scope:this.wizardScope,configObjectName:"wizardConfig"}).show()},e.prototype.markPageIncompleteWithError=function(e){this.wizardPageService.markPageIncompleteWithError(this.wizardConfig,e)},e.prototype.markPageComplete=function(e){this.wizardPageService.clearErrors(this.wizardConfig),this.wizardPageService.markPageComplete(this.wizardConfig,e)},e.$inject=["wizardPageService","vuiWizardService","$rootScope","i18nService"],e}();angular.module("com.vmware.vsphere.client.cluster").service("vuiClusterAddVmOverridesWizard",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.cluster").factory("createResourcePoolService",[function(){function e(){var e={parent:null,name:"",configSpec:{_type:"com.vmware.vim.binding.vim.ResourceConfigSpec",cpuAllocation:{_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",expandableReservation:!0,limit:-1,reservation:0,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",level:"normal",shares:4e3}},memoryAllocation:{_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",expandableReservation:!0,limit:-1,reservation:0,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",level:"normal",shares:163840}}}};return e}function t(e){var t={name:e};return t}return{createDefaultResourcePoolSpec:e,createCreateResourcePoolNameSpec:t}}])}();var cluster_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.columnRenderersRegistry=t,this.defaultUriSchemeUtil=i}return e.prototype.getGridOptions=function(){var e={actionBarOptions:{actions:[]},pageConfig:{hidePager:!0},searchable:!1,resizable:!1,data:[],columnDefs:this.getAllColumnDefs(),height:"100%"};return e},e.prototype.getAllColumnDefs=function(){var e=this;return[{displayName:this.getString("ha.vmcp.monitoring.host.header"),field:"hostName",template:function(t){return e.getColumnTemplate("vsphere-icon-host","hostName","hostRef",t)}},{displayName:this.getString("ha.vmcp.monitoring.datastore.header"),field:"datastoreName",template:function(t){return e.getColumnTemplate("vsphere-icon-datastore","datastoreName","datastoreRef",t)}},{displayName:this.getString("ha.vmcp.monitoring.dsCluster.header"),field:"dsClusterName",template:function(t){return e.getColumnTemplate("vsphere-icon-datastore-cluster","dsClusterName","dsClusterRef",t)}},{displayName:this.getString("ha.vmcp.monitoring.failure.header"),field:"reason",template:function(t){var i="";return t&&t.reason&&(i=e.getInaccessibleReason(t)),i}}]},e.prototype.getInaccessibleReason=function(e){var t={APD_DETECTED:this.getString("ha.vmcp.monitoring.reason.APD_DETECTED"),APD_TIMEOUT:this.getString("ha.vmcp.monitoring.reason.APD_TIMEOUT"),PDL:this.getString("ha.vmcp.monitoring.reason.PDL")};return t.hasOwnProperty(e.reason)?t[e.reason]:""},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.prototype.getColumnRenderer=function(e){return this.columnRenderersRegistry.getColumnRenderer(e)},e.prototype.getColumnTemplate=function(e,t,i,r){var n=this.getColumnRenderer("object-link"),o=this.defaultUriSchemeUtil.getVsphereObjectId(r[i]),a={currentObjectId:o,name:r[t]};return r&&r[t]&&r[i]?n(["currentObjectId","name",e],a):""},e.$inject=["i18nService","columnRenderersRegistry","defaultUriSchemeUtil"],e}();e.DatastoresUnderApdPdlService=t,angular.module("com.vmware.vsphere.client.cluster").service("datastoresUnderApdPdlService",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t){function i(){return Object.keys(t.dpmAutomationLevel).map(function(e){return r(e)})}function r(e){var i=!0,r=t.dpmAutomationLevel[e];return""===r&&(i=!1),{id:r,label:n(i,r),description:o(i,r)}}function n(e,i){if(!e)return a("drs.config.dpm.disabled");switch(i){case t.dpmAutomationLevel.MANUAL:return a("drs.config.dpm.automationLevel.manual");case t.dpmAutomationLevel.AUTOMATED:return a("drs.config.dpm.automationLevel.automated");default:return""}}function o(e,i){if(!e)return a("drs.config.dpm.disabledDescription");switch(i){case t.dpmAutomationLevel.MANUAL:return a("drs.config.dpm.automationLevel.manualDescription");case t.dpmAutomationLevel.AUTOMATED:return a("drs.config.dpm.automationLevel.automatedDescription");default:return""}}function a(t){return e.getString("ClusterUi",t)}return{getText:n,getDescription:o,getAutomationLevels:i}}angular.module("com.vmware.vsphere.client.cluster").service("dpmAutomationLevelService",e),e.$inject=["i18nService","drsConstants"]}(),function(){"use strict";function e(e,t,i){function r(e,t){if(e&&!o(t))return s.warn("Unexpected DPM threshold: "+t),"";var r=e?i.interpolate("drs.config.dpmThresholdLabel.priority{0}Description",[t]):"drs.config.dpmThresholdLabel.notAvailable";return a(r)}function n(t){return e.dpmThreshold.MAX-t+e.dpmThreshold.MIN}function o(t){return e.dpmThreshold.RANGE.indexOf(t)!==-1}function a(e){return i.getString("ClusterUi",e)}var s=t("drsMigrationThresholdService");return{getText:r,reverseDpmRateAndThreshold:n,MIN:e.dpmThreshold.MIN,MAX:e.dpmThreshold.MAX,DEFAULT:(e.dpmThreshold.MIN+e.dpmThreshold.MAX)/2,MIN_LABEL:a("drs.config.threshold.conservative"),MAX_LABEL:a("drs.config.threshold.aggressive")}}angular.module("com.vmware.vsphere.client.cluster").service("dpmThresholdService",e),e.$inject=["drsConstants","logService","i18nService"]}(),function(){"use strict";function e(e,t){function i(){var e=Object.keys(t.automationLevel).map(function(e){var i=t.automationLevel[e],r=n(i);return r});return e}function r(e){var t=n(e);return t}function n(e){return{id:e,label:o(e),description:a(e)}}function o(i){var r;switch(i){case t.automationLevel.MANUAL:r="drs.config.automationLevel.manual";break;case t.automationLevel.PARTIALLY_AUTOMATED:r="drs.config.automationLevel.partialauto";break;case t.automationLevel.FULLY_AUTOMATED:r="drs.config.automationLevel.fullauto";break;default:return""}return e.getString("ClusterUi",r)}function a(i){var r;switch(i){case t.automationLevel.MANUAL:r="drs.config.automationLevel.manualDescription";break;case t.automationLevel.PARTIALLY_AUTOMATED:r="drs.config.automationLevel.partialautoDescription";break;case t.automationLevel.FULLY_AUTOMATED:r="drs.config.automationLevel.fullautoDescription";break;default:return""}return e.getString("ClusterUi",r)}return{DEFAULT_LEVEL:n(t.automationLevel.FULLY_AUTOMATED),getLevels:i,getLevelByKey:r,getLabel:o}}angular.module("com.vmware.vsphere.client.cluster").service("drsAutomationLevelService",e),e.$inject=["i18nService","drsConstants"]}(),angular.module("com.vmware.vsphere.client.cluster").constant("drsConstants",{automationLevel:{MANUAL:"manual",PARTIALLY_AUTOMATED:"partiallyAutomated",FULLY_AUTOMATED:"fullyAutomated"},AUTOMATION_LEVEL_DISABLED:"disabled",migrationThreshold:{MIN:1,MAX:5,RANGE:[1,2,3,4,5]},dpmAutomationLevel:{DISABLED:"",MANUAL:"manual",AUTOMATED:"automated"},dpmThreshold:{MIN:1,MAX:5,RANGE:[1,2,3,4,5]},clusterRecommendationSpecOperation:{APPLY:"apply",CANCEL:"cancel",REFRESH:"refresh"},faults:{DRSFAULT_POWERONVM:"powerOnVm",DRSFAULT_INCREASECAP:"increaseCapacity",DRSFAULT_ENTERSTANDBY:"enterStandby",DRSFAULT_INSUFFICIENT_RESOURCES:"unreservedCapacity"},drsPolicies:{EVEN_DISTRIBUTION_OPTION:"TryBalanceVmsPerHost",EVEN_DISTRIBUTION_VALUE:"1",ALL_CONSUMED_MEMORY_METRIC_OPTION:"PercentIdleMBInMemDemand",ALL_CONSUMED_MEMORY_METRIC_VALUE:"100",CPU_OVERCOMMITMENT_OPTION:"MaxVcpusPerCore",CPU_OVERCOMMITMENT_MIN:0,CPU_OVERCOMMITMENT_MAX:500}}),function(){"use strict";function e(e,t,i,r,n,o){function a(t){return e.getString("Common","drs.migration.error."+t)}function s(e){var t={};if(e.target){var o={};o[i.ID_KEY]=e.target.provider,o[i.NAME_KEY]=e.target.name;var s=[o];t[i.TEXT_KEY]=r.interpolateWithLinks("{0}",s),t[i.ICON_KEY]=n.getByObjectRef(e.target.provider)}var c={};return c[i.LOCALIZED_REASON]=a(e.reason),c[i.REASON]=e.reason,c[i.TARGET_KEY]=e.target?t:"",c[i.DETAILS_KEY]=e.details,c[i.ICON_KEY]="vsphere-icon-status-error",c}function c(i,r){var n=null;switch(i){case t.faults.DRSFAULT_POWERONVM:n=u(r);break;case t.faults.DRSFAULT_INCREASECAP:n=d(r);break;case t.faults.DRSFAULT_ENTERSTANDBY:n=l(r);break;case t.faults.DRSFAULT_INSUFFICIENT_RESOURCES:var a=e.getString("ClusterUi","drs.action.reconfigureHA");n=v(r,a);break;default:r.preventedRecommendation.targetVm?n=p(r):o.sendDebugMessage("[DRS Faults] details.preventedRecommendation.targetVm is not defined",{reason:i,details:r})}return n}function l(t){var i=e.getString("ClusterUi","drs.faults.preventedRecommendation.powerOffHost");return t.preventedRecommendation.targetHost&&(i=r.interpolateWithLinks(e.getString("ClusterUi","drs.action.powerOffHost"),[h(t)])),v(t,i)}function d(t){var i=e.getString("ClusterUi","drs.action.powerOnAnyHost");return t.preventedRecommendation.targetHost&&(i=r.interpolateWithLinks(e.getString("ClusterUi","drs.action.powerOnHost"),[h(t)])),v(t,i)}function u(t){var i=[f(t),h(t)],n=r.interpolateWithLinks(e.getString("ClusterUi","drs.action.placeVm"),i);return v(t,n)}function p(t){var i=e.getString("ClusterUi","anyHost");t.preventedRecommendation.targetHost&&(i=h(t));var n=[f(t),g(t),i],o=r.interpolateWithLinks(e.getString("ClusterUi","drs.action.migrateVm"),n);return v(t,o)}function v(e,t){var r={};return r[i.REASON]=m(e.faultDetailMessage,e.helpId),r[i.REASON_ICON_CLASS]="vsphere-icon-status-error",r[i.PREVENTED_RECOMMENDATION]=t,r[i.PREVENTED_RECOMMENDATION_ICON_CLASS]=e.preventedRecommendationIcon,r}function m(e,t){return"<a ng-click=\"$parent.$parent.openHelpLink('"+t+"')\">"+e+"</a>"}function g(e){var t=e.preventedRecommendation.targetVm,r={};return r[i.ID_KEY]=t.host,r[i.NAME_KEY]=t.hostName,r}function h(e){var t=e.preventedRecommendation.targetHost,r={};return r[i.ID_KEY]=t.provider,r[i.NAME_KEY]=t.name,r}function f(e){var t=e.preventedRecommendation.targetVm,r={};return r[i.ID_KEY]=t.provider,r[i.NAME_KEY]=t.name,r}return{getFaultMasterData:s,getFaultDetailsData:c}}angular.module("com.vmware.vsphere.client.cluster").factory("drsFaultsService",e),e.$inject=["i18nService","drsConstants","drsFaultsViewConstants","drsFaultsViewService","iconService","feedbackService"]}(),function(){"use strict";function e(e,t,i){function r(t){if(!s(t))return l.warn("Unexpected migration threshold: "+t),"";var i=e.interpolate("drs.config.migrationThreshold.priority{0}",[t]);return c(i)}function n(t){if(!s(t))return l.warn("Unexpected migration threshold: "+t),"";var i=e.interpolate("drs.config.migrationThreshold.priority{0}Description",[t]);return c(i)}function o(e){return a(e)}function a(e){return s(e)?t.migrationThreshold.MAX-e+t.migrationThreshold.MIN:(l.warn("Unexpected migration threshold: "+e),NaN)}function s(e){return t.migrationThreshold.RANGE.indexOf(e)!==-1}function c(t){return e.getString("ClusterUi",t)}var l=i("drsMigrationThresholdService");return{getText:r,getDescription:n,MIN:t.migrationThreshold.MIN,MAX:t.migrationThreshold.MAX,DEFAULT:(t.migrationThreshold.MIN+t.migrationThreshold.MAX)/2,MIN_LABEL:c("drs.config.threshold.conservative"),MAX_LABEL:c("drs.config.threshold.aggressive"),getDrsMigrationRate:o}}angular.module("com.vmware.vsphere.client.cluster").service("drsMigrationThresholdService",e),e.$inject=["i18nService","drsConstants","logService"]}();var cluster_ui;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.getEvenDistributionLabel=function(e){return e.evenDistributionEnabled?this.i18nService.getString("ClusterUi","drs.config.evenDistribution.on"):this.i18nService.getString("ClusterUi","drs.config.evenDistribution.off")},e.prototype.getConsumedOrActiveMemoryLabel=function(e){return e.allConsumedMemoryMetricEnabled?this.i18nService.getString("ClusterUi","drs.config.consumedOrActiveMemory.consumed"):this.i18nService.getString("ClusterUi","drs.config.consumedOrActiveMemory.active")},e.prototype.getCpuOverCommitmentLabel=function(e){return e.cpuOverCommitment?this.getCpuOvercommitmentText(e.cpuOverCommitmentPercent):this.i18nService.getString("ClusterUi","drs.config.cpuOverCommitment.notConfigured")},e.prototype.getCpuOvercommitmentText=function(e){return 0===e?this.i18nService.getString("ClusterUi","drs.config.cpuOverCommitment.notAllowed"):this.i18nService.getString("ClusterUi","drs.config.cpuOverCommitment.allowed",e)},e.$inject=["i18nService"],e}();e.DrsPoliciesService=t,angular.module("com.vmware.vsphere.client.cluster").service("drsPoliciesService",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n){function o(e,i,r,n){var o={infraUpdateHaConfig:{enabled:e}};if(e){switch(o.infraUpdateHaConfig.behavior=i,String(r)){case t.proactiveHaRemediationLevel.QUARANTINE:o.infraUpdateHaConfig.moderateRemediation=t.proactiveHaRemediationMode.QUARANTINE_MODE,o.infraUpdateHaConfig.severeRemediation=t.proactiveHaRemediationMode.QUARANTINE_MODE;break;case t.proactiveHaRemediationLevel.BALANCED:o.infraUpdateHaConfig.moderateRemediation=t.proactiveHaRemediationMode.QUARANTINE_MODE,o.infraUpdateHaConfig.severeRemediation=t.proactiveHaRemediationMode.MAINTENANCE_MODE;break;default:o.infraUpdateHaConfig.moderateRemediation=t.proactiveHaRemediationMode.MAINTENANCE_MODE,o.infraUpdateHaConfig.severeRemediation=t.proactiveHaRemediationMode.MAINTENANCE_MODE}o.infraUpdateHaConfig.providers=_.filter(n,function(e){return e.isEnabled}).map(function(e){return e.idProvider})}return o}function a(e){return h(t.proactiveHaRemediationLevel.QUARANTINE===e?"ha.config.failures.responses.partial.failure.remediation.quarantine.desc":t.proactiveHaRemediationLevel.BALANCED===e?"ha.config.failures.responses.partial.failure.remediation.balanced.desc":"ha.config.failures.responses.partial.failure.remediation.maintenance.desc")}function s(e){return h(t.proactiveHaAutomationLevel.MANUAL===e?"ha.config.failures.responses.partial.failure.automation.manual.desc":"ha.config.failures.responses.partial.failure.automation.automated.desc")}function c(e,t){var i={propertyParams:[{propertyName:"filterForProvider",parameterType:"java.lang.String",parameter:t}]};return r.getProperties(e,["filterForProvider"],i)}function l(){return{message:e.getString("ClusterUi","ha.config.failures.responses.partial.filter.desc"),title:e.getString("ClusterUi","ha.config.failures.responses.partial.filter.label")}}function d(){return{message:e.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.clusterLevelVuiSignPost.desc"),title:e.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.clusterLevelVuiSignPost.title")}}function u(){return{selectionMode:i.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!0,sortMode:i.grid.sortMode.NONE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:m()}}function p(e,i,r,n){var o,a=e&&e===t.proactiveHaBlockAtTypes.CLUSTER_LEVEL;o=a?i.filterHostInfo:e===t.proactiveHaBlockAtTypes.INDIVIDUAL_HOSTS?n:[];var s=r;return s=_.filter(s,function(e){return e.isFilterOn}),{name:i.name,id:i.id,providerId:i.providerId,providerName:i.providerName,isClusterLevelSet:a,filterHealthUpdateInfo:s,filterHostInfo:o}}function v(e,i){var r,n=_.some(e,function(e){return e.isFilterOn}),o=_.some(i,function(e){return e.isFilterOn});return n&&(r=o?t.proactiveHaBlockAtTypes.INDIVIDUAL_HOSTS:t.proactiveHaBlockAtTypes.CLUSTER_LEVEL),r}function m(){return[{displayName:e.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.grid.hosts"),template:function(e){return e&&e.name?g(e):null}}]}function g(e){var t=n.getColumnRenderer("icon-text");return t(["icon","text"],{icon:"vsphere-icon-cluster",text:e.name})}var h=_.bind(e.getString,e,"ClusterUi");return{getFormData:o,getRemediationLevelDescription:a,getAutomationLevelDescription:s,getFilterForProvider:c,failureConditionsVuiSignPost:l,getFailureConditionsHostsDatagridOptions:u,failureConditionsClusterLevelVuiSignPost:d,getFilterModelSpec:p,getBlockAtValue:v,REMEDIATION_LEVELS:[{value:t.proactiveHaRemediationLevel.BALANCED,label:h("ha.config.failures.responses.partial.failure.remediation.dd.balanced")
},{value:t.proactiveHaRemediationLevel.QUARANTINE,label:h("ha.config.failures.responses.partial.failure.remediation.dd.quarantinemode")},{value:t.proactiveHaRemediationLevel.MAINTENANCE,label:h("ha.config.failures.responses.partial.failure.remediation.dd.maintenancemode")}],AUTOMATION_LEVELS:[{value:t.proactiveHaAutomationLevel.AUTOMATED,label:h("ha.portlet.host.partial.failure.response.Automated")},{value:t.proactiveHaAutomationLevel.MANUAL,label:h("ha.portlet.host.partial.failure.response.Manual")}]}}angular.module("com.vmware.vsphere.client.cluster").service("editProactiveHaService",e),e.$inject=["i18nService","clusterConstants","vuiConstants","dataService","columnRenderersRegistry"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.cluster").factory("editResourcePoolService",[function(){function e(){var e={configSpec:{_type:"com.vmware.vim.binding.vim.ResourceConfigSpec",cpuAllocation:{_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",expandableReservation:!0,limit:-1,reservation:0,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",level:"normal",shares:4e3}},memoryAllocation:{_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",expandableReservation:!0,limit:-1,reservation:0,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",level:"normal",shares:163840}}}};return e}return{editDefaultResourcePoolSpec:e}}])}(),angular.module("com.vmware.vsphere.client.cluster").constant("evcConstants",{cpuVendor:{UNKNOWN:"unknown",AMD:"amd",INTEL:"intel"}}),function(){"use strict";function e(e,t,i,r){function n(e){var i={};return e&&null!==e.admissionControlEnabled&&angular.isDefined(e.admissionControlEnabled)?e.admissionControlEnabled?e.admissionControlPolicy?o(e):(g.error("Admission control policy is not defined: "+e),i):(i.policyLabel=m("policy.disabled.label"),i.policyType=t.admissionControlPolicy.DISABLED_TYPE,i):(g.error("HA data is not set: "+e),i)}function o(e){var i={};switch(i.policyType=e.admissionControlPolicy._type,e.admissionControlPolicy._type){case t.admissionControlPolicy.FAILOVER_LEVEL_TYPE:i.policyLabel=m("policy.failoverlevel.label"),i.reservedFailoverCapacity=a(e.failoverHostNum);break;case t.admissionControlPolicy.FAILOVER_RESOURCES_TYPE:i.policyLabel=m("policy.failoverResources.label"),i.cpuFailoverInPercent=m("failoverResources.percent",e.cpuFailoverPercent),i.memoryFailoverInPercent=m("failoverResources.percent",e.memoryFailoverPercent);break;case t.admissionControlPolicy.FAILOVER_HOSTS_TYPE:i.policyLabel=m("policy.failoverHosts.label"),i.dedicatedHosts=a(e.dedicatedHostNum);break;default:g.warnings("Unknown admission policy: "+e.admissionControlPolicy._type)}return i}function a(e){var t="";return 1===e?t=m("host",e):e>1&&(t=m("host.plural",e)),t}function s(){var e=Object.keys(t.admissionControlPolicy).map(function(e){var i=t.admissionControlPolicy[e],r=c(i);return r});return e}function c(e){return{type:e,label:v(e)}}function l(e){function t(){return s.failoverHosts}function i(){var e=_.map(s.failoverHosts,function(e){return r.getVsphereObjectId(e.provider)});return e}function n(e,t){var i=_.map(t,function(e){return a(e)});return e.data=e.data.concat(i),s.failoverHosts=e.data,!0}function o(e,t){e.data=_.reject(e.data,function(e){return!!_.find(t,function(t){return t.name===e.name})}),s.failoverHosts=e.data}function a(e){var t=r.getPartsFromVsphereObjectId(e.rawData.id);return{iconId:e.rawData.icon,name:e.rawData.name,provider:t}}var s=e;return{getFailoverHostsGridData:t,getFailoverHostIds:i,addFailoverHosts:n,removeFailoverHost:o}}function d(){return h}function u(){return f}function p(){return S}function v(i){var r;switch(i){case t.admissionControlPolicy.FAILOVER_LEVEL_TYPE:r="ha.config.admission.control.failover.policy.label.failoverLevel";break;case t.admissionControlPolicy.FAILOVER_RESOURCES_TYPE:r="ha.config.admission.control.failover.policy.label.failoverResources";break;case t.admissionControlPolicy.FAILOVER_HOSTS_TYPE:r="ha.config.admission.control.failover.policy.label.failoverHosts";break;case t.admissionControlPolicy.DISABLED_TYPE:r="ha.config.admission.control.failover.policy.label.disabled";break;default:return""}return e.getString("ClusterUi",r)}function m(t,i){return e.getString("ClusterUi","ha.config.admission.control."+t,i)}var g=i("haAdmissionControlService"),h=1,f=32,S=100;return{getAdmissionControlModel:n,getPolicies:s,getFailoverHostsService:l,getFailoverLevelDefaultValue:d,getFixedSlotSizeCpuDefaultValue:u,getFixedSlotSizeMemoryDefaultValue:p}}angular.module("com.vmware.vsphere.client.cluster").service("haAdmissionControlService",e),e.$inject=["i18nService","haConstants","logService","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t){function i(t){return e.getString("ClusterUi",t)}function r(){return _.map(t.storageVmReaction,function(e){return{id:e,label:n[e],description:o[e]}})}var n={},o={};return n[t.storageVmReaction.DISABLED]=i("ha.config.failures.responses.ds.dswithapd.disabled"),n[t.storageVmReaction.WARNING]=i("ha.config.failures.responses.ds.dswithapd.issue.events"),n[t.storageVmReaction.RESTART_CONSERVATIVE]=i("ha.config.failures.responses.ds.dswithapd.conservative"),n[t.storageVmReaction.RESTART_AGGRESSIVE]=i("ha.config.failures.responses.ds.dswithapd.aggressive"),o[t.storageVmReaction.DISABLED]=i("ha.config.failures.responses.ds.dswithapd.disabled.desc"),o[t.storageVmReaction.WARNING]=i("ha.config.failures.responses.ds.dswithapd.issue.events.desc"),o[t.storageVmReaction.RESTART_CONSERVATIVE]=i("ha.config.failures.responses.ds.dswithapd.conservative.desc"),o[t.storageVmReaction.RESTART_AGGRESSIVE]=i("ha.config.failures.responses.ds.dswithapd.aggressive.desc"),{getResponses:r}}angular.module("com.vmware.vsphere.client.cluster").service("haApdResponseService",e),e.$inject=["i18nService","haConstants"]}(),angular.module("com.vmware.vsphere.client.cluster").constant("haConfigIssuesConstants",{hostRole:{SLAVE:"slave",MASTER:"master"},issueCategory:{INFO:"info",WARNING:"warning",ERROR:"error"},iconClass:{NONE:"vx-icon-issueStatusNone",WARNING:"vx-icon-issueStatusWarning",ERROR:"vx-icon-issueStatusError",INFO:"vx-icon-issueStatusInfo"}}),function(){"use strict";function e(e,t){function i(i){return i===t.hostRole.SLAVE?e.getString("ClusterUi","ha.config.issues.slave.role"):e.getString("ClusterUi","ha.config.issues.master.role")}function r(e){return null===e.issueCategory||null===e.issue.fullFormattedMessage?t.iconClass.NONE:e.issueCategory===t.issueCategory.ERROR?t.iconClass.ERROR:e.issueCategory===t.issueCategory.WARNING?t.iconClass.WARNING:e.issueCategory===t.issueCategory.INFO?t.iconClass.INFO:t.iconClass.NONE}return{getIssueMessageIcon:r,getHostRoleFormatted:i}}angular.module("com.vmware.vsphere.client.cluster").service("haConfigIssuesService",e),e.$inject=["i18nService","haConfigIssuesConstants"]}(),angular.module("com.vmware.vsphere.client.cluster").constant("haConstants",{SECONDS_IN_A_MINUTE:60,MAX_POST_READY_DELAY:3600,MAX_RESTART_PRIORITY_TIMEOUT:86400,MAX_FAILURE_INTERVAL:1e5,MAX_MINIMUM_UPTIME:1e5,MAX_VM_PER_RESET:1e3,MIN_RESETS_WINDOW_HRS:1,MAX_RESETS_WINDOW_HRS:1e3,MAX_VM_FAILOVER_DELAY:35791394,MIN_NUMBER_INPUT:0,admissionControlPolicy:{DISABLED_TYPE:"disabled",FAILOVER_LEVEL_TYPE:"com.vmware.vim.binding.vim.cluster.FailoverLevelAdmissionControlPolicy",FAILOVER_RESOURCES_TYPE:"com.vmware.vim.binding.vim.cluster.FailoverResourcesAdmissionControlPolicy",FAILOVER_HOSTS_TYPE:"com.vmware.vim.binding.vim.cluster.FailoverHostAdmissionControlPolicy"},slotSizePolicy:{COVER_ALL_VM:"coverAllVm",FIXED_SIZE:"fixedSize"},vmMonitoring:{DISABLED:"vmMonitoringDisabled",VM_ONLY:"vmMonitoringOnly",VM_AND_APP:"vmAndAppMonitoring"},hostMonitoringState:{ENABLED:"enabled",DISABLED:"disabled"},serviceState:{ENABLED:"enabled",DISABLED:"disabled"},restartPriority:{DISABLED:"disabled",LOWEST:"lowest",LOW:"low",MEDIUM:"medium",HIGH:"high",HIGHEST:"highest"},readyCondition:{NONE:"none",POWERED_ON:"poweredOn",APP_HEARTBEAT_DETECTED:"appHbStatusGreen",GUEST_HEARTBEAT_DETECTED:"guestHbStatusGreen"},hostIsolationResponse:{LEAVE_POWERED_ON:"none",POWER_OFF_AND_FAILOVER:"powerOff",SHUT_DOWN_AND_FAILOVER:"shutdown"},vmMonitoringSensitivity:{low:{FAILURE_INTERVAL:120,MIN_UPTIME:480,MAX_FAILURES:3,FAILURE_WINDOW:168,HAS_WINDOW:!0},medium:{FAILURE_INTERVAL:60,MIN_UPTIME:240,MAX_FAILURES:3,FAILURE_WINDOW:24,HAS_WINDOW:!0},high:{FAILURE_INTERVAL:30,MIN_UPTIME:120,MAX_FAILURES:3,FAILURE_WINDOW:1,HAS_WINDOW:!0},NO_FAILURE_WINDOW:-1},hbDatastoreCandidatePolicy:{AUTO_SELECT:"allFeasibleDs",USER_SELECTED_ONLY:"userSelectedDs",USER_SELECTED_WITH_AUTO_SELECTED:"allFeasibleDsWithUserPreference"},storageVmReaction:{DISABLED:"disabled",WARNING:"warning",RESTART_CONSERVATIVE:"restartConservative",RESTART_AGGRESSIVE:"restartAggressive"},vmReactionOnApdCleared:{NONE:"none",RESET:"reset",USE_CLUSTER_DEFAULT:"useClusterDefault"}}),function(){"use strict";function e(e,t){function i(){return{id:t.restartPriority.DISABLED,label:a("ha.config.failures.responses.host.failure.vm.restart.disabled"),description:a("ha.config.failures.responses.host.failure.vm.restart.disabled.desc")}}function r(e){var i={};return e&&(i.lowest={id:t.restartPriority.LOWEST,label:a("ha.config.vm.vmRestartPriority.lowest")}),i=angular.extend(i,{low:{id:t.restartPriority.LOW,label:a("ha.config.vm.vmRestartPriority.low")},medium:{id:t.restartPriority.MEDIUM,label:a("ha.config.vm.vmRestartPriority.medium")},high:{id:t.restartPriority.HIGH,label:a("ha.config.vm.vmRestartPriority.high")}}),e&&(i.highest={id:t.restartPriority.HIGHEST,label:a("ha.config.vm.vmRestartPriority.highest")}),i}function n(){return{none:{id:t.readyCondition.NONE,label:a("ha.config.failures.responses.host.failure.restart.readiness.none")},poweredOn:{id:t.readyCondition.POWERED_ON,label:a("ha.config.failures.responses.host.failure.restart.readiness.poweredOn")},guestHbStatusGreen:{id:t.readyCondition.GUEST_HEARTBEAT_DETECTED,label:a("ha.config.failures.responses.host.failure.restart.readiness.guestHbStatusGreen")},appHbStatusGreen:{id:t.readyCondition.APP_HEARTBEAT_DETECTED,label:a("ha.config.failures.responses.host.failure.restart.readiness.appHbStatusGreen")}}}function o(){return{none:{id:t.readyCondition.NONE,label:a("ha.config.failures.responses.host.failure.restart.readiness.none")},poweredOn:{id:t.readyCondition.POWERED_ON,label:a("ha.config.failures.responses.host.failure.restart.readiness.poweredOn")},guestHbDetected:{id:t.readyCondition.GUEST_HEARTBEAT_DETECTED,label:a("ha.config.failures.responses.host.failure.restart.readiness.guestHbStatusGreen")},appHbDetected:{id:t.readyCondition.APP_HEARTBEAT_DETECTED,label:a("ha.config.failures.responses.host.failure.restart.readiness.appHbStatusGreen")}}}function a(t){return e.getString("ClusterUi",t)}return{getDisabledOption:i,getVmRestartPriorityOptions:r,getReadyConditionOptions:o,getVmOrchestrationReadyConditions:n}}angular.module("com.vmware.vsphere.client.cluster").service("haHostFailureResponseService",e),e.$inject=["i18nService","haConstants"]}(),function(){"use strict";function e(e,t){function i(){var e=Object.keys(t.hostIsolationResponse).map(function(e){var i=t.hostIsolationResponse[e],r=n(i);return r});return e}function r(){return[{id:"EnsureFT",label:e.getString("ClusterUi","vmOverrides.haHostIsolationResponse.EnsureFT")}]}function n(e){return{id:e,label:o(e),description:a(e)}}function o(i){var r;switch(i){case t.hostIsolationResponse.LEAVE_POWERED_ON:r="ha.config.failures.responses.host.isolation.response.disabled";break;case t.hostIsolationResponse.SHUT_DOWN_AND_FAILOVER:r="ha.config.failures.responses.host.isolation.response.shutdown";break;case t.hostIsolationResponse.POWER_OFF_AND_FAILOVER:r="ha.config.failures.responses.host.isolation.response.poweroff";break;default:return""}return e.getString("ClusterUi",r)}function a(i){var r;switch(i){case t.hostIsolationResponse.LEAVE_POWERED_ON:r="ha.config.failures.responses.host.isolation.response.disabled.desc";break;case t.hostIsolationResponse.SHUT_DOWN_AND_FAILOVER:r="ha.config.failures.responses.host.isolation.response.shutdown.desc";break;case t.hostIsolationResponse.POWER_OFF_AND_FAILOVER:r="ha.config.failures.responses.host.isolation.response.poweroff.desc";break;default:return""}return e.getString("ClusterUi",r)}return{getResponses:i,getEnsureFtResponse:r}}angular.module("com.vmware.vsphere.client.cluster").service("haHostIsolationResponseService",e),e.$inject=["i18nService","haConstants"]}(),function(){"use strict";function e(e,t){function i(t){return e.getString("ClusterUi",t)}function r(){return _.map(a,function(e){return{id:e,label:n[e],description:o[e]}})}var n={},o={},a=[t.storageVmReaction.DISABLED,t.storageVmReaction.WARNING,t.storageVmReaction.RESTART_AGGRESSIVE];return n[t.storageVmReaction.DISABLED]=i("ha.config.failures.responses.ds.dswithpdl.disabled"),n[t.storageVmReaction.WARNING]=i("ha.config.failures.responses.ds.dswithpdl.issue.events"),n[t.storageVmReaction.RESTART_AGGRESSIVE]=i("ha.config.failures.responses.ds.dswithpdl.power.off"),o[t.storageVmReaction.DISABLED]=i("ha.config.failures.responses.ds.dswithpdl.disabled.desc"),o[t.storageVmReaction.WARNING]=i("ha.config.failures.responses.ds.dswithpdl.issue.events.desc"),o[t.storageVmReaction.RESTART_AGGRESSIVE]=i("ha.config.failures.responses.ds.dswithpdl.power.off.desc"),{getResponses:r}}angular.module("com.vmware.vsphere.client.cluster").service("haPdlResponseService",e),e.$inject=["i18nService","haConstants"]}(),function(){"use strict";function e(e,t){function i(e){var t=0;return t+=e.hostsDisconnectedWithUninitError,t+=e.hostsInStandByWithUninitError,t+=e.hostsInMaintenanceWithUninitError}function r(i){var r=e.createPropertyViewBuilder(),n=l(r),o=i.slotInfo||{};return n.property(t.getString("ClusterUi","ha.runtime.info.slot.size"),[t.getString("ClusterUi","ha.runtime.info.slot.mhz",o.cpuMHz),t.getString("ClusterUi","ha.runtime.info.slot.mb",o.memoryMB)]),n.property(t.getString("ClusterUi","ha.runtime.info.total.slots"),s(i.totalSlots)),n.property(t.getString("ClusterUi","ha.runtime.info.used.slots"),i.usedSlots),n.property(t.getString("ClusterUi","ha.runtime.info.unreserved.slots"),i.unreservedSlots),n.property(t.getString("ClusterUi","ha.runtime.info.failover.slots"),c(i)),n.property(t.getString("ClusterUi","ha.runtime.info.total.powered.vms"),i.totalVms),n.property(t.getString("ClusterUi","ha.runtime.info.total.hosts"),i.totalHosts),n.property(t.getString("ClusterUi","ha.runtime.info.total.good.hosts"),i.totalGoodHosts),r.build()}function n(i){var r=e.createPropertyViewBuilder(),n=l(r);if(n.property(t.getString("ClusterUi","ha.runtime.info.resources.memory.total.GB"),i.totalMemoryText),n.property(t.getString("ClusterUi","ha.runtime.info.resources.memory.reserved.percentage"),i.reservedMemoryPercentText),n.property(t.getString("ClusterUi","ha.runtime.info.resources.cpu.total.Ghz"),i.totalCpuText),n.property(t.getString("ClusterUi","ha.runtime.info.resources.cpu.reserved.percentage"),i.reservedCpuPercentText),null!==i.autoComputeStatus){var o=i.autoComputeStatus?"ha.runtime.info.resources.autocompute.flag.on":"ha.runtime.info.resources.autocompute.flag.off",a=t.getString("ClusterUi",o);n.property(t.getString("ClusterUi","ha.runtime.info.resources.autocompute.flag"),a)}return r.build()}function o(r){var n=e.createPropertyViewBuilder(),o=l(n);return o.property(t.getString("ClusterUi","ha.runtime.master.host"),r.masterName),o.property(t.getString("ClusterUi","ha.runtime.hosts.connected.to.master"),r.hostsConnectedCount),o.property(t.getString("ClusterUi","ha.runtime.hosts.not.connected.to.master"),r.hostsNotConnectedCount),o.property(t.getString("ClusterUi","ha.runtime.agent.not.reachable"),r.agentUnreachableCount),o.property(t.getString("ClusterUi","ha.runtime.config.errors"),r.configErrorCount),o.property(t.getString("ClusterUi","ha.runtime.hosts.failed"),r.hostsUnreachableCount),o.property(t.getString("ClusterUi","ha.runtime.network.isolated"),r.networkIsolatedCount),o.property(t.getString("ClusterUi","ha.runtime.network.partitioned"),r.networkPartitionedCount),o.property(t.getString("ClusterUi","ha.runtime.agent.initializing"),r.agentInitializingCount),o.property(t.getString("ClusterUi","ha.runtime.hosts.disconnected.from.vc"),r.hostsDisconnectedFromVcCount),o.property(t.getString("ClusterUi","ha.runtime.hosts.in.standby"),r.hostsInStandByCount),o.property(t.getString("ClusterUi","ha.runtime.hosts.in.maintenance"),r.hostsInMaitenanceModeCount),o.property(t.getString("ClusterUi","ha.runtime.hosts.uninitializationError"),i(r)),n.build()}function a(i){var r=e.createPropertyViewBuilder(),n=l(r);return n.property(t.getString("ClusterUi","ha.runtime.protected.vms"),i.protectedVmsCount),n.property(t.getString("ClusterUi","ha.runtime.not.protected.vms"),i.notProtectedVmCount),r.build()}function s(e){return e<0?t.getString("ClusterUi","ha.runtime.info.total.slots.na"):e}function c(e){var t=e.totalSlots-e.unreservedSlots-e.usedSlots;return t<0?0:t}function l(e){var t=e.category("").section("");return t}return{getHostsRuntimeData:o,getFailoverLevelAdvancedRuntimeData:r,getFailoverResourcesAdvancedRuntimeData:n,getVmsRuntimeData:a}}angular.module("com.vmware.vsphere.client.cluster").service("haSummaryService",e),e.$inject=["vxPropertyViewService","i18nService"]}(),function(){"use strict";function e(e,t){function i(){return _.map(_.values(t.vmMonitoring),a)}function r(e){var i=[t.vmMonitoring.DISABLED];return e!==t.vmMonitoring.DISABLED&&(i.push(t.vmMonitoring.VM_ONLY),e===t.vmMonitoring.VM_AND_APP&&i.push(t.vmMonitoring.VM_AND_APP)),_.map(i,a)}function n(e){var i=o(e);return _.isEqual(t.vmMonitoringSensitivity.low,i)?f.LOW:_.isEqual(t.vmMonitoringSensitivity.medium,i)?f.MEDIUM:_.isEqual(t.vmMonitoringSensitivity.high,i)?f.HIGH:f.CUSTOM}function o(e){return{FAILURE_INTERVAL:e.vmToolsMonitorFailureInt,MIN_UPTIME:e.vmToolsMonitorMinUpTime,MAX_FAILURES:e.vmToolsMonitorMaxFailures,FAILURE_WINDOW:e.vmToolsMonitorMaxFailureWindow,HAS_WINDOW:e.vmToolsMonitorHasFailureWindow}}function a(e){return{id:e,label:c(e),description:d(e)}}function s(e){return{id:e,label:l(e)}}function c(i){var r;switch(i){case t.vmMonitoring.DISABLED:r="HA.vm.monitoring.disabled";break;case t.vmMonitoring.VM_ONLY:r="HA.vm.monitoring.only";break;case t.vmMonitoring.VM_AND_APP:r="HA.vm.app.monitoring";break;default:return""}return e.getString("ClusterUi",r)}function l(t){var i;switch(t){case f.LOW:i="ha.config.vmResponse.vmMonitoringSensitivity.preset.low";break;case f.MEDIUM:i="ha.config.vmResponse.vmMonitoringSensitivity.preset.medium";break;case f.HIGH:i="ha.config.vmResponse.vmMonitoringSensitivity.preset.high";break;case f.CUSTOM:i="ha.config.vmResponse.vmMonitoringSensitivity.custom";break;default:return""}return e.getString("ClusterUi",i)}function d(e){return g[e]}function u(){return h}function p(){return f}function v(e){return S[e]}function m(){return _.map(_.values(f),s)}var g={};g[t.vmMonitoring.DISABLED]="",g[t.vmMonitoring.VM_ONLY]=e.getString("ClusterUi","ha.config.failures.responses.vm.monitoring.vm.monitoring.check.desc"),g[t.vmMonitoring.VM_AND_APP]=e.getString("ClusterUi","ha.config.failures.responses.vm.monitoring.app.monitoring.check.desc");var h={PRESET:0,CUSTOM:1},f={LOW:0,MEDIUM:1,HIGH:2,CUSTOM:3},S={};return S[f.LOW]={failure_interval:t.vmMonitoringSensitivity.low.FAILURE_INTERVAL,min_uptime:t.vmMonitoringSensitivity.low.MIN_UPTIME,max_failures:t.vmMonitoringSensitivity.low.MAX_FAILURES,failure_window:t.vmMonitoringSensitivity.low.FAILURE_WINDOW},S[f.MEDIUM]={failure_interval:t.vmMonitoringSensitivity.medium.FAILURE_INTERVAL,min_uptime:t.vmMonitoringSensitivity.medium.MIN_UPTIME,max_failures:t.vmMonitoringSensitivity.medium.MAX_FAILURES,failure_window:t.vmMonitoringSensitivity.medium.FAILURE_WINDOW},S[f.HIGH]={failure_interval:t.vmMonitoringSensitivity.high.FAILURE_INTERVAL,min_uptime:t.vmMonitoringSensitivity.high.MIN_UPTIME,max_failures:t.vmMonitoringSensitivity.high.MAX_FAILURES,failure_window:t.vmMonitoringSensitivity.high.FAILURE_WINDOW},{getMonitoringLevels:i,getMonitoringSensitivityLevels:m,getSensitivityLevelValues:v,getHaMonitoringSensitivityLevel:n,getSensitivityTypes:u,getPresetLevels:p,getVmOverrideMonitoringLevels:r,getLabel:c,DEFAULT_STATE:a(t.vmMonitoring.DISABLED)}}angular.module("com.vmware.vsphere.client.cluster").service("haVmMonitoringService",e),e.$inject=["i18nService","haConstants"]}(),function(){"use strict";function e(e,t){function i(t){return e.getString("ClusterUi",t)}function r(){return _.map(o,function(e){return{id:e,label:n[e]}})}var n={},o=[t.vmReactionOnApdCleared.NONE,t.vmReactionOnApdCleared.RESET];return n[t.vmReactionOnApdCleared.NONE]=i("ha.config.vmResponse.vmRemediationIfApdRecovers.doNotResetVm"),n[t.vmReactionOnApdCleared.RESET]=i("ha.config.vmResponse.vmRemediationIfApdRecovers.resetVm"),{getReactions:r}}angular.module("com.vmware.vsphere.client.cluster").service("haVmReactionsOnApdClearedService",e),e.$inject=["i18nService","haConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(e){return{selectionMode:i.grid.selectionMode.SINGLE,sortMode:i.grid.sortMode.SINGLE,sortOrder:[{field:"accessibleAndMountedHosts.length",dir:"desc"}],searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:u(e),height:"249px"}}function s(e,t){return{selectionMode:i.grid.selectionMode.NONE,sortMode:i.grid.sortMode.NONE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:p(e),height:"249px",dataBound:t}}function c(e){var t=_.map(e,function(e){return n.getVsphereObjectId({type:e.type,serverGuid:e.serverGuid,value:e.value})});return o.getPropertiesForObjects(t,["name","primaryIconId"]).then(function(e){return _.map(e,function(e,t){return{provider:n.getManagedObjectReference(t),name:e.name,iconId:e.primaryIconId}})})}function l(){var e=Object.keys(t.hbDatastoreCandidatePolicy).map(function(e){var i=t.hbDatastoreCandidatePolicy[e],r=S(i);return r});return e}function d(e){return e===t.hbDatastoreCandidatePolicy.AUTO_SELECT}function u(t){var i=[];return t&&i.push({displayName:" ",field:"isPreferred",type:"boolean",width:"27px",template:g}),i.push({displayName:e.getString("ClusterUi","datastoreNameHeaderText"),field:"name",type:"string",template:t?h:f},{displayName:e.getString("ClusterUi","datastoreClusterNameHeaderText"),field:"dsClusterData",type:"object",searchable:!1,template:t?v:m},{displayName:e.getString("ClusterUi","hostMountsCountHeaderText"),field:"accessibleAndMountedHosts.length",type:"number"}),i}function p(t){return[{displayName:e.getString("ClusterUi","hostNameHeaderText"),field:"name",type:"string",template:t?h:f}]}function v(e){return h(e.dsClusterData)}function m(e){return f(e.dsClusterData)}function g(e){var t=e.isPreferred?"checked":"";return'<input type="checkbox" class="row-checkbox" '+t+">"}function h(e){var t=e||{name:P},i=r.getColumnRenderer("icon-text");return i(["iconId","name"],t)}function f(e){var t=e||{};t.uid=n.getVsphereObjectId(t.provider),t.customLabel=P;var i=r.getColumnRenderer("object-link");return i(["uid","name",t.iconId,"customLabel"],t)}function S(e){return{id:e,label:y(e)}}function y(i){var r;switch(i){case t.hbDatastoreCandidatePolicy.AUTO_SELECT:r="ha.config.allFeasibleDs";break;case t.hbDatastoreCandidatePolicy.USER_SELECTED_ONLY:r="ha.config.userSelectedDs";break;case t.hbDatastoreCandidatePolicy.USER_SELECTED_WITH_AUTO_SELECTED:r="ha.config.allFeasibleDsWithUserPreference";break;default:return""}return e.getString("ClusterUi",r)}var P=e.getString("ClusterUi","datastoreClusterNA");return{getDatastoreGridOptions:a,getHostGridOptions:s,getDatastoreHosts:c,getCandidatePolicies:l,isAutoSelectPolicy:d}}angular.module("com.vmware.vsphere.client.cluster").service("heartbeatDatastoresService",e),e.$inject=["i18nService","haConstants","vuiConstants","columnRenderersRegistry","defaultUriSchemeUtil","dataService"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){this.$q=e,this.i18nService=t,this.columnRenderersRegistry=i,this.timeFormatterService=r,this.defaultUriSchemeUtil=n,this.datagridActionBarService=o,this.vuiConstants=a,this.drsConstants=s,this.ipParserService=c,this.getString=_.partial(this.i18nService.getString,"ClusterUi")}return e.prototype.parseHostOptionsData=function(e){var t=this,i={};if(e.dpmHostConfig&&_.each(e.dpmHostConfig,function(e){i[e.key.value]=e}),e.hosts&&e.hosts.length>0){var r=_.map(e.hosts,function(r){var n={hostRef:r.provider,name:r.name,primaryIconId:r.primaryIconId,bmcUsername:r.ipmiInfo?r.ipmiInfo.login:"",bmcIpAddr:r.ipmiInfo?r.ipmiInfo.bmcIpAddress:"",bmcMacAddr:r.ipmiInfo?r.ipmiInfo.bmcMacAddress:""};return _.extend(n,{powerManagement:t.formatPowerManagementProperty(i[r.provider.value],e.dpmEnabled,e.dpmBehavior),lteStandbyPromise:t.formatLastTimeExitProperty(r.hostStandbyInfo)}),n});return this.getDatagridData(r)}return this.$q.when([])},e.prototype.getDatagridData=function(e){return this.$q.all(_.map(e,function(e){return e.lteStandbyPromise})).then(function(t){return _.each(e,function(e,i){e.lteStandby=t[i]}),e})},e.prototype.formatLastTimeExitProperty=function(e){var t=this;if(!e)return this.$q.when(this.getString("hostOptions.lastExitStandbyNA"));var i=e.lastExitSucceeded?this.getString("hostOptions.lastExitStandbySucceeded"):this.getString("hostOptions.lastExitStandbyFailed");return this.timeFormatterService.formatDate(e.lastTimeExit).then(function(e){return t.getString("hostOptions.lastExitStandbyTimeAndResult",e,i)})},e.prototype.formatPowerManagementProperty=function(e,t,i){return e?this.getDpmBehavior(e.enabled,e.behavior):this.getString("hostOptions.dpmClusterDefault",this.getDpmBehavior(t,i))},e.prototype.getDpmBehavior=function(e,t){return e?this.getDpmBehaviorLabel(t):this.getString("hostOptions.dpmDisabled")},e.prototype.getDpmBehaviorLabel=function(e){return"manual"===e?this.getString("drs.config.dpm.automationLevel.manual"):this.getString("drs.config.dpm.automationLevel.automated")},e.prototype.getHostNameRenderer=function(e){var t=this.columnRenderersRegistry.getColumnRenderer("object-link"),i={hostName:e.name,hostId:this.getHostRef(e)},r=e.primaryIconId?e.primaryIconId:"vsphere-icon-host";return t(["hostId","hostName",r],i)},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.getString("hostOptions.hostNameHeaderText"),field:"name",template:function(t){return e.getHostNameRenderer(t)}},{displayName:this.getString("hostOptions.powerMgmtHeaderText"),field:"powerManagement"},{displayName:this.getString("hostOptions.LastExitStandbyHeaderText"),field:"lteStandby"},{displayName:this.getString("hostOptions.ipmiLoginHeaderText"),field:"bmcUsername"},{displayName:this.getString("hostOptions.ipmiIpAddressHeaderText"),field:"bmcIpAddr"},{displayName:this.getString("hostOptions.ipmiMacAddressHeaderText"),field:"bmcMacAddr"}]},e.prototype.getDatagridOptions=function(){return{actionBarOptions:{actions:[]},searchable:!1,resizable:!1,selectedItems:[],data:[],selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,columnDefs:this.getColumnDefs(),height:"100%",pageConfig:{hidePager:!0}}},e.prototype.getActionsSpec=function(e,t){var i=this;return[{actionId:"vsphere.core.cluster.actions.hostOptions.edit",getActionInvocationContext:function(){return{selectedHost:i.getHostRef(e.selectedItems[0]),clusterRef:t}},isActionAvailable:function(t){return t.available&&e.selectedItems&&e.selectedItems.length>0}}]},e.prototype.getHostRef=function(e){return this.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef)},e.prototype.createActionBar=function(e,t){var i=this.getActionsSpec(e,t);return this.datagridActionBarService.updateActionBar(e,[t],i).then(function(e){return e})},e.prototype.refreshActionBar=function(e,t,i){var r=this.getActionsSpec(e,t);i&&this.datagridActionBarService.updateActionBar(e,[t],r,i)},e.prototype.createClusterSpec=function(e){return{configSpecEx:{_type:"com.vmware.vim.binding.vim.cluster.ConfigSpecEx",dpmHostConfigSpec:e},modify:!0}},e.prototype.createDpmHostConfigSpec=function(e){var t={_type:"com.vmware.vim.binding.vim.cluster.DpmHostConfigSpec"};return t=e.powerManagementOverride?_.extend(t,{info:{_type:"com.vmware.vim.binding.vim.cluster.DpmHostConfigInfo",key:this.defaultUriSchemeUtil.getManagedObjectReference(e.hostId),behavior:e.selectedDpmBehavior?e.selectedDpmBehavior:null,enabled:e.selectedDpmBehavior!==this.drsConstants.dpmAutomationLevel.DISABLED},operation:e.defaultDpmOverride===e.powerManagementOverride?"edit":"add"}):_.extend(t,{removeKey:this.defaultUriSchemeUtil.getManagedObjectReference(e.hostId),operation:"remove"})},e.prototype.validatePowerConfigSoftwareSpec=function(e){var t=[];if(!e)return t;if(""===e.login&&""===e.password&&""===e.bmcIpAddress&&""===e.bmcMacAddress)return t;if(""===e.login||""===e.password||""===e.bmcIpAddress||""===e.bmcMacAddress){var i=this.i18nService.getString("ClusterUi","hostOptions.edit.ipmi.allParametersRequired");t.push(i)}if(""!==e.bmcIpAddress&&!this.ipParserService.isAddressValid(e.bmcIpAddress)){var r=this.i18nService.getString("ClusterUi","hostOptions.edit.ipmi.invalidIpAddress");t.push(r)}return t},e.prototype.showValidationMessages=function(e){return _.map(e,function(e){return{type:"error",text:e}})},e.prototype.setSelectedDpmBehavior=function(e,t){var i=this;if(e.dpmHostConfig){var r=_.find(e.dpmHostConfig,function(e){return i.defaultUriSchemeUtil.getVsphereObjectId(e.key)===t.hostId});r?(r.enabled?this.setDpmBehavior(t,this.createPowerManagementOverrideSelection(r)):this.setDpmBehavior(t,this.drsConstants.dpmAutomationLevel.DISABLED),t.powerManagementOverride=!0,t.defaultDpmOverride=!0):(t.powerManagementOverride=!1,t.defaultDpmOverride=!1,this.setDpmBehavior(t,this.drsConstants.dpmAutomationLevel.DISABLED))}else this.setDpmBehavior(t,this.drsConstants.dpmAutomationLevel.DISABLED)},e.prototype.setDpmBehavior=function(e,t){e.selectedDpmBehavior=t,e.defaultDpmBehavior=t},e.prototype.createPowerManagementOverrideSelection=function(e){var t=this.drsConstants.dpmAutomationLevel.MANUAL,i=this.drsConstants.dpmAutomationLevel.AUTOMATED;return e.behavior===t?t:i},e.prototype.getDpmBehaviors=function(){var e=this;return Object.keys(this.drsConstants.dpmAutomationLevel).map(function(t){return e.buildDpmBehavior(t)})},e.prototype.buildDpmBehavior=function(e){var t=!0,i=this.drsConstants.dpmAutomationLevel[e];return""===i&&(t=!1),{id:i,label:this.getDpmBehavior(t,i.toLowerCase())}},e.$inject=["$q","i18nService","columnRenderersRegistry","timeFormatterService","defaultUriSchemeUtil","datagridActionBarService","vuiConstants","drsConstants","ipParserService"],e}();e.HostOptionsService=t,angular.module("com.vmware.vsphere.client.cluster").service("hostOptionsService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e){this.i18nService=e,this.CLUSTER_MODEL_CLASS_MEMORY="com.vmware.vsphere.client.clusterui.model.monitor.reservation.ClusterMemoryCapacityData",this.HOST_MODEL_CLASS_MEMORY="com.vmware.vsphere.client.clusterui.model.monitor.reservation.HostMemoryCapacityData",this.RP_MODEL_CLASS_MEMORY="com.vmware.vsphere.client.clusterui.model.monitor.reservation.ResourcePoolMemoryCapacityData"}return e.prototype.sortReservationUsersLimit=function(e,t){var i=-1,r=0;return r=e.limit===i&&t.limit!==i?1:t.limit===i&&e.limit!==i?-1:e.limit-t.limit},e.prototype.sortSharesLevels=function(e,t){var i={"":0,low:1,normal:2,high:3,custom:4};return i[e.sharesInfo.level]-i[t.sharesInfo.level]},e.prototype.getSharesValueTextByLevel=function(e){var t={low:this.i18nService.getString("VmUi","sharesInfoLevel.low"),normal:this.i18nService.getString("VmUi","sharesInfoLevel.normal"),high:this.i18nService.getString("VmUi","sharesInfoLevel.high"),custom:this.i18nService.getString("VmUi","sharesInfoLevel.custom")};return t[e]},e.prototype.getReservationTypeByModel=function(e){return e===this.HOST_MODEL_CLASS_MEMORY||e===this.CLUSTER_MODEL_CLASS_MEMORY||e===this.RP_MODEL_CLASS_MEMORY?"memory":"cpu"},e.prototype.getMaxCapacityValue=function(e){return void 0!==e.rpReservationCapacityFormatted?e.rpReservationCapacityFormatted:e.reservationCapacityFormatted;
},e.$inject=["i18nService"],e}();e.ResourceAllocationService=t,angular.module("com.vmware.vsphere.client.cluster").service("resourceAllocationService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.mutationService=e,this.defaultUriSchemeUtil=t,this.clarityModalService=i,this.i18nService=r,this.dataService=n,this.authorizationService=o,this.$q=a}return e.prototype.showMoveCluster=function(e){var t=this;if(e&&e.length){var i="dc";this.dataService.getPropertiesForObjects(e,[i]).then(function(r){var n={title:t.i18nService.getString("ClusterUi","moveTo.title"),defaultButton:"submit",dialogData:{objectIds:e,dc:t.defaultUriSchemeUtil.getVsphereObjectId(r[e[0]][i])},contentTemplate:"cluster-ui/resources/cluster/views/move_to_cluster/moveClusterToDialog.html"};t.clarityModalService.openOkCancelModal(n)})}},e.prototype.validateMoveClusterToTarget=function(e,t){var i=this.getMoveSpec(t);return this.mutationService.validate(e,"com.vmware.vsphere.client.clusterui.MoveClusterSpec",i)},e.prototype.moveCluster=function(e,t){var i=this.getMoveSpec(t);this.mutationService.apply(e,"com.vmware.vsphere.client.clusterui.MoveClusterSpec",i)},e.prototype.getMoveSpec=function(e){var t=this,i=_.map(e,function(e){return t.defaultUriSchemeUtil.getManagedObjectReference(e)}),r={entities:i};return r},e.prototype.checkPrivileges=function(e,t){var i=[],r=e.concat([t]);return i.push(this.authorizationService.checkPrivilegesForMultipleObjects(_.uniq(r),["Host.Inventory.MoveCluster"])),this.$q.all(i).then(function(e){var i,r=[];return e.length>1?(e[0]||r.push(t),i=e[1]):i=e[0],_.each(i,function(e,t){e["Host.Inventory.MoveCluster"]||r.push(t)}),r})},e.prototype.getPrivilegesErrorMessage=function(e,t){var i;return i=_.contains(e,t)?1===e.length?this.i18nService.getString("ClusterUi","moveTo.noPermissionsOnTarget"):this.i18nService.getString("ClusterUi","moveTo.noPermissions"):this.i18nService.getString("ClusterUi","moveTo.noPermissionsOnSource")},e.$inject=["mutationService","defaultUriSchemeUtil","clarityModalService","i18nService","dataService","authorizationService","$q"],e}();e.MoveClusterToService=t,angular.module("com.vmware.vsphere.client.cluster").service("moveClusterToService",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(i,r){var n=_.map(r,function(e){return t.getManagedObjectReference(e)}),o={entities:n};e.apply(i,"com.vmware.vsphere.client.h5.rp.spec.MoveResourcePoolSpec",o)}function l(i,r){var n=_.map(r,function(e){return t.getManagedObjectReference(e)}),o={entities:n};return e.validate(i,"com.vmware.vsphere.client.h5.rp.spec.MoveResourcePoolSpec",o)}function d(e,o){var a=t.getEntityType(o),s=[];return a===n.V_APP?s.push(i.checkPrivilege(o,"VApp.AssignResourcePool")):e.push(o),s.push(i.checkPrivilegesForMultipleObjects(_.uniq(e),["Resource.MovePool"])),r.all(s).then(function(e){var t,i=[];return e.length>1?(e[0]||i.push(o),t=e[1]):t=e[0],_.each(t,function(e,t){e["Resource.MovePool"]||i.push(t)}),i})}function u(e,t){var i;return i=_.contains(e,t)?1===e.length?o.getString("RpUi","moveTo.noPermissionsOnTarget"):o.getString("RpUi","moveTo.noPermissions"):o.getString("RpUi","moveTo.noPermissionsOnSource")}function p(e,i,r){a.getProperties(e,["resourcePool"]).then(function(e){e?v(t.getVsphereObjectId(e.resourcePool),i,r):(r.modalOptions.alerts=[{type:s.validationBanner.type.ERROR,text:o.getString("RpUi","moveTo.target.error")}],r.modalOptions.isAlertClosed=!1)})}function v(e,t,i){c(e,t),i.closeModal()}function m(e){var i=t.getEntityType(e);return i===n.HOST||i===n.CLUSTER}function g(e,t,i){m(e)?p(e,t,i):v(e,t,i)}return{moveResourcePool:g,validateMoveResourcePoolToTarget:l,checkPrivileges:d,getPrivilegesErrorMessage:u}}angular.module("com.vmware.vsphere.client.cluster").service("moveResourcePoolToService",e),e.$inject=["mutationService","defaultUriSchemeUtil","authorizationService","$q","managedEntityConstants","i18nService","dataService","vuiConstants"]}();var cluster_ui;!function(e){var t=function(){function e(e,t){this.$rootScope=e,this.defaultUriSchemeUtil=t}return e.prototype.init=function(){var t=this,i=this.$rootScope.$on(e.OBJECT_DETAILS_CHANGED_EVENT,function(e,i){t.onObjectDetailsChanged(e,i)});this.$rootScope.$on("$destroy",function(){i&&i()})},e.prototype.onObjectDetailsChanged=function(t,i){var r=e.QUICKSTART_EXTENSION_ID===this.$rootScope._route.extensionId;r&&this.isEventRelevant(t,i)&&_.debounce(this.notifyQuickstartView,e.REFRESH_DELAY)()},e.prototype.isEventRelevant=function(e,t){var i=this,r=this.$rootScope._route.objectId,n=t&&_.some(t.updates,function(e){return i.isUpdateRelevant(e,r)});return n},e.prototype.isUpdateRelevant=function(t,i){var r=!!t.data&&this.defaultUriSchemeUtil.getVsphereObjectId(t.data)===i&&t.deltaProperties&&_.some(t.deltaProperties,function(t){return _.contains(e.RELEVANT_PROPERTIES,t)});return r},e.prototype.notifyQuickstartView=function(){var t=$(e.QUICKSTART_IFRAME_SELECTOR);t.length>0&&t[0].contentWindow.postMessage(e.REFRESH_QUICKSTART_MESSAGE,e.TARGET_ORIGIN)},e.QUICKSTART_EXTENSION_ID="vsphere.core.cluster.manage.settings.quickstart",e.QUICKSTART_IFRAME_SELECTOR="[vx-extension-view-id='"+e.QUICKSTART_EXTENSION_ID+"'] iframe",e.REFRESH_QUICKSTART_MESSAGE="refreshQuickstart",e.TARGET_ORIGIN="*",e.OBJECT_DETAILS_CHANGED_EVENT="object-details",e.REFRESH_DELAY=200,e.RELEVANT_PROPERTIES=["host","hciConfig.workflowState","hciConfig.configuredHosts","configurationEx.drsConfig.enabled","configurationEx.dasConfig.enabled","configurationEx.vsanConfigInfo.enabled"],e.$inject=["$rootScope","defaultUriSchemeUtil"],e}();e.QuickstartRefreshService=t,angular.module("com.vmware.vsphere.client.cluster").service("quickstartRefreshService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.mutationService=e,this.i18nService=t,this.resourceTypesConstants=i,this.$q=r}return e.prototype.validateSnapshotFile=function(e,t){return this.mutationService.validate(e,"com.vmware.vsphere.client.cluster.rp.RestoreRpTreeSpec",{rpTreeSnapshot:t})},e.prototype.applyMutationOperation=function(e,t){this.mutationService.apply(e,"com.vmware.vsphere.client.cluster.rp.RestoreRpTreeSpec",{rpTreeSnapshot:t})},e.prototype.getValidationResultType=function(e){var t=this.i18nService.getString("ClusterUi","restore.rp.tree.dialog.validation.error");switch(e){case this.resourceTypesConstants.resultValidationType.DIFFERENT_CLUSTER_ERROR:return this.i18nService.getString("ClusterUi","restore.rp.tree.dialog.different.cluster.validation.error");case this.resourceTypesConstants.resultValidationType.DRS_DISABLED_ERROR:return this.i18nService.getString("ClusterUi","restore.rp.tree.dialog.drs.disabled.validation.error");case this.resourceTypesConstants.resultValidationType.HAS_CHILD_RP_ERROR:return this.i18nService.getString("ClusterUi","restore.rp.tree.dialog.rp.present.validation.error");case this.resourceTypesConstants.resultValidationType.DESERIALIZATION_ERROR:return this.i18nService.getString("ClusterUi","restore.rp.tree.dialog.snapshot.deserialization.error");case this.resourceTypesConstants.resultValidationType.VMS_WITH_MISSING_PRIVILEGES_ERROR:return this.i18nService.getString("ClusterUi","restore.rp.tree.dialog.vm.missing.privileges.error");default:return t}},e.prototype.readFileContent=function(e){if(!e)return this.$q.when(null);var t=this.$q.defer(),i=new FileReader;return i.onload=function(){var e=i.result;t.resolve(e)},i.addEventListener("error",function(){t.resolve(null)}),i.readAsArrayBuffer(e),t.promise},e.$inject=["mutationService","i18nService","resourceTypesConstants","$q"],e}();e.RestoreResourcePoolTreeService=t,angular.module("com.vmware.vsphere.client.cluster").service("restoreResourcePoolTreeService",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(t){return e.getData(t,"com.vmware.vsphere.client.clusterui.model.ClusterDrsPortletData",{queryName:"drsPortletService."+a.name}).then(function(e){if(!e)return null;var t={};t.currentDeviation=e.currentBalance/1e3,t.targetDeviation=e.targetBalance/1e3;var o=i.getLevelByKey(e.defaultVmBehavior);return t.currentAutomationLevelText=o.label,t.currentMigrationThresholdText=r.getText(e.migrationThreshold),t.currentDpmAutomationLevelText=n.getText(e.dpmEnabled,e.defaultDpmBehavior),t.overallDrsBalanceText=s(t.currentDeviation,t.targetDeviation),t.currentDeviationForTooltip=l(t.currentDeviation),t.permittedDeviationForTooltip=c(t.targetDeviation),{data:e,viewData:t}})}function s(e,t){return d(u(e)&&u(t)?0===e?"drs.portlet.perfectlyBalancedLabel":e<t?"drs.portlet.balancedLabel":e===t?"drs.portlet.barelyBalancedLabel":"drs.portlet.imbalancedLabel":"drs.portlet.naLabel")}function c(e){if(!u(e))return d("drs.portlet.tooltip.targetDeviationNA");var i=o.format(e);return t.getString("ClusterUi","drs.portlet.tooltip.targetDeviationTextFormat",i)}function l(e){if(!u(e))return d("drs.portlet.tooltip.currentDeviationNA");var t=o.format(e);return t.toString()}function d(e){return t.getString("ClusterUi",e)}function u(e){return!("number"!=typeof e||isNaN(e)||e<0||1<e)}return{getViewData:a}}angular.module("com.vmware.vsphere.client.cluster").service("drsPortletService",e),e.$inject=["dataService","i18nService","drsAutomationLevelService","drsMigrationThresholdService","dpmAutomationLevelService","numberFormatterService"]}(),angular.module("com.vmware.vsphere.client.cluster").constant("ftConstants",{ftState:{DISABLED:"disabled",ENABLED:"enabled",NEED_SECONDARY:"needSecondary",STARTING:"starting",RUNNING:"running",PROTECTED:"protected",ENABLED_POWERED_ON:"enabledPoweredOn",ENABLED_NOT_POWERED_ON:"enabledNotPoweredOn",NOT_RUNNING:"notRunning",NOT_PROTECTED:"notProtected",NOT_CONFIGURED:"notConfigured"},powerState:{POWERED_OFF:"poweredOff",POWERED_ON:"poweredOn",SUSPENDED:"suspended"},moduleName:{FT_STATE:"ftState.",FT_STATUS:"ftStatus.",FT_STATUS_TOOLTIP:"ftStatusTooltip."},warnings:{INVALID_FT_STATE:"Unexpected FT state: ",UNEXPECTED_FT_STATE:"Invalid virtual machine fault tolerance state. "}}),function(){"use strict";function e(e){function t(t){return e.getProperties(t,["ftportlet:ftdata"])}return{requestData:t}}angular.module("com.vmware.vsphere.client.cluster").service("ftPortletService",e),e.$inject=["dataService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){function g(){w(!0);var e=o.getProperties(M,["name","createClusterConfig"]);i.all([m.is65VcOrLater(M),e]).then(function(e){T.isVc65OrLater=e[0];var t=e[1],i=t.createClusterConfig.evcModes.slice();i.unshift(A),T.supportedEvcModes=i,T.hciEnabled=!!t.createClusterConfig.hciWorkflowSupported,T.formState=h(t),w(!1)})}function h(e){var t={clusterName:e.createClusterConfig.uniqueName,currentEvcMode:A,drsEnabled:!1,haEnabled:!1,parent:O,drsAutomation:S(),haConfiguration:f(),locationIcon:b(O),locationName:_.escape(e.name)};return T.hciEnabled&&(t.vsanEnabled=!1),t}function f(){var e;return e=T.isVc65OrLater?{_type:"com.vmware.vim.binding.vim.cluster.FailoverResourcesAdmissionControlPolicy"}:{_type:"com.vmware.vim.binding.vim.cluster.FailoverLevelAdmissionControlPolicy",failoverLevel:1},{vmMonitoringState:p.DEFAULT_STATE.id,hostMonitoringEnabled:!0,admissionControlEnabled:!0,admissionControl:{policy:e}}}function S(){return{automationLevel:d.DEFAULT_LEVEL,migrationThreshold:T.drsMigrationThresholdSliderOptions.value}}function y(){return{value:u.DEFAULT,min:u.MIN,max:u.MAX,minLabel:u.MIN_LABEL,maxLabel:u.MAX_LABEL,enabled:!0,width:"auto",dragHandleTitle:I("create.vm.DRS.migration.threshold")}}function P(){T.formState.drsAutomation.migrationThreshold=parseInt(T.drsMigrationThresholdSliderOptions.value,10);var e=l.buildClusterComputeResourceSpec(T.formState,!1,T.hciEnabled);return w(!0),r.validate(M,E,e).then(function(t){C(t,e),w(!1)})["catch"](function(e){w(!1),i.reject(e)}),!1}function C(e,n){if(e&&!e.error&&e.result&&e.result.isValid!==!0)t.modalOptions.alerts=[{type:s.validationBanner.type.ERROR,text:e.result.validationMessage}],t.modalOptions.isAlertClosed=!1;else{var o=r.add(E,n);if(T.hciEnabled){var c=a.getHostedExtensions(V);i.all([o,c]).then(function(e){D(e)})}t.closeModal()}}function D(t){var i=t[0],r=t[1];if(i&&i.result&&r&&r.length>0&&r[0]&&r[0].uid){var o=n.getVsphereObjectId(i.result);e._navigateToViewAndObject(V,o)}}function w(e){t.modalOptions.submitDisabled=e,T.loading=e}function b(e){return v.getByObjectRef(e)}function I(e){return c.getString("ClusterUi",e)}var T=this,E="com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",V="vsphere.core.cluster.manage.settings.quickstart",M=t.modalOptions.dialogData.objectId,O=n.getManagedObjectReference(M);T.isVc65OrLater=!1;var A={key:null,label:I("evc.config.disableText"),description:I("create.blank")};t.modalOptions.onSubmit=P,T.formState={},T.supportedEvcModes=[],T.drsAutomationLevels=d.getLevels(),T.drsMigrationThresholdSliderOptions=y(),T.haVmMonitoringStates=p.getMonitoringLevels(),t.modalOptions.isAlertClosed=!0;var k='<div class="flex-row"><div class="flex-auto flex-column"><div>'+I("create.DRS.signpost.message.automationLevel")+"</div><div>"+I("create.DRS.signpost.message.migrationThreshold")+'</div></div><div class="flex-auto flex-column"><div>'+I("create.DRS.signpost.message.automationLevelValue")+"</div><div>"+I("create.DRS.signpost.message.migrationThresholdValue")+"</div></div></div>";T.drsSignPostParams={title:I("create.DRS.signpost.title"),message:k};var R='<div class="flex-row"><div class="flex-auto flex-column"><div>'+I("create.HA.signpost.message.hostMonitoring")+"</div><div>"+I("create.HA.signpost.message.admissionControl")+"</div><div>"+I("create.HA.signpost.message.vmMonitoring")+'</div></div><div class="flex-auto flex-column"><div>'+I("create.HA.signpost.message.hostMonitoringValue")+"</div><div>"+I("create.HA.signpost.message.admissionControlValue")+"</div><div>"+I("create.HA.signpost.message.vmMonitoringValue")+"</div></div></div>";T.haSignPostParams={title:I("create.HA.signpost.title"),message:R},g()}angular.module("com.vmware.vsphere.client.cluster").controller("CreateClusterController",e),e.$inject=["$rootScope","$scope","$q","mutationService","defaultUriSchemeUtil","dataService","extensionService","vuiConstants","i18nService","clusterSpecBuilderService","drsAutomationLevelService","drsMigrationThresholdService","haVmMonitoringService","iconService","vcService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.cluster").controller("CreateResourcePoolController",["$scope","dataService","managedEntityMutationService","i18nService","vuiConstants","mutationService","defaultUriSchemeUtil","managedEntityConstants","$q","createResourcePoolService","bytesFilter","cpuClockFilter","resourcePoolManagementService",function(e,t,i,r,n,o,a,s,c,l,d,u,p){function v(){return r.getString("RpUi","Util.Validation.ValidRange",r.getString("RpUi","RpCpu.Label.Reservation"),r.getString("RpUi","cpuValue",0),r.getString("RpUi","cpuValue",T.cpuReservationOptions.maximum.value))}function m(){return r.getString("RpUi","Util.Validation.ValidRange",r.getString("RpUi","RpMemory.Label.Reservation"),r.getString("RpUi","memValue",0),r.getString("RpUi","memValue",T.memoryReservationOptions.maximum.value))}function g(){return r.getString("RpUi","Util.Validation.ValidRange",r.getString("RpUi","settings.limit"),r.getString("RpUi","cpuValue",T.cpuLimitOptions.minimum.value),r.getString("RpUi","cpuValue",T.cpuLimitOptions.maximum.value))}function h(){return r.getString("RpUi","Util.Validation.ValidRange",r.getString("RpUi","settings.limit"),r.getString("RpUi","memValue",T.memoryLimitOptions.minimum.value),r.getString("RpUi","memValue",T.memoryLimitOptions.maximum.value))}function f(e){e.formattedValue=u(e.value,r.getString("RpUi","rpCpu.MHz"))}function S(e){e.formattedValue=e.value===-1?V:d(e.value,"MB")}function y(t){e.modalOptions.submitDisabled=t,T.loading=t}function P(t){var i=_.map(t,function(e){return{type:n.validationBanner.type.ERROR,text:e}});e.modalOptions.alerts=i}function C(){y(!0);var e;e=I.type===s.CLUSTER?t.getProperties(b,["resourcePool"]).then(function(e){return e.resourcePool}):I.type===s.HOST?t.getPropertiesByRelation(b,"host",s.COMPUTE_RESOURCE,["resourcePool"]).then(function(e){return _.values(e)[0].resourcePool}):I.type===s.RESOURCE_POOL||I.type===s.V_APP?c.when(I):c.reject(),e.then(function(e){T.spec.parent=e;var i=a.createVmomiUri(T.spec.parent.type,T.spec.parent.value,T.spec.parent.serverGuid);return t.getData(i,"com.vmware.vsphere.client.clusterui.model.ResourcePoolConfigData")}).then(function(e){return e?(M.setCpuRuntimeInfo(e.runtimeInfo.cpu),T.cpuReservationOptions=M.getCpuDropdownOptions(),M.setCpuLimitInfo(e.runtimeInfo.cpu),T.cpuLimitOptions=M.getCpuLimitOptions(),M.setMemoryRuntimeInfo(e.runtimeInfo.memory),T.memoryReservationOptions=M.getMemoryDropdownOptions(),M.setMemoryLimitInfo(e.runtimeInfo.memory),T.memoryLimitOptions=M.getMemoryLimitOptions(),_.each(T.cpuReservationOptions,f),_.each(T.cpuLimitOptions,f),_.each(T.memoryReservationOptions,S),_.each(T.memoryLimitOptions,S),void y(!1)):(y(!1),null)})["catch"](function(){T.error=!0,y(!1)})}function D(){if(!T.spec.name||/^\s*$/gi.test(T.spec.name))return P([r.getString("CommonModuleUi","NameValidator.emptyName")]),c.reject();if(e.createResourcePoolForm.$invalid||T.error)return c.reject();var t=l.createCreateResourcePoolNameSpec(T.spec.name),i=o.validate(b,"com.vmware.vsphere.client.h5.rp.CreateResourcePoolNameSpec",t).then(function(e){return e&&e.result?(P([e.result]),c.reject()):c.resolve()});return i}function w(){return!T.loading&&(e.modalOptions.alerts=[],y(!0),D().then(function(){o.add("com.vmware.vsphere.client.rp.ResourcePoolSpec",T.spec,r.getString("RpUi","actionCreateRPLabel")),y(!1),e.closeModal()})["catch"](function(e){y(!1),c.reject(e)}),!1)}var b,I,T=this,E=r.getString("RpUi","actionCreateRPDefaultName"),V=r.getString("RpUi","labelUnlimited"),M=p.createInstance();T.error=!1,T.cpuReservationOptions=M.getCpuDropdownOptions(),T.cpuUnitOptions=M.getCpuUnitOptions(),T.cpuLimitOptions=M.getCpuLimitOptions(),T.memoryReservationOptions=M.getMemoryDropdownOptions(),T.memoryUnitOptions=M.getMemoryUnitOptions(),T.memoryLimitOptions=M.getMemoryLimitOptions(),T.cpuReservationValueErrorMessages={min:v,max:v},T.memoryReservationValueErrorMessages={min:m,max:m},T.cpuLimitValueErrorMessages={min:g,max:g},T.memoryLimitValueErrorMessages={min:h,max:h},_.each(T.cpuReservationOptions,f),_.each(T.cpuLimitOptions,f),_.each(T.memoryReservationOptions,S),_.each(T.memoryLimitOptions,S),b=e.modalOptions.dialogData.objectId,I=a.getManagedObjectReference(b),T.spec=l.createDefaultResourcePoolSpec(),T.spec.name=E,e.modalOptions.onSubmit=w,C()}])}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.$scope=e,this.$q=t,this.clarityConstants=i,this.clarityModalService=r,this.clusterConstants=n,this.clusterSpecBuilderService=o,this.dataService=a,this.drsAutomationLevelService=s,this.editDrsFileDownloadService=c,this.haConstants=l,this.haVmMonitoringService=d,this.i18nService=u,this.iconService=p,this.mutationService=v,this.loading=!0}return e.prototype.$onInit=function(){var e=this;this.clusterId=this.$scope.modalOptions.dialogData.objectId,this.$scope.modalOptions.onSubmit=function(){return e.onSubmit()},this.dataService.getData(this.clusterId,"com.vmware.vsphere.client.clusterui.model.configuration.ClusterConfigData").then(function(t){t&&(e.formState=t,e.formState.locationIcon=e.getLocationIcon(e.formState.location),e.initSignpost(t))})["finally"](function(){e.setPageBusy(!1)})},e.prototype.initSignpost=function(e){var t='<div class="flex-row">\n            <div class="flex-auto flex-column">\n               <div>'+this.getString("create.DRS.signpost.message.automationLevel")+"</div>\n               <div>"+this.getString("create.DRS.signpost.message.migrationThreshold")+'</div>\n            </div>\n            <div class="flex-auto flex-column">\n               <div>'+this.drsAutomationLevelService.getLabel(e.defaultDrsBehavior)+"</div>\n               <div>"+e.migrationThreshold+"</div>\n            </div>\n         </div>";this.drsSignPostParams={title:this.getString("create.DRS.signpost.title"),message:t};var i='<div class="flex-row">\n            <div class="flex-auto flex-column">\n               <div>'+this.getString("create.HA.signpost.message.hostMonitoring")+"</div>\n               <div>"+this.getString("create.HA.signpost.message.admissionControl")+"</div>\n               <div>"+this.getString("create.HA.signpost.message.vmMonitoring")+'</div>\n            </div>\n            <div class="flex-auto flex-column">\n               <div>'+this.getHostMonitoring(e.hostMonitoring)+"</div>\n               <div>"+this.getAdmissionControl(e.admissionControlEnabled)+"</div>\n               <div>"+this.haVmMonitoringService.getLabel(e.vmMonitoring)+"</div>\n            </div>\n         </div>";this.haSignPostParams={title:this.getString("create.HA.signpost.title"),message:i}},e.prototype.onSubmit=function(){var e=this,t=this.clusterSpecBuilderService.buildClusterComputeResourceSpec(this.formState,!0);return this.setPageBusy(!0),this.mutationService.validate(this.clusterId,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",t).then(function(t){return e.onValidation(t)}).then(function(){return e.mutationService.apply(e.clusterId,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",t),t.name&&e.mutationService.apply(e.clusterId,"com.vmware.vsphere.client.mixed.ManagedEntityNameInfo",{name:t.name}),e.$q.resolve(!0)},function(){return e.$q.resolve(!1)})["finally"](function(){e.setPageBusy(!1)})},e.prototype.onValidation=function(e){var t;if(e&&(e.error||e.result&&e.result.isValid!==!0)){if(e.error){var i=e.error.localizedMessage?e.error.localizedMessage:e.error.message;return this.showValidationMessages(i),this.$q.reject()}if(e.result.errorCode===this.clusterConstants.editClusterErrorCodes.DRS_OFF_WITH_RESOURCE_POOLS)return this.editDrsFileDownloadService.showYesNoCancelDialog(this.clusterId);if(e.result.errorCode===this.clusterConstants.editClusterErrorCodes.DPM_ON_WITH_HOSTS_STANDBY)return t=this.getString("drs.config.editDrs.dpmTurningOnCaption"),this.showConfirmationDialog(t,e.result.validationMessage,e.result.validationData);var r=[e.result.validationMessage];return this.showValidationMessages(r),this.$q.reject()}return this.$q.resolve()},e.prototype.showConfirmationDialog=function(e,t,i){var r=this.$q.defer(),n=e,o=t;_.each(i,function(e){o+="\n"+e});var a={title:n,message:o,submit:function(){return r.resolve(!0)},onCancel:function(){return r.reject()},preserveNewlines:!0};return this.clarityModalService.openConfirmationModal(a),r.promise},e.prototype.showValidationMessages=function(e){var t=this,i=_.map(e,function(e){return{type:t.clarityConstants.notifications.type.ERROR,text:e}});this.$scope.modalOptions.isAlertClosed=!1,this.$scope.modalOptions.alerts=i},e.prototype.getLocationIcon=function(e){return this.iconService.getByObjectRef(e)},e.prototype.setPageBusy=function(e){this.$scope.modalOptions.submitDisabled=e,this.loading=e},e.prototype.getString=function(e){return this.i18nService.getString("ClusterUi",e)},e.prototype.getHostMonitoring=function(e){return this.getString(e===this.haConstants.hostMonitoringState.ENABLED?"ha.config.hostmonitoring.enabled":"ha.config.hostmonitoring.disabled")},e.prototype.getAdmissionControl=function(e){return this.getString(e?"ha.config.admission.control.enabled":"ha.config.admission.control.disabled")},e.$inject=["$scope","$q","clarityConstants","clarityModalService","clusterConstants","clusterSpecBuilderService","dataService","drsAutomationLevelService","editDrsFileDownloadService","haConstants","haVmMonitoringService","i18nService","iconService","mutationService"],e}();angular.module("com.vmware.vsphere.client.commonModule").controller("EditClusterController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.vscSchedulingHelper=i,this.mutationService=r,this.invalidResourcePool=!1,this.editResourcePool="cluster-ui/resources/cluster/views/edit_resource_pool/editResourcePool.html",this.SCHEDULE_TASK_SPEC="com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec",this.actionEval=this.$scope.modalOptions.actionEval,this.pageModel=this.actionEval.additionalData.schedulingData;var n=this.getResourcePoolSpec.bind(this);this.$scope.$on("stDataEvent",n)}return e.prototype.getPageValidated=function(){return this.$scope.modalOptions.submitDisabled=!0,!(this.pageModel.schedulingSpec&&this.pageModel.schedulingSpec.isFormStatusValid&&!this.invalidResourcePool)||(this.$scope.modalOptions.submitDisabled=!1,!1)},e.prototype.getResourcePoolSpec=function(e,t){this.invalidResourcePool=t.invalidResourcePool,this.resourcePoolSpec=t},e.prototype.onCommit=function(){var e=this.pageModel;e.spec=this.resourcePoolSpec.configSpec,e.spec._type=this.resourcePoolSpec._type,e.schedulingSpec.recurrence=this.vscSchedulingHelper.formatRecurrenceData(e.schedulingSpec.recurrence),this.mutationService.apply(this.resourcePoolSpec.objectId,this.SCHEDULE_TASK_SPEC,e),this.$scope.closeModal()},e.$inject=["$scope","i18nService","vscSchedulingHelper","mutationService"],e}();e.EditResourcePoolScheduledTaskDialogController=t,angular.module("com.vmware.vsphere.client.cluster").controller("EditResourcePoolScheduledTaskDialogController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.cluster").controller("EditResourcePoolController",["$scope","dataService","i18nService","mutationService","defaultUriSchemeUtil","editResourcePoolService","bytesFilter","cpuClockFilter","resourcePoolManagementService","managedEntityConstants","$q",function(e,t,i,r,n,o,a,s,c,l,d){function u(){b.loading=!0,e.modalOptions.submitDisabled=!0,t.getData(w,"com.vmware.vsphere.client.clusterui.model.ResourcePoolData").then(function(t){if(!t)return b.loading=!1,e.modalOptions.submitDisabled=!1,null;var i=e.$parent.$parent,r=i.ctrl&&i.ctrl.actionEval&&i.ctrl.actionEval.additionalData;i&&r&&r.isScheduledTask&&1===r.schedulingData.scheduleTaskOperationMode&&(t.config=r.schedulingData.spec.argument[1].value),S(t),y(t),_.each(b.cpuReservationOptions,h),_.each(b.cpuLimitOptions,h),_.each(b.memoryReservationOptions,f),_.each(b.memoryLimitOptions,f),b.loading=!1,e.modalOptions.submitDisabled=!1})["catch"](function(t){b.loading=!1,e.modalOptions.submitDisabled=!1,d.reject(t)})}function p(){return i.getString("RpUi","Util.Validation.ValidRange",i.getString("RpUi","RpCpu.Label.Reservation"),i.getString("RpUi","cpuValue",b.cpuReservationOptions.minimum.value),i.getString("RpUi","cpuValue",b.cpuReservationOptions.maximum.value))}function v(){return i.getString("RpUi","Util.Validation.ValidRange",i.getString("RpUi","settings.limit"),i.getString("RpUi","cpuValue",b.cpuLimitOptions.minimum.value),i.getString("RpUi","cpuValue",b.cpuLimitOptions.maximum.value))}function m(){return i.getString("RpUi","Util.Validation.ValidRange",i.getString("RpUi","RpMemory.Label.Reservation"),i.getString("RpUi","memValue",b.memoryReservationOptions.minimum.value),i.getString("RpUi","memValue",b.memoryReservationOptions.maximum.value))}function g(){return i.getString("RpUi","Util.Validation.ValidRange",i.getString("RpUi","settings.limit"),i.getString("RpUi","memValue",b.memoryLimitOptions.minimum.value),i.getString("RpUi","memValue",b.memoryLimitOptions.maximum.value))}function h(e){e.formattedValue=s(e.value,i.getString("RpUi","rpCpu.MHz"))}function f(e){e.formattedValue=e.value===-1?E:a(e.value,"MB")}function S(e){var t=Math.max(0,e.parentRuntime.cpu.unreservedForPool),i=Math.max(e.runtimeInfo.cpu.reservationUsed,e.config.cpuAllocation.reservation),r=i+t;e.owner.type===l.CLUSTER&&e.summary.vAppState&&e.summary.vAppState===T&&(r=Math.max(e.parentRuntime.cpu.maxUsage,i));var n=e.parentRuntime.cpu.maxUsage,o=Math.max(n,i);o=Math.max(o,e.config.cpuAllocation.limit),b.spec.configSpec.cpuAllocation.shares.shares=e.config.cpuAllocation.shares.shares,b.spec.configSpec.cpuAllocation.shares.level=e.config.cpuAllocation.shares.level,V.setCpuMaxReservation(r),b.cpuReservationUsed=e.runtimeInfo.cpu.reservationUsed,V.setCpuCurrentReservation(e.config.cpuAllocation.reservation),b.spec.configSpec.cpuAllocation.reservation=e.config.cpuAllocation.reservation,b.cpuReservationOptions=V.getCpuDropdownOptions(),V.setCpuMaxLimit(o),V.setCpuMinLimit(e.config.cpuAllocation.reservation),V.setCpuCurrentLimit(e.config.cpuAllocation.limit),b.spec.configSpec.cpuAllocation.limit=e.config.cpuAllocation.limit,b.cpuLimitOptions=V.getCpuLimitOptions(),b.spec.configSpec.cpuAllocation.expandableReservation=e.config.cpuAllocation.expandableReservation}function y(e){var t=Math.max(0,e.parentRuntime.memory.unreservedForPool/I),i=Math.max(e.runtimeInfo.memory.reservationUsed/I,e.config.memoryAllocation.reservation),r=t+i;e.owner.type===l.CLUSTER&&e.summary.vAppState&&e.summary.vAppState===T&&(r=Math.max(e.parentRuntime.memory.maxUsage/I,i));var n=e.parentRuntime.memory.maxUsage/I,o=Math.max(n,i);o=Math.max(o,e.config.memoryAllocation.limit),b.spec.configSpec.memoryAllocation.shares.shares=e.config.memoryAllocation.shares.shares,b.spec.configSpec.memoryAllocation.shares.level=e.config.memoryAllocation.shares.level,V.setMemoryMaxReservation(r),b.memoryReservationUsed=e.runtimeInfo.memory.reservationUsed/I,V.setMemoryCurrentReservation(e.config.memoryAllocation.reservation),b.spec.configSpec.memoryAllocation.reservation=e.config.memoryAllocation.reservation,b.memoryReservationOptions=V.getMemoryDropdownOptions(),V.setMemoryMaxLimit(o),V.setMemoryMinLimit(e.config.memoryAllocation.reservation),V.setMemoryCurrentLimit(e.config.memoryAllocation.limit),b.spec.configSpec.memoryAllocation.limit=e.config.memoryAllocation.limit,b.memoryLimitOptions=V.getMemoryLimitOptions(),b.spec.configSpec.memoryAllocation.expandableReservation=e.config.memoryAllocation.expandableReservation}function P(){b.spec.configSpec.cpuAllocation.limit!==-1&&b.spec.configSpec.cpuAllocation.limit<V.getCpuLimitOptions().minimum.value&&(b.spec.configSpec.cpuAllocation.limit=V.getCpuLimitOptions().minimum.value),b.spec.configSpec.memoryAllocation.limit!==-1&&b.spec.configSpec.memoryAllocation.limit<V.getMemoryLimitOptions().minimum.value&&(b.spec.configSpec.memoryAllocation.limit=V.getMemoryLimitOptions().minimum.value)}function C(){return!e.editResourcePoolForm.$invalid&&(P(),r.apply(w,"com.vmware.vsphere.client.rp.ResourcePoolSpec",b.spec),!0)}function D(){P();var t={objectId:w,_type:"com.vmware.vsphere.client.rp.ResourcePoolSpec",configSpec:b.spec,invalidResourcePool:e.editResourcePoolForm.$invalid};e.$emit("stDataEvent",t)}var w,b=this,I=1048576,T="stopped",E=i.getString("RpUi","labelUnlimited"),V=c.createInstance();b.cpuReservationOptions=V.getCpuDropdownOptions(),b.cpuUnitOptions=V.getCpuUnitOptions(),b.cpuLimitOptions=V.getCpuLimitOptions(),b.memoryReservationOptions=V.getMemoryDropdownOptions(),b.memoryUnitOptions=V.getMemoryUnitOptions(),b.memoryLimitOptions=V.getMemoryLimitOptions(),b.cpuReservationValueErrorMessages={min:p,max:p},b.cpuLimitValueErrorMessages={min:v,max:v},b.memoryReservationValueErrorMessages={min:m,max:m},b.memoryLimitValueErrorMessages={min:g,max:g},_.each(b.cpuReservationOptions,h),_.each(b.cpuLimitOptions,h),_.each(b.memoryReservationOptions,f),_.each(b.memoryLimitOptions,f),b.spec=o.editDefaultResourcePoolSpec(),w=e.modalOptions.dialogData.objectId,e.modalOptions.onSubmit=function(){return C()},u(),e.$watch(angular.bind(this,function(){e.modalOptions.actionEval&&e.modalOptions.actionEval.additionalData&&e.modalOptions.actionEval.additionalData.isScheduledTask&&D()}))}])}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l){this.$scope=e,this.dataService=t,this.i18nService=i,this.vxPropertyViewService=r,this.vuiConstants=n,this.columnRenderersRegistry=o,this.defaultUriSchemeUtil=a,
this.resourceAllocationService=s,this.$q=c,this.capacityFormatterService=l,this.gridOptions={},this.reservationType="cpu",this.objectId=e._route?e._route.objectId:null;var d=this.$scope._view.contentSpec.metadata.liveRefreshProperties;d&&(this.liveRefreshProperties=d.split(",").map(function(e){return e.trim()})),e.loadingData=!1,e.groupedMeters=[],e.maxCapacityValue="",e.reservationData={},this.reservationType=this.resourceAllocationService.getReservationTypeByModel(this.$scope._view.contentSpec.metadata.modelClass),this.reservationTitle="cpu"===this.reservationType?this.i18nService.getString("ClusterUi","resourceReservation.cpuTitle"):this.i18nService.getString("ClusterUi","resourceReservation.memoryTitle"),this.gridOptions=this.getGridOptions(),this.getData()}return e.prototype.getData=function(){var e=this;this.$scope.loadingData||(this.$scope.loadingData=!0,this.dataService.getData(this.objectId,this.$scope._view.contentSpec.metadata.modelClass).then(function(t){e.$scope.groupedMeters=e.getGroupedMeters(t),e.$scope.maxCapacityValue=e.resourceAllocationService.getMaxCapacityValue(t),e.$scope.reservationData=e.getReservationData(t),t.reservationUsers=_.map(t.reservationUsers,function(e){return e.sharesInfo||(e.sharesInfo={level:"",shares:0}),e}),e.gridOptions.data=t.reservationUsers,t&&t.resourcePool&&(e.objectsToWatchIds=[e.objectId,e.defaultUriSchemeUtil.getVsphereObjectId(t.resourcePool.provider)]),e.$scope.loadingData=!1})["catch"](function(t){e.$scope.loadingData=!1,e.$q.reject(t)}))},e.prototype.getReservationData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return void 0!==e.totalCapacityFormatted&&i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.clusterTotalCapacity")).exit().valueBuilder().text(e.totalCapacityFormatted),void 0!==e.hostTotalCapacityFormatted&&i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.hostTotalCapacity")).exit().valueBuilder().text(e.hostTotalCapacityFormatted),void 0!==e.reservationCapacityFormatted&&i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.Total")).exit().valueBuilder().text(e.reservationCapacityFormatted),void 0!==e.rpReservationCapacityFormatted&&i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.rpTotalCapacity")).exit().valueBuilder().text(e.rpReservationCapacityFormatted),void 0!==e.configuredReservationFormatted&&i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","reservation.Configured")).exit().valueBuilder().text(e.configuredReservationFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.Reserved")).icon("vx-property-view-key-legend-icon monitor-resource-reservation-grid-icon-color-light-blue").exit().valueBuilder().text(e.reservedCapacityFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.Available")).icon("vx-property-view-key-legend-icon monitor-resource-reservation-grid-icon-color-white").exit().valueBuilder().text(e.availableCapacityFormatted),void 0!==e.expandableReservation&&i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","reservationType")).exit().valueBuilder().text(e.expandableReservation?this.i18nService.getString("ClusterUi","reservationType.expandable"):this.i18nService.getString("ClusterUi","reservationType.fixed")),t.build()},e.prototype.getGroupedMeters=function(e){return[{colorClass:"monitor-resource-reservation-icon-color-light-blue",value:e.activePercentage,label:this.capacityFormatterService.format(e.reservedCapacityFormatted,this.resourceAllocationService.getMaxCapacityValue(e),e.activePercentage)},{colorClass:"monitor-resource-reservation-icon-color-light-gray",value:100-e.activePercentage,label:this.capacityFormatterService.format(e.availableCapacityFormatted,this.resourceAllocationService.getMaxCapacityValue(e),100-e.activePercentage)}]},e.prototype.getGridOptions=function(){return{searchable:!1,resizable:!0,sortOrder:[{field:"name",dir:"asc"}],data:[],selectionMode:this.vuiConstants.grid.selectionMode.NONE,columnDefs:this.getColumnDefs(),height:"100%",pageConfig:{hidePager:!0}}},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("ClusterUi","nameColumnHeader"),field:"name",type:"string",template:function(t){var i=t||{},r=e.columnRenderersRegistry.getColumnRenderer("object-name");return i.uid=e.defaultUriSchemeUtil.getVsphereObjectId(i.provider),r(["uid","primaryIconId","name","labelIds"],i)}},{displayName:this.i18nService.getString("ClusterUi","reservationColumnHeader."+this.reservationType),field:"reservation",type:"number",template:'<span title="#:reservation#">#:reservation#</span>'},{displayName:this.i18nService.getString("ClusterUi","limitColumnHeader."+this.reservationType),field:"limit",type:"number",template:function(t){var i=t||{};return i.limit!==-1?i.limit:e.i18nService.getString("ClusterUi","limit.unlimited")},sortable:this.resourceAllocationService.sortReservationUsersLimit},{displayName:this.i18nService.getString("ClusterUi","reservationTypeColumnHeader"),field:"expandableReservation",type:"boolean",template:function(t){var i=t||{};return i.expandableReservation?e.i18nService.getString("ClusterUi","reservationType.expandable"):e.i18nService.getString("ClusterUi","reservationType.fixed")}},{displayName:this.i18nService.getString("ClusterUi","storage.shareLevelColumn"),field:"sharesInfo.level",type:"string",sortable:this.resourceAllocationService.sortSharesLevels,template:function(t){var i="";if(t.sharesInfo.level){var r=t.sharesInfo.level;i=e.resourceAllocationService.getSharesValueTextByLevel(r)}return i}},{displayName:this.i18nService.getString("ClusterUi","storage.sharesValueColumn"),field:"sharesInfo.shares",type:"number",sortable:!0,template:function(e){return e.sharesInfo.shares.toString()}},{displayName:this.i18nService.getString("ClusterUi","cpuMemAllocation.sharesPercentColumn"),field:"sharesInfoValuePercentFormatted",type:"string",sortable:!0}]},e.$inject=["$scope","dataService","i18nService","vxPropertyViewService","vuiConstants","columnRenderersRegistry","defaultUriSchemeUtil","resourceAllocationService","$q","capacityFormatterService"],e}();e.MonitorResourceAllocationViewController=t,angular.module("com.vmware.vsphere.client.cluster").controller("MonitorResourceAllocationViewController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i){this.$rootScope=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.noCpuOnVms=this.getString("drs.utilization.histogram.barNoCpuUsageLabel"),this.signPostParams={}}return e.prototype.goToSelectedHostLink=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.provider);this.$rootScope._navigateToObject(t)},e.prototype.buildSignPostData=function(e){var t="cluster-ui/resources/cluster/views/monitor/drs/cpuVmBarTooltipContent.html";this.signPostParams={templateUrl:t,title:e.name,model:e,width:300}},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.$inject=["$rootScope","i18nService","defaultUriSchemeUtil"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="cluster-ui/resources/cluster/views/monitor/drs/drsCpuUtilizationComponent.html",this.bindings={data:"<"}}return e}();angular.module("com.vmware.vsphere.client.cluster").component("drsCpuUtilizationComponent",new i)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.dataService=i,this.defaultUriSchemeUtil=r,this.DRS_CLUSTER_UTILIZATION_MODEL="com.vmware.vsphere.client.clusterui.model.monitor.drs.utilization.DrsCpuClusterUtilizationData",this.cpuUtilizationData={},this.watchForObjects=[this.objectId],this.liveRefreshProperties=["configStatus","summary.currentBalance"],this.objectId=e._route.objectId,this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getData(this.objectId,this.DRS_CLUSTER_UTILIZATION_MODEL).then(function(t){e.sortVms(t),e.cpuUtilizationData=t})},e.prototype.sortVms=function(e){null!==e&&null!==e.hosts&&e.hosts.forEach(function(e){e.poweredOnVms.sort(function(e,t){return e.cpuBarWidth>t.cpuBarWidth?-1:1})})},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.$inject=["$scope","i18nService","dataService","defaultUriSchemeUtil"],e}();e.DrsCpuUtilizationController=t,angular.module("com.vmware.vsphere.client.cluster").controller("DrsCpuUtilizationController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$rootScope=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.clusterConstants=r,this.noMemoryOnVms=this.getString("drs.utilization.histogram.barNoMemoryUsageLabel"),this.signPostParams={templateUrl:"cluster-ui/resources/cluster/views/monitor/drs/memoryVmBarTooltipContent.html",width:300,height:200,direction:"up","class":"drs-utilization-info-tooltip"},this.memoryUtilizationTypes=this.clusterConstants.memoryUtilizationTypes}return e.prototype.goToSelectedHostLink=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.provider);this.$rootScope._navigateToObject(t)},e.prototype.buildSignPostData=function(e){this.signPostParams.title=e.name,this.signPostParams.model=e},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.prototype.getBarWidthForVm=function(e,t){return t===this.memoryUtilizationTypes.CONSUMED?e.consumedMemoryBarWidth:e.activeMemoryBarWidth},e.$inject=["$rootScope","i18nService","defaultUriSchemeUtil","clusterConstants"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="cluster-ui/resources/cluster/views/monitor/drs/drsMemoryUtilizationComponent.html",this.bindings={data:"<"}}return e}();angular.module("com.vmware.vsphere.client.cluster").component("drsMemoryUtilizationComponent",new i)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.$scope=e,this.i18nService=t,this.dataService=i,this.defaultUriSchemeUtil=r,this.clusterConstants=n,this.DRS_CLUSTER_UTILIZATION_MODEL="com.vmware.vsphere.client.clusterui.model.monitor.drs.utilization.DrsMemoryClusterUtilizationData",this.drsUtilizationData={},this.watchForObjects=[this.objectId],this.liveRefreshProperties=["configStatus","summary.currentBalance"],this.objectId=e._route.objectId,this.selectedMemoryUtilizationType=this.clusterConstants.memoryUtilizationTypes.ACTIVE,this.title=this.getString("drs.utilization.active.header"),this.memoryUtilizationTypes=this.getMemoryUtilizationTypes(),this.showDropdown=!1,this.getViewData(),e.$watch(function(){return o.selectedMemoryUtilizationType},function(e){e&&(o.title=_.find(o.memoryUtilizationTypes,function(t){return t.value===e}).header,o.drsUtilizationData.memoryUtilizationType=e)})}return e.prototype.getViewData=function(){var e=this;this.dataService.getData(this.objectId,this.DRS_CLUSTER_UTILIZATION_MODEL).then(function(t){t&&(e.drsUtilizationData=_.extend({memoryUtilizationType:e.selectedMemoryUtilizationType},t),e.sortVms())})},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.prototype.showDropdownEvent=function(e){this.showDropdown=!e},e.prototype.setMemoryMetric=function(e){this.selectedMemoryUtilizationType=e,this.showDropdown=!1,this.sortVms()},e.prototype.sortVms=function(){var e=this;null!==this.drsUtilizationData&&null!==this.drsUtilizationData.hosts&&this.drsUtilizationData.hosts.forEach(function(t){t.poweredOnVms.sort(function(t,i){return e.selectedMemoryUtilizationType===e.clusterConstants.memoryUtilizationTypes.ACTIVE?t.activeMemoryBarWidth>i.activeMemoryBarWidth?-1:1:t.consumedMemoryBarWidth>i.consumedMemoryBarWidth?-1:1})})},e.prototype.getMemoryUtilizationTypes=function(){var e=this.getString("drs.utilization.tooltip.active");e=e.substr(0,e.length-1);var t=this.getString("drs.utilization.tooltip.consumed");return t=t.substr(0,t.length-1),[{value:this.clusterConstants.memoryUtilizationTypes.ACTIVE,header:this.getString("drs.utilization.active.header"),selectValueLabel:e},{value:this.clusterConstants.memoryUtilizationTypes.CONSUMED,header:this.getString("drs.utilization.consumed.header"),selectValueLabel:t}]},e.$inject=["$scope","i18nService","dataService","defaultUriSchemeUtil","clusterConstants"],e}();e.DrsMemoryUtilizationController=t,angular.module("com.vmware.vsphere.client.cluster").controller("DrsMemoryUtilizationController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i){this.$rootScope=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.signPostParams={}}return e.prototype.getWidth=function(e){return Math.max(e,.5)},e.prototype.goToSelectedHostLink=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.provider);this.$rootScope._navigateToObject(t)},e.prototype.buildSignPostData=function(e,t){var i="cluster-ui/resources/cluster/views/monitor/drs/networkHostBarTooltipContent.html";e.receivedMode=t,this.signPostParams={templateUrl:i,title:e.name,model:e,width:300}},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.$inject=["$rootScope","i18nService","defaultUriSchemeUtil"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="cluster-ui/resources/cluster/views/monitor/drs/drsNetworkUtilizationComponent.html",this.bindings={data:"<",receivedMode:"<"}}return e}();angular.module("com.vmware.vsphere.client.cluster").component("drsNetworkUtilizationComponent",new i)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.dataService=t,this.contextObjectService=i,this.DRS_CLUSTER_UTILIZATION_MODEL="com.vmware.vsphere.client.clusterui.model.monitor.drs.utilization.DrsNetworkClusterUtilizationData",this.drsUtilizationData={},this.watchForObjects=[this.objectId],this.liveRefreshProperties=["configStatus","summary.currentBalance"],this.objectId=this.contextObjectService.getSelection()[0],this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getData(this.objectId,this.DRS_CLUSTER_UTILIZATION_MODEL).then(function(t){return e.drsUtilizationData=t})},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("ClusterUi",e,t)},e.$inject=["i18nService","dataService","contextObjectService"],e}();e.DrsNetworkUtilizationController=t,angular.module("com.vmware.vsphere.client.cluster").controller("DrsNetworkUtilizationController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(e){var t=[];e[0].forEach(function(e){e.details.forEach(function(i){var n=r.getFaultDetailsData(e.reason,i);n&&t.push(n)})}),s.detailsViewGridOptions.data=t}var s=this;s.detailsViewGridOptions=i.getDetailsViewGridOptions(),s.drsTroubleshootHelpId=o.DRS_FAULT_TROUBLESHOOT_GUIDE_ID,s.faultDetailsTitle=t.getString("Common","drs.faultControl.details.drsState.headerLabel"),e.$watch("masterDetailsViewContext.selectedItems",function(e){e&&e.length>0&&a(e)}),e.openHelpLink=function(e){n.showHelpPage(e)}}angular.module("com.vmware.vsphere.client.cluster").controller("FaultsDetailsViewController",e),e.$inject=["$scope","i18nService","drsFaultsViewService","drsFaultsService","helpService","clusterHelpConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){t.getProperties(l,["computedDrsFaults"]).then(function(e){s(e)})}function s(e){var t=[];e.computedDrsFaults.forEach(function(e){t.push(r.getFaultMasterData(e))}),c.masterViewGridOptions.data=t}var c=this,l=o.getRoute().objectId;c.selectedItem=null,c.watchForObjects=[l],c.liveRefreshProperties=["drsFault","summary.currentBalance"],c.getViewData=a,c.masterViewGridOptions=n.getMasterViewGridOptions(),c.faultMasterTitle=i.getString("Common","drs.faultControl.drsState.headerLabel"),a(),e.$watch(function(){return c.masterViewGridOptions.selectedItems},function(t){t&&t.length>0?(e.masterDetailsViewContext.selectedItems=[t],c.selectedItem=t[0]):void 0!==e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=[])}),e.preselectComparator=function(e){var t=!1;return c.selectedItem&&(t=e.target.text===c.selectedItem.target.text&&e.reason===c.selectedItem.reason),t}}angular.module("com.vmware.vsphere.client.cluster").controller("FaultsMasterViewController",e),e.$inject=["$scope","dataService","i18nService","drsFaultsService","drsFaultsViewService","navigation"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){t.getProperties(v,["computedActionHistory"]).then(function(e){if(e.computedActionHistory.length>0){var t=e.computedActionHistory.map(function(e){return a.formatDate(e.time).then(function(t){return e.time=t,e})});s.all(t).then(function(e){p.gridOptions.data=e})}})}function l(){var e={sortMode:r.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],columnDefs:d(),height:"100%"};return e}function d(){return[{displayName:i.getString("ClusterUi","actionHistoryList.timeColumnHeaderLabel"),field:"time",type:"string"},{displayName:i.getString("ClusterUi","actionHistoryList.drsActionColumnHeaderLabel"),field:"text",type:"string",template:u}]}function u(e){var t=e||{},r=[],a=n.getColumnRenderer("object-name");t.targetObjects.forEach(function(e){e.uid=o.getVsphereObjectId(e.provider);var t=a(["uid",null,"name","labelIds"],e);r.push(t)});var s=i.interpolate(t.text,r);return t.image&&(s='<span class="'+t.image+'"></span>'+s),s}var p=this,v=e._route.objectId;p.watchForObjects=[v],p.liveRefreshProperties=["actionHistory","summary.currentBalance"],p.getViewData=c,p.gridOptions=l(),p.historyTitle=i.getString("ClusterUi","drs.history"),c()}angular.module("com.vmware.vsphere.client.cluster").controller("HistoryController",e),e.$inject=["$scope","dataService","i18nService","vuiConstants","columnRenderersRegistry","defaultUriSchemeUtil","timeFormatterService","$q"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d){var u=this;this.$scope=e,this.dataService=t,this.i18nService=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.defaultUriSchemeUtil=o,this.mutationService=a,this.drsConstants=s,this.clarityModalService=c,this.drsRecommendationsService=l,this.actionsService=d,this.actionSpecs=["vsphere.core.cluster.actions.drs.refreshRecommendationsAction","vsphere.core.cluster.actions.drs.applyRecommendationsAction"],this.overrideRecommendations=!1,this.isRefreshButtonDisabled=!0,this.isApplyButtonDisabled=!0,this.objectId=e._route.objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=["recommendation","summary.currentBalance"],this.recommendationsTitle=i.getString("ClusterUi","RecommendationsList.drsRecommendationsLabel"),this.gridOptions=this.getGridOptions(),this.getViewData(),this.isRecommendationChecked=function(e){return u.recommendationStore.isRecommendationChecked(e)},this.actionsService.getActions(this.objectId,this.actionSpecs).then(function(e){_.each(e,function(e){e.action.uid===u.actionSpecs[0]&&e.available&&(u.isRefreshButtonDisabled=!1),e.action.uid===u.actionSpecs[1]&&e.available&&(u.isApplyButtonDisabled=!1)})})}return e.prototype.getViewData=function(){var e=this;this.dataService.getData(this.objectId,"com.vmware.vsphere.client.clusterui.model.monitor.DrsRecommendationsData").then(function(t){e.gridOptions.data=t.recommendations;var i=_.map(t.recommendations,function(e){return e.recommendationData}),r=e.drsRecommendationsService.createRecommendationsStore(i),n=r.getRecommendationKeys();if(e.recommendationStore){var o=e.recommendationStore.getRecommendationKeys(),a=!e.arrayEq(n.sort(),o.sort());a&&(e.recommendationStore=r)}else e.recommendationStore=r})},e.prototype.runDrs=function(){var e={};this.mutationService.apply(this.objectId,"com.vmware.vsphere.client.clusterui.RefreshClusterRecommendationsSpec",e)},e.prototype.applyRecommendations=function(){if(this.recommendationStore){var e=this.recommendationStore.getRecommendationsToApply(),t={operation:this.drsConstants.clusterRecommendationSpecOperation.APPLY,keys:e};this.mutationService.apply(this.objectId,"com.vmware.vsphere.client.cluster.services.recommendations.ClusterRecommendationSpec",t)}},e.prototype.onRecommendationCheckboxClick=function(e){var t=this.recommendationStore.isRecommendationChecked(e);t?this.recommendationStore.uncheckRecommendation(e)&&(this.$scope.modalOptions=this.getUncheckedDependantRecommendationsModalOptions(),this.clarityModalService.openPopUp(this.$scope)):this.recommendationStore.checkRecommendation(e)&&(this.$scope.modalOptions=this.getCheckedPrerequisiteRecommendationsModalOptions(),this.clarityModalService.openPopUp(this.$scope))},e.prototype.arrayEq=function(e,t){return e.length===t.length&&e.every(function(e,i){return e===t[i]})},e.prototype.getGridOptions=function(){return{sortMode:this.vuiConstants.grid.sortMode.NONE,searchable:!1,resizable:!0,data:[],columnDefs:this.getColumnDefs(),height:"100%"}},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("ClusterUi","RecommendationsList.applyColumnHeaderText"),field:"recommendationsText",type:"string",width:"100px",template:this.checkboxColumnTemplate.bind(this)},{displayName:this.i18nService.getString("ClusterUi","RecommendationsList.priorityColumnHeaderText"),field:"recommendationData.priorityRating",type:"string",width:"100px",template:"#:recommendationData.priorityRating#"},{displayName:this.i18nService.getString("ClusterUi","RecommendationsList.recommendationColumnHeaderText"),field:"recommendationText",type:"string",template:this.recommendationTextRenderer.bind(this)},{displayName:this.i18nService.getString("ClusterUi","RecommendationsList.reasonColumnHeaderText"),field:"recommendationData.parentRecommendation.reasonText",type:"string",template:'<span title="#:recommendationData.parentRecommendation.reasonText#">#:recommendationData.parentRecommendation.reasonText#</span>'}]},e.prototype.recommendationTextRenderer=function(e){var t=this,i=[],r=this.columnRenderersRegistry.getColumnRenderer("object-name");e.targets.forEach(function(e){e.uid=t.defaultUriSchemeUtil.getVsphereObjectId(e.provider);var n=r(["uid",null,"name","labelIds"],e);i.push(n)});var n=this.i18nService.interpolate(e.recommendationText,i);return e.image&&(n='<span class="'+e.image+'"></span>'+n),n},e.prototype.checkboxColumnTemplate=function(e){if(!e.recommendationData.isFirst)return"";var t=e.recommendationData.parentRecommendation.key,i=["<div class='centered-content-container'>","<input type='checkbox' ","ng-disabled='!$parent.$parent.ctrl.overrideRecommendations' ","ng-checked='$parent.$parent.ctrl.isRecommendationChecked(",t,")' ","ng-click='$parent.$parent.ctrl.onRecommendationCheckboxClick(",t,")' >","</div>"].join("");return i},e.prototype.getCheckedPrerequisiteRecommendationsModalOptions=function(){return{title:this.i18nService.getString("ClusterUi","prerequisite.recommendations.selected.title"),contentUrl:"cluster-ui/resources/cluster/views/monitor/drs/checkedPrerequisiteRecommendationsModal.html"}},e.prototype.getUncheckedDependantRecommendationsModalOptions=function(){return{title:this.i18nService.getString("ClusterUi","dependent.recommendations.unselected.title"),contentUrl:"cluster-ui/resources/cluster/views/monitor/drs/uncheckedDependantRecommendationsModal.html"}},e.$inject=["$scope","dataService","i18nService","vuiConstants","columnRenderersRegistry","defaultUriSchemeUtil","mutationService","drsConstants","clarityModalService","drsRecommendationsService","actionsService"],e}();e.RecommendationsController=t,angular.module("com.vmware.vsphere.client.cluster").controller("RecommendationsController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){t.getProperties(v,["haConfigIssues"]).then(function(e){e&&e.haConfigIssues&&(_.each(e.haConfigIssues,function(e){e.hostRoleFormatted=o.getHostRoleFormatted(e.hostRole),e.messageIcon=o.getIssueMessageIcon(e)}),p.datagridOptions.data=e.haConfigIssues)})}function c(){return{selectionMode:r.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:l(),height:"100%"}}function l(){return[{displayName:i.getString("ClusterUi","ha.config.issues.grid.entity.header"),field:"entityName",type:"string",width:"35%",template:d},{displayName:i.getString("ClusterUi","ha.config.issues.grid.role.header"),field:"hostRoleFormatted",type:"string",width:"10%",template:"#:hostRoleFormatted#"},{displayName:i.getString("ClusterUi","ha.config.issues.grid.issue.description.header"),field:"issue.fullFormattedMessage",type:"string",width:"55%",template:u}]}function d(e){var t=n.getColumnRenderer("object-link");e&&_.extend(e,{entityId:a.getVsphereObjectId({_type:"com.vmware.vim.binding.vmodl.ManagedObjectReference",value:e.entity.value,type:e.entity.type,serverGuid:e.entity.serverGuid})});var i=t(["entityId","entityName",e.entityIcon],e||{});return i}function u(e){var t=e&&e.messageIcon?e.messageIcon:"",i=e&&e.issue.fullFormattedMessage?e.issue.fullFormattedMessage:"",r='<i class="'+t+'"></i>';return'<span title="'+i+'">'+r+i+"</span>"}var p=this,v=e._route?e._route.objectId:null;p.watchForObjects=[v],p.liveRefreshProperties=["configIssue","configStatus","name"],p.datagridOptions=c(),p.getViewData=s,s()}angular.module("com.vmware.vsphere.client.cluster").controller("ConfigIssuesViewController",e),e.$inject=["$scope","dataService","i18nService","vuiConstants","columnRenderersRegistry","haConfigIssuesService","defaultUriSchemeUtil"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.dataService=t,this.datastoresUnderApdPdlService=i,this.navigation=r,this.INACCESSIBLE_DATASTORE_INFO_PROPERTY="inaccessibleDatastoreInfo",this.objectId=this.navigation.getRoute().objectId,this.gridOptions=this.datastoresUnderApdPdlService.getGridOptions(),this.getData()}return e.prototype.getData=function(){var e=this;this.dataService.getProperties(this.objectId,[this.INACCESSIBLE_DATASTORE_INFO_PROPERTY]).then(function(t){var i=t&&t.inaccessibleDatastoreInfo?t.inaccessibleDatastoreInfo:[];e.gridOptions.data=i})},e.$inject=["$scope","dataService","datastoresUnderApdPdlService","navigation"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("DatastoresUnderApdPdlController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.haSummaryService=i,this.$q=r,this.portletData=[],this.loadingData=!1,this.objectId=this.$scope._route.objectId,this.portletData=[],this.$scope.$on("haSummaryPortletsRefresh",function(){n.getData()}),this.getData()}return e.prototype.getData=function(){var e=this;if(!this.loadingData)return this.loadingData=!0,this.dataService.getProperties(this.objectId,["dasAdvancedRuntimeInfo"]).then(function(t){t&&t.dasAdvancedRuntimeInfo&&(e.portletData=e.haSummaryService.getFailoverLevelAdvancedRuntimeData(t.dasAdvancedRuntimeInfo)),e.loadingData=!1})["catch"](function(t){e.loadingData=!1,e.$q.reject(t)})},e.$inject=["$scope","dataService","haSummaryService","$q"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("HaAdvancedRuntimeInfoController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.haSummaryService=i,this.$q=r,this.loadingData=!1,this.objectId=this.$scope._route.objectId,this.propertyViewData=[],this.$scope.$on("haSummaryPortletsRefresh",function(){n.getData()}),this.getData()}return e.prototype.getData=function(){var e=this;if(!this.loadingData)return this.loadingData=!0,this.dataService.getData(this.objectId,"com.vmware.vsphere.client.clusterui.model.services.HaFailoverResourceRuntimeInfoData").then(function(t){e.propertyViewData=e.haSummaryService.getFailoverResourcesAdvancedRuntimeData(t),e.loadingData=!1})["catch"](function(t){e.loadingData=!1,e.$q.reject(t)})},e.$inject=["$scope","dataService","haSummaryService","$q"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("HaResourcesAdvancedRuntimeInfoController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r){function n(){a().then(function(e){o(e)})}function o(t){var i=r.createPortlets(t,l);e.portletOptions.portlets=r.updatePortlets(i,e.portletOptions.portlets)}function a(){return i.getHostedExtensions(e._view.$id,l)}function s(){e.$broadcast("haSummaryPortletsRefresh")}function c(){return r.createPortlets(e._view.children,l)}var l=e._route?e._route.objectId:null;this.watchForObjects=[l],this.liveRefreshProperties=["configStatus"],e.refreshPortlets=n,e.refreshPortletsData=s,e.portletOptions={layout:t.portlets.layout.TWO_COLUMNS,portlets:c()}}angular.module("com.vmware.vsphere.client.cluster").controller("haSummaryViewController",e),e.$inject=["$scope","vuiConstants","extensionService","summaryService"]}(),function(){"use strict";function e(e,t,i){function r(){t.getData(a,n).then(function(e){o.hbDatastoreCandidates=e.heartbeatDatastores})}var n="com.vmware.vsphere.client.clusterui.model.services.ClusterHaData",o=this,a=e._route?e._route.objectId:null;o.liveRefreshProperties=["configurationEx.dasConfig.heartbeatDatastore","summary.dasData"],o.watchForObjects=[a],o.hbDatastoreCandidates=[],o.datastoresGridLabel=i.getString("ClusterUi","ha.runtime.selected.heartbeat.datastores"),o.getViewData=r,r()}angular.module("com.vmware.vsphere.client.cluster").controller("HeartbeatViewController",e),e.$inject=["$scope","dataService","i18nService"]}(),function(){"use strict";function e(e,t,i,r){function n(){if(!e.loadingData)return e.loadingData=!0,t.getProperties(o,["hostHaRuntimeInfo"]).then(function(t){t&&t.hostHaRuntimeInfo&&(e.portletData=i.getHostsRuntimeData(t.hostHaRuntimeInfo)),e.loadingData=!1})["catch"](function(t){e.loadingData=!1,r.reject(t)})}var o=e._route?e._route.objectId:null;e.loadingData=!1,e.$on("haSummaryPortletsRefresh",n),n()}angular.module("com.vmware.vsphere.client.cluster").controller("HostRuntimeInfoController",e),e.$inject=["$scope","dataService","haSummaryService","$q"]}(),function(){"use strict";function e(e,t,i,r){function n(){if(!e.loadingData)return e.loadingData=!0,t.getProperties(o,["vmHaRuntimeInfo"]).then(function(t){t&&t.vmHaRuntimeInfo&&(e.portletData=i.getVmsRuntimeData(t.vmHaRuntimeInfo)),e.loadingData=!1})["catch"](function(t){e.loadingData=!1,r.reject(t)})}var o=e._route?e._route.objectId:null;e.loadingData=!1,e.$on("haSummaryPortletsRefresh",n),n()}angular.module("com.vmware.vsphere.client.cluster").controller("VmsRuntimeInfoController",e),e.$inject=["$scope","dataService","haSummaryService","$q"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){this.$scope=e,this.dataService=t,this.i18nService=i,this.vxPropertyViewService=r,this.columnRenderersRegistry=n,this.vuiConstants=o,this.defaultUriSchemeUtil=a,this.$q=s,this.capacityFormatterService=c,this.objectId=e._route?e._route.objectId:null;var l=this.$scope._view.contentSpec.metadata.liveRefreshProperties;l&&(this.liveRefreshProperties=l.split(",").map(function(e){return e.trim()})),e.loadingData=!1,e.groupedMeters=[],e.maxCapacityValue="",e.reservationData={},this.gridOptions=this.getGridOptions(),this.getData()}return e.prototype.getData=function(){var e=this;this.$scope.loadingData||(this.$scope.loadingData=!0,this.dataService.getData(this.objectId,this.$scope._view.contentSpec.metadata.modelClass).then(function(t){
e.$scope.groupedMeters=e.getGroupedMeters(t),e.$scope.maxCapacityValue=t.totalCapacityFormatted,e.$scope.reservationData=e.getReservationData(t),e.gridOptions.data=t.virtualDisks,e.$scope.loadingData=!1})["catch"](function(t){e.$scope.loadingData=!1,e.$q.reject(t)}))},e.prototype.getReservationData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","storage.totalCapacity")).exit().valueBuilder().text(e.totalCapacityFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.Reserved")).icon("vx-property-view-key-legend-icon monitor-resource-reservation-grid-icon-color-light-blue").exit().valueBuilder().text(e.usedSpaceFormatted),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("ClusterUi","capacity.availableCapacity")).icon("vx-property-view-key-legend-icon monitor-resource-reservation-grid-icon-color-white").exit().valueBuilder().text(e.freeSpaceFormatted),t.build()},e.prototype.getGroupedMeters=function(e){return[{colorClass:"monitor-resource-reservation-icon-color-light-blue",value:e.storagePercentage,label:this.capacityFormatterService.format(e.usedSpaceFormatted,e.totalCapacityFormatted,e.storagePercentage)},{colorClass:"monitor-resource-reservation-icon-color-light-gray",value:100-e.storagePercentage,label:this.capacityFormatterService.format(e.freeSpaceFormatted,e.totalCapacityFormatted,100-e.storagePercentage)}]},e.prototype.getGridOptions=function(){return{searchable:!0,resizable:!1,sortOrder:[{field:"name",dir:"asc"}],data:[],selectionMode:this.vuiConstants.grid.selectionMode.NONE,columnDefs:this.getColumnDefs(),height:"100%",pageConfig:{hidePager:!0}}},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("ClusterUi","nameColumnHeader"),field:"vmName",type:"string",template:function(t){var i=t||{},r=e.columnRenderersRegistry.getColumnRenderer("object-name");return i.uid=e.defaultUriSchemeUtil.getVsphereObjectId(i.vm),r(["uid","vmPrimaryIcon","vmName"],i)}},{displayName:this.i18nService.getString("ClusterUi","storage.diskColumn"),field:"label",type:"string",template:'<span title="#:label#">#:label#</span>'},{displayName:this.i18nService.getString("ClusterUi","storage.datastoreColumn"),field:"datastoreName",type:"string",template:'<span title="#:datastoreName#">#:datastoreName#</span>'},{displayName:this.i18nService.getString("ClusterUi","storage.limitColumn"),field:"limit",type:"number",template:function(t){var i=t||{};return i.limit!==-1?i.limit:e.i18nService.getString("ClusterUi","limit.unlimited")}},{displayName:this.i18nService.getString("ClusterUi","storage.shareLevelColumn"),field:"shareLevel",type:"string",template:'<span title="#:shareLevel#">#:shareLevel#</span>'},{displayName:this.i18nService.getString("ClusterUi","storage.sharesValueColumn"),field:"shares",type:"string",template:'<span title="#:shares#">#:shares#</span>'},{displayName:this.i18nService.getString("ClusterUi","storage.dsPercentSharesValueColumn"),field:"datastoreSharesPercentage",type:"string",template:'<span title="#:datastoreSharesPercentage#">#:datastoreSharesPercentage#</span>',sortable:function(e,t){return parseInt(e.datastoreSharesPercentage)-parseInt(t.datastoreSharesPercentage)}}]},e.$inject=["$scope","dataService","i18nService","vxPropertyViewService","columnRenderersRegistry","vuiConstants","defaultUriSchemeUtil","$q","capacityFormatterService"],e}();e.MonitorStorageResourceReservationViewController=t,angular.module("com.vmware.vsphere.client.cluster").controller("MonitorStorageResourceReservationViewController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.clusterUtilizationService=i,this.$controller=r,this.meters=[],this.maxCapacityValue="",this.resourcesData={},angular.extend(this,r("GenericPortletController",{$scope:e})),e.$watch("data",function(e){e&&(n.meters=n.clusterUtilizationService.getCpuMetersData(e),n.maxCapacityValue=e.cpuCapacityFormatted,n.resourcesData=n.clusterUtilizationService.buildCpuPropertyViewData(e))})}return e.$inject=["$scope","dataService","clusterUtilizationService","$controller"],e}();e.ClusterCpuUtilizationPortletController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterCpuUtilizationPortletController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.clusterUtilizationService=i,this.$controller=r,this.meters=[],this.groupedMeters=[],this.maxCapacityValue="",this.resourcesData={},angular.extend(this,r("GenericPortletController",{$scope:e})),e.$watch("data",function(e){e&&(n.meters=n.clusterUtilizationService.getGuestMemoryMetersData(e),n.maxCapacityValue=e.guestMemorySizeFormatted,n.resourcesData=n.clusterUtilizationService.buildGuestMemoryPropertyViewData(e),n.groupedMeters=n.clusterUtilizationService.getGuestMemoryGroupedMetersData(e))})}return e.$inject=["$scope","dataService","clusterUtilizationService","$controller"],e}();e.ClusterGuestMemoryUtilizationPortletController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterGuestMemoryUtilizationPortletController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.clusterUtilizationService=i,this.$controller=r,this.meters=[],this.maxCapacityValue="",this.resourcesData={},angular.extend(this,r("GenericPortletController",{$scope:e})),e.$watch("data",function(e){e&&(n.meters=n.clusterUtilizationService.getMemoryMetersData(e),n.maxCapacityValue=e.memoryCapacityFormatted,n.resourcesData=n.clusterUtilizationService.buildMemoryPropertyViewData(e))})}return e.$inject=["$scope","dataService","clusterUtilizationService","$controller"],e}();e.ClusterMemoryUtilizationPortletController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterMemoryUtilizationPortletController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.clusterUtilizationService=i,this.$controller=r,this.meters=[],this.pointers=[],this.maxCapacityValue="",this.resourcesData={},angular.extend(this,r("GenericPortletController",{$scope:e})),e.$watch("data",function(e){e&&(n.meters=n.clusterUtilizationService.getCpuMetersData(e),n.maxCapacityValue=e.maxValue,n.resourcesData=n.clusterUtilizationService.buildResourcePoolCpuPropertyViewData(e),n.pointers=n.clusterUtilizationService.getUtilizationPointersData(e))})}return e.$inject=["$scope","dataService","clusterUtilizationService","$controller"],e}();e.ClusterResourcePoolCpuUtilizationPortletController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterResourcePoolCpuUtilizationPortletController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.clusterUtilizationService=i,this.$controller=r,this.meters=[],this.pointers=[],this.maxCapacityValue="",this.resourcesData={},angular.extend(this,r("GenericPortletController",{$scope:e})),e.$watch("data",function(e){e&&(n.meters=n.clusterUtilizationService.getMemoryConsumedMetersData(e),n.maxCapacityValue=e.maxValue,n.resourcesData=n.clusterUtilizationService.buildResourcePoolMemoryPropertyViewData(e),n.pointers=n.clusterUtilizationService.getUtilizationPointersData(e))})}return e.$inject=["$scope","dataService","clusterUtilizationService","$controller"],e}();e.ClusterResourcePoolMemoryUtilizationPortletController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterResourcePoolMemoryUtilizationPortletController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.vuiConstants=t,this.extensionService=i,this.summaryService=r,this.objectId=e._route?e._route.objectId:null,this.headerOptions={title:"",objectId:this.objectId,actions:[]},this.watchForObjects=[this.objectId],e.portletOptions={layout:t.portlets.layout.TWO_COLUMNS,portlets:this.getSummaryPortletViews()}}return e.prototype.refreshPortlets=function(){var e=this;this.updateExistingPortlets(this.$scope._view.children),this.requestViewExtensions().then(function(t){e.updateExistingPortlets(t)})},e.prototype.updateExistingPortlets=function(e){var t=this.summaryService.createPortlets(e,this.objectId);this.$scope.portletOptions.portlets=this.summaryService.updatePortlets(t,this.$scope.portletOptions.portlets)},e.prototype.requestViewExtensions=function(){return this.extensionService.getHostedExtensions(this.$scope._view.$id,this.objectId)},e.prototype.getSummaryPortletViews=function(){return this.summaryService.createPortlets(this.$scope._view.children,this.objectId)},e.$inject=["$scope","vuiConstants","extensionService","summaryService"],e}();e.ClusterUtilizationViewController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterUtilizationViewController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.dataService=t,this.clusterUtilizationService=i,this.$controller=r,this.meters=[],this.pointers=[],this.maxCapacityValue="",this.resourcesData={},angular.extend(this,r("GenericPortletController",{$scope:e})),e.$watch("data",function(e){e&&(n.meters=n.clusterUtilizationService.getMemoryConsumedMetersData(e),n.maxCapacityValue=e.maxValue,n.resourcesData=n.clusterUtilizationService.buildVmMemoryPropertyViewData(e),n.pointers=n.clusterUtilizationService.getUtilizationPointersData(e))})}return e.$inject=["$scope","dataService","clusterUtilizationService","$controller"],e}();e.ClusterVmMemoryUtilizationPortletController=t,angular.module("com.vmware.vsphere.client.cluster").controller("ClusterVmMemoryUtilizationPortletController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.vuiConstants=t,this.i18nService=i,this.moveClusterToService=r,this.dataService=n,this.defaultUriSchemeUtil=o,this.loading=!1,this.clusterIds=e.modalOptions.dialogData.objectIds,this.dc=e.modalOptions.dialogData.dc,this.onLocationSelected=function(e){a.entityToMoveClusterTo=e},e.modalOptions.onSubmit=function(){e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,a.moveClusterToService.validateMoveClusterToTarget(a.entityToMoveClusterTo,a.clusterIds).then(function(e){e.result?(a.moveClusterToService.checkPrivileges(a.clusterIds,a.entityToMoveClusterTo).then(function(e){e&&0!==e.length?(a.$scope.modalOptions.alerts=[{type:a.vuiConstants.validationBanner.type.ERROR,text:a.moveClusterToService.getPrivilegesErrorMessage(e,a.entityToMoveClusterTo)}],a.$scope.modalOptions.isAlertClosed=!1):a.moveClusterToService.moveCluster(a.entityToMoveClusterTo,a.clusterIds)}),a.$scope.closeModal()):(a.$scope.modalOptions.alerts=[{type:a.vuiConstants.validationBanner.type.ERROR,text:a.i18nService.getString("ClusterUi","moveTo.targetNestedValidationError")}],a.$scope.modalOptions.isAlertClosed=!1)})}}return e.$inject=["$scope","vuiConstants","i18nService","moveClusterToService","dataService","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("moveClusterToDialogController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$scope=e,this.defaultUriSchemeUtil=t,this.dataService=i,this.vuiConstants=r,this.i18nService=n,this.moveResourcePoolToService=o,this.managedEntityConstants=a,this.loading=!0,this.rpIds=e.modalOptions.dialogData.objectIds,_.isEmpty(this.rpIds)||(this.rootObjId=this.rpIds[0]),e.modalOptions.onSubmit=function(){e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,_.contains(s.rpIds,s.entityToMoveRpTo)?(s.$scope.modalOptions.alerts=[{type:s.vuiConstants.validationBanner.type.ERROR,text:s.i18nService.getString("Common","moveTo.targetValidationError")}],s.$scope.modalOptions.isAlertClosed=!1):s.moveResourcePoolToService.validateMoveResourcePoolToTarget(s.entityToMoveRpTo,s.rpIds).then(function(e){e.result?s.moveResourcePoolToService.checkPrivileges(s.sourcesIds,s.entityToMoveRpTo).then(function(e){e&&0!==e.length?(s.$scope.modalOptions.alerts=[{type:s.vuiConstants.validationBanner.type.ERROR,text:s.moveResourcePoolToService.getPrivilegesErrorMessage(e,s.entityToMoveRpTo)}],s.$scope.modalOptions.isAlertClosed=!1):s.moveResourcePoolToService.moveResourcePool(s.entityToMoveRpTo,s.rpIds,s.$scope)}):(s.$scope.modalOptions.alerts=[{type:s.vuiConstants.validationBanner.type.ERROR,text:s.i18nService.getString("Common","moveTo.targetNestedValidationError")}],s.$scope.modalOptions.isAlertClosed=!1)})},this.onLocationSelected=function(e){s.entityToMoveRpTo=e},this.getData()}return e.prototype.getData=function(){var e=this;this.dataService.getPropertiesForObjects(this.rpIds,["parent","cluster"]).then(function(t){t&&(e.isMoveActionUnderCluster=!!t[e.rpIds[0]].cluster,e.sourcesIds=_.map(e.rpIds,function(i){return e.defaultUriSchemeUtil.getVsphereObjectId(t[i].parent)}),(i=e.sourcesIds).push.apply(i,e.rpIds)),e.loading=!1;var i})},e.$inject=["$scope","defaultUriSchemeUtil","dataService","vuiConstants","i18nService","moveResourcePoolToService","managedEntityConstants"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("moveResourcePoolToDialogController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$scope=e,this.$element=t,this.mutationService=i,this.restoreResourcePoolTreeService=r,this.clarityConstants=n,this.i18nService=o,this.resourceTypesConstants=a,this.objectId=this.$scope.modalOptions.objectId,this.fileInput=t.find("input[type='file']"),this.fileInput.on("change",this.onFileInputChange.bind(this)),this.$scope.modalOptions.alerts=[],this.$scope.modalOptions.isAlertClosed=!0,this.$scope.modalOptions.onSubmit=function(){return s.onSubmit()}}return e.prototype.onFileInputChange=function(e){e.target.files&&e.target.files.length&&this.setFileToUpload(e.target.files[0])},e.prototype.setFileToUpload=function(e){this.file=e},e.prototype.onSubmit=function(){var e=this;this.$scope.modalOptions.alerts=[],this.$scope.modalOptions.isAlertClosed=!0,this.restoreResourcePoolTreeService.readFileContent(this.file).then(function(t){var i=new Int8Array(t),r=Array.prototype.slice.call(i);e.restoreResourcePoolTreeService.validateSnapshotFile(e.objectId,r).then(function(t){if(t.result.validationResultType!==e.resourceTypesConstants.resultValidationType.SUCCESS){var i=e.restoreResourcePoolTreeService.getValidationResultType(t.result.validationResultType);e.$scope.modalOptions.alerts=[{text:i,type:e.clarityConstants.notifications.type.ERROR}],e.$scope.modalOptions.isAlertClosed=!1}else e.restoreResourcePoolTreeService.applyMutationOperation(e.objectId,r),e.$scope.closeModal()})})},e.$inject=["$scope","$element","mutationService","restoreResourcePoolTreeService","clarityConstants","i18nService","resourceTypesConstants"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("RestoreResourcePoolTreeController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){b(!0),e.modalOptions.onSubmit=w,e.evcConstants=a,e.$watch("ctrl.vendor",d),e.$watch("ctrl.evcMode",u)}function l(){t.getData(M,"com.vmware.vsphere.client.clusterui.model.configuration.EditEvcConfigData").then(function(e){return e&&e.supportedIntelEvcMode&&e.supportedAmdEvcMode?(E.supportedIntelEvcMode=e.supportedIntelEvcMode,E.supportedAmdEvcMode=e.supportedAmdEvcMode,E.ftDrsWithoutEvcSupported=e.ftDrsWithoutEvcSupported,F=S(e.hosts),e.currentEvcMode?(E.vendor=e.currentEvcMode.vendor,E.evcMode=e.currentEvcMode):(E.vendor=a.cpuVendor.UNKNOWN,E.evcMode=O),T=E.vendor,I=E.evcMode,void b(!1)):void y()})}function d(e){E.evcModes=f(e),e&&(e===T?E.evcMode=_.find(E.evcModes,function(e){return e.key===I.key}):E.evcModes?E.evcMode=E.evcModes[0]:E.evcMode={})}function u(t){if(t&&I){if(E.compatibilityItems=[],e.modalOptions.isAlertClosed=!0,e.modalOptions.alerts=[],t.key===I.key)return void(E.compatibilityItems=[A]);if(null===t.key)return void(E.ftDrsWithoutEvcSupported?E.compatibilityItems=[N]:E.compatibilityItems=[R]);if(L[t.key])return void p(L[t.key]);b(!0),v(t.key).then(function(e){L[t.key]=e,p(e),b(!1)})}}function p(t){t&&(t.error?(e.modalOptions.alerts=[{type:n.validationBanner.type.ERROR,text:t.error.localizedMessage}],e.modalOptions.isAlertClosed=!1):t.result&&0!==t.result.length?E.compatibilityItems=g(t.result.map(h)):m()?E.compatibilityItems=[U]:E.compatibilityItems=[k])}function v(e){return r.validate(M,"com.vmware.vsphere.client.cluster.ClusterEvcSpec",D(e))}function m(){return null!==E.evcMode.key&&null!==I.key&&E.evcMode.vendorTier>I.vendorTier}function g(e){var t=_.groupBy(e,"message");return _.map(t,function(e,t){var i=_.uniq(_.flatten(_.map(e,"hostNames")));return{icon:"vsphere-icon-status-error",message:t,contents:_.map(i,function(e){return{icon:s.getByObjectType("HostSystem"),message:e,contents:[]}})}})}function h(e){var t=[];return e.host&&0!==e.host.length&&e.host.forEach(function(e){var i=F[e.value];i?t.push(i):V.warn("Could not find a name for host: ",e)}),{message:e.error.localizedMessage,hostNames:t}}function f(e){return e===a.cpuVendor.INTEL?E.supportedIntelEvcMode:e===a.cpuVendor.AMD?E.supportedAmdEvcMode:[O]}function S(e){var t={};return e&&0!==e.length&&e.forEach(function(e){t[e.provider.value]=e.name}),t}function y(){b(!1),e.modalOptions.submitDisabled=!0,e.modalOptions.alerts=[{type:n.validationBanner.type.ERROR,text:C("evc.config.serverError")}],e.modalOptions.isAlertClosed=!1,V.error("Server error can not retrieve edit EVC config data.")}function P(e){return{title:C(e)}}function C(e){return i.getString("ClusterUi",e)}function D(e){return{evcModeKey:e}}function w(){var t=E.evcMode?E.evcMode.key:null;return r.apply(M,"com.vmware.vsphere.client.cluster.ClusterEvcSpec",D(t)),e.closeModal(),!1}function b(t){E.loading=t,e.modalOptions.submitDisabled=t}var I,T,E=this,V=o("EditEvcDialogController"),M=e.modalOptions.dialogData.objectId,O={key:null,label:C("evc.config.disableText")},A={icon:"vsphere-icon-status-ok",message:C("evc.config.validation.currentConfiguration"),contents:[]},k={icon:"vsphere-icon-status-ok",message:C("evc.config.validation.validationSucceeded"),contents:[]},R={icon:"vsphere-icon-status-warning",message:C("evc.config.validation.warning.disable"),contents:[]},N={icon:"vsphere-icon-status-warning",message:C("evc.config.validation.warning.disable.noFtDrsCheck"),contents:[]},U={icon:"vsphere-icon-status-warning",message:C("evc.config.validation.warning.raiseBaseline"),contents:[]},L={},F={};E.vendorHeaderOptions=P("evc.config.evcModeBlock"),E.descriptionHeaderOptions=P("evc.config.descriptionBlock"),E.compatibilityHeaderOptions=P("evc.config.compatibilityBlock"),e.modalOptions.isAlertClosed=!0,c(),l()}angular.module("com.vmware.vsphere.client.cluster").controller("EditEvcDialogController",e),e.$inject=["$scope","dataService","i18nService","mutationService","vuiConstants","logService","evcConstants","iconService"]}(),function(){"use strict";function e(e,t,i,r){function n(){a(!0),t.getSwapFilePlacement(c).then(function(e){s.formData.vmSwapPlacement=e,a(!1)})}function o(){if(s.loading)return!1;var e=i.buildClusterComputeResourceSpec(s.formData,!0);return r.apply(c,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",e),!0}function a(t){e.modalOptions.submitDisabled=t,s.loading=t}var s=this,c=e.modalOptions.dialogData.objectId;s.warning=t.WARNING,s.formData=s.formData||{},s.vmDirectory=t.getVmDirectoryData(),s.hostDatastore=t.getHostDatastoreData(),e.modalOptions.onSubmit=o,n()}angular.module("com.vmware.vsphere.client.cluster").controller("EditSwapFileLocationController",e),e.$inject=["$scope","clusterSwapFileLocationService","clusterSpecBuilderService","mutationService"]}(),function(){"use strict";function e(e,t,i){function r(){return{title:t.getString("ClusterUi","manage.settings.general"),actions:[{actionUid:"vsphere.core.cluster.actions.editSwapfileLocationAction",customLabel:t.getString("Common","settingsView.defaultEditActionLabel")}]}}function n(){i.getSwapFilePlacement(a).then(function(e){o.swapFileLocation=i.getVmSwapFileLocation(e)})}var o=this,a=e._route.objectId;o.headerOptions=r(),o.watchForObjects=[a],o.liveRefreshProperties=["configurationEx.vmSwapPlacement"],o.getViewData=n,n()}angular.module("com.vmware.vsphere.client.cluster").controller("GeneralConfigController",e),e.$inject=["$scope","i18nService","clusterSwapFileLocationService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){p.typeOptions=r.buildTypesOptions()}function l(e){return t.getString("ClusterUi",e)}function d(){if(!p.spec.name)return e.modalOptions.alerts=[{text:l("groups.config.error.nameEmpty"),type:n.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(/^\s*$/gi.test(p.spec.name))return e.modalOptions.alerts=[{text:l("groups.config.error.nameEmpty"),type:n.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(p.spec.name.length>80)return e.modalOptions.alerts=[{text:l("groups.config.error.nameTooLong"),type:n.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(p.spec.groupMembers&&0===p.spec.groupMembers.length)return e.modalOptions.alerts=[{text:l("groups.config.error.noMembers"),type:n.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();var t=r.getSelectedItemsIds(p.spec.groupMembers);p.groupSpec=r.buildGroupSpec(p.spec.groupType,p.spec.name,r.buildGroupMembersSpec(t),s.operationType.ADD);var a=o.validate(v,"com.vmware.vim.binding.vim.cluster.GroupSpec",p.groupSpec).then(function(t){return e.modalOptions.isAlertClosed=!0,e.modalOptions.alerts=[],!t||t.result&&!t.error?i.resolve():(e.modalOptions.alerts.push({text:l("groups.config.error.nameNotUnique"),type:n.validationBanner.type.ERROR}),e.modalOptions.isAlertClosed=!1,i.reject())});return a}function u(){return d().then(function(){if(!p.groupSpec){var e=r.getSelectedItemsIds(p.spec.groupMembers);p.groupSpec=r.buildGroupSpec(p.spec.groupType,p.spec.name,r.buildGroupMembersSpec(e))}var t=a.buildClusterComputeResourceSpec({group:p.groupSpec},!0);return o.apply(v,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",t),!0})["catch"](function(e){return!1})}var p=this,v=e._route.objectId;p.spec={},p.spec.groupType=r.DEFAULT_GROUP_TYPE,p.spec.name="",p.spec.groupMembers=[],e.modalOptions.isAlertClosed=!0,c(),e.modalOptions.onSubmit=function(){return u()}}angular.module("com.vmware.vsphere.client.cluster").controller("AddClusterGroupController",e),e.$inject=["$scope","i18nService","$q","clusterGroupsService","vuiConstants","mutationService","clusterSpecBuilderService","clusterGroupsConstants"]}(),function(){"use strict";function e(e){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/configuration/groups/addGroupMembers.html",scope:{groupType:"=",groupMembers:"="},controller:["$scope","$element",function(t){function i(e){t.groupMembers=t.groupMembers.filter(function(t){return!e.some(function(e){return e.id===t.id})})}function r(e){return t.groupMembers=t.groupMembers.concat(e),!0}t.removeAction=i,t.addAction=r,t.gridTitle=e.getString("ClusterUi","groups.members.list.name"),t.$watch("groupType",function(e){e&&(t.groupMembers=[])})}]}}angular.module("com.vmware.vsphere.client.cluster").directive("addGroupMembers",e),e.$inject=["i18nService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(e){return e===t.groupType.VM_GROUP?{label:i.getString("Common","typeResource.vmPlural"),objectType:c.managedEntityConstants.VIRTUAL_MACHINE,listViewId:"vsphere.core.vm.list"}:e===t.groupType.HOST_GROUP?{label:i.getString("Common","typeResource.hostPlural"),objectType:c.managedEntityConstants.HOST,listViewId:"vsphere.core.host.list"}:null}function a(e,t){return e===c.clusterGroupsConstants.groupType.VM_GROUP?0===t.length?"clusterVmsExceptSecondaryVmsFilter":"clusterVmsExceptSecondaryVmsExcludeVmsFilter":e===c.clusterGroupsConstants.groupType.HOST_GROUP?0===t.length?"clusterObjectsFilter":"clusterObjectsExcludeObjectsFilter":void 0}function s(e){return e.map(function(e){return e.id})}var c=this;c.managedEntityConstants=r,c.clusterGroupsConstants=t;var l=e.modalOptions.dialogData;l.selectedItems=[],e.modalOptions.onSubmit=function(){return 0===l.selectedItems.length?(e.modalOptions.alerts=[{text:i.getString("CommonUi","objectSelectorDialog.noSelection"),type:n.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,!1):e.modalOptions.dialogData.onSubmit()};var d=l.objectId,u=l.objects,p=l.objectType,v=s(u),m=o(p),g=a(p,v);m&&(this.config={contextObject:d,multipleSelect:!0,listTabConfig:{listConfig:[{label:m.label,listViewId:m.listViewId,dataModels:[m.objectType],filterId:g,filterParams:v}]},onSelectionChanged:function(e){l.selectedItems=e}})}angular.module("com.vmware.vsphere.client.cluster").controller("AddGroupMembersSelectorDialog",e),e.$inject=["$scope","clusterGroupsConstants","i18nService","managedEntityConstants","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/configuration/groups/groupMembersManager.html",scope:{objects:"=",objectType:"=",addAction:"=",removeAction:"=",gridTitle:"="},controller:["$scope",function(r){function n(){i.updateActionBar(r.gridOptions,[c],d).then(function(e){u=e})}function o(){u&&i.updateActionBar(r.gridOptions,[c],d,u)}function a(){var e={actionBarOptions:{actions:[]},pageConfig:{hidePager:!0},searchable:!1,resizable:!1,data:[],columnDefs:[{field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'}],selectionMode:t.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],height:"100%"};return e}function s(e){l=e&&0!==e.length?e:[],o()}var c=e._route.objectId,l=[],d=[{actionId:"vsphere.core.cluster.actions.group.members.add",getActionInvocationContext:function(){return{memberObjects:r.objects,memberObjectsType:r.objectType,addMembersCallback:function(e){return r.addAction(e)}}},isActionAvailable:function(e){return e.available&&!!r.objects}},{actionId:"vsphere.core.cluster.actions.group.members.remove",getActionInvocationContext:function(){return{removeMembersCallback:function(){return r.removeAction(l)}}},isActionAvailable:function(e){return e.available&&r.gridOptions.selectedItems.length>0}}],u=null;r.gridOptions=a(),r.$watch("gridOptions.selectedItems",s),r.$watchCollection("objects",function(e){e?r.gridOptions.data=e:r.gridOptions.data=[],o()}),n()}],link:function(e,t){var i=r.defer();e.$on("kendoWidgetCreated",function(e,t){t&&t.constructor===kendo.ui.Grid&&i.resolve(t)}),e.$watch("gridTitle",function(r){r&&r.trim().length>0&&i.promise.then(function(i){var n=i.getOptions();n.columns[0].title=r,i.setOptions(n),e.$evalAsync(function(){kendo.resize(t)})})})}}}angular.module("com.vmware.vsphere.client.cluster").directive("groupMembersManager",e),e.$inject=["$rootScope","vuiConstants","datagridActionBarService","$q"]}(),function(){"use strict";function e(e,t,i,r,n,o){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/configuration/groups/vmAndHostGroupMembers.html",scope:{group:"="},controller:["$scope","$element",function(a){function s(e){t.removeGroupMembers(d,a.group,e)}function c(e){var i=l(a.objects.concat(e)),s=t.buildGroupSpec(a.group.rawType,a.group.name,t.buildGroupMembersSpec(i),r.operationType.EDIT),c=o.buildClusterComputeResourceSpec({group:s},!0);return n.apply(d,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",c),!0}function l(e){return e.map(function(e){return e.id})}var d=i._route.objectId;a.removeAction=s,a.addAction=c,a.$watch("group",function(i){i?t.getGroupMembers(i).then(function(t){a.group&&a.group.name===i.name&&(a.objects=t,a.objectType=i.rawType,a.gridTitle=e.getString("ClusterUi","rules.groupMembers.members",_.escape(i.name)))}):(a.objects=null,a.gridTitle=" ")})}]}}angular.module("com.vmware.vsphere.client.cluster").directive("vmAndHostGroupMembers",e),e.$inject=["i18nService","clusterGroupsService","$rootScope","clusterGroupsConstants","mutationService","clusterSpecBuilderService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){o.getGroupsData(C,t.searchTerm).then(function(e){P.groupsGridOptions.data=e,u()})}function l(){s.updateActionBar(P.groupsGridOptions,[C],D).then(function(e){w=e})}function d(){w&&s.updateActionBar(P.groupsGridOptions,[C],D,w)}function u(){if(P.groupsGridOptions.data&&P.groupsGridOptions.data.length>0){var e;P.selectedGroup&&(e=_.find(P.groupsGridOptions.data,{name:P.selectedGroup.name})),P.selectedGroup=e?e:P.groupsGridOptions.data[0]}}function p(){var e={actionBarOptions:{actions:[]},pageConfig:{hidePager:!0},searchable:!1,resizable:!0,data:[],selectionMode:a.grid.selectionMode.SINGLE,selectedItems:[],columnDefs:f(),height:"100%",dataBound:v};return e}function v(){T||m()}function m(){var e=g();if(e){var t=e.find(".k-grid-toolbar");t.length>0&&(t.append(I),T=!0)}}function g(){const e=i.find(".k-grid-content");return e&&e.parent()}function h(){return{orientation:a.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"40%"},{min:"150px",size:"60%"}]}}function f(){return[{displayName:n.getString("ClusterUi","groups.list.name"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'},{displayName:n.getString("ClusterUi","groups.list.type"),field:"type",type:"string",template:'<span title="#:type#">#:type#</span>'}]}function S(e){return e&&0!==e.length?void(P.selectedGroup&&e[0].name===P.selectedGroup.name||(P.selectedGroup=e[0])):void(P.selectedGroup=null)}function y(e){return P.selectedGroup&&e&&P.selectedGroup.name===e.name}var P=this,C=e._route.objectId,D=[{actionId:"vsphere.core.cluster.actions.group.add"},{actionId:"vsphere.core.cluster.actions.group.remove",getActionInvocationContext:function(){return{selectedGroup:P.selectedGroup}},isActionAvailable:function(e){return e.available&&P.groupsGridOptions.selectedItems.length>0}}],w=null;P.watchForObjects=[C],P.liveRefreshProperties=["configurationEx.group"],P.getViewData=c,P.groupsGridOptions=p(),P.splitterOptions=h(),P.groupsTitle=n.getString("ClusterUi","manage.settings.groups"),P.selectedGroup=null;var b=n.getString("Common","filter.label"),I=r('<div class="filter-input pull-right"><span class="nav-icon fa fa-filter" ng-click="doSearch()"/><input type="text" ng-model="searchTerm" ng-trim="true" ng-change="debouncedRefreshCallback()" ng-keypress="keyPress($event)" placeholder="'+b+'"/></div>')(t),T=!1;t.doSearch=function(){c()},t.keyPress=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),c())},t.groupsPreselectComparator=y,t.$watch("ctrl.groupsGridOptions.selectedItems",S),t.$watch(function(){return P.selectedGroup},function(){d()}),c(),l()}angular.module("com.vmware.vsphere.client.cluster").controller("VmAndHostGroupsController",e),e.$inject=["$rootScope","$scope","$element","$compile","i18nService","clusterGroupsService","vuiConstants","datagridActionBarService"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g){this.dataService=e,this.i18nService=t,this.clusterConfigVmOverrideService=i,this.drsAutomationLevelService=r,this.vcService=n,this.haConstants=o,this.haHostFailureResponseService=a,this.haHostIsolationResponseService=s,this.haPdlResponseService=c,this.haApdResponseService=l,this.haVmReactionsOnApdClearedService=d,this.clusterVmOverridesConstants=u,this.clusterConstants=p,this.haVmMonitoringService=v,this.defaultUriSchemeUtil=m,
this.$q=g,this.tooltipParams={},this.MIN_POST_READY_DELAY=0,this.MIN_RESTART_PRIORITY_TIMEOUT=0,this.i18n=t.getString,this.setPageBusy(!0),this.MAX_POST_READY_DELAY=this.haConstants.MAX_POST_READY_DELAY,this.MAX_RESTART_PRIORITY_TIMEOUT=this.haConstants.MAX_RESTART_PRIORITY_TIMEOUT,this.POST_READY_DELAY_PLACEHOLDER=this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues")}return e.prototype.$onChanges=function(e){var t=this;if(angular.isUndefined(e.spec)||(this.vmSettingsSpec=e.spec.currentValue),!angular.isUndefined(this.vmSettingsSpec)&&!angular.isUndefined(e.selectedVms)&&!angular.isUndefined(e.selectedVms.currentValue)&&e.selectedVms.currentValue.length>0)if(this.selectedVms=e.selectedVms.currentValue,this.clusterOverridesData&&this.is65VcOrLater)this.initSettings();else{var i=this.dataService.getData(this.vmSettingsSpec.objectId,"com.vmware.vsphere.client.clusterui.model.configuration.ClusterAddOverrideData"),r=this.vcService.is65VcOrLater(this.vmSettingsSpec.objectId);this.$q.all([i,r]).then(function(e){t.clusterOverridesData=e[0],t.is65VcOrLater=e[1],t.initSettings()})}},e.prototype.initSettings=function(){this.initDrsSettings(),this.initHaSettings();var e=this.getDifferentSettingsVmsCount();e>0&&(this.alertText=1===e?this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.warningMessage.single"):this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.warningMessage.multiple",e)),this.setPageBusy(!1)},e.prototype.updateRestartPriorityDependencies=function(){this.isRestartPriorityDisabled()&&(this.setDefaultHaIsolationResponse(),this.setDefaultHaPdlProtection(),this.setDefaultHaApdProtection(),this.setDefaultHaApdVmRecovery(),this.setDefaultHaApdDelay())},e.prototype.updateDrsAutomationLevelValue=function(){this.vmSettingsSpec.drsAutomationOverrideEnabled||(this.vmSettingsSpec.drsAutomationLevel=this.clusterOverridesData.clusterDrsAutomationLevel)},e.prototype.updateRestartPriorityValue=function(){this.vmSettingsSpec.haRestartPriorityEnabled||(this.vmSettingsSpec.haRestartPriority=this.clusterOverridesData.clusterVmRestartPriority)},e.prototype.updateRestartOrchestrationValue=function(){var e=this;this.vmSettingsSpec.haRestartOrchestrationEnabled?_.each(this.selectedVms,function(t){t.skipFromOrchestrationSpec&&(t.skipFromOrchestrationSpec=!1),t.arrayOperation===e.clusterVmOverridesConstants.operationType.REMOVE&&(t.arrayOperation=e.clusterVmOverridesConstants.operationType.EDIT)}):(this.vmSettingsSpec.restartOrchestration.readyCondition=this.clusterOverridesData.defaultVmReadiness.readyCondition,this.vmSettingsSpec.haRestartOrchestrationAdditionalDelayEnabled||_.each(this.selectedVms,function(t){t.arrayOperation===e.clusterVmOverridesConstants.operationType.ADD&&(t.skipFromOrchestrationSpec=!0),t.arrayOperation===e.clusterVmOverridesConstants.operationType.EDIT&&(t.arrayOperation=e.clusterVmOverridesConstants.operationType.REMOVE)}))},e.prototype.updateRestartOrchestrationAdditionalDelayValue=function(){var e=this;this.vmSettingsSpec.haRestartOrchestrationAdditionalDelayEnabled?(this.vmSettingsSpec.restartOrchestration.postReadyDelay===this.clusterVmOverridesConstants.APD_DELAY_CLUSTER_DEFAULT&&(this.vmSettingsSpec.restartOrchestration.postReadyDelay=this.clusterOverridesData.defaultVmReadiness.postReadyDelay),_.each(this.selectedVms,function(t){t.skipFromOrchestrationSpec&&(t.skipFromOrchestrationSpec=!1),t.arrayOperation===e.clusterVmOverridesConstants.operationType.REMOVE&&(t.arrayOperation=e.clusterVmOverridesConstants.operationType.EDIT)})):(this.vmSettingsSpec.restartOrchestration.postReadyDelay=this.clusterVmOverridesConstants.APD_DELAY_CLUSTER_DEFAULT,this.vmSettingsSpec.haRestartOrchestrationEnabled||_.each(this.selectedVms,function(t){t.arrayOperation===e.clusterVmOverridesConstants.operationType.ADD&&(t.skipFromOrchestrationSpec=!0),t.arrayOperation===e.clusterVmOverridesConstants.operationType.EDIT&&(t.arrayOperation=e.clusterVmOverridesConstants.operationType.REMOVE)}))},e.prototype.updateRestartPriorityTimeoutValue=function(){this.vmSettingsSpec.haRestartPriorityTimeoutEnabled?this.vmSettingsSpec.haRestartPriorityTimeout===this.clusterVmOverridesConstants.APD_DELAY_CLUSTER_DEFAULT&&(this.vmSettingsSpec.haRestartPriorityTimeout=this.clusterOverridesData.clusterVmRestartPriorityTimeout):this.vmSettingsSpec.haRestartPriorityTimeout=this.clusterVmOverridesConstants.APD_DELAY_CLUSTER_DEFAULT},e.prototype.updateIsolationResponseValue=function(){this.vmSettingsSpec.haIsolationResponseEnabled||(this.vmSettingsSpec.haIsolationResponse=this.clusterOverridesData.clusterIsolationResponse)},e.prototype.updatePdlProtectionValue=function(){this.vmSettingsSpec.haPdlProtectionEnabled||(this.vmSettingsSpec.haPdlProtection=this.clusterOverridesData.vmcpSettings.pdlResponse)},e.prototype.updateApdProtectionValue=function(){this.vmSettingsSpec.haApdProtectionEnabled||(this.vmSettingsSpec.haApdProtection=this.clusterOverridesData.vmcpSettings.apdResponse,this.updateApdProtectionDependencies())},e.prototype.updateApdProtectionDependencies=function(){this.isApdProtectionDisabled()&&(this.setDefaultHaApdDelay(),this.setDefaultHaApdVmRecovery())},e.prototype.updateApdDelayValue=function(){this.vmSettingsSpec.haApdDelayEnabled||(this.vmSettingsSpec.haApdDelay=this.getApdDelayClusterDefault())},e.prototype.updateApdVmRecoveryValue=function(){this.vmSettingsSpec.haApdVmRecoveryEnabled||(this.vmSettingsSpec.haApdVmRecovery=this.clusterOverridesData.vmcpSettings.vmReactionOnAPDCleared)},e.prototype.updateVmMonitoringValue=function(){this.vmSettingsSpec.haVmMonitoringEnabled||(this.vmSettingsSpec.haVmMonitoring=this.clusterOverridesData.vmMonitoring,this.setDefaultHaVmMonitoringSensitivity(),this.setDefaultHaVmMonitoringFailureInterval(),this.setDefaultHaVmMonitoringMinUpTime(),this.setDefaultHaVmMonitoringMaxFailures(),this.setDefaultHaVmMonitoringMaxFailuresWindow()),this.updateVmMonitoringSensitivityTooltip()},e.prototype.updateVmMonitoringSensitivityTooltip=function(){if(this.tooltipParams.haVmMonitoringSensitivityParams&&(this.tooltipParams.haVmMonitoringSensitivityParams.isSettingVisible=this.isVmMonitoringSensitivityVisible(),this.alertText)){var e=this.getDifferentSettingsVmsCount();this.alertText=1===e?this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.warningMessage.single"):this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.warningMessage.multiple",e)}},e.prototype.normalizeApdDelayValue=function(e){var t=Math.floor(this.clusterConstants.MAX_INTEGER/this.haConstants.SECONDS_IN_A_MINUTE);this.normalizeOverrideValue("haApdDelay",e,this.haConstants.MIN_NUMBER_INPUT,t)},e.prototype.normalizeApdDelayMultipleValues=function(e){if(e!==this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues")){var t=Math.floor(this.clusterConstants.MAX_INTEGER/this.haConstants.SECONDS_IN_A_MINUTE),i=parseInt(e,10);angular.isUndefined(e)||_.isNull(e)||i<0||isNaN(i)?this.vmSettingsSpec.haApdDelay=0:i>t?this.vmSettingsSpec.haApdDelay=t:this.vmSettingsSpec.haApdDelay=i}},e.prototype.normalizeFailureInt=function(e){this.normalizeOverrideValue("vmToolsMonitorFailureInt",e,this.haConstants.MIN_NUMBER_INPUT,this.haConstants.MAX_FAILURE_INTERVAL)},e.prototype.normalizeMinUpTime=function(e){this.normalizeOverrideValue("vmToolsMonitorMinUpTime",e,this.haConstants.MIN_NUMBER_INPUT,this.haConstants.MAX_MINIMUM_UPTIME)},e.prototype.normalizeMaxFailures=function(e){this.normalizeOverrideValue("vmToolsMonitorMaxFailures",e,this.haConstants.MIN_NUMBER_INPUT,this.haConstants.MAX_VM_PER_RESET)},e.prototype.normalizeMaxFailuresWindow=function(e){this.normalizeOverrideValue("vmToolsMonitorMaxFailureWindow",e,this.haConstants.MIN_RESETS_WINDOW_HRS,this.haConstants.MAX_RESETS_WINDOW_HRS)},e.prototype.hasSelectedVm=function(){return!_.isEmpty(this.selectedVms)},e.prototype.isFtVm=function(){return this.hasSelectedVm()&&_.some(this.selectedVms,function(e){return e.vm.ftVm})},e.prototype.isVmcpSupportedForVm=function(){return this.hasSelectedVm()&&_.all(this.selectedVms,function(e){return e.vm.isVmcpSupportedForVm})},e.prototype.isDrsAutomationLevelEditable=function(){var e=this.getSelectedVmsDrsProperties("drsAutomationLevelEditable"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);return this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(t=!1),!this.isEditMode()||t},e.prototype.isCustomMonitoringSensitivity=function(){return this.vmSettingsSpec.haVmMonitoringSensitivity===this.haVmMonitoringService.getPresetLevels().CUSTOM},e.prototype.isRestartPriorityDisabled=function(){if(this.vmSettingsSpec.haRestartPriority===this.haConstants.restartPriority.DISABLED)return!0;if(this.clusterConfigVmOverrideService.hasMultipleValues(this.vmSettingsSpec.haRestartPriority)){var e=this.getSelectedVmsHaProperties("haRestartPriority");if(this.clusterConfigVmOverrideService.containsValue(e,this.haConstants.restartPriority.DISABLED))return!0}return!1},e.prototype.isApdProtectionDisabled=function(){if(this.vmSettingsSpec.haApdProtection===this.haConstants.storageVmReaction.DISABLED||this.vmSettingsSpec.haApdProtection===this.haConstants.storageVmReaction.WARNING)return!0;if(this.clusterConfigVmOverrideService.hasMultipleValues(this.vmSettingsSpec.haApdProtection)){var e=this.getSelectedVmsHaProperties("apdProtectionLevel");if(this.clusterConfigVmOverrideService.containsValue(e,this.haConstants.storageVmReaction.DISABLED)||this.clusterConfigVmOverrideService.containsValue(e,this.haConstants.storageVmReaction.WARNING))return!0}return!1},e.prototype.isVmMonitoringSensitivityVisible=function(){if(this.vmSettingsSpec.haVmMonitoring===this.haConstants.vmMonitoring.DISABLED)return!1;if(this.clusterConfigVmOverrideService.hasMultipleValues(this.vmSettingsSpec.haVmMonitoring)){var e=this.getSelectedVmsHaProperties("vmMonitoring");if(this.clusterConfigVmOverrideService.containsValue(e,this.haConstants.vmMonitoring.DISABLED))return!1}return!0},e.prototype.getDifferentSettingsVmsCount=function(){var e=0;return _.each(this.tooltipParams,function(t){t.isSettingVisible&&e++}),e},e.prototype.normalizeOverrideValue=function(e,t,i,r){var n=t.target.value;(!n||n<i)&&(this.vmSettingsSpec[e]=i),n>r&&(this.vmSettingsSpec[e]=r)},e.prototype.initDrsSettings=function(){this.drsAutomationLevels=this.clusterConfigVmOverrideService.getDrsAutomationLevels();var e=this.getSelectedVmsDrsProperties("drsAutomationLevel"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.clusterConfigVmOverrideService.addInitialValuesOption(this.drsAutomationLevels),this.tooltipParams.drsAutomationLevelParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.drsAutomationLevels,this.clusterOverridesData.clusterDrsAutomationLevel),this.tooltipParams.drsAutomationLevelParams.isSettingVisible=!0),this.vmSettingsSpec.drsAutomationLevel=t,this.vmSettingsSpec.drsAutomationOverrideEnabled=this.isDrsAutomationLevelEditable()):this.setDefaultDrsAutomationLevel()},e.prototype.initHaSettings=function(){this.initHaIsolationResponse(),this.initHaRestartPriority(),this.initHaRestartOrchestration(),this.initHaRestartOrchestrationAdditionalDelay(),this.initHaRestartPriorityTimeout(),this.initHaPdlProtection(),this.initHaApdProtection(),this.initHaApdDelay(),this.initHaApdVmRecovery(),this.initHaVmMonitoring(),this.initHaVmMonitoringSensitivity(),this.initHaVmMonitoringFailureInterval(),this.initHaMonitoringMinUpTime(),this.initHaMonitoringMaxFailures(),this.initHaMonitoringMaxFailuresWindow()},e.prototype.initHaRestartPriority=function(){this.restartPriorityOptions=this.haHostFailureResponseService.getVmRestartPriorityOptions(this.is65VcOrLater),this.isFtVm()||(this.restartPriorityOptions.disabled=this.haHostFailureResponseService.getDisabledOption()),this.vmSettingsSpec.haRestartPriorityDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.clusterVmRestartPriority===this.haConstants.restartPriority.DISABLED;var e=this.getSelectedVmsHaProperties("haRestartPriority"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.restartPriorityOptions.useInitialValues={id:this.clusterVmOverridesConstants.INITIAL_VALUES,label:this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues")},this.tooltipParams.haRestartPriorityParams=this.clusterConfigVmOverrideService.getTooltipParams(e,_.values(this.restartPriorityOptions),this.clusterOverridesData.clusterVmRestartPriority),this.tooltipParams.haRestartPriorityParams.isSettingVisible=!0),this.vmSettingsSpec.haRestartPriority=t,this.vmSettingsSpec.haRestartPriorityEnabled=!0):(this.vmSettingsSpec.haRestartPriority=this.clusterOverridesData.clusterVmRestartPriority,this.vmSettingsSpec.haRestartOrchestrationEnabled=!1)},e.prototype.setOrchestrationArrayOperationsPerVM=function(){var e=this;_.each(this.selectedVms,function(t){var i=e.findOrchestrationInfoForVm(t);_.isUndefined(i)?t.arrayOperation=e.clusterVmOverridesConstants.operationType.ADD:t.arrayOperation=e.clusterVmOverridesConstants.operationType.EDIT})},e.prototype.findOrchestrationInfoForVm=function(e){var t=this.defaultUriSchemeUtil;return _.find(this.clusterOverridesData.vmOrchestrationCondition,function(i){var r;if(e.vm.provider){var n={type:e.vm.provider.type,value:e.vm.provider.value,serverGuid:e.vm.provider.serverGuid};r=t.getVsphereObjectId(n)}else r=e.id;return t.getVsphereObjectId(i.vm)===r})},e.prototype.initHaIsolationResponse=function(){if(this.isFtVm())this.isolationResponseOptions=this.haHostIsolationResponseService.getEnsureFtResponse(),this.vmSettingsSpec.haIsolationResponse="EnsureFT";else{this.isolationResponseOptions=this.haHostIsolationResponseService.getResponses(),this.vmSettingsSpec.haIsolationResponseDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.clusterIsolationResponse===this.haConstants.hostIsolationResponse.LEAVE_POWERED_ON;var e=this.getSelectedVmsHaProperties("haIsolationResponse"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.clusterConfigVmOverrideService.addInitialValuesOption(this.isolationResponseOptions),this.tooltipParams.haIsolationResponseParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.isolationResponseOptions,this.clusterOverridesData.clusterIsolationResponse),this.tooltipParams.haIsolationResponseParams.isSettingVisible=!0),this.vmSettingsSpec.haIsolationResponse=t,this.vmSettingsSpec.haIsolationResponseEnabled=!this.isFtVm()):this.setDefaultHaIsolationResponse()}},e.prototype.initHaRestartOrchestration=function(){if(this.is65VcOrLater){this.restartOrchestrationOptions=this.haHostFailureResponseService.getVmOrchestrationReadyConditions(),this.vmSettingsSpec.haRestartOrchestrationDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.clusterVmRestartPriority===this.haConstants.restartPriority.DISABLED;var e=this.getSelectedVmsOrchestrationReadyConditions(),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.setOrchestrationArrayOperationsPerVM(),_.isUndefined(this.vmSettingsSpec.restartOrchestration)&&(this.vmSettingsSpec.restartOrchestration={}),this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.restartOrchestrationOptions.useInitialValues={id:this.clusterVmOverridesConstants.INITIAL_VALUES,label:this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues")},this.tooltipParams.haRestartOrchestrationParams=this.clusterConfigVmOverrideService.getTooltipParams(e,_.values(this.restartOrchestrationOptions),this.clusterOverridesData.defaultVmReadiness.readyCondition),this.tooltipParams.haRestartOrchestrationParams.isSettingVisible=this.is65VcOrLater),this.vmSettingsSpec.restartOrchestration.readyCondition=t,this.vmSettingsSpec.haRestartOrchestrationEnabled=!0):(this.vmSettingsSpec.restartOrchestration.readyCondition=this.clusterOverridesData.defaultVmReadiness.readyCondition,this.vmSettingsSpec.haRestartOrchestrationEnabled=!1)}},e.prototype.initHaRestartOrchestrationAdditionalDelay=function(){if(this.is65VcOrLater){_.isUndefined(this.vmSettingsSpec.restartOrchestration)&&(this.vmSettingsSpec.restartOrchestration={}),this.vmSettingsSpec.haRestartOrchestrationAdditionalDelayDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.clusterVmRestartPriority===this.haConstants.restartPriority.DISABLED;var e=this.getSelectedVmsOrchestrationPostReadyDelays(),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.setOrchestrationArrayOperationsPerVM(),this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)&&t!==this.clusterOverridesData.defaultVmReadiness.postReadyDelay?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(t=this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues"),this.haAdditionalDelayMultipleOptions={recommendedValues:[{value:t}]},this.tooltipParams.haRestartOrchestrationAdditionalDelayParams=this.clusterConfigVmOverrideService.getValuesInSecondsTooltipParams(e,this.clusterOverridesData.defaultVmReadiness.postReadyDelay),this.tooltipParams.haRestartOrchestrationAdditionalDelayParams.isSettingVisible=this.is65VcOrLater),this.vmSettingsSpec.restartOrchestration.postReadyDelay=t,this.vmSettingsSpec.haRestartOrchestrationAdditionalDelayEnabled=!0):(this.vmSettingsSpec.restartOrchestration.postReadyDelay=this.clusterOverridesData.defaultVmReadiness.postReadyDelay,this.vmSettingsSpec.haRestartOrchestrationAdditionalDelayEnabled=!1)}},e.prototype.initHaRestartPriorityTimeout=function(){if(this.is65VcOrLater){this.vmSettingsSpec.haRestartPriorityTimeoutDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.clusterVmRestartPriority===this.haConstants.restartPriority.DISABLED;var e=_.map(this.getSelectedVmsHaProperties("haRestartPriorityTimeout"),function(e){return{vm:e.vm,value:e.value?parseInt(e.value.split("s")[0]):e.value}}),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&t!==-1&&t!==this.clusterOverridesData.clusterVmRestartPriorityTimeout?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(t=this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues"),this.haRestartPriorityMultipleOptions={recommendedValues:[{value:t}]},this.tooltipParams.haRestartPriorityTimeoutParams=this.clusterConfigVmOverrideService.getValuesInSecondsTooltipParams(e,this.clusterOverridesData.clusterVmRestartPriorityTimeout),this.tooltipParams.haRestartPriorityTimeoutParams.isSettingVisible=this.is65VcOrLater),this.vmSettingsSpec.haRestartPriorityTimeout=t,this.vmSettingsSpec.haRestartPriorityTimeoutEnabled=!0):(this.vmSettingsSpec.haRestartPriorityTimeout=this.clusterOverridesData.clusterVmRestartPriorityTimeout,this.vmSettingsSpec.haRestartPriorityTimeoutEnabled=!1)}},e.prototype.initHaPdlProtection=function(){this.pdlProtectionOptions=this.haPdlResponseService.getResponses(),this.vmSettingsSpec.haPdlProtectionDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.vmcpSettings.pdlResponse===this.haConstants.storageVmReaction.DISABLED,this.pdlTooltipParams={message:this.i18nService.getString("ClusterUi","vm.overrides.HA.pdlProtectionLevel.hint"),title:this.i18nService.getString("Common","help")};var e=this.getSelectedVmsHaProperties("pdlProtectionLevel"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.clusterConfigVmOverrideService.addInitialValuesOption(this.pdlProtectionOptions),this.tooltipParams.haPdlProtectionParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.pdlProtectionOptions,this.clusterOverridesData.vmcpSettings.pdlResponse),this.tooltipParams.haPdlProtectionParams.isSettingVisible=!0),this.vmSettingsSpec.haPdlProtection=t,this.vmSettingsSpec.haPdlProtectionEnabled=this.isVmcpSupportedForVm()):this.setDefaultHaPdlProtection()},e.prototype.initHaApdProtection=function(){this.apdProtectionOptions=this.haApdResponseService.getResponses(),this.vmSettingsSpec.haApdProtectionDisabled=!this.clusterOverridesData.haEnabled||this.clusterOverridesData.vmcpSettings.apdResponse===this.haConstants.storageVmReaction.DISABLED,this.apdTooltipParams={message:this.i18nService.getString("ClusterUi","vm.overrides.HA.apdProtectionLevel.hint"),title:this.i18nService.getString("Common","help")};var e=this.getSelectedVmsHaProperties("apdProtectionLevel"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.clusterConfigVmOverrideService.addInitialValuesOption(this.apdProtectionOptions),this.tooltipParams.haApdProtectionParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.apdProtectionOptions,this.clusterOverridesData.vmcpSettings.apdResponse),this.tooltipParams.haApdProtectionParams.isSettingVisible=!0),this.vmSettingsSpec.haApdProtection=t,this.vmSettingsSpec.haApdProtectionEnabled=this.isVmcpSupportedForVm()):this.setDefaultHaApdProtection()},e.prototype.initHaApdVmRecovery=function(){this.apdVmRecoveryOptions=this.haVmReactionsOnApdClearedService.getReactions();var e=this.getSelectedVmsHaProperties("vmRemediationOnApdRecover"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.clusterConfigVmOverrideService.addInitialValuesOption(this.apdVmRecoveryOptions),this.tooltipParams.haApdVmRecoveryParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.apdVmRecoveryOptions,this.clusterOverridesData.vmcpSettings.vmReactionOnAPDCleared),this.tooltipParams.haApdVmRecoveryParams.isSettingVisible=!0),this.vmSettingsSpec.haApdVmRecovery=t,this.vmSettingsSpec.haApdVmRecoveryEnabled=this.isVmcpSupportedForVm()):this.setDefaultHaApdVmRecovery()},e.prototype.initHaApdDelay=function(){var e=this.getSelectedVmsHaProperties("usesDefaultIntervalBeforeVmcpReaction"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);if(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(t=!1),this.isEditMode()&&!t){var i=this.getSelectedVmsHaProperties("intervalBeforeVmcpReaction"),r=this.clusterConfigVmOverrideService.getUniqueValue(i);this.clusterConfigVmOverrideService.hasMultipleValues(r)&&(r=this.i18nService.getString("ClusterUi","vm.overrides.config.editMultiple.useInitialValues"),this.apdDelayMultipleValuesOptions={recommendedValues:[{value:r}]},this.tooltipParams.haApdDelayParams=this.clusterConfigVmOverrideService.getApdDelayTooltipParams(e,i,this.getApdDelayClusterDefault()),this.tooltipParams.haApdDelayParams.isSettingVisible=!0),this.vmSettingsSpec.haApdDelay=r,this.vmSettingsSpec.haApdDelayEnabled=this.isVmcpSupportedForVm()}else this.setDefaultHaApdDelay()},e.prototype.getApdDelayClusterDefault=function(){return this.clusterOverridesData.vmcpSettings.vmTerminateDelayForAPDSec/this.haConstants.SECONDS_IN_A_MINUTE},e.prototype.initHaVmMonitoring=function(){this.vmMonitoringOptions=this.haVmMonitoringService.getVmOverrideMonitoringLevels(this.clusterOverridesData.vmMonitoring);var e=this.getSelectedVmsHaProperties("vmMonitoring"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?(this.clusterConfigVmOverrideService.hasMultipleValues(t)&&(this.clusterConfigVmOverrideService.addInitialValuesOption(this.vmMonitoringOptions),this.tooltipParams.haVmMonitoringParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.vmMonitoringOptions,this.clusterOverridesData.vmMonitoring),this.tooltipParams.haVmMonitoringParams.isSettingVisible=!0),this.vmSettingsSpec.haVmMonitoringEnabled=!0,this.vmSettingsSpec.haVmMonitoring=t):this.setDefaultHaVmMonitoring()},e.prototype.initHaVmMonitoringSensitivity=function(){this.vmMonitoringSensitivityOptions=this.haVmMonitoringService.getMonitoringSensitivityLevels();var e=this.getSelectedVmsHaProperties("vmMonitoringSensitivity"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!this.clusterConfigVmOverrideService.isClusterDefault(t)?this.clusterConfigVmOverrideService.hasMultipleValues(t)?this.setMultipleVmMonitoringSensitivityParams(e,t):this.vmSettingsSpec.haVmMonitoringSensitivity=parseInt(t,10):this.setDefaultHaVmMonitoringSensitivity()},e.prototype.handleMultipleVmMonitoringSensitivityValues=function(){if(!this.tooltipParams.haVmMonitoringSensitivityParams){var e=this.getSelectedVmsHaProperties("vmMonitoringSensitivity"),t=this.clusterVmOverridesConstants.INITIAL_VALUES;this.setMultipleVmMonitoringSensitivityParams(e,t)}},e.prototype.setMultipleVmMonitoringSensitivityParams=function(e,t){this.clusterConfigVmOverrideService.addInitialValuesOption(this.vmMonitoringSensitivityOptions),this.tooltipParams.haVmMonitoringSensitivityParams=this.clusterConfigVmOverrideService.getTooltipParams(e,this.vmMonitoringSensitivityOptions,this.getDefaultHaVmMonitoringSensitivity()),this.tooltipParams.haVmMonitoringSensitivityParams.isSettingVisible=this.isVmMonitoringSensitivityVisible(),this.vmSettingsSpec.haVmMonitoringSensitivity=t},e.prototype.initHaVmMonitoringFailureInterval=function(){var e=this.getSelectedVmsHaProperties("vmFailureIntervalValue"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!_.isNull(t)?this.clusterConfigVmOverrideService.hasMultipleValues(t)?(this.handleMultipleVmMonitoringSensitivityValues(),this.setDefaultHaVmMonitoringFailureInterval()):this.vmSettingsSpec.vmToolsMonitorFailureInt=t:this.setDefaultHaVmMonitoringFailureInterval()},e.prototype.initHaMonitoringMinUpTime=function(){var e=this.getSelectedVmsHaProperties("vmMinUptimeValue"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!_.isNull(t)?this.clusterConfigVmOverrideService.hasMultipleValues(t)?(this.handleMultipleVmMonitoringSensitivityValues(),this.setDefaultHaVmMonitoringMinUpTime()):this.vmSettingsSpec.vmToolsMonitorMinUpTime=t:this.setDefaultHaVmMonitoringMinUpTime()},e.prototype.initHaMonitoringMaxFailures=function(){var e=this.getSelectedVmsHaProperties("vmMaxFailuresValue"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!_.isNull(t)?this.clusterConfigVmOverrideService.hasMultipleValues(t)?(this.handleMultipleVmMonitoringSensitivityValues(),this.setDefaultHaVmMonitoringMaxFailures()):this.vmSettingsSpec.vmToolsMonitorMaxFailures=t:this.setDefaultHaVmMonitoringMaxFailures()},e.prototype.initHaMonitoringMaxFailuresWindow=function(){var e=this.getSelectedVmsHaProperties("vmMaxFailureWindowValue"),t=this.clusterConfigVmOverrideService.getUniqueValue(e);this.isEditMode()&&!_.isNull(t)?this.clusterConfigVmOverrideService.hasMultipleValues(t)?(this.handleMultipleVmMonitoringSensitivityValues(),this.setDefaultHaVmMonitoringMaxFailuresWindow()):t!==this.haConstants.vmMonitoringSensitivity.NO_FAILURE_WINDOW?(this.vmSettingsSpec.vmToolsMonitorHasFailureWindow=!0,this.vmSettingsSpec.vmToolsMonitorMaxFailureWindow=t/3600):(this.vmSettingsSpec.vmToolsMonitorHasFailureWindow=!1,this.vmSettingsSpec.vmToolsMonitorMaxFailureWindow=1):this.setDefaultHaVmMonitoringMaxFailuresWindow()},e.prototype.setDefaultDrsAutomationLevel=function(){this.vmSettingsSpec.drsAutomationLevel=this.clusterOverridesData.clusterDrsAutomationLevel,this.vmSettingsSpec.drsAutomationOverrideEnabled=!1},e.prototype.setDefaultHaIsolationResponse=function(){this.vmSettingsSpec.haIsolationResponseEnabled=!1,this.vmSettingsSpec.haIsolationResponse=this.clusterOverridesData.clusterIsolationResponse},e.prototype.setDefaultHaPdlProtection=function(){this.vmSettingsSpec.haPdlProtectionEnabled=!1,this.vmSettingsSpec.haPdlProtection=this.clusterOverridesData.vmcpSettings.pdlResponse},e.prototype.setDefaultHaApdProtection=function(){this.vmSettingsSpec.haApdProtectionEnabled=!1,this.vmSettingsSpec.haApdProtection=this.clusterOverridesData.vmcpSettings.apdResponse},e.prototype.setDefaultHaApdDelay=function(){this.vmSettingsSpec.haApdDelayEnabled=!1,this.updateApdDelayValue()},e.prototype.setDefaultHaApdVmRecovery=function(){this.vmSettingsSpec.haApdVmRecoveryEnabled=!1,this.updateApdVmRecoveryValue()},e.prototype.setDefaultHaVmMonitoring=function(){this.vmSettingsSpec.haVmMonitoringEnabled=!1,this.vmSettingsSpec.haVmMonitoring=this.clusterOverridesData.vmMonitoring},e.prototype.setDefaultHaVmMonitoringSensitivity=function(){this.vmSettingsSpec.haVmMonitoringSensitivity=this.getDefaultHaVmMonitoringSensitivity()},e.prototype.setDefaultHaVmMonitoringFailureInterval=function(){this.vmSettingsSpec.vmToolsMonitorFailureInt=this.clusterOverridesData.vmToolsMonitorFailureInt},e.prototype.setDefaultHaVmMonitoringMinUpTime=function(){this.vmSettingsSpec.vmToolsMonitorMinUpTime=this.clusterOverridesData.vmToolsMonitorMinUpTime},e.prototype.setDefaultHaVmMonitoringMaxFailures=function(){this.vmSettingsSpec.vmToolsMonitorMaxFailures=this.clusterOverridesData.vmToolsMonitorMaxFailures},e.prototype.getDefaultHaVmMonitoringSensitivity=function(){var e=this.clusterOverridesData.vmToolsMonitorMaxFailureWindow!==this.haConstants.vmMonitoringSensitivity.NO_FAILURE_WINDOW,t=angular.merge({},this.clusterOverridesData,{vmToolsMonitorHasFailureWindow:e,vmToolsMonitorMaxFailureWindow:this.clusterOverridesData.vmToolsMonitorMaxFailureWindow/3600});return this.haVmMonitoringService.getHaMonitoringSensitivityLevel(t)},e.prototype.setDefaultHaVmMonitoringMaxFailuresWindow=function(){var e=this.clusterOverridesData.vmToolsMonitorMaxFailureWindow;e!==this.haConstants.vmMonitoringSensitivity.NO_FAILURE_WINDOW?(this.vmSettingsSpec.vmToolsMonitorHasFailureWindow=!0,this.vmSettingsSpec.vmToolsMonitorMaxFailureWindow=this.clusterOverridesData.vmToolsMonitorMaxFailureWindow/3600):(this.vmSettingsSpec.vmToolsMonitorHasFailureWindow=!1,this.vmSettingsSpec.vmToolsMonitorMaxFailureWindow=1)},e.prototype.getSelectedVmsHaProperties=function(e){return this.getSelectedVmsProperties("haOverrides",e)},e.prototype.getSelectedVmsDrsProperties=function(e){return this.getSelectedVmsProperties("drsOverrides",e)},e.prototype.getSelectedVmsProperties=function(e,t){return this.hasSelectedVm()&&angular.isDefined(this.selectedVms[0][e])?_.map(this.selectedVms,function(i){return{vm:i.vm,value:i[e][t]}}):null},e.prototype.isEditMode=function(){return this.vmSettingsSpec.mode===this.clusterVmOverridesConstants.operationType.EDIT},e.prototype.setPageBusy=function(e){this.loading=e},e.prototype.getSelectedVmsOrchestrationReadyConditions=function(){var e=this;if(this.hasSelectedVm()){var t=_.map(this.selectedVms,function(t){var i=e.findOrchestrationInfoForVm(t);return{vm:{name:t.vm.name},value:_.isUndefined(i)||"useClusterDefault"===i.vmReadiness.readyCondition?e.clusterVmOverridesConstants.CLUSTER_DEFAULT:i.vmReadiness.readyCondition}});return t}return[]},e.prototype.getSelectedVmsOrchestrationPostReadyDelays=function(){var e=this;if(this.hasSelectedVm()){var t=_.map(this.selectedVms,function(t){var i=e.findOrchestrationInfoForVm(t);return{vm:{name:t.vm.name},value:_.isUndefined(i)||i.vmReadiness.postReadyDelay===-1||_.isUndefined(i.vmReadiness.postReadyDelay)?e.clusterVmOverridesConstants.CLUSTER_DEFAULT:i.vmReadiness.postReadyDelay}});return t}return[]},e.$inject=["dataService","i18nService","clusterConfigVmOverrideService","drsAutomationLevelService","vcService","haConstants","haHostFailureResponseService","haHostIsolationResponseService","haPdlResponseService","haApdResponseService","haVmReactionsOnApdClearedService","clusterVmOverridesConstants","clusterConstants","haVmMonitoringService","defaultUriSchemeUtil","$q"],
e}(),i=function(){function e(){this.controller=t,this.templateUrl="cluster-ui/resources/cluster/views/settings/configuration/overrides/configClusterVmOverridesComponent.html",this.bindings={spec:"<",selectedVms:"<"}}return e}();angular.module("com.vmware.vsphere.client.cluster").component("configClusterVmOverridesComponent",new i)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.clusterVmOverridesPageService=r,this.clusterVmOverridesConstants=n,this.defaultUriSchemeUtil=o,this.objectId=e.modalOptions.dialogData.objectId;var s=e.modalOptions.dialogData.selectedOverrides,c=n.operationType.EDIT;this.selectedVmsSpec={objectId:this.objectId,vms:[]},this.selectedVmsSpec.vms=s,this.vmSettingsSpec={objectId:this.objectId,mode:c},e.modalOptions.onSubmit=function(){return a.onCommit()}}return e.prototype.onCommit=function(){if(this.validate()){var e=_.map(this.selectedVmsSpec.vms,function(e){var t=angular.extend({},e.vm.provider,{_type:"com.vmware.vim.binding.vmodl.ManagedObjectReference"});return{skipFromOrchestrationSpec:e.skipFromOrchestrationSpec,arrayOperation:e.arrayOperation,key:t,haOverrides:e.haOverrides,drsOverrides:e.drsOverrides}});return this.clusterVmOverridesPageService.applyOverrides(this.objectId,e,this.vmSettingsSpec),!0}return!1},e.prototype.validate=function(){return this.$scope.modalOptions.alerts=[],this.$scope.modalOptions.isAlertClosed=!0,!(!this.clusterVmOverridesPageService.hasOverrides(this.vmSettingsSpec)&&this.vmSettingsSpec.mode!==this.clusterVmOverridesConstants.operationType.EDIT)||(this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("ClusterUi","vm.overrides.config.noChangesValidationError"),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,!1)},e.$inject=["$scope","i18nService","vuiConstants","clusterVmOverridesPageService","clusterVmOverridesConstants","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("ConfigVmOverrideDialogController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.$element=t,this.$document=i,this.vxValueInUnitsService=r,e.$watch("$ctrl.recommendedValues",function(){n.highlightValue()})}return e.prototype.$onInit=function(){this.ngModelController.$render=this.modelValueChanged.bind(this)},e.prototype.$postLink=function(){this.installDocumentClickEvent()},e.prototype.updateModelFromField=function(){this.ngModelController.$setViewValue(this.value)},e.prototype.onBlurValueChanged=function(){this.valueChangedCallback&&"function"==typeof this.valueChangedCallback&&this.valueChangedCallback({value:this.value})},e.prototype.setModelValue=function(e){this.ngModelController.$setViewValue(e),this.modelValueChanged(),this.highlightValue()},e.prototype.clickDropdownButton=function(){this.recommendedValuesExpanded=!this.recommendedValuesExpanded,this.vxValueInUnitsService.onRecommendedValuesExpandedChange(this.$element)},e.prototype.modelValueChanged=function(){this.value=this.ngModelController.$viewValue},e.prototype.installDocumentClickEvent=function(){var e=this,t=function(t){e.$element===t.target||e.$element[0].contains(t.target)||e.$scope.$apply(function(){e.recommendedValuesExpanded=!1})};this.$document.on("click",t),this.$scope.$on("$destroy",function(){e.$document.off("click",t)})},e.prototype.highlightValue=function(){var e=this,t=!1;_.each(this.recommendedValues,function(i){i.value!==e.ngModelController.$viewValue||t?i.isHighlighted=!1:(i.isHighlighted=!0,t=!0)})},e.$inject=["$scope","$element","$document","vxValueInUnitsService"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="cluster-ui/resources/cluster/views/settings/configuration/overrides/overrideOptionsCombobox.html",this.bindings={valueChangedCallback:"&",isDisabled:"<",recommendedValues:"<"},this.require={ngModelController:"ngModel"}}return e}();angular.module("com.vmware.vsphere.client.cluster").component("overrideOptionsCombobox",new i)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t;var i=e.manager.getClusterId(),r=e.manager.getSelectedVms(),n={objectType:"VirtualMachine",listViewId:"vsphere.core.vm.list"},o="clusterVmsExceptOverriddenVmsFilter";this.config={contextObject:i,multipleSelect:!0,listTabConfig:{listConfig:[{label:t.getString("Common","typeResource.vmPlural"),listViewId:n.listViewId,dataModels:[n.objectType],filterId:o}]},selectedObjects:_.map(r,function(e){return e.id}),onSelectionChanged:function(t){e.manager.setSelectedVms(t)}}}return e.prototype.$onInit=function(){setTimeout(function(){$("div.cluster-add-vm-override-member-container [vx-object-selector] div.filter-input input").focus()},200)},e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("SelectClusterVmOverrideMemberController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.clusterVmOverridesPageService=r,this.clusterVmOverridesConstants=n,this.defaultUriSchemeUtil=o,this.objectId=e.manager.getClusterId(),this.vmSettingsSpec={objectId:this.objectId,mode:n.operationType.ADD},this.selectedVmsSpec={objectId:this.objectId,vms:[]},e.manager.setSelectedVmsSpec(this.selectedVmsSpec),e.manager.setVmSettingsSpec(this.vmSettingsSpec),this.populateVms()}return e.prototype.populateVms=function(){var e=this;this.clusterVmOverridesPageService.populateVmFtRole(this.$scope.manager.getSelectedVms()).then(function(t){e.selectedVmsSpec.vms=t})},e.$inject=["$scope","i18nService","vuiConstants","clusterVmOverridesPageService","clusterVmOverridesConstants","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("SelectClusterVmOverridesController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(){return{restrict:"A",link:function(e,t){setTimeout(function(){t.find("input[type='checkbox']:enabled").first().focus()},200)}}}angular.module("com.vmware.vsphere.client.cluster").directive("vmOverridesAutofocus",e)}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(){c.updateActionBar(f.gridOptions,[S],y).then(function(e){P=e})}function d(){P&&c.updateActionBar(f.gridOptions,[S],y,P)}function u(e){var t={actionBarOptions:{actions:[]},pageConfig:{hidePager:!0},resizable:!0,data:[],selectionMode:o.grid.selectionMode.MULTI,selectedItems:[],columnDefs:v(e),height:"100%",showCheckboxesOnMultiSelection:!1};return t}function p(e){var t=_.find(e,function(e){return null!==e.haOverrides.vmMonitoringWarningText});return t?t.haOverrides.vmMonitoringWarningText:null}function v(e){var t=[{displayName:i.getString("ClusterUi","vmOverrides.vmNameHeaderText"),field:"vm.name",type:"string",template:'<span class="object" title="#:vm.name#"><i class="#:vm.primaryIconId#")></i>#:vm.name#</span>'},{displayName:i.getString("ClusterUi","vmOverrides.drsAutomationLevelHeaderText"),field:"drsOverrides.drsAutomationLevelText",type:"string",template:'<span title="#:drsOverrides.drsAutomationLevelText#">#:drsOverrides.drsAutomationLevelText#</span>'},{displayName:i.getString("ClusterUi","vmOverrides.haRestartPriorityHeaderText"),field:"haOverrides.haRestartPriorityText",type:"string",template:'<span title="#:haOverrides.haRestartPriorityText#">#:haOverrides.haRestartPriorityText#</span>'}];return e&&t.push({displayName:i.getString("ClusterUi","vmOverrides.haRestartConditionHeaderText"),field:"haOverrides.haRestartConditionsText",type:"string",template:'<span title="#:haOverrides.haRestartConditionsText#">#:haOverrides.haRestartConditionsText#</span>'}),t=t.concat([{displayName:i.getString("ClusterUi","vmOverrides.haHostIsolationResponseHeaderText"),field:"haOverrides.haIsolationResponseText",type:"string",template:'<span title="#:haOverrides.haIsolationResponseText#">#:haOverrides.haIsolationResponseText#</span>'},{displayName:i.getString("ClusterUi","vmOverrides.vmHostHeaderText"),field:"vm.host",type:"string",template:m}])}function m(e){if(_.isNull(e.vm.host))return"";var t='<span class="'+e.vm.host.primaryIconId+'"></span>',i=a.generateObjectLink(r.getVsphereObjectId(e.vm.host.provider),e.vm.host.name);return t+i}function g(e){return e&&0!==e.length?void(f.selectedOverrides=e):void(f.selectedOverrides=null)}function h(e){var t=!1;return f.selectedOverrides&&e&&(t=_.some(f.selectedOverrides,function(t){return t.vm.name===e.vm.name&&(t.vm.host&&e.vm.host&&t.vm.host.name===e.vm.host.name||!t.vm.host&&!e.vm.host)})),t}var f=this,S=e._route.objectId;f.watchForObjects=[S],f.liveRefreshProperties=["configurationEx.drsConfig.enabled","configurationEx.drsConfig.defaultVmBehavior","configurationEx.drsConfig.enableVmBehaviorOverrides","configurationEx.dasConfig.enabled","configurationEx.dasConfig.vmComponentProtecting","configurationEx.dasConfig.vmMonitoring","configurationEx.dasConfig.defaultVmSettings.isolationResponse","configurationEx.dasConfig.defaultVmSettings.vmComponentProtectionSettings.vmTerminateDelayForAPDSec","configurationEx.dasConfig.defaultVmSettings.vmComponentProtectionSettings.vmReactionOnAPDCleared","configurationEx.dasConfig.defaultVmSettings.vmComponentProtectionSettings.vmStorageProtectionForPDL","configurationEx.dasConfig.defaultVmSettings.vmComponentProtectionSettings.vmStorageProtectionForAPD","configurationEx.dasConfig.defaultVmSettings.restartPriority","configurationEx.dasConfig.defaultVmSettings.restartPriorityTimeout","configurationEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.failureInterval","configurationEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.maxFailureWindow","configurationEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.maxFailures","configurationEx.dasConfig.defaultVmSettings.vmToolsMonitoringSettings.minUpTime","configurationEx.orchestration.defaultVmReadiness.postReadyDelay","configurationEx.orchestration.defaultVmReadiness.readyCondition","configurationEx.drsVmConfig","configurationEx.dasVmConfig","configurationEx.vmOrchestration","summary.currentEVCModeKey"],f.gridTitle=i.getString("ClusterUi","manage.settings.vmOverrides"),f.selectedOverrides=null,f.vmMonitoringWarningMessage=null;var y=[{actionId:"vsphere.core.cluster.actions.vmOverride.add"},{actionId:"vsphere.core.cluster.actions.vmOverride.edit",getActionInvocationContext:function(){return{selectedOverrides:f.selectedOverrides}},isActionAvailable:function(e){return e.available&&!_.isEmpty(f.gridOptions.selectedItems)&&(1===f.gridOptions.selectedItems.length||!_.some(f.gridOptions.selectedItems,function(e){return e.vm&&e.vm.ftVm}))}},{actionId:"vsphere.core.cluster.actions.vmOverride.delete",getActionInvocationContext:function(){return{selectedOverrides:f.selectedOverrides}},isActionAvailable:function(e){return e.available&&!_.isEmpty(f.gridOptions.selectedItems)&&_.every(f.gridOptions.selectedItems,function(e){return e.vm.ftVm===!1})}}],P=null;f.getViewData=function(){n.getVmOverridesData(S).then(function(e){f.gridOptions.data=e.overrides,f.vmMonitoringWarningMessage=p(e.overrides)})},s.is65VcOrLater(S).then(function(e){f.gridOptions=u(e),f.getViewData(),l(),t.$watch("ctrl.gridOptions.selectedItems",g)}),t.overridesPreselectComparator=h,t.$watch(function(){return f.selectedOverrides},function(){d(),f.selectedOverrides&&1===f.selectedOverrides.length&&f.selectedOverrides[0].haOverrides?f.propertyGrid=n.buildPropertyView(f.selectedOverrides[0].haOverrides):f.propertyGrid=null})}angular.module("com.vmware.vsphere.client.cluster").controller("VmOverridesController",e),e.$inject=["$rootScope","$scope","i18nService","defaultUriSchemeUtil","clusterVmOverridesService","vuiConstants","linksUtil","vcService","datagridActionBarService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(){S.getViewData(),S.drsConfigAccessor&&S.drsConfigAccessor.refresh&&S.drsConfigAccessor.refresh()}function d(){t.getData(y,"com.vmware.vsphere.client.clusterui.model.services.DrsConfigData",{queryName:"DrsController."+d.name}).then(function(e){S.drsData=e?v(e):{},S.dpm=e?m(e):{},S.policies=e?h(e):{},e&&(S.headerOptions.title=p(e.drsEnabled));var t=!!S.drsData.advancedOptions&&S.drsData.advancedOptions.length>0;S.advancedOptionsText=f(t?"drs.config.advancedOptionsCollapsedText.show":"drs.config.advancedOptionsCollapsedText.none")})}function u(){s.is65VcOrLater(y).then(function(e){S.is65VcOrLater=e})}function p(e){return f(e?"drs.config.drsEnabled":"drs.config.drsDisabled")}function v(e){var t=r.getLevelByKey(e.defaultDrsBehavior);return e.drsAutomationLevelText=t.label,e.drsAutomationLevelDescription=t.description,e.migrationThresholdText=n.getText(e.migrationThreshold),e.migrationThresholdDescription=n.getDescription(e.migrationThreshold),e.predictiveDrsText=g(e),e.vmAutomationText=f(e.vmAutomationEnabled?"drs.config.vmAutomation.enabled":"drs.config.vmAutomation.disabled"),e}function m(e){var t=o.getText(e.dpmEnabled,e.defaultDpmBehavior),i=o.getDescription(e.dpmEnabled,e.defaultDpmBehavior),r=a.reverseDpmRateAndThreshold(e.dpmRate),n=a.getText(e.dpmEnabled,r);return{automationLevel:t,automationLevelDescription:i,threshold:n}}function g(e){return f(e.proactiveDrsEnabled?"drs.portlet.migration.forecastedMetrics.enabled":"drs.portlet.migration.forecastedMetrics.disabled")}function h(e){var t=c.getEvenDistributionLabel(e),i=c.getConsumedOrActiveMemoryLabel(e),r=c.getCpuOverCommitmentLabel(e);return{evenDistributionLabel:t,consumedOrActiveMemoryLabel:i,cpuOverCommitmentLabel:r}}function f(){var e=Array.prototype.slice.call(arguments);return i.getString.apply(i,["ClusterUi"].concat(e))}var S=this,y=e._route.objectId;S.headerOptions={title:i.getString("ClusterUi","services.drs"),objectId:y,actions:[{actionUid:"vsphere.core.cluster.actions.scheduleDrs",customLabel:i.getString("ClusterUi","drs.config.scheduleDrs.button.label")},{actionUid:"vsphere.core.cluster.actions.restoreRpTree",customLabel:i.getString("ClusterUi","drs.config.restore.rp.tree.action.label")},{actionUid:"vsphere.core.cluster.actions.editDrs",customLabel:i.getString("ClusterUi","general.config.button.edit")}]},S.watchForObjects=[y],S.liveRefreshProperties=["configurationEx.drsConfig.enabled","configurationEx.drsConfig.enableVmBehaviorOverrides","configurationEx.drsConfig.defaultVmBehavior","configurationEx.drsConfig.option","configurationEx.drsConfig.vmotionRate","configurationEx.dpmConfigInfo.defaultDpmBehavior","configurationEx.dpmConfigInfo.enabled","configurationEx.dpmConfigInfo.hostPowerActionRate","configurationEx.proactiveDrsConfig.enabled"],S.getViewData=d,S.getString=f,S.refreshUi=l,S.advancedOptionsLabel=f("drs.config.advancedOptionsLabel"),S.configParametersLabel=f("drs.config.advancedOptions.configParametersLabel"),S.is65VcOrLater=!1,S.drsConfigAccessor={},d(),u()}angular.module("com.vmware.vsphere.client.cluster").controller("DrsController",e),e.$inject=["$scope","dataService","i18nService","drsAutomationLevelService","drsMigrationThresholdService","dpmAutomationLevelService","dpmThresholdService","vcService","drsPoliciesService"]}(),function(){"use strict";function e(e,t,i,r){function n(){return{title:i.getString("ClusterUi","manage.settings.evc.description"),objectId:d,actions:[{actionUid:"vsphere.core.cluster.actions.editEvcMode",customLabel:i.getString("ClusterUi","general.config.button.edit")}]}}function o(){t.getData(d,"com.vmware.vsphere.client.clusterui.model.configuration.EvcConfigData").then(function(e){s(e),l.evcData=e,l.headerOptions.title=a(e.evcModeKey)})}function a(e){return e?i.getString("ClusterUi","evc.config.evcEnabledLabel"):i.getString("ClusterUi","evc.config.evcDisabledLabel")}function s(e){e.evcModeKey&&e.currentEvcMode&&(l.datagridOptions={columnDefs:[{field:"register",displayName:i.getString("ClusterUi","evc.config.registerColumnName"),sortable:!1,template:function(e){var t=$("<span></span>").text(e.register);return e.isLeaf&&t.addClass("cpuid-leaf"),t[0].outerHTML}},{field:"value",displayName:i.getString("ClusterUi","evc.config.valueColumnName"),sortable:!1}],pageConfig:{hidePager:!0},searchable:!1,selectedItems:[],data:c(e.currentEvcMode.guaranteedCPUFeatures),dataBound:function(){r.find("[vui-datagrid] .k-grid-content").css("height","")}})}function c(e){var t=[];return e.forEach(function(e){var r=e.level;r<0&&(r=4294967295+r+1);var n={register:i.getString("ClusterUi","evc.config.cpuidFeaturesFlagLeafLabel",r.toString(16)),value:"",isLeaf:!0};t.push(n);var o={register:"eax",value:e.eax};t.push(o);var a={register:"ebx",value:e.ebx};t.push(a);var s={register:"ecx",value:e.ecx};t.push(s);var c={register:"edx",value:e.edx};t.push(c)}),t}var l=this,d=e._route.objectId;l.headerOptions=n(),l.watchForObjects=[d],l.liveRefreshProperties=["summary.currentEVCModeKey","supportedEvcMode"],l.getViewData=o,o()}angular.module("com.vmware.vsphere.client.cluster").controller("EvcController",e),e.$inject=["$scope","dataService","i18nService","$element"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.$scope=e,this.i18nService=t,this.dataService=i,this.hostOptionsService=r,this.defaultUriSchemeUtil=n,this.dpmAutomationLevelService=o,this.mutationService=a,this.$q=s,this.isAlertClosed=!0,this.hostId=e.modalOptions.dialogData.selectedHost,this.clusterId=e.modalOptions.dialogData.clusterRef,this.dpmBehaviors=r.getDpmBehaviors(),this.loading=!0,e.modalOptions.onSubmit=this.onSubmit.bind(this),this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getData(this.hostId,"com.vmware.vsphere.client.clusterui.model.services.HostOptionsConfigInfoData").then(function(t){t&&(e.bmcConfigData=t.ipmiInfo,e.defaultIpmiSettings=angular.merge({},t.ipmiInfo),e.powerManagementConfig={hostId:e.hostId},e.hostOptionsService.setSelectedDpmBehavior(t.clusterDpmConfigData,e.powerManagementConfig)),e.loading=!1})["catch"](function(t){e.loading=!1,e.$q.reject(t)})},e.prototype.onSubmit=function(){if(this.bmcConfigData&&!_.isEqual(this.bmcConfigData,this.defaultIpmiSettings)){this.bmcConfigData.password||(this.bmcConfigData.password="");var e=this.hostOptionsService.validatePowerConfigSoftwareSpec(this.bmcConfigData);if(0!==e.length)return this.$scope.modalOptions.alerts=this.hostOptionsService.showValidationMessages(e),this.isAlertClosed=!1,!1;this.mutationService.apply(this.hostId,"com.vmware.vsphere.client.h5.host.config.spec.PowerConfigSoftwareSpec",this.bmcConfigData)}if(this.powerManagementConfig.defaultDpmOverride!==this.powerManagementConfig.powerManagementOverride||this.powerManagementConfig.defaultDpmBehavior!==this.powerManagementConfig.selectedDpmBehavior){var t=this.hostOptionsService.createDpmHostConfigSpec(this.powerManagementConfig),i=this.hostOptionsService.createClusterSpec([t]);this.mutationService.apply(this.clusterId,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",i)}return!0},e.prototype.updatePowerManagementlValue=function(){this.powerManagementConfig.powerManagementOverride||(this.powerManagementConfig.selectedDpmBehavior=this.powerManagementConfig.defaultDpmBehavior)},e.$inject=["$scope","i18nService","dataService","hostOptionsService","defaultUriSchemeUtil","dpmAutomationLevelService","mutationService","$q"],e}();e.EditHostOptionsController=t,angular.module("com.vmware.vsphere.client.cluster").controller("EditHostOptionsController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.$scope=e,this.i18nService=t,this.dataService=i,this.hostOptionsService=r,this.$q=n,this.hostOptionsPreselectComparator=function(e){return o.selectedItem&&e&&o.selectedItem.name===e.name},this.objectId=e._route.objectId,this.liveRefreshProperties=["configurationEx.dpmConfigInfo.enabled","configurationEx.dpmConfigInfo.defaultDpmBehavior","configurationEx.dpmHostConfig"],this.headerOptions={title:t.getString("ClusterUi","manage.settings.hostOptions"),actions:[],objectIds:[this.objectId]},this.datagridOptions=r.getDatagridOptions(),this.getData(),r.createActionBar(this.datagridOptions,this.objectId).then(function(e){o.actionBarCacheObject=e}),this.preselectDatagridItem(),this.refreshActionBarOnSelect()}return e.prototype.getData=function(){var e=this;this.dataService.getData(this.objectId,"com.vmware.vsphere.client.clusterui.model.services.ClusterHostOptionsConfigData").then(function(t){t&&e.$q.when(e.hostOptionsService.parseHostOptionsData(t)).then(function(t){t&&(e.datagridOptions.data=t,e.keepPreselection())})})},e.prototype.refreshActionBarOnSelect=function(){var e=this;this.$scope.$watch(function(){return e.selectedItem},function(){e.hostOptionsService.refreshActionBar(e.datagridOptions,e.objectId,e.actionBarCacheObject)})},e.prototype.preselectDatagridItem=function(){var e=this;this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t){return t&&0!==t.length?void(e.selectedItem&&e.selectedItem.name===t[0].name||(e.selectedItem=t[0])):void(e.selectedItem=null)})},e.prototype.keepPreselection=function(){var e=this;this.selectedItem&&this.datagridOptions.data.length>0&&(this.datagridOptions.selectedItems[0]=_.find(this.datagridOptions.data,function(t){return e.selectedItem.name===t.name}))},e.$inject=["$scope","i18nService","dataService","hostOptionsService","$q"],e}();e.HostOptionsController=t,angular.module("com.vmware.vsphere.client.cluster").controller("HostOptionsController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o){return{restrict:"AE",templateUrl:"cluster-ui/resources/cluster/views/settings/rules/addAffinityRule.html",scope:{spec:"="},controller:["$scope",function(a){function s(){r.updateActionBar(a.vmAffinityGridOptions,[u],p).then(function(e){v=e})}function c(){v&&r.updateActionBar(a.vmAffinityGridOptions,[u],p,v)}function l(){var e={actionBarOptions:{actions:[]},searchable:!1,resizable:!1,data:a.spec.vmAffinityData,selectionMode:i.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],columnDefs:[{displayName:t.getString("ClusterUi","rules.members.list.name"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'}],height:"100%",pageConfig:{hidePager:!0}};return e}function d(){return a.spec.ruleType===o.ruleSpec.VM_AFFINITY_RULE?t.getString("ClusterUi","rules.config.type.vmAffinity.desc"):t.getString("ClusterUi","rules.config.type.vmAntiAffinity.desc")}var u=e._route.objectId;a.descriptionTitle=t.getString("Common","rules.config.description"),a.gridTitle=t.getString("ClusterUi","rules.members.list.name"),a.spec.vmAffinityData=[],a.spec.members&&a.spec.members.length>0&&n.getAffinityRulesMembersData(a.spec).then(function(e){a.spec.vmAffinityData=e,a.vmAffinityGridOptions.data=e}),a.vmAffinityGridOptions=l();var p=[{actionId:"vsphere.core.cluster.actions.rule.members.add",getActionInvocationContext:function(){return{selectedMembers:a.spec.vmAffinityData,dialogSubTitleObject:{objectId:u},submitCallback:function(e){return void 0!==e.dialogData.selectedItems&&(a.vmAffinityGridOptions.data=a.vmAffinityGridOptions.data.concat(e.dialogData.selectedItems),a.spec.vmAffinityData=a.vmAffinityGridOptions.data),!0}}}},{actionId:"vsphere.core.cluster.actions.rule.members.remove",getActionInvocationContext:function(){return{isExistingRule:!1,rule:null,membersToRemove:a.vmAffinityGridOptions.selectedItems,confirmCallback:function(){return a.vmAffinityGridOptions.data=a.spec.vmAffinityData=_.filter(a.vmAffinityGridOptions.data,function(e){return _.every(a.vmAffinityGridOptions.selectedItems,function(t){return e.id!==t.id})}),!0}}},isActionAvailable:function(e){return e.available&&a.vmAffinityGridOptions.selectedItems.length>0}}],v=null;a.$watch("vmAffinityGridOptions.selectedItems",function(){c()}),a.$watch("spec.ruleType",function(){a.descriptionLabel=d()}),s()}]}}angular.module("com.vmware.vsphere.client.cluster").directive("addAffinityRule",e),e.$inject=["$rootScope","i18nService","vuiConstants","datagridActionBarService","clusterRulesService","clusterRulesConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(){l.is65VcOrLater(g).then(function(e){m.typeOptions=o.getRuleTypes(e)})}function u(e){return t.getString("ClusterUi",e)}function p(){if(!m.spec.name)return e.modalOptions.alerts=[{text:u("rules.config.error.nameEmpty"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(/^\s*$/gi.test(m.spec.name))return e.modalOptions.alerts=[{text:u("rules.config.error.nameEmpty"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(m.spec.name.length>80)return e.modalOptions.alerts=[{text:u("rules.config.error.nameTooLong"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if((m.spec.ruleType===s.ruleSpec.VM_AFFINITY_RULE||m.spec.ruleType===s.ruleSpec.VM_ANTIAFFINITY_RULE)&&m.spec.vmAffinityData.length<2)return e.modalOptions.alerts=[{text:u("rules.config.members.error.noMembers"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();var t=null;if(m.spec.ruleType===s.ruleSpec.VM_HOST_GROUP_RULE){if(!m.spec.selectedVmGroup)return e.modalOptions.alerts=[{text:u("rules.config.error.noSelectedVmGroup"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(m.spec.invalidVmGroup)return e.modalOptions.alerts=[{text:u("rules.config.relationTypes.selectVmGroup"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(!m.spec.selectedHostGroup)return e.modalOptions.alerts=[{text:u("rules.config.error.noSelectedHostGroup"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();if(m.spec.invalidHostGroup)return e.modalOptions.alerts=[{text:u("rules.config.relationTypes.selectHostGroup"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();t={vmGroupName:m.spec.selectedVmGroup,hostGroupName:m.spec.selectedHostGroup,isMandatory:m.spec.selectedVmToHostRuleType.isMandatory,isAffineHostGroupName:m.spec.selectedVmToHostRuleType.isAffineHostGroupName}}if(m.spec.ruleType===s.ruleSpec.VM_DEPENDENCY_RULE){if(!m.spec.selectedVmGroup||!m.spec.selectedDependsOnVmGroup)return e.modalOptions.alerts=[{text:u("rules.config.error.noSelectableVmGroup"),type:r.validationBanner.type.ERROR}],e.modalOptions.isAlertClosed=!1,i.reject();t={vmGroup:m.spec.selectedVmGroup,dependsOnVmGroup:m.spec.selectedDependsOnVmGroup}}var a=null;m.spec.operation===s.operationType.EDIT&&(a=m.spec.key),m.ruleSpec=o.buildRuleSpec(m.spec.ruleType,m.spec.name,m.spec.enabled,_.map(m.spec.vmAffinityData,function(e){return c.getManagedObjectReference(e.id)}),t,m.spec.operation,a);var l=n.validate(g,"com.vmware.vim.binding.vim.cluster.RuleSpec",m.ruleSpec).then(function(t){return e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,!t||t.result&&!t.error?i.resolve():"NAME_ERROR"===t.result?(e.modalOptions.alerts.push({text:u("rules.error.nameNotUnique"),type:r.validationBanner.type.ERROR}),e.modalOptions.isAlertClosed=!1,i.reject()):"RULE_CONFLICT_ERROR"===t.result?m.spec.enabled?(e.modalOptions.alerts.push({text:u("rules.error.ruleConflicts"),type:r.validationBanner.type.ERROR}),e.modalOptions.isAlertClosed=!1,m.spec.enabled=!1,i.reject()):i.resolve():void 0});return l}function v(){return p().then(function(){var e=a.buildClusterComputeResourceSpec({rule:m.ruleSpec},!0);return n.apply(g,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",e),!0})["catch"](function(e){return!1})}var m=this,g=e._route.objectId;m.isRuleTypeSelectDisabled=!1,e.modalOptions.isAlertClosed=!0,e.modalOptions.dialogData&&e.modalOptions.dialogData.rule?(m.spec=e.modalOptions.dialogData.rule,m.spec.ruleType=o.getSpecTypeByRuleType(e.modalOptions.dialogData.rule.type),m.spec.operation=s.operationType.EDIT,m.isRuleTypeSelectDisabled=!0):(m.spec={},m.spec.ruleType=o.DEFAULT_TYPE,m.spec.name="",m.spec.enabled=!0,m.spec.operation=s.operationType.ADD),d(),e.modalOptions.onSubmit=function(){return v()}}angular.module("com.vmware.vsphere.client.cluster").controller("AddClusterRuleController",e),e.$inject=["$scope","i18nService","$q","vuiConstants","mutationService","clusterRulesService","clusterSpecBuilderService","clusterRulesConstants","defaultUriSchemeUtil","vcService"]}(),function(){"use strict";function e(e,i){var r=e.modalOptions.dialogData.objectId,n=e.modalOptions.dialogData,o=t(n.selectedVms),a={objectType:"VirtualMachine",listViewId:"vsphere.core.vm.list"},s="clusterVmsExceptSecondaryVmsExcludeVmsFilter";0===o.length&&(s="clusterVmsExceptSecondaryVmsFilter"),this.config={contextObject:r,multipleSelect:!0,listTabConfig:{listConfig:[{label:i.getString("Common","typeResource.vmPlural"),listViewId:a.listViewId,dataModels:[a.objectType],filterId:s,filterParams:o}]},onSelectionChanged:function(e){n.selectedItems=e}}}function t(e){return _.map(e,function(e){return e.id})}angular.module("com.vmware.vsphere.client.cluster").controller("AddClusterRuleMemberController",e),e.$inject=["$scope","i18nService"]}(),function(){"use strict";function e(e,t,i,r){return{restrict:"A",templateUrl:"cluster-ui/resources/cluster/views/settings/rules/addVmDependencyRule.html",scope:{spec:"="},controller:["$scope",function(n){function o(){null===n.spec.selectedDependsOnVmGroup||null===n.spec.selectedVmGroup?n.ruleDescription=t.getString("ClusterUi","rules.config.relationTypes.selectVmGroup"):n.ruleDescription=t.getString("ClusterUi","rules.config.type.vmToVM.desc",n.spec.selectedDependsOnVmGroup,n.spec.selectedVmGroup)}function a(){var e=[];return i.getGroupsData(s).then(function(t){t.forEach(function(t){t.rawType===r.groupType.VM_GROUP&&e.push(t)}),n.dependsOnVmGroups=e,e.length>0&&("edit"===n.spec.operation?n.spec.selectedDependsOnVmGroup=n.spec.vmDependencyRuleProperties&&n.spec.vmDependencyRuleProperties.dependsOnVmGroup?n.spec.vmDependencyRuleProperties.dependsOnVmGroup:null:n.spec.selectedDependsOnVmGroup=e[0].name)})}var s=e._route.objectId;n.dependsOnVmGroups=[],n.vmGroups=[],n.spec.selectedDependsOnVmGroup=null,n.spec.selectedVmGroup=null,a(),n.$watch("spec.selectedDependsOnVmGroup",function(e){e&&(n.vmGroups=n.dependsOnVmGroups.filter(function(t){return t.name!==e}),n.vmGroups.length>0&&("edit"!==n.spec.operation||n.spec.selectedVmGroup?n.spec.selectedVmGroup=n.vmGroups[0].name:n.spec.selectedVmGroup=n.spec.vmDependencyRuleProperties&&n.spec.vmDependencyRuleProperties.vmGroup?n.spec.vmDependencyRuleProperties.vmGroup:null))}),n.$watch("spec.selectedVmGroup",function(){o()}),n.ruleDescriptionTitle=t.getString("Common","rules.config.description"),n.dependsOnVmGroupTitle=t.getString("ClusterUi","rules.config.vmGroup2.text"),n.vmGroupTitle=t.getString("ClusterUi","rules.config.vmGroup1.label")}]}}angular.module("com.vmware.vsphere.client.cluster").directive("addVmDependencyRule",e),e.$inject=["$rootScope","i18nService","clusterGroupsService","clusterGroupsConstants"]}(),function(){"use strict";function e(e,t,i,r,n){return{restrict:"AE",templateUrl:"cluster-ui/resources/cluster/views/settings/rules/addVmToHostsRule.html",scope:{spec:"="},controller:["$scope",function(o){function a(){var e=[],t=[];return i.getGroupsData(l).then(function(i){i.forEach(function(i){i.rawType===r.groupType.VM_GROUP?e.push(i):i.rawType===r.groupType.HOST_GROUP&&t.push(i)}),o.vmGroups=e,e.length>0&&!o.spec.selectedVmGroup&&(o.spec.selectedVmGroup=e[0].name),o.hostGroups=t,t.length>0&&!o.spec.selectedHostGroup&&(o.spec.selectedHostGroup=t[0].name)})}function s(){var e=[{id:"hardAffinity",label:c("rules.config.relationTypes.hardAffinity.label"),isAffineHostGroupName:!0,isMandatory:!0},{id:"softAffinity",label:c("rules.config.relationTypes.softAffinity.label"),isAffineHostGroupName:!0,isMandatory:!1},{id:"hardAntiAffinity",label:c("rules.config.relationTypes.hardAntiAffinity.label"),isAffineHostGroupName:!1,
isMandatory:!0},{id:"softAntiAffinity",label:c("rules.config.relationTypes.softAntiAffinity.label"),isAffineHostGroupName:!1,isMandatory:!1}];return o.spec.selectedVmToHostRuleType=e[0],o.spec.operation===n.operationType.EDIT&&_.each(e,function(e){e.isMandatory===o.spec.vmToHostRuleProperties.isMandatory&&e.isAffineHostGroupName===o.spec.vmToHostRuleProperties.isAffineHostGroupName&&(o.spec.selectedVmToHostRuleType=e)}),e}function c(e){return t.getString("ClusterUi",e)}var l=e._route.objectId;o.ruleDescriptionTitle=t.getString("Common","rules.config.description"),o.vmGroupTitle=c("rules.config.vmGroup.label"),o.hostGroupTitle=c("rules.config.hostGroup.label"),o.vmGroups=[],o.hostGroups=[],o.spec.selectedVmGroup=null,o.spec.selectedHostGroup=null,o.vmToHostRuleTypeOptions=s(),o.spec.operation===n.operationType.EDIT&&(o.spec.selectedVmGroup=o.spec.vmToHostRuleProperties.vmGroupName,o.spec.selectedHostGroup=o.spec.vmToHostRuleProperties.hostGroupName),a().then(function(){o.$watchGroup(["spec.selectedVmGroup","spec.selectedHostGroup","spec.selectedVmToHostRuleType"],function(e){if(null===e[0])return void(o.ruleDescription=c("rules.config.relationTypes.selectVmGroup"));if(o.spec.invalidVmGroup=!_.some(o.vmGroups,function(t){return t.name===e[0]}),null===e[1])return void(o.ruleDescription=c("rules.config.relationTypes.selectHostGroup"));o.spec.invalidHostGroup=!_.some(o.hostGroups,function(t){return t.name===e[1]});var i=e[2];switch(i.id){case"hardAffinity":o.ruleDescription=t.getString("ClusterUi","rules.config.relationTypes.hardAffinity.desc",e[0],e[1]);break;case"softAffinity":o.ruleDescription=t.getString("ClusterUi","rules.config.relationTypes.softAffinity.desc",e[0],e[1]);break;case"hardAntiAffinity":o.ruleDescription=t.getString("ClusterUi","rules.config.relationTypes.hardAntiAffinity.desc",e[0],e[1]);break;case"softAntiAffinity":o.ruleDescription=t.getString("ClusterUi","rules.config.relationTypes.softAntiAffinity.desc",e[0],e[1])}})})}]}}angular.module("com.vmware.vsphere.client.cluster").directive("addVmToHostsRule",e),e.$inject=["$rootScope","i18nService","clusterGroupsService","clusterGroupsConstants","clusterRulesConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/rules/affinityRuleDetails.html",scope:{rule:"="},controller:["$scope","$rootScope",function(a,s){function c(){o.updateActionBar(a.ruleMembersGridOptions,[h],f).then(function(e){S=e})}function l(){S&&o.updateActionBar(a.ruleMembersGridOptions,[h],f,S)}function d(){var e={actionBarOptions:{actions:[]},searchable:!1,resizable:!0,data:[],columnDefs:p(),selectionMode:r.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],height:"100%",pageConfig:{hidePager:!0}};return e}function u(){var e={searchable:!1,resizable:!1,data:[],columnDefs:v(),height:"100%",pageConfig:{hidePager:!0}};return e}function p(){return[{displayName:e.getString("ClusterUi","rules.vmRuleDetails.ruleMembers"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'},{displayName:e.getString("ClusterUi","rules.vmRuleDetails.conflicts"),field:"conflictsCount",type:"string",template:'<span title="#:conflictsCount#">#:conflictsCount#</span>'}]}function v(){return[{displayName:e.getString("ClusterUi","rules.vmRuleDetails.conflicts"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'}]}function m(){var t="";return a.rule&&(a.rule.type===i.ruleType.VM_AFFINITY_RULE&&(t=e.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmAffinity",a.rule.members.length)),a.rule.type===i.ruleType.VM_ANTIAFFINITY_RULE&&(t=e.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmAntiAffinity",a.rule.members.length))),t}function g(){a.ruleMembersGridOptions.data=[],a.conflictingRulesGridOptions.data=[],a.rule&&(t.getAffinityRulesMembersData(a.rule).then(function(e){a.ruleMembersGridOptions.data=e}),a.conflictingRulesGridOptions.data=t.getConflictingRulesData(a.rule.conflictingRules)),a.ruleDetailsLabel=m()}var h=s._route.objectId;a.ruleMembersGridOptions=d(),a.conflictingRulesGridOptions=u(),a.ruleDetailsTitle=e.getString("ClusterUi","manage.settings.ruleDetails"),a.$watch("rule",g);var f=[{actionId:"vsphere.core.cluster.actions.rule.members.add",getActionInvocationContext:function(){return{selectedMembers:a.ruleMembersGridOptions.data,dialogSubTitleObject:{text:a.rule.name},submitCallback:function(i){return i.isAlertClosed=!0,i.alerts=[],_.isEmpty(i.dialogData.selectedItems)?(i.alerts=[{text:e.getString("CommonUi","objectSelectorDialog.noSelection"),type:r.validationBanner.type.ERROR}],i.isAlertClosed=!1,!1):t.addRuleMembers(h,a.rule,i.dialogData.selectedItems).then(function(){return!0})["catch"](function(){return!1})}}},isActionAvailable:function(e){return e.available&&!!a.rule}},{actionId:"vsphere.core.cluster.actions.rule.members.details",getActionInvocationContext:function(){return{selectedRule:a.rule,selectedMember:_.first(_.filter(a.rule.members,function(e){return n.getVsphereObjectId(e.entity)===a.ruleMembersGridOptions.selectedItems[0].id}))}},isActionAvailable:function(e){return e.available&&1===a.ruleMembersGridOptions.selectedItems.length&&a.ruleMembersGridOptions.selectedItems[0].conflictsCount>0}},{actionId:"vsphere.core.cluster.actions.rule.members.remove",getActionInvocationContext:function(){return{isExistingRule:!0,rule:a.rule,membersToRemove:a.ruleMembersGridOptions.selectedItems,confirmCallback:function(){return t.removeRuleMembers(h,a.rule,a.ruleMembersGridOptions.selectedItems),!0}}},isActionAvailable:function(e){return e.available&&a.ruleMembersGridOptions.selectedItems.length>0}}],S=null;a.$watch("ruleMembersGridOptions.selectedItems",function(){l()}),c()}]}}angular.module("com.vmware.vsphere.client.cluster").directive("affinityRuleDetails",e),e.$inject=["i18nService","clusterRulesService","clusterRulesConstants","vuiConstants","defaultUriSchemeUtil","datagridActionBarService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){m(e.modalOptions.dialogData.member.conflicts,e.modalOptions.dialogData.rule.name)}function s(e,t){var i={pageConfig:{hidePager:!0},searchable:!1,resizable:!1,data:[],selectionMode:t,showCheckboxesOnMultiSelection:!1,selectedItems:[],columnDefs:e,height:"100%"};return i}function c(){return[{displayName:t.getString("ClusterUi","rules.vmRuleMemberDetails.ruleName"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'}]}function l(){return[{displayName:t.getString("ClusterUi","rules.vmRuleMemberDetails.issue"),field:"issue",type:"string",template:'<span class="object" title="#:issue#"><i class="#:icon#")></i>#:issue#</span>'}]}function d(t){var i=[];_.each(t,function(t){t.rule.name!==e.modalOptions.dialogData.rule.name&&i.push({name:t.rule.name,icon:t.conflictingRules.length>0?"vx-icon-rule-conflict":"vx-icon-rule"})}),g.membersRulesGridData.data=i}function u(e,i,r,o){var a;switch(e.conflictType){case n.conflictType.ANTIAFFINITY_ANTIAFFINITY:case n.conflictType.AFFINITY_AFFINITY:a=t.getString("ClusterUi","rules.vmRuleMemberDetails.affinityAffinityConflictDescription",i,r,o);break;case n.conflictType.AFFINITY_ANTIAFFINITY:a=t.getString("ClusterUi","rules.vmRuleMemberDetails.affinityAntiaffinityConflictDescription",i,r,o);break;default:a=t.getString("ClusterUi","rules.vmRuleMemberDetails.unknownConflictDescription")}return a}function p(e){var i=0,r="";return _.each(e,function(n){0===i?r=n:r+=i===e.length-1?" "+t.getString("ClusterUi","rules.vmRuleMemberDetails.and")+" "+n:", "+n,i++}),r}function v(e){var t=[];return _.each(e,function(e){t=[].concat(e.members,t)}),t}function m(r,a){var s=v(r),c=[];i.getVmNames(s).then(function(i){_.each(r,function(e){var r=[],s=a===e.rule1.rule.name?e.rule2:e.rule1,l=s.rule.name,d=n.ruleType.VM_AFFINITY_RULE===s.ruleType?t.getString("ClusterUi","rules.vmRuleMemberDetails.affinity"):t.getString("ClusterUi","rules.vmRuleMemberDetails.antiAffinity");_.each(e.members,function(e){var t=o.getVsphereObjectId(e.entity);r.push(i[t].name)});var v=p(r);c.push({issue:u(e,v,d,l),icon:"vx-icon-error"})}),g.conflictsGridData.data=c,d(e.modalOptions.dialogData.member.rules)})}var g=this;g.conflictsGridData=s(l(),r.grid.selectionMode.MULTI),g.membersRulesGridData=s(c(),r.grid.selectionMode.SINGLE),a()}angular.module("com.vmware.vsphere.client.cluster").controller("ViewDetailsClusterRuleMemberController",e),e.$inject=["$scope","i18nService","clusterRulesService","vuiConstants","clusterRulesConstants","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){i.getRulesData(S).then(function(e){h.gridOptions.data=_.map(e.rules,function(e){return angular.merge({_original:e},e)}),l()})}function s(){o.updateActionBar(h.gridOptions,[S],y).then(function(e){P=e})}function c(){P&&o.updateActionBar(h.gridOptions,[S],y,P)}function l(){if(h.gridOptions.data&&h.gridOptions.data.length>0){var e;h.selectedRule&&(e=_.find(h.gridOptions.data,{name:h.selectedRule.name})),h.selectedRule=e?e._original:h.gridOptions.data[0]._original}}function d(e){return e&&0!==e.length?void(h.selectedRule&&e[0].name===h.selectedRule.name||(h.selectedRule=e[0]._original)):void(h.selectedRule=null)}function u(){return{actionBarOptions:{actions:[]},searchable:!1,resizable:!0,data:[],selectionMode:r.grid.selectionMode.SINGLE,selectedItems:[],columnDefs:p(),height:"100%",pageConfig:{hidePager:!0}}}function p(){return[{displayName:t.getString("ClusterUi","rules.list.name"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'},{displayName:t.getString("ClusterUi","rules.list.type"),field:"typeText",type:"string",template:'<span title="#:typeText#">#:typeText#</span>'},{displayName:t.getString("ClusterUi","rules.list.enabled"),field:"enabled",type:"boolean",template:v},{displayName:t.getString("ClusterUi","rules.list.conflicts"),field:"conflictingRules.length",type:"string",template:'<span title="#:conflictingRules.length#">#:conflictingRules.length#</span>'},{displayName:t.getString("ClusterUi","rules.list.definedBy"),field:"userCreated",type:"boolean",template:m}]}function v(e){var i=e.enabled?t.getString("ClusterUi","rules.list.enabled.yes"):t.getString("ClusterUi","rules.list.enabled.no");return f(i)}function m(e){var i=e.userCreated?t.getString("ClusterUi","rules.list.definedBy.user"):t.getString("ClusterUi","rules.list.definedBy.system");return f(i)}function g(e){return h.selectedRule&&e&&h.selectedRule.name===e.name}var h=this,f=kendo.template('<span title="#:data#">#:data#</span>'),S=e._route.objectId,y=[{actionId:"vsphere.core.cluster.actions.rule.add"},{actionId:"vsphere.core.cluster.actions.rule.edit",getActionInvocationContext:function(){return{selectedRule:h.selectedRule}},isActionAvailable:function(e){return e.available&&h.gridOptions.selectedItems.length>0}},{actionId:"vsphere.core.cluster.actions.rule.remove",getActionInvocationContext:function(){return{selectedRule:h.selectedRule}},isActionAvailable:function(e){return e.available&&h.gridOptions.selectedItems.length>0}}],P=null;h.VM_AFFINITY_RULE_TYPE=n.ruleType.VM_AFFINITY_RULE,h.VM_ANTIAFFINITY_RULE_TYPE=n.ruleType.VM_ANTIAFFINITY_RULE,h.VM_HOST_GROUP_RULE_TYPE=n.ruleType.VM_HOST_GROUP_RULE,h.VM_DEPENDENCY_RULE_TYPE=n.ruleType.VM_DEPENDENCY_RULE,h.watchForObjects=[S],h.liveRefreshProperties=["configurationEx.dasConfig.option","configurationEx.dasConfig.enabled","configurationEx.rule"],h.getViewData=a,h.gridOptions=u(),h.selectedRule=null,e.rulesPreselectComparator=g,h.rulesTitle=t.getString("ClusterUi","manage.settings.rules"),h.noSelectedItems=t.getString("ClusterUi","rules.view.noRuleSelected"),e.$watch("ctrl.gridOptions.selectedItems",d),e.$watch(function(){return h.selectedRule},function(){c()}),a(),s()}angular.module("com.vmware.vsphere.client.cluster").controller("VmAndHostRulesController",e),e.$inject=["$scope","i18nService","clusterRulesService","vuiConstants","clusterRulesConstants","datagridActionBarService"]}(),function(){"use strict";function e(e,t,i){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/rules/vmDependencyRuleDetails.html",scope:{rule:"="},controller:["$scope",function(r){function n(e){return t.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmDependency",e.vmDependencyRuleProperties.vmGroup,e.vmDependencyRuleProperties.dependsOnVmGroup)}var o=e._route.objectId;r.ruleDetailsTitle=t.getString("ClusterUi","manage.settings.ruleDetails"),r.dependsOnVmGroup=null,r.vmGroup=null,r.$watch("rule",function(e){e&&(i.getRuleGroupsData(o,e).then(function(t){r.dependsOnVmGroup=i.getGroupByName(t,e.vmDependencyRuleProperties.dependsOnVmGroup),r.vmGroup=i.getGroupByName(t,e.vmDependencyRuleProperties.vmGroup)}),r.ruleDetailsLabel=n(e))})}]}}angular.module("com.vmware.vsphere.client.cluster").directive("vmDependencyRuleDetails",e),e.$inject=["$rootScope","i18nService","clusterGroupsService"]}(),function(){"use strict";function e(e,t,i){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/rules/vmToHostRuleDetails.html",scope:{rule:"="},controller:["$scope",function(r){function n(e){var i="";return e.isAffineHostGroupName===!0&&e.isMandatory===!0&&(i=t.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmHostGroup.hard")),e.isAffineHostGroupName===!0&&e.isMandatory===!1&&(i=t.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmHostGroup.soft")),e.isAffineHostGroupName===!1&&e.isMandatory===!0&&(i=t.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmHostSeparate.hard")),e.isAffineHostGroupName===!1&&e.isMandatory===!1&&(i=t.getString("ClusterUi","rules.vmRuleDetails.typeDescription.vmHostSeparate.soft")),i}function o(e){return null!==e.vmToHostRuleProperties.vmGroupName&&void 0!==e.vmToHostRuleProperties.vmGroupName}function a(e){return null!==e.vmToHostRuleProperties.hostGroupName&&void 0!==e.vmToHostRuleProperties.hostGroupName}var s=e._route.objectId;r.ruleDetailsTitle=t.getString("ClusterUi","manage.settings.ruleDetails"),r.vmGroup=null,r.hostGroup=null,r.$watch("rule",function(e){e&&((o(e)||a(e))&&i.getRuleGroupsData(s,e).then(function(t){r.vmGroup=i.getGroupByName(t,e.vmToHostRuleProperties.vmGroupName),r.hostGroup=i.getGroupByName(t,e.vmToHostRuleProperties.hostGroupName)}),r.ruleDetailsLabel=n(e.vmToHostRuleProperties))})}]}}angular.module("com.vmware.vsphere.client.cluster").directive("vmToHostRuleDetails",e),e.$inject=["$rootScope","i18nService","clusterGroupsService"]}();var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$scope=e,this.dataService=t,this.vcService=i,this.$q=r,this.drsConstants=n,this.objectId=e.modalOptions.dialogData.objectId,this.$scope.modalOptions.dialogData.manager.setObjectId(this.objectId),this.$scope.modalOptions.dialogData.manager.setDrsDialogOptions(this.$scope.modalOptions),this.$scope.modalOptions.isAlertClosed=!0,this.getViewData()}return e.prototype.getSelectedPageUrl=function(){var e=this,t=_.find(this.$scope.pages.categories,function(t){return t.id===e.$scope.selectedCategoryId});return t?t.contentUrl:""},e.prototype.getViewData=function(){var e=this;this.setPageBusy(!0);var t=[],i=this.vcService.is65VcOrLater(this.objectId).then(function(t){e.is65VcOrLater=t,e.$scope.pages={categories:e.$scope.modalOptions.dialogData.manager.getPageDefinitions(!1)},e.$scope.selectedCategoryId=e.$scope.pages.categories[0].id,e.$scope.selectCategory=function(t){e.$scope.selectedCategoryId=t}}),r=this.dataService.getData(this.objectId,"com.vmware.vsphere.client.clusterui.model.services.DrsConfigData").then(function(t){_.extend(e.$scope.modalOptions.dialogData.editDrsData,t),e.setPageBusy(!1)});t.push(i),t.push(r),this.$q.all(t).then(function(){var t=e.$scope.modalOptions.dialogData.editDrsData;e.$scope.modalOptions.dialogData.manager.setFormData(t,e.is65VcOrLater,!1),e.formData=e.$scope.modalOptions.dialogData.manager.getFormData(),e.addWatchers()})},e.prototype.addWatchers=function(){var e=this;this.$scope.$watch("ctrl.formData.drsPolicies.allConsumedMemoryMetric",this.allConsumedMemoryMetricChanged.bind(this)),this.$scope.$watch(function(){var t=e.formData.advancedOptionsBuilder.getOptionByKey(e.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_OPTION);return t&&t.value},function(t){e.formData.drsPolicies.allConsumedMemoryMetric=!!t&&parseInt(t)>0})},e.prototype.allConsumedMemoryMetricChanged=function(e){var t=this.formData.advancedOptionsBuilder.getOptionByKey(this.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_OPTION);e?t||this.formData.advancedOptionsBuilder.addOption({key:this.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_OPTION,value:this.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_VALUE}):t&&this.formData.advancedOptionsBuilder.removeOption(t.id)},e.prototype.setPageBusy=function(e){this.loading=e,this.$scope.modalOptions.submitDisabled=e},e.$inject=["$scope","dataService","vcService","$q","drsConstants"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("EditDrsDialogController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.i18nService=e,this.drsConstants=t,this.dpmThresholdService=i,this.advancedOptionsBuilderFactory=r,this.clusterSpecBuilderService=n,this.mutationService=o,this.$q=a,this.editDrsFileDownloadService=s,this.clusterConstants=c,this.clarityModalService=l,this.clarityConstants=d}return e.prototype.setDrsDialogOptions=function(e){this.drsDialogOptions=e},e.prototype.submit=function(){var e=this;this.formData.drsPolicies.cpuOvercommitmentValue=Math.round(parseFloat(this.formData.drsPolicies.cpuOvercommitmentValue));var t=this.clusterSpecBuilderService.buildClusterComputeResourceSpec(this.formData,!0);return this.mutationService.validate(this.objectId,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",t).then(this.handleValidationResult.bind(this)).then(function(){return e.mutationService.apply(e.objectId,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",t),!0},function(){return e.$q.resolve(!1)})["catch"](function(t){e.$q.reject(t)})},e.prototype.getPageDefinitions=function(e){var t=[],i=this.getPageDefs();return e?(t.push(i.drsAutomationLevelDef.page),t.push(i.additionalOptionsDef.page),t.push(i.dpmAutomationDef.page)):(t.push(i.drsAutomationLevelDef.page),t.push(i.additionalOptionsDef.page),t.push(i.dpmAutomationDef.page),t.push(i.advancedOptionsDef.page)),t},e.prototype.setObjectId=function(e){this.objectId=e},e.prototype.getObjectId=function(){return this.objectId},e.prototype.setFormData=function(e,t){var i={allConsumedMemoryMetric:e.allConsumedMemoryMetricEnabled,cpuOvercommitment:e.cpuOverCommitment,cpuOvercommitmentValue:e.cpuOverCommitmentPercent};t&&(i.evenDistribution=e.evenDistributionEnabled),this.formData={is65VcOrLater:t,drsEnabled:e.drsEnabled,drsAutomation:{automationLevel:{id:e.defaultDrsBehavior},migrationThreshold:e.migrationThreshold,vmAutomation:e.vmAutomationEnabled,proactiveDrsEnabled:e.proactiveDrsEnabled},drsPolicies:i,dpmAutomation:{automationLevel:{id:this.getDpmAutomationLevel(e)},dpmThreshold:this.dpmThresholdService.reverseDpmRateAndThreshold(e.dpmRate)},scheduledTasksCount:e.scheduledTasksCount},this.formData.advancedOptionsBuilder=this.advancedOptionsBuilderFactory.getBuilder(e.advancedOptions,!0)},e.prototype.getFormData=function(){return this.formData},e.prototype.getDpmPageModel=function(){return{dpmAutomation:this.formData.dpmAutomation}},e.prototype.getAdditionalOptionsPageModel=function(){return{drsPolicies:this.formData.drsPolicies,is65VcOrLater:this.formData.is65VcOrLater}},e.prototype.getDrsAutomationLevelPageModel=function(){return{is65VcOrLater:this.formData.is65VcOrLater,drsAutomation:this.formData.drsAutomation}},e.prototype.getAdvancedOptionsPageModel=function(){return{advancedOptionsBuilder:this.formData.advancedOptionsBuilder}},e.prototype.getPageDefs=function(){var e={page:{id:"drsAutomationLevel",title:this.i18nService.getString("ClusterUi","drs.config.dialog.automationLabel"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/drs/edit/pages/drsAutomationLevelPage.html"}},t={page:{id:"additionalOptions",title:this.i18nService.getString("ClusterUi","drs.config.drsPoliciesLabel"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/drs/edit/pages/additionalOptionsPage.html"}},i={page:{id:"dpmAutomation",title:this.i18nService.getString("ClusterUi","drs.config.dpmLabel"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/drs/edit/pages/dpmAutomationPage.html"}},r={page:{id:"advancedOptions",title:this.i18nService.getString("ClusterUi","drs.config.advancedOptionsLabel"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/drs/edit/pages/drsAdvancedOptionsPage.html"}};return{drsAutomationLevelDef:e,additionalOptionsDef:t,dpmAutomationDef:i,advancedOptionsDef:r}},e.prototype.getDpmAutomationLevel=function(e){return e.dpmEnabled?e.defaultDpmBehavior:this.drsConstants.dpmAutomationLevel.DISABLED},e.prototype.handleValidationResult=function(e){var t;if(e&&(e.error||e.result&&e.result.isValid!==!0)){if(e.error){var i=e.error.localizedMessage?e.error.localizedMessage:e.error.message;return this.showValidationMessages(i),this.$q.reject()}if(e.result.errorCode===this.clusterConstants.editClusterErrorCodes.DRS_OFF_WITH_RESOURCE_POOLS)return this.editDrsFileDownloadService.showYesNoCancelDialog(this.objectId);if(e.result.errorCode===this.clusterConstants.editClusterErrorCodes.DPM_ON_WITH_HOSTS_STANDBY)return t=this.i18nService.getString("ClusterUi","drs.config.editDrs.dpmTurningOnCaption"),this.showConfirmationDialog(t,e.result.validationMessage,e.result.validationData);var r=[e.result.validationMessage];return this.showValidationMessages(r),this.$q.reject()}return this.$q.resolve()},e.prototype.showConfirmationDialog=function(e,t,i){var r=this.$q.defer(),n=e,o=t;_.each(i,function(e){o+="\n"+e});var a={title:n,message:o,submit:function(){return r.resolve(!0)},onCancel:function(){return r.reject()},preserveNewlines:!0,modalClass:"turn-on-dpm-confirmation-modal"};return this.clarityModalService.openConfirmationModal(a),r.promise},e.prototype.showValidationMessages=function(e){var t=this,i=_.map(e,function(e){return{type:t.clarityConstants.notifications.type.ERROR,text:e}});this.drsDialogOptions.isAlertClosed=!1,this.drsDialogOptions.alerts=i},e.$inject=["i18nService","drsConstants","dpmThresholdService","advancedOptionsBuilderFactory","clusterSpecBuilderService","mutationService","$q","editDrsFileDownloadService","clusterConstants","clarityModalService","clarityConstants"],e}();e.EditDrsDialogManager=t,angular.module("com.vmware.vsphere.client.cluster").factory("EditDrsDialogManager",["i18nService","drsConstants","dpmThresholdService","advancedOptionsBuilderFactory","clusterSpecBuilderService","mutationService","$q","editDrsFileDownloadService","clusterConstants","clarityModalService","clarityConstants",function(){return Function.prototype.bind.apply(t,[void 0,arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8],arguments[9],arguments[10]])}])}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$q=e,this.i18nService=t,this.clarityModalService=i,this.dataService=r,this.EditDrsDialogManager=n}return e.prototype.show=function(e,t){var i={},r={},n=new this.EditDrsDialogManager;_.extend(r,{title:this.i18nService.getString("ClusterUi","editClusterSettingsDialog.title"),subTitle:{objectId:e},defaultButton:"submit",contentTemplate:"cluster-ui/resources/cluster/views/settings/services/drs/edit/EditDrsDialog.html",size:"lg",onSubmit:n.submit.bind(n),modalClass:"edit-cluster-drs-dialog",focusTarget:t,dialogData:{editDrsData:i,manager:n,objectId:e,pageModel:null}}),this.clarityModalService.openOkCancelModal(r)},e.$inject=["$q","i18nService","clarityModalService","dataService","EditDrsDialogManager"],e}();e.EditDrsDialogService=t,angular.module("com.vmware.vsphere.client.cluster").service("editDrsDialogService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.$element=t,this.editDrsFileDownloadService=i,this.DOWNLOAD_LINK_SELECTOR=".edit-cluster-drs-dialog-confirmation-modal-download-section a",this.objectId=this.$scope.modalOptions.dialogData.objectId,this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.editDrsFileDownloadService.getSnapshotTreeData(this.objectId).then(function(t){t&&t.rpTreeSnapshot&&t.name&&(e.rpTreeSnapshotData=t.rpTreeSnapshot,e.clusterName=t.name)})},e.prototype.saveSnapshot=function(){if(this.rpTreeSnapshotData&&this.clusterName&&""!==this.clusterName){var e=this.editDrsFileDownloadService.createFileFromData(this.rpTreeSnapshotData,this.clusterName);if(window.navigator&&window.navigator.msSaveBlob)window.navigator.msSaveBlob(e.fileAsBlob,e.fileName);else{var t=this.$element.find(this.DOWNLOAD_LINK_SELECTOR)[0];t.href=e.fileUrl,t.download=e.fileName,t.click()}}},e.prototype.saveRpTreeAsSnapshotFile=function(){this.saveSnapshot(),this.$scope.modalOptions.dialogData.deferred.resolve(),this.$scope.closeModal()},e.prototype.turnOffDrsWithoutSavingRpTree=function(){this.$scope.modalOptions.dialogData.deferred.resolve(),this.$scope.closeModal()},e.prototype.closeConfirmationModal=function(){this.$scope.modalOptions.dialogData.deferred.reject(),this.$scope.closeModal()},e.$inject=["$scope","$element","editDrsFileDownloadService"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("EditDrsFileDownloadController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.clarityModalService=i,this.dataService=r,this.FILE_EXTENSION=".snapshot",this.FILE_FORMAT="application/octet-stream"}return e.prototype.getSnapshotTreeData=function(e){return this.dataService.getProperties(e,["rpTreeSnapshot","name"])},e.prototype.showYesNoCancelDialog=function(e){var t=this.$q.defer(),i={title:this.i18nService.getString("ClusterUi","drs.config.editDrs.drsTurningOffCaption"),deferred:t,objectId:e};return this.clarityModalService.openModal({},{},i,"cluster-ui/resources/cluster/views/settings/services/drs/edit/EditDrsFileDownloadDialog.html"),t.promise},e.prototype.createFileFromData=function(e,t){var i=this.convertBase64DataToByteArray(e),r=new Blob([i],{type:this.FILE_FORMAT}),n=URL.createObjectURL(r),o=t+this.FILE_EXTENSION;return{fileAsBlob:r,fileUrl:n,fileName:o}},e.prototype.convertBase64DataToByteArray=function(e){var t=atob(e),i=new Int8Array(new ArrayBuffer(2*t.length));return _.each(t,function(e,t){i[t]=e.charCodeAt(0)}),i},e.$inject=["$q","i18nService","clarityModalService","dataService"],e}();e.EditDrsFileDownloadService=t,angular.module("com.vmware.vsphere.client.cluster").service("editDrsFileDownloadService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.drsConstants=t,this.i18nService=i,this.additionalOptionsPageService=r,this.CPU_OVERCOMMITMENT_MIN=this.drsConstants.drsPolicies.CPU_OVERCOMMITMENT_MIN,this.CPU_OVERCOMMITMENT_MAX=this.drsConstants.drsPolicies.CPU_OVERCOMMITMENT_MAX,this.pageModel=e.modalOptions.dialogData.manager.getAdditionalOptionsPageModel(),this.drsPolicies=this.pageModel.drsPolicies,this.cpuOverCommitmentSignPostParams=this.additionalOptionsPageService.getCpuOverCommitmentSignPostParams(),this.advancedOptionsBuilder=e.modalOptions.dialogData.manager.getFormData().advancedOptionsBuilder}return e.prototype.normalizeCpuOvercommitment=function(e){(""===e.target.value||e.target.value<this.CPU_OVERCOMMITMENT_MIN)&&(this.drsPolicies.cpuOvercommitmentValue=this.CPU_OVERCOMMITMENT_MIN),e.target.value>this.CPU_OVERCOMMITMENT_MAX&&(this.drsPolicies.cpuOvercommitmentValue=this.CPU_OVERCOMMITMENT_MAX)},e.prototype.getString=function(e){return this.i18nService.getString("ClusterUi",e)},e.$inject=["$scope","drsConstants","i18nService","additionalOptionsPageService"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("AdditionalOptionsPageController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.getCpuOverCommitmentSignPostParams=function(){return{title:this.getString("help","Common"),message:this.getString("drs.config.overcommitment.label")}},e.prototype.getString=function(e,t){return t?this.i18nService.getString(t,e):this.i18nService.getString("ClusterUi",e)},e.$inject=["i18nService"],e}();e.AdditionalOptionsPageService=t,angular.module("com.vmware.vsphere.client.cluster").service("additionalOptionsPageService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.dpmThresholdService=t,this.drsConstants=i,this.dpmAutomationLevelService=r,this.i18nService=n,this.dpmAutomationPageService=o,this.pageModel=e.modalOptions.dialogData.manager.getDpmPageModel(),this.dpmAutomation=this.pageModel.dpmAutomation,this.DPM_AUTOMATION_LEVEL_DISABLED=this.drsConstants.dpmAutomationLevel.DISABLED,this.automationLevels=this.dpmAutomationLevelService.getAutomationLevels(),this.dpmAutomationLevelEnabled=this.dpmAutomation.automationLevel.id!==this.DPM_AUTOMATION_LEVEL_DISABLED,this.dpmAutomationLevelValue=this.dpmAutomationLevelEnabled?this.dpmAutomation.automationLevel.id:this.drsConstants.dpmAutomationLevel.MANUAL,this.dpmSliderOptions=this.dpmAutomationPageService.getSliderOptions(this.i18nService.getString("ClusterUi","drs.config.dpmThresholdLabel")),this.dpmAutomationLevelSignPostParams=this.dpmAutomationPageService.getDpmAutomationLevelSignPostParams(),this.dpmThresholdInformationMessage=this.dpmAutomationPageService.getDpmThresholdDescription(this.dpmAutomation.dpmThreshold),this.dpmAutomationLevelValuesSignPostParams=this.dpmAutomationPageService.getDpmAutomationLevelValuesSignPostParams(this.dpmAutomationLevelEnabled,this.dpmAutomation.automationLevel.id),e.$watch(function(){return a.dpmAutomation},function(e){e&&(a.dpmSliderOptions.value=a.dpmAutomation.dpmThreshold,a.dpmThresholdInformationMessage=a.dpmAutomationPageService.getDpmThresholdDescription(a.dpmAutomation.dpmThreshold))}),e.$watch(function(){return a.dpmSliderOptions.value},function(e){if(e&&a.dpmAutomation){var t=parseInt(e,10);a.dpmAutomation.dpmThreshold=t,a.dpmThresholdInformationMessage=a.dpmAutomationPageService.getDpmThresholdDescription(t)}}),e.$watch(function(){return a.dpmAutomationLevelEnabled},function(e){e?(a.dpmAutomation.automationLevel.id=a.dpmAutomationLevelValue,a.dpmAutomationLevelValuesSignPostParams.message=a.dpmAutomationPageService.getAutomationLevelValueDescriptions(a.dpmAutomation.automationLevel.id)):(a.dpmAutomation.automationLevel.id=a.DPM_AUTOMATION_LEVEL_DISABLED,a.dpmAutomationLevelValuesSignPostParams.message=a.i18nService.getString("ClusterUi","drs.config.dpm.disabledDescription"))}),e.$watch(function(){return a.dpmAutomationLevelValue},function(e){e&&a.dpmAutomationLevelEnabled&&(a.dpmAutomation.automationLevel.id=a.dpmAutomationLevelValue)}),e.$watch(function(){return a.dpmAutomation.automationLevel.id},function(e){e&&(a.dpmAutomationLevelValuesSignPostParams.message=a.dpmAutomationPageService.getAutomationLevelValueDescriptions(e))})}return e.$inject=["$scope","dpmThresholdService","drsConstants","dpmAutomationLevelService","i18nService","dpmAutomationPageService"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("DpmAutomationPageController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.dpmThresholdService=t}return e.prototype.getDpmAutomationLevelSignPostParams=function(){var e=this.getString("drs.config.dpm.description"),t=this.getString("drs.config.dpm.overridesLabel"),i=e+" "+t;
return{title:this.getString("help","Common"),message:i}},e.prototype.getDpmAutomationLevelValuesSignPostParams=function(e,t){var i=this.getAutomationLevelValueDescriptions(t),r=e?i:this.getString("drs.config.dpm.disabledDescription");return{title:this.getString("help","Common"),message:r}},e.prototype.getAutomationLevelValueDescriptions=function(e){var t={manual:this.getString("drs.config.dpm.automationLevel.manualDescription"),automated:this.getString("drs.config.dpm.automationLevel.automatedDescription")};return t[e]},e.prototype.getDpmThresholdDescription=function(e){return this.dpmThresholdService.getText(!0,e)},e.prototype.getSliderOptions=function(e){return{value:this.dpmThresholdService.DEFAULT,min:this.dpmThresholdService.MIN,max:this.dpmThresholdService.MAX,minLabel:this.dpmThresholdService.MIN_LABEL,maxLabel:this.dpmThresholdService.MAX_LABEL,enabled:!0,width:"auto",dragHandleTitle:e}},e.prototype.getString=function(e,t){return t?this.i18nService.getString(t,e):this.i18nService.getString("ClusterUi",e)},e.$inject=["i18nService","dpmThresholdService"],e}();e.DpmAutomationPageService=t,angular.module("com.vmware.vsphere.client.cluster").service("dpmAutomationPageService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.drsConstants=t,this.pageModel=e.modalOptions.dialogData.manager.getAdvancedOptionsPageModel(),this.formData=e.modalOptions.dialogData.manager.getFormData(),this.advancedOptionsBuilder=this.pageModel.advancedOptionsBuilder}return e.$inject=["$scope","drsConstants"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("DrsAdvancedOptionsPageController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.drsAutomationLevelService=t,this.i18nService=i,this.drsMigrationThresholdService=r,this.drsConstants=n,this.drsAutomationLevelPageService=o,this.scheduleDrsWizardManager=e.manager,this.pageModel=e.modalOptions.dialogData.manager.getDrsAutomationLevelPageModel(),this.drsAutomation=this.pageModel.drsAutomation,this.automationLevels=this.drsAutomationLevelService.getLevels(),this.signPostParams=this.drsAutomationLevelPageService.getSignPostParams(),this.automationLevelInformationMessage=this.drsAutomationLevelPageService.getAutomationLevelInformationMessage(this.drsAutomation.automationLevel.id),this.predictiveDrsSignPostParams=this.drsAutomationLevelPageService.getPredictiveDrsSignPostParams(),this.vmAutomationSignPostParams=this.drsAutomationLevelPageService.getVmAutomationSignPostParams(),this.migrationThresholdInformationMessage=this.drsAutomationLevelPageService.getMigrationThresholdDescription(this.drsAutomation.migrationThreshold),this.mtSliderOptions=this.drsAutomationLevelPageService.getSliderOptions(this.i18nService.getString("ClusterUi","drs.config.migrationThresholdLabel")),e.$watch(function(){return a.drsAutomation},function(e){e&&(a.mtSliderOptions.value=a.drsAutomation.migrationThreshold,a.migrationThresholdInformationMessage=a.drsAutomationLevelPageService.getMigrationThresholdDescription(a.drsAutomation.migrationThreshold),a.drsAutomation.is65VcOrLater=a.pageModel.is65VcOrLater)}),e.$watch(function(){return a.mtSliderOptions.value},function(e){if(e&&a.drsAutomation){var t=parseInt(e,10);a.drsAutomation.migrationThreshold=t,a.migrationThresholdInformationMessage=a.drsAutomationLevelPageService.getMigrationThresholdDescription(t)}}),e.$watch("ctrl.drsAutomation.automationLevel.id",function(e){e&&a.drsAutomation&&(a.automationLevelInformationMessage=a.drsAutomationLevelPageService.getAutomationLevelInformationMessage(e))})}return e.prototype.$onInit=function(){this.scheduleDrsWizardManager&&$("select[data-test-id='drsAutomationLevelDropdown']").focus()},e.$inject=["$scope","drsAutomationLevelService","i18nService","drsMigrationThresholdService","drsConstants","drsAutomationLevelPageService"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("DrsAutomationLevelController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.drsMigrationThresholdService=t}return e.prototype.getSliderOptions=function(e){return{value:this.drsMigrationThresholdService.DEFAULT,min:this.drsMigrationThresholdService.MIN,max:this.drsMigrationThresholdService.MAX,minLabel:this.drsMigrationThresholdService.MIN_LABEL,maxLabel:this.drsMigrationThresholdService.MAX_LABEL,enabled:!0,width:"auto",dragHandleTitle:e}},e.prototype.getSignPostParams=function(){return{title:this.getString("help","Common"),message:this.getString("drs.config.migrationThreshold.signpostMessage")}},e.prototype.getMigrationThresholdDescription=function(e){var t=this.drsMigrationThresholdService.getDescription(e);return t},e.prototype.getVmAutomationSignPostParams=function(){return{title:this.getString("help","Common"),message:this.getString("drs.config.vmAutomation.enableOverridesDescription")}},e.prototype.getPredictiveDrsSignPostParams=function(){return{title:this.getString("help","Common"),message:this.getString("drs.config.migration.forecastedMetrics.desc")}},e.prototype.getAutomationLevelInformationMessage=function(e){var t={manual:this.getString("drs.config.automationLevel.manualDescription"),partiallyAutomated:this.getString("drs.config.automationLevel.partialautoDescription"),fullyAutomated:this.getString("drs.config.automationLevel.fullautoDescription")};return t[e]},e.prototype.getString=function(e,t){return t?this.i18nService.getString(t,e):this.i18nService.getString("ClusterUi",e)},e.$inject=["i18nService","drsMigrationThresholdService"],e}();e.DrsAutomationLevelPageService=t,angular.module("com.vmware.vsphere.client.cluster").service("drsAutomationLevelPageService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$scope=e,this.dataService=t,this.vcService=i,this.$q=r,this.drsConstants=n,this.objectId=e.modalOptions.dialogData.objectId,this.$scope.modalOptions.dialogData.manager.setObjectId(this.objectId),this.$scope.modalOptions.dialogData.manager.setDrsDialogOptions(this.$scope.modalOptions),this.$scope.modalOptions.isAlertClosed=!0,this.getViewData()}return e.prototype.getSelectedPageUrl=function(){var e=this,t=_.find(this.$scope.pages.categories,function(t){return t.id===e.$scope.selectedCategoryId});return t?t.contentUrl:""},e.prototype.getViewData=function(){var e=this;this.loading=!0;var t=this.vcService.is65VcOrLater(this.objectId).then(function(t){e.is65VcOrLater=t,e.$scope.pages={categories:e.$scope.modalOptions.dialogData.manager.getPageDefinitions(!0)},e.$scope.selectedCategoryId=e.$scope.pages.categories[0].id,e.$scope.selectCategory=function(t){e.$scope.selectedCategoryId=t}});if(this.$scope.modalOptions.dialogData.isEditScheduledTaskMode)t.then(function(){e.loadFormData(),e.loading=!1});else{var i=[],r=this.dataService.getData(this.objectId,"com.vmware.vsphere.client.clusterui.model.services.DrsConfigData").then(function(t){_.extend(e.$scope.modalOptions.dialogData.editDrsData,t),e.loading=!1});i.push(t),i.push(r),this.$q.all(i).then(function(){e.loadFormData()})}},e.prototype.addWatchers=function(){var e=this;this.$scope.$watch("ctrl.formData",function(){e.$scope.manager.setFormData(e.$scope.modalOptions.dialogData.manager.getFormData())}),this.$scope.$watch("ctrl.formData.drsPolicies.allConsumedMemoryMetric",this.allConsumedMemoryMetricChanged.bind(this))},e.prototype.allConsumedMemoryMetricChanged=function(e){var t=this.formData.advancedOptionsBuilder.getOptionByKey(this.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_OPTION);e?t||this.formData.advancedOptionsBuilder.addOption({key:this.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_OPTION,value:this.drsConstants.drsPolicies.ALL_CONSUMED_MEMORY_METRIC_VALUE}):t&&this.formData.advancedOptionsBuilder.removeOption(t.id)},e.prototype.loadFormData=function(){var e=this.$scope.modalOptions.dialogData.editDrsData;this.$scope.modalOptions.dialogData.manager.setFormData(e,this.is65VcOrLater),this.formData=this.$scope.modalOptions.dialogData.manager.getFormData(),this.addWatchers()},e.$inject=["$scope","dataService","vcService","$q","drsConstants"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("ScheduleDrsDrsSettingsPageController",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.vuiConstants=t,this.mutationService=i,this.defaultUriSchemeUtil=r,this.$rootScope=n,this.wizardPageService=o,this.clusterSpecBuilderService=a,this.vscSchedulingHelper=s,this.scheduleModel={},this.buildPages()}return e.prototype.getPageDefinitions=function(){return[this.scheduleSettingsPageDef,this.drsSettingsPageDef]},e.prototype.getObjectId=function(){return this.objectId},e.prototype.getModel=function(){return this.scheduleModel},e.prototype.setModel=function(e){this.scheduleModel=e},e.prototype.setFormData=function(e){this.formData=e},e.prototype.submit=function(){return this.scheduleModel.scheduleTaskSpec.spec=this.clusterSpecBuilderService.buildClusterComputeResourceSpec(this.formData,!0),this.scheduleModel.scheduleTaskSpec.spec._type="com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",this.scheduleModel.scheduleTaskSpec.schedulingSpec.recurrence=this.vscSchedulingHelper.formatRecurrenceData(this.scheduleModel.scheduleTaskSpec.schedulingSpec.recurrence),this.mutationService.apply(this.objectId,"com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec",this.scheduleModel.scheduleTaskSpec),!0},e.prototype.getWizardConfig=function(e){var t,i=this,r=this.i18nService.getString("ClusterUi","editClusterSettingsDialog.title");return t=e&&e.isScheduledTask&&1===e.schedulingData.scheduleTaskOperationMode?this.i18nService.getString("ScheduledOpsUi","scheduledTask.ScheduleTasksEdit",r):this.i18nService.getString("ScheduledOpsUi","scheduledTask.ScheduleNewTasks.label")+" ("+r+")",this.wizardConfig?this.wizardConfig.title=t:this.wizardConfig={title:t,pages:this.getPageDefinitions(),show:!0,loading:!1,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),onFinish:function(){return i.submit()},cssClass:"schedule-cluster-drs-page"},this.wizardConfig},e.prototype.init=function(e,t){this.objectId=e,t&&t.isScheduledTask&&1===t.schedulingData.scheduleTaskOperationMode?this.scheduleModel={scheduleTaskSpec:t.schedulingData}:this.scheduleModel={scheduleTaskSpec:{spec:{},operation:0,entity:this.defaultUriSchemeUtil.getManagedObjectReference(e),schedulingSpec:{_type:"com.vmware.vise.core.model.scheduling.ScheduledTaskSpec",scheduledTask:null,recurrence:null,name:"Reconfigure Cluster",taskKey:"ReconfigureComputeResource_Task",description:"",source:"Cluster",enabled:!0,notification:""},deferredOperation:0,scheduleTaskOperationMode:0}}},e.prototype.buildPages=function(){var e=this;this.scheduleSettingsPageDef={title:this.i18nService.getString("ScheduledOpsUi","scheduledTask.snapshot.options"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/drs/edit/pages/scheduleDrsScheduleOptionsPage.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){var t=e.getModel().scheduleTaskSpec.schedulingSpec.recurrence,i=e.getModel().scheduleTaskSpec.schedulingSpec.isFormStatusValid;return t&&i?(e.setModel(e.getModel()),e.wizardPageService.markPageComplete(e.wizardConfig),!0):(t||e.wizardPageService.markPageIncompleteWithError(e.wizardConfig,e.i18nService.getString("SchedulingUi","scheduledTask.emptyScheduler")),!1)}},this.drsSettingsPageDef={title:this.i18nService.getString("ClusterUi","drs.schedule.config.pageTitle"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/drs/edit/pages/scheduleDrsDrsSettingsPage.html",state:this.vuiConstants.wizard.pageState.DISABLED}},e.$inject=["i18nService","vuiConstants","mutationService","defaultUriSchemeUtil","$rootScope","wizardPageService","clusterSpecBuilderService","vscSchedulingHelper"],e}();e.ScheduleDrsWizardManager=t,angular.module("com.vmware.vsphere.client.cluster").service("scheduleDrsWizardManager",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.wizardManager=r,this.pageStateManagementService=n,this.EditDrsDialogManager=o}return e.prototype.show=function(e,t,i){var r=this.$rootScope.$new();this.wizardManager.init(t,e.additionalData);var n=e.additionalData&&e.additionalData.isScheduledTask&&1===e.additionalData.schedulingData.scheduleTaskOperationMode;r.wizardConfig=this.wizardManager.getWizardConfig(e.additionalData),r.manager=this.wizardManager,r.modalOptions={focusTarget:i,dialogData:{manager:new this.EditDrsDialogManager,editDrsData:n?e.additionalData.schedulingData.spec:{},objectId:t,pageModel:null,isEditScheduledTaskMode:n}},this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(r),this.vuiWizardService({scope:r,configObjectName:"wizardConfig"}).show()},e.$inject=["$rootScope","i18nService","vuiWizardService","scheduleDrsWizardManager","pageStateManagementService","EditDrsDialogManager"],e}();e.ScheduleDrsWizardService=t,angular.module("com.vmware.vsphere.client.cluster").service("scheduleDrsWizardService",t)}(cluster_ui||(cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t){var i=this;this.$scope=e,this.dataService=t,e.pages={categories:e.modalOptions.dialogData.manager.getPageDefinitions()},e.selectedCategoryId=e.pages.categories[0].id,e.selectCategory=function(t){e.modalOptions.dialogData.manager.validate()&&(i.$scope.selectedCategoryId=t)},this.getViewData()}return e.prototype.getSelectedPageUrl=function(){var e=this,t=_.find(this.$scope.pages.categories,function(t){return t.id===e.$scope.selectedCategoryId});return t?t.contentUrl:""},e.prototype.getViewData=function(){var e=this;this.setPageBusy(!0),this.dataService.getData(this.$scope.modalOptions.dialogData.objectId,"com.vmware.vsphere.client.clusterui.model.services.ClusterEditHaData").then(function(t){_.extend(e.$scope.modalOptions.dialogData.haData,t),e.pageModel=e.$scope.modalOptions.dialogData.manager.getFailuresAndResponsesModel(),e.setPageBusy(!1)})},e.prototype.setPageBusy=function(e){this.loading=e,this.$scope.modalOptions.submitDisabled=e},e.$inject=["$scope","dataService"],e}();angular.module("com.vmware.vsphere.client.cluster").controller("EditHaDialogController",t)}(cluster_ui||(cluster_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){return function(d,u){function p(){M={page:{id:"failuresAndResponses",title:i.getString("ClusterUi","ha.config.edit.vmResponse.ToCItem"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/ha/edit/pages/failuresAndResponsesPage.html"}},O={page:{id:"heartbeatDatastores",title:i.getString("ClusterUi","ha.config.dsForHeartbeating.ToCItem"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/ha/edit/pages/heartbeatDatastoresPage.html"}},A={page:{id:"advancedOptions",title:i.getString("ClusterUi","ha.config.advancedOptions"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/ha/edit/pages/advancedOptionsPage.html"}},k={page:{id:"admissionControl",title:i.getString("ClusterUi","ha.config.admissionControl"),contentUrl:"cluster-ui/resources/cluster/views/settings/services/ha/edit/pages/admissionControlPage.html"}}}function v(){var e=[];return e.push(M.page),e.push(k.page),e.push(O.page),e.push(A.page),e}function m(){var e=u.dialogData.objectId,t=g();return h(e,t).then(function(){return n.apply(e,R,t),!0},function(){return!1})}function g(){var e=_.extend({},M.model||{},w(),A.model||{},k.model||{});if(M&&M.model&&M.model.haConfiguration&&M.model.haConfiguration.defaultVmSettings){var t=M.model.haConfiguration,i=t.defaultVmSettings,n=i.vmToolsMonitoringSettings,o=V(n),a=M.model.haConfiguration.defaultVmSettings.vmToolsMonitoringSettings;_.extend(a,o)}return r.buildClusterComputeResourceSpec(e,!0)}function h(e,t){if(!f())return s.reject();var i=S();return i?n.validate(e,R,t).then(y):s.resolve()}function f(){return u.alerts=[],u.isAlertClosed=!0,!k.model||k.model.admissionControlPolicy.type!==t.admissionControlPolicy.FAILOVER_HOSTS_TYPE||0!==k.model.failoverHosts.length||(u.alerts=[{type:e.validationBanner.type.ERROR,text:i.getString("ClusterUi","ha.config.admission.control.policy.failover.host.error")}],u.isAlertClosed=!1,!1)}function S(){var e=!1;return!M.model||M.model.haConfiguration.vmcpSettings.pdlResponse===t.storageVmReaction.DISABLED&&M.model.haConfiguration.vmcpSettings.apdResponse===t.storageVmReaction.DISABLED||(e=!0),e}function y(e){if(e&&!e.error&&e.result&&e.result.isValid!==!0&&e.result.errorCode===l.editClusterErrorCodes.HA_APD_PDL_WITH_FT_VMS){var t=i.getString("ClusterUi","ha.config.enable.storageProtection.with.ftVms.warning.title");return P(t,e.result.validationMessage)}return s.resolve()}function P(e,t){var i=s.defer(),r={title:e,message:t,submit:function(){return i.resolve(),!0},onCancel:function(){return i.reject(),!0}};return c.openConfirmationModal(r),i.promise}function C(){return M.model||D(),M.model}function D(){var e=d.hostMonitoring===t.hostMonitoringState.ENABLED,i=!0,r=t.vmMonitoringSensitivity.high.FAILURE_WINDOW;d.vmToolsMonitorMaxFailureWindow===t.vmMonitoringSensitivity.NO_FAILURE_WINDOW?i=!1:r=d.vmToolsMonitorMaxFailureWindow/3600,M.model={haEnabled:d.haEnabled,haConfiguration:{defaultVmSettings:{isolationResponse:d.isolationResponse,restartPriority:d.restartPriority,restartPriorityTimeout:d.restartPriorityTimeout,vmToolsMonitoringSettings:{vmToolsMonitorFailureInt:d.vmToolsMonitorFailureInt,vmToolsMonitorMinUpTime:d.vmToolsMonitorMinUpTime,vmToolsMonitorMaxFailures:d.vmToolsMonitorMaxFailures,vmToolsMonitorMaxFailureWindow:r,vmToolsMonitorHasFailureWindow:i}},hostMonitoringEnabled:e,vmMonitoringState:d.vmMonitoring,vmcpSettings:{pdlResponse:d.vmcpSettings.pdlResponse,apdResponse:d.vmcpSettings.apdResponse,vmReactionOnAPDCleared:d.vmcpSettings.vmReactionOnAPDCleared,apdRecoveryDelayMinutes:d.vmcpSettings.vmTerminateDelayForAPDSec/t.SECONDS_IN_A_MINUTE}},storagePDLSupported:d.storagePDLSupported,storageAPDSupported:d.storageAPDSupported,orchestration:{defaultVmReadiness:{readyCondition:d.readyCondition,postReadyDelay:d.postReadyDelay}}}}function w(){return O.model||b(),O.model}function b(){O.model={hbDatastoreCandidatePolicy:d.heartbeatDatastoreCandidatePolicy,hbDatastoreCandidates:d.heartbeatDatastoreCandidates,hbDatastoresPerHost:d.requiredDatastoreMounts}}function I(){return A.model||(A.model={haAdvancedOptionsBuilder:o.getBuilder(d.advancedOptions,!0)}),A.model}function T(){return k.model||E(),k.model}function E(){var e;e=d.admissionControlEnabled?d.admissionControlPolicy._type:t.admissionControlPolicy.DISABLED_TYPE;var i=d.failoverHostNum,r=a.getFailoverLevelDefaultValue();i<r&&(i=r);var n=t.slotSizePolicy.COVER_ALL_VM,o=a.getFixedSlotSizeCpuDefaultValue(),s=a.getFixedSlotSizeMemoryDefaultValue(),c=d.admissionControlPolicy.slotPolicy;c&&(n=t.slotSizePolicy.FIXED_SIZE,o=c.cpu,s=c.memory);var l=d.hostData;null===l&&(l=[]);var u=d.autoComputePercentages;null!==u&&e===t.admissionControlPolicy.FAILOVER_RESOURCES_TYPE||(u=!0),k.model={admissionControlPolicy:{type:e},failoverLevel:i,failoverHosts:l,cpuFailoverPercent:d.cpuFailoverPercent,memoryFailoverPercent:d.memoryFailoverPercent,slotSizePolicy:n,fixedSlotSizeCpu:o,fixedSlotSizeMemory:s,autoComputePercentages:u,resourceReductionToToleratePercent:d.resourceReductionToToleratePercent,hostsInCluster:d.hostsInCluster}}function V(e){return{vmToolsMonitorFailureInt:Math.round(e.vmToolsMonitorFailureInt),vmToolsMonitorMaxFailureWindow:Math.round(e.vmToolsMonitorMaxFailureWindow),vmToolsMonitorMaxFailures:Math.round(e.vmToolsMonitorMaxFailures),vmToolsMonitorMinUpTime:Math.round(e.vmToolsMonitorMinUpTime)}}var M,O,A,k,R="com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec";return p(),{getPageDefinitions:v,getFailuresAndResponsesModel:C,getHeartbeatDatastoresModel:w,getAdvancedOptionsModel:I,getAdmissionControlModel:T,submit:m,getClusterReconfigureSpec:g,validate:f}}}angular.module("com.vmware.vsphere.client.cluster").factory("HaDialogManager",e),e.$inject=["vuiConstants","haConstants","i18nService","clusterSpecBuilderService","mutationService","advancedOptionsBuilderFactory","haAdmissionControlService","$q","clarityModalService","clusterConstants"]}(),function(){"use strict";function e(e,t,i){function r(r,n){var o={},a={},s=new t(o,a);_.extend(a,{title:e.getString("ClusterUi","editClusterSettingsDialog.title"),subTitle:{objectId:r},defaultButton:"submit",contentTemplate:"cluster-ui/resources/cluster/views/settings/services/ha/edit/editHaDialog.html",size:"lg",onSubmit:s.submit,modalClass:"cluster-edit-ha-dialog-modal",focusTarget:n,dialogData:{haData:o,manager:s,objectId:r}}),i.openOkCancelModal(a)}return{show:r}}angular.module("com.vmware.vsphere.client.cluster").service("haDialogService",e),e.$inject=["i18nService","HaDialogManager","clarityModalService"]}(),function(){"use strict";function e(e,t){var i=e.modalOptions.dialogData;i.selectedItems=[];var r="clusterObjectsExcludeObjectsFilter";0===i.dedicatedFailoverHostIds.length&&(r="clusterObjectsFilter"),i.objectSelectorConfig=this.config={contextObject:i.clusterId,multipleSelect:!0,listTabConfig:{listConfig:[{label:t.getString("Common","typeResource.hostPlural"),listViewId:"vsphere.core.host.list",dataModels:["HostSystem"],filterId:r,filterParams:i.dedicatedFailoverHostIds}]},onSelectionChanged:function(e){i.selectedItems=e}}}angular.module("com.vmware.vsphere.client.cluster").controller("AdmissionControlFailoverHostsSelectorDialogController",e),e.$inject=["$scope","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d){function u(){"undefined"!=typeof I.pageModel.failoverLevel&&I.pageModel.hostsInCluster<=I.pageModel.failoverLevel&&(I.pageModel.failoverLevel=I.pageModel.hostsInCluster-1),("undefined"==typeof I.pageModel.failoverLevel||I.pageModel.failoverLevel<=1)&&(I.pageModel.failoverLevel=1)}function p(e){f(e.target.value,"cpuFailoverPercent")}function v(e){f(e.target.value,"memoryFailoverPercent")}function m(e){f(e.target.value,"resourceReductionToToleratePercent")}function g(e){(""===e.target.value||e.target.value<1)&&(I.pageModel.fixedSlotSizeCpu=1),e.target.value>d.MAX_INTEGER&&(I.pageModel.fixedSlotSizeCpu=d.MAX_INTEGER)}function h(e){(""===e.target.value||e.target.value<1)&&(I.pageModel.fixedSlotSizeMemory=1),e.target.value>d.MAX_INTEGER&&(I.pageModel.fixedSlotSizeMemory=d.MAX_INTEGER)}function f(e,t){""===e||e<0?I.pageModel[t]=0:e>100&&(I.pageModel[t]=100)}function S(){var e=I.failoverHostsGridOptions.selectedItems;I.failoverHostsService.removeFailoverHost(I.failoverHostsGridOptions,e)}function y(){var e={actionId:"vsphere.core.cluster.actions.addFailoverHost",enabled:!0,visible:!0,iconClass:"vui-icon-action-add",label:T("ha.config.admission.control.policy.failover.add.host.button.label"),tooltipText:T("ha.config.admission.control.policy.failover.add.host.button.tooltip"),onClick:D},t={actionId:"vsphere.core.cluster.actions.removeFailoverHost",enabled:!1,visible:!0,iconClass:"vui-icon-action-delete",label:T("ha.config.admission.control.policy.failover.remove.hosts.button.label"),tooltipText:T("ha.config.admission.control.policy.failover.remove.hosts.button.tooltip"),onClick:S};I.failoverHostsGridOptions={columnDefs:[{displayName:T("ha.config.admission.control.policy.failover.host.header"),field:"name",template:w("name","iconId"),sortable:!0,searchable:!1}],height:"285px",resizable:!1,reorderable:!1,data:[],selectionMode:n.grid.selectionMode.SINGLE,selectedItems:[],actionBarOptions:{actions:[e,t]}}}function P(){var t=I.haDialogManager.getClusterReconfigureSpec().configSpecEx.dasConfig,i={propertyParams:[{_type:"com.vmware.vise.mvc.model.data.ParamSpec",propertyName:"reconfigureHaFailoverLevelPrecheckResult",parameterType:"com.vmware.vim.binding.vim.cluster.DasConfigInfo",parameter:t}]};s.getProperties(e.modalOptions.dialogData.objectId,["reconfigureHaFailoverLevelPrecheckResult"],i).then(function(e){if(e&&e.reconfigureHaFailoverLevelPrecheckResult){var t=e.reconfigureHaFailoverLevelPrecheckResult;I.slotSizeRequirements.numberOfVmsRequiringMultipleSlots=t.vmsRequiringMultipleSlots?t.vmsRequiringMultipleSlots.length:0,I.slotSizeRequirements.totalPoweredOnVms=t.totalVms,I.slotSizeRequirements.vmsRequiringMultipleSlots=t.vmsRequiringMultipleSlots,I.slotSizeRequirements.vmsRequiringMultipleSlotsRatioLabel=I.slotSizeRequirements.numberOfVmsRequiringMultipleSlots+"/"+I.slotSizeRequirements.totalPoweredOnVms}})}function C(){I.slotSizeRequirements||P();var e={slotSizeRequirements:I.slotSizeRequirements};o.openActionDialog({action:{}},[],e,"cluster-ui/resources/cluster/views/settings/services/ha/edit/pages/admissionControlVmsRequiringMultiSlotsDialog.html",{title:T("ha.config.admission.control.policy.failover.level.excluded.vms.title"),resizable:!1,draggable:!0,maximizable:!1,width:"550px",height:"400px",confirmOptions:{label:T("ha.config.admission.control.policy.failover.level.excluded.vms.close.button")},rejectOptions:{visible:!1}})}function D(){var i={dedicatedFailoverHostIds:I.failoverHostsService.getFailoverHostIds(),clusterId:e.modalOptions.dialogData.objectId};l.openOkCancelModal({title:t.getString("ClusterUi","ha.config.admission.control.policy.failover.host.selection.title"),subTitle:{objectId:e.modalOptions.dialogData.objectId},dialogData:i,defaultButton:"submit",size:"lg",modalClass:"cluster-admission-control-failover-host-selector-dialog",contentTemplate:"cluster-ui/resources/cluster/views/settings/services/ha/edit/pages/admissionControlFailoverHostsSelectorDialog.html",onSubmit:function(){return e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,I.failoverHostsService.addFailoverHosts(I.failoverHostsGridOptions,i.selectedItems)}})}function w(e,t){return function(i){var r=i[t],n=a.getColumnRenderer("object-link");return n([void 0,e,r],i)}}function b(){return I.pageModel.is65VcOrLater&&I.pageModel.admissionControlPolicy.type!==I.admissionControlTypes.DISABLED_TYPE}var I=this,T=_.bind(t.getString,t,"ClusterUi"),E=e.modalOptions.dialogData.objectId;I.pageModel=e.modalOptions.dialogData.manager.getAdmissionControlModel(),I.slotSizeRequirements={numberOfVmsRequiringMultipleSlots:0,totalPoweredOnVms:0,vmsRequiringMultipleSlots:null,vmsRequiringMultipleSlotsRatioLabel:""},I.admissionControlTypes=r.admissionControlPolicy,I.slotSizePolicyTypes=r.slotSizePolicy,I.haDialogManager=e.modalOptions.dialogData.manager,I.pageModel.is65VcOrLater=!1,I.oldFailoverValue=I.pageModel.failoverLevel,I.showWarningLabel=!1,c.is65VcOrLater(E).then(function(e){I.pageModel.is65VcOrLater=e}),y(),e.$watch(function(){return I.failoverHostsGridOptions.selectedItems},function(e){var t=!!e&&e.length>0;I.failoverHostsGridOptions.actionBarOptions.actions[1].enabled=t}),e.$watch(function(){return I.pageModel.admissionControlPolicy.type},function(){I.pageModel.admissionControlPolicy.type===I.admissionControlTypes.FAILOVER_HOSTS_TYPE&&(I.failoverHostsService=i.getFailoverHostsService(I.pageModel),I.failoverHostsGridOptions.data=I.failoverHostsService.getFailoverHostsGridData())}),e.$watch("ctrl.pageModel.failoverLevel",function(){I.oldFailoverValue===I.pageModel.failoverLevel?I.showWarningLabel=!1:I.showWarningLabel=!0}),I.validateFailoverLevel=u,I.validateFailoverCpu=p,I.validateFailoverMemory=v,I.normalizeSlotSizeCpu=g,I.normalizeSlotSizeMemory=h,I.calculateNumberOfVmsRequiringMultipleSlots=P,I.openDialogForVmsRequiringMultipleSlots=C,I.show65VcOrLaterFeatures=b,I.validateResourceReductionThreshold=m,I.admissionControlDesc=T("ha.config.admission.control.description"),I.definedHostFailoverCapacityLabel=T("ha.config.admission.control.propertygrid.failover.capacity.label"),I.admissionControlPolicies=i.getPolicies(),I.failoverLevelLabel=T("ha.config.admission.control.policy.failover.level.num.hosts"),I.hostFailuresToleratesLabel=T("ha.config.admission.control.propertygrid.num.hosts.label"),I.failoverLevelHostsLabel=T("ha.config.admission.control.policy.failover.level.hosts"),I.hostFailuresToleratesMaxLabel=T("ha.config.admission.control.failover.level.desc"),I.autoComputePercentagesLabel=T("ha.config.admission.control.newpage.policy.failover.resources.override.label"),I.failoverCpuCapacityLabel=T("ha.config.admission.control.policy.failover.reserved.cpu"),I.failoverMemoryCapacityLabel=T("ha.config.admission.control.policy.failover.reserved.memory"),I.percentLabel=T("ha.config.percent"),I.cpuLabel=T("ha.config.admission.control.policy.cpu"),I.memoryLabel=T("ha.config.admission.control.policy.mem"),I.slotSizePolicyLabel=T("ha.config.admission.control.policy.failover.level.slot.policy"),I.coverAllVmLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.auto"),I.coverAllVmHint=T("ha.config.admission.control.policy.failover.level.slot.policy.auto.hint"),I.fixedSlotSizeLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.fixed"),I.fixedSlotSizeHint=T("ha.config.admission.control.policy.failover.level.slot.policy.fixed.hint"),I.cpuSlotSizeLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.cpu.size"),I.MhzLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.cpu.mhz"),I.memorySlotSizeLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.memory.size"),I.MbLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.memory.mb"),I.vmRequiringMultipleSlotsTitle=T("ha.config.admission.control.policy.failover.level.slot.policy.vms.requiring.multiple.slots.label"),I.slotPolicyViewButtonLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.view.excluded.label"),I.slotPolicyCalculateButtonLabel=T("ha.config.admission.control.policy.failover.level.slot.policy.calculate.label"),I.resourceReductionThresholdLabel=T("ha.config.admission.control.propertygrid.resource.reduction.label"),I.resourceReductionThresholdDesc=T("ha.config.admission.control.newpage.resource.reduction.desc")}angular.module("com.vmware.vsphere.client.cluster").controller("AdmissionControlPageController",e),e.$inject=["$scope","i18nService","haAdmissionControlService","haConstants","vuiConstants","actionDialogService","columnRenderersRegistry","dataService","vcService","clarityModalService","clusterConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(e){var t=r.getColumnRenderer("icon-text");return t(["icon","text"],{icon:"vsphere-icon-vm-on",text:e.vmName})}var o=this;o.header=t.getString("ClusterUi","ha.config.admission.control.policy.failover.level.excluded.vms.header"),o.slotSizeRequirements=e.dialogOptions.actionDetails.dialogData.slotSizeRequirements;var a=[],s=o.slotSizeRequirements.vmsRequiringMultipleSlots;s&&s.forEach(function(e){a.push({vmName:e.vmName,requiredSlots:e.requiredSlots})});var c=[{displayName:t.getString("ClusterUi","ha.config.admission.control.policy.failover.level.excluded.vms.grid.name.header"),field:"vmName",template:function(e){return n(e)}},{displayName:t.getString("ClusterUi","ha.config.admission.control.policy.failover.level.excluded.vms.grid.slots.header"),field:"requiredSlots"}];o.datagridOptions={columnDefs:c,sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,selectedItems:[],data:a,resizable:!0,height:"100%",pageConfig:{hidePager:!0}}}angular.module("com.vmware.vsphere.client.cluster").controller("AdmissionControlVmsRequiringMultipleSlotsDialogController",e),e.$inject=["$scope","i18nService","vuiConstants","columnRenderersRegistry"]}(),function(){"use strict";function e(e,t){var i=this,r=e.modalOptions.dialogData.manager,n=_.partial(t.getString,"ClusterUi");i.advancedOptionsDesc=n("ha.config.advancedOptions.description"),i.advancedOptionsBuilder=r.getAdvancedOptionsModel().haAdvancedOptionsBuilder}angular.module("com.vmware.vsphere.client.cluster").controller("AdvancedOptionsPageController",e),
e.$inject=["$scope","i18nService"]}(),function(){"use strict";function e(e,t){function i(){var e;return e=r(n.pageModel.storagePDLSupported?n.pageModel.storageAPDSupported?"ha.config.failures.responses.host.failure.all.desc":"ha.config.failures.responses.host.failure.pdl.desc":n.pageModel.storageAPDSupported?"ha.config.failures.responses.host.failure.apd.desc":"ha.config.failures.responses.host.failure.none.desc")}function r(e){return t.getString("ClusterUi",e)}var n=this,o=e.modalOptions.dialogData.manager;n.pageModel=o.getFailuresAndResponsesModel(),n.enableHostMonitoringLabel=r("ha.config.hostmonitoring.enablefeature"),n.hostMonitoringPopupParams={title:t.getString("Common","help"),message:r("ha.config.hostmonitoring.description")},n.supportedFailureConditionsText=i()}angular.module("com.vmware.vsphere.client.cluster").controller("FailuresAndResponsesPageController",e),e.$inject=["$scope","i18nService"]}(),function(){"use strict";function e(e,t,i){function r(){return o}function n(e){return t.getString("ClusterUi",e)}var o=!1,a=this;a.datastoresGridLabel=n("ha.config.ds.preferred.heartbeat.datastores");var s=e.modalOptions.dialogData.manager;a.pageModel=s.getHeartbeatDatastoresModel(),a.hbDatastoreDescLabel=1===a.pageModel.hbDatastoresPerHost?t.getString("ClusterUi","ha.config.ds.heartbeat.hint.single",a.pageModel.hbDatastoresPerHost):t.getString("ClusterUi","ha.config.ds.heartbeat.hint.multiple",a.pageModel.hbDatastoresPerHost),a.hbDatestoreCandidatePolicyLabel=n("ha.config.ds.heartbeat.buttons.header"),a.hbDatastoreCandidatePolicies=i.getCandidatePolicies(),a.isHbDatastoresSelectionAllowed=r,e.$watch("ctrl.pageModel.hbDatastoreCandidatePolicy",function(e){o=!i.isAutoSelectPolicy(e)})}angular.module("com.vmware.vsphere.client.cluster").controller("HeartbeatDatastoresPageController",e),e.$inject=["$scope","i18nService","heartbeatDatastoresService"]}(),function(){"use strict";function e(e,t,i){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/services/ha/editHaVmMonitoring.html",scope:{haConfiguration:"="},controller:["$scope",function(r){function n(){return{min:t.getPresetLevels().LOW,max:t.getPresetLevels().HIGH,value:t.getPresetLevels().HIGH,minLabel:u("ha.config.vmResponse.vmMonitoringSensitivity.preset.low"),maxLabel:u("ha.config.vmResponse.vmMonitoringSensitivity.preset.high"),enabled:!0,width:"auto",dragHandleTitle:u("ha.config.vmResponse.vmMonitoringSensitivity")+" "+u("ha.config.vmResponse.vmMonitoringSensitivity.preset")}}function o(){var e=t.getHaMonitoringSensitivityLevel(r.vmToolsMonSettings);e!==t.getPresetLevels().CUSTOM?(r.vmToolsMonSettings.vmMonitoringSensitivityType=t.getSensitivityTypes().PRESET,r.vmMonitoringSensitivitySliderOptions.value=e):r.vmToolsMonSettings.vmMonitoringSensitivityType=t.getSensitivityTypes().CUSTOM}function a(e){var i=t.getSensitivityLevelValues(e);r.vmToolsMonSettings.vmToolsMonitorFailureInt=i.failure_interval,r.vmToolsMonSettings.vmToolsMonitorMinUpTime=i.min_uptime,r.vmToolsMonSettings.vmToolsMonitorMaxFailures=i.max_failures,r.vmToolsMonSettings.vmToolsMonitorMaxFailureWindow=i.failure_window,r.vmToolsMonSettings.vmToolsMonitorHasFailureWindow=!0}function s(){var e=r.vmToolsMonSettings.vmToolsMonitorFailureInt;(angular.isUndefined(e)||e<0)&&(r.vmToolsMonSettings.vmToolsMonitorFailureInt=0),e>i.MAX_FAILURE_INTERVAL&&(r.vmToolsMonSettings.vmToolsMonitorFailureInt=i.MAX_FAILURE_INTERVAL)}function c(){var e=r.vmToolsMonSettings.vmToolsMonitorMinUpTime;(angular.isUndefined(e)||e<0)&&(r.vmToolsMonSettings.vmToolsMonitorMinUpTime=0),e>i.MAX_MINIMUM_UPTIME&&(r.vmToolsMonSettings.vmToolsMonitorMinUpTime=i.MAX_MINIMUM_UPTIME)}function l(){var e=r.vmToolsMonSettings.vmToolsMonitorMaxFailures;(angular.isUndefined(e)||e<0)&&(r.vmToolsMonSettings.vmToolsMonitorMaxFailures=0),e>i.MAX_VM_PER_RESET&&(r.vmToolsMonSettings.vmToolsMonitorMaxFailures=i.MAX_VM_PER_RESET)}function d(){var e=r.vmToolsMonSettings.vmToolsMonitorMaxFailureWindow;(angular.isUndefined(e)||e<1)&&(r.vmToolsMonSettings.vmToolsMonitorMaxFailureWindow=1),e>i.MAX_RESETS_WINDOW_HRS&&(r.vmToolsMonSettings.vmToolsMonitorMaxFailureWindow=i.MAX_RESETS_WINDOW_HRS)}function u(t){return e.getString("ClusterUi",t)}r.monitoringLevels=t.getMonitoringLevels(),r.vmMonitoringSensitivitySliderOptions=n(),r.VM_MON_SENSITIVITY_TYPE_PRESET=t.getSensitivityTypes().PRESET,r.VM_MON_SENSITIVITY_TYPE_CUSTOM=t.getSensitivityTypes().CUSTOM,r.blockOptions={expanded:!1},r.vmToolsMonSettings=r.haConfiguration.defaultVmSettings.vmToolsMonitoringSettings,r.normalizeMaxFailureWindow=d,r.normalizeMinUpTime=c,r.normalizeMaxFailures=l,r.normalizeFailureInt=s,o(),r.$watch("vmMonitoringSensitivitySliderOptions.value",function(e){r.vmToolsMonSettings.vmMonitoringSensitivityType===t.getSensitivityTypes().PRESET&&(e=parseInt(e,10),a(e))}),r.$watch("vmToolsMonSettings.vmMonitoringSensitivityType",function(e){e===t.getSensitivityTypes().PRESET&&a(r.vmMonitoringSensitivitySliderOptions.value)}),r.haVmMonitoringLabel=u("ha.config.failures.responses.vm.monitoring.vm.monitoring.check"),r.heartbeatMonitoringLabel=u("ha.config.failures.responses.vm.monitoring.enable.heartbeat.monitoring.label"),r.heartbeatMonitoringDescriptionLabel=u("ha.config.failures.responses.vm.monitoring.desc"),r.vmMonitoringSensitivityLabel=u("ha.config.vmResponse.vmMonitoringSensitivity"),r.vmMonitoringSensitivityPresetLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.preset"),r.vmMonitoringSensitivityCustomLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.custom"),r.vmMonitoringSensitivityFailureIntervalLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.failureInterval"),r.vmMonitoringSensitivityMinUptimeLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.minUptime"),r.vmMonitoringSensitivityMaxResetsLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.maxResets"),r.vmMonitoringSensitivityMaxResetsWindowLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.maxResetsWindow"),r.vmMonitoringSensitivityNoWindowLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.noWindow"),r.vmMonitoringSensitivityMaxResetsWithinLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.maxResetsWithin"),r.vmMonitoringSensitivityHoursLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.hours"),r.vmMonitoringSensitivitySecondsLabel=u("ha.config.vmResponse.vmMonitoringSensitivity.seconds"),r.isVmMonitoringDisabled=function(){return r.haConfiguration.vmMonitoringState===t.DEFAULT_STATE.id},r.isVmMonitoringSensitivityCustom=function(){return r.vmToolsMonSettings.vmMonitoringSensitivityType===t.getSensitivityTypes().CUSTOM},r.isVmMonitoringSensitivityPreset=function(){return r.vmToolsMonSettings.vmMonitoringSensitivityType===t.getSensitivityTypes().PRESET},r.hasFailureWindow=function(){return r.vmToolsMonSettings.vmToolsMonitorHasFailureWindow===!0}}]}}angular.module("com.vmware.vsphere.client.cluster").directive("editHaVmMonitoring",e),e.$inject=["i18nService","haVmMonitoringService","haConstants"]}(),function(){function e(e,t,i,r,n){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/services/ha/haApdResponse.html",scope:{haConfiguration:"=",storageApdSupported:"="},controller:["$scope",function(o){o.isViewDisabled=function(){return!o.storageApdSupported||!o.haConfiguration.hostMonitoringEnabled||o.haConfiguration.defaultVmSettings.restartPriority===i.restartPriority.DISABLED},o.isApdRecoveryDelayDisabled=function(){return o.haConfiguration.vmcpSettings.apdResponse===i.storageVmReaction.DISABLED||o.haConfiguration.vmcpSettings.apdResponse===i.storageVmReaction.WARNING},o.normalizeRecoveryDelay=function(e){(angular.isUndefined(e.target.value)||e.target.value<o.MIN_APD_RECOVERY_DELAY)&&(o.haConfiguration.vmcpSettings.apdRecoveryDelayMinutes=o.MIN_APD_RECOVERY_DELAY),e.target.value>o.MAX_APD_RECOVERY_DELAY&&(o.haConfiguration.vmcpSettings.apdRecoveryDelayMinutes=o.MAX_APD_RECOVERY_DELAY)},o.apdResponses=t.getResponses(),o.reactionsOnApdCleared=r.getReactions(),o.responseForApdLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithapd.label"),o.responseForApdSubmenuLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithapd.submenu.label"),o.responseForApdDescription=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithapd.desc"),o.responseRecoveryLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithapd.recovery.submenu"),o.responseDelayLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithapd.recovery.delay"),o.minutesLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithapd.minutes"),o.MIN_APD_RECOVERY_DELAY=0,o.MAX_APD_RECOVERY_DELAY=Math.floor(n.MAX_INTEGER/i.SECONDS_IN_A_MINUTE)}]}}angular.module("com.vmware.vsphere.client.cluster").directive("haApdResponse",e),e.$inject=["i18nService","haApdResponseService","haConstants","haVmReactionsOnApdClearedService","clusterConstants"]}(),function(){function e(e,t,i,r,n){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/services/ha/haHostFailureResponse.html",scope:{haData:"="},controllerAs:"vm",bindToController:!0,controller:["$scope",function(o){function a(e){return t.getString("ClusterUi",e)}function s(){return{id:"vmRestart",label:u.hostFailureResponses.vmRestart,description:u.hostFailureResponses.vmRestartDescription}}function c(){var e={readyConditionLabel:a("ha.config.failures.responses.host.failure.restart.criteria.label"),readyConditionDescLabel:a("ha.config.failures.responses.host.failure.restart.criteria.condition"),postReadyDelay:a("ha.config.failures.responses.host.failure.restart.criteria.delay.enable"),postReadyPostDelayDesc:a("ha.config.failures.responses.host.failure.restart.criteria.delay.desc"),restartPriorityTimeout:a("ha.config.failures.responses.host.failure.restart.criteria.timeout"),restartPriorityTimeoutDesc:a("ha.config.failures.responses.host.failure.restart.criteria.timeout.desc"),seconds:a("ha.config.failures.responses.host.failure.restart.criteria.delay.seconds")};return e}function l(e){(angular.isUndefined(e.target.value)||e.target.value<u.MIN_POST_READY_DELAY)&&(u.haData.orchestration.defaultVmReadiness.postReadyDelay=u.MIN_POST_READY_DELAY),e.target.value>n.MAX_POST_READY_DELAY&&(u.haData.orchestration.defaultVmReadiness.postReadyDelay=n.MAX_POST_READY_DELAY)}function d(e){(angular.isUndefined(e.target.value)||e.target.value<u.MIN_RESTART_PRIORITY_TIMEOUT)&&(u.haData.haConfiguration.defaultVmSettings.restartPriorityTimeout=u.MIN_RESTART_PRIORITY_TIMEOUT),e.target.value>n.MAX_RESTART_PRIORITY_TIMEOUT&&(u.haData.haConfiguration.defaultVmSettings.restartPriorityTimeout=n.MAX_RESTART_PRIORITY_TIMEOUT)}var u=this,p=null,v=e._route.objectId;u.is65VcOrLater=!1,u.hostFailureResponses={label:a("ha.config.hostfailure.label"),vmRestart:a("ha.config.failures.responses.host.failure.vm.restart.restartvms"),vmRestartLabel:a("ha.config.failures.responses.host.failure.vm.restart.label"),vmRestartDescription:a("ha.config.failures.responses.host.failure.vm.restart.restartvms.desc"),subMenuLabel:a("ha.config.failures.responses.host.failure.response.submenu.label"),responseLabel:a("ha.config.failures.responses.host.failure.response.label")},u.hostFailureOptions={disabled:i.getDisabledOption(),vmRestart:s()},r.is65VcOrLater(v).then(function(e){u.restartPriorityOptions=i.getVmRestartPriorityOptions(e),u.data={hostFailure:u.hostFailureOptions.disabled.id,restartPriority:u.restartPriorityOptions.medium.id},u.haData.is65VcOrLater=e,u.is65VcOrLater=e,e&&(u.readyConditionOptions=i.getReadyConditionOptions(),u.vmDependencyRestartLabels=c(),u.postReadyDelayPostParams={message:c().postReadyPostDelayDesc,title:t.getString("Common","help")},u.restartPriorityTimeoutPostParams={message:c().restartPriorityTimeoutDesc,title:t.getString("Common","help")})}).then(function(){o.$watch("vm.haData.haConfiguration.defaultVmSettings.restartPriority",function(e){if(e){var t=u.hostFailureOptions.disabled.id;e!==u.hostFailureOptions.disabled.id&&(t=u.hostFailureOptions.vmRestart.id,u.data.restartPriority=e),u.data.hostFailure=t}}),o.$watch("vm.data.hostFailure",function(e){e&&(e!==u.hostFailureOptions.vmRestart.id?u.haData.haConfiguration.defaultVmSettings.restartPriority=e:p?u.haData.haConfiguration.defaultVmSettings.restartPriority=p:u.haData.haConfiguration.defaultVmSettings.restartPriority=u.restartPriorityOptions.medium.id)}),o.$watch("vm.data.restartPriority",function(e){e&&u.data.hostFailure===u.hostFailureOptions.vmRestart.id&&(p=e,u.haData.haConfiguration.defaultVmSettings.restartPriority=e)})}),u.MIN_RESTART_PRIORITY_TIMEOUT=0,u.MAX_RESTART_PRIORITY_TIMEOUT=n.MAX_RESTART_PRIORITY_TIMEOUT,u.MIN_POST_READY_DELAY=0,u.MAX_POST_READY_DELAY=n.MAX_POST_READY_DELAY,u.normalizePostReadyDelay=l,u.normalizeRestartPriorityTimeout=d}]}}angular.module("com.vmware.vsphere.client.cluster").directive("haHostFailureResponse",e),e.$inject=["$rootScope","i18nService","haHostFailureResponseService","vcService","haConstants"]}(),function(){function e(e,t,i){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/services/ha/haHostIsolationResponse.html",scope:{haConfiguration:"="},controller:["$scope",function(r){r.isViewDisabled=function(){return!r.haConfiguration.hostMonitoringEnabled||r.haConfiguration.defaultVmSettings.restartPriority===i.restartPriority.DISABLED},r.responseForHostIsolationLabel=e.getString("ClusterUi","ha.config.vm.hostIsolationResponse.label"),r.hostIsolationResponseLabel=e.getString("ClusterUi","ha.config.failures.responses.host.isolation.label"),r.hostIsolationResponseDescLabel=e.getString("ClusterUi","ha.config.failures.responses.host.isolation.desc"),r.hostIsolationResponses=t.getResponses()}]}}angular.module("com.vmware.vsphere.client.cluster").directive("haHostIsolationResponse",e),e.$inject=["i18nService","haHostIsolationResponseService","haConstants"]}(),function(){function e(e,t,i){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/services/ha/haPdlResponse.html",scope:{haConfiguration:"=",storagePdlSupported:"="},controller:["$scope",function(r){r.isViewDisabled=function(){return!r.storagePdlSupported||!r.haConfiguration.hostMonitoringEnabled||r.haConfiguration.defaultVmSettings.restartPriority===i.restartPriority.DISABLED},r.pdlResponses=t.getResponses(),r.responseForPdlLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithpdl.label"),r.responseForPdlSubmenuLabel=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithpdl.submenu.label"),r.responseForPdlDescription=e.getString("ClusterUi","ha.config.failures.responses.ds.dswithpdl.desc")}]}}angular.module("com.vmware.vsphere.client.cluster").directive("haPdlResponse",e),e.$inject=["i18nService","haPdlResponseService","haConstants"]}(),function(){"use strict";function e(e,t,i){return{restrict:"E",templateUrl:"cluster-ui/resources/cluster/views/settings/services/ha/heartbeatDatastores.html",scope:{data:"=",isEditMode:"=",datastoresGridLabel:"="},controller:["$scope","$element",function(r,n){function o(e){for(var t=$(e.target).closest("tr"),n=l.data("kendoGrid").dataItem(t),o=i.getVsphereObjectId(n.provider),a=0;a<r.data.length;a++){var s=r.data[a],c=i.getVsphereObjectId(s.provider);if(_.isEqual(c,o)){s.isPreferred=e.target.checked;break}}}function a(){n.find("[vui-datagrid] .k-grid-content").css("height",""),kendo.resize(n)}function s(t){return e.getString("ClusterUi",t)}function c(e){if(0===e.length)return void(r.hostsGridOptions.data=[]);var i=e[0];t.getDatastoreHosts(i.accessibleAndMountedHosts).then(function(e){r.hostsGridOptions.data=e})}var l,d="div.heartbeat-datastores div[kendo-grid]";r.hostsGridLabel=s("ha.config.ds.host.mounting.datastores"),r.datastoresGridOptions=t.getDatastoreGridOptions(r.isEditMode),r.hostsGridOptions=t.getHostGridOptions(r.isEditMode,a),r.$watch("data",function(e){var t=e?e:[];r.datastoresGridOptions.data=t,r.isEditMode&&(l=n.find(d),l.on("click",".row-checkbox",o))}),r.$watch(function(){return r.datastoresGridOptions.selectedItems},c),r.$on("$destroy",function(){r.isEditMode&&l.off("click",".row-checkbox",o)})}]}}angular.module("com.vmware.vsphere.client.cluster").directive("heartbeatDatastores",e),e.$inject=["i18nService","heartbeatDatastoresService","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(){t.getData(y,"com.vmware.vsphere.client.clusterui.model.services.ClusterProactiveHaConfigData").then(function(e){e&&(S._originalData={proHaEnabled:e.infraUpdateHaEnabled,automationLevel:e.behaviorInfraUpdate,remediationLevel:e.proactiveHaRemediationLevel,clusterProviders:_.map(e.clusterProviders,_.clone)},S.proHaEnabled=e.infraUpdateHaEnabled,S.automationLevel={value:e.behaviorInfraUpdate},S.remediationLevel={value:e.proactiveHaRemediationLevel},S.getAutomationLevelDesc(),S.getRemediationLevelDesc(),S.clusterProviders=e.clusterProviders,S.datagridOptions.data=e.clusterProviders),S.loading=!1})}function d(){var e=_.find(S.clusterProviders,function(e,t){return e.isEnabled!==S._originalData.clusterProviders[t].isEnabled});return S._originalData&&(S._originalData.proHaEnabled!==S.proHaEnabled||S._originalData.automationLevel!==S.automationLevel.value||S._originalData.remediationLevel!==S.remediationLevel.value||e||S.blockAtValue)}function u(){if(e.modalOptions.alerts=[],S.loading)return!1;if(!d())return!0;var t=a.getFormData(S.proHaEnabled,S.automationLevel.value,S.remediationLevel.value,S.clusterProviders),o=r.buildClusterComputeResourceSpec(t,!0);return i.validate(y,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",o).then(function(t){return t&&!t.error&&t.result&&t.result.isValid!==!0?(e.modalOptions.alerts.push({type:n.validationBanner.type.ERROR,text:t.result.validationMessage}),!1):(i.apply(y,"com.vmware.vsphere.client.cluster.ClusterComputeResourceSpec",o).then(function(e){var t=S.datagridOptions.selectedItems[0];if(!e.error&&t&&t.isEnabled&&S.blockAtValue){var r=S.datagridOptionsFailureConditionsHosts,n=a.getFilterModelSpec(S.blockAtValue,S.filterModel,S.filterHealthUpdateInfo,r.selectedItems);i.apply(y,"com.vmware.vsphere.client.cluster.ha.proactive.FilterModel",n)}}),!0)})}function p(){return[{filterable:!1,sortable:!1,groupable:!1,searchable:!1,width:"39px",headerTemplate:function(){var e,t=!1;return S.clusterProviders&&0!==S.clusterProviders.length?e=_.find(S.clusterProviders,function(e){return!e.isEnabled}):(e=!0,t=!0),'<input type="checkbox" ng-checked="'+!e+'" ng-disabled="'+t+'" ng-click="datagridOptions.onMasterCheckboxClick($event)" data-test-id="master-check-box"/>'},field:"isEnabled",type:"boolean",template:function(e){return'<input type="checkbox" class="row-checkbox" ng-checked="'+e.isEnabled+'" ng-click="datagridOptions.onProviderCheckboxClick(dataItem)">'}},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.providers.grid.provider"),field:"nameProvider",type:"string"},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.providers.grid.status"),field:"isEnabled",type:"boolean",template:function(e){var t=e.isEnabled?o.getString("ClusterUi","ha.config.proHa.provider.enabled"):o.getString("ClusterUi","ha.config.proHa.provider.disabled");return"<span>"+t+"</span>"}},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.providers.grid.isBlocked"),field:"isBlocked",type:"boolean",template:function(e){var t=e.isFiltered?o.getString("ClusterUi","ha.config.constants.yes"):o.getString("ClusterUi","ha.config.constants.no");return"<span>"+t+"</span>"}}]}function v(e){var t=e.idProvider;a.getFilterForProvider(y,t).then(function(e){e&&(S.filterModel=e.filterForProvider,S.filterHealthUpdateInfo=S.filterModel&&S.filterModel.filterHealthUpdateInfo?S.filterModel.filterHealthUpdateInfo:[],S.filterHostInfo=S.filterModel&&S.filterModel.filterHostInfo?S.filterModel.filterHostInfo:[],g(S.filterHealthUpdateInfo,S.datagridOptionsFailureConditions),g(S.filterHostInfo,S.datagridOptionsFailureConditionsHosts),S.blockAtValue=a.getBlockAtValue(S.filterHealthUpdateInfo,S.filterHostInfo))})}function m(e){return s.find(e).data("kendoGrid")}function g(e,t){t.data=e}function h(){return{selectionMode:n.grid.selectionMode.NONE,sortMode:n.grid.sortMode.NONE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:f(),onFailureComponentMasterCheckboxClick:function(e){var t=e.currentTarget.checked;_.each(S.filterHealthUpdateInfo,function(e){e.isFilterOn=t}),g(S.filterHealthUpdateInfo,S.datagridOptionsFailureConditions)},onFailureComponentSelected:function(e){if(S.filterModel&&S.filterHealthUpdateInfo){e.isFilterOn=!e.isFilterOn,_.each(S.filterHealthUpdateInfo,function(t){e.id===t.id&&(t.isFilterOn=e.isFilterOn)});var t=_.some(S.filterHealthUpdateInfo,function(e){return e.isFilterOn});t&&!S.blockAtValue&&(S.blockAtValue=c.proactiveHaBlockAtTypes.CLUSTER_LEVEL),g(S.filterHealthUpdateInfo,S.datagridOptionsFailureConditions)}}}}function f(){return[{width:"39px",headerTemplate:function(){var e;return e=!S.filterHealthUpdateInfo||0===S.filterHealthUpdateInfo.length||_.find(S.filterHealthUpdateInfo,function(e){return!e.isFilterOn}),'<input type="checkbox" ng-checked="'+!e+'" ng-click="datagridOptions.onFailureComponentMasterCheckboxClick($event)" data-test-id="failure-master-check-box"/>'},field:"isFilterOn",type:"boolean",template:function(e){return'<input type="checkbox" class="row-checkbox" ng-checked="'+e.isFilterOn+'" ng-click="datagridOptions.onFailureComponentSelected(dataItem)">'}},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.grid.component"),field:"component"},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.grid.id"),field:"id"},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.grid.desc"),field:"description",template:function(e){return e&&e.description?'<span title="'+e.description+'">'+e.description+"</span>":""}},{displayName:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.filters.grid.blocked"),field:"isFilterOn",type:"boolean",template:function(e){var t=S.blockAtValue===c.proactiveHaBlockAtTypes.INDIVIDUAL_HOSTS,i=S.datagridOptionsFailureConditionsHosts.selectedItems&&0===S.datagridOptionsFailureConditionsHosts.selectedItems.length,r=!(t&&i),n=e.isFilterOn&&r?o.getString("ClusterUi","ha.config.constants.yes"):o.getString("ClusterUi","ha.config.constants.no");return"<span>"+n+"</span>"}}]}var S=this,y=e.modalOptions.dialogData.availableTargets[0];e.modalOptions.alerts=[],e.modalOptions.onSubmit=u,e.$on("kendoWidgetCreated",function(e,t){if(t&&t.constructor===kendo.ui.Grid){var i=".enable-providers-container [kendo-grid]";S.gridWidget=m(i)}}),S.loading=!0,S.signPostConfig={message:o.getString("ClusterUi","ha.config.failures.responses.partial.failure.remediation.dd.help"),title:o.getString("Common","help")},S.automationLevels=a.AUTOMATION_LEVELS,S.remediationLevels=a.REMEDIATION_LEVELS,S.getRemediationLevelDesc=function(){S.remediationLevelDesc=a.getRemediationLevelDescription(S.remediationLevel.value)}.bind(this),S.getAutomationLevelDesc=function(){S.automationLevelDesc=a.getAutomationLevelDescription(S.automationLevel.value)}.bind(this),S.datagridOptions={selectionMode:n.grid.selectionMode.SINGLE,sortMode:n.grid.sortMode.NONE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:p(),onMasterCheckboxClick:function(e){var t=e.currentTarget.checked;_.each(S.clusterProviders,function(e){return e.isEnabled=t,S.datagridOptions.data}),_.each(S.gridWidget._data,function(e){return e.isEnabled=t,S.gridWidget._data}),S.gridWidget&&S.gridWidget.refresh()},onProviderCheckboxClick:function(e){var t=!e.isEnabled;e.isEnabled=t,_.find(S.clusterProviders,function(t){return t.nameProvider===e.nameProvider}).isEnabled=t,S.gridWidget&&S.gridWidget.setOptions(S.datagridOptions)}},S.failureConditionsSignPostParams=a.failureConditionsVuiSignPost(),S.datagridOptionsFailureConditions=h(),S.failureConditionsClusterLevelVuiSignPost=a.failureConditionsClusterLevelVuiSignPost(),S.datagridOptionsFailureConditionsHosts=a.getFailureConditionsHostsDatagridOptions(),S.proactiveHaBlockAtTypes=c.proactiveHaBlockAtTypes,S.blockAtOldValue=null,S.filterModel={},S.filterHealthUpdateInfo=[],S.filterHostInfo=[],S.preselectComparator=function(e){return e.isFilterOn},l(),e.$watch(function(){if(S.datagridOptions.selectedItems)return S.datagridOptions.selectedItems},function(e,t){if(e&&1===e.length){var i=e[0],r=t&&t.length>0?t[0].idProvider:null;i.idProvider!==r&&v(i)}},!0),e.$watch(function(){if(S.filterHealthUpdateInfo)return S.filterHealthUpdateInfo},function(e){e&&(S.isBlockAtAvailable=_.some(S.filterHealthUpdateInfo,function(e){return e.isFilterOn}))},!0),e.$watch(function(){if(S.blockAtValue)return S.blockAtValue},function(e,t){S.blockAtOldValue=t,e&&g(S.filterHealthUpdateInfo,S.datagridOptionsFailureConditions)}),e.$watchCollection(function(){if(S.datagridOptionsFailureConditionsHosts.selectedItems)return S.datagridOptionsFailureConditionsHosts.selectedItems},function(e){e&&S.filterHealthUpdateInfo.length>0&&g(S.filterHealthUpdateInfo,S.datagridOptionsFailureConditions)})}angular.module("com.vmware.vsphere.client.cluster").controller("EditProactiveHaDialogController",e),e.$inject=["$scope","dataService","mutationService","clusterSpecBuilderService","vuiConstants","i18nService","editProactiveHaService","$element","clusterConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(){return{title:h("ha.config.HA"),actions:[{actionUid:"vsphere.core.cluster.actions.editHa",customLabel:h("general.config.button.edit")}]}}function u(){return{title:h("ha.config.responseTable.header"),objectId:C,actions:[]}}function p(){t.getData(C,"com.vmware.vsphere.client.clusterui.model.services.ClusterHaData").then(function(e){P.data=e,P.haStatusHeaderOptions.title=m(e.haEnabled),P.proactiveHaTitle=g(e.infraUpdateHaEnabled,e.drsEnabled),P.isProactiveHaAvailable=e.drsEnabled,P.datagridOptions.data=e.failureConditionData.items,P.heartbeatDatastoreBlock={expanded:!1},P.isHeartbeatDatastorePolicyAllFeasible=!0,P.heartbeatDatastoresPolicyLabel="";var t=e.heartbeatDatastoreCandidatePolicy;if(t){P.isHeartbeatDatastorePolicyAllFeasible=s.isAutoSelectPolicy(t);var i="ha.config.".concat(t);P.heartbeatDatastoresPolicyLabel=h(i)}P.admissionControlData=a.getAdmissionControlModel(e);var r=!!P.data.advancedOptions&&P.data.advancedOptions.length>0;P.advancedOptionsText=h(r?"ha.config.advancedOptionsCollapsedText.show":"ha.config.advancedOptionsCollapsedText.none")})}function v(){l.is65VcOrLater(C).then(function(e){P.is65VcOrLater=e})}function m(e){return h(e?"ha.config.haEnabled":"ha.config.haDisabled")}function g(e,t){return h(t?e?"ha.config.prohaEnabled":"ha.config.prohaDisabled":"ha.config.prohaNa")}function h(e){return i.getString("ClusterUi",e)}function f(){return{selectionMode:r.grid.selectionMode.NONE,sortMode:r.grid.sortMode.NONE,searchable:!1,resizable:!1,selectedItems:[],data:[],pageConfig:{hidePager:!0},columnDefs:S(),dataBound:function(){c.find("[vui-datagrid] .k-grid-content").css("height","")},height:"100%"}}function S(){return[{displayName:h("ha.config.vmResponse.failure.column"),field:"failure"},{displayName:h("ha.config.vmResponse.failureResponse.column"),field:"failureResponse",template:function(e){var t={text:e.failureResponse},i=y(e.failureResponseType);return D([void 0,"text",i],t)}},{displayName:h("ha.config.vmResponse.details.column"),field:"details",template:function(e){return w(["details"],e)}}]}function y(e){return"responseDisabled"===e?"vsphere-icon-status-error":"responseProtected"===e?"vsphere-icon-status-ok":"responseWarnOnly"===e?"vsphere-icon-status-warning":""}var P=this,C=e._route.objectId,D=n.getColumnRenderer("object-link"),w=n.getColumnRenderer("wrapped-text");P.haStatusHeaderOptions=d(),P.headerFailureConditionsOptions=u(),P.expandForDetailsLabel=h("ha.config.expandForDetails"),P.dsForHeartbeatingLabel=h("ha.config.dsForHeartbeating"),P.datagridOptions=f(),P.watchForObjects=[C],P.liveRefreshProperties=["configurationEx.dasConfig.heartbeatDatastore","configurationEx.dasConfig.enabled","configurationEx.dasConfig.defaultVmSettings.isolationResponse","configurationEx.dasConfig.defaultVmSettings.restartPriority","configurationEx.dasConfig.hBDatastoreCandidatePolicy","configurationEx.dasConfig.admissionControlPolicy","configurationEx.dasConfig.admissionControlEnabled","configurationEx.dasConfig.admissionControlPolicy.cpuFailoverResourcesPercent","configurationEx.dasConfig.admissionControlPolicy.memoryFailoverResourcesPercent","configurationEx.dasConfig.admissionControlPolicy.failoverLevel","configurationEx.dasConfig.admissionControlPolicy.failoverHosts","configurationEx.dasConfig.option","configurationEx.dasConfig.hostMonitoring","configurationEx.dasConfig.vmMonitoring","dasAdvancedRuntimeInfo"],P.data={},P.admissionControlData={},P.getViewData=p,P.admissionControlPolicy=o.admissionControlPolicy,P.advOptionsBlock={expanded:!1},P.advancedOptionsLabel=h("ha.config.advancedOptionsLabel"),P.configParametersLabel=h("ha.config.advancedOptions.configParametersLabel"),P.proactiveHaActions=[{actionUid:"vsphere.core.cluster.actions.editProactiveHa",customLabel:h("general.config.button.edit")}],p(),v()}angular.module("com.vmware.vsphere.client.cluster").controller("VSphereHaController",e),e.$inject=["$scope","dataService","i18nService","vuiConstants","columnRenderersRegistry","haConstants","haAdmissionControlService","heartbeatDatastoresService","$element","vcService"]}(),function(){"use strict";function e(e,t,i){function r(e){return i.getString("ClusterUi",e)}var n=this;angular.extend(n,t("GenericPortletController",{$scope:e})),n.max=_.max,n.liveRefreshProperties=["summary.currentBalance"],n.getString=r}angular.module("com.vmware.vsphere.client.cluster").controller("ClusterConsumersController",e),e.$inject=["$scope","$controller","i18nService"]}(),function(){"use strict";function e(e,t,i,r){function n(e){return i.getString("ClusterUi",e)}function o(){return"function"==typeof r.PMemEnabled&&r.PMemEnabled()}var a=this;angular.extend(a,t("GenericPortletController",{$scope:e})),a.liveRefreshProperties=["summary.currentEVCModeKey","host"],a.getString=n,a.isPmemEnabled=o()}angular.module("com.vmware.vsphere.client.cluster").controller("ClusterResourcesController",e),e.$inject=["$scope","$controller","i18nService","featureFlagsService"]}(),function(){"use strict";function e(e,t,i){function r(){t.getViewData(o).then(function(t){n.signPostParams.model=e.drsModel=t})}var n=this,o=e._route.objectId;e.clusterId=[o],n.liveRefreshProperties=["configurationEx.drsConfig.enabled","configurationEx.drsConfig.defaultVmBehavior","configurationEx.drsConfig.vmotionRate","configurationEx.dpmConfigInfo.enabled","configurationEx.dpmConfigInfo.defaultDpmBehavior","summary.currentBalance","summary.targetBalance","recommendation","drsFault"],n.getViewData=r;var a=i.getString("ClusterUi","drs.portlet.tooltip.hostLoadDeviationLabel");n.signPostParams={templateUrl:"cluster-ui/resources/cluster/views/summary/drsDeviationInfoTooltipContent.html",title:a,model:null,width:440},r()}angular.module("com.vmware.vsphere.client.cluster").controller("DrsPortletController",e),e.$inject=["$scope","drsPortletService","i18nService"]}(),function(){"use strict";function e(e,t,i,r){var n=this,o=e._route.objectId;n.vmId=[o],n.liveRefreshProperties=["runtime.faultToleranceState","runtime.powerState","runtime.dasVmProtection","config.ftInfo","config.files.ftMetadataDirectory","config.flags.faultToleranceType"],n.getData=function(){var e=t.requestData(o);e.then(function(e){n.ftData=e["ftportlet:ftdata"];var t=parseInt(n.ftData.logBandwidth)||0;t>0?n.logBandwidth=r.getString("VmUi","vmFTView.logBandwidthFormat",t):n.logBandwidth=r.getString("VmUi","vmFTView.notAvailable"),n.ftData.secondaryHost&&(n.hostRef=i.getVsphereObjectId(n.ftData.secondaryHost))})},n.getData()}angular.module("com.vmware.vsphere.client.cluster").controller("FtPortletController",e),
e.$inject=["$scope","ftPortletService","defaultUriSchemeUtil","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){t.getData(u,"com.vmware.vsphere.client.clusterui.model.ClusterHaSummaryData",{queryName:"HaPortletController."+a.name}).then(function(e){if(d.haData=e,s(),e.admissionControlPolicy._type===d.admissionControlPolicyTypes.FAILOVER_LEVEL){var t;t=0!==e.numHosts?e.numHosts:0!==e.numFailoverHosts?e.numFailoverHosts:1,d.chartMaxValue=t,d.chartData=[{label:i.getString("ClusterUi","ha.portlet.hosts.chart.label"),usage:e.numHosts-e.currentNumFailoverHosts,reservation:e.numFailoverHosts}],d.chartMarkers=[{value:0,label:"0",labelAlign:"right"},{value:t,label:e.numHosts.toString(),labelAlign:"left"}]}else e.admissionControlPolicy._type===d.admissionControlPolicyTypes.FAILOVER_RESOURCES?(d.chartMaxValue=100,d.chartData=[{label:i.getString("ClusterUi","ha.portlet.cpu.chart.label"),usage:100-e.currentCpuFailoverPercent,reservation:e.cpuFailoverPercent},{label:i.getString("ClusterUi","ha.portlet.memory.chart.label"),usage:100-e.currentMemoryFailoverPercent,reservation:e.memoryFailoverPercent}],d.chartMarkers=[{value:0,label:"0%",labelAlign:"right"},{value:50,label:"50%",labelAlign:"center"},{value:100,label:"100%",labelAlign:"left"}]):e.admissionControlPolicy._type===d.admissionControlPolicyTypes.FAILOVER_HOST&&(d.datagridOptions={columnDefs:[{field:"name",displayName:i.getString("ClusterUi","ha.portlet.grid.host.header"),template:function(e){return p(["entityUid","name",e.iconId],e)}},{field:"cpuCapacityText",displayName:i.getString("ClusterUi","ha.portlet.grid.host.cpu"),sortable:function(e,t){return e.cpuCapacity-t.cpuCapacity}},{field:"memorySizeText",displayName:i.getString("ClusterUi","ha.portlet.grid.host.memory"),sortable:function(e,t){return e.memorySize-t.memorySize}}],searchable:!1,selectedItems:[]},e.hostData=e.hostData||[],e.hostData.forEach(function(e){e.entityUid=o.getVsphereObjectId(e.provider),e.memorySizeText=r("bytes")(e.memorySize,"B","GB")}),d.datagridOptions.data=e.hostData)})}function s(){var e="",t="",r=0;d.haData.admissionControlPolicy._type===d.admissionControlPolicyTypes.FAILOVER_LEVEL?(e="cluster-ui/resources/cluster/views/summary/failoverLevelInfoTooltipContent.html",t=i.getString("ClusterUi","ha.portlet.failover.level.policy"),r=400):d.haData.admissionControlPolicy._type===d.admissionControlPolicyTypes.FAILOVER_RESOURCES&&(e="cluster-ui/resources/cluster/views/summary/failoverResourceInfoTooltipContent.html",t=i.getString("ClusterUi","ha.portlet.failover.resources.policy"),r=440),d.signPostParams={templateUrl:e,title:t,model:d.haData,width:r}}function c(e){return"enabled"===e?i.getString("ClusterUi","ha.portlet.hostmonitoring.enabled"):i.getString("ClusterUi","ha.portlet.hostmonitoring.disabled")}function l(e,t){return e?i.getString("ClusterUi","ha.portlet.host.partial.failure.response."+t):i.getString("ClusterUi","ha.portlet.host.partial.failure.response.disabled")}var d=this,u=e._route.objectId,p=n.getColumnRenderer("object-link");d.clusterId=[u],d.liveRefreshProperties=["configurationEx.dasConfig.enabled","configurationEx.dasConfig.admissionControlPolicy","configurationEx.dasConfig.admissionControlEnabled","configurationEx.dasConfig.hostMonitoring","configurationEx.dasConfig.vmMonitoring","configurationEx.dasConfig.admissionControlPolicy.cpuFailoverResourcesPercent","configurationEx.dasConfig.admissionControlPolicy.memoryFailoverResourcesPercent","configurationEx.dasConfig.admissionControlPolicy.failoverHosts","configurationEx.dasConfig.admissionControlPolicy.failoverLevel","configurationEx.infraUpdateHaConfig.enabled","configurationEx.infraUpdateHaConfig.behavior","summary.admissionControlInfo.currentCpuFailoverResourcesPercent","summary.admissionControlInfo.currentMemoryFailoverResourcesPercent","summary.admissionControlInfo.currentFailoverLevel","summary.numHosts"],d.getViewData=a,d.getHostMonitoringText=c,d.getHostPartialResponse=l,d.admissionControlPolicyTypes={FAILOVER_LEVEL:"com.vmware.vim.binding.vim.cluster.FailoverLevelAdmissionControlPolicy",FAILOVER_RESOURCES:"com.vmware.vim.binding.vim.cluster.FailoverResourcesAdmissionControlPolicy",FAILOVER_HOST:"com.vmware.vim.binding.vim.cluster.FailoverHostAdmissionControlPolicy"},a()}angular.module("com.vmware.vsphere.client.cluster").controller("HaPortletController",e),e.$inject=["$scope","dataService","i18nService","$filter","columnRenderersRegistry","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){t.getData(v,"com.vmware.vsphere.client.clusterui.model.ResourcePoolSummaryData",{queryName:"RpSettingsPortletController."+o.name}).then(function(e){p.resourcePoolData=e,a(e)})}function a(e){var t=r.createPropertyViewBuilder();s(t,e),c(t,e),p.resourcePoolData=t.build()}function s(e,t){if(t){var i=e.category("").section("cpu").title(u("settings.cpu"));i.property(u("settings.shares"),l(t.configSpec.cpuAllocation.shares)),i.property(u("settings.reservation"),t.cpuReservationFormatted),i.property(u("settings.limit"),t.cpuLimitFormatted),i.property(u("settings.worstcase"),t.cpuWorstCaseAllocationFormatted)}}function c(e,t){if(t){var i=e.category("").section("memory").title(u("settings.memory"));i.property(u("settings.shares"),l(t.configSpec.memoryAllocation.shares)),i.property(u("settings.reservation"),t.memoryReservationFormatted),i.property(u("settings.limit"),t.memoryLimitFormatted),i.property(u("settings.worstcase"),t.memoryWorstCaseAllocationFormatted)}}function l(e){return i.getString("RpUi","resourceAllocationInfoControl.shares",d(e.level),e.shares)}function d(e){switch(e){case n.sharesLevel.LOW:return u("rpList.lowSharesLabel");case n.sharesLevel.HIGH:return u("rpList.highSharesLabel");case n.sharesLevel.NORMAL:return u("rpList.normalSharesLabel");case n.sharesLevel.CUSTOM:return u("rpList.customSharesLabel")}}function u(e){return i.getString("RpUi",e)}var p=this,v=e._route.objectId;p.rpId=[v],p.getViewData=o,p.liveRefreshProperties=["config","summary.quickStats.staticCpuEntitlement","summary.quickStats.staticCpuEntitlement"],o()}angular.module("com.vmware.vsphere.client.cluster").controller("RpSettingsPortletController",e),e.$inject=["$scope","dataService","i18nService","vxPropertyViewService","sharesLevelsConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){t.getData(m,"com.vmware.vsphere.client.clusterui.model.services.VmFailureResponsesData",{queryName:"VmHaPortletController."+a.name}).then(function(e){v.haProtection=s(e.dasVmProtection),v.gridOptions.data=e.mergedItems,v.signPostParams=u(e)})}function s(e){var t={};return null===e?(t.icon="vsphere-icon-status-unknown",t.label=p("failureResponseView.naStatus"),t.description=p("failureResponseView.tooltip.naStatus.descr")):e.dasProtected?(t.icon="vsphere-icon-status-ok",t.label=p("failureResponseView.protectedStatus"),t.description=p("failureResponseView.tooltip.protectedStatus.descr")):(t.icon="vsphere-icon-status-error",t.label=p("failureResponseView.unprotectedStatus"),t.description=p("failureResponseView.tooltip.unprotectedStatus.descr")),t.description='<span class="cluster-tooltip-content-wrapper">'+t.description+"</span>",t}function c(){return{selectionMode:r.grid.selectionMode.NONE,sortMode:r.grid.sortMode.NONE,searchable:!1,resizable:!1,selectedItems:[],data:[],pageConfig:{hidePager:!0},columnDefs:l(),dataBound:function(){o.find("[vui-datagrid] .k-grid-content").css("height","")},height:"100%"}}function l(){return[{displayName:p("ha.config.vmResponse.failure.column"),field:"failure"},{displayName:p("ha.config.vmResponse.failureResponse.column"),field:"failureResponse",template:function(e){var t={text:e.failureResponse,title:e.details},i=d(e.failureResponseType);return g([void 0,"text",i,void 0,void 0,"title"],t)}}]}function d(e){return"responseDisabled"===e?"vsphere-icon-status-error":"responseProtected"===e?"vsphere-icon-status-ok":"responseWarnOnly"===e?"vsphere-icon-status-warning":""}function u(e){var t=s(e.dasVmProtection);return{title:t.label,message:t.description}}function p(e){return i.getString("ClusterUi",e)}var v=this,m=e._route.objectId,g=n.getColumnRenderer("object-link");v.vmId=[m],v.getViewData=a,v.liveRefreshProperties=["runtime.dasVmProtection","cluster","dasVmSettings"],v.haProtectionLabel=p("failureResponseView.haProtection.label"),v.gridOptions=c(),a()}angular.module("com.vmware.vsphere.client.cluster").controller("VmHaPortletController",e),e.$inject=["$scope","dataService","i18nService","vuiConstants","columnRenderersRegistry","$element"]}(),h5=h5||{},h5.dsCluster={angularModule:angular.module("com.vmware.vsphere.client.dsCluster",[])};var ds_cluster_ui;!function(e){angular.module("com.vmware.vsphere.client.dsCluster").run(["columnRenderersRegistry","i18nService",function(e,t){e.registerColumnRenderers({"datastore-name":function(i,r,n){var o=e.getColumnRenderer("object-name");return r.datastoreName="",r.datastoreNames&&(r.datastoreTitle=r.datastoreNames.join(", "),1===r.datastoreNames.length?(r.datastoreIcon="vsphere-icon-datastore",r.datastoreName=r.datastoreNames[0]):r.datastoreNames.length>1&&(r.datastoreName=t.getString("DsClusterUi","sdrs.rules.config.multipleDatastores"))),o([null,"datastoreIcon","datastoreName",null,"datastoreTitle"],r,n)}})}]).run(["createDsClusterWizardService","sdrsDialogService","sdrsRulesService","clarityModalService","i18nService","mutationService","dsClusterConstants","storageVmOverridesService","addSdrsVmOverridesService","datastoreMaintenanceModeService","scheduleSdrsWizardService",function(e,t,i,r,n,o,a,s,c,l,d){function u(t,i){e.show(i[0])}function p(e,i){t.show(i[0])}function v(e,t,i){c.openAddVmOverridesWizard(t[0])}function m(e,t,i,o){var s;s=i===a.operationType.ADD?n.getString("DsClusterUi","sdrs.rules.rules.config.title.add"):n.getString("DsClusterUi","sdrs.rules.rules.config.title.edit"),r.openOkCancelModal({title:s,subTitle:{objectId:t[0]},defaultButton:"submit",modalClass:"ds-cluster-add-sdrs-rule-modal",dialogData:{operationType:i,context:o},contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/addSdrsRule.html"})}function g(e,t,i){var o={title:n.getString("DsClusterUi","rules.config.members.dialog.title"),subTitle:i.dialogSubTitleObject,size:"lg",defaultButton:"submit",modalClass:"ds-cluster-add-sdrs-rule-member-dialog",contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/addSdrsVmRuleMember.html",dialogData:{selectedVms:i.selectedMembers,objectId:t[0]},onSubmit:function(){return i.submitCallback(o)}};r.openOkCancelModal(o)}function h(e,t,i){var o={title:n.getString("DsClusterUi","vms.per.dscluster.single.selection.title"),subTitle:i.dialogSubTitleObject,size:"lg",defaultButton:"submit",modalClass:"ds-cluster-add-sdrs-rule-member-dialog",contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/addSdrsVmdkRuleMember.html",dialogData:{selectedVms:i.selectedMembers,objectId:t[0]},onSubmit:function(){return i.submitCallback(o)}};r.openOkCancelModal(o)}function f(e,t,i){var o=i.confirmCallback,a={title:n.getString("Common","sdrs.rules.config.remove.vmmember.question.title"),message:n.getString("Common","sdrs.rules.config.remove.vmmember.question.text"),submit:function(){return o()}};r.openConfirmationModal(a)}function S(e,t,r){i.deleteRule(t[0],r.selectedRule)}function y(e,t){var i={title:n.getString("DsClusterUi","vmOverrides.actionDelete.caption"),defaultButton:"submit",contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/sdrsVmOverrides/removeSdrsVmOverridesView.html",dialogData:{context:t,objectId:e[0]}};r.openOkCancelModal(i)}function P(e,t){var i=a.vmOverridesOperationType.EDIT,n=s.getEditVmOverridesDialogTitle(t),o={title:n,defaultButton:"submit",size:"lg",contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/sdrsVmOverrides/editSdrsVmOverridesView.html",dialogData:{context:t,objectId:e,mode:i},modalClass:"ds-cluster-add-sdrs-override-dialog"};r.openOkCancelModal(o)}function C(e,t,i){l.initiateEnterMaintenanceMode(t[0])}function D(e,t,i){l.exitMaintenanceMode(t[0])}function w(e,t,i){d.show(t[0],i&&i.focusTarget)}function b(e,t){1===t.length?o.remove(t[0]):t.length>1&&o.removeOnMultiEntity(t)}h5.actions["vsphere.core.dsCluster.actions.add"]=u,h5.actions["vsphere.core.dsCluster.actions.editSdrs"]=p,h5.actions["vsphere.core.dscluster.actions.rule.add"]=function(e,t,i){return m(e,t,a.operationType.ADD,i)},h5.actions["vsphere.core.dscluster.actions.rule.members.add"]=g,h5.actions["vsphere.core.dscluster.actions.rule.edit"]=function(e,t,i){return m(e,t,a.operationType.EDIT,i)},h5.actions["vsphere.core.dscluster.actions.rule.members.remove"]=f,h5.actions["vsphere.core.dscluster.actions.rule.remove"]=S,h5.actions["vsphere.core.dscluster.actions.rule.vmdk.members.add"]=h,h5.actions["vsphere.core.dscluster.actions.vmoverrides.remove"]=function(e,t,i){y(t,i)},h5.actions["vsphere.core.dscluster.actions.vmOverrides.add"]=v,h5.actions["vsphere.core.dscluster.actions.vmOverrides.edit"]=function(e,t,i){P(t,i)},h5.actions["vsphere.core.datastore.actions.enterMaintenanceMode"]=C,h5.actions["vsphere.core.datastore.actions.exitMaintenanceMode"]=D,h5.actions["vsphere.core.dsCluster.actions.scheduleSdrs"]=w,h5.actions["vsphere.core.dscluster.actions.delete"]=b}])}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={model:"=",isAutofocusDisabled:"="},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/components/dsAutomation.html"}return e}();e.DsAutomationComponent=t;var i=function(){function e(e,t,i,r){this.vuiConstants=e,this.i18nService=t,this.columnRenderersRegistry=i,this.storageDrsAutomationService=r,this.i18n=this.i18nService.getString,this.buildSignPostParams(),this.automationLevels=r.getSdrsAutomationLevels(t.getString("DsClusterUi","sdrs.config.automationLevelLabel")),this.automationOverridesOptions=r.getSdrsAutomationOverridesOptions()}return e.prototype.buildSignPostParams=function(){this.signPostParams={spaceLoadBalanceAutomationMode:{message:this.i18nService.getString("DsClusterUi","sdrs.config.automationLevel.spaceBalanceDescriptionLabel"),title:this.i18nService.getString("Common","help")},ioLoadBalanceAutomationMode:{message:this.i18nService.getString("DsClusterUi","sdrs.config.automationLevel.ioBalanceDescriptionLabel"),title:this.i18nService.getString("Common","help")},ruleEnforcementAutomationMode:{message:this.i18nService.getString("DsClusterUi","sdrs.config.automationLevel.ruleEnforcementDescriptionLabel"),title:this.i18nService.getString("Common","help")},policyEnforcementAutomationMode:{message:this.i18nService.getString("DsClusterUi","sdrs.config.automationLevel.policyEnforcementDesciprionLabel"),title:this.i18nService.getString("Common","help")},vmEvacuationAutomationMode:{message:this.i18nService.getString("DsClusterUi","sdrs.config.automationLevel.vmEvacuationDescriptionLabel"),title:this.i18nService.getString("Common","help")}}},e.$inject=["vuiConstants","i18nService","columnRenderersRegistry","storageDrsAutomationService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("dsAutomation",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={model:"="},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/components/runtimeSettings.html"}return e}();e.RuntimeSettingsComponent=t;var i=function(){function e(e,t,i){this.vuiConstants=e,this.i18nService=t,this.dsClusterConstants=i,this.i18n=this.i18nService.getString,this.ioMetricsInclusionLegend=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.ioMetricsInclusion.legend"),this.ioMetricsInclusionCheck=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.ioMetricsInclusion.check"),this.ioLatencyThresholdLegend=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.ioLatencyThreshold.legend"),this.ioLatencyThresholdDesc=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.ioLatencyThreshold.desc"),this.spaceThresholdLegend=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.legend"),this.spaceThresholdDesc=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.sdrsThreshold.desc"),this.utilizedSpaceLabel=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.utilizedSpace.label"),this.utilizedSpaceUnit=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.utilizedSpace.unit"),this.utilizedSpaceDesc=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.utilizedSpace.desc"),this.minFreeSpaceLabel=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.minFreeSpace.label"),this.minFreeSpaceMetricLabel=this.i18n("DsClusterUi","sdrs.config.minFreeSpaceThreshold.metricLabel"),this.minFreeSpaceDesc=this.i18n("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.minFreeSpace.desc")}return e.prototype.$onInit=function(){this.buildSignPostParams(),this.initMinMaxThresholdValues()},e.prototype.initMinMaxThresholdValues=function(){this.minUtilizationThreshold=this.dsClusterConstants.spaceUtilizationThreshold.MIN,this.maxUtilizationThreshold=this.dsClusterConstants.spaceUtilizationThreshold.MAX,this.minLatencyThreshold=this.dsClusterConstants.ioLatencyThreshold.MIN,this.maxLatencyThreshold=this.dsClusterConstants.ioLatencyThreshold.MAX},e.prototype.normalizeFreeSpaceThreshold=function(){void 0!==this.model&&void 0!==this.model.spaceLoadBalanceConfig&&(this.model.spaceLoadBalanceConfig.freeSpaceThresholdGB=this.normalize(this.model.spaceLoadBalanceConfig.freeSpaceThresholdGB,this.dsClusterConstants.freeSpaceThresholdGB.MIN,this.dsClusterConstants.MAX_INTEGER))},e.prototype.normalizeIOLatencyThreshold=function(){void 0!==this.model&&void 0!==this.model.ioLatencyThreshold&&void 0!==this.minLatencyThreshold&&void 0!==this.maxLatencyThreshold&&(this.model.ioLatencyThreshold=this.normalize(this.model.ioLatencyThreshold,this.minLatencyThreshold,this.maxLatencyThreshold))},e.prototype.normalizeUtilizationThreshold=function(){void 0!==this.model&&void 0!==this.model.spaceLoadBalanceConfig&&void 0!==this.model.spaceLoadBalanceConfig.spaceUtilizationThreshold&&void 0!==this.minUtilizationThreshold&&void 0!==this.maxUtilizationThreshold&&(this.model.spaceLoadBalanceConfig.spaceUtilizationThreshold=this.normalize(this.model.spaceLoadBalanceConfig.spaceUtilizationThreshold,this.minUtilizationThreshold,this.maxUtilizationThreshold))},e.prototype.normalize=function(e,t,i){return Math.max(Math.min(e,i),t)},e.prototype.buildSignPostParams=function(){this.signPostParams={message:this.i18nService.getString("DsClusterUi","sdrs.config.ioMetrics.info"),title:this.i18nService.getString("Common","help")}},e.$inject=["vuiConstants","i18nService","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("runtimeSettings",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={computedSdrsRecommendations:"<",alwaysOverrideRecommendations:"<",noLinks:"<",skipApplyButton:"<",recommendationStore:"=",gridTitle:"<"},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/components/sdrsRecommendationsList/sdrsRecommendationsList.html"}return e}();e.SdrsRecommendationsListComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c){this.i18nService=e,this.vuiConstants=t,this.drsRecommendationsService=i,this.$rootScope=r,this.columnRenderersRegistry=n,this.clarityModalService=o,this.defaultUriSchemeUtil=a,this.mutationService=s,this.numberFormatterService=c,this.overrideRecommendations=!1,this.gridOptions=this.getRecommenadtionsGridOptions()}return e.prototype.$onInit=function(){var e=this;this.isRecommendationChecked=function(t){return e.recommendationStore.isRecommendationChecked(t)},this.applyRecommendationsActionLabel=this.getString("applyRecomendationsActionLabel"),this.overrideSdrsRecommendationsLabel=this.getString("sdrs.recommendations.overrideSdrsRecommendationsLabel")},e.prototype.$onChanges=function(e){if(e&&e.computedSdrsRecommendations.currentValue){this.objectId=e.computedSdrsRecommendations.currentValue.id;var t=e.computedSdrsRecommendations.currentValue.computedSdrsRecommendations;this.gridOptions&&t&&(this.gridOptions.data=this.formatGridColumnValues(t));var i=_.map(t,function(e){return e.recommendationData}),r=this.drsRecommendationsService.createRecommendationsStore(i),n=r.getRecommendationKeys();if(this.recommendationStore){var o=this.recommendationStore.getRecommendationKeys(),a=!this.arrayEq(n.sort(),o.sort());a&&(this.recommendationStore=r)}else this.recommendationStore=r;this.alwaysOverrideRecommendations&&(this.overrideRecommendations=t&&t.length>0,this.checkRecommendations())}},e.prototype.formatGridColumnValues=function(e){var t=this,i=this.getString("sdrs.recommendations.columns.before.label")+" ",r=this.getString("sdrs.recommendations.columns.after.label")+" ",n=this.getString("sdrs.recommendations.columns.source.label")+" ",o=this.getString("sdrs.recommendations.columns.destination.label")+" ";return _.each(e,function(e){e.utilizationSource=i+t.roundToOneDecimal(e.spaceUtilSrcBefore)+"\n"+r+t.roundToOneDecimal(e.spaceUtilSrcAfter),e.utilizationDestination=i+t.roundToOneDecimal(e.spaceUtilDstBefore)+"\n"+r+t.roundToOneDecimal(e.spaceUtilDstAfter),e.ioLatencyBefore=n+t.roundToOneDecimal(e.ioLatencySrcBefore)+"\n"+o+t.roundToOneDecimal(e.ioLatencyDstBefore)}),e},e.prototype.arrayEq=function(e,t){return e.length===t.length&&e.every(function(e,i){return e===t[i]})},e.prototype.roundToOneDecimal=function(e){return this.numberFormatterService.format(+(Math.round(parseFloat(e+"e+1"))+"e-1"))},e.prototype.getRecommenadtionsGridOptions=function(){return{searchable:!1,resizable:!0,selectable:!1,scrollable:!0,data:[],columnDefs:this.getColumnDefs(),pageConfig:{hidePager:!0},height:"100%"}},e.prototype.getColumnDefs=function(){return[{displayName:this.getString("sdrs.recommendations.columns.apply"),field:"recommendationText",type:"string",width:"10%",template:this.checkboxColumnTemplate},{displayName:this.getString("sdrs.recommendations.columns.recommendation"),field:"recommendationText",type:"string",width:"21%",template:this.recommendationTextRenderer.bind(this)},{displayName:this.getString("sdrs.recommendations.columns.reason"),field:"recommendationData.parentRecommendation.reasonText",type:"string",width:"21%"},{displayName:this.getString("sdrs.recommendations.columns.utilization.source"),field:"utilizationSource",type:"string",template:function(e){return"<span class='column-value-pre-wrap'>"+e.utilizationSource+"</span>"}},{displayName:this.getString("sdrs.recommendations.columns.utilization.destination"),field:"utilizationDestination",type:"string",template:function(e){return"<span class='column-value-pre-wrap'>"+e.utilizationDestination+"</span>"}},{displayName:this.getString("sdrs.recommendations.columns.latency"),field:"ioLatencyBefore",type:"string",template:function(e){return"<span class='column-value-pre-wrap'>"+e.ioLatencyBefore+"</span>"}}]},e.prototype.applyRecommendations=function(){if(this.recommendationStore){var e=this.recommendationStore.getRecommendationsToApply(),t={operation:"apply",keys:e};this.mutationService.apply(this.objectId,"com.vmware.vsphere.client.dscluster.services.sdrs.DatastoreClusterRecommendationSpec",t)}},e.prototype.checkboxColumnTemplate=function(e){if(!e.recommendationData.isFirst)return"";var t=e.recommendationData.parentRecommendation.key,i='<div class="centered-content-container">\n               <input type="checkbox"\n                  ng-disabled="!$parent.$parent.$ctrl.overrideRecommendations"\n                  ng-checked="$parent.$parent.$ctrl.isRecommendationChecked(\''+t+"')\n                  || !$parent.$parent.$ctrl.overrideRecommendations\"\n                  ng-click=\"$parent.$parent.$ctrl.onRecommendationCheckboxClick('"+t+"')\"/>\n            </div>";return i},e.prototype.checkRecommendations=function(){var e=this,t=this.recommendationStore.getRecommendationKeys();_.each(t,function(t){e.recommendationStore.isRecommendationChecked(t)||e.recommendationStore.checkRecommendation(t)})},e.prototype.onOverrideRecommendationsClick=function(){this.checkRecommendations()},e.prototype.onRecommendationCheckboxClick=function(e){var t=this.recommendationStore.isRecommendationChecked(e);if(t){if(this.recommendationStore.uncheckRecommendation(e)){var i=this.$rootScope.$new();i.modalOptions=this.getUncheckedDependantRecommendationsModalOptions(),this.clarityModalService.openPopUp(i)}}else if(this.recommendationStore.checkRecommendation(e)){var i=this.$rootScope.$new();i.modalOptions=this.getCheckedPrerequisiteRecommendationsModalOptions(),this.clarityModalService.openPopUp(i)}},e.prototype.recommendationTextRenderer=function(e){var t=this,i=this.columnRenderersRegistry.getColumnRenderer("object-name"),r=e.targets.map(function(e){e.uid=t.defaultUriSchemeUtil.getVsphereObjectId(e.provider);var r;return r=t.noLinks?'"'+e.name+'"':i(["uid",null,"name","labelIds"],e)}),n=this.i18nService.interpolate(e.recommendationText,r);return e.image&&(n='<span class="'+e.image+'"></span>'+n),n},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("DsClusterUi",e,t)},e.prototype.getCheckedPrerequisiteRecommendationsModalOptions=function(){return{title:this.i18nService.getString("ClusterUi","prerequisite.recommendations.selected.title"),contentUrl:"cluster-ui/resources/cluster/views/monitor/drs/checkedPrerequisiteRecommendationsModal.html"}},e.prototype.getUncheckedDependantRecommendationsModalOptions=function(){return{title:this.i18nService.getString("ClusterUi","dependent.recommendations.unselected.title"),contentUrl:"cluster-ui/resources/cluster/views/monitor/drs/uncheckedDependantRecommendationsModal.html"}},e.$inject=["i18nService","vuiConstants","drsRecommendationsService","$rootScope","columnRenderersRegistry","clarityModalService","defaultUriSchemeUtil","mutationService","numberFormatterService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("sdrsRecommendationsList",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){angular.module("com.vmware.vsphere.client.dsCluster").constant("createDsClusterPageConstants",{NAME_AND_LOCATION_INDEX:0,AUTOMATION_INDEX:1,RUNTIME_INDEX:2,HOSTS_AND_CLUSTERS_INDEX:3,DATASTORES_INDEX:4,READY_TO_COMPLETE_INDEX:5})}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e){this.i18nService=e,this.datastoreOptions=[{label:this.i18nService.getString("DsClusterUi","createDsClusterWizard.selectDatastoresPage.showDatastores.connectedToAll"),filterId:"datastoresWithoutPMemDatastoresFilter"},{label:this.i18nService.getString("DsClusterUi","createDsClusterWizard.selectDatastoresPage.showDatastores.showAll"),filterId:"allDatastoresWithoutPMemDatastoresFilter"}]}return e.prototype.getOptions=function(){return this.datastoreOptions},e.$inject=["i18nService"],e}();e.CreateDsClusterWizardDatastoresService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("createDsClusterWizardDatastoresService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.mutationService=e,this.i18nService=t,this.dsClusterConstants=i}return e.prototype.getHostsAndClusters=function(e,t){var i=this.getValidationSpec(e,t);return this.mutationService.validateSpec(this.dsClusterConstants.HOSTS_AND_CLUSTERS_VALIDATE_SPEC,i).then(function(e){return e.result})},e.prototype.getValidationSpec=function(e,t){var i={_type:this.dsClusterConstants.HOSTS_AND_CLUSTERS_VALIDATE_SPEC,datastores:e,hostsAndClustersIds:t};return i},e.$inject=["mutationService","i18nService","dsClusterConstants"],e}();e.CreateDsClusterWizardHostsAndClustersService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("createDsClusterWizardHostsAndClustersService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.vuiConstants=t,this.mutationService=i,this.dsClusterSpecBuilderService=r,this.dsClusterConstants=n,this.defaultUriSchemeUtil=o,this.$rootScope=a,this.sdrsDialogManager=s,this.createPages()}return e.prototype.getPageDefinitions=function(){return[this.nameAndLocationPageDef,this.automationPageDef,this.runtimeSettingsPageDef,this.hostsAndClustersPageDef,this.datastoresPageDef,this.readyToCompletePageDef]},e.prototype.submit=function(){var e=this.getModel(),t=this.dsClusterSpecBuilderService.buildDsClusterSpec(e,!0);return this.mutationService.add(this.dsClusterConstants.DS_CLUSTER_SPEC_TYPE,t),!0},e.prototype.setModelDatastoreRefs=function(){var e=this.getModel(),t=this;e.datastoreRefs=[],e.datastores.forEach(function(i){e.datastoreRefs.push(t.defaultUriSchemeUtil.getManagedObjectReference(i))})},e.prototype.getModel=function(){return this.model},e.prototype.getWizardConfig=function(){var e=this;return this.wizardConfig||(this.wizardConfig={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.title"),pages:this.getPageDefinitions(),show:!0,loading:!1,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),onFinish:function(){return e.submit()},cssClass:"create-ds-cluster-wizard"}),this.wizardConfig},e.prototype.initModel=function(e){this.model={objectId:e,name:this.i18nService.getString("DsClusterUi","createDsClusterWizard.defaultName"),hostsAndClusters:[],datastores:[],datastoreRefs:[],datastoreDetails:[],parent:this.defaultUriSchemeUtil.getManagedObjectReference(e),dsFilter:{filterId:"datastoresWithoutPMemDatastoresFilter"},sdrsEnabled:!0,defaultVmBehavior:this.dsClusterConstants.SDRS_FULLAUTO,automationOverrides:this.sdrsDialogManager.getAutomationOverridesModel(null),ioLoadBalanceEnabled:!0,ioLatencyThreshold:this.dsClusterConstants.ioLatencyThreshold.DEFAULT,spaceLoadBalanceConfig:this.sdrsDialogManager.getSpaceLoadBalanceConfigModel()}},e.prototype.createPages=function(){this.nameAndLocationPageDef={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.nameAndLocationPage.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/create/nameAndLocationPage.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){}},this.automationPageDef={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.automationLevelPage.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/create/dsAutomationPage.html",state:this.vuiConstants.wizard.pageState.DISABLED,onCommit:function(){}},this.runtimeSettingsPageDef={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/create/runtimeSettingsPage.html",state:this.vuiConstants.wizard.pageState.DISABLED,onCommit:function(){}},this.hostsAndClustersPageDef={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.hostsAndClustersPage.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/create/hostsAndClustersPage.html",state:this.vuiConstants.wizard.pageState.DISABLED,onCommit:function(){}},this.datastoresPageDef={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.selectDatastoresPage.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/create/datastoresPage.html",state:this.vuiConstants.wizard.pageState.DISABLED,onCommit:function(){}},this.readyToCompletePageDef={title:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/create/readyToCompletePage.html",state:this.vuiConstants.wizard.pageState.DISABLED,onCommit:function(){}}},e.prototype.changeSdrsPagesVisibility=function(e){
e?(this.automationPageDef.state=this.vuiConstants.wizard.pageState.DISABLED,this.runtimeSettingsPageDef.state=this.vuiConstants.wizard.pageState.DISABLED):(this.automationPageDef.state=this.vuiConstants.wizard.pageState.SKIPPED,this.runtimeSettingsPageDef.state=this.vuiConstants.wizard.pageState.SKIPPED)},e.$inject=["i18nService","vuiConstants","mutationService","dsClusterSpecBuilderService","dsClusterConstants","defaultUriSchemeUtil","$rootScope","sdrsDialogManager"],e}();e.CreateDsClusterWizardManager=t,angular.module("com.vmware.vsphere.client.dsCluster").service("createDsClusterWizardManager",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.dialogManager=r,this.pageStateManagementService=n}return e.prototype.show=function(e){var t=this.$rootScope.$new();this.dialogManager.initModel(e),t.wizardConfig=this.dialogManager.getWizardConfig(),this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(t),this.vuiWizardService({scope:t,configObjectName:"wizardConfig"}).show()},e.$inject=["$rootScope","i18nService","vuiWizardService","createDsClusterWizardManager","pageStateManagementService"],e}();e.CreateDsClusterWizardService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("createDsClusterWizardService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.mutationService=e,this.dsClusterConstants=t,this.dataService=i,this.clarityModalService=r,this.i18nService=n,this.sdrsFaultsService=o,this.defaultUriSchemeUtil=a,this.clarityConstants=s,this.actionsService=c,this.$q=l,this.drsRecommendationsService=d,this.drsFaultsViewConstants=u,this.columnRenderersRegistry=p,this.vuiConstants=v}return e.prototype.enterMaintenanceMode=function(e,t){var i=this;this.requestMaintenanceModeOperation(e,this.dsClusterConstants.maintenanceMode.enter).then(function(r){i.analyzeOperationResult(r,e,t)})},e.prototype.exitMaintenanceMode=function(e){this.requestMaintenanceModeOperation(e,this.dsClusterConstants.maintenanceMode.exit)},e.prototype.initiateEnterMaintenanceMode=function(e){var t=this,i=this.displayWarningCheck(e);i.then(function(i){i.shouldWarn?t.displayWarning(e,i):t.enterMaintenanceMode(e,t.defaultUriSchemeUtil.getVsphereObjectId(i.parentPod))})},e.prototype.getFaultDetailsGridOptions=function(e){return{selectionMode:this.vuiConstants.grid.selectionMode.NONE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,scrollable:!0,data:e,selectedItems:[],columnDefs:this.getFaultsColumnDefs(),pageConfig:{hidePager:!0},height:"100%"}},e.prototype.getFaultsColumnDefs=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("icon-text");return[{displayName:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.faults.datagrid.vmHeader"),field:this.drsFaultsViewConstants.VM_NAME_KEY,type:"string",template:function(i){var r={icon:i[e.drsFaultsViewConstants.VM_ICON_KEY],text:i[e.drsFaultsViewConstants.VM_NAME_KEY]};return t(["icon","text"],r)}},{displayName:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.faults.datagrid.vmDisksHeader"),field:this.drsFaultsViewConstants.DISK_NAME_KEY,type:"string",template:"#:"+this.drsFaultsViewConstants.DISK_NAME_KEY+"#"},{displayName:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.faults.datagrid.hostHeader"),field:this.drsFaultsViewConstants.HOST_NAME_KEY,type:"string",template:function(i){var r={icon:i[e.drsFaultsViewConstants.HOST_ICON_KEY],text:i[e.drsFaultsViewConstants.HOST_NAME_KEY]};return t(["icon","text"],r)}},{displayName:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.faults.datagrid.descriptionHeader"),field:this.drsFaultsViewConstants.DESCRIPTION_KEY,type:"string",template:"#:"+this.drsFaultsViewConstants.DESCRIPTION_KEY+"#"}]},e.prototype.analyzeOperationResult=function(e,t,i){var r=this,n=[];if(e.result.faults&&e.result.faults.forEach(function(e){n=n.concat(r.sdrsFaultsService.getMaintenaceModeFaultDetailsData(e))}),e.result.faults||e.result.recommendations){var o={computedSdrsRecommendations:e.result.recommendations,id:this.defaultUriSchemeUtil.getVsphereObjectId(e.entity)};this.displayFaultsAndRecommendations(e.taskUid,n,o,t,i)}},e.prototype.displayFaultsAndRecommendations=function(e,t,i,r,n){var o=this,a={},s={title:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.title"),subTitle:{objectId:r},modalClass:"ds-enter-maintenance-mode-hide-close-button",dialogData:a,size:"xl",submitButtonTitle:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.button.continue"),defaultButton:"submit",onCancel:function(){o.mutationService.apply(e,"com.vmware.vise.core.model.monitor.TaskStateSpec",{cancel:"true"})}};if(i.computedSdrsRecommendations){var c=this.drsRecommendationsService.createRecommendationsStore(new Array(0));a={recommendations:i,parentPodId:n,recommendationStore:c},s.contentTemplate="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/enterMaintenanceModeRecommendationsWarning.html",s.onSubmit=function(){var e="com.vmware.vsphere.client.dscluster.maintenancemode.DatastoreMaintenanceSpec",t={maintenanceOpType:o.dsClusterConstants.maintenanceMode.applyRecommendations,keys:s.dialogData.recommendationStore.getRecommendationsToApply()};return o.mutationService.apply(r,e,t),!0},t&&t.length>0&&(a.faults=t,s.contentTemplate="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/faultsAndRecommendations.html")}else t&&t.length>0&&(a={faults:t},s.contentTemplate="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/enterMaintenanceModeFaultsWarning.html",s.onSubmit=function(){return!0});s.dialogData=a,this.clarityModalService.openOkCancelModal(s)},e.prototype.displayWarningCheck=function(e){return this.dataService.getData(e,"com.vmware.vsphere.client.dscluster.model.DatastoreEnterMaintenanceModeWarningData").then(function(e){return e})},e.prototype.displayWarning=function(e,t){var i=this,r=_.map(t.vms,function(e){return i.defaultUriSchemeUtil.getVsphereObjectId(e)}),n=[this.mutationService.validateSpec("com.vmware.vsphere.client.h5.vm.model.migration.VmMigrationFlowValidationSpec",{vms:r}),this.actionsService.getAction("vsphere.core.vm.actions.migrate",r,!1)],o={title:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.title"),subTitle:{objectId:e},modalClass:"ds-enter-maintenance-mode-hide-close-button",contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/enterMaintenanceModeWarning.html",defaultButton:"submit",submitButtonTitle:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.button.continue"),dialogData:{shouldStartMigrateWizard:!1,parentPod:t.parentPod,vmIds:r,actionEval:{invoker:"vsphere.core.vm.actions.vmMigrate",action:{uid:"vsphere.core.vm.actions.migrate",confirmationTextAll:"CUSTOM",confirmationTextSome:"CUSTOM",label:this.i18nService.getString("VmUi","actionLabelMigrate")}},promise:this.$q.all(n)},onSubmit:function(){return i.enterMaintenanceMode(e,t.parentPod),o.dialogData.shouldStartMigrateWizard&&i.actionsService.invokeAction(o.dialogData.actionEval),!0}};this.clarityModalService.openOkCancelModal(o)},e.prototype.requestMaintenanceModeOperation=function(e,t){var i="com.vmware.vsphere.client.dscluster.maintenancemode.DatastoreMaintenanceSpec",r={maintenanceOpType:t};return this.mutationService.apply(e,i,r)},e.$inject=["mutationService","dsClusterConstants","dataService","clarityModalService","i18nService","sdrsFaultsService","defaultUriSchemeUtil","clarityConstants","actionsService","$q","drsRecommendationsService","drsFaultsViewConstants","columnRenderersRegistry","vuiConstants"],e}();e.DatastoreMaintenanceModeService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("datastoreMaintenanceModeService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){angular.module("com.vmware.vsphere.client.dsCluster").constant("dsClusterConstants",{DS_CLUSTER_SPEC_TYPE:"com.vmware.vsphere.client.storagedrs.DatastoreClusterSpec",HOSTS_AND_CLUSTERS_VALIDATE_SPEC:"com.vmware.vsphere.client.dsclusterui.impl.CreateDsClusterSpec",NAME_AND_LOCATION_VALIDATE_SPEC:"com.vmware.vsphere.client.dscluster.DatastoreClusterNameValidationSpec",DS_CLUSTER_VM_AFFINITY_VALIDATION_SPEC:"com.vmware.vsphere.client.dscluster.DefaultVmAffinityValidationSpec",SDRS_RULE_INFO_SPEC:"com.vmware.vsphere.client.storagedrs.rules.SdrsRuleInfo",SDRS_RULE_SPEC:"com.vmware.vsphere.client.dscluster.SdrsRuleSpec",SDRS_VM_OVERRIDE_SPEC:"com.vmware.vsphere.client.dscluster.VmOverridesReconfigureSpec",SDRS_MANUAL:"manual",SDRS_FULLAUTO:"automated",SDRS_SPACE_THRESHOLD_FREE_SPACE:"freeSpace",SDRS_SPACE_THRESHOLD_UTILIZATION:"utilization",loadBalanceInterval:{HOUR_MINUTES:60,DAY_MINUTES:1440,MIN_HOURS:1,MAX_DAYS:29},loadBalanceIoThreshold:{DEFAULT:5,MIN:1,MAX:100},minSpaceUtilizationDifference:{MIN:1,MAX:50},ioLatencyThreshold:{DEFAULT:15,MIN:5,MAX:100},spaceUtilizationThreshold:{DEFAULT:80,MIN:50,MAX:100},freeSpaceThresholdGB:{MIN:1},ruleTypes:{VM_ANTI_AFFINITY_TYPE:"VM_ANTIAFFINITY_RULE_TYPE",VMDK_ANTI_AFFINITY_TYPE:"VIRTUAL_DISK_ANTI_AFFINITY_RULE_TYPE"},ruleSpec:{VM_ANTI_AFFINITY_TYPE:"com.vmware.vim.binding.vim.cluster.AntiAffinityRuleSpec",VMDK_ANTI_AFFINITY_TYPE:"com.vmware.vim.binding.vim.storageDrs.VirtualDiskAntiAffinityRuleSpec"},operationType:{ADD:"add",REMOVE:"remove",EDIT:"edit"},vmOverridesOperationType:{ADD:"Add",REMOVE:"Remove",EDIT:"Edit"},affinityRuleMinimumMembers:2,sdrsVmOverridesAutomationLevels:{automated:"Automated",manual:"Manual",disabled:"Disabled",clusterDefault:"ClusterDefault",useInitialValues:"useInitialValues"},keepVmdksValues:{clusterDefault:"ClusterDefault",useInitialValues:"useInitialValues"},MAX_INTEGER:2147483647,liveRefreshProperties:{RECOMMENDATION:"podStorageDrsEntry.recommendation",FAULT:"podStorageDrsEntry.drsFault",STORAGE_DRS_CONFIG:"podStorageDrsEntry.storageDrsConfig",SUMMARY:"summary"},maintenanceMode:{enter:"enter",exit:"exit",applyRecommendations:"applyRecommendations"}})}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.vxPropertyViewService=e,this.dataService=t,this.i18nService=i}return e.prototype.getPropertyViewData=function(e){var t=this;return this.dataService.getData(e,"com.vmware.vsphere.client.dsclusterui.model.DsClusterConsumersData").then(function(e){var i=t.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("").section("");return r.property(t.i18nService.getString("DsClusterUi","dscluster.consumers.vms"),e.vmCount),r.property(t.i18nService.getString("DsClusterUi","dscluster.consumers.vm.templates"),e.vmTemplateCount),i.build()})},e.$inject=["vxPropertyViewService","dataService","i18nService"],e}();e.DsClusterConsumersService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("dsClusterConsumersService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){angular.module("com.vmware.vsphere.client.dsCluster").constant("dsClusterHelpConstants",{SDRS_FAULT_TROUBLESHOOT_GUIDE_ID:"vc_304"})}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.vxPropertyViewService=e,this.i18nService=t}return e.prototype.buildResourcesPropertyViewData=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("DsClusterUi","dscluster.resources.used")).icon("ds-cluster-used-resources-legend vx-property-view-key-legend-icon").exit().valueBuilder().text(e.formattedUsedSpace),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("DsClusterUi","dscluster.resources.freeSpace")).icon("ds-cluster-free-resources-legend vx-property-view-key-legend-icon").exit().valueBuilder().text(e.formattedFreeSpace),i.property(this.i18nService.getString("DsClusterUi","dscluster.resources.capacity"),e.formattedCapacity),i.property(this.i18nService.getString("DsClusterUi","dscluster.resources.datastores"),e.datastoreCount),i.property(this.i18nService.getString("DsClusterUi","dscluster.resources.largestFreeSpace"),e.formattedDsLargestFreeSpace),t.build()},e.prototype.getMinCapacityLabel=function(t){return e.MIN_CAPACITY_VALUE+this.getCapacityUnit(t)},e.prototype.getCapacityUnit=function(e){var t=e.split(" ");return t[1]},e.prototype.buildServicesPropertyViewData=function(e,t,i){var r=this.vxPropertyViewService.createPropertyViewBuilder(),n={extensionId:"vsphere.core.dsCluster.monitor.sdrs.recommendations",objectId:t,navigator:i},o={extensionId:"vsphere.core.dscluster.monitor.sdrs.faults.masterDetailsView",objectId:t,navigator:i},a=r.category("").section("");return a.property(this.i18nService.getString("DsClusterUi","sdrs.config.automationLabel"),e.automationLevelText),a.property(this.i18nService.getString("DsClusterUi","dscluster.services.iometrics"),e.ioMetricInclusion),a.property(this.i18nService.getString("DsClusterUi","dscluster.services.spaceThreshold"),e.spaceThreshold),a.property(this.i18nService.getString("DsClusterUi","dscluster.services.ioThreshold"),e.ioLatencyThreshold),a.propertyBuilder().keyBuilder().text(this.i18nService.getString("DsClusterUi","dscluster.services.recommendationsLabel")).exit().valueBuilder().text(e.recommendationsCount).link(n),a.propertyBuilder().keyBuilder().text(this.i18nService.getString("DsClusterUi","dscluster.services.drsFaultsLabel")).exit().valueBuilder().text(e.faultsCount).link(o),r.build()},e.$inject=["vxPropertyViewService","i18nService"],e.MIN_CAPACITY_VALUE="0 ",e}();e.DsClusterServicesAndResourcesService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("dsClusterServicesAndResourcesService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e){this.dsClusterConstants=e}return e.prototype.buildDsClusterSpec=function(e,t){var i={configSpec:{_type:"com.vmware.vim.binding.vim.storageDrs.ConfigSpec",podConfigSpec:{_type:"com.vmware.vim.binding.vim.storageDrs.PodConfigSpec",ioLoadBalanceConfig:{_type:"com.vmware.vim.binding.vim.storageDrs.IoLoadBalanceConfig"}}},modify:t};if(t&&!angular.isDefined(e.name)||(i.name=e.name),angular.isDefined(e.parent)&&(i.parent=e.parent),angular.isDefined(e.datastoreRefs)&&(i.datastores=e.datastoreRefs),angular.isDefined(e.sdrsEnabled)?i.configSpec.podConfigSpec.enabled=e.sdrsEnabled:i.configSpec.podConfigSpec.enabled=!1,angular.isDefined(e.defaultVmBehavior)&&(i.configSpec.podConfigSpec.defaultVmBehavior=e.defaultVmBehavior),angular.isDefined(e.ioLoadBalanceEnabled)&&(i.configSpec.podConfigSpec.ioLoadBalanceEnabled=e.ioLoadBalanceEnabled),void 0!==e.ioLatencyThreshold&&(i.configSpec.podConfigSpec.ioLoadBalanceConfig.ioLatencyThreshold=Math.round(e.ioLatencyThreshold)),angular.isDefined(e.defaultIntraVmAffinity)&&(i.configSpec.podConfigSpec.defaultIntraVmAffinity=e.defaultIntraVmAffinity),angular.isDefined(e.loadBalanceInterval)&&(i.configSpec.podConfigSpec.loadBalanceInterval=e.loadBalanceInterval),angular.isDefined(e.ioLoadImbalanceThreshold)&&(i.configSpec.podConfigSpec.ioLoadBalanceConfig.ioLoadImbalanceThreshold=e.ioLoadImbalanceThreshold),void 0!==e.spaceLoadBalanceConfig&&(i.configSpec.podConfigSpec.spaceLoadBalanceConfig={_type:"com.vmware.vim.binding.vim.storageDrs.SpaceLoadBalanceConfig"},angular.isDefined(e.spaceLoadBalanceConfig.spaceThresholdMode)?i.configSpec.podConfigSpec.spaceLoadBalanceConfig.spaceThresholdMode=e.spaceLoadBalanceConfig.spaceThresholdMode:(i.configSpec.podConfigSpec.spaceLoadBalanceConfig.spaceThresholdMode=this.dsClusterConstants.SDRS_SPACE_THRESHOLD_UTILIZATION,i.configSpec.podConfigSpec.spaceLoadBalanceConfig.spaceUtilizationThreshold=this.dsClusterConstants.spaceUtilizationThreshold.DEFAULT),void 0!==e.spaceLoadBalanceConfig.spaceUtilizationThreshold&&(i.configSpec.podConfigSpec.spaceLoadBalanceConfig.spaceUtilizationThreshold=Math.round(e.spaceLoadBalanceConfig.spaceUtilizationThreshold)),void 0!==e.spaceLoadBalanceConfig.freeSpaceThresholdGB&&(i.configSpec.podConfigSpec.spaceLoadBalanceConfig.freeSpaceThresholdGB=Math.round(e.spaceLoadBalanceConfig.freeSpaceThresholdGB)),angular.isDefined(e.spaceLoadBalanceConfig.minSpaceUtilizationDifference)&&(i.configSpec.podConfigSpec.spaceLoadBalanceConfig.minSpaceUtilizationDifference=e.spaceLoadBalanceConfig.minSpaceUtilizationDifference)),void 0!==e.advancedOptions&&(i.configSpec.podConfigSpec.option={_type:"com.vmware.vim.binding.vim.storageDrs.OptionSpec"},angular.isDefined(e.advancedOptions)&&(i.configSpec.podConfigSpec.option=e.advancedOptions.buildOptions())),angular.isDefined(e.automationOverrides)){var r=_.mapObject(e.automationOverrides,function(e){if(null!==e)return e.id});i.configSpec.podConfigSpec.automationOverrides=angular.merge({_type:"com.vmware.vim.binding.vim.storageDrs.AutomationConfig"},r)}return i},e.$inject=["dsClusterConstants"],e}();e.DsClusterSpecBuilderService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("dsClusterSpecBuilderService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.defaultUriSchemeUtil=r,this.resourceUtil=n,this.entityStatusService=o}return e.prototype.getMasterViewGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getMasterColumnDefs(),height:"100%"}},e.prototype.getDetailsViewGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.NONE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getDetailsColumnDefs(),height:"100%"}},e.prototype.getDetailsColumnDefs=function(){return[{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceDetailsView.nameColumn"),field:"name",type:"string",template:this.getObjNameIconRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceDetailsView.datastoresConnectedColumn"),field:"datastoresConnected",type:"string"},{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceDetailsView.detailsColumn"),field:"details",type:"string"}]},e.prototype.getMasterColumnDefs=function(){return[{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.nameColumn"),field:"name",type:"string",template:this.getObjNameIconRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.dsConnectionStatusColumn"),field:"isConnected",type:"boolean",template:this.getConnectivityIconRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.allocatedSpace"),field:"allocatedSpaceFormatted",type:"string"},{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.usedSpace"),field:"usedSpaceFormatted",type:"string"}]},e.prototype.getVmConnectivityMasterViewGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!0,resizable:!0,data:[],selectedItems:[],columnDefs:this.getVmConnectivityMasterColumnDefs(),height:"100%"}},e.prototype.getVmConnectivityDetailsViewGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.NONE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getVmConnectivityDetailsColumnDefs(),height:"100%"}},e.prototype.getVmConnectivityDetailsColumnDefs=function(){return[{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.fileName"),field:"fileName",type:"string",template:this.getVdNameIconRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.deviceName"),field:"deviceName",type:"string"},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.type"),field:"diskType",type:"string"},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.datastoreName"),field:"datastoreName",type:"string"},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.capacity"),field:"capacityValue",type:"string"}]},e.prototype.getVmConnectivityMasterColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.nameColumn"),field:"vmName",type:"string",template:this.getVmNameRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.state"),field:"state",type:"string",template:this.getPowerState.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.status"),field:"status",type:"string",template:this.getStatusIconRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.datastore"),field:"datastoreName",type:"string",template:this.getDatastoreNameIconLinkRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.managedBy"),field:"managedByLabel",type:"string",template:this.getManagedByNameIconRenderer},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.host"),field:"host.name",type:"string",template:this.getHostObjectLinkRenderer.bind(this)},{displayName:this.i18nService.getString("DsClusterUi","dsCluster.connectivity.vm.columns.provisionedSpace"),field:"totalProvisionedSpace",type:"string",sortable:function(t,i){return e.compareNumericValues(t,i,"provisionedSpace")}},{displayName:this.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.usedSpace"),field:"totalUsedSpace",type:"string",sortable:function(t,i){return e.compareNumericValues(t,i,"usedSpace")}}]},e.prototype.compareNumericValues=function(e,t,i){return e[i]<t[i]?-1:e[i]>t[i]?1:0},e.prototype.getObjNameIconRenderer=function(e){return this.getNameIconRenderer(e.icon,e.name)},e.prototype.getVmNameRenderer=function(e){return e.vmName=e.name+this.resourceUtil.getTaggingLabelString(e.label),this.getObjectLinkRenderer(e.provider,e.vmName,e.icon)},e.prototype.getPowerState=function(e){return this.i18nService.getString("Common","powerState."+e.state)},e.prototype.getStatusIconRenderer=function(e){var t=this.entityStatusService.statusProperties(e.status);return this.getNameIconRenderer(t.iconClass,t.label)},e.prototype.getDatastoreNameIconLinkRenderer=function(e){var t=e.datastoreArray;if(1===t.length)return e.datastoreName=t[0].name,this.getObjectLinkRenderer(t[0].provider,e.datastoreName,t[0].icon);if(t.length>1){var i=void 0,r=[],n=this.columnRenderersRegistry.getColumnRenderer("text-with-custom-tooltip");return _.map(t,function(e){r.push(e.name)}),i=r.join(", "),e.datastoreName=this.i18nService.getString("DsClusterUi","sdrs.rules.config.multipleDatastores"),n(["text","title"],{text:e.datastoreName,title:i})}return""},e.prototype.getManagedByNameIconRenderer=function(e){return null!==e.managedByIcon&&null!==e.managedByLabel?'<span><img src="data:image/png;base64,\n                '+e.managedByIcon.imageData+'"/>\n                '+e.managedByLabel+"</span>":null!==e.managedByLabel?e.managedByLabel:""},e.prototype.getHostObjectLinkRenderer=function(e){return this.getObjectLinkRenderer(e.host.provider,e.host.name,e.host.icon)},e.prototype.getVdNameIconRenderer=function(e){return this.getNameIconRenderer("vx-icon-vmDisk",e.fileName)},e.prototype.getConnectivityIconRenderer=function(e){return this.getNameIconRenderer(e.isConnectedIcon,e.connectionLabel)},e.prototype.setHostFromCluster=function(e){this.clusterConectivityData=e},e.prototype.getHostFromCluster=function(e){var t=null;return _.each(this.clusterConectivityData,function(i){i.name===e.name&&(t=e)}),null!==t?_.map(t.hosts,function(e){return{name:e.name,icon:e.icon,datastoresConnected:e.connectedDatastoresCount,details:e.datastoresConnectionStatus}}):[]},e.prototype.getNameIconRenderer=function(e,t){var i=this.columnRenderersRegistry.getColumnRenderer("icon-text");return i(["icon","text"],{icon:e,text:t})},e.prototype.getObjectLinkRenderer=function(e,t,i){var r=this.columnRenderersRegistry.getColumnRenderer("object-link"),n=this.defaultUriSchemeUtil.getVsphereObjectId(e);return r(["ref","name",i],{ref:n,name:t})},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry","defaultUriSchemeUtil","resourceUtil","entityStatusService"],e}();e.DsClusterConectivityService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("dsClusterConectivityService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.drsFaultsViewConstants=t,this.drsFaultsViewService=i,this.iconService=r,this.feedbackService=n,this.resourceUtil=o}return e.prototype.getFaultMasterData=function(e){var t={};if(e.target)if(null!==e.target.name||""!==e.target.name){var i={};i[this.drsFaultsViewConstants.ID_KEY]=e.target.provider,i[this.drsFaultsViewConstants.NAME_KEY]=e.target.name;var r=[i];t[this.drsFaultsViewConstants.TEXT_KEY]=this.drsFaultsViewService.interpolateWithLinks("{0}",r),t[this.drsFaultsViewConstants.ICON_KEY]=this.iconService.getByObjectRef(e.target.provider)}else t[this.drsFaultsViewConstants.TEXT_KEY]=this.i18nService.getString("DsClusterUi","sdrs.faults.missingObjectNameLabel");var n={};return n[this.drsFaultsViewConstants.LOCALIZED_REASON]=this.getDrsMigrationErrorLocalization(e.reason),n[this.drsFaultsViewConstants.REASON]=e.reason,n[this.drsFaultsViewConstants.TARGET_KEY]=t[this.drsFaultsViewConstants.TEXT_KEY]?t:"",n[this.drsFaultsViewConstants.DETAILS_KEY]=e.details,n[this.drsFaultsViewConstants.ICON_KEY]="vsphere-icon-status-error",n},e.prototype.getMaintenaceModeFaultDetailsData=function(e){for(var t=[],i=0,r=e.description;i<r.length;i++){var n=r[i],o={};o[this.drsFaultsViewConstants.DESCRIPTION_KEY]=n,o[this.drsFaultsViewConstants.HOST_NAME_KEY]=e.hostName+this.resourceUtil.getTaggingLabelString(e.hostLabelIds),o[this.drsFaultsViewConstants.HOST_ICON_KEY]=e.hostIcon,o[this.drsFaultsViewConstants.VM_NAME_KEY]=e.vmName+this.resourceUtil.getTaggingLabelString(e.vmLabelIds),o[this.drsFaultsViewConstants.VM_ICON_KEY]=e.vmIcon,o[this.drsFaultsViewConstants.DISK_NAME_KEY]=e.diskName,t.push(o)}return t},e.prototype.getFaultDetailsData=function(e){var t=null;return t=null!==e.preventedRecommendation.targetVmdk?this.buildMigrateVmdkFaultItem(e):this.buildMigrateVmFaultItem(e)},e.prototype.getDrsMigrationErrorLocalization=function(e){return this.i18nService.getString("Common","drs.migration.error."+e)},e.prototype.buildMigrateVmdkFaultItem=function(e){var t=this.drsFaultsViewService.interpolateWithLinks(this.i18nService.getString("DsClusterUi","sdrs.faults.migrateVmdk"),[this.getVmdkObject(e),this.getVmObject(e),this.getVmdsObject(e)]);return this.buildGridItem(e,t)},e.prototype.buildMigrateVmFaultItem=function(e){var t="";return null!==e.preventedRecommendation.targetVm&&(t=this.drsFaultsViewService.interpolateWithLinks(this.i18nService.getString("DsClusterUi","sdrs.faults.migrateVm"),[this.getVmObject(e)])),this.buildGridItem(e,t)},e.prototype.buildGridItem=function(e,t){var i={};return i[this.drsFaultsViewConstants.REASON]=this.buildReasonLink("vsphere-icon-status-error",e.faultDetailMessage,e.helpId),i[this.drsFaultsViewConstants.PREVENTED_RECOMMENDATION]=t,i[this.drsFaultsViewConstants.PREVENTED_RECOMMENDATION_ICON_CLASS]=e.preventedRecommendationIcon,i},e.prototype.buildReasonLink=function(e,t,i){return"<a ng-click=\"$parent.$parent.openHelpLink('"+i+'\')"><span class="'+e+'"></span>'+t+"</a>"},e.prototype.getVmdkObject=function(e){var t=e.preventedRecommendation.targetVmdk;return null===t?this.i18nService.getString("DsClusterUi","sdrs.faults.missingObjectNameLabel"):t},e.prototype.getVmdsObject=function(e){var t=e.preventedRecommendation.targetVmds,i={};return null===t.name?this.i18nService.getString("DsClusterUi","sdrs.faults.missingObjectNameLabel"):(i[this.drsFaultsViewConstants.ID_KEY]=t.provider,i[this.drsFaultsViewConstants.NAME_KEY]=t.name,i)},e.prototype.getVmObject=function(e){var t=e.preventedRecommendation.targetVm,i={};return null===t.name?this.i18nService.getString("DsClusterUi","sdrs.faults.missingObjectNameLabel"):(i[this.drsFaultsViewConstants.ID_KEY]=t.provider,i[this.drsFaultsViewConstants.NAME_KEY]=t.name,i)},e.$inject=["i18nService","drsFaultsViewConstants","drsFaultsViewService","iconService","feedbackService","resourceUtil"],e}();e.SdrsFaultsService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("sdrsFaultsService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.vuiConstants=t,this.columnRenderersRegistry=i,this.dsClusterConstants=r,this.defaultUriSchemeUtil=n,this.AddVmToVmOverridesManager=o,this.addVmOverridesWizardService=a}return e.prototype.openAddVmOverridesWizard=function(e){var t=new this.AddVmToVmOverridesManager;this.addVmOverridesWizardService.invokeWizard(e,t)},e.prototype.buildVuiSignPostSdrsAutomationLevel=function(e){var t=this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.signPost.title"),i=[];return _.each(e,function(e){i.push(e.vm.name+" - "+e.sdrsAutomationLevelText)}),{title:t,message:i.join("<br>")}},e.prototype.buildVuiSignPostIntraVmAffinityLevel=function(e){var t=this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.signPost.title"),i=[];return _.each(e,function(e){i.push(e.vm.name+" - "+e.intraVmAffinityText)}),{title:t,message:i.join("<br>")}},e.prototype.getEditMultipleVmOverridesIdentityResults=function(e){var t=_.uniq(e,!1,function(e){return e.rawData.intraVmAffinity}),i=_.uniq(e,!1,function(e){return[e.rawData.vmAutomationLevel,e.rawData.vmAutomationLevelEnabled,e.rawData.defaultAutomationLevel].join()}),r=1===t.length,n=1===i.length;return{vmsAreWithEqualIntraVmAffinity:r,vmsAreWithEqualSdrsAutomationLevel:n}},e.prototype.getSdrsVmOverridesGridOptions=function(e){return{actionBarOptions:{actions:[]},searchable:!1,resizable:!0,data:e,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],columnDefs:[{displayName:this.i18nService.getString("DsClusterUi","vmOverrides.vmNameHeaderText"),field:"rawData.vmName",template:this.vmNameRenderer.bind(this)}],pageConfig:{hidePager:!0}}},e.prototype.getSplitterOptions=function(){return{panes:[{min:"150px",size:"25%"},{min:"150px",size:"75%"}],orientation:this.vuiConstants.splitter.orientation.HORIZONTAL}},e.prototype.vmNameRenderer=function(e){var t=this.columnRenderersRegistry.getColumnRenderer("icon-text"),i=t(["icon","name"],e);return i},e.$inject=["i18nService","vuiConstants","columnRenderersRegistry","dsClusterConstants","defaultUriSchemeUtil","AddVmToVmOverridesManager","addVmOverridesWizardService"],e}();e.AddSdrsVmOverridesService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("addSdrsVmOverridesService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){}return e.prototype.setSpec=function(e){this.spec=e},e.prototype.getSpec=function(){return this.spec},e.prototype.setClusterName=function(e){this.clusterName=e},e.prototype.getClusterName=function(){return this.clusterName},e.prototype.setTargetUid=function(e){this.targetUid=e},e.prototype.getTargetUid=function(){return this.targetUid},e.prototype.setSelectedVms=function(e){this.selectedVms=e},e.prototype.getSelectedVms=function(){return this.selectedVms},e.prototype.setSdrsAutomationLevel=function(e){this.sdrsAutomationLevel=e;
},e.prototype.getSdrdsAutomationLevel=function(){return this.sdrsAutomationLevel},e.prototype.setDefaultSdrsAutomationLevel=function(e){this.defaultSdrsAutomationLevel=e},e.prototype.isDefaultSdrsAutomationLevelSelected=function(){return this.defaultSdrsAutomationLevel},e.prototype.setKeepVmdkTogether=function(e){this.keepVmdkTogether=e},e.prototype.getKeepVmdkTogether=function(){return this.keepVmdkTogether},e.$inject=[],e}();e.AddVmToVmOverridesManager=t,angular.module("com.vmware.vsphere.client.dsCluster").factory("AddVmToVmOverridesManager",[function(){return Function.prototype.bind.apply(t,[void 0])}])}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){this.i18nService=e,this.dataService=t,this.vuiConstants=i,this.defaultUriSchemeUtil=r,this.columnRenderersRegistry=n,this.dsClusterConstants=o,this.dsClusterSpecBuilderService=a,this.mutationService=s,this.clarityModalService=c,this.PROPERTY_SDRS_RULES="computedSdrsRules",this.PROPERTY_VM_VIRTUAL_DISKS="virtualDisks",this.PROPERTY_VM_RULE_DETAILS="computedSdrsRuleVmDetails"}return e.prototype.getMasterViewData=function(e,t){var i;return t&&""!==t&&(i={propertyParams:[{propertyName:this.PROPERTY_SDRS_RULES,parameterType:"java.lang.String",parameter:t}]}),this.dataService.getProperties(e,[this.PROPERTY_SDRS_RULES],i).then(function(e){return e.computedSdrsRules})},e.prototype.getMasterGridOptions=function(e){var t={actionBarOptions:{actions:[]},pageConfig:{hidePager:!0},selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getMasterColumnDefs(),height:"100%",dataBound:e};return t},e.prototype.getVmdkDetailsViewData=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.vm.provider);return this.dataService.getProperties(t,[this.PROPERTY_VM_VIRTUAL_DISKS]).then(function(t){var i=_.filter(t.virtualDisks,function(t){return _.contains(e.rule.diskId,t.key)});return _.map(i,function(e){return{name:e.deviceInfo.label,key:e.key,deviceInfo:{label:e.deviceInfo.label}}})})},e.prototype.getVmDetailsViewData=function(e){var t=this,i=_.map(e.rule.vm,function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e)});return this.dataService.getPropertiesForObjects(i,[this.PROPERTY_VM_RULE_DETAILS]).then(function(e){return _.map(e,function(e,t){return _.extend(e.computedSdrsRuleVmDetails,{id:t})})})},e.prototype.deleteRule=function(e,t){var i=this,r={title:this.i18nService.getString("DsClusterUi","sdrs.rules.action.remove.confirmation.title"),message:this.i18nService.getString("DsClusterUi","sdrs.rules.action.remove.confirmation.text"),submit:function(){i.deleteRuleFromDsCluster(e,t)}};this.clarityModalService.openConfirmationModal(r)},e.prototype.deleteRuleFromDsCluster=function(e,t){var i=this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE,r=null;t.ruleType===this.dsClusterConstants.ruleTypes.VMDK_ANTI_AFFINITY_TYPE&&(i=this.dsClusterConstants.ruleSpec.VMDK_ANTI_AFFINITY_TYPE,r=t.vm.provider);var n={operation:this.dsClusterConstants.operationType.REMOVE,ruleInfo:{_type:this.dsClusterConstants.SDRS_RULE_INFO_SPEC,rule:{_type:i,key:t.rule.key},vm:r}};this.mutationService.apply(e,this.dsClusterConstants.SDRS_RULE_SPEC,n)},e.prototype.getMasterColumnDefs=function(){return[{displayName:this.getString("rules.view.name"),field:"rule.name",type:"string",template:'<span class="object" title="#:rule.name#"><i class="vx-icon-rule")></i>#:rule.name#</span>'},{displayName:this.getString("rules.view.description"),field:"ruleType",type:"string",template:this.renderRuleType.bind(this)},{displayName:this.getString("rules.view.enabled"),field:"rule.enabled",type:"boolean",template:this.renderEnabled.bind(this)},{displayName:this.getString("rules.view.vmName"),field:"vm",type:"object",searchable:!1,template:this.renderVmName.bind(this)}]},e.prototype.renderRuleType=function(e){return e.ruleType===this.dsClusterConstants.ruleTypes.VM_ANTI_AFFINITY_TYPE?this.getString("rules.view.type.vmAntiAffinity"):this.getString("rules.view.type.vmdkAntiAffinity")},e.prototype.renderEnabled=function(e){return e.rule.enabled?this.getString("rules.view.enabled.yes"):this.getString("rules.view.enabled.no")},e.prototype.renderVmName=function(e){if(null===e.vm)return this.getString("rules.view.multipleVms");var t=this.columnRenderersRegistry.getColumnRenderer("icon-text");return t(["primaryIconId","name"],e.vm)},e.prototype.getString=function(e){return this.i18nService.getString("Common",e)},e.prototype.getVmdkDetailsGridOptions=function(){var e={pageConfig:{hidePager:!0},searchable:!1,resizable:!1,data:[],selectedItems:[],columnDefs:this.getVmdkDetailsColumnDefs(),height:"100%"};return e},e.prototype.getVmdkDetailsColumnDefs=function(){return[{displayName:this.getString("rules.view.name"),field:"name",type:"string",template:'<span class="object" title="#:name#">#:name#</span>'}]},e.prototype.getVmDetailsGridOptions=function(){var e={pageConfig:{hidePager:!0},searchable:!1,resizable:!0,data:[],selectedItems:[],columnDefs:this.getVmDetailsColumnDefs(),height:"100%"};return e},e.prototype.getVmDetailsColumnDefs=function(){return[{displayName:this.getString("rules.view.vmName"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:primaryIconId#")></i>#:name#</span>'},{displayName:this.i18nService.getString("DsClusterUi","sdrs.rules.config.vmDatastoreHeaderText"),field:"datastoreName",type:"string",template:this.renderDatastoreData.bind(this)}]},e.prototype.renderDatastoreData=function(e){var t=e||{};t.primaryIconId="vsphere-icon-datastore";var i=this.columnRenderersRegistry.getColumnRenderer("object-name");return i([null,"primaryIconId","datastoreName",null,"datastoreHint"],t)},e.prototype.getSdrsRuleTypes=function(){return[{id:this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE,label:this.getString("sdrs.rules.config.label.VM_ANTIAFFINITY_RULE_TYPE")},{id:this.dsClusterConstants.ruleSpec.VMDK_ANTI_AFFINITY_TYPE,label:this.getString("sdrs.rules.config.label.VIRTUAL_DISK_ANTI_AFFINITY_RULE_TYPE")}]},e.prototype.createRuleInstance=function(e,t,i,r,n){var o={name:t,enabled:i,userCreated:!0,key:n};switch(e){case this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE:o=_.extend({vm:r,_type:e},o);break;case this.dsClusterConstants.ruleSpec.VMDK_ANTI_AFFINITY_TYPE:o=_.extend({diskId:r,_type:e},o)}return o},e.prototype.createSdrsRuleInfo=function(e,t,i,r){var n={_type:this.dsClusterConstants.SDRS_RULE_INFO_SPEC,rule:e,ruleType:t,operation:i};return t===this.dsClusterConstants.ruleTypes.VMDK_ANTI_AFFINITY_TYPE&&(n=_.extend({vm:r},n)),n},e.prototype.getRuleTypeByRuleSpec=function(e){switch(e){case this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE:return this.dsClusterConstants.ruleTypes.VM_ANTI_AFFINITY_TYPE;case this.dsClusterConstants.ruleSpec.VMDK_ANTI_AFFINITY_TYPE:return this.dsClusterConstants.ruleTypes.VMDK_ANTI_AFFINITY_TYPE}return""},e.prototype.buildSdrsRuleInfo=function(e,t,i,r,n,o,a){var s=this.createRuleInstance(e,t.trim(),i,r,o),c=this.getRuleTypeByRuleSpec(e);return this.createSdrsRuleInfo(s,c,n,a)},e.prototype.buildSdrsRuleSpec=function(e,t){return{_type:this.dsClusterConstants.SDRS_RULE_SPEC,ruleInfo:e,operation:t}},e.prototype.getVmVirtualDisks=function(e){return this.dataService.getProperties(e,[this.PROPERTY_VM_VIRTUAL_DISKS]).then(function(e){return _.map(e.virtualDisks,function(e){return{key:e.key,deviceInfo:e.deviceInfo}})})},e.prototype.getRuleMemberRefs=function(e){var t,i=this;return t=e.ruleType.id===this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE?_.map(e.ruleMembersData,function(e){return i.defaultUriSchemeUtil.getManagedObjectReference(e.id)}):_.pluck(e.ruleMembersData,"key")},e.$inject=["i18nService","dataService","vuiConstants","defaultUriSchemeUtil","columnRenderersRegistry","dsClusterConstants","dsClusterSpecBuilderService","mutationService","clarityModalService"],e}();e.SdrsRulesService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("sdrsRulesService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.dataService=t,this.vuiConstants=i,this.defaultUriSchemeUtil=r,this.columnRenderersRegistry=n,this.mutationService=o,this.dsClusterConstants=a}return e.prototype.getViewData=function(e){return this.dataService.getData(e,"com.vmware.vsphere.client.dsclusterui.model.configuration.DsClusterVmOverrideData").then(function(e){return e.vmOverrides})},e.prototype.getGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.MULTI,pageConfig:{hidePager:!0},resizable:!0,data:[],selectedItems:[],columnDefs:this.getAllColumnDefs(),height:"100%",actionBarOptions:{actions:[]},showCheckboxesOnMultiSelection:!1}},e.prototype.getAllColumnDefs=function(){return[{displayName:this.getString("vmOverrides.vmNameHeaderText"),field:"vm.name",type:"string",template:this.renderVmLink.bind(this)},{displayName:this.getString("vmOverrides.sdrsAutomationLevelHeaderText"),field:"drsAutomationLevelText",type:"string",template:"<span title='#:sdrsAutomationLevelText#'>#:sdrsAutomationLevelText#</span>"},{displayName:this.getString("vmOverrides.intraVmAffinityHeaderText"),field:"intraVmAffinityText",type:"string",template:"<span title='#:intraVmAffinityText#'>#:intraVmAffinityText#</span>"}]},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("DsClusterUi",e,t)},e.prototype.renderVmLink=function(e){var t=this.columnRenderersRegistry.getColumnRenderer("object-link"),i=this.defaultUriSchemeUtil.getVsphereObjectId(e.vm.provider),r=e.vm.iconId;return t(["vmRef","name",r],{vmRef:i,name:e.vm.name,iconId:r})},e.prototype.removeVmOverride=function(e,t){var i=this.dsClusterConstants.vmOverridesOperationType.REMOVE;this.changeVmOverride(e,t,i)},e.prototype.validateVmOverride=function(e,t){return this.mutationService.validate(e,"com.vmware.vsphere.client.dscluster.VmOverridesReconfigureSpec",t)},e.prototype.getVmOverrideErrorMessages=function(e){var t=this.buildErrorMessages(e),i={text:this.i18nService.getString("DsClusterUi","vmOverrides.conflicting.vms.rule.description",t),type:this.vuiConstants.validationBanner.type.ERROR};return i},e.prototype.getEditVmOverridesDialogTitle=function(e){var t=e.length,i=t>1?this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.titleLabel",t):this.i18nService.getString("DsClusterUi","vmOverrides.config.edit.titleLabel");return i},e.prototype.buildErrorMessages=function(e){var t=this,i="";if(!_.isEmpty(e)){_.each(e,function(e){var r=t.i18nService.getString("DsClusterUi","vmOverrides.conflicting.vms.rule.item",e.name);i=i.concat(r)});var r=i.indexOf(",");i=i.substring(r+2)}return i},e.prototype.changeVmOverride=function(e,t,i){this.mutationService.apply(e,"com.vmware.vsphere.client.dscluster.VmOverridesReconfigureSpec",t,i)},e.$inject=["i18nService","dataService","vuiConstants","defaultUriSchemeUtil","columnRenderersRegistry","mutationService","dsClusterConstants"],e}();e.StorageVmOverridesService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("storageVmOverridesService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.mutationService=t,this.vuiConstants=i,this.$q=r,this.dsClusterSpecBuilderService=n,this.dsClusterConstants=o,this.advancedOptionsBuilderFactory=a,this.isFormValid=!0}return e.prototype.initManager=function(e,t){this.sdrsDialogOptions=t,this.sdrsData=e,this.createPages()},e.prototype.getPageDefinitions=function(){return[this.storageDrsAutomationPageDef,this.storageDrsRuntimeSettingsPageDef,this.storageDrsAdvancedOptionsPageDef]},e.prototype.submit=function(){var e=this,t=this.sdrsDialogOptions.dialogData.objectId,i=this.getDsClusterReconfigureSpec();return this.validate(t).then(function(){return e.mutationService.apply(t,e.dsClusterConstants.DS_CLUSTER_SPEC_TYPE,i).then(function(){return!0}),!0})},e.prototype.setFormValidationResult=function(e){this.isFormValid=e},e.prototype.getSheduleModel=function(){return{storageDrsAutomationMode:this.getStorageDrsAutomationModel(),storageDrsRuntimeSettingsModel:this.getStorageDrsRuntimeSettingsModel(),storageDrsAdvancedOptionsModel:this.getStorageDrsAdvancedOptionsModel()}},e.prototype.validate=function(e){if(this.sdrsDialogOptions.alerts=[],this.sdrsDialogOptions.isAlertClosed=!1,!this.isFormValid)return this.$q.reject();var t={defaultIntraVmAffinity:this.getStorageDrsAdvancedOptionsModel().defaultIntraVmAffinity};return this.mutationService.validate(e,this.dsClusterConstants.DS_CLUSTER_VM_AFFINITY_VALIDATION_SPEC,t).then(this.handleValidationResult.bind(this))},e.prototype.handleValidationResult=function(e){if(e){if(0!==e.result.conflictingVmdkAARules.length)return this.setValidationError(this.i18nService.getString("DsClusterUi","sdrs.config.defaultVmAff.disable.conflictingVmdkAARule.descFormat",e.result.conflictingVmdkAARules[0])),this.$q.reject();if(0!==e.result.conflictingVmAARules.length)return this.setValidationError(this.i18nService.getString("DsClusterUi","sdrs.config.defaultVmAff.disable.conflictingVmAARule.descFormat",e.result.conflictingVmAARules[0])),this.$q.reject()}return this.$q.resolve()},e.prototype.setValidationError=function(e){this.sdrsDialogOptions.alerts=[{type:this.vuiConstants.validationBanner.type.ERROR,text:e}],this.sdrsDialogOptions.isAlertClosed=!1},e.prototype.getStorageDrsAutomationModel=function(){return this.storageDrsAutomationPageDef.model||this.buildStorageDrsAutomationModel(),this.storageDrsAutomationPageDef.model},e.prototype.getStorageDrsRuntimeSettingsModel=function(){return this.storageDrsRuntimeSettingsPageDef.model||this.buildStorageDrsRuntimeSettingsModel(),this.storageDrsRuntimeSettingsPageDef.model},e.prototype.getStorageDrsAdvancedOptionsModel=function(){return this.storageDrsAdvancedOptionsPageDef.model||this.buildStorageDrsAdvancedOptionsModel(),this.storageDrsAdvancedOptionsPageDef.model},e.prototype.getFormData=function(){return this.getDsClusterReconfigureModel()},e.prototype.createPages=function(){this.storageDrsAutomationPageDef={id:"storageDrsAutomation",title:this.i18nService.getString("DsClusterUi","sdrs.config.automationLabel"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/services/editSdrs/storageDrsAutomationPageView.html"},this.storageDrsRuntimeSettingsPageDef={id:"storageDrsRuntimeSettings",title:this.i18nService.getString("DsClusterUi","sdrs.config.runtimeSettingsLabel"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/services/editSdrs/storageDrsRuntimeSettingsPageView.html"},this.storageDrsAdvancedOptionsPageDef={id:"storageDrsAdvancedOptions",title:this.i18nService.getString("DsClusterUi","sdrs.config.advancedOptions"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/services/editSdrs/storageDrsAdvancedOptionsPageView.html"}},e.prototype.buildStorageDrsAutomationModel=function(){this.storageDrsAutomationPageDef.model={sdrsEnabled:this.sdrsData.enabled,defaultVmBehavior:this.sdrsData.defaultVmBehavior,automationOverrides:this.getAutomationOverridesModel(this.sdrsData.automationOverrides)}},e.prototype.buildStorageDrsRuntimeSettingsModel=function(){this.storageDrsRuntimeSettingsPageDef.model={ioLoadBalanceEnabled:this.sdrsData.ioLoadBalanceEnabled,ioLatencyThreshold:this.sdrsData.ioLatencyThreshold,spaceLoadBalanceConfig:{spaceUtilizationThreshold:this.sdrsData.spaceUtilizationThreshold,freeSpaceThresholdGB:this.sdrsData.freeSpaceThresholdGB,spaceThresholdMode:this.sdrsData.spaceThresholdMode},minDatastoreCapacityGB:this.sdrsData.minDatastoreCapacityGB}},e.prototype.getAutomationOverridesModel=function(e){var t=e||{ioLoadBalanceAutomationMode:null,policyEnforcementAutomationMode:null,ruleEnforcementAutomationMode:null,spaceLoadBalanceAutomationMode:null,vmEvacuationAutomationMode:null};return _.mapObject(t,function(e){return{id:e}})},e.prototype.getSpaceLoadBalanceConfigModel=function(){var e={spaceThresholdMode:this.dsClusterConstants.SDRS_SPACE_THRESHOLD_UTILIZATION,spaceUtilizationThreshold:this.dsClusterConstants.spaceUtilizationThreshold.DEFAULT,freeSpaceThresholdGB:this.dsClusterConstants.freeSpaceThresholdGB.MIN};return e},e.prototype.buildStorageDrsAdvancedOptionsModel=function(){var e=this.sdrsData.ioLoadImbalanceThreshold;0===e&&(e=this.dsClusterConstants.loadBalanceIoThreshold.DEFAULT),this.storageDrsAdvancedOptionsPageDef.model={defaultIntraVmAffinity:this.sdrsData.defaultIntraVmAffinity,convertedLoadBalanceInterval:this.sdrsData.convertedLoadBalanceInterval,loadBalanceInterval:this.sdrsData.loadBalanceInterval,ioLoadImbalanceThreshold:e,spaceLoadBalanceConfig:{minSpaceUtilizationDifference:this.sdrsData.minSpaceUtilizationDifference},advancedOptions:this.advancedOptionsBuilderFactory.getBuilder(this.sdrsData.advancedOptions,!1)}},e.prototype.getDsClusterReconfigureModel=function(){var e=_.extend({},this.getStorageDrsRuntimeSettingsModel().spaceLoadBalanceConfig,this.getStorageDrsAdvancedOptionsModel().spaceLoadBalanceConfig),t=_.extend({},this.storageDrsAutomationPageDef.model||{},this.storageDrsRuntimeSettingsPageDef.model||{},this.storageDrsAdvancedOptionsPageDef.model||{});return t.spaceLoadBalanceConfig=e,t},e.prototype.getDsClusterReconfigureSpec=function(){return this.dsClusterSpecBuilderService.buildDsClusterSpec(this.getDsClusterReconfigureModel(),!0)},e.$inject=["i18nService","mutationService","vuiConstants","$q","dsClusterSpecBuilderService","dsClusterConstants","advancedOptionsBuilderFactory"],e}();e.SdrsDialogManager=t,angular.module("com.vmware.vsphere.client.dsCluster").service("sdrsDialogManager",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.sdrsDialogManager=e,this.i18nService=t,this.clarityModalService=i}return e.prototype.show=function(e){var t=this,i={},r={};this.sdrsDialogManager.initManager(i,r),_.extend(r,{title:this.i18nService.getString("DsClusterUi","sdrs.dialog.edit.title"),subTitle:{objectId:e},defaultButton:"submit",contentTemplate:"ds-cluster-ui/resources/ds-cluster/views/settings/services/editSdrs/editSdrsDialog.html",size:"lg",onSubmit:function(){return t.sdrsDialogManager.submit()},modalClass:"ds-cluster-edit-sdrs-dialog-modal",dialogData:{sdrsData:i,manager:this.sdrsDialogManager,objectId:e}}),this.clarityModalService.openOkCancelModal(r)},e.$inject=["sdrsDialogManager","i18nService","clarityModalService"],e}();e.SdrsDialogService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("sdrsDialogService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.dsClusterConstants=t}return e.prototype.getUnitOptions=function(){return[{label:this.i18nService.getString("DsClusterUi","TIME_MINUTES"),multiplier:1},{label:this.i18nService.getString("DsClusterUi","TIME_HOURS"),multiplier:this.dsClusterConstants.loadBalanceInterval.HOUR_MINUTES},{label:this.i18nService.getString("DsClusterUi","TIME_DAYS"),multiplier:this.dsClusterConstants.loadBalanceInterval.DAY_MINUTES}]},e.prototype.getIntervalOptions=function(e){var t=e.loadBalanceInterval;return{current:{name:this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.advancedOptions.loadBalanceInterval.Current"),value:t,formattedValue:e.convertedLoadBalanceInterval.value+" "+this.i18nService.getString("DsClusterUi",e.convertedLoadBalanceInterval.unitKey).toLocaleLowerCase(),unit:e.convertedLoadBalanceInterval.unit},minimum:{name:this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.advancedOptions.loadBalanceInterval.Minimum"),value:this.dsClusterConstants.loadBalanceInterval.MIN_HOURS*this.dsClusterConstants.loadBalanceInterval.HOUR_MINUTES,formattedValue:this.i18nService.getString("Common","hour",this.dsClusterConstants.loadBalanceInterval.MIN_HOURS,1),unit:this.i18nService.getString("DsClusterUi","TIME_HOURS")},maximum:{name:this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.advancedOptions.loadBalanceInterval.Maximum"),value:this.dsClusterConstants.loadBalanceInterval.DAY_MINUTES*this.dsClusterConstants.loadBalanceInterval.MAX_DAYS,formattedValue:this.i18nService.getString("Common","days",this.dsClusterConstants.loadBalanceInterval.MAX_DAYS),unit:this.i18nService.getString("DsClusterUi","TIME_DAYS")}}},e.prototype.getErrorMessages=function(){var e=this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.advancedOptions.loadBalanceInterval.errorRange",this.dsClusterConstants.loadBalanceInterval.MIN_HOURS,this.dsClusterConstants.loadBalanceInterval.MAX_DAYS);return{min:e,max:e}},e.prototype.getIoImbalanceThresholdSliderOptions=function(e,t){return{value:e,min:this.dsClusterConstants.loadBalanceIoThreshold.MIN,max:this.dsClusterConstants.loadBalanceIoThreshold.MAX,minLabel:this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.advancedOptions.ioLoadImbalance.minUnit"),maxLabel:this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.advancedOptions.ioLoadImbalance.maxUnit"),enabled:!0,width:"auto",dragHandleTitle:t}},e.$inject=["i18nService","dsClusterConstants"],e}();e.StorageDrsAdvancedOptionsService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("storageDrsAdvancedOptionsService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.dsClusterConstants=e,this.storageDrsLocalizationService=t}return e.prototype.getSdrsAutomationLevels=function(e){return[{id:this.dsClusterConstants.SDRS_MANUAL,label:this.storageDrsLocalizationService.getAutomationLevelTextLocalization(this.dsClusterConstants.SDRS_MANUAL),description:this.storageDrsLocalizationService.getAutomationLevelDescriptionLocalization(this.dsClusterConstants.SDRS_MANUAL),sectionLabel:e},{id:this.dsClusterConstants.SDRS_FULLAUTO,label:this.storageDrsLocalizationService.getAutomationLevelTextLocalization(this.dsClusterConstants.SDRS_FULLAUTO),description:this.storageDrsLocalizationService.getAutomationLevelDescriptionLocalization(this.dsClusterConstants.SDRS_FULLAUTO),sectionLabel:e}]},e.prototype.getSdrsAutomationOverridesOptions=function(){return[{id:null,label:this.storageDrsLocalizationService.getAutomationLevelTextLocalization(null)},{id:this.dsClusterConstants.SDRS_MANUAL,label:this.storageDrsLocalizationService.getAutomationLevelTextLocalization(this.dsClusterConstants.SDRS_MANUAL)},{id:this.dsClusterConstants.SDRS_FULLAUTO,label:this.storageDrsLocalizationService.getAutomationLevelTextLocalization(this.dsClusterConstants.SDRS_FULLAUTO)}]},e.$inject=["dsClusterConstants","storageDrsLocalizationService"],e}();e.StorageDrsAutomationService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("storageDrsAutomationService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.storageDrsLocalizationService=e,this.dataService=t,this.dsClusterConstants=i}return e.prototype.retrieveData=function(e){var t=this;return this.dataService.getData(e,"com.vmware.vsphere.client.dsclusterui.model.ClusterStorageDrsConfiguration").then(function(e){return e?(e.automationOverrides=e.automationOverrides||{},{enabled:e.enabled,automationLevelText:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.defaultVmBehavior),automationLevelDescription:t.storageDrsLocalizationService.getAutomationLevelDescriptionLocalization(e.defaultVmBehavior),spaceLoadBalanceAutomationMode:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.automationOverrides.spaceLoadBalanceAutomationMode),ioLoadBalanceAutomationMode:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.automationOverrides.ioLoadBalanceAutomationMode),ruleEnforcementAutomationMode:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.automationOverrides.ruleEnforcementAutomationMode),policyEnforcementAutomationMode:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.automationOverrides.policyEnforcementAutomationMode),vmEvacuationAutomationMode:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.automationOverrides.vmEvacuationAutomationMode),spaceThreshold:t.storageDrsLocalizationService.getSpaceThresholdText(e.spaceThresholdMode,e.freeSpaceThresholdGB,e.spaceUtilizationThreshold),ioMetricInclusion:t.storageDrsLocalizationService.getIoMetricInclusionText(e.ioLoadBalanceEnabled),ioMetricInclusionDescription:t.storageDrsLocalizationService.getIoMetricInclusionDescription(e.ioLoadBalanceEnabled),ioLatencyThreshold:t.storageDrsLocalizationService.getIoLatencyThresholdText(e.ioLatencyThreshold),defaultIntraVmAffinity:t.storageDrsLocalizationService.getDefaultIntraVmAffinityText(e.defaultIntraVmAffinity),ioLoadImbalanceThreshold:e.ioLoadImbalanceThreshold?e.ioLoadImbalanceThreshold:t.dsClusterConstants.loadBalanceIoThreshold.DEFAULT,minSpaceUtilizationDifference:t.storageDrsLocalizationService.getMinSpaceUtilizationDifferenceText(e.minSpaceUtilizationDifference),loadBalanceInterval:e.loadBalanceInterval,advancedOptions:t.storageDrsLocalizationService.getAdvancedOptions(e.advancedOptions)}):{}})},e.prototype.retrievePortletData=function(e){var t=this;return this.dataService.getData(e,"com.vmware.vsphere.client.dsclusterui.model.ClusterStorageDrsPortletData").then(function(e){return e?{enabled:e.enabled,automationLevelText:t.storageDrsLocalizationService.getAutomationLevelTextLocalization(e.defaultVmBehavior),ioMetricInclusion:t.storageDrsLocalizationService.getIoMetricInclusion(e.ioLoadBalanceEnabled),spaceThreshold:t.storageDrsLocalizationService.getPortletSpaceThresholdText(e.spaceLoadBalanceConfig),ioLatencyThreshold:t.storageDrsLocalizationService.getIoLatencyThresholdText(e.ioLatencyThreshold),recommendationsCount:e.recommendationsCount,faultsCount:e.faultsCount}:{}})},e.$inject=["storageDrsLocalizationService","dataService","dsClusterConstants"],e}();e.StorageDrsDataRetrieval=t,angular.module("com.vmware.vsphere.client.dsCluster").service("storageDrsDataRetrieval",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.dsClusterConstants=t}return e.prototype.getAutomationLevelDescriptionLocalization=function(e){var t="";switch(e){case this.dsClusterConstants.SDRS_MANUAL:t=this.getString("sdrs.config.automationLevel.manualDescription");break;case this.dsClusterConstants.SDRS_FULLAUTO:t=this.getString("sdrs.config.automationLevel.fullautoDescription")}return t},e.prototype.getAutomationLevelTextLocalization=function(e){var t="";switch(e){case this.dsClusterConstants.SDRS_MANUAL:t=this.getString("sdrs.config.automationLevel.manual");break;case this.dsClusterConstants.SDRS_FULLAUTO:t=this.getString("sdrs.config.automationLevel.fullauto");break;case null:t=this.getString("sdrs.config.automationLevel.useClusterAutomationLabel")}return t},e.prototype.getSpaceThresholdText=function(e,t,i){var r="";switch(e){case this.dsClusterConstants.SDRS_SPACE_THRESHOLD_FREE_SPACE:r=this.getString("sdrs.config.spaceThreshold.minFreeSpaceFormat",t);break;case this.dsClusterConstants.SDRS_SPACE_THRESHOLD_UTILIZATION:r=this.getString("sdrs.config.spaceThreshold.utlizedSpaceFormat",i)}return r},e.prototype.getIoMetricInclusionText=function(e){return e?this.getString("sdrs.config.ioLoadBalanceEnabled"):this.getString("sdrs.config.ioLoadBalanceDisabled")},e.prototype.getIoMetricInclusionDescription=function(e){return e?this.getString("sdrs.config.ioLoadBalanceEnabled.description"):this.getString("sdrs.config.ioLoadBalanceDisabled.description")},e.prototype.getIoLatencyThresholdText=function(e){return this.getString("sdrs.config.ioLatencyThresholdText.format",e)},e.prototype.getMinSpaceUtilizationDifferenceText=function(e){return this.getString("sdrs.config.minSpaceUtilizationDifference.format",e)},e.prototype.getDefaultIntraVmAffinityText=function(e){return e?this.getString("sdrs.config.advancedOptions.keepVmdskTogether.yes.label"):this.getString("sdrs.config.advancedOptions.keepVmdskTogether.no.label")},e.prototype.getAdvancedOptions=function(e){return _.map(e,function(e){return{_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.key,value:e.value}})},e.prototype.getIoMetricInclusion=function(e){return e?this.getString("dscluster.services.iometrics.true"):this.getString("dscluster.services.iometrics.false")},e.prototype.getPortletSpaceThresholdText=function(e){switch(e=e||{},e.spaceThresholdMode){case this.dsClusterConstants.SDRS_SPACE_THRESHOLD_FREE_SPACE:return this.getString("dscluster.services.spaceThreshold.minFreeSpaceFormat",e.freeSpaceThresholdGB);case this.dsClusterConstants.SDRS_SPACE_THRESHOLD_UTILIZATION:return this.getString("dscluster.services.spaceThreshold.utlizedSpaceFormat",e.spaceUtilizationThreshold)}},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("DsClusterUi",e,t)},e.$inject=["i18nService","dsClusterConstants"],e}();e.StorageDrsLocalizationService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("storageDrsLocalizationService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.createDsClusterWizardManager=e,this.simpleValidationCommit=t,this.wizardConfig=this.createDsClusterWizardManager.getWizardConfig()}return e.prototype.initPageSubmit=function(){var e=this;this.createDsClusterWizardManager.getPageDefinitions()[e.getCurrentPageIndex()].onCommit=e.simpleValidationCommit(function(){return e.getValidationErrors()},e.wizardConfig)},e.prototype.setWizardPageState=function(e){this.wizardConfig.pages[this.getCurrentPageIndex()].state=e},e}();e.WizardPageControllerAbstract=t}(ds_cluster_ui||(ds_cluster_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ds_cluster_ui;!function(e){var t=e.WizardPageControllerAbstract,i=function(e){function t(t,i,r,n,o,a,s,c,l,d){e.call(this,i,r),this.$scope=t,this.vuiConstants=n,this.i18nService=o,this.$q=a,this.createDsClusterWizardDatastoresService=s,this.$compile=c,this.createDsClusterPageConstants=l,this.defaultUriSchemeUtil=d,this.initPageSubmit(),this.initModel()}return __extends(t,e),t.prototype.getValidationErrors=function(){var e=this;if(this.$scope.model.datastores.length<=0)return this.$q.resolve([this.i18nService.getString("DsClusterUi","createDsClusterWizard.selectDatastoresPage.noDatastoreSelectedErrorMessage")]);var t=_.some(this.$scope.model.datastoreDetails,function(t){return e.$scope.model.datastoreDetails[0].type!==t.type});return t?this.$q.resolve([this.i18nService.getString("DsClusterUi","createDsClusterWizard.selectDatastoresPage.mixedTypeDatastoresErroroMessage")]):this.$q.reject()},t.prototype.getCurrentPageIndex=function(){return this.createDsClusterPageConstants.DATASTORES_INDEX},t.prototype.initModel=function(){var e=this;this.$scope.model=this.createDsClusterWizardManager.getModel();var t=this.$scope.model.objectId;this.dsFilterOptions=this.createDsClusterWizardDatastoresService.getOptions(),this.config=e.getObjectSelectorConfig(t),this.$scope.$watch("model.dsFilter.filterId",function(){e.config.listTabConfig.listConfig[0].filterId=e.$scope.model.dsFilter.filterId}),e.$scope.$watch("model.datastores",function(){e.getValidationErrors().then(function(){e.setWizardPageState(e.vuiConstants.wizard.pageState.INCOMPLETE)},function(){e.setWizardPageState(e.vuiConstants.wizard.pageState.COMPLETED)})})},t.prototype.getObjectSelectorConfig=function(e){var t=this;return{contextObject:e,multipleSelect:!0,listTabConfig:{listConfig:[{label:this.i18nService.getString("Common","typeResource.datastorePlural"),
listViewId:"vsphere.core.datastore.simplified.list",dataModels:["Datastore"],filterId:this.$scope.model.dsFilter.filterId,filterParams:this.$scope.model.hostsAndClusters,propertyParams:[{_type:"com.vmware.vise.mvc.model.data.ParamSpec",propertyName:"hostConnectionStatus",parameterType:"com.vmware.vsphere.client.dsclusterui.model.DsHostsConnectionStatusSpec",parameter:{_type:"com.vmware.vsphere.client.dsclusterui.model.DsHostsConnectionStatusSpec",hostsAndClusters:_.map(this.$scope.model.hostsAndClusters,function(e){return t.defaultUriSchemeUtil.getManagedObjectReference(e)})}}]}]},selectedObjects:this.$scope.model.datastores,onSelectionChanged:function(e){t.$scope.model.datastores=_.pluck(e,"id"),t.createDsClusterWizardManager.setModelDatastoreRefs(),t.$scope.model.datastoreDetails=_.map(e,function(e){return{name:e.name,icon:e.icon,type:e.rawData.specificType,capacity:e.rawData["summary.capacity.@formatted"],freeSpace:e.rawData["info.freeSpace.@formatted"]}})}}},t.$inject=["$scope","createDsClusterWizardManager","simpleValidationCommit","vuiConstants","i18nService","$q","createDsClusterWizardDatastoresService","$compile","createDsClusterPageConstants","defaultUriSchemeUtil"],t}(t);angular.module("com.vmware.vsphere.client.dsCluster").controller("DatastoresPageController",i)}(ds_cluster_ui||(ds_cluster_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ds_cluster_ui;!function(e){var t=e.WizardPageControllerAbstract,i=function(e){function t(t,i,r,n,o){e.call(this,t,r),this.vuiConstants=i,this.createDsClusterPageConstants=n,this.$q=o,this.initPageSubmit(),this.initModel(),this.setWizardPageState(this.vuiConstants.wizard.pageState.COMPLETED)}return __extends(t,e),t.prototype.getValidationErrors=function(){return this.$q.reject()},t.prototype.getCurrentPageIndex=function(){return this.createDsClusterPageConstants.AUTOMATION_INDEX},t.prototype.initModel=function(){this.model=this.createDsClusterWizardManager.getModel()},t.$inject=["createDsClusterWizardManager","vuiConstants","simpleValidationCommit","createDsClusterPageConstants","$q"],t}(t);angular.module("com.vmware.vsphere.client.dsCluster").controller("DsAutomationPageController",i)}(ds_cluster_ui||(ds_cluster_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ds_cluster_ui;!function(e){var t=e.WizardPageControllerAbstract,i=function(e){function t(t,i,r,n,o,a,s){e.call(this,i,r),this.$scope=t,this.vuiConstants=n,this.i18nService=o,this.$q=a,this.createDsClusterPageConstants=s,this.listLabel=this.i18nService.getString("DsClusterUi","createDsClusterWizard.hostsAndClustersPage.title"),this.initModel(),this.initPageSubmit()}return __extends(t,e),t.prototype.getValidationErrors=function(){return this.$scope.model.hostsAndClusters.length<=0?this.$q.resolve([this.i18nService.getString("DsClusterUi","createDsClusterWizard.hostsAndClustersPage.noHostOrClusterSelectedErrorMessage")]):this.$q.reject()},t.prototype.getCurrentPageIndex=function(){return this.createDsClusterPageConstants.HOSTS_AND_CLUSTERS_INDEX},t.prototype.initModel=function(){var e=this,t=this;this.$scope.model=this.createDsClusterWizardManager.getModel();var i=this.$scope.model.objectId;this.config={contextObject:i,multipleSelect:!0,listTabConfig:{listConfig:[{label:this.i18nService.getString("DsClusterUi","createDsClusterWizard.hostsAndClustersPage.clusters"),listViewId:"vsphere.core.cluster.list",dataModels:["ClusterComputeResource"],filterId:"datacenterObjectsFilter",filterParams:[]},{label:this.i18nService.getString("DsClusterUi","createDsClusterWizard.hostsAndClustersPage.hosts"),listViewId:"vsphere.core.host.list",dataModels:["HostSystem"],filterId:"standaloneHostsFilter",filterParams:[]}]},selectedObjects:t.$scope.model.hostsAndClusters,onSelectionChanged:function(e){t.$scope.model.hostsAndClusters=_.map(e,function(e){return e.id})}},this.$scope.$watch("model.hostsAndClusters",function(){e.getValidationErrors().then(function(){e.setWizardPageState(e.vuiConstants.wizard.pageState.INCOMPLETE)},function(){e.setWizardPageState(e.vuiConstants.wizard.pageState.COMPLETED)})})},t.$inject=["$scope","createDsClusterWizardManager","simpleValidationCommit","vuiConstants","i18nService","$q","createDsClusterPageConstants"],t}(t);angular.module("com.vmware.vsphere.client.dsCluster").controller("HostsAndClustersPageController",i)}(ds_cluster_ui||(ds_cluster_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ds_cluster_ui;!function(e){var t=e.WizardPageControllerAbstract,i=function(e){function t(t,i,r,n,o,a,s,c,l,d){e.call(this,i,o),this.$scope=t,this.vuiConstants=r,this.dataService=n,this.i18nService=a,this.mutationService=s,this.$q=c,this.createDsClusterPageConstants=l,this.dsClusterConstants=d,this.initModel(),this.initPageSubmit()}return __extends(t,e),t.prototype.getValidationErrors=function(){var e=this;if(this.$scope.model.name.length<=0)return this.$q.resolve([this.i18nService.getString("DsClusterUi","createDsClusterWizard.nameAndLocationPage.validation.nameRequired")]);var t=void 0!==this.location?this.location.name:"",i=this.i18nService.getString("DsClusterUi","createDsClusterWizard.nameAndLocationPage.validation.duplicateDsClusterName",t),r={datastoreClusterName:this.$scope.model.name},n=this.mutationService.validate(this.dcId,this.dsClusterConstants.NAME_AND_LOCATION_VALIDATE_SPEC,r).then(function(t){return!t||t.result&&!t.error?e.$q.reject():e.$q.resolve([i])},function(){return e.$q.reject()});return n},t.prototype.getCurrentPageIndex=function(){return this.createDsClusterPageConstants.NAME_AND_LOCATION_INDEX},t.prototype.initModel=function(){var e=this;this.$scope.model=this.createDsClusterWizardManager.getModel(),this.dcId=this.$scope.model.objectId,this.dataService.getProperties(this.dcId,["name","primaryIconId"]).then(function(t){e.location=t}),this.$scope.$watch("model.name",function(){e.getValidationErrors().then(function(){e.setWizardPageState(e.vuiConstants.wizard.pageState.INCOMPLETE)},function(){e.setWizardPageState(e.vuiConstants.wizard.pageState.COMPLETED)})}),this.$scope.$watch("model.sdrsEnabled",function(){void 0!==e.$scope.model.sdrsEnabled&&e.createDsClusterWizardManager.changeSdrsPagesVisibility(e.$scope.model.sdrsEnabled)})},t.$inject=["$scope","createDsClusterWizardManager","vuiConstants","dataService","simpleValidationCommit","i18nService","mutationService","$q","createDsClusterPageConstants","dsClusterConstants"],t}(t);angular.module("com.vmware.vsphere.client.dsCluster").controller("NameAndLocationPageController",i)}(ds_cluster_ui||(ds_cluster_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ds_cluster_ui;!function(e){var t=e.WizardPageControllerAbstract,i=function(e){function t(t,i,r,n,o,a,s,c,l,d,u){e.call(this,t,r),this.vuiConstants=i,this.i18nService=n,this.vxPropertyViewService=o,this.columnRenderersRegistry=a,this.$q=s,this.createDsClusterWizardHostsAndClustersService=c,this.createDsClusterPageConstants=l,this.storageDrsLocalizationService=d,this.dsClusterConstants=u,this.initPageSubmit(),this.initModel()}return __extends(t,e),t.prototype.getValidationErrors=function(){return this.$q.reject()},t.prototype.getCurrentPageIndex=function(){return this.createDsClusterPageConstants.READY_TO_COMPLETE_INDEX},t.prototype.initModel=function(){var e=this;this.model=this.createDsClusterWizardManager.getModel(),this.buildNameAndLocationData(),this.buildAutomationOverridesData(),this.buildRuntimeSettingsData(),this.datastoresGridOptions=this.getDatastoresGridOptions(),this.clustersAndHostsGridOptions=this.getClustersAndHostsGridOptions(),this.createDsClusterWizardHostsAndClustersService.getHostsAndClusters(this.model.datastoreRefs,this.model.hostsAndClusters).then(function(t){e.clustersAndHostsGridOptions.data=t})},t.prototype.buildNameAndLocationData=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("").section("").title(this.i18nService.getString("DsClusterUi","createDsClusterWizard.nameAndLocationPage.title"));t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.nameAndLocationPage.dsClusterNameLabel"),this.model.name);var i=this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage."+(this.model.sdrsEnabled?"sdrsEnabled":"sdrsDisabled"));t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.sdrsLabel"),i),this.nameAndLocationData=e.build()},t.prototype.buildAutomationOverridesData=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("").section("").title(this.i18nService.getString("DsClusterUi","createDsClusterWizard.automationLevelPage.title")),i=this.model.automationOverrides;i&&(t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.automationLevelLabel"),this.storageDrsLocalizationService.getAutomationLevelTextLocalization(this.model.defaultVmBehavior)),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.spaceBalanceLabel"),this.storageDrsLocalizationService.getAutomationLevelTextLocalization(i.spaceLoadBalanceAutomationMode.id)),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.ioBalanceLabel"),this.storageDrsLocalizationService.getAutomationLevelTextLocalization(i.ioLoadBalanceAutomationMode.id)),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.ruleEnforcementLabel"),this.storageDrsLocalizationService.getAutomationLevelTextLocalization(i.ruleEnforcementAutomationMode.id)),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.policyEnforcementLabel"),this.storageDrsLocalizationService.getAutomationLevelTextLocalization(i.policyEnforcementAutomationMode.id)),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.vmEvacuationLabel"),this.storageDrsLocalizationService.getAutomationLevelTextLocalization(i.vmEvacuationAutomationMode.id))),this.automationOverrides=e.build()},t.prototype.buildRuntimeSettingsData=function(){var e=this.vxPropertyViewService.createPropertyViewBuilder(),t=e.category("").section("").title(this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.title")),i=this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage."+(this.model.ioLoadBalanceEnabled?"ioLoadBalancingEnabled":"ioLoadBalancingDisabled"));t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.ioLoadBalancingLabel"),i);var r="";void 0!==this.model&&void 0!==this.model.spaceLoadBalanceConfig&&this.model.spaceLoadBalanceConfig.spaceThresholdMode===this.dsClusterConstants.SDRS_SPACE_THRESHOLD_UTILIZATION?r=this.i18nService.getString("DsClusterUi","sdrs.config.spaceThreshold.utlizedSpaceFormat",this.model.spaceLoadBalanceConfig.spaceUtilizationThreshold):void 0!==this.model&&void 0!==this.model.spaceLoadBalanceConfig&&this.model.spaceLoadBalanceConfig.spaceThresholdMode===this.dsClusterConstants.SDRS_SPACE_THRESHOLD_FREE_SPACE&&(r=this.i18nService.getString("DsClusterUi","sdrs.config.spaceThreshold.minFreeSpaceFormat",this.model.spaceLoadBalanceConfig.freeSpaceThresholdGB)),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.spaceThreshold.label"),r),t.property(this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.ioLatencyThreshold.label"),this.i18nService.getString("DsClusterUi","createDsClusterWizard.runtimeSettingsPage.ioLatencyThreshold.format",this.model.ioLatencyThreshold)),this.runtimeSettings=e.build()},t.prototype.getDatastoresGridOptions=function(){return{searchable:!1,resizable:!1,selectable:!1,data:this.model.datastoreDetails,columnDefs:this.getDatastoresGridColumnDefs(),height:"153px",pageConfig:{hidePager:!0}}},t.prototype.getDatastoresGridColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.datastoresNameHeaderLabel"),field:"name",type:"string",template:function(t){var i=e.columnRenderersRegistry.getColumnRenderer("icon-text");return i(["icon","name"],t)}},{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.datastoresCapacityHeaderLabel"),field:"capacity",type:"string",template:"#:capacity#"},{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.datastoresFreeSpaceHeaderLabel"),field:"freeSpace",type:"string",template:"#:freeSpace#"},{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.datastoresTypeHeaderLabel"),field:"type",type:"string",template:"#:type#"}]},t.prototype.getClustersAndHostsGridOptions=function(){return{searchable:!1,resizable:!1,selectable:!1,data:[],columnDefs:this.getClustersAndHostsGridColumnDefs(),height:"153px",pageConfig:{hidePager:!0}}},t.prototype.getClustersAndHostsGridColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHostNameHeaderLabel"),field:"name",type:"string",template:function(t){var i=e.columnRenderersRegistry.getColumnRenderer("icon-text");return i(["icon","name"],t)}},{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHostDatastoreConnectionStatusHeaderLabel"),field:"isFullyConnected",type:"boolean",template:function(t){var i=e.columnRenderersRegistry.getColumnRenderer("icon-text");return t.isFullyConnected?(t.isFullyConnectedIcon="vx-icon-compliant",t.isFullyConnectedText=e.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHosts.allDatastoresConnected")):(t.isFullyConnectedIcon="vx-icon-warn",t.isFullyConnectedText=e.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHosts.datastoreConnectionMissing")),i(["isFullyConnectedIcon","isFullyConnectedText"],t)}},{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHostSelectedHeaderLabel"),field:"isSelected",type:"boolean",template:function(t){return t.isSelected?e.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHosts.selected"):e.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHosts.notSelected")}},{displayName:this.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHostIOCapableHeaderLabel"),field:"isIOLoadBalanceCapable",type:"boolean",template:function(t){var i=e.columnRenderersRegistry.getColumnRenderer("icon-text");return t.isIOLoadBalanceCapable?(t.isIOLoadBalanceCapableIcon="vx-icon-compliant",t.isIOLoadBalanceCapableText=e.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHosts.ioLoadBalanceCapable")):(t.isIOLoadBalanceCapableIcon="vx-icon-warn",t.isIOLoadBalanceCapableText=e.i18nService.getString("DsClusterUi","createDsClusterWizard.readyToCompletePage.clustersAndHosts.ioLoadBalanceNotCapable")),i(["isIOLoadBalanceCapableIcon","isIOLoadBalanceCapableText"],t)}}]},t.$inject=["createDsClusterWizardManager","vuiConstants","simpleValidationCommit","i18nService","vxPropertyViewService","columnRenderersRegistry","$q","createDsClusterWizardHostsAndClustersService","createDsClusterPageConstants","storageDrsLocalizationService","dsClusterConstants"],t}(t);angular.module("com.vmware.vsphere.client.dsCluster").controller("ReadyToCompletePageController",i)}(ds_cluster_ui||(ds_cluster_ui={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},ds_cluster_ui;!function(e){var t=e.WizardPageControllerAbstract,i=function(e){function t(t,i,r,n,o){e.call(this,t,r),this.vuiConstants=i,this.createDsClusterPageConstants=n,this.$q=o,this.initPageSubmit(),this.initModel(),this.setWizardPageState(this.vuiConstants.wizard.pageState.COMPLETED)}return __extends(t,e),t.prototype.getValidationErrors=function(){return this.$q.reject()},t.prototype.getCurrentPageIndex=function(){return this.createDsClusterPageConstants.RUNTIME_INDEX},t.prototype.initModel=function(){this.model=this.createDsClusterWizardManager.getModel()},t.$inject=["createDsClusterWizardManager","vuiConstants","simpleValidationCommit","createDsClusterPageConstants","$q"],t}(t);angular.module("com.vmware.vsphere.client.dsCluster").controller("RuntimeSettingsPageController",i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={faults:"<"},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/enterMaintenanceModeFaultsWarningView.html"}return e}();e.EnterMaintenanceModeFaultsWarningComponent=t;var i=function(){function e(e,t,i,r,n){this.$scope=e,this.vuiConstants=t,this.drsFaultsViewConstants=i,this.i18nService=r,this.datastoreMaintenanceModeService=n,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.faultDetailsGridOptions=this.datastoreMaintenanceModeService.getFaultDetailsGridOptions(this.faults)},e.$inject=["$scope","vuiConstants","drsFaultsViewConstants","i18nService","datastoreMaintenanceModeService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("enterMaintenanceModeFaultsWarning",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={recommendations:"<",recommendationStore:"="},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/enterMaintenanceModeRecommendationsWarningView.html"}return e}();e.EnterMaintenanceModeRecommendationsWarningComponent=t;var i=function(){function e(e){this.i18nService=e,this.i18n=this.i18nService.getString}return e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("enterMaintenanceModeRecommendationsWarning",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={parentPod:"<",vmIds:"<",actionEval:"=",promise:"<",shouldStartMigrateWizard:"="},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/enterMaintenanceModeWarningView.html"}return e}();e.EnterMaintenanceModeWarningComponent=t;var i=function(){function e(e,t,i,r,n){this.$scope=e,this.defaultUriSchemeUtil=t,this.actionsService=i,this.datastoreMaintenanceModeService=r,this.i18nService=n,this.canMigrate=!0,this.loading=!0,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){var e=this;this.promise.then(function(t){var i=0===t[0].result.warnings.length&&0===t[0].result.errors.length,r=!1;if(t[1].evaluationStatuses){var n=_.map(t[1].evaluationStatuses,function(e){return e.available});r=!!n&&void 0===_.find(n,function(e){return!e})}e.actionEval.evaluationStatuses=t[1].evaluationStatuses,e.actionEval.available=r,e.canMigrate=i&&r,e.loading=!1}),this.signpostParams={title:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.signpost.help"),message:this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.signpost")};var t=this.vmIds.length;this.warningMessage=t>1?this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.datastore.multiple",t):this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.datastore.single"),this.parentPod&&(this.warningMessage+=this.i18nService.getString("DsClusterUi","enterDsMaintenanceMode.warning.datastore.sdrsOff"))},e.$inject=["$scope","defaultUriSchemeUtil","actionsService","datastoreMaintenanceModeService","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("enterMaintenanceModeWarning",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(){this.bindings={faults:"<",recommendations:"<",recommendationStore:"="},this.controller=i,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/maintenanceMode/faultsAndRecommendationsView.html"}return e}();e.FaultsAndRecommendationsComponent=t;var i=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.vuiConstants=t,this.clarityConstants=i,this.drsFaultsViewConstants=r,this.$timeout=n,this.datastoreMaintenanceModeService=o,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.faultDetailsGridOptions=this.datastoreMaintenanceModeService.getFaultDetailsGridOptions(this.faults)},e.$inject=["i18nService","vuiConstants","clarityConstants","drsFaultsViewConstants","$timeout","datastoreMaintenanceModeService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").component("faultsAndRecommendations",new t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.$scope=e,this.i18nService=t,this.helpService=i,this.vuiConstants=r,this.dsClusterConectivityService=n,this.detailsViewGridOptions=this.dsClusterConectivityService.getDetailsViewGridOptions(),e.$watch("masterDetailsViewContext.selectedItems",function(e){e&&e.length>0&&o.setDetailsViewGridData(e)})}return e.prototype.setDetailsViewGridData=function(e){this.detailsViewGridOptions.data=this.dsClusterConectivityService.getHostFromCluster(e[0][0])},e.$inject=["$scope","i18nService","helpService","vuiConstants","dsClusterConectivityService"],e}();e.DsClusterConnectivityDetailsController=t,angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterConnectivityDetailsController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$scope=e,this.i18nService=t,this.dataService=i,this.navigation=r,this.vuiConstants=n,this.columnRenderersRegistry=o,this.dsClusterConectivityService=a,this.selectedItem=null,this.objectId=r.getRoute().objectId,this.watchForObjects=[this.objectId],this.masterViewGridOptions=this.dsClusterConectivityService.getMasterViewGridOptions(),e.$watch(function(){return s.masterViewGridOptions.selectedItems},function(t){t&&t.length>0?(e.masterDetailsViewContext.selectedItems=[t],s.selectedItem=t[0]):void 0!==e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=[])}),this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getProperties(this.objectId,["computedDsClusterConnectivity"]).then(function(t){var i=_.map(t.computedDsClusterConnectivity,function(t){return{name:t.name,icon:t.icon,connectionLabel:t.isConnected?e.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.allDatastoresConnected"):e.i18nService.getString("DsClusterUi","dsClusterComputeResourceList.datastoreConnectionMissing"),isConnectedIcon:t.isConnected?"vx-icon-compliant":"vx-icon-warn",allocatedSpaceFormatted:t.allocatedSpaceFormatted,usedSpaceFormatted:t.usedSpaceFormatted,hosts:t.hosts}});e.masterViewGridOptions.data=i,e.dsClusterConectivityService.setHostFromCluster(t.computedDsClusterConnectivity)})},e.$inject=["$scope","i18nService","dataService","navigation","vuiConstants","columnRenderersRegistry","dsClusterConectivityService"],e}();e.DsClusterConnectivityMasterController=t,angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterConnectivityMasterController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){var i=this;this.$scope=e,this.dsClusterConectivityService=t,this.detailsViewGridOptions=this.dsClusterConectivityService.getVmConnectivityDetailsViewGridOptions(),e.$watch("masterDetailsViewContext.selectedItems",function(e){e&&e.length>0&&i.setVmDetailsViewGridData(e[0])})}return e.prototype.setVmDetailsViewGridData=function(e){this.detailsViewGridOptions.data=e.vmDisks.slice(0)},e.$inject=["$scope","dsClusterConectivityService"],e}();e.DsClusterVmConnectivityDetailsController=t,angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterVmConnectivityDetailsController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.i18nService=t,this.dataService=i,this.navigation=r,this.dsClusterConectivityService=n,this.dsClusterConstants=o,this.selectedItem=null,this.objectId=r.getRoute().objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.SUMMARY,this.dsClusterConstants.liveRefreshProperties.STORAGE_DRS_CONFIG],this.masterViewGridOptions=this.dsClusterConectivityService.getVmConnectivityMasterViewGridOptions(),e.$watch("ctrl.masterViewGridOptions.selectedItems",function(t){t&&t.length>0?(e.masterDetailsViewContext.selectedItems=t,a.selectedItem=t[0]):void 0!==e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=[])}),this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getData(this.objectId,"com.vmware.vsphere.client.dsclusterui.model.DsClusterConnectivityVmData").then(function(t){e.masterViewGridOptions.data=t.vms})},e.$inject=["$scope","i18nService","dataService","navigation","dsClusterConectivityService","dsClusterConstants"],e}();e.DsClusterVmConnectivityMasterController=t,angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterVmConnectivityMasterController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.i18nService=t,this.drsFaultsViewService=i,this.dsClusterHelpConstants=r,this.helpService=n,this.sdrsFaultsService=o,this.detailsViewGridOptions=this.drsFaultsViewService.getDetailsViewGridOptions(),this.faultDetailsTitle=t.getString("Common","drs.faultControl.details.sdrsState.headerLabel"),this.drsTroubleshootHelpId=this.dsClusterHelpConstants.SDRS_FAULT_TROUBLESHOOT_GUIDE_ID,e.$watch("masterDetailsViewContext.selectedItems",function(e){e&&e.length>0&&a.setDetailsViewGridData(e)}),e.openHelpLink=function(e){a.helpService.showHelpPage(e)}}return e.prototype.setDetailsViewGridData=function(e){var t=this,i=[];e[0].forEach(function(e){e.details.forEach(function(e){var r=t.sdrsFaultsService.getFaultDetailsData(e);r&&i.push(r)})}),this.detailsViewGridOptions.data=i},e.$inject=["$scope","i18nService","drsFaultsViewService","dsClusterHelpConstants","helpService","sdrsFaultsService"],e}();e.DsClusterFaultsDetailsViewController=t,angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterFaultsDetailsViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$scope=e,this.i18nService=t,this.dataService=i,this.drsFaultsViewService=r,this.sdrsFaultsService=n,this.navigation=o,this.dsClusterConstants=a,this.selectedItem=null,this.objectId=o.getRoute().objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.FAULT],this.masterViewGridOptions=this.drsFaultsViewService.getMasterViewGridOptions(),this.faultMasterTitle=t.getString("Common","drs.faultControl.sdrsState.headerLabel"),e.$watch(function(){return s.masterViewGridOptions.selectedItems},function(t){t&&t.length>0?(e.masterDetailsViewContext.selectedItems=[t],s.selectedItem=t[0]):void 0!==e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=[])}),e.preselectComparator=function(e){var t=!1;return s.selectedItem&&(t=e.target.text===s.selectedItem.target.text&&e.reason===s.selectedItem.reason),t},this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getProperties(this.objectId,["computedSdrsFaults"]).then(function(t){e.setMasterViewGridData(t)})},e.prototype.setMasterViewGridData=function(e){var t=this;if(e.computedSdrsFaults){var i=[];e.computedSdrsFaults.forEach(function(e){i.push(t.sdrsFaultsService.getFaultMasterData(e))}),this.masterViewGridOptions.data=i}},e.$inject=["$scope","i18nService","dataService","drsFaultsViewService","sdrsFaultsService","navigation","dsClusterConstants"],e}();e.DsClusterFaultsMasterViewController=t,angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterFaultsMasterViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){this.$scope=e,this.dataService=t,this.i18nService=i,this.vuiConstants=r,this.columnRenderersRegistry=n,this.defaultUriSchemeUtil=o,this.timeFormatterService=a,this.$q=s,this.dsClusterConstants=c,this.objectId=e._route.objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.SUMMARY],this.historyTitle=this.getString("dscluster.services.drsHistoryLabel"),this.gridOptions=this.getGridOptions(),this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getProperties(this.objectId,["computedActionHistory"]).then(function(t){if(t&&t.computedActionHistory&&t.computedActionHistory.length>0){var i=t.computedActionHistory.map(function(t){return e.timeFormatterService.formatDate(t.time).then(function(e){return t.time=e,t})});e.$q.all(i).then(function(t){e.gridOptions.data=t})}})},e.prototype.getGridOptions=function(){var e={selectionMode:this.vuiConstants.grid.selectionMode.NONE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],columnDefs:this.getColumnDefs(),height:"100%"};return e},e.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("Common","actionHistoryList.timeColumnHeaderLabel"),field:"time",type:"string"},{displayName:this.i18nService.getString("Common","actionHistoryList.sdrsActionColumnHeaderLabel"),field:"text",type:"string",template:this.textRenderer.bind(this)}]},e.prototype.textRenderer=function(e){var t=this,i=e||{},r=this.columnRenderersRegistry.getColumnRenderer("object-name"),n=i.targetObjects.map(function(e){return e&&e.name?(e.uid=t.defaultUriSchemeUtil.getVsphereObjectId(e.provider),r(["uid",null,"name","labelIds"],e)):t.getString("sdrs.history.missingObjectNameLabel")}),o=this.i18nService.interpolate(i.text,n);return i.image&&(o='<span class="'+i.image+'"></span>'+o),o},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("DsClusterUi",e,t)},e.$inject=["$scope","dataService","i18nService","vuiConstants","columnRenderersRegistry","defaultUriSchemeUtil","timeFormatterService","$q","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterHistoryViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.$scope=e,this.dataService=t,this.i18nService=i,this.columnRenderersRegistry=r,this.defaultUriSchemeUtil=n,this.drsRecommendationsService=o,this.clarityModalService=a,this.mutationService=s,this.dsClusterSpecBuilderService=c,this.$rootScope=l,this.dsClusterConstants=d,this.objectId=e._route.objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.RECOMMENDATION],this.recommendationsTitle=this.getString("dscluster.services.recommendationsLabel"),
this.recommendationStore=this.drsRecommendationsService.createRecommendationsStore(new Array(0)),this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.dataService.getProperties(this.objectId,["computedSdrsRecommendations"]).then(function(t){e.sdrsRecommendationsData=t})},e.prototype.runDrs=function(){var e={operation:"refresh"};this.mutationService.apply(this.objectId,"com.vmware.vsphere.client.dscluster.services.sdrs.DatastoreClusterRecommendationSpec",e)},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("DsClusterUi",e,t)},e.$inject=["$scope","dataService","i18nService","columnRenderersRegistry","defaultUriSchemeUtil","drsRecommendationsService","clarityModalService","mutationService","dsClusterSpecBuilderService","$rootScope","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("SdrsRecommendationsController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.sdrsRulesService=e,this.dsClusterConstants=t,this.$scope=i,this.vuiConstants=r,this.$q=n,this.i18nService=o,this.defaultUriSchemeUtil=a,this.mutationService=s,this.spec={},this.typeOptions={},this.ruleInfo=null,this.mode=i.modalOptions.dialogData.operationType,this.objectId=c._route.objectId,this.editMode=t.operationType.EDIT,this.typeOptions=this.sdrsRulesService.getSdrsRuleTypes(),this.initSpecValues(),i.$watch(function(){return l.spec.ruleType},function(e){l.mode===t.operationType.ADD&&(l.spec.ruleMembersData=[]),e&&e.id===t.ruleSpec.VM_ANTI_AFFINITY_TYPE?l.ruleDescription=l.i18nService.getString("Common","sdrs.rules.config.description.VM_ANTIAFFINITY_RULE_TYPE"):e&&e.id===t.ruleSpec.VMDK_ANTI_AFFINITY_TYPE?l.ruleDescription=l.i18nService.getString("Common","sdrs.rules.config.description.VIRTUAL_DISK_ANTI_AFFINITY_RULE_TYPE"):l.ruleDescription=""}),i.modalOptions.onSubmit=function(){return l.onCommit()}}return e.prototype.initSpecValues=function(){if(this.spec={name:"",ruleType:{id:this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE},enabled:!0,ruleMembersData:[]},this.mode===this.dsClusterConstants.operationType.EDIT){var e=this.$scope.modalOptions.dialogData.context.selectedRule;this.spec.key=e.rule.key,this.spec.name=e.rule.name,this.spec.enabled=e.rule.enabled,this.spec.ruleType=_.find(this.typeOptions,function(t){return t.id===e.rule._type}),this.spec.ruleMembersData=this.$scope.modalOptions.dialogData.context.selectedRuleDetails.data,this.spec.selectedRuleDetails=this.$scope.modalOptions.dialogData.context.selectedRuleDetails.formattedData(),null!==e.vm&&(this.spec.selectedVm=e.vm,this.spec.selectedVm.id=this.defaultUriSchemeUtil.getVsphereObjectId(e.vm.provider))}},e.prototype.validate=function(){var e=this;if(!this.spec.name)return this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common","sdrs.rules.config.error.nameEmpty"),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,this.$q.reject();if(/^\s*$/gi.test(this.spec.name))return this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common","sdrs.rules.config.error.nameEmpty"),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,this.$q.reject();if(this.spec.name.length>80)return this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common","sdrs.rules.config.error.nameTooLong","80"),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,this.$q.reject();if(this.spec.ruleType.id===this.dsClusterConstants.ruleSpec.VMDK_ANTI_AFFINITY_TYPE&&!this.spec.selectedVm)return this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common","sdrs.rules.config.error.vmNameEmpty"),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,this.$q.reject();if(this.spec.ruleMembersData.length<this.dsClusterConstants.affinityRuleMinimumMembers){var t=void 0;return t=this.spec.ruleType.id===this.dsClusterConstants.ruleSpec.VM_ANTI_AFFINITY_TYPE?"sdrs.rules.config.error.lessThenMinVmRuleMembers":"sdrs.rules.config.error.lessThenMinVmdkRuleMembers",this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common",t,this.dsClusterConstants.affinityRuleMinimumMembers),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,this.$q.reject()}var i=this.spec.selectedVm?this.defaultUriSchemeUtil.getManagedObjectReference(this.spec.selectedVm.id):null,r=this.mode===this.dsClusterConstants.operationType.ADD?null:this.spec.key,n=this.sdrsRulesService.getRuleMemberRefs(this.spec);this.ruleInfo=this.sdrsRulesService.buildSdrsRuleInfo(this.spec.ruleType.id,this.spec.name,this.spec.enabled,n,this.spec.operation,r,i);var o=this.mutationService.validate(this.objectId,this.dsClusterConstants.SDRS_RULE_INFO_SPEC,this.ruleInfo).then(function(t){if(t&&t.result){if(!e.handleNameValidation(t))return e.$q.reject();if(!e.handleConflictingRulesValidation(t))return e.$q.reject();if(!e.handleConflictingOverridesValidation(t))return e.$q.reject();if(!e.handleConflictingDscDefVmAffVmsValidation(t))return e.$q.reject()}return e.$q.resolve()});return o},e.prototype.handleNameValidation=function(e){return!e.result.nameIsDuplicated||(this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common","sdrs.rules.config.duplicated.name.error.message.format",this.spec.name),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,!1)},e.prototype.handleConflictingRulesValidation=function(e){var t=this;if(e.result.conflictingRules.length>0&&this.spec.enabled){var i=[];return _.each(e.result.conflictingRules,function(e){i.push({text:t.i18nService.getString("Common","sdrs.rules.config.rule.conflict.error.message.format",e.name),type:t.vuiConstants.validationBanner.type.ERROR})}),this.$scope.modalOptions.alerts=i,this.$scope.modalOptions.isAlertClosed=!1,this.spec.enabled=!1,!1}return!0},e.prototype.handleConflictingOverridesValidation=function(e){var t=this;if(e.result.conflictingVmsOverrides.length>0){var i=[];return _.each(e.result.conflictingVmsOverrides,function(e){var r=e?e.vmName:"",n=t.ruleInfo.ruleType;t.dsClusterConstants.ruleTypes.VMDK_ANTI_AFFINITY_TYPE===n?i.push({text:t.i18nService.getString("Common","sdrs.rules.config.keep.vmdk.together.conflict.error.message.format",r),type:t.vuiConstants.validationBanner.type.ERROR}):t.dsClusterConstants.ruleTypes.VM_ANTI_AFFINITY_TYPE===n&&i.push({text:t.i18nService.getString("Common","sdrs.rules.config.do.not.keep.vmdk.together.conflict.error.message.format",r),type:t.vuiConstants.validationBanner.type.ERROR})}),this.$scope.modalOptions.alerts=i,this.$scope.modalOptions.isAlertClosed=!1,this.spec.enabled=!1,!1}return!0},e.prototype.handleConflictingDscDefVmAffVmsValidation=function(e){var t=this;if(e.result.conflictingDscDefVmAffVms.length>0){var i=this.ruleInfo.ruleType;if(this.dsClusterConstants.ruleTypes.VM_ANTI_AFFINITY_TYPE===i)if(e.result.conflictingDscDefVmAffVms.length===this.spec.ruleMembersData.length)this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("Common","sdrs.rules.config.conficts.dsClusterDefVmAff.allVms"),type:this.vuiConstants.validationBanner.type.ERROR}];else{var r=[],n={};_.each(this.spec.ruleMembersData,function(e){n[e.id]=e.name}),_.each(e.result.conflictingDscDefVmAffVms,function(e){r.push({text:t.i18nService.getString("Common","sdrs.rules.config.conficts.dsClusterDefVmAff.perVm.format",n[t.defaultUriSchemeUtil.getVsphereObjectId(e)]),type:t.vuiConstants.validationBanner.type.ERROR})}),this.$scope.modalOptions.alerts=r}return this.$scope.modalOptions.isAlertClosed=!1,this.spec.enabled=!1,!1}return!0},e.prototype.onCommit=function(){var e=this;return this.$scope.modalOptions.alerts=[],this.$scope.modalOptions.isAlertClosed=!0,this.validate().then(function(){var t=e.mode===e.dsClusterConstants.operationType.ADD?"create":"apply",i=e.sdrsRulesService.buildSdrsRuleSpec(e.ruleInfo,t);return e.mutationService.apply(e.objectId,e.dsClusterConstants.SDRS_RULE_SPEC,i),!0})["catch"](function(){return!1})},e.$inject=["sdrsRulesService","dsClusterConstants","$scope","vuiConstants","$q","i18nService","defaultUriSchemeUtil","mutationService","$rootScope"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("AddSdrsRuleController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t;var i=e.modalOptions.dialogData.objectId,r=e.modalOptions.dialogData,n=r.selectedVms?r.selectedVms:[],o={objectType:"VirtualMachine",listViewId:"vsphere.core.vm.members.list"},a="dsClusterVmdkRuleVmsExceptSecondaryVmsExcludeVmsFilter";0===n.length&&(a="dsClusterVmdkRuleVmsExceptSecondaryVmsFilter"),this.config={contextObject:i,multipleSelect:!1,listTabConfig:{listConfig:[{label:t.getString("Common","typeResource.vmPlural"),listViewId:o.listViewId,dataModels:[o.objectType],filterId:a,filterParams:n}]},onSelectionChanged:function(e){r.selectedItems=e}}}return e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("AddSdrsVmdkRuleMemberController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t;var i=e.modalOptions.dialogData.objectId,r=e.modalOptions.dialogData,n=this.getSelectedVmsManagedObjectRefs(r.selectedVms),o={objectType:"VirtualMachine",listViewId:"vsphere.core.vm.members.list"},a="dsClusterVmsExceptSecondaryVmsExcludeVmsFilter";0===n.length&&(a="dsClusterVmsExceptSecondaryVmsFilter"),this.config={contextObject:i,multipleSelect:!0,listTabConfig:{listConfig:[{label:t.getString("Common","typeResource.vmPlural"),listViewId:o.listViewId,dataModels:[o.objectType],filterId:a,filterParams:n}]},onSelectionChanged:function(e){r.selectedItems=e}}}return e.prototype.getSelectedVmsManagedObjectRefs=function(e){return _.map(e,function(e){return e.id})},e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("AddSdrsVmRuleMemberController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=t,this.i18nService=i,this.datagridActionBarService=r,this.vuiConstants=n,this.columnRenderersRegistry=o,this.datagridActionBarServiceCacheObject=null,this.objectId=e._route.objectId,t.$watch("$ctrl.vmAffinityGridOptions.selectedItems",function(){a.refreshActionBar()})}return e.prototype.$onChanges=function(e){var t=this;"undefined"!=typeof e.spec&&(this.vmAffinityGridOptions=this.getVmAffinityGridOptions(e.spec.currentValue),this.actionSpecs=[{actionId:"vsphere.core.dscluster.actions.rule.members.add",getActionInvocationContext:function(){return{selectedMembers:e.spec.currentValue.ruleMembersData,dialogSubTitleObject:{objectId:t.objectId},submitCallback:function(i){return void 0!==i.dialogData.selectedItems&&(t.vmAffinityGridOptions.data=t.vmAffinityGridOptions.data.concat(i.dialogData.selectedItems),e.spec.currentValue.ruleMembersData=t.vmAffinityGridOptions.data),!0}}}},{actionId:"vsphere.core.dscluster.actions.rule.members.remove",getActionInvocationContext:function(){return{membersToRemove:t.vmAffinityGridOptions.selectedItems,confirmCallback:function(){return t.vmAffinityGridOptions.data=e.spec.currentValue.ruleMembersData=_.filter(t.vmAffinityGridOptions.data,function(e){return _.every(t.vmAffinityGridOptions.selectedItems,function(t){return e.id!==t.id})}),!0}}},isActionAvailable:function(e){return e.available&&t.vmAffinityGridOptions.selectedItems.length>0}}],this.createActionBar())},e.prototype.createActionBar=function(){var e=this;this.datagridActionBarService.updateActionBar(this.vmAffinityGridOptions,[this.objectId],this.actionSpecs).then(function(t){e.datagridActionBarServiceCacheObject=t})},e.prototype.refreshActionBar=function(){this.datagridActionBarServiceCacheObject&&this.datagridActionBarService.updateActionBar(this.vmAffinityGridOptions,[this.objectId],this.actionSpecs,this.datagridActionBarServiceCacheObject)},e.prototype.getVmAffinityGridOptions=function(e){return{actionBarOptions:{actions:[]},searchable:!1,resizable:!0,data:e.selectedRuleDetails,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,selectedItems:[],columnDefs:[{displayName:this.i18nService.getString("Common","sdrs.rules.config.vmNameHeaderText"),field:"name",type:"string",template:'<span class="object" title="#:name#"><i class="#:icon#")></i>#:name#</span>'},{displayName:this.i18nService.getString("DsClusterUi","sdrs.rules.config.vmDatastoreHeaderText"),field:"rawData.datastoreName",template:this.datastoreNameRenderer.bind(this)}],height:"100%",pageConfig:{hidePager:!0}}},e.prototype.datastoreNameRenderer=function(e){var t=this.columnRenderersRegistry.getColumnRenderer("datastore-name");return t([],e.rawData)},e.$inject=["$rootScope","$scope","i18nService","datagridActionBarService","vuiConstants","columnRenderersRegistry"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/addVmAntiAffinityRuleComponent.html",this.bindings={spec:"<"}}return e}();angular.module("com.vmware.vsphere.client.dsCluster").component("addVmAntiAffinityRuleComponent",new i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.$scope=t,this.i18nService=i,this.datagridActionBarService=r,this.vuiConstants=n,this.columnRenderersRegistry=o,this.actionsService=a,this.sdrsRulesService=s,this.dsClusterConstants=c,this.objectId=e._route.objectId,this.editMode=c.operationType.EDIT,t.$watch("$ctrl.vmdkGridOptions.selectedItems",function(){l.spec.ruleMembersData=l.vmdkGridOptions.selectedItems}),t.vmdkPreselectComparator=this.vmdkPreselectComparator.bind(this)}return e.prototype.$onChanges=function(e){var t=this;"undefined"!=typeof e.spec?(this.spec=e.spec.currentValue,this.vmdkGridOptions=this.getVmdkGridOptions(e.spec.currentValue),this.actionsService.getAction("vsphere.core.dscluster.actions.rule.vmdk.members.add",[this.objectId]).then(function(e){t.addVmAction=e})):"undefined"!=typeof e.mode&&(this.mode=e.mode.currentValue)},e.prototype.invokeAction=function(e){var t=this;this.actionsService.invokeAction(e,{submitCallback:function(e){if(void 0!==e.dialogData.selectedItems){var i=e.dialogData.selectedItems[0];t.spec.selectedVm=i,t.sdrsRulesService.getVmVirtualDisks(i.id).then(function(e){t.vmdkGridOptions.data=e})}return!0},selectedMembers:this.spec.selectedVm?[this.spec.selectedVm.id]:[],dialogSubTitleObject:{objectId:this.objectId}})},e.prototype.vmdkPreselectComparator=function(e){return this.mode===this.editMode},e.prototype.getVmdkGridOptions=function(e){return{actionBarOptions:{actions:[]},searchable:!1,resizable:!0,data:e.ruleMembersData,selectionMode:this.vuiConstants.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!0,selectedItems:[],columnDefs:[{displayName:this.i18nService.getString("Common","sdrs.rules.config.vmdkNameHeaderText"),field:"deviceInfo.label",type:"string",template:'<span class="object" title="#:deviceInfo.label#">#:deviceInfo.label#</span>'}],height:"186px",pageConfig:{hidePager:!0}}},e.$inject=["$rootScope","$scope","i18nService","datagridActionBarService","vuiConstants","columnRenderersRegistry","actionsService","sdrsRulesService","dsClusterConstants"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/addVmdkAntiAffinityRuleComponent.html",this.bindings={spec:"<",mode:"<"}}return e}();angular.module("com.vmware.vsphere.client.dsCluster").component("addVmdkAntiAffinityRuleComponent",new i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){var s=this;this.$scope=e,this.$compile=t,this.$element=i,this.sdrsRulesService=r,this.dsClusterConstants=n,this.datagridActionBarService=o,this.i18nService=a,this.selectedRule=null,this.selectedRuleDetails=null,this.isFilterAdded=!1,this.objectId=e._route.objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.STORAGE_DRS_CONFIG],e.rulesPreselectComparator=this.rulesPreselectComparator.bind(this),this.actionSpecs=[{actionId:"vsphere.core.dscluster.actions.rule.add"},{actionId:"vsphere.core.dscluster.actions.rule.edit",getActionInvocationContext:function(){return{selectedRule:s.selectedRule,selectedRuleDetails:s.selectedRuleDetails}},isActionAvailable:function(e){return e.available&&s.gridOptions.selectedItems.length>0}},{actionId:"vsphere.core.dscluster.actions.rule.remove",getActionInvocationContext:function(){return{selectedRule:s.selectedRule}},isActionAvailable:function(e){return e.available&&s.gridOptions.selectedItems.length>0}}],this.datagridActionBarServiceCacheObject=null,this.gridOptions=r.getMasterGridOptions(function(){s.onDataBound()}),e.$watch("ctrl.gridOptions.selectedItems",this.onSelectedRuleChange.bind(this)),e.$watch(function(){return s.selectedRule},function(){s.refreshActionBar()});var c=this.i18nService.getString("Common","filter.label"),l=a.getString("Common","applyFilter.label");this.filterElement=t('<div class="filter-input pull-right">\n                <button class="nav-icon fa fa-filter filter-button" ng-click="doSearch()"\n                      aria-label="'+l+'" /></button>\n                <input type="text" ng-model="searchTerm" ng-trim="true"\n                ng-change="debouncedRefreshCallback()"\n                ng-keypress="keyPress($event)"\n                placeholder="'+c+'"/></div>')(e),e.doSearch=function(){s.doSearch()},e.keyPress=function(e){s.handleKeyPress(e)},this.getViewData(),this.createActionBar()}return e.prototype.doSearch=function(){this.getViewData()},e.prototype.handleKeyPress=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),this.getViewData())},e.prototype.getViewData=function(){var e=this;this.sdrsRulesService.getMasterViewData(this.objectId,this.$scope.searchTerm).then(function(t){e.gridOptions.data=_.map(t,function(e){return angular.merge({_original:e},e)}),e.keepSelectionOrPreselectFirst(),e.refreshActionBar()})},e.prototype.createActionBar=function(){var e=this;this.datagridActionBarService.updateActionBar(this.gridOptions,[this.objectId],this.actionSpecs).then(function(t){e.datagridActionBarServiceCacheObject=t})},e.prototype.refreshActionBar=function(){this.datagridActionBarServiceCacheObject&&this.datagridActionBarService.updateActionBar(this.gridOptions,[this.objectId],this.actionSpecs,this.datagridActionBarServiceCacheObject)},e.prototype.rulesPreselectComparator=function(e){return this.selectedRule&&e&&this.selectedRule.rule.name===e.rule.name},e.prototype.onSelectedRuleChange=function(e){return e&&0!==e.length?void(this.selectedRule&&e[0].rule.name===this.selectedRule.rule.name||(this.selectedRule=e[0]._original)):void(this.selectedRule=null)},e.prototype.keepSelectionOrPreselectFirst=function(){var e=this;if(this.gridOptions.data&&this.gridOptions.data.length>0){var t=void 0;this.selectedRule&&(t=_.find(this.gridOptions.data,function(t){return t.rule.name===e.selectedRule.rule.name})),this.selectedRule=t?t._original:this.gridOptions.data[0]._original}},e.prototype.onDataBound=function(){this.isFilterAdded||this.addToolbarFilter()},e.prototype.addToolbarFilter=function(){var e=this.getGridElement();if(e){var t=e.find(".k-grid-toolbar");t.length>0&&(t.append(this.filterElement),this.isFilterAdded=!0)}},e.prototype.getGridElement=function(){var e=this.$element.find(".k-grid-content");return e&&e.parent()},e.$inject=["$scope","$compile","$element","sdrsRulesService","dsClusterConstants","datagridActionBarService","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("SdrsRulesViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.$rootScope=e,this.i18nService=t,this.sdrsRulesService=i,this.ruleDetailsTitle=t.getString("DsClusterUi","manage.settings.sdrsRuleDetails"),this.ruleDetailsDescription=t.getString("DsClusterUi","sdrs.rules.view.vm.details.hint")}return e.prototype.$onChanges=function(e){var t=this;"undefined"!=typeof e.rule&&(this.gridOptions=this.sdrsRulesService.getVmDetailsGridOptions(),this.sdrsRulesService.getVmDetailsViewData(e.rule.currentValue).then(function(e){t.selectedRuleDetails={data:e,formattedData:function(){return _.map(e,function(e){return{id:e.id,icon:e.primaryIconId,name:e.name,rawData:{datastoreNames:[e.datastoreName],datastoreHint:e.datastoreHint}}})}},t.gridOptions.data=e}))},e.$inject=["$rootScope","i18nService","sdrsRulesService"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/vmAndVmdkAntiAffinityRuleDetailsComponent.html",this.bindings={rule:"<",selectedRuleDetails:"="}}return e}();angular.module("com.vmware.vsphere.client.dsCluster").component("vmAntiAffinityRuleDetailsComponent",new i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.$rootScope=e,this.i18nService=t,this.sdrsRulesService=i,this.ruleDetailsTitle=t.getString("DsClusterUi","manage.settings.sdrsRuleDetails"),this.ruleDetailsDescription=t.getString("DsClusterUi","sdrs.rules.view.vmdk.details.hint")}return e.prototype.$onChanges=function(e){var t=this;"undefined"!=typeof e.rule&&(this.gridOptions=this.sdrsRulesService.getVmdkDetailsGridOptions(),this.sdrsRulesService.getVmdkDetailsViewData(e.rule.currentValue).then(function(e){t.selectedRuleDetails={data:e,formattedData:function(){return _.map(e,function(e){return{name:e.name,rawData:{deviceInfo:{label:e.deviceInfo.label}}}})}},t.gridOptions.data=e}))},e.$inject=["$rootScope","i18nService","sdrsRulesService"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/settings/configuration/rules/vmAndVmdkAntiAffinityRuleDetailsComponent.html",this.bindings={rule:"<",selectedRuleDetails:"="}}return e}();angular.module("com.vmware.vsphere.client.dsCluster").component("vmdkAntiAffinityRuleDetailsComponent",new i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l){var d=this;this.$scope=e,this.datagridActionBarService=t,this.dataService=i,this.i18nService=r,this.dsClusterConstants=n,this.mutationService=o,this.addSdrsVmOverridesService=a,this.addVmOverridesPageService=s,this.storageVmOverridesService=c,this.vuiConstants=l,this.objectId=e._route.objectId,this.splitterOptions=this.addSdrsVmOverridesService.getSplitterOptions(),this.spec={},this.selectedVms=[],e.modalOptions.dialogData.mode===this.dsClusterConstants.vmOverridesOperationType.EDIT?(this.selectedVms=e.modalOptions.dialogData.context,this.spec.mode=this.dsClusterConstants.vmOverridesOperationType.EDIT):this.spec.mode=this.dsClusterConstants.vmOverridesOperationType.ADD,e.modalOptions.onSubmit=function(){if(d.$scope.modalOptions.isAlertClosed=!0,d.$scope.modalOptions.alerts=[],d.spec.keepVmdksChecked||d.spec.sdrsAutomationLevel||d.spec.mode===d.dsClusterConstants.vmOverridesOperationType.EDIT){var e=d.spec.keepVmdksChecked?d.spec.keepVmdksValue:d.dsClusterConstants.keepVmdksValues.clusterDefault,t=d.spec.sdrsAutomationLevel?d.spec.sdrsAutomationLevelValue:d.dsClusterConstants.sdrsVmOverridesAutomationLevels.clusterDefault,i=d.addVmOverridesPageService.getOverrideSpec(d.selectedVms,t,e,d.spec.mode);d.mutationService.validate(d.objectId,d.dsClusterConstants.SDRS_VM_OVERRIDE_SPEC,i).then(function(e){if(e&&e.result&&e.result.length>0){var t=d.storageVmOverridesService.getVmOverrideErrorMessages(e.result);d.$scope.modalOptions.alerts=[t],d.$scope.modalOptions.isAlertClosed=!1}else d.mutationService.apply(d.objectId,d.dsClusterConstants.SDRS_VM_OVERRIDE_SPEC,i),d.$scope.closeModal()})}else d.$scope.modalOptions.alerts=[{text:d.i18nService.getString("DsClusterUi","vm.overrides.config.noChangesValidationError"),type:d.vuiConstants.validationBanner.type.ERROR}],d.$scope.modalOptions.isAlertClosed=!1;return!1}}return e.$inject=["$scope","datagridActionBarService","dataService","i18nService","dsClusterConstants","mutationService","addSdrsVmOverridesService","addVmOverridesPageService","storageVmOverridesService","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("AddSdrsVmOverridesController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e){this.$scope=e,this.selectedVms=e.manager.getSelectedVms(),this.spec=e.manager.getSpec()}return e.$inject=["$scope"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("AddVmOverridesController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){var r=this;this.$scope=e,this.storageVmOverridesService=t,this.dsClusterConstants=i,this.INTRA_VM_AFFINITY_CLUSTER_DEFAULT="ClusterDefault",this.objectId=e._route.objectId,this.selectedVms=e.modalOptions.dialogData.context,this.$scope.modalOptions.alerts=[],e.modalOptions.onSubmit=function(){r.$scope.modalOptions.isAlertClosed=!0,r.$scope.modalOptions.alerts=[];var e=r.getRemoveSpec();r.storageVmOverridesService.validateVmOverride(r.objectId,e).then(function(t){if(t){var i=t.result;if(i&&i.length>0){var n=r.storageVmOverridesService.getVmOverrideErrorMessages(i);r.$scope.modalOptions.isAlertClosed=!1,r.$scope.modalOptions.alerts=[n]}else r.storageVmOverridesService.removeVmOverride(r.objectId,e),r.$scope.closeModal()}})}}return e.prototype.getRemoveSpec=function(){var e=this,t=this.dsClusterConstants.vmOverridesOperationType.REMOVE;return{vmOverrides:_.map(this.selectedVms,function(t){return{vmSor:t.vm.provider,intraVmAffinity:e.INTRA_VM_AFFINITY_CLUSTER_DEFAULT}}),operation:t}},e.$inject=["$scope","storageVmOverridesService","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("RemoveSdrsVmOverridesController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t;var i=e.manager.getTargetUid(),r=e.manager.getSelectedVms(),n={objectType:"VirtualMachine",listViewId:"vsphere.core.vm.members.list"},o="dsClusterVmOverridesExceptSecondaryVmsAndOverridedVmsFilter";this.config={contextObject:i,multipleSelect:!0,listTabConfig:{listConfig:[{label:t.getString("Common","typeResource.vmPlural"),listViewId:n.listViewId,dataModels:[n.objectType],filterId:o}]},selectedObjects:_.map(r,function(e){return e.id}),onSelectionChanged:function(t){e.manager.setSelectedVms(t)}}}return e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("SelectVmsToOverrideController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$rootScope=e,this.$scope=t,this.addSdrsVmOverridesService=i,this.datagridActionBarService=r}return e.prototype.$onInit=function(){this.objectId=this.$rootScope._route.objectId,this.gridOptions=this.addSdrsVmOverridesService.getSdrsVmOverridesGridOptions(this.selectedVms),this.watchForObjects=[this.objectId]},e.$inject=["$rootScope","$scope","addSdrsVmOverridesService","datagridActionBarService"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/settings/configuration/sdrsVmOverrides/selectVmToVmOverrideComponent.html",this.bindings={selectedVms:"="}}return e}();angular.module("com.vmware.vsphere.client.dsCluster").component("selectVmToVmOverrideComponent",new i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.$rootScope=e,this.$scope=t,this.addVmOverridesPageService=i,this.addSdrsVmOverridesService=r,this.dataService=n,this.i18nService=o,this.dsClusterConstants=a,this.STORAGE_POD_AUTOMATION_LEVEL_PROPERTY="podStorageDrsEntry/storageDrsConfig/podConfig/defaultVmBehavior",this.DEFAULT_INTRA_VM_AFFINITY_PROPERTY="podStorageDrsEntry/storageDrsConfig/podConfig/defaultIntraVmAffinity",this.i18n=o.getString,this.objectId=e._route.objectId,this.sdrsAutomationSectionTitle=this.i18nService.getString("DsClusterUi","vmOverrides.services.sdrs"),this.sdrsAutomationLabel=this.i18nService.getString("DsClusterUi","vmOverrides.sdrsAutomationLevelHeaderText"),this.sdrsAutomationLevel=!1,this.storagePodSdrsAutomationText="",this.sdrsAutomationLevels=this.addVmOverridesPageService.createAutomationLevelsMap(),this.keepVdmkTogetherValuesMap=this.addVmOverridesPageService.createKeepVdmkTogetherValuesMap(),this.keepVdmkTogetherLabel=this.i18nService.getString("DsClusterUi","vmOverrides.intraVmAffinityHeaderText"),this.areVmsWithEqualIntraVmAffinityValues=!0,this.areVmsWithEqualSdrsAutomationValues=!0,this.multipleEditWarningMessage=""}return e.prototype.$onInit=function(){this.getViewData()},e.prototype.updateSdrsAutomationLevelValue=function(){this.spec.sdrsAutomationLevel||(this.spec.sdrsAutomationLevelValue=this.sdrsDefaultValue)},e.prototype.updateVdmkTogetherlValue=function(){this.spec.keepVmdksChecked||(this.spec.keepVmdksValue=this.keepVmdkTogetherDefaultValue)},e.prototype.editPreselectionOfUiElements=function(){this.selectedVms&&this.selectedVms.length>0&&this.selectedVms[0].rawData&&(this.setIntraVmAffinity(),this.setSdrsAutomationLevel())},e.prototype.setSdrsAutomationLevel=function(){if(this.areVmsWithEqualSdrsAutomationValues){var e=this.addVmOverridesPageService.getSdrsAutomationLevelForVm(this.selectedVms[0]);this.spec.sdrsAutomationLevel=e.sdrsAutomationLevel,this.spec.sdrsAutomationLevelValue=e.sdrsAutomationLevelValue}else this.sdrsAutomationLevels=_.extend({useInitialValues:{id:"useInitialValues",label:this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.useInitialValues"),value:this.dsClusterConstants.sdrsVmOverridesAutomationLevels.useInitialValues}},this.sdrsAutomationLevels),this.spec.sdrsAutomationLevelValue=this.dsClusterConstants.sdrsVmOverridesAutomationLevels.useInitialValues,this.spec.sdrsAutomationLevel=!0},e.prototype.setIntraVmAffinity=function(){if(this.areVmsWithEqualIntraVmAffinityValues){var e=this.addVmOverridesPageService.getIntraVmAffinityValueForAVm(this.selectedVms[0]);this.spec.keepVmdksChecked=e.keepVmdksChecked,this.spec.keepVmdksValue=e.keepVmdksValue}else this.keepVdmkTogetherValuesMap=_.extend({useInitialValues:{id:"useInitialValues",label:this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.useInitialValues"),value:this.dsClusterConstants.keepVmdksValues.useInitialValues}},this.keepVdmkTogetherValuesMap),this.spec.keepVmdksValue=this.dsClusterConstants.keepVmdksValues.useInitialValues},e.prototype.initAddSdrsVmOverridesData=function(e){var t=e[this.STORAGE_POD_AUTOMATION_LEVEL_PROPERTY],i=this.sdrsAutomationLevels[t].label;this.sdrsDefaultValue=this.sdrsAutomationLevels[t].id,this.spec.sdrsAutomationLevelValue=this.sdrsDefaultValue,this.spec.sdrsAutomationLevelDefaultValue=this.sdrsDefaultValue,this.keepVmdkTogetherDefaultValue=e[this.DEFAULT_INTRA_VM_AFFINITY_PROPERTY]?this.keepVdmkTogetherValuesMap.keepVmdksTogether.value:this.keepVdmkTogetherValuesMap.doNotKeepVmdksTogether.value,this.spec.keepVmdksValue=this.keepVmdkTogetherDefaultValue,this.spec.keepVmdksDefaultValue=this.keepVmdkTogetherDefaultValue,this.keepVdmkTogetherText=e[this.DEFAULT_INTRA_VM_AFFINITY_PROPERTY]?this.i18nService.getString("Common","yes.label"):this.i18nService.getString("Common","no.label"),this.storagePodSdrsAutomationText=i},e.prototype.initValidationResultsForEditMultipleVms=function(){var e=this.addSdrsVmOverridesService.getEditMultipleVmOverridesIdentityResults(this.selectedVms);
this.areVmsWithEqualIntraVmAffinityValues=e.vmsAreWithEqualIntraVmAffinity,this.areVmsWithEqualSdrsAutomationValues=e.vmsAreWithEqualSdrsAutomationLevel;var t=0;if(this.areVmsWithEqualIntraVmAffinityValues||(this.spec.keepVmdksChecked=!0,this.intraVmAffinityLevelSignPostParams=this.addSdrsVmOverridesService.buildVuiSignPostIntraVmAffinityLevel(this.selectedVms),t++),this.areVmsWithEqualSdrsAutomationValues||(this.sdrsAutomationLevelSignPostParams=this.addSdrsVmOverridesService.buildVuiSignPostSdrsAutomationLevel(this.selectedVms),t++),t>0){var i=1===t?this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.warningMessage.one"):this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.warningMessage.two");this.multipleEditWarningMessage=this.i18nService.getString("DsClusterUi","vmOverrides.config.editMultiple.warningMessage",i)}},e.prototype.getViewData=function(){var e=this;this.dataService.getProperties(this.objectId,[this.STORAGE_POD_AUTOMATION_LEVEL_PROPERTY,this.DEFAULT_INTRA_VM_AFFINITY_PROPERTY]).then(function(t){e.initAddSdrsVmOverridesData(t),e.spec.mode===e.dsClusterConstants.vmOverridesOperationType.EDIT&&(e.initValidationResultsForEditMultipleVms(),e.editPreselectionOfUiElements())})},e.$inject=["$rootScope","$scope","addVmOverridesPageService","addSdrsVmOverridesService","dataService","i18nService","dsClusterConstants"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="ds-cluster-ui/resources/ds-cluster/views/settings/configuration/sdrsVmOverrides/vmOverridesServicesComponent.html",this.bindings={spec:"=",selectedVms:"="}}return e}();angular.module("com.vmware.vsphere.client.dsCluster").component("vmOverridesServicesComponent",new i)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.storageVmOverridesService=t,this.datagridActionBarService=i,this.dsClusterConstants=r,this.objectId=e._route.objectId,this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.STORAGE_DRS_CONFIG],this.gridOptions=t.getGridOptions(),this.getViewData(),this.actions=[{actionId:"vsphere.core.dscluster.actions.vmOverrides.add"},{actionId:"vsphere.core.dscluster.actions.vmOverrides.edit",getActionInvocationContext:function(){return n.gridOptions.selectedItems},isActionAvailable:function(e){return e.available&&n.gridOptions.selectedItems.length>=1}},{actionId:"vsphere.core.dscluster.actions.vmoverrides.remove",getActionInvocationContext:function(){return n.gridOptions.selectedItems},isActionAvailable:function(e){return e.available&&n.gridOptions.selectedItems.length>0}}],this.createActionBar(),e.$watch(function(){return n.gridOptions.selectedItems},this.onSelectedVmOverrideChange.bind(this)),e.overridesPreselectComparator=this.overridesPreselectComparator.bind(this)}return e.prototype.overridesPreselectComparator=function(e){return this.selectedOverrides&&e&&_.some(this.selectedOverrides,function(t){return t.vm.name===e.vm.name})},e.prototype.getViewData=function(){var e=this;this.storageVmOverridesService.getViewData(this.objectId).then(function(t){e.gridOptions.data=t})},e.prototype.onSelectedVmOverrideChange=function(e){e&&0!==e.length?this.selectedOverrides=e:this.selectedOverrides=null,this.refreshActionBar()},e.prototype.refreshActionBar=function(){this.datagridActionBarServiceCacheObject&&this.datagridActionBarService.updateActionBar(this.gridOptions,[this.objectId],this.actions,this.datagridActionBarServiceCacheObject)},e.prototype.createActionBar=function(){var e=this;this.datagridActionBarService.updateActionBar(this.gridOptions,[this.objectId],this.actions).then(function(t){e.datagridActionBarServiceCacheObject=t})},e.$inject=["$scope","storageVmOverridesService","datagridActionBarService","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("StorageVmOverridesController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var cluster_ui;!function(e){var t=function(){function e(e,t,i){var r=this;this.$scope=e,this.dataService=t,this.$timeout=i,e.pages={categories:e.modalOptions.dialogData.manager.getPageDefinitions()},e.selectedCategoryId=e.pages.categories[0].id,e.selectCategory=function(e){r.$scope.selectedCategoryId=e},e.enableButtonAutofocus=!0,this.getViewData(),this.onTabsClick=function(){e.enableButtonAutofocus&&(e.enableButtonAutofocus=!1)}}return e.prototype.getSelectedPageUrl=function(){var e=this,t=_.find(this.$scope.pages.categories,function(t){return t.id===e.$scope.selectedCategoryId});return t?t.contentUrl:""},e.prototype.getViewData=function(){var e=this;this.setPageBusy(!0),this.dataService.getData(this.$scope.modalOptions.dialogData.objectId,"com.vmware.vsphere.client.dsclusterui.model.DsClusterEditSdrsData").then(function(t){_.extend(e.$scope.modalOptions.dialogData.sdrsData,t),e.pageModel=e.$scope.modalOptions.dialogData.manager.getStorageDrsAutomationModel(),e.setPageBusy(!1),e.$timeout(function(){$("#dsClusterEditSdrsEnabledCheckbox").focus()},1)})},e.prototype.setPageBusy=function(e){this.loading=e,this.$scope.modalOptions.submitDisabled=e},e.$inject=["$scope","dataService","$timeout"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("EditSdrsDialogController",t)}(cluster_ui||(cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.storageDrsAdvancedOptionsService=t,this.dsClusterConstants=i,this.i18nService=r;var o=e.modalOptions.dialogData.manager;this.pageModel=o.getStorageDrsAdvancedOptionsModel();var a=this.pageModel.convertedLoadBalanceInterval.unitKey;this.pageModel.convertedLoadBalanceInterval.unit=this.i18nService.getString("DsClusterUi",1===this.pageModel.convertedLoadBalanceInterval.value?a+"S":a),e.$watch("sdrsAdvancedOptionsForm.$invalid",function(e){o.setFormValidationResult(!e)}),this.initLoadBalanceInterval(),this.initMinUtilizationDifference(),this.ioImbalanceThresholdSliderOptions=this.storageDrsAdvancedOptionsService.getIoImbalanceThresholdSliderOptions(this.pageModel.ioLoadImbalanceThreshold,this.i18nService.getString("DsClusterUi","sdrs.config.ioImbalanceThresholdLabel")),e.$watch(function(){return n.ioImbalanceThresholdSliderOptions.value},function(e){n.pageModel.ioLoadImbalanceThreshold=parseInt(e,10)})}return e.prototype.initMinUtilizationDifference=function(){var e=this;this.minUtilizationDifferenceMin=this.dsClusterConstants.minSpaceUtilizationDifference.MIN,this.minUtilizationDifferenceMax=this.dsClusterConstants.minSpaceUtilizationDifference.MAX,this.$scope.$watch("ctrl.pageModel.spaceLoadBalanceConfig.minSpaceUtilizationDifference",function(t){t>e.minUtilizationDifferenceMax&&(e.pageModel.spaceLoadBalanceConfig.minSpaceUtilizationDifference=e.minUtilizationDifferenceMax),t<e.minUtilizationDifferenceMin&&(e.pageModel.spaceLoadBalanceConfig.minSpaceUtilizationDifference=e.minUtilizationDifferenceMin)})},e.prototype.initLoadBalanceInterval=function(){this.loadBalanceUnitOptions=this.storageDrsAdvancedOptionsService.getUnitOptions(),this.loadBalanceIntervalOptions=this.storageDrsAdvancedOptionsService.getIntervalOptions(this.pageModel),this.loadBalanceIntervalErrorMessages=this.storageDrsAdvancedOptionsService.getErrorMessages()},e.$inject=["$scope","storageDrsAdvancedOptionsService","dsClusterConstants","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("StorageDrsAdvancedOptionsPageViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.storageDrsAutomationService=t,this.sdrsManager=e.modalOptions.dialogData.manager,this.pageModel=this.sdrsManager.getStorageDrsAutomationModel(),this.enableButtonAutofocus=e.enableButtonAutofocus}return e.$inject=["$scope","storageDrsAutomationService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("StorageDrsAutomationPageViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.i18nService=t,this.dsClusterConstants=i;var r=e.modalOptions.dialogData.manager;this.pageModel=r.getStorageDrsRuntimeSettingsModel(),this.pageModel.isInEditMode=!0}return e.$inject=["$scope","i18nService","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("StorageDrsRuntimeSettingsPageViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.$scope=e,this.dataService=t,this.vcService=i,this.$q=r,this.$timeout=n,this.objectId=e.modalOptions.dialogData.objectId,this.$scope.modalOptions.dialogData.manager.initManager({},this.$scope.modalOptions),this.$scope.modalOptions.isAlertClosed=!0,e.enableButtonAutofocus=!0,this.onTabsClick=function(){e.enableButtonAutofocus&&(e.enableButtonAutofocus=!1)},this.getViewData()}return e.prototype.getSelectedPageUrl=function(){var e=this,t=_.find(this.$scope.pages.categories,function(t){return t.id===e.$scope.selectedCategoryId});return t?t.contentUrl:""},e.prototype.getViewData=function(){var e=this;this.setPageBusy(!0),this.$scope.pages={categories:this.$scope.modalOptions.dialogData.manager.getPageDefinitions()},this.$scope.selectedCategoryId=this.$scope.pages.categories[0].id,this.$scope.selectCategory=function(t){e.$scope.selectedCategoryId=t},this.dataService.getData(this.$scope.modalOptions.dialogData.objectId,"com.vmware.vsphere.client.dsclusterui.model.DsClusterEditSdrsData").then(function(t){_.extend(e.$scope.modalOptions.dialogData.manager.sdrsData,t),e.formData=e.$scope.modalOptions.dialogData.manager.getSheduleModel(),e.setPageBusy(!1),e.addWatchers(),e.$timeout(function(){$("#dsClusterEditSdrsEnabledCheckbox").focus()},1)})},e.prototype.setPageBusy=function(e){this.loading=e,this.$scope.modalOptions.submitDisabled=e},e.prototype.addWatchers=function(){var e=this;this.$scope.$watch("ctrl.formData",function(){e.$scope.manager.setFormData(e.$scope.modalOptions.dialogData.manager.getFormData())},!0)},e.$inject=["$scope","dataService","vcService","$q","$timeout"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("ScheduleSdrsSdrsSettingsPageController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l){this.i18nService=e,this.vuiConstants=t,this.mutationService=i,this.defaultUriSchemeUtil=r,this.$rootScope=n,this.wizardPageService=o,this.vscSchedulingHelper=a,this.$q=s,this.dsClusterConstants=c,this.dsClusterSpecBuilderService=l,this.scheduleModel={},this.formData={},this.buildPages()}return e.prototype.getPageDefinitions=function(){return[this.scheduleSettingsPageDef,this.sdrsSettingsPageDef]},e.prototype.getObjectId=function(){return this.objectId},e.prototype.getModel=function(){return this.scheduleModel},e.prototype.setModel=function(e){this.scheduleModel=e},e.prototype.setFormData=function(e){_.extend(this.formData,e)},e.prototype.submit=function(){return this.scheduleModel.scheduleTaskSpec.spec=this.dsClusterSpecBuilderService.buildDsClusterSpec(this.formData,!0),this.scheduleModel.scheduleTaskSpec.spec._type=this.dsClusterConstants.DS_CLUSTER_SPEC_TYPE,this.scheduleModel.scheduleTaskSpec.schedulingSpec.recurrence=this.vscSchedulingHelper.formatRecurrenceData(this.scheduleModel.scheduleTaskSpec.schedulingSpec.recurrence),this.mutationService.apply(this.objectId,"com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec",this.scheduleModel.scheduleTaskSpec),!0},e.prototype.getWizardConfig=function(){var e=this;return this.wizardConfig||(this.wizardConfig={title:this.i18nService.getString("ScheduledOpsUi","scheduledTask.ScheduleNewTasks.label")+" ("+this.i18nService.getString("DsClusterUi","sdrs.dialog.edit.title")+")",pages:this.getPageDefinitions(),show:!0,loading:!1,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),onFinish:function(){return e.submit()},cssClass:"schedule-sdrs-wizard"}),this.wizardConfig},e.prototype.init=function(e){this.objectId=e,this.scheduleModel={scheduleTaskSpec:{spec:{},operation:0,entity:this.defaultUriSchemeUtil.getManagedObjectReference(e),schedulingSpec:{_type:"com.vmware.vise.core.model.scheduling.ScheduledTaskSpec",scheduledTask:null,recurrence:null,name:"Configure Storage DRS",description:"",source:"StoragePod",enabled:!0,notification:""},deferredOperation:0,scheduleTaskOperationMode:0}}},e.prototype.buildPages=function(){var e=this;this.scheduleSettingsPageDef={title:this.i18nService.getString("ScheduledOpsUi","scheduledTask.snapshot.options"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/services/scheduleTask/scheduleSdrsScheduleOptionsPage.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){var t=e.getModel().scheduleTaskSpec.schedulingSpec.recurrence,i=e.getModel().scheduleTaskSpec.schedulingSpec.isFormStatusValid;return t&&i?(e.setModel(e.getModel()),e.wizardPageService.markPageComplete(e.wizardConfig),!0):(t||e.wizardPageService.markPageIncompleteWithError(e.wizardConfig,e.i18nService.getString("SchedulingUi","scheduledTask.emptyScheduler")),!1)}},this.sdrsSettingsPageDef={title:this.i18nService.getString("DsClusterUi","sdrs.schedule.config.pageTitle"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/services/scheduleTask/scheduleSdrsSdrsSettingsPage.html",state:this.vuiConstants.wizard.pageState.DISABLED}},e.$inject=["i18nService","vuiConstants","mutationService","defaultUriSchemeUtil","$rootScope","wizardPageService","vscSchedulingHelper","$q","dsClusterConstants","dsClusterSpecBuilderService"],e}();e.ScheduleSdrsWizardManager=t,angular.module("com.vmware.vsphere.client.dsCluster").service("scheduleSdrsWizardManager",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$rootScope=e,this.i18nService=t,this.vuiWizardService=i,this.wizardManager=r,this.pageStateManagementService=n,this.sdrsDialogManager=o}return e.prototype.show=function(e,t){var i=this.$rootScope.$new();this.wizardManager.init(e),i.wizardConfig=this.wizardManager.getWizardConfig(),i.manager=this.wizardManager,i.modalOptions={focusTarget:t,dialogData:{manager:this.sdrsDialogManager,objectId:e}},this.pageStateManagementService.registerWizardForDefaultStateManagementStrategy(i),this.vuiWizardService({scope:i,configObjectName:"wizardConfig"}).show()},e.$inject=["$rootScope","i18nService","vuiWizardService","scheduleSdrsWizardManager","pageStateManagementService","sdrsDialogManager"],e}();e.ScheduleSdrsWizardService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("scheduleSdrsWizardService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.storageDrsDataRetrieval=i,this.dsClusterConstants=r,this.$scope=e,this.objectId=e._route.objectId,this.headerOptions={title:this.getString("dscluster.services.drs"),objectId:this.objectId,actions:[{actionUid:"vsphere.core.dsCluster.actions.scheduleSdrs",customLabel:t.getString("DsClusterUi","sdrs.config.scheduleSdrs.button.label")},{actionUid:"vsphere.core.dsCluster.actions.editSdrs",customLabel:t.getString("Common","settingsView.defaultEditActionLabel")}]},this.watchForObjects=[this.objectId],this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.STORAGE_DRS_CONFIG],this.getViewData()}return e.prototype.getViewData=function(){var e=this;this.storageDrsDataRetrieval.retrieveData(this.objectId).then(function(t){e.sdrsViewModelData=t,e.headerOptions.title=e.getTitle(t.enabled)})},e.prototype.getTitle=function(e){return e?this.getString("sdrs.config.sdrsEnabled"):this.getString("sdrs.config.sdrsDisabled")},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("DsClusterUi",e,t)},e.$inject=["$scope","i18nService","storageDrsDataRetrieval","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("StorageDrsViewController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.vuiAddVmOverridesWizard=e,this.i18nService=t,this.dsClusterConstants=i,this.mutationService=r,this.storageVmOverridesService=n,this.defaultUriSchemeUtil=o,this.$q=a}return e.prototype.buildSelectVmsPage=function(e){var t=this;return{title:this.i18nService.getString("DsClusterUi","vmOverrides.selection.title"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/sdrsVmOverrides/selectVmsToOverrideView.html",onCommit:function(){var i=e.manager.getSelectedVms();return i&&i.length>0?(t.vuiAddVmOverridesWizard.markPageComplete(),!0):(t.vuiAddVmOverridesWizard.markPageIncompleteWithError(t.i18nService.getString("DsClusterUi","sdrs.vmOverrides.noVmIsSelected")),!1)},disableNext:function(){return e.wizardConfig.loading}}},e.prototype.buildAddVmOverridesPage=function(e){var t=this;return{title:this.i18nService.getString("DsClusterUi","vmOverrides.services.sdrs"),contentUrl:"ds-cluster-ui/resources/ds-cluster/views/settings/configuration/sdrsVmOverrides/addVmOverridesView.html",onCommit:function(){var i=e.manager.getSpec(),r=e.manager.getSelectedVms(),n=e.manager.getTargetUid(),o=t.$q.defer();if(i.keepVmdksChecked||i.sdrsAutomationLevel){var a=i.keepVmdksChecked?i.keepVmdksValue:t.dsClusterConstants.keepVmdksValues.clusterDefault,s=i.sdrsAutomationLevel?i.sdrsAutomationLevelValue:t.dsClusterConstants.sdrsVmOverridesAutomationLevels.clusterDefault,c=t.getOverrideSpec(r,s,a,"Add");e.wizardConfig.loading=!0,t.mutationService.validate(n,t.dsClusterConstants.SDRS_VM_OVERRIDE_SPEC,c).then(function(i){if(e.wizardConfig.loading=!1,i&&i.result&&i.result.length>0){var r=t.storageVmOverridesService.getVmOverrideErrorMessages(i.result);t.vuiAddVmOverridesWizard.markPageIncompleteWithError(r.text),o.reject()}else t.mutationService.apply(n,t.dsClusterConstants.SDRS_VM_OVERRIDE_SPEC,c),o.resolve(!0)})}else{var l=t.i18nService.getString("DsClusterUi","vm.overrides.config.noChangesValidationError");t.vuiAddVmOverridesWizard.markPageIncompleteWithError(l),o.reject()}return o.promise},finishReady:function(){return!e.wizardConfig.loading}}},e.prototype.createKeepVdmkTogetherValuesMap=function(){return{keepVmdksTogether:{id:"keepVmdksTogether",label:this.i18nService.getString("Common","yes.label"),value:"KeepVmdksTogether"},doNotKeepVmdksTogether:{id:"DoNotKeepVmdksTogether",label:this.i18nService.getString("Common","no.label"),value:"DoNotKeepVmdksTogether"}}},e.prototype.createAutomationLevelsMap=function(){return{automated:{id:"Automated",label:this.i18nService.getString("DsClusterUi","vmOverrides.vmSdrsAutomationLevelFullyAutomated")},manual:{id:"Manual",label:this.i18nService.getString("DsClusterUi","vmOverrides.vmSdrsAutomationLevelManual")},disabled:{id:"Disabled",label:this.i18nService.getString("DsClusterUi","vmOverrides.vmSdrsAutomationLevelDisabled")}}},e.prototype.getIntraVmAffinityValueForAVm=function(e){var t=this.createKeepVdmkTogetherValuesMap(),i=!0,r="";return null===e.rawData.intraVmAffinity?(i=!1,r=e.rawData.defaultIntraVmAffinity?t.keepVmdksTogether.value:t.doNotKeepVmdksTogether.value):(i=!0,r=e.rawData.intraVmAffinity?t.keepVmdksTogether.value:t.doNotKeepVmdksTogether.value),{keepVmdksChecked:i,keepVmdksValue:r}},e.prototype.getSdrsAutomationLevelForVm=function(e){var t=this.createAutomationLevelsMap(),i=!0,r="",n=e.rawData.vmAutomationLevel,o=e.rawData.vmAutomationLevelEnabled,a=e.rawData.defaultVmAutomationLevel;return n===this.dsClusterConstants.SDRS_FULLAUTO?(i=!0,r=t[n].id):n===this.dsClusterConstants.SDRS_MANUAL?(i=!0,r=t[n].id):null===n&&(null===o?a===this.dsClusterConstants.SDRS_FULLAUTO?(i=!1,r=t[a].id):a===this.dsClusterConstants.SDRS_MANUAL&&(i=!1,r=t[a].id):(i=!0,r=t.disabled.id)),{sdrsAutomationLevel:i,sdrsAutomationLevelValue:r}},e.prototype.getOverrideSpec=function(e,t,i,r){var n=this;return{operation:r,vmOverrides:_.map(e,function(e){var o={};if(r===n.dsClusterConstants.vmOverridesOperationType.ADD)o={vmSor:n.defaultUriSchemeUtil.getManagedObjectReference(e.id),vmName:e.name,sdrsAutomationLevel:t,intraVmAffinity:i};else{var a=n.getIntraVmAffinityByKeepVmdksValue(i,e),s=n.getSdrsValueBySdrsAutomationLevel(t,e);o={vmSor:e.vm.provider,vmName:e.name,sdrsAutomationLevel:s,intraVmAffinity:a}}return o})}},e.prototype.getIntraVmAffinityByKeepVmdksValue=function(e,t){var i="";if(e===this.dsClusterConstants.keepVmdksValues.useInitialValues){var r=this.getIntraVmAffinityValueForAVm(t);i=r.keepVmdksChecked?r.keepVmdksValue:this.dsClusterConstants.sdrsVmOverridesAutomationLevels.clusterDefault}else i=e;return i},e.prototype.getSdrsValueBySdrsAutomationLevel=function(e,t){var i="",r=this.dsClusterConstants.sdrsVmOverridesAutomationLevels.clusterDefault,n=this.dsClusterConstants.sdrsVmOverridesAutomationLevels.useInitialValues;if(e===n){var o=this.getSdrsAutomationLevelForVm(t);i=o.sdrsAutomationLevel?o.sdrsAutomationLevelValue:r}else i=e;return i},e.$inject=["vuiAddVmOverridesWizard","i18nService","dsClusterConstants","mutationService","storageVmOverridesService","defaultUriSchemeUtil","$q"],e}();e.AddVmOverridesPageService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("addVmOverridesPageService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$rootScope=e,this.dataService=t,this.vuiAddVmOverridesWizard=i,this.addVmOverridesPageService=r}return e.prototype.invokeWizard=function(e,t){var i=this;t.setTargetUid(e),t.setSelectedVms([]),t.setSpec({}),this.wizardScope=this.$rootScope.$new(),this.wizardScope.manager=t;var r=this.createWizardPages(this.wizardScope);this.dataService.getProperties(e,["name"]).then(function(e){if(e&&e.name){var n=e.name;t.setClusterName(n),i.vuiAddVmOverridesWizard.show(r,i.wizardScope)}})},e.prototype.createWizardPages=function(e){var t=[];return t.push(this.addVmOverridesPageService.buildSelectVmsPage(e)),t.push(this.addVmOverridesPageService.buildAddVmOverridesPage(e)),t},e.$inject=["$rootScope","dataService","vuiAddVmOverridesWizard","addVmOverridesPageService"],e}();e.AddVmOverridesWizardService=t,angular.module("com.vmware.vsphere.client.dsCluster").service("addVmOverridesWizardService",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.wizardPageService=e,this.vuiWizardService=t,this.$rootScope=i,this.i18nService=r}return e.prototype.show=function(e,t){this.wizardConfig=_.extend(t.wizardConfig?t.wizardConfig:{},{title:this.i18nService.getString("DsClusterUi","vmOverrides.config.add.title",t.manager.getClusterName()),pages:this.wizardPageService.initializePageStates(e),resizeMinHeight:500,onFinish:function(){return!0}}),this.wizardScope=t,this.wizardScope.wizardConfig=this.wizardConfig,this.vuiWizardService({scope:this.wizardScope,configObjectName:"wizardConfig"}).show()},e.prototype.markPageIncompleteWithError=function(e){this.wizardPageService.markPageIncompleteWithError(this.wizardConfig,e)},e.prototype.markPageComplete=function(e){this.wizardPageService.clearErrors(this.wizardConfig),this.wizardPageService.markPageComplete(this.wizardConfig,e)},e.$inject=["wizardPageService","vuiWizardService","$rootScope","i18nService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").service("vuiAddVmOverridesWizard",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r){this.$rootScope=e,this.i18nService=t,this.dsClusterConsumersService=i,this.dsClusterConstants=r,this.objectId=this.$rootScope._route.objectId,this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.SUMMARY],this.getData()}return e.prototype.getData=function(){var e=this;this.dsClusterConsumersService.getPropertyViewData(this.objectId).then(function(t){e.consumersData=t})},e.$inject=["$rootScope","i18nService","dsClusterConsumersService","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterConsumersPortletController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.dataService=e,this.$rootScope=t,this.dsClusterServicesAndResourcesService=i,this.i18nService=r,this.dsClusterConstants=n,this.numberFormatterService=o,this.objectId=this.$rootScope._route.objectId,this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.SUMMARY],this.getData()}return e.prototype.getData=function(){var e=this;this.dataService.getData(this.objectId,"com.vmware.vsphere.client.dsclusterui.model.DsClusterResourcesData").then(function(t){e.resourcesData=e.dsClusterServicesAndResourcesService.buildResourcesPropertyViewData(t),e.usedPercentage=t.usedSpacePercentage;var i=e.numberFormatterService.format(t.usedSpacePercentage);e.usedPercentageLabel=e.i18nService.getString("DsClusterUi","sdrs.config.utilizedSpaceThreshold.format",i),e.minResourcesLabel=e.dsClusterServicesAndResourcesService.getMinCapacityLabel(t.formattedCapacity),e.totalResourcesLabel=t.formattedCapacity})},e.$inject=["dataService","$rootScope","dsClusterServicesAndResourcesService","i18nService","dsClusterConstants","numberFormatterService"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterResourcesPortletController",t)}(ds_cluster_ui||(ds_cluster_ui={}));var ds_cluster_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.dataService=e,this.$rootScope=t,this.dsClusterServicesAndResourcesService=i,this.i18nService=r,this.storageDrsDataRetrieval=n,this.vxPropertyViewService=o,this.$scope=a,this.dsClusterConstants=s,this.objectId=this.$rootScope._route.objectId,this.liveRefreshProperties=[this.dsClusterConstants.liveRefreshProperties.STORAGE_DRS_CONFIG,this.dsClusterConstants.liveRefreshProperties.FAULT,this.dsClusterConstants.liveRefreshProperties.RECOMMENDATION],this.getData()}return e.prototype.getData=function(){var e=this;this.storageDrsDataRetrieval.retrievePortletData(this.objectId).then(function(t){e.sdrsEnabled=t.enabled,e.resourcesData=e.dsClusterServicesAndResourcesService.buildServicesPropertyViewData(t,e.objectId,e.$scope._route.navigator)})},e.$inject=["dataService","$rootScope","dsClusterServicesAndResourcesService","i18nService","storageDrsDataRetrieval","vxPropertyViewService","$scope","dsClusterConstants"],e}();angular.module("com.vmware.vsphere.client.dsCluster").controller("DsClusterServicesPortletController",t)}(ds_cluster_ui||(ds_cluster_ui={})),h5=h5||{},h5.tagging={angularModule:angular.module("com.vmware.vsphere.client.tagging",["com.vmware.platform.ui"])},angular.module("com.vmware.vsphere.client.tagging").run([function(){}]),h5=h5||{},h5.networkLibUi={angularModule:angular.module("com.vmware.vsphere.client.networkLibUi",["com.vmware.platform.ui"])},function(){"use strict";function e(e,t,i,r){function n(i,r){if(i){var n=t.createPropertyViewBuilder(),a=n.category("general").title(e.getString("NetworkUi","DvsConfigPage.general.title"));return o(i,r,a),s(i,a),l(i,a),p(i,a),n.build()}return{}}function o(t,r,n){var o=e.getString("NetworkUi","DvsConfigPage.general.title"),s=n.section("generalSection").title(o);t.name&&s.property(i.getString("DvsConfigPage.general.body.name.label"),t.name),t.description&&s.property(e.getString("NetworkUi","DvsConfigPage.general.body.notes.label"),t.description),t.productVendor&&s.property(i.getString("HostProxySwitchDetailsView.manufacturer"),t.productVendor),t.productVersion&&s.property(i.getString("HostProxySwitchDetailsView.version"),i.getString("SwitchDiagram.dvsVersionStringFormat",t.productVersion,t.productBuildNumber?t.productBuildNumber:"")),t.productBuildNumber&&s.property(i.getString("HostProxySwitchDetailsView.version"),t.productVersion),t.uplinkPorts&&s.property(i.getString("DvsConfigPage.general.body.numberOfUplinks.label"),t.uplinkPorts),!r&&t.numberOfPorts&&s.property(i.getString("DvsConfigPage.general.body.numberOfPorts.label"),t.numberOfPorts),t.networkResourceManagementSupported&&s.property(i.getString("DvsConfigPage.resmgmt.label"),a(t.networkResourceManagementEnabled))}function a(e){return e?i.getString("DvsConfigPage.resmgmt.enabled"):i.getString("DvsConfigPage.resmgmt.disabled")}function s(t,r){var n=e.getString("NetworkUi","DvsConfigPage.advanced.title"),o=r.section("advancedSection").title(n);t.maxMtu&&o.property(i.getString("DvsConfigPage.advanced.maxMtu.label"),i.getString("DvsConfigPage.advanced.maxMtu.format",t.maxMtu)),t.multicastSnoopingSupported&&t.multicastFilteringMode&&o.property(i.getString("DvsConfigPage.advanced.multicastFiltering.label"),c(t.multicastFilteringMode)),t.dvsCapabilities&&t.dvsCapabilities.defaultMaxNumPortsSupported&&t.defaultProxySwitchMaxNumPorts&&o.property(i.getString("DvsConfigPage.advanced.defaultMaxNumPorts.label"),t.defaultProxySwitchMaxNumPorts)}function c(e){return e===r.MulticastFiltering.BASIC?i.getString("DvsConfigPage.advanced.multicastMode.basic"):e===r.MulticastFiltering.SNOOPING?i.getString("DvsConfigPage.advanced.multicastMode.snooping"):void 0}function l(t,n){var o=e.getString("NetworkUi","DvsConfigPage.advanced.dp.title"),a=n.section("ldpSection").title(o);t.linkDiscoveryProtocolOperation!==r.LinkDiscoveryOperation.DISABLED?(a.property(i.getString("DvsConfigPage.advanced.dp.type.label"),d(t.linkDiscoveryProtocolType)),a.property(i.getString("DvsConfigPage.advanced.dp.operation.label"),u(t.linkDiscoveryProtocolOperation))):(a.property(i.getString("DvsConfigPage.advanced.dp.type.label"),i.getString("DvsConfigPage.advanced.dp.type.disabled")),a.property(i.getString("DvsConfigPage.advanced.dp.operation.label"),""))}function d(e){return e===r.LinkDiscoveryProtocol.CDP?i.getString("DvsConfigPage.advanced.dp.type.cdp"):e===r.LinkDiscoveryProtocol.LLDP?i.getString("DvsConfigPage.advanced.dp.type.lldp"):void 0}function u(e){switch(e){case r.LinkDiscoveryOperation.ADVERTISE:return i.getString("DvsConfigPage.advanced.dp.operation.advertise");case r.LinkDiscoveryOperation.LISTEN:return i.getString("DvsConfigPage.advanced.dp.operation.listen");case r.LinkDiscoveryOperation.BOTH:return i.getString("DvsConfigPage.advanced.dp.operation.both");default:return""}}function p(t,r){var n=e.getString("NetworkUi","DvsConfigPage.advanced.contact.title"),o=r.section("adminContactSection").title(n);o.property(i.getString("DvsConfigPage.advanced.contact.name.label"),t.contactName),o.property(i.getString("DvsConfigPage.advanced.contact.contact.label"),t.contact)}return{build:n}}angular.module("com.vmware.vsphere.client.networkLibUi").service("dvsDetailsViewService",e),e.$inject=["i18nService","vxPropertyViewService","networkUtil","networkUiConstants"]}();var network_lib_ui;!function(e){var t=function(){function e(){this.bindings={dvsUri:"<"},this.controller=i,this.templateUrl="network-lib-ui/resources/network-lib/components/dvsProperties/dvsPropertiesView.html"}return e}();e.DvsPropertiesViewComponent=t;var i=function(){function e(e,t){this.dataService=e,this.dvsDetailsViewService=t,this.liveRefreshProperties=["name","config.productInfo.version","config.contact.name","config.contact.contact","config.linkDiscoveryProtocolConfig.protocol","config.linkDiscoveryProtocolConfig.operation","config.name","config.description","config.multicastFilteringMode","config.maxMtu","config.defaultProxySwitchMaxNumPorts","config.numPorts","config.uplinkPortPolicy.uplinkPortName","config.networkResourceManagementEnabled"]}return e.prototype.$onChanges=function(){this.refresh()},e.prototype.refresh=function(){var t=this;this.dvsUri&&(this.loadingData=!0,this.dataService.getProperties(this.dvsUri,[e.CONFIG_DATA_PROPERTY_NAME]).then(function(i){var r=i?i[e.CONFIG_DATA_PROPERTY_NAME]:null;if(r&&r.name){var n=r.name.trim(),o=n.replace(/%25/g,"%").replace(/%2f/g,"/").replace(/%5c/g,"\\");r.name=o}t.dvsDetailsData=t.dvsDetailsViewService.build(r,!1),t.loadingData=!1;
}))},e.$inject=["dataService","dvsDetailsViewService"],e.CONFIG_DATA_PROPERTY_NAME="dvswitchproperties:configdata",e}();angular.module("com.vmware.vsphere.client.networkLibUi").component("dvsPropertiesView",new t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(e,t,i){return{restrict:"A",scope:!1,link:function(r,n,o){function a(){c.errorData&&c.errorData.showMessage()&&(l=e(u)(c),c.$apply(),d.append(l),p())}function s(){l&&l.remove()}if(!o.errorTooltipData)throw new Error("error-tooltip-data attribute is not found.");var c=r.$new(!0);r.$watch(o.errorTooltipData,function(e){c.errorData=e}),n.bind("mouseenter",a),n.bind("mouseleave",s);var l,d=angular.element(t.document.body),u='<div ng-show="errorData.showMessage()" class="vx-error-tooltip tooltip right in"><div class="tooltip-arrow"></div><div class="tooltip-inner">{{errorData.message}}</div></div>',p=function(){var e=i.positionElements(n,l,"right",!0);e.top+="px",e.left+="px",l.css(e)};r.$on("$destroy",function(){l&&l.remove()})}}}angular.module("com.vmware.vsphere.client.networkLibUi").directive("errorTooltip",e),e.$inject=["$compile","$window","positionService"]}();var network_lib_ui;!function(e){var t=function(){function e(){this.require={model:"ngModel"},this.bindings={type:"<",enabled:"<",name:"@",message:"<",validate:"=?",onValidationComplete:"&",directionClass:"<?",inputId:"<?",labelledby:"@?"},this.controller=r,this.templateUrl="network-lib-ui/resources/network-lib/components/ipv4Address/ipAddressInput.html"}return e}();e.IpAddressInputComponent=t;var i=function(){function e(){this.IPV4=new n,this.IPV6=new o}return e}();e.StaticIpInputTypes=i;var r=function(){function e(e,t,i,r,n){this.vxValidatorFactory=e,this.ipParserService=t,this.i18nService=i,this.staticIpInputTypes=r,this.$log=n,this.validator=this.vxValidatorFactory.create()}return e.prototype.$onInit=function(){var e=this;this.name=this.name||"ipv4AddressInput",this.validateEmptyValue=!1,this.setValidateFunctionBasedOnType(),this.model.$render=function(){e.value=e.model.$viewValue},this.validate=function(){return e.validateEmptyValue=!0,e.validator.validate.call(e.validator)}},e.prototype.$onChanges=function(e){e.enabled?this.validateInput():e.type&&this.setValidateFunctionBasedOnType()},e.prototype.onChange=function(){this.model.$setViewValue(this.value)},e.prototype.onBlur=function(){this.validateInput()},e.prototype.setValidateFunctionBasedOnType=function(){this.type===this.staticIpInputTypes.IPV4.IP_ADDRESS?(this.validateFunction=this.validateIPv4Address.bind(this),this.message=this.message||this.i18nService.getString("NetworkLibUi","invalidIpAddress")):this.type===this.staticIpInputTypes.IPV4.SUBNET_MASK?(this.validateFunction=this.validateSubnetMask.bind(this),this.message=this.message||this.i18nService.getString("NetworkLibUi","invalidSubnetMask")):this.type===this.staticIpInputTypes.IPV4.DEFAULT_GATEWAY?(this.validateFunction=this.validateIPv4Address.bind(this),this.message=this.message||this.i18nService.getString("NetworkLibUi","invalidIpv4DefaultGateway")):this.type===this.staticIpInputTypes.IPV6.IPV6_ADDRESS?(this.validateFunction=this.validateIPv6Address.bind(this),this.message=this.message||this.i18nService.getString("NetworkLibUi","invalidIpv6Address")):this.type===this.staticIpInputTypes.IPV6.IPV6_ADDRESS_LINK_LOCAL?(this.validateFunction=this.validateLinkLocalIPv6Address.bind(this),this.message=this.message||this.i18nService.getString("NetworkLibUi","invalidIpv6LinkLocalAddress")):this.type===this.staticIpInputTypes.IPV6.DEFAULT_GATEWAY?(this.validateFunction=this.validateIPv6Address.bind(this),this.message=this.message||this.i18nService.getString("NetworkLibUi","invalidIpv6DefaultGateway")):this.$log.warn("IpAddressInputController#type "+this.type+" has no validations defined")},e.prototype.validateInput=function(){var e=this.validator.validate();this.onValidationComplete({errors:e})},e.prototype.validateIPv4Address=function(){return this.triggerValidation()&&!this.ipParserService.isIpv4AddressValid(this.value)?[this.message]:(this.validateEmptyValue=!1,[])},e.prototype.validateIPv6Address=function(){return this.triggerValidation()&&!this.ipParserService.isIpv6AddressValid(this.value)?[this.message]:(this.validateEmptyValue=!1,[])},e.prototype.validateLinkLocalIPv6Address=function(){return!this.triggerValidation()||this.ipParserService.isIpv6AddressValid(this.value)&&this.isLinkLocalIPv6Address(this.value)?(this.validateEmptyValue=!1,[]):[this.message]},e.prototype.isLinkLocalIPv6Address=function(e){if(!e||e.length<4)return!1;var t=parseInt(e.substr(0,4),16);return 65152===(65472&t)},e.prototype.validateSubnetMask=function(){return this.triggerValidation()&&!this.ipParserService.isSubnetMaskValid(this.value)?[this.message]:(this.validateEmptyValue=!1,[])},e.prototype.triggerValidation=function(){return this.enabled&&(this.validateEmptyValue||!!this.value)},e.$inject=["vxValidatorFactory","ipParserService","i18nService","staticIpInputTypes","$log"],e}(),n=function(){function e(){this.IP_ADDRESS="ipv4Address",this.SUBNET_MASK="subnetMask",this.DEFAULT_GATEWAY="defaultGateway"}return e}(),o=function(){function e(){this.IPV6_ADDRESS="ipv6Address",this.IPV6_ADDRESS_LINK_LOCAL="ipv6AddressLinkLocal",this.DEFAULT_GATEWAY="defaultIpv6Gateway"}return e}();angular.module("com.vmware.vsphere.client.networkLibUi").constant("staticIpInputTypes",new i),angular.module("com.vmware.vsphere.client.networkLibUi").component("ipAddressInput",new t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(){var e={restrict:"A",replace:!0,scope:{value:"="},template:'<input class="ip-address-input" type="text" ng-model="value"/>'};return e}var t=angular.module("com.vmware.vsphere.client.networkLibUi");t.directive("ipv4AddressInput",e)}(),function(){"use strict";function e(){var e={restrict:"A",replace:!0,scope:{networkSelectorName:"<?",objectRef:"=",mode:"=",filterSpec:"=",dialogSpec:"=?",preselectedNetwork:"=?",onSelectedNetworks:"&onSelectedNetworks",onPreloadNetworks:"&onPreloadNetworks",prefetchedNetworks:"=?",errorConfig:"<?",sortParams:"<?",isDisabled:"<?",preloadNetworks:"<?"},templateUrl:"network-lib-ui/resources/network-lib/components/networkselector/networkSelector.html",controller:"NetworkSelectorController",controllerAs:"ctrl"};return e}var t=angular.module("com.vmware.vsphere.client.networkLibUi");t.directive("networkSelector",e),t.constant("NetworkSelectorMode",{SINGLE_SELECTION_BROWSE_INPUT:"singleSelectionBrowseInput",SINGLE_SELECTION_BUTTON:"singleSelectionButton",MULTIPLE_SELECTION:"multipleSelection",SINGLE_SELECTION_DROPDOWN:"singleSelectionDropdown"})}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){g=angular.copy(v.prefetchedNetworks),d(v.preselectedNetwork),v.preselectedNetwork&&u(v.preselectedNetwork.id),v.selectedNetwork=v.preselectedNetwork}function s(){v.networkSelectorName=e.networkSelectorName?e.networkSelectorName:"selectNetwork",v.objectRef=e.objectRef,v.mode=e.mode,v.filterSpec=e.filterSpec,v.dialogSpec=e.dialogSpec,v.preselectedNetwork=e.preselectedNetwork,v.onSelectedNetworks=e.onSelectedNetworks,v.onPreloadNetworks=e.onPreloadNetworks,v.preloadNetworks=e.preloadNetworks,v.prefetchedNetworks=e.prefetchedNetworks,v.sortParams=e.sortParams,e.isDisabled=!!e.isDisabled,void 0===e.errorConfig&&(e.errorConfig={message:"",isVisible:!1}),v.errorConfig=e.errorConfig}function c(e,t){var i=v.selectedNetwork;if(i.id===m)v.selectedNetwork=t,v.preloadNetworks?v.onPreloadNetworks().then(function(e){v.retrievedNetworks=e,n.openNetworkSelectorDialog(v.objectRef,v.filterSpec,v.dialogSpec,l,v.sortParams,v.retrievedNetworks)}):n.openNetworkSelectorDialog(v.objectRef,v.filterSpec,v.dialogSpec,l,v.sortParams,v.retrievedNetworks);else{var o={name:i.name,networkRef:r.getManagedObjectReference(i.id),dvsUuid:i.dvsUuid,opaqueNetworkType:i.opaqueNetworkType,portgroupKey:i.portgroupKey};v.onSelectedNetworks&&v.onSelectedNetworks({selectedNetworks:[o]}),u(r.getVsphereObjectId(o.networkRef))}}function l(e){var t=e[0],n={name:t.name,id:r.getVsphereObjectId(t.networkRef),dvsUuid:t.dvsUuid,portgroupKey:t.portgroupKey};v.mode===i.SINGLE_SELECTION_DROPDOWN&&(p(n),n.id&&u(n.id)),v.selectedNetwork=n,v.onSelectedNetworks&&v.onSelectedNetworks({selectedNetworks:e})}function d(e){if(e&&e.id){var t=r.getManagedObjectReference(e.id);if(t.type===o.NETWORK||t.type===o.OPAQUE_NETWORK){var i={name:e.name,id:e.id,networkRef:t,dvsUuid:null,opaqueNetworkType:e.opaqueNetworkType};p(i)}}}function u(e){var t=_.filter(g,function(t){return t.id===e}),i=_.filter(g,function(t){return t.id!==e}),r=_.sortBy(i,function(e){return e.name});t.length&&(r=t.concat(r)),v.networkDropdownOptions=r.concat([{name:v.browseButtonLabel,id:m}])}function p(e){_.findIndex(g,function(t){return t.id===e.id})<0&&g.push(e)}var v=this,m="browse-networks-option-id";v.browseButtonLabel=t.getString("Common","NetworkSelectorDropDown.browseEntry");var g=[];v.$onInit=function(){s(),v.selectedNetwork=v.preselectedNetwork,v.mode===i.SINGLE_SELECTION_DROPDOWN&&(v.networkDropdownOptions=[{name:v.browseButtonLabel,id:m}],a(),e.$on("onPrefetchNetworksCompleted",function(){a()}))},v.onSelectorBrowseButtonClicked=function(){n.openNetworkSelectorDialog(v.objectRef,v.filterSpec,v.dialogSpec,l)},v.onSelectNetwork=c}angular.module("com.vmware.vsphere.client.networkLibUi").controller("NetworkSelectorController",e),e.$inject=["$scope","i18nService","NetworkSelectorMode","defaultUriSchemeUtil","networkSelectorDialogService","managedEntityConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e,i,r,a,s,c){var l={title:t.getString("Common","NetworkSelectorDialog.titleSingular"),contentTemplate:"network-lib-ui/resources/network-lib/components/networkselector/networkSelectorDialog.html",alerts:[],defaultButton:"submit"};n.getUserSession().then(function(n){var o={};o.contextObjectId=e,o.networkSelectorFilterSpec=i,o.userSessionClientId=n.clientId,o.sortParams=s,o.retrievedNetworks=c,o.applyToAll=!1,o.isBatchAssignmentRelevant=!1,void 0!==r.isBatchAssignmentRelevant&&(o.isBatchAssignmentRelevant=r.isBatchAssignmentRelevant),o.isBatchAssignmentEnabled=r.isBatchAssignmentEnabled,o.applyToAllLabel=t.getString("Common","NetworkSelectorDialog.applyToAll.label"),o.applyToAllDisabledTitle=t.getString("Common","NetworkSelectorDialog.applyToAll.signPostTitle"),o.applyToAllSingPostMessage=r.applyToAllSingPostMessage,o.applyToAllSignPostIcon=o.isBatchAssignmentEnabled?"info-circle":"exclamation-triangle",l.dialogData=o,l.onSubmit=function(){var e=o.selectedItems;return 0===e.length?(p(t.getString("Common","NetworkSelectorDialog.noNetworksSelectedSingular"),l),!1):d(r,e).then(function(t){return t&&t.length>0?(u(t,l,r.networkSelectorErrorMessages),!1):(a&&a(e,o.applyToAll),!0)})}}),o.openOkCancelModal(l)}function c(e,t,i,r,n){return{_type:"com.vmware.vsphere.client.networkselector.NetworkSelectorFilterSpec",includeStandardNetworks:e,includeOpaqueNetworks:t,includeDistributedPortGroups:i,includeUplinkPortGroups:r,includeOpaqueNetworkTypes:n}}function l(e,t,i){return{privilegesToCheck:e,networkSelectorErrorMessages:{noPrivilegesOnFewNetworksMsg:t,noPrivilegesOnManyNetworksMsg:i}}}function d(t,n){if(!t||!t.privilegesToCheck||0===t.privilegesToCheck.length)return e.when(!0);var o={};_.each(n,function(e){var t=r.getVsphereObjectId(e.networkRef);o[t]=e});var a=_.keys(o),s=t.privilegesToCheck;return i.checkPrivilegesForMultipleObjects(a,s).then(function(e){var t=[];return _.each(e,function(e,i){var r=_.values(e).reduce(function(e,t){return e&&t},!0);r||t.push(o[i])}),t})}function u(e,i,r){var n,o,a=_.pluck(e,"name");a.length<4?(n=a.join(", "),o=t.getString("Common","NetworkSelectorDialog.noPrivileges"),r&&r.noPrivilegesOnFewNetworksMsg&&(o=r.noPrivilegesOnFewNetworksMsg)):(n=a.slice(0,4).join(", "),o=t.getString("Common","NetworkSelectorDialog.noPrivilegesAndMore"),r&&r.noPrivilegesOnManyNetworksMsg&&(o=r.noPrivilegesOnManyNetworksMsg)),p(t.interpolate(o,[n]),i)}function p(e,t){t.alerts=[{text:e,type:a.notifications.type.ERROR}]}return{openNetworkSelectorDialog:s,createNetworkSelectorFilterSpec:c,createNetworkSelectorDialogSpec:l}}angular.module("com.vmware.vsphere.client.networkLibUi").factory("networkSelectorDialogService",e),e.$inject=["$q","i18nService","authorizationService","defaultUriSchemeUtil","userSessionService","clarityModalService","clarityConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(i){var n,c,l=!1,v="network-lib-ui/ctrl/networkSelector/list/",m=angular.toJson(i.networkSelectorFilterSpec),h={targetObjectId:i.contextObjectId,filterSpec:m,webClientSessionId:i.userSessionClientId,sort:i.sortParams||[{field:"name",dir:"asc"}]};i.retrievedNetworks?(i.retrievedNetworks=_.sortBy(i.retrievedNetworks,function(e){return e.name.toLowerCase()}),c=i.retrievedNetworks):c={url:v,params:h,dataType:t.grid.dataType.JSON,method:t.grid.dataMethod.POST,data:"networks",total:"totalMatchedObjectCount"},i.searchTerm="",g="",i.doSearch=function(){h.filterSpec=a(i),i.selectedItems=[],o(i)},i.debouncedRefreshCallback=_.debounce(function(){i.searchTerm!==g&&(i.retrievedNetworks?i.networkSelectorDatagridOptions.data=s(i):(h.filterSpec=a(i),o(i)),i.selectedItems=[])},500),i.networkSelectorDatagridOptions={actionBarOptions:{actions:[]},height:"100%",selectionMode:t.grid.selectionMode.SINGLE,resizable:!0,pageConfig:{displayMode:t.grid.displayMode.VIRTUAL_SCROLLING},columnDefs:[{displayName:e.getString("Common","NetworkSelectorDialog.nameColumnHeader"),field:"name",searchable:!1,template:p()},{displayName:e.getString("Common","NetworkSelectorDialog.dvsNameColumnHeader"),field:"dvsName",sortable:!1,searchable:!1,template:u()}],data:c,selectedItems:[],dataBound:function(t){if(!l){var c=e.getString("Common","filter.label"),u=e.getString("Common","applyFilter.label"),p='<div class="filter-input pull-right"><button class="nav-icon fa fa-filter filter-button" ng-click="doSearch()" aria-label="'+u+'" /></button><input type="text" ng-model="searchTerm" ng-trim="true" ng-change="debouncedRefreshCallback()"placeholder="'+c+'"/></div>',v=r(p)(i),m=d();if(m){var f=m.find(".k-grid-toolbar");f.length>0&&(f.append(v),l=!0)}i.searchTerm="",g="",i.retrievedNetworks?t.sender.dataSource.data=s(i):(h.filterSpec=a(i),o(i)),i.selectedItems=[]}if(t.sender.dataSource.sort()){var S=t.sender.dataSource.sort()[0];(n&&!S||!n&&S||n&&S&&n.dir!==S.dir)&&(i.selectedItems=[]),n=S}}}}function o(e){e.isRefreshInProgress=!0;var t=c();if(t){var i=null;try{i=t._events.progress,delete t._events.progress}catch(r){i=null}t.read().then(function(){e.isRefreshInProgress=!1,null!==i&&(t._events.progress=i)})}}function a(e){return e.searchTerm?(e.networkSelectorFilterSpec.filterText=e.searchTerm,e.networkSelectorFilterSpec.filteredFields=["name","dvsName"]):(e.networkSelectorFilterSpec.filterText=void 0,e.networkSelectorFilterSpec.filteredFields=[]),g=e.searchTerm,angular.toJson(e.networkSelectorFilterSpec)}function s(e){return g=e.searchTerm,e.retrievedNetworks?e.searchTerm?_.filter(e.retrievedNetworks,function(t){return t.name.toLowerCase().indexOf(e.searchTerm.toLowerCase())!==-1||t.dvsName&&t.dvsName.toLowerCase().indexOf(e.searchTerm.toLowerCase())!==-1}):e.retrievedNetworks:[]}function c(){var e=l();return e&&e.dataSource}function l(){var e=d();return e&&e.data("kendoGrid")}function d(){var e=angular.element(".network-select-list .k-grid-content");return e&&e.parent()}function u(){return function(t){return t.dvsName?i.getColumnRenderer("text")(["dvsName"],t,!0):e.getString("Common","NetworkSelectorItem.noData")}}function p(){return function(e){var t="vsphere-icon-virtual-port-group";e.isStandardNetwork?t="vsphere-icon-network":e.isOpaqueNetwork?t="vsphere-icon-cloud-network":e.isUplink&&(t="network-lib-ui-icon-uplink");var r=i.getColumnRenderer("object-link");return r([null,"name",t],e)}}function v(e){e.$watch(function(){return e.networkSelectorDatagridOptions.selectedItems},function(t){e.selectedItems=t})}var m={scope:{contextObjectId:"=",networkSelectorFilterSpec:"=",userSessionClientId:"=",selectedItems:"=",sortParams:"<?",retrievedNetworks:"<?"},templateUrl:"network-lib-ui/resources/network-lib/components/networkselector/NetworkSelectorList.html",replace:!0,link:{pre:n,post:v}},g="";return m}angular.module("com.vmware.vsphere.client.networkLibUi").directive("networkSelectorList",e),e.$inject=["i18nService","vuiConstants","columnRenderersRegistry","$compile"]}(),function(){"use strict";function e(e,t){function i(i,r,n,o,a){function s(e){_.findIndex(c,function(t){return t.id===e.id})<0&&c.push(e)}var c=[],l="networkSelectorFilteredNetworks",d={includeDistributedPortGroups:r.includeDistributedPortGroups,includeStandardNetworks:r.includeStandardNetworks,includeUplinkPortGroups:r.includeUplinkPortGroups,includeOpaqueNetworks:r.includeOpaqueNetworks,includeOpaqueNetworkTypes:r.includeOpaqueNetworkTypes,networks:n,networksCount:o},u={propertyParams:[{propertyName:l,parameterType:"com.vmware.vsphere.client.modules.api.networkselector.NetworkSelectorFilterSpec",parameter:d}]};return a&&a.skipLoadingNotification&&(u.skipLoadingNotification=a.skipLoadingNotification),e.getProperties(i,[l],u).then(function(e){var i=e[l];_.forEach(i.networks,function(e){s({name:e.name,id:t.getVsphereObjectId(e.networkRef),dvsUuid:e.dvsUuid,portgroupKey:e.portgroupKey,opaqueNetworkType:e.opaqueNetworkType})});var r={recentNetworks:c,networkMatchesCount:e[l].totalMatchedObjectCount};return r})}return{prefetchNetworks:i}}angular.module("com.vmware.vsphere.client.networkLibUi").service("networkSelectorPrefetchingService",e),e.$inject=["dataService","defaultUriSchemeUtil"]}(),function(){"use strict";var e={bindings:{networkSelectorName:"<?",objectRef:"=",mode:"=",filterSpec:"=",dialogSpec:"=?",preselectedNetwork:"=?",onSelectedNetworks:"&onSelectedNetworks",prefetchedNetworks:"=?",errorConfig:"<?",sortParams:"<?",isDisabled:"<?"},controller:function(){},template:'<div network-selector                network-selector-name="$ctrl.networkSelectorName"\n               object-ref="$ctrl.objectRef"\n               mode="$ctrl.mode"\n               filter-spec="$ctrl.filterSpec"\n               dialog-spec="$ctrl.dialogSpec"\n               preselected-network="$ctrl.preselectedNetwork"\n               on-selected-networks="$ctrl.onSelectedNetworks(selectedNetworks)"\n               prefetched-networks="$ctrl.prefetchedNetworks"\n               error-config="$ctrl.errorConfig"\n               sort-params="$ctrl.sortParams"\n               is-disabled="$ctrl.isDisabled">'};angular.module("com.vmware.vsphere.client.networkLibUi").component("upgradableNetworkSelector",e)}(),function(){"use strict";function e(e){var t={restrict:"E",templateUrl:"network-lib-ui/resources/network-lib/components/overridableDropdown/overridableDropdown.html",scope:{options:"=",selectedValue:"=",isOverridden:"=",validator:"=?",isAutofocused:"=?",labelledby:"@?",selectName:"@?"},link:{pre:function(t){t.selectName=t.selectName||"selectName",t.validator=t.validator||{message:null,visible:!1},t.i18nService=e},post:function(e,t,i){e.isAutofocused&&t[0].querySelector("input").focus()}}};return t}angular.module("com.vmware.vsphere.client.networkLibUi").directive("overridableDropdown",e),e.$inject=["i18nService"]}();var dvs_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",pnicDevice:"<",registerRefreshCallback:"<"},this.controller=i,this.templateUrl="network-lib-ui/resources/network-lib/components/pnicSettings/physicalAdapterSettingsTemplate.html"}return e}();e.PhysicalAdapterSettingsComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.physicalAdaptersListService=t,this.physicalAdapterDetailsViewService=i,this.loadingData=!1}return e.prototype.$onInit=function(){var e=this;void 0!==this.registerRefreshCallback&&this.registerRefreshCallback(function(){return e.requestData()})},e.prototype.$onChanges=function(){void 0!==this.hostId&&void 0!==this.pnicDevice&&this.requestData()},e.prototype.requestData=function(){var e=this;this.loadingData=!0;var t=this.physicalAdaptersListService.getPhysicalAdapterDetailsItem(this.hostId,this.pnicDevice);this.lastPhysicalAdapterPromise=t,t.then(function(i){e.isResponseForLastRequest(t)&&(e.adapterDetailsData=e.physicalAdapterDetailsViewService.build(i))})["finally"](function(){e.isResponseForLastRequest(t)&&(e.loadingData=!1)})},e.prototype.isResponseForLastRequest=function(e){return e===this.lastPhysicalAdapterPromise},e.$inject=["i18nService","physicalAdaptersListService","physicalAdapterDetailsViewService"],e}();angular.module("com.vmware.vsphere.client.networkLibUi").component("pnicSettings",new t)}(dvs_ui||(dvs_ui={}));var dvs_ui;!function(e){var t=function(){function e(){this.bindings={hostId:"<",vnicDevice:"<",registerRefreshCallback:"<",customizedSettings:"<"},this.controller=i,this.templateUrl="network-lib-ui/resources/network-lib/components/vnicSettings/virtualAdapterSettingsTemplate.html"}return e}();e.VirtualAdapterSettingsComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.networkDetailsViewService=t,this.vmKernelAdapterService=i,this.loadingData=!1}return e.prototype.$onInit=function(){var e=this;void 0!==this.registerRefreshCallback&&this.registerRefreshCallback(function(){return e.requestData()})},e.prototype.$onChanges=function(){void 0!==this.hostId&&void 0!==this.vnicDevice&&this.requestData()},e.prototype.requestData=function(){var e=this;this.loadingData=!0;var t=this.vmKernelAdapterService.getVnicDetailsData(this.hostId,this.vnicDevice);this.lastVmKernelAdapterPromise=t,t.then(function(i){e.lastVmKernelAdapterPromise===t&&(e.propertyViewData=e.networkDetailsViewService.build(i,e.customizedSettings))})["finally"](function(){e.lastVmKernelAdapterPromise===t&&(e.loadingData=!1)})},e.$inject=["i18nService","networkDetailsViewService","vmKernelAdapterService"],e}();angular.module("com.vmware.vsphere.client.networkLibUi").component("vnicSettings",new t)}(dvs_ui||(dvs_ui={}));var network_lib_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.networkUtil=t,this.networkUiConstants=i}return e.prototype.getTrafficShapingErrorMessage=function(e,t){this.validateAttributeName(t);var i=this.networkUiConstants.MAX_SAFE_INTEGER,r=this.networkUtil.isPositiveInteger(e)&&e>0,n=e<=i,o=null;if(n===!1)switch(t){case this.networkUiConstants.TrafficShapingSetting.AVERAGE_BANDWIDTH:o=this.i18nService.getString("H5NetworkUi","VSwitchTrafficShapingPage.averageBandwidth.errorMessage.exceeding",i);break;case this.networkUiConstants.TrafficShapingSetting.PEAK_BANDWIDTH:o=this.i18nService.getString("H5NetworkUi","VSwitchTrafficShapingPage.peakBandwidth.errorMessage.exceeding",i);break;case this.networkUiConstants.TrafficShapingSetting.BURST_SIZE:o=this.i18nService.getString("H5NetworkUi","VSwitchTrafficShapingPage.burstSize.errorMessage.exceeding",i)}else if(r===!1)switch(t){case this.networkUiConstants.TrafficShapingSetting.AVERAGE_BANDWIDTH:o=this.i18nService.getString("H5NetworkUi","VSwitchTrafficShapingPage.averageBandwidth.errorMessage");break;case this.networkUiConstants.TrafficShapingSetting.PEAK_BANDWIDTH:o=this.i18nService.getString("H5NetworkUi","VSwitchTrafficShapingPage.peakBandwidth.errorMessage");break;case this.networkUiConstants.TrafficShapingSetting.BURST_SIZE:o=this.i18nService.getString("H5NetworkUi","VSwitchTrafficShapingPage.burstSize.errorMessage")}return o},e.prototype.validateAttributeName=function(e){if(e!==this.networkUiConstants.TrafficShapingSetting.AVERAGE_BANDWIDTH&&e!==this.networkUiConstants.TrafficShapingSetting.PEAK_BANDWIDTH&&e!==this.networkUiConstants.TrafficShapingSetting.BURST_SIZE)throw new Error("Attribute name must be networkUiConstants.TrafficShapingSetting")},e.$inject=["i18nService","networkUtil","networkUiConstants"],e}();e.TrafficShapingPolicyValidator=t,angular.module("com.vmware.vsphere.client.networkLibUi").service("trafficShapingPolicyValidator",t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(e,i,r){function n(e,t){return a(e,t,!0)}function o(e,t){return a(e,t)}function a(n,o,a){if(!n)return{};var u=o||i.createPropertyViewBuilder(),p=u.category("policies").title(e.getString("NetworkUi","dvpg.manage.settings.policiesHeader"));if(n.security){var v=p.section("security").title(e.getString("NetworkUi","dvpg.policy.security.title")),m=e.getString("NetworkUi","dvpg.policy.security.accept"),g=e.getString("NetworkUi","dvpg.policy.security.reject");v.property(e.getString("NetworkUi","dvpg.policy.security.promiscuousMode"),n.security.allowPromiscuous?m:g),v.property(e.getString("NetworkUi","dvpg.policy.security.macAddressChanges"),n.security.macChanges?m:g),v.property(e.getString("NetworkUi","dvpg.policy.security.forgedTransmits"),n.security.forgedTransmits?m:g)}if(n.inTrafficShaping){var h=p.section("ingressTrafficShaping").title(e.getString("NetworkUi","dvpg.policy.shaping.ingress"));h.property(e.getString("NetworkUi","dvpg.policy.shaping.status"),n.inTrafficShaping.enabled?e.getString("NetworkUi","dvpg.policy.shaping.status.on"):e.getString("NetworkUi","dvpg.policy.shaping.status.off")),h.property(e.getString("NetworkUi","dvpg.policy.shaping.avgBW"),s(n.inTrafficShaping.averageBandwidthSummary)),h.property(e.getString("NetworkUi","dvpg.policy.shaping.peakBW"),s(n.inTrafficShaping.peakBandwidthSummary)),h.property(e.getString("NetworkUi","dvpg.policy.shaping.burstSize"),s(n.inTrafficShaping.burstSizeSummary))}if(n.outTrafficShaping){var f=p.section("egressTrafficShaping").title(e.getString("NetworkUi","dvpg.policy.shaping.egress"));f.property(e.getString("NetworkUi","dvpg.policy.shaping.status"),n.outTrafficShaping.enabled?e.getString("NetworkUi","dvpg.policy.shaping.status.on"):e.getString("NetworkUi","dvpg.policy.shaping.status.off")),f.property(e.getString("NetworkUi","dvpg.policy.shaping.avgBW"),s(n.outTrafficShaping.averageBandwidthSummary)),f.property(e.getString("NetworkUi","dvpg.policy.shaping.peakBW"),s(n.outTrafficShaping.peakBandwidthSummary)),f.property(e.getString("NetworkUi","dvpg.policy.shaping.burstSize"),s(n.outTrafficShaping.burstSizeSummary))}if(n.vlan){var S=p.section("vlan").title(e.getString("NetworkUi","dvpg.policy.vlan.title"));switch(n.vlan.type){case r.Vlan.Type.NONE:S.property(e.getString("NetworkUi","dvpg.policy.vlan.type.label"),e.getString("NetworkUi","dvpg.policy.vlan.type.none"));break;case r.Vlan.Type.VLAN:S.property(e.getString("NetworkUi","dvpg.policy.vlan.type.label"),e.getString("NetworkUi","dvpg.policy.vlan.type.vlan")),S.property(e.getString("NetworkUi","dvpg.policy.vlan.id.label"),n.vlan.value);break;case r.Vlan.Type.TRUNK:S.property(e.getString("NetworkUi","dvpg.policy.vlan.type.label"),e.getString("NetworkUi","dvpg.policy.vlan.type.trunk")),S.property(e.getString("NetworkUi","dvpg.policy.vlan.trunk.label"),n.vlan.value);break;case r.Vlan.Type.PRIVATE:S.property(e.getString("NetworkUi","dvpg.policy.vlan.type.label"),e.getString("NetworkUi","dvpg.policy.vlan.type.private")),S.property(e.getString("NetworkUi","dvpg.policy.vlan.private.label"),n.vlan.value)}}if(n.basicLacpAvailable){var y=p.section("lacp").title(e.getString("NetworkUi","dvpg.policy.lacp.title"));n.lacp.enable?(y.property(e.getString("NetworkUi","dvpg.policy.lacp.status.label"),e.getString("NetworkUi","dvpg.policy.lacp.status.enabled")),y.property(e.getString("NetworkUi","dvpg.policy.lacp.status.mode"),n.lacp.mode===r.LacpMode.ACTIVE?e.getString("NetworkUi","dvpg.policy.lacp.status.active"):e.getString("NetworkUi","dvpg.policy.lacp.status.passive"))):y.property(e.getString("NetworkUi","dvpg.policy.lacp.status.label"),e.getString("NetworkUi","dvpg.policy.lacp.status.disabled"))}if(n.teamingAndFailover){var P=n.teamingAndFailover,C=p.section("teaming").title(e.getString("NetworkUi","dvpg.policy.failover.title"));if(C.property(e.getString("NetworkUi","dvpg.policy.failover.lb.label"),d(P.loadBalancing)),P.loadBalancing===t){var D=l(P);D&&C.warning(D),c().forEach(function(e){C.info(e)})}C.property(e.getString("NetworkUi","dvpg.policy.failover.detection.label"),P.failureDetection?e.getString("NetworkUi","dvpg.policy.failover.detection.beaconProbing"):e.getString("NetworkUi","dvpg.policy.failover.detection.linkStatus")),C.property(e.getString("NetworkUi","dvpg.policy.failover.notify.label"),P.notifySwitches?e.getString("NetworkUi","dvpg.policy.failover.notify.on"):e.getString("NetworkUi","dvpg.policy.failover.notify.off")),C.property(e.getString("NetworkUi","dvpg.policy.failover.failback.label"),P.failback?e.getString("NetworkUi","dvpg.policy.failover.failback.on"):e.getString("NetworkUi","dvpg.policy.failover.failback.off")),C.property(e.getString("NetworkUi","dvpg.policy.failover.order.active.label"),s(P.activeAdapters.join(", "))),C.property(e.getString("NetworkUi","dvpg.policy.failover.order.standby.label"),s(P.standByAdapters.join(", "))),C.property(e.getString("NetworkUi","dvpg.policy.failover.order.unused.label"),s(P.unusedAdapters.join(", ")))}if(null!==n.monitoring&&"undefined"!=typeof n.monitoring){var w=p.section("monitoring").title(e.getString("NetworkUi","dvpg.policy.monitoring.title"));w.property(e.getString("NetworkUi","dvpg.policy.monitoring.status.label"),n.monitoring?e.getString("NetworkUi","dvpg.policy.monitoring.status.on"):e.getString("NetworkUi","dvpg.policy.monitoring.status.off"))}if(null!==n.blocked&&"undefined"!=typeof n.blocked){var b=p.section("miscellaneous").title(e.getString("NetworkUi","dvpg.policy.misc.title"));b.property(a?e.getString("NetworkUi","port.policy.misc.block.label"):e.getString("NetworkUi","dvpg.policy.misc.block.label"),n.blocked?e.getString("NetworkUi","dvpg.policy.misc.block.on"):e.getString("NetworkUi","dvpg.policy.misc.block.off"))}return o?void 0:u.build()}function s(t){return t?t:e.getString("NetworkUi","VnicPortPropertiesView.noData")}function c(){return[e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.info.etherChannel"),e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.info.portGroupPolicies")]}function l(t){return 0!==t.standByAdapters.length&&t.failureDetection?e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbingAndStandbyUplinks"):0!==t.standByAdapters.length?e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.standbyUplinks"):t.failureDetection?e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbing"):null}function d(t){switch(t){case r.LoadBalancingPolicy.SRCID:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_srcid");case r.LoadBalancingPolicy.IP:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_ip");case r.LoadBalancingPolicy.SRCMAC:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_srcmac");case r.LoadBalancingPolicy.EXPLICIT:return e.getString("NetworkUi","PortFailoverPolicyView.failover_explicit");case r.LoadBalancingPolicy.LOADBASED:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_loadbased");default:return e.getString("NetworkUi","VnicPortPropertiesView.noData")}}return{build:o,buildDistributedPortPoliciesView:n}}angular.module("com.vmware.vsphere.client.networkLibUi").service("distributedPortgroupPoliciesViewService",e),e.$inject=["i18nService","vxPropertyViewService","networkUiConstants"];var t="loadbalance_ip"}();var network_lib_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.dataService=e,this.i18nService=t,this.$q=i,this.networkUiConstants=r,this.vxPropertyViewService=n,this.i18n=this.i18nService.getString}return e.prototype.requestDvPortgroupPropertiesAndPolicy=function(t,i){return t&&i?this.dataService.getProperties(t,[e.DVPG_PROPERTIES_AND_POLICY],{propertyParams:[{propertyName:e.DVPG_PROPERTIES_AND_POLICY,parameterType:"java.lang.String",parameter:i}]}).then(function(t){return t&&t[e.DVPG_PROPERTIES_AND_POLICY]}):this.$q.when(null)},e.prototype.buildProperties=function(e){var t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("general");
return this.addPropertiesToSection(e,i),t.build()},e.prototype.addPropertiesToSection=function(e,t){var i=t.section("generalSection").title(this.i18n("NetworkUi","dvpg.properties.general"));i.property(this.i18n("NetworkUi","dvpg.properties.name.label"),e.name),e.description&&i.property(this.i18n("NetworkUi","dvpg.properties.description.label"),e.description),i.property(this.i18n("NetworkUi","dvpg.properties.portBinding.label"),this.getPortBindingText(e.portBinding)),null!==e.portAllocation&&"undefined"!=typeof e.portAllocation&&i.property(this.i18n("NetworkUi","dvpg.properties.portAllocation.label"),e.portAllocation?this.i18n("NetworkUi","dvpg.properties.portAllocation.autoExpand.true"):this.i18n("NetworkUi","dvpg.properties.portAllocation.autoExpand.false")),i.property(this.i18n("NetworkUi","dvpg.properties.numberOfPorts.label"),e.numberOfPorts),e.vmVnicResourcePoolName&&i.property(this.i18n("NetworkUi","dvpg.properties.vmVnicResPool.label"),e.vmVnicResourcePoolName);var r=t.section("advancedSection").title(this.i18n("NetworkUi","dvpg.properties.advanced"));r.property(this.i18n("NetworkUi","dvpg.properties.resetAtDisconnect.label"),e.portConfigResetAtDisconnect?this.i18n("NetworkUi","dvpg.properties.resetAtDisconnect.on"):this.i18n("NetworkUi","dvpg.properties.resetAtDisconnect.off"));var n=t.section("overridePortPoliciesSection").title(this.i18n("NetworkUi","dvpg.policy.override.label")),o=this.i18n("NetworkUi","dvpg.policy.override.on"),a=this.i18n("NetworkUi","dvpg.policy.override.off");n.property(this.i18n("NetworkUi","dvpg.policy.override.blockPorts"),e.blockOverrideAllowed?o:a),null!==e.shapingOverrideAllowed&&"undefined"!=typeof e.shapingOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.trafficShaping"),e.shapingOverrideAllowed?o:a),n.property(this.i18n("NetworkUi","dvpg.policy.override.vendorConfig"),e.vendorConfigOverrideAllowed?o:a),null!==e.vlanOverrideAllowed&&"undefined"!=typeof e.vlanOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.vlan"),e.vlanOverrideAllowed?o:a),null!==e.uplinkTeamingOverrideAllowed&&"undefined"!=typeof e.uplinkTeamingOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.teaming"),e.uplinkTeamingOverrideAllowed?o:a),null!==e.networkResourcePoolOverrideAllowed&&"undefined"!=typeof e.networkResourcePoolOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.iorm"),e.networkResourcePoolOverrideAllowed?o:a),null!==e.securityPolicyOverrideAllowed&&"undefined"!=typeof e.securityPolicyOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.security"),e.securityPolicyOverrideAllowed?o:a),null!==e.ipfixOverrideAllowed&&"undefined"!=typeof e.ipfixOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.monitoring"),e.ipfixOverrideAllowed?o:a),null!==e.trafficFilterOverrideAllowed&&"undefined"!=typeof e.trafficFilterOverrideAllowed&&n.property(this.i18n("NetworkUi","dvpg.policy.override.trafficFilteringConfig"),e.trafficFilterOverrideAllowed?o:a)},e.prototype.getPortBindingText=function(e){switch(e){case this.networkUiConstants.PortgroupType.EARLY_BINDING:return this.i18n("NetworkUi","dvpg.properties.portBinding.earlyBinding");case this.networkUiConstants.PortgroupType.LATE_BINDING:return this.i18n("NetworkUi","dvpg.properties.portBinding.lateBinding");case this.networkUiConstants.PortgroupType.EPHEMERAL:return this.i18n("NetworkUi","dvpg.properties.portBinding.ephemeral");default:return e}},e.DVPG_PROPERTIES_AND_POLICY="dvpg:dvPortgroupPropertiesAndPolicy",e.$inject=["dataService","i18nService","$q","networkUiConstants","vxPropertyViewService"],e}();e.DvPortgroupPropertiesService=t,angular.module("com.vmware.vsphere.client.networkLibUi").service("dvPortgroupPropertiesService",t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(e,t){var i={restrict:"E",template:'<div class="fill-parent no-column-header assigned-adapters-datagrid failover-order" vx-stretch-grid vui-datagrid="datagridOptions" vx-datagrid-preselect-item="true" reselect-on-change="true" preselect-comparator="preselectComparator"></div>',scope:{failoverOrder:"=",onSelectionChange:"=?",actions:"=?",actionsDisabled:"=?",selectionMode:"=?",editAllItems:"=?"},replace:!1,link:{pre:function(i){var r=new t(i.failoverOrder,i.actions,i.selectionMode,i.editAllItems,i.actionsDisabled);i.datagridOptions=r.datagridOptions,i.preselectComparator=r.preselectComparator,i.$watch(function(){return i.datagridOptions.selectedItems},function(e){var t=r.selectionChanged(e);t&&i.onSelectionChange&&i.onSelectionChange(e)}),i.$watch("actionsDisabled",function(){r.enableDisableAllActions(i.datagridOptions.selectedItems,i.actionsDisabled)}),e(function(){var e=$("div.assigned-adapters-datagrid .k-grid");if(e){var t=e.data("kendoGrid");t&&t.resize()}},0)}}};return i}angular.module("com.vmware.vsphere.client.networkLibUi").directive("failoverOrder",e),e.$inject=["$timeout","FailoverOrderDatagridManager"]}(),function(){"use strict";function e(e,t,i,r,n){var o=["active","standby","unused"],a=n.failoverOrderActions.ADD,s=n.failoverOrderActions.REMOVE,c=n.failoverOrderActions.MOVE_UP,l=n.failoverOrderActions.MOVE_DOWN;return function(n,d,u,p,v){function m(e){return(0===j.length||j.length===e.length)&&(j=[],h(e))}function g(e,t){B=t,h(e)}function h(t){return _.forEach(Y.actionBarOptions.actions,function(i){if(i!==e.actions.SEPARATOR){if(B)return void(i.enabled=!1);if(!t||0===t.length)return void(i.enabled=i.id===a);switch(i.id){case a:i.enabled=!0;break;case s:i.enabled=C(t);break;case c:i.enabled=G&&!y(t,G.active)&&S(t);break;case l:i.enabled=G&&!P(t,G.unused)&&S(t)}}}),!0}function f(e){return _.some(j,function(t){if(t.value===e.value)return!0})}function S(e){return _.some(e,function(e){return!e.categoryItem})}function y(e,t){var i=_.some(e,function(e){return e.value===t[0]});return e&&e.length>0&&t&&t.length>0&&i}function P(e,t){var i=_.some(e,function(e){return e.value===t[t.length-1]});return e&&e.length>0&&t&&t.length>0&&i}function C(e){var t;if(p){var i=_.some(e,function(e){return!e.categoryItem});t=!!e&&i}else{var r=_.some(e,function(e){return H(e.value)}),n=_.every(e,function(e){return e.categoryItem||H(e.value)});t=!!e&&r&&n}return t}function D(t){var i={columnDefs:$(),data:I(),pageConfig:{hidePager:!0},selectedItems:[],resizable:!0,height:"100%",sortMode:e.grid.sortMode.NONE,selectionMode:e.grid.selectionMode.MULTI,showCheckboxesOnMultiSelection:!1,actionBarOptions:{actions:E()}};return t&&(i.selectionMode=t),i}function w(e){var t={};return _.forEach(e,function(e,i){t[i]={categoryItem:!0,value:e}}),t}function b(e){return _.map(e,function(e){return{value:e}})}function I(){var e=[],t=w(n.labels);return _.forEach(t,function(i,r){e.push(t[r]),G&&G[r]&&(e=e.concat(b(G[r])))}),e}function T(e){var t=_.filter(Y.selectedItems,function(e){return!e.categoryItem});j=e?e:t,Y.data=I()}function E(){return d?_.filter(W,function(e){return _.indexOf(d,e.id)!==-1}):W}function V(){if(G.unclaimed&&G.unclaimed.length>0)r.createPnicSelectorDialog(G.unclaimed,n.connecteesDetails,e.grid.selectionMode.MULTI,null,M);else{var o={message:t.getString("NetworkUi","FailoverOrderEditor.noFreeNics"),title:t.getString("H5NetworkUi","failoverOrder.notification.warning"),icon:"vx-icon-warning-32x32",hideCancelButton:!0,preserveNewlines:!0,submit:function(){}};i.openConfirmationModal(o)}}function M(e){var t=[];_.forEach(e,function(e){var i=_.indexOf(G.unclaimed,e);G.unclaimed.splice(i,1),G.active.push(e),t.push({value:e})}),T(t)}function O(){_.each(Y.selectedItems,function(e){_.some(o,function(t){return A(t,e)})}),Y.selectedItems.splice(0),T()}function A(e,t){var i=G[e],r=_.indexOf(i,t.value);return r!==-1&&(i.splice(r,1),G.unclaimed.push(t.value),G.unclaimed.sort()),r!==-1}function k(){_.forEach(Y.selectedItems,function(e){if(!e.categoryItem){var t=L(o,e),i=F(G[t],e);R(e,i,t)}}),T()}function R(e,t,i){if(0===t){var r=o[_.indexOf(o,i)-1];G[r].push(e.value),G[i]=G[i].slice(1,G[i].length)}else x(i,t,t-1)}function N(){for(var e=Y.selectedItems.length-1;e>=0;e--){var t=Y.selectedItems[e],i=L(o,t),r=F(G[i],t);r!==-1&&U(t,r,i)}T()}function U(e,t,i){var r=G.unused;if(!(r&&r.length>0&&e.value===r[r.length-1]))if(t===G[i].length-1){var n=o[_.indexOf(o,i)+1];G[n].unshift(e.value),G[i]=G[i].slice(0,G[i].length-1)}else x(i,t,t+1)}function L(e,t){var i;return _.each(e,function(e){var r=_.findIndex(G[e],function(e){return e===t.value});r!==-1&&(i=e)}),i}function F(e,t){return _.findIndex(e,function(e){return e===t.value})}function x(e,t,i){var r=G[e][t];G[e][t]=G[e][i],G[e][i]=r}function $(){return[{field:"value",width:"150px",template:function(e){return e.categoryItem?'<span class="assigned-pnic-sections">'+e.value+"</span>":G.lagNames&&G.lagNames.length>0?_.indexOf(G.lagNames,e.value)===-1?'<span class="network-lib-ui-icon-physicalAdapter"></span><span ng-non-bindable>'+z(e)+"</span>":'<span class="network-lib-ui-icon-portChannel"></span><span ng-non-bindable>'+z(e)+"</span>":'<span class="network-lib-ui-icon-physicalAdapter"></span><span ng-non-bindable>'+z(e)+"</span>"}}]}function z(e){return!p&&H(e.value)?t.getString("NetworkUi","FailoverOrder.newNicFormat",e.value):e.value}function H(e){return _.contains(G.unclaimedInitial,e)}p=p||!1;var B=v,G=n.connectees;n.connectees&&(n.connectees.unclaimedInitial||(n.connectees.unclaimedInitial=_.extend([],n.connectees.unclaimed)));var j=[],W=[{id:a,enabled:!v,iconClass:"network-lib-ui-icon-add",tooltipText:t.getString("NetworkUi","FailoverOrder.add"),onClick:V},e.actions.SEPARATOR,{id:s,enabled:!1,iconClass:"vx-icon-removeIcon",tooltipText:t.getString("NetworkUi","FailoverOrder.remove"),onClick:O},{id:c,enabled:!1,iconClass:"vx-icon-moveUp",tooltipText:t.getString("NetworkUi","FailoverOrder.moveUp"),onClick:k},{id:l,enabled:!1,iconClass:"vx-icon-moveDown",tooltipText:t.getString("NetworkUi","FailoverOrder.moveDown"),onClick:N}],Y=D(u);return{datagridOptions:Y,selectionChanged:m,preselectComparator:f,enableDisableAllActions:g}}}angular.module("com.vmware.vsphere.client.networkLibUi").factory("FailoverOrderDatagridManager",e),e.$inject=["vuiConstants","i18nService","clarityModalService","pnicSelectorDialogService","networkUiConstants"]}(),function(){"use strict";function e(e){var t={restrict:"E",templateUrl:"network-lib-ui/resources/network-lib/host/pnic/failoverOrder/failoverOrderWithDetails.html",scope:{failoverOrder:"=",noItemsSelectedMessage:"=",datagridHeaderOptions:"=?",actions:"=?",actionsDisabled:"=?",onSelectionChange:"=?",selectionMode:"=?",editAllItems:"=?"},replace:!0,link:{pre:function(t){t.showDetailsAndNotify=function(i){i&&1===i.length&&!i[0].categoryItem?t.selectedConnecteeDetails=e.build(t.failoverOrder.connecteesDetails[i[0].value]):t.selectedConnecteeDetails=null,t.onSelectionChange&&t.onSelectionChange(i)}}}};return t}angular.module("com.vmware.vsphere.client.networkLibUi").directive("failoverOrderWithDetails",e),e.$inject=["physicalAdapterDetailsViewService"]}();var network_lib_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.propertyViewService=t,this.networkUtil=i,this.numberFormatterService=r}return e.prototype.build=function(e){if(null!==e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildPropertiesCategoryInternal(t,e),this.buildCdpCategoryInternal(t,e),this.buildLldpCategoryInternal(t,e),t.category("all",0).title(this.i18nService.getString("H5NetworkUi","PhysicalAdapterDetailsView.allTabTitle")).cloneAndAddBuilder(t.getSection("properties","general")).cloneAndAddBuilder(t.getSection("properties","status")).cloneAndAddBuilder(t.getSection("properties","networkIoControl")).cloneAndAddBuilder(t.getSection("properties","sriov")).cloneAndAddBuilder(t.getSection("cdp","cdpSection")).cloneAndAddBuilder(t.getSection("cdp","cdpCapabilitySection")).cloneAndAddBuilder(t.getSection("lldp","lldpSection")).cloneAndAddBuilder(t.getSection("lldp","lldpCapabilitySection")),t.build()}return{}},e.prototype.buildOnlyProperties=function(e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildPropertiesCategoryInternal(t,e),t.getCategory("properties").title(null),t.build()},e.prototype.buildOnlyCdp=function(e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildCdpCategoryInternal(t,e),t.getCategory("cdp").title(null),t.build()},e.prototype.buildOnlyLldp=function(e){var t=this.propertyViewService.createPropertyViewBuilder();return this.buildLldpCategoryInternal(t,e),t.getCategory("lldp").title(null),t.build()},e.prototype.buildPropertiesCategoryInternal=function(e,t){var i=e.category("properties").title(this.networkUtil.getString("PnicView.adapterDetails"));this.buildGeneralSection(i,t),this.buildStatusSection(i,t),this.buildSriovSection(i,t)},e.prototype.buildGeneralSection=function(e,t){e.section("general").property(this.networkUtil.getString("PnicView.adapter"),t.adapterName).property(this.networkUtil.getString("PnicView.name"),t.deviceName).property(this.networkUtil.getString("PnicView.location"),t.location).property(this.networkUtil.getString("PnicView.driver"),t.driverName)},e.prototype.buildStatusSection=function(e,t){if(e.section("status").title(this.networkUtil.getString("PnicView.status")).property(this.networkUtil.getString("PnicView.statusLabel"),t.isConnected?this.networkUtil.getString("PnicView.connected"):this.networkUtil.getString("PnicView.disconnected")).property(this.networkUtil.getString("PnicView.actualSpeed"),this.getPnicActualSpeedValue(t)).property(this.networkUtil.getString("PnicView.configSpeed"),this.getConfiguredSpeedValue(t)).property(this.networkUtil.getString("PnicView.networks"),this.getNetworks(t)),null!==t.resourcePoolSchedulerAllowed){var i=e.section("networkIoControl").title(this.networkUtil.getString("PnicView.netIorm"));i.property(this.networkUtil.getString("PnicView.status"),t.resourcePoolSchedulerAllowed?this.networkUtil.getString("PnicView.netIorm.allowed"):this.networkUtil.getString("PnicView.netIorm.notAllowed")),_.forEach(t.resourcePoolSchedulerDisallowedReasons,function(e){i.info(e)})}},e.prototype.getPnicActualSpeedValue=function(e){var t;return t=e.actualSpeed?e.isActualSpeedFullDuplex?this.networkUtil.getString("PnicView.fullDuplex",this.numberFormatterService.formatBandwidth(e.actualSpeed,i.MBITPS,i.AUTO)):this.networkUtil.getString("PnicView.halfDuplex",this.numberFormatterService.formatBandwidth(e.actualSpeed,i.MBITPS,i.AUTO)):this.networkUtil.getString("PnicView.down")},e.prototype.getConfiguredSpeedValue=function(e){var t;return t=e.configuredSpeed?e.isConfiguredSpeedFullDuplex?this.networkUtil.getString("PnicView.fullDuplex",this.numberFormatterService.formatBandwidth(e.configuredSpeed,i.MBITPS,i.AUTO)):this.networkUtil.getString("PnicView.halfDuplex",this.numberFormatterService.formatBandwidth(e.configuredSpeed,i.MBITPS,i.AUTO)):this.networkUtil.getString("PnicView.autonegotiate")},e.prototype.getNetworks=function(e){return e.networkHints&&e.networkHints.length?e.networkHints:this.networkUtil.getString("NetworkUtil.NoNetworks")},e.prototype.buildSriovSection=function(e,t){t.sriovInfo&&t.sriovInfo.sriovCapable?t.sriovInfo.sriovEnabled?e.section("sriov").title(this.networkUtil.getString("Sriov.title")).property(this.networkUtil.getString("Sriov.status"),this.networkUtil.getString("Sriov.status.enabled")).property(this.networkUtil.getString("Sriov.virtualFunctionsCount"),this.getVirtualFunctions(t)):e.section("sriov").title(this.networkUtil.getString("Sriov.title")).property(this.networkUtil.getString("Sriov.status"),this.networkUtil.getString("Sriov.status.disabled")):e.section("sriov").title(this.networkUtil.getString("Sriov.title")).property(this.networkUtil.getString("Sriov.status"),this.networkUtil.getString("Sriov.status.notSupported"))},e.prototype.getVirtualFunctions=function(e){return e.sriovInfo.numVirtualFunctionsRequested===e.sriovInfo.numVirtualFunction?e.sriovInfo.numVirtualFunction:this.networkUtil.getString("Sriov.vf.mixedFormat",e.sriovInfo.numVirtualFunctionsRequested,e.sriovInfo.numVirtualFunction)},e.prototype.buildCdpCategoryInternal=function(e,t){var i=e.category("cdp").title(this.networkUtil.getString("CdpDetailsView.category")),r=i.section("cdpSection").title(this.networkUtil.getString("CdpDetailsView.title"));if(t.areNetworkHintsRetrieved)if(null===t.cdpInfo)r.info(this.networkUtil.getString("CdpDetailsView.notAvailable"));else{r.property(this.networkUtil.getString("CdpDetailsView.version"),t.cdpInfo.version),r.property(this.networkUtil.getString("CdpDetailsView.timeout"),t.cdpInfo.timeout),r.property(this.networkUtil.getString("CdpDetailsView.ttl"),t.cdpInfo.ttl),r.property(this.networkUtil.getString("CdpDetailsView.samples"),t.cdpInfo.samples),r.property(this.networkUtil.getString("CdpDetailsView.deviceId"),t.cdpInfo.devId),r.property(this.networkUtil.getString("CdpDetailsView.ipAddress"),t.cdpInfo.address),r.property(this.networkUtil.getString("CdpDetailsView.portId"),t.cdpInfo.portId),r.property(this.networkUtil.getString("CdpDetailsView.softwareVersion"),t.cdpInfo.softwareVersion),r.property(this.networkUtil.getString("CdpDetailsView.hardwarePlatform"),t.cdpInfo.hardwarePlatform),r.property(this.networkUtil.getString("CdpDetailsView.ipPrefix"),t.cdpInfo.ipPrefix),r.property(this.networkUtil.getString("CdpDetailsView.ipPrefixLength"),t.cdpInfo.ipPrefixLen),r.property(this.networkUtil.getString("CdpDetailsView.vlan"),t.cdpInfo.vlan),r.property(this.networkUtil.getString("CdpDetailsView.fullDuplex"),t.cdpInfo.fullDuplex),r.property(this.networkUtil.getString("CdpDetailsView.mtu"),t.cdpInfo.mtu),r.property(this.networkUtil.getString("CdpDetailsView.systemName"),t.cdpInfo.systemName),r.property(this.networkUtil.getString("CdpDetailsView.systemOid"),t.cdpInfo.systemOID),r.property(this.networkUtil.getString("CdpDetailsView.managementAddress"),t.cdpInfo.mgmtAddr),r.property(this.networkUtil.getString("CdpDetailsView.location"),t.cdpInfo.location);var n=i.section("cdpCapabilitySection").title(this.networkUtil.getString("CdpDetailsView.deviceCapability"));n.property(this.networkUtil.getString("CdpDetailsView.router"),t.cdpInfo.deviceCapabilities.router),n.property(this.networkUtil.getString("CdpDetailsView.transBridge"),t.cdpInfo.deviceCapabilities.transparentBridge),n.property(this.networkUtil.getString("CdpDetailsView.srcRouteBridge"),t.cdpInfo.deviceCapabilities.sourceRouteBridge),n.property(this.networkUtil.getString("CdpDetailsView.networkSwitch"),t.cdpInfo.deviceCapabilities.networkSwitch),n.property(this.networkUtil.getString("CdpDetailsView.host"),t.cdpInfo.deviceCapabilities.host),n.property(this.networkUtil.getString("CdpDetailsView.igmp"),t.cdpInfo.deviceCapabilities.igmpEnabled),n.property(this.networkUtil.getString("CdpDetailsView.repeater"),t.cdpInfo.deviceCapabilities.repeater)}else r.info(this.networkUtil.getString("CdpDetailsView.notAccessible"))},e.prototype.buildLldpCategoryInternal=function(e,t){var i=e.category("lldp").title(this.networkUtil.getString("LldpDetailsView.category")),r=i.section("lldpSection").title(this.networkUtil.getString("LldpDetailsView.title"));if(t.areNetworkHintsRetrieved)if(null===t.lldpInfo)r.info(this.networkUtil.getString("LldpDetailsView.notAvailable"));else{r.property(this.networkUtil.getString("LldpDetailsView.chassisId"),t.lldpInfo.chassisId),r.property(this.networkUtil.getString("LldpDetailsView.portId"),t.lldpInfo.portId),r.property(this.networkUtil.getString("LldpDetailsView.ttl"),t.lldpInfo.ttl),_.forEach(t.lldpInfo.parameter,function(e){r.property(e.key,e.value)});var n=i.section("lldpCapabilitySection").title(this.networkUtil.getString("LldpDetailsView.deviceCapability"));n.property(this.networkUtil.getString("LldpDetailsView.router"),t.lldpInfo.deviceCapabilities.router),n.property(this.networkUtil.getString("LldpDetailsView.transBridge"),t.lldpInfo.deviceCapabilities.transparentBridge),n.property(this.networkUtil.getString("LldpDetailsView.srcRouteBridge"),t.lldpInfo.deviceCapabilities.sourceRouteBridge),n.property(this.networkUtil.getString("LldpDetailsView.networkSwitch"),t.lldpInfo.deviceCapabilities.networkSwitch),n.property(this.networkUtil.getString("LldpDetailsView.host"),t.lldpInfo.deviceCapabilities.host),n.property(this.networkUtil.getString("LldpDetailsView.igmp"),t.lldpInfo.deviceCapabilities.igmpEnabled),n.property(this.networkUtil.getString("LldpDetailsView.repeater"),t.lldpInfo.deviceCapabilities.repeater)}else r.info(this.networkUtil.getString("LldpDetailsView.notAccessible"))},e.$inject=["i18nService","vxPropertyViewService","networkUtil","numberFormatterService"],e}();e.PhysicalAdapterDetailsViewService=t;var i;!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.networkLibUi").service("physicalAdapterDetailsViewService",t)}(network_lib_ui||(network_lib_ui={}));var network_lib_ui;!function(e){var t=function(){function e(e,t,i){this.dataService=e,this.i18nService=t,this.numberFormatterService=i}return e.prototype.getPhysicalAdapterItems=function(t){var r=this;return this.dataService.getProperties(t,[e.PHYSICAL_ADAPTER_ITEMS_PROPERTY],{skipErrorInterceptor:!0}).then(function(t){var n=t?t[e.PHYSICAL_ADAPTER_ITEMS_PROPERTY]:[];n=n||[];var o=0;return n.forEach(function(e){e.virtualSwitch||(e.virtualSwitch={switchName:r.i18nService.getString("NetworkUi","NetworkUtil.noData")}),e.wakeOnLanSupportedLabel=e.wakeOnLanSupported?r.i18nService.getString("NetworkUi","PnicView.labelYes"):r.i18nService.getString("NetworkUi","PnicView.labelNo"),e.actualSpeedLabel=e.actualSpeed?r.numberFormatterService.formatBandwidth(e.actualSpeed,i.MBITPS,i.AUTO):r.i18nService.getString("NetworkUi","PnicView.down"),e.configuredSpeedLabel=e.configuredSpeed&&0!==e.configuredSpeed?r.numberFormatterService.formatBandwidth(e.configuredSpeed,i.MBITPS,i.AUTO):r.i18nService.getString("NetworkUi","PnicView.autonegotiate"),e.sriovInfo&&e.sriovInfo.sriovCapable?e.sriovInfo.sriovEnabled?(e.sriovStatusLabel=r.i18nService.getString("NetworkUi","Sriov.status.enabled"),e.sriovNumVirtuanFunctionsLabel=e.sriovInfo.numVirtualFunctionsRequested===e.sriovInfo.numVirtualFunction?e.sriovInfo.numVirtualFunction:r.i18nService.getString("NetworkUi","Sriov.vf.mixedFormat",e.sriovInfo.numVirtualFunctionsRequested,e.sriovInfo.numVirtualFunction)):(e.sriovStatusLabel=r.i18nService.getString("NetworkUi","Sriov.status.disabled"),e.sriovNumVirtuanFunctionsLabel=r.i18nService.getString("NetworkUi","Sriov.vf.na")):(e.sriovStatusLabel=r.i18nService.getString("NetworkUi","Sriov.status.notSupported"),e.sriovNumVirtuanFunctionsLabel=r.i18nService.getString("NetworkUi","Sriov.vf.na")),e.pnicIndex=o++}),n})},e.prototype.getPhysicalAdapterDetailsItem=function(t,i){var r=[{propertyName:e.PHYSICAL_ADAPTER_ITEM_DETAILS_PROPERTY,parameterType:"java.lang.String",parameter:i}];return this.dataService.getProperties(t,[e.PHYSICAL_ADAPTER_ITEM_DETAILS_PROPERTY],{propertyParams:r}).then(function(t){return t&&t[e.PHYSICAL_ADAPTER_ITEM_DETAILS_PROPERTY]?t[e.PHYSICAL_ADAPTER_ITEM_DETAILS_PROPERTY]:null})},e.prototype.getUnclaimedPhysicalAdapters=function(t){return this.dataService.getProperties(t,[e.UNCLAIMED_PHYSICAL_ADAPTERS_PROPERTY]).then(function(t){return t&&t[e.UNCLAIMED_PHYSICAL_ADAPTERS_PROPERTY]?t[e.UNCLAIMED_PHYSICAL_ADAPTERS_PROPERTY]:null})},e.prototype.getPhysicalAdaptersWithDetails=function(t,i){var r=[{propertyName:e.PHYSICAL_ADAPTERS_WITH_DETAILS_PROPERTY,parameterType:"java.lang.String",parameter:i}];return this.dataService.getProperties(t,[e.PHYSICAL_ADAPTERS_WITH_DETAILS_PROPERTY],{propertyParams:r}).then(function(t){return t&&t[e.PHYSICAL_ADAPTERS_WITH_DETAILS_PROPERTY]?t[e.PHYSICAL_ADAPTERS_WITH_DETAILS_PROPERTY]:null})},e.prototype.getProxySwitchUplinkData=function(t,i,r){var n={dvsRef:i,proxySwitchKey:r},o=[{propertyName:e.PROXY_SWITCH_UPLINK_DATA_PROPERTY,parameterType:"com.vmware.vsphere.client.h5.network.host.proxyswitch.spec.ProxySwitchInfoSpec",parameter:n}];return this.dataService.getProperties(t,[e.PROXY_SWITCH_UPLINK_DATA_PROPERTY],{propertyParams:o}).then(function(t){return t&&t[e.PROXY_SWITCH_UPLINK_DATA_PROPERTY]?t[e.PROXY_SWITCH_UPLINK_DATA_PROPERTY]:null})},e.$inject=["dataService","i18nService","numberFormatterService"],e.PHYSICAL_ADAPTER_ITEMS_PROPERTY="pnic:physicalAdapterItems",e.PHYSICAL_ADAPTER_ITEM_DETAILS_PROPERTY="pnic:physicalAdapterItemDetails",e.UNCLAIMED_PHYSICAL_ADAPTERS_PROPERTY="pnic:unclaimedPhysicalAdapters",e.PHYSICAL_ADAPTERS_WITH_DETAILS_PROPERTY="pnic:physicalAdaptersWithDetails",e.PROXY_SWITCH_UPLINK_DATA_PROPERTY="proxyswitch:getProxySwitchUplinkData",e}();e.PhysicalAdaptersListService=t;var i;!function(e){e[e.BITPS=0]="BITPS",e[e.KBITPS=1]="KBITPS",e[e.MBITPS=2]="MBITPS",e[e.GBITPS=3]="GBITPS",e[e.TBITPS=4]="TBITPS",e[e.AUTO=5]="AUTO"}(i||(i={})),angular.module("com.vmware.vsphere.client.networkLibUi").service("physicalAdaptersListService",t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(e,t,i,r){function n(r,n,a,s,c){var l={};l.hasDropdownOptions=s&&s.length>0,l.dropdownOptions=s,l.selectedPnics=[],l.pnicSelectorOptions={},l.pnicSelectorOptions.datagridHeaderOptions={title:e.getString("NetworkUi","FailoverOrderAddDialog.networkAdapters")},l.pnicSelectorOptions.selectionMode=a?a:t.grid.selectionMode.MULTI,l.pnicSelectorOptions.unclaimedPnics=r,l.pnicSelectorOptions.pnicDetails=n,l.pnicSelectorOptions.updateSelectedPnics=function(e){l.selectedPnics=e},l.noItemsSelectedMessage=e.getString("NetworkUi","FailoverOrderAddDialog.detailsPrompt");var d=function(){if(0===l.selectedPnics.length)return o(e.getString("H5NetworkUi","AddNetworkingWizard.pnicSelector.noPnicSelected"),u),!1;if(c){var t={};_.each(l.dropdownOptions,function(e){t[e.id]=e.selectedItem}),c(l.selectedPnics,t)}return!0},u={title:e.getString("NetworkUi","FailoverOrderAddDialog.title"),contentTemplate:"network-lib-ui/resources/network-lib/host/pnic/pnicSelector/pnicSelectorDialog.html",defaultButton:"submit",dialogData:l,alerts:[],size:"lg",modalClass:"pnic-selector-dialog",onSubmit:d};i.openOkCancelModal(u)}function o(e,t){t.alerts=[{text:e,type:r.notifications.type.ERROR}]}return{createPnicSelectorDialog:n}}angular.module("com.vmware.vsphere.client.networkLibUi").service("pnicSelectorDialogService",e),e.$inject=["i18nService","vuiConstants","clarityModalService","clarityConstants"]}(),function(){"use strict";function e(e,t){function i(t,i){var n={columnDefs:r(),data:t,pageConfig:{hidePager:!0},selectedItems:[],resizable:!0,height:"100%",sortMode:e.grid.sortMode.NONE,selectionMode:i,showCheckboxesOnMultiSelection:!1,sortOrder:[{field:"pnic",dir:"asc"}]};return n}function r(){return[{field:"pnic",width:"150px",template:function(e){return'<span class="network-lib-ui-icon-physicalAdapter"></span><span>'+e+"</span>"}}]}return{restrict:"E",templateUrl:"network-lib-ui/resources/network-lib/host/pnic/pnicSelector/pnicSelectorWithDetails.html",scope:{pnicSelectorOptions:"=?"},replace:!1,link:{pre:function(e){e.datagridHeaderOptions=e.pnicSelectorOptions.datagridHeaderOptions,e.datagridOptions=i(e.pnicSelectorOptions.unclaimedPnics,e.pnicSelectorOptions.selectionMode),e.$watch(function(){return e.datagridOptions.selectedItems},function(i){if(i&&1===i.length){var r=e.pnicSelectorOptions.pnicDetails[i[0]];e.selectedPnicDetails=t.build(r)}else e.selectedPnicDetails=null;e.pnicSelectorOptions.updateSelectedPnics&&e.pnicSelectorOptions.updateSelectedPnics(i)})}}}}angular.module("com.vmware.vsphere.client.networkLibUi").directive("pnicSelectorWithDetails",e),e.$inject=["vuiConstants","physicalAdapterDetailsViewService"]}(),function(){"use strict";function e(e,t,i){function r(r,n){if(!r)return{};var o=n||t.createPropertyViewBuilder(),a=o.category("policies").title(e.getString("NetworkUi","PortgroupSettingsView.policy"));return i.fillPoliciesCategory(a,r),n?void 0:o.build()}return{build:r}}angular.module("com.vmware.vsphere.client.networkLibUi").service("standardPortgroupPoliciesViewService",e),e.$inject=["i18nService","vxPropertyViewService","networkUtil"]}(),function(){var e=angular.module("com.vmware.vsphere.client.networkLibUi");e.constant("networkUiConstants",{POSITIVE_INTEGER_REG_EXP:new RegExp("^[0-9]+$"),MAX_SAFE_INTEGER:9007199254740991,MAX_HOST_NAME_LENGTH:63,MAX_DOMAIN_NAME_LENGTH:63,HOST_MAX_NUMBER_OT_CONNECTIONS_MAX:2e4,HOST_MAX_NUMBER_OT_CONNECTIONS_MIN:2e3,FQDN_MAX_LENGTH:255,MAX_NUMBER_SEARCH_DOMAINS:6,Mtu:{DEFAULT:1500,MIN:1280,MAX:9e3},NumPorts:{DEFAULT:128,MIN:16,MAX:4096},DvPortgroupNumPorts:{MIN:0,MAX:8192},Ipv6PrefixLength:{DEFAULT:64},DatagridActions:{ADD:"vsphere.core.network.wizard.actions.addIpV6",EDIT:"vsphere.core.network.wizard.actions.editIpV6",DELETE:"vsphere.core.network.wizard.actions.deleteIpV6"},LoadBalancingPolicy:{SRCID:"loadbalance_srcid",IP:"loadbalance_ip",SRCMAC:"loadbalance_srcmac",EXPLICIT:"failover_explicit",LOADBASED:"loadbalance_loadbased"},TrafficShapingSetting:{AVERAGE_BANDWIDTH:"averageBandwidth",PEAK_BANDWIDTH:"peakBandwidth",BURST_SIZE:"burstSize"},Vlan:{Type:{NONE:"none",VLAN:"vlan",TRUNK:"trunk",PRIVATE:"private"},Id:{NONE:0,MIN:1,MAX:4094,ALL:4095},PvlanType:{PROMISCUOUS:"promiscuous",COMMUNITY:"community",ISOLATED:"isolated"},DEFAULT_VLAN_TRUNK_RANGE:"0-4094"},PortgroupType:{EARLY_BINDING:"earlyBinding",LATE_BINDING:"lateBinding",EPHEMERAL:"ephemeral"},actions:{EDIT_DVS_NOTES:"vsphere.core.dvs.actions.editNotes",ADD_NETWORKING:"vsphere.core.network.actions.addNetworking",EDIT_VNIC:"vsphere.core.host.network.actions.editVnicAction",REMOVE_VNIC:"vsphere.core.host.network.actions.removeVnicAction",EDIT_PORTGROUP:"vsphere.core.host.network.editPortgroupSettingsAction",EDIT_DVPG:"vsphere.core.dvPortgroup.editSettingsAction",EXPORT_DVPG:"vsphere.core.dvPortgroup.exportConfiguration",IMPORT_DVPG:"vsphere.core.dvPortgroup.importConfiguration",RESTORE_DVPG:"vsphere.core.dvPortgroup.restoreConfiguration",EDIT_DVPG_NOTES:"vsphere.core.dvPortgroup.actions.editNotes",REMOVE_PORTGROUP:"vsphere.core.host.network.removePortgroupAction",EDIT_VSWITCH:"vsphere.core.host.network.editVSwitchSettingsAction",REMOVE_VSWITCH:"vsphere.core.host.network.removeVirtualSwitchAction",MANAGE_PNICS:"vsphere.core.host.network.managePhysicalNicsAction",MIGRATE_HOST_NETWORKING:"vsphere.core.dvs.migrateHostNetworkingAction",ADD_PORT_BINDING_FOR_ISCSI:"vsphere.core.network.addIscsiPortBindingAction",REMOVE_PORT_BINDING_FROM_ISCSI:"vsphere.core.network.removeIscsiPortBindingAction",SHOW_ISCSI_PORT_BINDING_DETAILS:"vsphere.core.network.showIscsiPortBindingDetailsAction",EDIT_DNS_AND_ROUTING:"vsphere.core.host.network.editDnsAndRoutingAction",EDIT_IPV6_SUPPORT:"vsphere.core.host.network.editIpv6SupportAction",VM_MIGRATE:"vsphere.core.network.vmMigrateAction",RENAME_DV_PORTGROUP:"vsphere.core.dvPortgroup.renameAction",REFRESH_NETWORK:"vsphere.core.host.network.refreshNetworkAction",EDIT_PNIC:"vsphere.core.host.network.actions.editPnicAction",REMOVE_SPAN_SESSION:"vsphere.core.dvs.spanSession.removeAction",ADD_SPAN_SESSION:"vsphere.core.dvs.spanSession.addAction",EDIT_SPAN_SESSION:"vsphere.core.dvs.spanSession.editAction",HOST_OF_SYNC_DVS_HOST:"vsphere.core.dvs.configissues.HostOutOfSyncIssue",REMOVE_DVS:"vsphere.core.dvs.removeHostFromDvsAction",RECTIFY_HOSTS_OUT_OF_SYNC_DVS:"vsphere.core.dvs.configissues.RectifyHostOutOfSync",MIGRATE_VMK_TO_VSWITCH:"vsphere.core.host.network.migrateVmkAction",GHOST_DVS_PROXY_SWITCH_DETACHED:"vsphere.core.network.configissues.GhostDvsProxySwitchDetectedIssue",NETWORK_MOVE_TO_ACTION:"vsphere.core.network.actions.moveTo",DVS_MOVE_TO_ACTION:"vsphere.core.dvs.actions.moveTo",NETWORK_MOVE_TO_DRAG_AND_DROP_ACTION:"vsphere.core.network.actions.moveNetworkToDrag",DVS_MOVE_TO_DRAG_AND_DROP_ACTION:"vsphere.core.dvs.actions.moveDvsToDrag",EDIT_DVPORT:"vsphere.core.dvs.editPortAction",VSS_VIEW_SETTINGS:"vsphere.core.host.network.vss.viewSettings",PROXY_SWITCH_VIEW_SETTINGS:"vsphere.core.host.network.proxySwitch.viewSettings"
},failoverOrderActions:{ADD:"add-action",REMOVE:"remove-action",MOVE_UP:"moveup-action",MOVE_DOWN:"movedown-action"},switchType:{STANDARD:"standardSwitch",DISTRIBUTED:"distributedSwitch"},UnitFormat:{KBPS:1e3,KB:1024},MulticastFiltering:{BASIC:"legacyFiltering",SNOOPING:"snooping"},LinkDiscoveryOperation:{LISTEN:"listen",ADVERTISE:"advertise",BOTH:"both",DISABLED:"none"},LinkDiscoveryProtocol:{CDP:"cdp",LLDP:"lldp"},LacpSupport:{BASIC:"singleLag",ENHANCED:"multipleLag"},LacpMode:{ACTIVE:"active",PASSIVE:"passive"},ManageDvpgWizard:{DVPG_CONFIG_VERSION_PROP:"config.configVersion"},TcpIpStack:{DEFAULT_NET_STACK_KEY:"defaultTcpipStack",VMOTION_NET_STACK_KEY:"vmotion"}})}(),function(){"use strict";function e(e,t,i){function r(e,t,i){var r=Number(e[i]),n=Number(t[i]);return isNaN(r)&&isNaN(n)?0:isNaN(r)?-1:isNaN(n)?1:r<n?-1:r>n?1:0}function n(e,t,i){var n=Number(e[i]),o=Number(t[i]);return isNaN(n)||isNaN(o)?isNaN(n)&&!isNaN(o)?1:isNaN(o)&&!isNaN(n)?-1:e[i].localeCompare(t[i]):r(e,t,i)}function o(t){return t===C?e.getString("NetworkUi","NetworkUtil.vlanNone"):t===D?e.getString("NetworkUi","NetworkUtil.vlanAll",D):t?""+t:""}function a(e){var t=c(e);return t&&e>=0&&e<=D}function s(e){var i=c(e);return"undefined"!=typeof e&&i&&e>=t.Mtu.MIN&&e<=t.Mtu.MAX}function c(e,i,r){return i=i||0,r=r&&r<=t.MAX_SAFE_INTEGER?r:t.MAX_SAFE_INTEGER,t.POSITIVE_INTEGER_REG_EXP.test(e)&&i<=e&&e<=r}function l(t){return _.map(t,function(t){return{val:t,label:e.getString("NetworkUi","PortFailoverPolicyView."+t)}})}function d(e){return!!e&&w.test(e)}function u(e){if(!e)return!1;var t=e.split(".");return""===t[t.length-1]&&t.pop(),t.every(function(e){return e&&w.test(e)})}function p(){var t=Array.prototype.slice.call(arguments);return e.getString.apply(null,["NetworkUi"].concat(t))}function v(i,r){if(r.security){var n=i.section("security").title(e.getString("NetworkUi","PortgroupSettingsView.security"));n.property(e.getString("NetworkUi","PortSecurityPolicyView.promiscuousMode"),r.security.allowPromiscuous?e.getString("NetworkUi","PortSecurityPolicyView.accept"):e.getString("NetworkUi","PortSecurityPolicyView.reject")),n.property(e.getString("NetworkUi","PortSecurityPolicyView.mac"),r.security.macChanges?e.getString("NetworkUi","PortSecurityPolicyView.accept"):e.getString("NetworkUi","PortSecurityPolicyView.reject")),n.property(e.getString("NetworkUi","PortSecurityPolicyView.forgedTransmits"),r.security.forgedTransmits?e.getString("NetworkUi","PortSecurityPolicyView.accept"):e.getString("NetworkUi","PortSecurityPolicyView.reject"))}if(r.trafficShaping){var o=i.section("trafficShaping").title(e.getString("NetworkUi","PortgroupSettingsView.trafficShaping"));o.property(e.getString("NetworkUi","PortTrafficShapingPolicyView.avgBW"),m(r.trafficShaping.averageBandwidthSummary)),o.property(e.getString("NetworkUi","PortTrafficShapingPolicyView.peakBW"),m(r.trafficShaping.peakBandwidthSummary)),o.property(e.getString("NetworkUi","PortTrafficShapingPolicyView.burstSize"),m(r.trafficShaping.burstSizeSummary))}if(r.teamingAndFailover){var a=r.teamingAndFailover,s=i.section("teaming").title(e.getString("NetworkUi","PortgroupSettingsView.failover"));if(s.property(e.getString("NetworkUi","PortFailoverPolicyView.lbLabel"),f(a.loadBalancing)),a.loadBalancing===t.LoadBalancingPolicy.IP){var c=h(a);c&&s.warning(c),g().forEach(function(e){s.info(e)})}s.property(e.getString("NetworkUi","PortFailoverPolicyView.detectionLabel"),a.failureDetection?e.getString("NetworkUi","PortFailoverPolicyView.beaconProbing"):e.getString("NetworkUi","PortFailoverPolicyView.linkStatus")),s.property(e.getString("NetworkUi","PortFailoverPolicyView.notifyLabel"),a.notifySwitches?e.getString("NetworkUi","PortFailoverPolicyView.notifyOn"):e.getString("NetworkUi","PortFailoverPolicyView.notifyOff")),s.property(e.getString("NetworkUi","PortFailoverPolicyView.failbackLabel"),a.failback?e.getString("NetworkUi","PortFailoverPolicyView.failbackOn"):e.getString("NetworkUi","PortFailoverPolicyView.failbackOff")),s.property(e.getString("NetworkUi","PortFailoverPolicyView.active"),m(a.activeAdapters.join(", "))),s.property(e.getString("NetworkUi","PortFailoverPolicyView.standby"),m(a.standByAdapters.join(", "))),s.property(e.getString("NetworkUi","PortFailoverPolicyView.inactive"),m(a.unusedAdapters.join(", ")))}}function m(t){return t?t:e.getString("NetworkUi","VnicPortPropertiesView.noData")}function g(){return[e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.info.etherChannel"),e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.info.portGroupPolicies")]}function h(t){return 0!==t.standByAdapters.length&&t.failureDetection?e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbingAndStandbyUplinks"):0!==t.standByAdapters.length?e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.standbyUplinks"):t.failureDetection?e.getString("NetworkUi","PortPolicyData.failover.lb.loadbalance_ip.warn.beaconProbing"):null}function f(i){switch(i){case t.LoadBalancingPolicy.SRCID:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_srcid");case t.LoadBalancingPolicy.IP:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_ip");case t.LoadBalancingPolicy.SRCMAC:return e.getString("NetworkUi","PortFailoverPolicyView.loadbalance_srcmac");case t.LoadBalancingPolicy.EXPLICIT:return e.getString("NetworkUi","PortFailoverPolicyView.failover_explicit");default:return e.getString("NetworkUi","VnicPortPropertiesView.noData")}}function S(e,t){if(!e||0===e.length)return null;var i=[],r="<div class='row'><span class='col-md-1'><span class='"+t+" failover-icon'></span></span><span class='col-md-11 info-msg-color'>{{msg}}</span></div>";return _.each(e,function(e){i.push(r.replace("{{msg}}",e))}),i}function y(e){var t=i.getEntityType(e);return"DistributedVirtualSwitch"===t||"VmwareDistributedVirtualSwitch"===t}function P(e){return e&&"string"==typeof e?encodeURIComponent(e).replace(/%[A-F\d]{2}/g,"U").length:0}var C=0,D=4095,w=/^[A-Z0-9]([A-Z0-9\-]*[A-Z0-9])*$/i;return{compareNumericValues:r,compareNumericAndNonNumericValues:n,formatVlanId:o,isVlanIdValid:a,isMtuValid:s,getString:p,fillPoliciesCategory:v,formatTextMessagesWithIcon:S,isDistributedSwitch:y,isPositiveInteger:c,createNicTeamingPolicyOptions:l,isHostNameValid:d,isDomainNameValid:u,getStringLengthInUtf8Bytes:P,NETWORK_LABEL_MAX_LENGTH:127}}angular.module("com.vmware.vsphere.client.networkLibUi").factory("networkUtil",e),e.$inject=["i18nService","networkUiConstants","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i){function r(r,o,a){var s=_.filter(o,function(e){return e!==t.actions.SEPARATOR});if(0===s.length){var c=o&&o.length>0?o:null;return e.resolve(c)}return i.getActions(r,s).then(function(e){var i={actions:[]};return _.forEach(o,function(r){var o;if(r===t.actions.SEPARATOR)i.actions.push(t.actions.SEPARATOR);else{var s=_.find(e,function(e){return e.action.uid===r});s&&(o=n(s,a),i.actions.push(o))}}),i})}function n(e,t){return{actionId:e.action.uid,tooltipText:e.action.description,label:e.action.label,enabled:e.available,iconClass:e.action.icon,onClick:function(){i.invokeAction(e,t)}}}return{createActionbarOptions:r}}angular.module("com.vmware.vsphere.client.networkLibUi").factory("actionToolbarFactory",e),e.$inject=["$q","vuiConstants","actionsService"]}();var network_lib_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.networkUiConstants=t,this.mutationService=i}return e.prototype.getInvalidNameError=function(t){var i=t.trim(),r=i.replace(/%/g,"%25").replace(/\//g,"%2f").replace(/\\/g,"%5c");return 0===r.length?this.i18nService.getString("NetworkLibUi","dvpg.properties.name.required"):r.length>e.MAX_ALLOWED_NAME_LENGTH?this.i18nService.getString("NetworkLibUi","dvpg.properties.name.tooLong"):null},e.prototype.getDuplicateOrTooLongNameError=function(e,t){return this.mutationService.validate(e,"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupNameSpec",{_type:"com.vmware.vsphere.client.h5.network.dvportgroup.model.DvPortgroupNameSpec",name:t.trim()}).then(function(e){return e.error&&e.error.localizedMessage?[e.error.localizedMessage]:e.result?[e.result]:[]},function(){return[]})},e.prototype.getVlanIdError=function(e){return this.isNumValueValid(e,this.networkUiConstants.Vlan.Id.MIN,this.networkUiConstants.Vlan.Id.MAX)?null:this.i18nService.getString("NetworkLibUi","dvpg.properties.vlan.type.error")},e.prototype.getNumPortsError=function(e,t){return void 0===t&&(t=this.networkUiConstants.DvPortgroupNumPorts.MAX),this.isNumValueValid(e,this.networkUiConstants.DvPortgroupNumPorts.MIN,t)?null:this.i18nService.getString("NetworkLibUi","dvpg.properties.numPorts.error",t)},e.prototype.isNumValueValid=function(e,t,i){return null!==e&&!isNaN(e)&&this.isValidInteger(e.toString())&&e>=t&&e<=i},e.prototype.isValidInteger=function(e){var t=new RegExp("^[0-9]+$");return t.test(e)},e.$inject=["i18nService","networkUiConstants","mutationService"],e.MAX_ALLOWED_NAME_LENGTH=80,e}();e.DvpgPropertiesService=t,angular.module("com.vmware.vsphere.client.networkLibUi").service("dvpgPropertiesService",t)}(network_lib_ui||(network_lib_ui={})),function(){"use strict";function e(e,t,i,r,n,o,a){function s(i,r){if(i){var n=t.createPropertyViewBuilder();if(p(n,i),m(n,i.ipProperties),v(n,i),r&&r.noPoliciesIncluded||(i.dvPortgroup?a.build(i.portPolicy,n):o.build(i.portPolicy,n)),r&&r.addAllTab){var s=n.category("all",0);s.title(e.getString("H5NetworkUi","VmkernelAdapterDetailsView.allTabTitle")).cloneAndAddBuilder(n.getSection("properties","propertiesSection")).cloneAndAddBuilder(n.getSection("ipCategory","ipv4Section")).cloneAndAddBuilder(n.getSection("ipCategory","ipv6Section")).cloneAndAddBuilder(n.getSection("properties","nicSettings")),r.noPoliciesIncluded||s.cloneAndAddBuilder(n.getSection("policies","security")).cloneAndAddBuilder(n.getSection("policies","trafficShaping")).cloneAndAddBuilder(n.getSection("policies","ingressTrafficShaping")).cloneAndAddBuilder(n.getSection("policies","egressTrafficShaping")).cloneAndAddBuilder(n.getSection("policies","teaming")).cloneAndAddBuilder(n.getSection("policies","vlan")).cloneAndAddBuilder(n.getSection("policies","monitoring")).cloneAndAddBuilder(n.getSection("policies","miscellaneous"))}return n.build()}return{}}function c(e){var i=t.createPropertyViewBuilder();return i.category("properties"),v(i,e),i.getCategory("properties").title(null),i.build()}function l(e){var i=t.createPropertyViewBuilder();return p(i,e),i.getCategory("properties").title(null),i.build()}function d(e){var i=t.createPropertyViewBuilder();return m(i,e),i.getCategory("ipCategory").title(null),i.build()}function u(e){var i=t.createPropertyViewBuilder();return e.dvPortgroup?a.build(e.portPolicy,i):o.build(e.portPolicy,i),i.build()}function p(t,r){var n=t.category("properties").title(e.getString("NetworkUi","VnicView.nicCategory.title")),o=r.mtu&&r.mac?e.getString("NetworkUi","VnicView.properties"):e.getString("NetworkUi","PortgroupPropertiesView.title"),a=n.section("propertiesSection").title(o);if(a.property(e.getString("NetworkUi","VnicPortPropertiesView.networkLabel"),g(r.networkLabel)),r.showVlanId===!0&&a.property(e.getString("NetworkUi","VnicPortPropertiesView.vlanID"),i.formatVlanId(r.vlanId)),r.showNetworkStack===!0&&a.property(e.getString("NetworkUi","VnicPortPropertiesView.networkStack"),g(r.networkStack)),r.enabledServices){var s=y(r.enabledServices);a.property(e.getString("NetworkUi","VnicPortPropertiesView.servicesEnabled"),g(s))}r.pinnedPnic&&a.property(e.getString("NetworkUi","VnicPortPropertiesView.pinnedPnic"),g(r.pinnedPnic))}function v(t,i){if(i.mac&&i.mtu){var r=t.getCategory("properties"),n=r.section("nicSettings").title(e.getString("NetworkUi","VnicView.nicSettings"));n.property(e.getString("NetworkUi","VnicSettingsView.macAddress"),g(i.mac)),n.property(e.getString("NetworkUi","VnicSettingsView.mtu"),g(i.mtu))}}function m(t,i){if(i&&i.hasIpv4Settings){var r=t.category("ipCategory").title(e.getString("NetworkUi","VnicView.ipCategory.title")),o=r.section("ipv4Section").title(e.getString("NetworkUi","VnicView.ipv4Settings"));if(o.property(e.getString("NetworkUi","VnicSettingsView.dhcp.label"),f(i.ipv4DhcpEnabled)),o.property(e.getString("NetworkUi","VnicIpv4SettingsView.ipv4Address"),S(i.ipv4DhcpEnabled,i.ipv4Address)),o.property(e.getString("NetworkUi","VnicIpv4SettingsView.subnetMask"),g(i.subnetMask)),o.property(e.getString("NetworkUi","VnicIpv4SettingsView.ipv4Gateway"),g(i.ipv4DefaultGateway)),i.shouldShowDnsServers){var a=_.filter(i.dnsServers,function(e){return n.isIpv4AddressValid(e)});0===a.length?o.property(e.getString("NetworkUi","VnicIpv4SettingsView.dnsAddresses"),e.getString("NetworkUi","NetworkUtil.noData")):o.property(e.getString("NetworkUi","VnicIpv4SettingsView.dnsAddresses"),a)}}if(i&&i.hasIpv6Settings){var s=t.getCategory("ipCategory");null===s&&(s=t.category("ipCategory").title(e.getString("NetworkUi","VnicView.ipCategory.title")));var c=s.section("ipv6Section").title(e.getString("NetworkUi","VnicView.ipv6Settings"));if(c.property(e.getString("NetworkUi","VnicSettingsView.dhcp.label"),f(i.ipv6DhcpEnabled)),c.property(e.getString("NetworkUi","VnicSettingsView.routerAdvertisement.label"),f(i.ipv6AutoConfigEnabled)),i.formattedIpv6Addresses&&0!==i.formattedIpv6Addresses.length?c.property(e.getString("NetworkUi","VnicIpv6SettingsView.ipv6Addresses"),i.formattedIpv6Addresses):c.property(e.getString("NetworkUi","VnicIpv6SettingsView.ipv6Addresses"),e.getString("NetworkUi","NetworkUtil.noData")),c.property(e.getString("NetworkUi","VnicIpv6SettingsView.ipv6Gateway"),g(i.ipv6DefaultGateway)),i.shouldShowDnsServers){var l=_.filter(i.dnsServers,function(e){return!n.isIpv4AddressValid(e)});0===l.length?c.property(e.getString("H5NetworkUi","VnicIpv6SettingsView.dnsAddresses"),e.getString("NetworkUi","NetworkUtil.noData")):c.property(e.getString("H5NetworkUi","VnicIpv6SettingsView.dnsAddresses"),l)}}}function g(t){return t?t:e.getString("NetworkUi","VnicPortPropertiesView.noData")}function h(t){return 0===t.length?[e.getString("NetworkUi","VnicPortPropertiesView.noData")]:t}function f(t){return t?e.getString("NetworkUi","VnicSettingsView.autoConfig.enabled"):e.getString("NetworkUi","VnicSettingsView.autoConfig.disabled")}function S(t,i){if(!i)return e.getString("NetworkUi","VnicIpv4SettingsView.noData");var r=t?e.getString("NetworkUi","VnicView.ipAddrDhcpTypeFormat"):e.getString("NetworkUi","VnicView.ipAddrStaticTypeFormat");return e.getString("NetworkUi","VnicView.ipAddressTypeFormat",i,r)}function y(t){var i=[];return t.isVmotionEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesView.vMotion")),t.isFtEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesView.ftLogging")),t.isManagementTrafficEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesView.mngTraffic")),t.isVrTrafficEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesView.vRTraffic")),t.isVrNfcTrafficEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesView.vrNfcTraffic")),t.isProvisioningNfcTrafficEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesView.provisioningNfcTraffic")),t.isVsanEnabled===!0&&i.push(e.getString("NetworkUi","VnicPortPropertiesPage.vsan")),t.isVsanWitnessTrafficEnabled&&i.push(e.getString("H5NetworkUi","VnicPortPropertiesPage.vsanWitnessTraffic")),h(i)}return{build:s,buildOnlyProperties:l,buildOnlyIpSettings:d,buildOnlyPolicies:u,buildOnlyNicSettings:c}}angular.module("com.vmware.vsphere.client.networkLibUi").service("networkDetailsViewService",e),e.$inject=["i18nService","vxPropertyViewService","networkUtil","networkUiConstants","ipParserService","standardPortgroupPoliciesViewService","distributedPortgroupPoliciesViewService"]}(),function(){"use strict";function e(e,t,i){function r(e){return{device:{displayName:t.getString("NetworkUi","VnicDataGridView.deviceColumnHeader"),field:"device",width:"150px",template:a("device",{"default":"network-lib-ui-icon-virtualAdapter"}),sortable:function(e,t){return c(e.device,t.device)}},networkLabel:{displayName:t.getString("NetworkUi","VnicDataGridView.networkLabelColumnHeader"),field:"networkLabel",width:"150px",template:a("networkLabel",{dvs:"vsphere-icon-virtual-port-group",opaqueNetwork:"vsphere-icon-cloud-network","default":"vsphere-icon-network"})},virtualSwitch:{displayName:t.getString("NetworkUi","VnicDataGridView.switchColumnHeader"),field:"virtualSwitch",width:"150px",template:a("virtualSwitch",{dvs:"vsphere-icon-dv-switch",opaqueNetwork:"network-lib-ui-icon-opaqueSwitch","default":"network-lib-ui-icon-vswitch"})},firstIpAddress:{displayName:t.getString("NetworkUi","VnicDataGridView.ipAddressColumnHeader"),field:"firstIpAddress",width:"150px"},networkStackName:{displayName:t.getString("NetworkUi","VnicDataGridView.networkStack"),field:"networkStackName",width:"150px"},isVmotionEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.vMotionColumnHeader"),field:"localizedVmotionEnabled",width:"150px",visible:e},isProvisioningNfcTrafficEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.provisioningNfcTrafficColumnHeader"),field:"localizedProvisioningNfcTrafficEnabled",width:"150px",visible:e},isFtEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.ftColumnHeader"),field:"localizedFtEnabled",width:"150px",visible:e},isManagementTrafficEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.managementTrafficColumnHeader"),field:"localizedManagementTrafficEnabled",width:"150px",visible:e},isVrTrafficEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.vRTrafficColumnHeader"),field:"localizedVrTrafficEnabled",width:"150px",visible:e},isVrNfcTrafficEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.vRNfcTrafficColumnHeader"),field:"localizedVrNfcTrafficEnabled",width:"150px",visible:e},isVsanEnabled:{displayName:t.getString("NetworkUi","VnicDataGridView.vsanColumnHeader"),field:"localizedVsanEnabled",width:"150px",visible:e},isVsanWitnessTrafficEnabled:{displayName:t.getString("H5NetworkUi","VnicPortPropertiesPage.vsanWitnessTraffic"),field:"localizedVsanWitnessTrafficEnabled",width:"150px",visible:e}}}function n(e,t){var i=e?e[l]:void 0;i&&i.items&&i.items.forEach(function(e){e.localizedVmotionEnabled=s(e.isVmotionEnabled),e.localizedProvisioningNfcTrafficEnabled=s(e.isProvisioningNfcTrafficEnabled),e.localizedFtEnabled=s(e.isFtEnabled),e.localizedManagementTrafficEnabled=s(e.isManagementTrafficEnabled),e.localizedVrTrafficEnabled=s(e.isVrTrafficEnabled),e.localizedVrNfcTrafficEnabled=s(e.isVrNfcTrafficEnabled),e.localizedVsanEnabled=s(e.isVsanEnabled),e.localizedVsanWitnessTrafficEnabled=s(e.isVsanWitnessTraficEnabled)});var r=i?i.hostFeatures:void 0,n=!!i&&i.isVsanWitnessTrafficSupported,a=o(r,n,t);return{"vnic:virtualAdaptersData":i,vnicColumnDefs:a}}function o(e,t,i){var n=[],o=r(i);return n.push(o.device),n.push(o.networkLabel),n.push(o.virtualSwitch),n.push(o.firstIpAddress),e&&e.isTcpIpStackSupported&&n.push(o.networkStackName),n.push(o.isVmotionEnabled),e&&e.isProvisioningNfcTrafficSupported&&n.push(o.isProvisioningNfcTrafficEnabled),n.push(o.isFtEnabled),n.push(o.isManagementTrafficEnabled),e&&e.isVrTrafficSupported&&n.push(o.isVrTrafficEnabled),e&&e.isVrNfcTrafficSupported&&n.push(o.isVrNfcTrafficEnabled),e&&e.isVsanSupported&&n.push(o.isVsanEnabled),t&&n.push(o.isVsanWitnessTrafficEnabled),n}function a(e,r){return function(n){if(!n[e])return"<span class='network-list-empty-cell'>"+t.getString("NetworkUi","NetworkUtil.noData")+"</span>";var o=r[n.connectedTo]||r["default"],a=i.getColumnRenderer("object-link");return a([void 0,e,o],n)}}function s(e){return e?t.getString("NetworkUi","NetworkUtil.enabled"):t.getString("NetworkUi","NetworkUtil.disabled")}function c(e,t){if(!e&&!t)return 0;if(!e&&t)return 1;if(e&&!t)return-1;var i=parseInt(e.substring(d)),r=parseInt(t.substring(d));return isNaN(i)&&isNaN(r)?0:isNaN(i)&&!isNaN(r)?1:!isNaN(i)&&isNaN(r)?-1:i<r?-1:i===r?0:1}var l="vnic:virtualAdaptersData",d="vmk".length;return{getVnics:function(t,i){return e.getProperties(t,[l]).then(function(e){return n(e,i)})},getVnicDetailsData:function(t,i){var r="vnic:virtualAdapterDetailsData",n=[{propertyName:r,parameterType:"java.lang.String",parameter:i}];return e.getProperties(t,[r],{propertyParams:n}).then(function(e){return e&&e[r]})}}}angular.module("com.vmware.vsphere.client.networkLibUi").service("vmKernelAdapterService",e),e.$inject=["dataService","i18nService","columnRenderersRegistry"]}(),h5=h5||{},h5.admin={angularModule:angular.module("com.vmware.vsphere.client.admin",["com.vmware.platform.ui"])};var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t){this.dataService=e,this.$http=t,this.privilegesUrl="admin-ui/ctrl/privileges"}return e.prototype.getPrivilegeTree=function(){return this.$http.get(this.privilegesUrl).then(function(e){return e.data})},e.$inject=["dataService","$http"],e}();e.PrivilegeService=t,angular.module("com.vmware.vsphere.client.admin").service("privilegeService",t)}(t=e.admin_ui||(e.admin_ui={}))}(h5_client||(h5_client={})),function(){"use strict";function e(e,s,c,l,d){function u(){return e.getProperties(r,["rolesInfo"]).then(function(e){return e.rolesInfo.filter(function(e){return e.id!==t&&e.id!==i})}).then(p)}function p(e){if(!e||0===e.length)return e;var t=e.findIndex(function(e){return"-1"===e.id}),i=e.splice(t,1),r=e.findIndex(function(e){return"-2"===e.id}),n=e.splice(r,1),o=e.findIndex(function(e){return"-5"===e.id}),a=e.splice(o,1);return e.sort(function(e,t){return e.label.toLowerCase()<t.label.toLowerCase()?-1:e.label.toLowerCase()>t.label.toLowerCase()?1:0}).unshift(i[0],n[0],a[0]),e}function v(t,i){var r={propertyName:"vsphere:permissionForRole",parameterType:"flex.messaging.io.amf.ASObject",parameter:{_type:"flex.messaging.io.amf.ASObject",roleId:t}},n=i.serviceGuid,o=c.createVmomiUri("Folder","group-d1",n),a=["vsphere:permissionForRole"];return e.getProperties(o,a,{propertyParams:[r],skipErrorInterceptor:!0}).then(m)["catch"](function(){d.notifyError("Syncronization error","Error retrieving usage data on this vCenter.")})}function m(e){var t=e["vsphere:permissionForRole"];if(void 0===t||null===t)return[];for(var i=[],r=t.names,n=t.permissions,o=0;o<n.length;o++)i.push({definedIn:g(n[o],r),userGroup:n[o].principal,propagate:n[o].propagate});return i}function g(e,t){for(var i=e.entity,r=0;r<t.length;++r){var n=t[r].value;if(i.value===n.value&&n.serverGuid===i.serverGuid)return t[r].name}return""}function h(e,t,i){var r={roleName:e,description:t,privileges:i};return s.getAllServersInfo().then(function(e){var t=e.serversInfo[0].serviceGuid,i=c.createVmomiUri("Folder","group-d1",t);return l.apply(i,n,r)})}function f(e,t,i,r){var n={roleId:e,roleName:t,roleDescription:i,privileges:r};return s.getAllServersInfo().then(function(e){var t=e.serversInfo[0].serviceGuid,i=c.createVmomiUri("Folder","group-d1",t);return l.apply(i,o,n)})}function S(e){var t={roleId:String(e)};return s.getAllServersInfo().then(function(e){var i=e.serversInfo[0].serviceGuid,r=c.createVmomiUri("Folder","group-d1",i);return l.apply(r,a,t)})}return{getRoles:u,getRoleUsages:v,cloneOrCreateRole:h,editRole:f,deleteRole:S}}angular.module("com.vmware.vsphere.client.admin").service("rolesService",e),e.$inject=["dataService","userSessionService","defaultUriSchemeUtil","mutationService","notificationService"];var t="-3",i="-4",r="urn:vri:acl:RootPermissionNode:root",n="com.vmware.vise.vim.security.data.CreateRoleSpec",o="com.vmware.vise.vim.security.data.EditRoleSpec",a="com.vmware.vise.vim.security.data.RemoveRoleSpec"}(),function(){function e(e,t,i,r){function n(){a.errorMessage=a.i18n("Common","error.role.name.unique"),a.validity="invalid"}function o(t){return 0===_.filter(e.modalOptions.dialogData.roles,function(e){return e.label===t}).length}var a=this;a.roleName=e.modalOptions.dialogData.roleName,a.description=e.modalOptions.dialogData.description,a.selectedPrivilegeIds=e.modalOptions.dialogData.selectedPrivilegeIds,a.i18n=r.getString,a.cloneRole=function(){return o(a.roleName)?t.cloneOrCreateRole(a.roleName,a.description,a.selectedPrivilegeIds).then(function(){return i.$broadcast("refreshRoles"),!0}):(n(),!1)},e.modalOptions.onSubmit=a.cloneRole,e.textChanged=function(){""===e.ctrl.roleName?e.modalOptions.submitDisabled=!0:e.modalOptions.submitDisabled=!1}}angular.module("com.vmware.vsphere.client.admin").controller("cloneRoleController",e),e.$inject=["$scope","rolesService","$rootScope","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(){var e=f.datagridRolesOptions.selectedItems[0],t=f.datagridRolesOptions.data;o.showWizard(t,e)}function d(){var e=f.datagridRolesOptions.selectedItems[0],t=i.getString("CommonModuleUi","cloneOf",e.label),r=e.summary,o=i.getString("CommonModuleUi","cloneRole"),a={action:{label:o}},s={title:o,actionEval:a,size:"lg",contentTemplate:"admin-ui/resources/admin/views/cloneRole.html",dialogData:{roleName:t,description:r,selectedPrivilegeIds:e.privilegeIds,roles:f.datagridRolesOptions.data}};n.openOkCancelModal(s)}function u(e){e.forEach(function(e){return 0===e.childNodes.length&&f.selectedPriviledgeIds.indexOf(e.id)>=0?void(e.selected=!0):(u(e.childNodes),void(e.childNodes.length&&p(e)))})}function p(e){var t=e.childNodes.filter(function(e){return e.selected});e.selected=t.length>0}function v(){var e=f.datagridRolesOptions.data;o.showWizard(e)}function m(){var e={title:i.getString("Common","rolesAction.remove.dialog.title"),message:i.getString("Common","rolesAction.remove.warning"),icon:"icon-warning-32",defaultButton:"close",submit:g,preserveNewlines:!0};n.openConfirmationModal(e)}function g(){t.deleteRole(f.datagridRolesOptions.selectedItems[0].id).then(function(){h()})}function h(){t.getRoles().then(function(e){f.datagridRolesOptions.data=e}),a.getPrivilegeTree().then(function(e){f.originalPrivileges=e,f.privilegeTreeForRole=angular.copy(f.originalPrivileges),u(f.privilegeTreeForRole)})}var f=this;f.hideUsage=!0,f.hideDescription=!1,f.hidePrivileges=!0,f.isAuthorized=!1,f.selectedDescription="",f.privilegeTreeForRole=[],f.originalPrivileges=[],f.selectedPriviledgeIds=[],f.selectedPriviledge={},f.datagridRolesOptions={actionBarOptions:{actions:[{id:"add-role-action",iconClass:"vsphere-icon-toolbar-add",tooltipText:i.getString("Common","rolesAction.create.desc"),enabled:f.isAuthorized,onClick:v},{id:"clone-role-action",iconClass:"vsphere-icon-roles-clone",tooltipText:i.getString("Common","rolesAction.clone.desc"),enabled:!1,onClick:d},{id:"edit-role-action",iconClass:"vsphere-icon-toolbar-edit",tooltipText:i.getString("Common","rolesAction.edit.desc"),enabled:!1,onClick:l},{id:"delete-role-action",iconClass:"vsphere-icon-toolbar-remove",tooltipText:i.getString("Common","rolesAction.remove.desc"),enabled:!1,onClick:m}]},columnDefs:[{field:"label"}],id:"Test",selectionMode:r.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,height:"100%"},f.datagridPermissionsOptions={columnDefs:[{displayName:i.getString("Common","PermissionView.defined"),field:"definedIn",attributes:{style:"text-align: right; font-size: 14px"}},{displayName:i.getString("Common","PermissionView.userGroupName"),field:"userGroup"},{displayName:i.getString("Common","usergrid.header.propagate"),field:"propagate"}],resizable:!0,reorderable:!1,height:"100%",attributes:{"class":"table-cell",style:"text-align: right; font-size: 14px"}},s.getAllServersInfo().then(function(e){f.vCenters=_.filter(e.serversInfo,function(e){return"noError"===e.errorCode}),f.selectedVc=f.vCenters[0]}),f.fetchRolesData=h,e.$watch(function(){return f.datagridRolesOptions.selectedItems},function(e){if(f.datagridRolesOptions.actionBarOptions.actions[1].enabled=!1,f.datagridRolesOptions.actionBarOptions.actions[2].enabled=!1,f.datagridRolesOptions.actionBarOptions.actions[3].enabled=!1,void 0!==e.length&&0!==e.length){f.selectedPriviledgeIds=JSON.parse(JSON.stringify(e[0].privilegeIds)),f.datagridRolesOptions.actionBarOptions.actions[1].enabled=f.isAuthorized;var i=e[0].id;f.selectedDescription=e[0].summary,"-1"!==i&&"-2"!==i&&"-5"!==i&&(f.datagridRolesOptions.actionBarOptions.actions[2].enabled=f.isAuthorized,f.datagridRolesOptions.actionBarOptions.actions[3].enabled=f.isAuthorized),f.selectedVc&&t.getRoleUsages(i,f.selectedVc).then(function(e){f.datagridPermissionsOptions.data=e}),f.privilegeTreeForRole=angular.copy(f.originalPrivileges),u(f.privilegeTreeForRole)}}),f.showUsage=function(){f.hideUsage=!1,f.hideDescription=!0,f.hidePrivileges=!0},f.showDescription=function(){f.hideUsage=!0,f.hideDescription=!1,f.hidePrivileges=!0},f.showPrivileges=function(){f.hideUsage=!0,f.hideDescription=!0,f.hidePrivileges=!1},f.checkPrivilege=function(){return c.checkUserPrivilege("urn:vri:acl:RootPermissionNode:root","Authorization.ModifyRoles").then(function(e){f.isAuthorized=e,f.datagridRolesOptions.actionBarOptions.actions[0].enabled=e})},e.$on("refreshRoles",function(){h()}),f.checkPrivilege(),h()}angular.module("com.vmware.vsphere.client.admin").controller("RolesViewController",e),e.$inject=["$scope","rolesService","i18nService","vuiConstants","clarityModalService","createEditRoleWizardService","privilegeService","userSessionService","userPrivilegeService"]}();var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.vuiWizardService=e,this.$rootScope=t,this.i18nService=i,this.rolesService=r,this.wizardPageService=n,this.createEditRolePageService=o,this.roleNamePageService=a}return e.prototype.showWizard=function(e,t){var i=this,r=this.$rootScope.$new(),n=this.createEditRolePageService.build(),o=this.roleNamePageService.build(),a=[],s=!1;a.push({id:"create.role.flowId",pages:[n,o]});var c=[n,o];r.wizardConfig={pages:this.wizardPageService.initializePageStates(c),flows:this.wizardPageService.initializeFlowStates(a)},r.wizardConfig.roles=e,r.wizardConfig.title=this.i18nService.getString("AdminUi","roles.create.new"),r.wizardConfig.hideToc=!0,r.wizardConfig.hideHeader=!0,r.wizardConfig.resizable=!1,r.wizardConfig.maximizable=!1,r.wizardConfig.resizable=!1,r.wizardConfig.resizeMinWidth=984,r.wizardConfig.cssClass="create-role-wizard",r.wizardState={name:"",selectedPrivilegeIds:[]},t&&(s=!0,r.wizardState={name:t.label,description:t.summary,selectedPrivilegeIds:t.privilegeIds,roleId:t.id},r.wizardConfig.title=this.i18nService.getString("AdminUi","roles.create.edit")),r.wizardConfig.onFinish=function(){if(s){var e=r.wizardState.name!==t.label,n=e?r.wizardState.name:null;i.rolesService.editRole(r.wizardState.roleId,n,r.wizardState.description,r.wizardState.selectedPrivilegeIds).then(function(){i.$rootScope.$broadcast("refreshRoles")})}else i.rolesService.cloneOrCreateRole(r.wizardState.name,r.wizardState.description,r.wizardState.selectedPrivilegeIds).then(function(){i.$rootScope.$broadcast("refreshRoles")});return!0},this.vuiWizardService({scope:r,configObjectName:"wizardConfig",sizeClass:"vui-large-modal"}).show()},e.$inject=["vuiWizardService","$rootScope","i18nService","rolesService","wizardPageService","createEditRolePageService","roleNamePageService"],e}();angular.module("com.vmware.vsphere.client.admin").service("createEditRoleWizardService",t)}(t=e.admin_ui||(e.admin_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.wizardPageService=t}return e.prototype.build=function(){return{contentUrl:"admin-ui/resources/admin/views/wizard/pages/createEditRole.html"}},e.$inject=["i18nService","wizardPageService"],e}();angular.module("com.vmware.vsphere.client.admin").service("createEditRolePageService",t)}(t=e.admin_ui||(e.admin_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$scope=e,this.$rootScope=t,this.privilegeService=i,this.rolesService=r,this.i18nService=n,this.$timeout=o,this.showAll=!0,this.showSelected=!1,
this.showUnselected=!1,this.selectedPrivilege,this.privilegeNodes=[],this.getPrivileges(),this.selectedPrivilegeIds=e.wizardState.selectedPrivilegeIds,this.groupSelected=!1,this.i18n=n.getString,this.init()}return e.prototype.focusPane=function(){var e=angular.element("#privilege-list-pane");e&&e[0]&&this.$timeout(function(){e[0].focus()},0)},e.prototype.handleKeyUp=function(e){if("LI"===e.target.tagName.toUpperCase()){var t=e.target;40===e.keyCode?t&&t.nextElementSibling&&(t.nextElementSibling.focus(),this.selectPrivilege(t.nextElementSibling.innerText)):38===e.keyCode&&t&&t.previousElementSibling&&(t.previousElementSibling.focus(),this.selectPrivilege(t.previousElementSibling.innerText))}},e.prototype.getPrivileges=function(){var e=this;this.privilegeService.getPrivilegeTree().then(function(t){e.privilegeNodes=t,e.privileges=_.pluck(t,"label").sort(),e.setSelectedIds(e.privilegeNodes),e.setNodesVisibleFlag(e.privilegeNodes,!0,!1)})},e.prototype.setNodesVisibleFlag=function(e,t,i){var r=this;e.forEach(function(e){if(0===e.childNodes.length)return void(i&&e.selected||!i?e.visible=t:e.visible=!t);if(r.setNodesVisibleFlag(e.childNodes,t,i),i){var n=_.filter(e.childNodes,function(e){return!e.selected});t===!0?n.length===e.childNodes.length?e.visible=!1:e.visible=!0:0===n.length?e.visible=!1:e.visible=!0}else e.visible=t}),this.focusPane()},e.prototype.getSelectedIds=function(e,t){var i=this;return e.forEach(function(e){return 0===e.childNodes.length&&e.selected?void t.push(e.id):void i.getSelectedIds(e.childNodes,t)}),t},e.prototype.setSelectedIds=function(e){var t=this;e.forEach(function(e){return 0===e.childNodes.length&&t.selectedPrivilegeIds.indexOf(e.id)>=0?void(e.selected=!0):(t.setSelectedIds(e.childNodes),void(e.childNodes.length&&t.toggleParent(e)))})},e.prototype.toggleChild=function(e){_.forEach(e.childNodes,function(t){t.selected=e.selected})},e.prototype.toggleParent=function(e){var t=_.filter(e.childNodes,function(e){return!e.selected});e.selected=0===t.length},e.prototype.selectPrivilege=function(e){var t=_.filter(this.privilegeNodes,function(t){return t.label===e});this.selectedPrivilege=t[0];var i=this.selectedPrivilege.childNodes;i.length>0&&i[0].childNodes.length>0?(this.isHorizontalMode=!0,this.isVerticalMode=!1):(this.isHorizontalMode=!1,this.isVerticalMode=!0),this.checkIfAllSelected()},e.prototype.displaySelected=function(){this.setNodesVisibleFlag(this.privilegeNodes,!0,!0),this.showSelected=!0,this.showUnselected=!1,this.showAll=!1},e.prototype.displayUnselected=function(){this.setNodesVisibleFlag(this.privilegeNodes,!1,!0),this.showUnselected=!0,this.showSelected=!1,this.showAll=!1},e.prototype.displayAll=function(){this.setNodesVisibleFlag(this.privilegeNodes,!0,!1),this.showUnselected=!1,this.showSelected=!1,this.showAll=!0},e.prototype.toggleSelectAll=function(){var e=this;this.selectedPrivilege.childNodes.forEach(function(t){t.selected=e.groupSelected,e.toggleChild(t)})},e.prototype.checkIfAllSelected=function(){var e=_.filter(this.selectedPrivilege.childNodes,function(e){return!e.selected});this.groupSelected=0===e.length},e.prototype.toggleExpandPrivileges=function(e){e.privilegeExpanded=!e.privilegeExpanded},e.prototype.init=function(){var e=this;this.$scope.vuiWizard.currentPage.disableNext=function(){var t=e.getSelectedIds(e.privilegeNodes,[]);return 0===t.length},this.$scope.vuiWizard.currentPage.onCommit=function(){var t=e.getSelectedIds(e.privilegeNodes,[]);return e.$scope.wizardState.selectedPrivilegeIds=t,e.$scope.vuiWizard.currentPage.state="completed",!0}},e.$inject=["$scope","$rootScope","privilegeService","rolesService","i18nService","$timeout"],e}();angular.module("com.vmware.vsphere.client.admin").controller("createEditRoleController",t)}(t=e.admin_ui||(e.admin_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.wizardPageService=t}return e.prototype.build=function(){return{contentUrl:"admin-ui/resources/admin/views/wizard/pages/createEditRoleName.html"}},e.$inject=["i18nService","wizardPageService"],e}();angular.module("com.vmware.vsphere.client.admin").service("roleNamePageService",t)}(t=e.admin_ui||(e.admin_ui={}))}(h5_client||(h5_client={}));var h5_client;!function(e){var t;!function(e){var t=function(){function e(e){this.i18nService=e,this.validity="valid",this.errorMessage="",this.$onInit=this.onInit}return e.prototype.i18n=function(e){return this.i18nService.getString("AdminUi",e)},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function(){return this._description},set:function(e){this._description=e},enumerable:!0,configurable:!0}),e.prototype.onInit=function(){var e=this;this.previousName=this._name,this.wizard.currentPage.onCommit=function(){return!e.nameInvalid()}},e.prototype.nameInvalid=function(){return this.name&&0!==this.name.length?!!this.isDuplicateRole()&&(this.validity="invalid",this.errorMessage=this.i18nService.getString("Common","error.role.name.unique"),!0):(this.validity="invalid",this.errorMessage=this.i18nService.getString("Common","error.role.name.req"),!0)},e.prototype.isDuplicateRole=function(){return this.name!==this.previousName&&_.findIndex(this.wizard.roles,{name:this.name})!==-1},e.$inject=["i18nService"],e}();e.RoleNamePageController=t;var i=function(){function e(){this.bindings={name:"=",description:"=",wizard:"="},this.controller=t,this.templateUrl="admin-ui/resources/admin/views/wizard/role-name-page/role-name-page.component.html"}return e.Name="roleNamePage",e}();e.RoleNamePage=i,angular.module("com.vmware.vsphere.client.admin").component(i.Name,new i)}(t=e.admin_ui||(e.admin_ui={}))}(h5_client||(h5_client={})),h5.hostprofile={angularModule:angular.module("com.vmware.vsphere.client.hostprofile",["com.vmware.platform.ui","com.vmware.vsphere.client.commonModule"])};var hostprofile_ui;!function(e){angular.module("com.vmware.vsphere.client.hostprofile").run(["hostProfileService","i18nService","clarityModalService","HostProfileComplianceService","mutationService","attachHostProfileService","dataService","clusterHostProfileSettingsService","managedEntityConstants","defaultUriSchemeUtil","hostCustomizationsService","remediateHostWizardService","createHostProfileService","vscImportHostProfileDialogOpenService","vscHpRemediateDialogService","vscEditHostProfileSettingsModalOpenService","vscAttachHostProfileModalOpenService","vscExtractHostProfileFromHostService","vscEditClusterHostCustomizationsService","vscDeleteHostProfileService","vscChangeRefHostService","vscCopyHostProfileToHostProfilesOpenWizardService",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C){h5.actions["vsphere.core.hostProfile.actions.createProfileFromAHost"]=function(e,t){p.openCreateHostProfileDialog(t[0])},h5.actions["vsphere.core.hostProfile.actions.attachHostProfile"]=function(e,t){o.openModal(t[0],!0)},h5.actions["vsphere.core.hostProfile.actions.changeHostProfile"]=function(t,i){var r=l.getEntityType(i[0]);r===c.CLUSTER?o.openModal(i[0],!1):e.changeHostProfile(i[0])},h5.actions["vsphere.core.hostProfile.actions.cluster.changeHostProfile"]=function(e,t){o.openModal(t[0],!1)},h5.actions["vsphere.core.hostProfile.actions.detachHostProfile"]=function(t,i){e.detachHostProfile(i[0])},h5.actions["vsphere.core.hostProfile.actions.editHostCustomizations"]=function(e,r){var n={title:t.getString("HostProfileUi","editHostCustomizationsWizard.title"),subTitle:{objectId:r[0]},dialogData:{availableTargets:r},defaultButton:"submit",contentTemplate:"hostprofile-ui/resources/hostprofile/customizations/editHostCustomizations.html",size:"xl"};i.openOkCancelModal(n)},h5.actions["vsphere.core.hostProfile.actions.cluster.editHostCustomizations"]=function(e,t){S.openWizard(t[0])},h5.actions["vsphere.core.hostProfile.actions.hostProfile.editHostCustomizations"]=function(e,t){S.openWizard(t[0])},h5.actions["vsphere.core.hostProfile.actions.hostProfile.editHostProfileAction"]=function(e,t){a.getProperties(t[0],["validationState"]).then(function(e){var i={selectedItemPath:null,editType:"original"};"Failed"===e.validationState&&(i.editType="failed"),g.open(t[0],i)})},h5.actions["vsphere.core.hostProfile.actions.cluster.checkHostProfileCompliance"]=function(e,t,i){var r=i&&i.hostProfileId?i.hostProfileId:null;n.apply(t[0],"com.vmware.vsphere.client.hostprofile.cluster.h5.ClusterHostProfileComplianceCheckSpec",{hostProfile:r})},h5.actions["vsphere.core.hostProfile.actions.hostProfile.checkHostProfileCompliance"]=function(e,t,i){n.apply(t[0],"com.vmware.vsphere.client.hostprofile.data.h5.HostProfileCheckComplianceSpec",{})},h5.actions["vsphere.core.hostProfile.actions.checkHostProfileCompliance"]=function(e,t,i){var n=i&&i.hostProfileId?i.hostProfileId:null;r.checkCompliance(t,n)},h5.actions["vsphere.core.hostProfile.actions.cluster.detachHostProfile"]=function(e,t){s.detachHostProfileFromCluster(t[0])},h5.actions["vsphere.core.hostProfile.actions.resetHostCustomizations"]=function(e,t){d.resetHostCustomizations(t[0])},h5.actions["vsphere.core.hostProfile.actions.remediateHost"]=function(e,t){m.openSingleHostRemediateDialog(t[0])},h5.actions["vsphere.core.hostProfile.actions.cluster.remediateMultipleHosts"]=function(e,t){m.openMultipleHostRemediateDialog(t[0])},h5.actions["vsphere.core.hostProfile.actions.hostProfile.remediateMultipleHosts"]=function(e,t){m.openMultipleHostRemediateDialog(t[0])},h5.actions["vsphere.core.hostProfile.actions.duplicateProfile"]=function(e,t){p.openCreateHostProfileDialog(t[0],!1)},h5.actions["vsphere.core.hostProfile.actions.exportProfile"]=function(t,i){e.openExportHostProfileDialog(i[0])},h5.actions["vsphere.core.hostprofile.attachAction"]=function(e,t){h.open(t[0])},h5.actions["vsphere.core.hostProfile.actions.importProfile"]=function(e,t){v.open()},h5.actions["vsphere.core.hostProfile.actions.exportHostCustomizations"]=function(t,i){e.openExportHostCustomizationsDialog(i[0])},h5.actions["vsphere.core.hostProfile.actions.editHostProfile"]=function(e,t,i){g.open(t[0],i)},h5.actions["vsphere.core.hostProfile.actions.extractHostProfileFromAHost"]=function(e,t,i){f.openWizard(t[0])},h5.actions["vsphere.core.hostProfile.actions.deleteProfile"]=function(e,t,i){y.openDeleteProfileConfirmationModal(t[0])},h5.actions["vsphere.core.hostProfile.actions.changeRefHostAction"]=function(e,t,i){P.openChangeRefDialog(t[0])},h5.actions["vsphere.core.hostProfile.actions.copySettingsToHostProfiles"]=function(e,t,i){C.open(t[0])},h5.actions["vsphere.core.hostProfile.actions.copySettingsFromHostProfile"]=function(e,t,i){C.openFromToWizard(t[0])}}])}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n){var o=this;this.$scope=e,this.dataService=t,this.attachHostProfileService=i,this.i18nService=r,this.vuiConstants=n,this.loading=!0,this.gridOptions=i.getGridOptions(),this.filterPlaceholderText=r.getString("Common","filter.label"),this.searchTerm="",this.objectId=e.modalOptions.dialogData.objectId,e.modalOptions.onSubmit=this.submitProfile.bind(this),i.fetchData(this.objectId).then(function(e){o.gridOptions.data=e,o.dataGridOriginalData=e,o.loading=!1})}return e.prototype.filterSettings=function(){var e=["description","name"];this.gridOptions.data=this.attachHostProfileService.filterSettings(this.dataGridOriginalData,this.searchTerm,e)},e.prototype.submitProfile=function(){return this.$scope.modalOptions.isAlertClosed=!0,this.$scope.modalOptions.alerts=[],this.gridOptions.selectedItems[0]?(this.attachHostProfileService.attachHostProfile(this.objectId,this.gridOptions.selectedItems[0]),!0):(this.$scope.modalOptions.alerts=[{text:this.i18nService.getString("HostProfileUi","attachWizard.hostProfileSelectionPage.errors.selectProfile"),type:this.vuiConstants.validationBanner.type.ERROR}],this.$scope.modalOptions.isAlertClosed=!1,!1)},e.$inject=["$scope","dataService","attachHostProfileService","i18nService","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("AttachHostProfilePageController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l){this.$scope=e,this.$controller=t,this.i18nService=i,this.timeFormatterService=r,this.mutationService=n,this.hostProfileComplianceService=o,this.portletActionBarService=a,this.defaultUriSchemeUtil=s,this.dataService=c,this.vcService=l,this.HP_PORTLET_MODEL_65="com.vmware.vsphere.client.hostprofile.data.h5.model.HostProfilePortletData",this.HP_PORTLET_MODEL_66="com.vmware.vsphere.client.hostprofile.data.h5.model.H5HostProfilePortletData",this.hostId=e._route.objectId,this.liveRefreshProperties=["configStatus","complianceStatus","entity","complianceCheckState","remediationState"],this.statuses=o.getStatuses(),this.getFormattedDateTime=o.getFormattedDateTime,this.$scope.portlet.footerLinks=this.getFormattedLinks(),this.getPortletData(),this.updateActionBar()}return e.prototype.updateActionBar=function(){var e=this,t=[{actionId:"vsphere.core.hostProfile.actions.checkHostPortletCompliance",getActionInvocationContext:function(){var t=null;return e.$scope.data&&e.$scope.data.associatedHostProfileData&&e.$scope.data.associatedHostProfileData.provider&&(t=e.$scope.data.associatedHostProfileData.provider),{hostProfileId:t}}}];this.portletActionBarService.updateActionBar(this.$scope.portlet,[this.hostId],t,null)},e.prototype.getPortletData=function(){var e=this;this.loadingData||(this.loadingData=!0,this.vcService.is66VcOrLater(this.hostId).then(function(t){var i=t?e.HP_PORTLET_MODEL_66:e.HP_PORTLET_MODEL_65;e.dataService.getData(e.hostId,i).then(function(t){e.data=t,t&&t.associatedHostProfileData&&t.associatedHostProfileData.provider&&(e.hostProfileId=e.defaultUriSchemeUtil.getVsphereObjectId(t.associatedHostProfileData.provider)),e.loadingData=!1})}))},e.prototype.getFormattedLinks=function(){var e=this;return[{label:this.i18nService.getString("HostProfileUi","hostSummary.details"),ariaLabel:this.i18nService.getString("HostProfileUi","hostSummary.detailsAriaLabel"),onClick:function(){e.$scope._navigate("vsphere.core.host.manage.settings.hostProfileView",e.$scope._route.objectId)},enabled:!0}]},e.$inject=["$scope","$controller","i18nService","timeFormatterService","mutationService","HostProfileComplianceService","portletActionBarService","defaultUriSchemeUtil","dataService","vcService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("HostProfileController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$controller=e,this.i18nService=t,this.timeFormatterService=i,this.mutationService=r,this.dataService=n,this.portletActionBarService=o}return e.prototype.getFormattedDateTime=function(e){return this.timeFormatterService.timestampToText(e)},e.prototype.getStatuses=function(){return{unknown:{label:this.getString("hostComplianceStatus.unknown"),iconClass:"vsphere-icon-status-unknown"},compliant:{label:this.getString("hostComplianceStatus.compliant"),iconClass:"vx-icon-statusCompliant"},nonCompliant:{label:this.getString("hostComplianceStatus.notCompliant"),iconClass:"vx-icon-statusNotCompliant"},running:{label:this.getString("hostComplianceStatus.running"),iconClass:"spinner spinner-inline"},precheckRemediationRunning:{label:this.getString("hostComplianceStatus.precheckRemediationRunning"),iconClass:"spinner spinner-inline"},precheckRemediationComplete:{label:this.getString("hostComplianceStatus.precheckRemediationComplete"),iconClass:""},precheckRemediationFailed:{label:this.getString("hostComplianceStatus.precheckRemediationFailed"),iconClass:"vx-icon-statusNotCompliant"},remediationRunning:{label:this.getString("hostComplianceStatus.remediationRunning"),iconClass:"spinner spinner-inline"},remediationFailed:{label:this.getString("hostComplianceStatus.remediationFailed"),iconClass:"vx-icon-statusNotCompliant"}}},e.prototype.getString=function(e){return this.i18nService.getString("HostProfileUi",e)},e.prototype.checkCompliance=function(e,t){this.mutationService.applyOnMultiEntity(e,"com.vmware.vsphere.client.hostprofile.data.HostProfileComplianceCheckSpec",{hostProfile:t},this.getString("actionCheckHostProfileCompliance"))},e.$inject=["$controller","i18nService","timeFormatterService","mutationService","dataService","portletActionBarService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("HostProfileComplianceService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.mutationService=r,this.$q=n,this.createHostProfileService=o,e.modalOptions.onSubmit=this.submitProfile.bind(this),this.objectId=this.$scope.modalOptions.dialogData.objectId,this.isExtract=this.$scope.modalOptions.dialogData.isExtractAction,this.profileName=this.isExtract?this.i18nService.getString("HostProfileUi","createProfileWizard.defaultProfileName"):""}return e.prototype.submitProfile=function(){var e=this;if(this.$scope.modalOptions.isAlertClosed=!0,this.$scope.modalOptions.alerts=[],this.pageErrors=null,this.profileName){var t={profileName:this.profileName,isNewHostProfile:!0};this.mutationService.validate(this.objectId,"com.vmware.vsphere.client.hostprofile.data.HostProfileNameValidationSpec",t).then(function(t){if(t.result){var i=e.isExtract?e.createHostProfileService.getCreateProfileFromHostSpec(e.profileName,e.profileDescription,e.objectId):e.createHostProfileService.getDuplicateProfileSpec(e.profileName,e.profileDescription,e.objectId);e.mutationService.add(i._type,i),e.$scope.closeModal()}else e.pageErrors=e.i18nService.getString("HostProfileUi","hpRename.validation.uniqueName.error",e.profileName)})}else this.pageErrors=this.i18nService.getString("HostProfileUi","importProfile.noProfileName.error");return!1},e.$inject=["$scope","i18nService","vuiConstants","mutationService","$q","createHostProfileService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("CreateHostProfileController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(){this.require={parentCtrl:"^hostCustomizations"},this.controllerAs="ctrl",this.bindings={item:"<"},this.controller=i,this.templateUrl="hostprofile-ui/resources/hostprofile/customizations/customizationTextInputTemplate.html"}return e}();e.CustomizationTextInput=t;var i=function(){function e(e,t,i,r,n){this.$scope=e,this.i18nService=t,this.hostCustomizationsErrorsService=i,this.$element=r,this.HostProfileConstants=n,this.requiredConfig={message:this.i18nService.getString("HostProfileUi","hostCustomizations.requiredField.error"),isVisible:!1}}return e.prototype.updateValue=function(e){this.item.value=e,this.requiredConfig.isVisible=this.hostCustomizationsErrorsService.isPropertyRequiredAndEmpty(this.item),this.parentCtrl.updateHostCustomizationSetting(this.item),this.item.error=null},e.prototype.getErrorConfig=function(){return!this.requiredConfig.isVisible&&this.item.error?this.item.error:this.requiredConfig},e.$inject=["$scope","i18nService","hostCustomizationsErrorsService","$element","HostProfileConstants"],e}();angular.module("com.vmware.vsphere.client.hostprofile").component("customizationTextInput",new t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.clarityConstants=t,this.$scope.modalOptions.onSubmit=this.onSubmit.bind(this),this.objectId=this.$scope.modalOptions.dialogData.availableTargets[0],this.showGenericErrors=this.setGenericErrors.bind(this)}return e.prototype.setGenericErrors=function(e){var t=this;this.$scope.modalOptions.alerts=_.map(e,function(e){return{text:e,type:t.clarityConstants.notifications.type.ERROR}})},e.prototype.onSubmit=function(){var e=this;return this.getValidationErrors().then(function(t){return t===!0?e.submit():(_.isArray(t)&&e.setGenericErrors(t),!1)},function(){return!1})},e.$inject=["$scope","clarityConstants"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("EditHostCustomizationsController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t}return e.prototype.updateValue=function(e){this.$scope.modalOptions.dialogData.matching=!e.isVisible,this.$scope.modalOptions.dialogData.value=e.passwordValue},e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("EditPasswordController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.$window=t,this.i18nService=i,this.$scope.modalOptions.onSubmit=this.onSubmit.bind(this),this.objectId=this.$scope.modalOptions.dialogData.objectId}return e.prototype.onSubmit=function(){return this.$window.open("data/download/hostcustomizations?objectId="+this.objectId,"_blank"),!0},e.$inject=["$scope","$window","i18nService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("ExportHostCustomizationsController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(){this.bindings={data:"<",errors:"<",targetType:"@"},this.controller=i,this.templateUrl="hostprofile-ui/resources/hostprofile/customizations/hostCustomizationsComponent.html"}return e}();e.HostsCustomizations=t;var i=function(){function e(e,t,i,r){this.i18nService=e,this.managedEntityConstants=t,this.hostCustomizationsErrorsService=i,this.hostCustomizationsService=r,this.KEY_SPLITTER="/",this.datagridOptions=this.getGridOptions(),this.filterPlaceholderText=this.i18nService.getString("Common","filter.label"),this.hostCustomizationsGridTitle=this.i18nService.getString("HostProfileUi","host.customizations.datagrid.title"),this.searchTerm=""}return e.prototype.$onInit=function(){this.paramToErrorMap=this.hostCustomizationsErrorsService.getParamErrorsMap(this.data,this.errors),this.datagridOptions.data=this.createGridData(this.data)},e.prototype.$onChanges=function(e){e.errors&&(this.paramToErrorMap=this.hostCustomizationsErrorsService.getParamErrorsMap(this.data,this.errors)),this.datagridOptions&&(e.data||e.errors)&&(this.datagridOptions.data=this.createGridData(this.data))},e.prototype.createGridData=function(e){var t=this;return _.map(e,function(e,i){return _.extend({index:i,error:t.getItemError(e)},e)})},e.prototype.getGridOptions=function(){return{selectionMode:"single",sortMode:"single",searchable:!0,columnDefs:this.getColumnDefs(),data:[],height:"100%",resizable:!0}},e.prototype.getColumnDefs=function(){var e=[];return this.targetType===this.managedEntityConstants.CLUSTER&&e.push({field:"hostName",sortable:!0,searchable:!1,displayName:this.i18nService.getString("HostProfileUi","hostCustomizations.column.host")}),e.push({field:"requiredValue",sortable:!0,searchable:!1,displayName:this.i18nService.getString("HostProfileUi","hostCustomizations.column.required")}),e.push({field:"name",sortable:!0,searchable:!1,displayName:this.i18nService.getString("HostProfileUi","hostCustomizations.column.propertyName"),template:"<span title='#:name#'>#:name#</span>"}),e.push({field:"description",sortable:!0,searchable:!1,displayName:this.i18nService.getString("HostProfileUi","hostCustomizations.column.path"),template:"<span title='#:description#'>#:description#</span>"}),e.push({field:"value",sortable:!0,searchable:!1,displayName:this.i18nService.getString("HostProfileUi","hostCustomizations.column.value"),template:function(e){return"password"===e.valueType?"<password-text-input item='dataItem'></password-text-input>":"<customization-text-input item='dataItem'></customization-text-input>"}}),e},e.prototype.updateHostCustomizationSetting=function(e){var t=this.data[e.index];t&&(t.value=e.value)},e.prototype.getItemError=function(e){var t=e.hostName+this.KEY_SPLITTER+e.inputPath.profilePath+this.KEY_SPLITTER+e.inputPath.policyId+this.KEY_SPLITTER+e.inputPath.parameterId,i=this.paramToErrorMap[t];return i?{message:i,isVisible:!0}:null},e.prototype.filterSettings=function(){this.datagridOptions.data=this.hostCustomizationsService.filterCustomizations(this.searchTerm,this.data)},e.$inject=["i18nService","managedEntityConstants","hostCustomizationsErrorsService","hostCustomizationsService"],e}();e.HostsCustomizationsController=i,angular.module("com.vmware.vsphere.client.hostprofile").component("hostCustomizations",new t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.defaultUriSchemeUtil=e,this.mutationService=t,this.$q=i,this.i18nService=r,this.hostProfileConstants=n,this.clarityModalService=o,this.KEY_SPLITTER="/"}return e.prototype.isPropertyRequiredAndEmpty=function(e){return e.isRequired&&""===e.value},e.prototype.getValidationErrors=function(e){var t=this.getEmptyRequiredPropertiesErrors(e.deferredHostSettingsSpec.currentHostCustomizations);return t.length>0?this.$q.reject({paramErrors:t,genericErrors:[this.i18nService.getString("HostProfileUi","hostCustomizationPage.validation.error")],invalidHosts:[]}):this.serverValidateHostCustomizations(e)},e.prototype.getClientValidationErrors=function(e){var t=this.getEmptyRequiredPropertiesErrors(e.deferredHostSettingsSpec.currentHostCustomizations),i=[];return t.length>0&&(i=[this.i18nService.getString("HostProfileUi","hostCustomizationPage.validation.error")]),i},e.prototype.getParamErrorsMap=function(e,t){var i=this,r={};return _.each(t,function(e){r[i.buildErrorMapKey(e)]=e.message}),r},e.prototype.buildErrorMapKey=function(e){var t="";return e.hostName&&(t+=e.hostName+this.KEY_SPLITTER),e.propertyPath&&(t+=e.propertyPath.profilePath+this.KEY_SPLITTER+e.propertyPath.policyId+this.KEY_SPLITTER+e.propertyPath.parameterId),t},e.prototype.getEmptyRequiredPropertiesErrors=function(e){var t=this;return _.map(_.filter(e,function(e){return t.isPropertyRequiredAndEmpty(e)}),function(e){return{hostName:e.hostName,propertyPath:e.inputPath,message:t.i18nService.getString("HostProfileUi","hostCustomizations.requiredFieldName.error",e.name)}})},e.prototype.getCustomizationsErrorMessages=function(e){var t=this.flatErrorsList([e]),i=this.getCommonCustomizationErrorMessages(t);return i},e.prototype.getCustomizationsImportErrorAndWarningMessages=function(e){var t=this.flatErrorsList([e]),i=_.find(t,function(e){return e&&(_.has(e,"errorMessages")||_.has(e,"warningMessages"))});return i?{errorMessages:_.map(i.errorMessages,function(e){return e.message}),warningMessages:_.map(i.warningMessages,function(e){return e.message})}:{errorMessages:[],warningMessages:[]}},e.prototype.serverValidateHostCustomizations=function(e){if(!e.deferredHostSettingsSpec||_.isEmpty(e.deferredHostSettingsSpec.forceValidationOnHosts))return this.$q.resolve({});var t=e.hostProfileId,i=this.defaultUriSchemeUtil.createVmomiUri(t.type,t.value,t.serverGuid);return this.mutationService.validate(i,"com.vmware.vsphere.client.hostprofile.data.h5.ValidateHostCustomizationsSpec",e.deferredHostSettingsSpec,e.deferredHostSettingsSpec.currentHostCustomizations).then(this.handleValidationResult.bind(this))},e.prototype.extractGenericErrors=function(e){return _.filter(e,function(e){return!e.path})},e.prototype.extractParameterRelatedErrors=function(e){return _.filter(e,function(e){return!_.isUndefined(e.path)&&!_.isNull(e.path)})},e.prototype.handleValidationResult=function(e){var t=this;if(e&&(e.error||this.hasValidationResultMessage(e))){var i=[],r=[];if(e.error){var n=e.error;r=_.filter(n.exceptions,function(e){return!!e.faultCause&&e.faultCause._type===t.hostProfileConstants.INVALID_PROFILE_REFERENCE_HOST}).map(function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.faultCause.host)}),i=this.getCustomizationsErrorMessages(n)}var o=[];return _.each(_.keys(e.result),function(r){var n=e.result[r].errors;if(n){var a=t.extractParameterRelatedErrors(n);o=o.concat(_.map(a,function(e){return{hostName:r,propertyPath:e.path,message:e.message.message}})),i=i.concat(t.extractGenericErrors(n))}}),o.length>0&&i.push(this.i18nService.getString("HostProfileUi","hostCustomizationPage.validation.error")),this.$q.reject({genericErrors:i,paramErrors:o,invalidHosts:r})}return this.$q.resolve({})},e.prototype.hasValidationResultMessage=function(e){return!(!e||!e.result)&&_.some(_.keys(e.result),function(t){return"error"===e.result[t].status})},e.prototype.showSkipValidationDialog=function(e,t){var i=this,r=_.map(t,function(t){var r=_.filter(e.deferredHostSettingsSpec.currentHostCustomizations,function(e){return i.defaultUriSchemeUtil.getVsphereObjectId(e.hostMor)===t}),n="";return r&&r.length>0&&(n=r[0].hostName),{id:t,name:n,checked:!0}}),n=this.$q.defer(),o={title:this.i18nService.getString("HostProfileUi","skipHostValidation.title"),contentTemplate:"hostprofile-ui/resources/hostprofile/attach/hostCustomizationSkipValidationDialog.html",dialogData:{validationData:{invalidHosts:r,deferredHostSettingsSpec:e.deferredHostSettingsSpec}},onSubmit:function(){return n.resolve(i.serverValidateHostCustomizations(e)),!0},onCancel:function(){var r=_.map(t,function(e){return i.defaultUriSchemeUtil.getManagedObjectReference(e)});e.deferredHostSettingsSpec.forceValidationOnHosts?e.deferredHostSettingsSpec.forceValidationOnHosts=_.uniq(_.union(e.deferredHostSettingsSpec.forceValidationOnHosts,r),!1,function(e){return e.value}):e.deferredHostSettingsSpec.forceValidationOnHosts=r,e.deferredHostSettingsSpec.skipValidationOnHosts=[],n.reject({genericErrors:[],paramErrors:[],invalidHosts:[]})}};return this.clarityModalService.openOkCancelModal(o),n.promise},e.prototype.flatErrorsList=function(e){e=e.concat();for(var t=[];e.length>0;){var i=e.shift();i&&(i._type===this.hostProfileConstants.COMPOSITE_EXCEPTION?Array.prototype.unshift.apply(e,i.exceptions):t.push(i))}return t},e.prototype.getCommonCustomizationErrorMessages=function(e){var t=this;return _.chain(e).filter(function(e){var i=e.message;return i||(i=e.localizedMessage),i&&!(e._type===t.hostProfileConstants.HOST_CUSTOMIZATION_IMPORT_EXCEPTION)&&!i.startsWith(t.hostProfileConstants.BAD_REQUEST_EXCEPTION)}).map(function(e){return e.message?e.message:e.localizedMessage}).value()},e.$inject=["defaultUriSchemeUtil","mutationService","$q","i18nService","HostProfileConstants","clarityModalService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("hostCustomizationsErrorsService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=com.vmware.vsphere.client.hostprofile.data.h5.ReadHostCustomizationsSpec,i=function(){function e(e,t,i,r,n,o,a){this.$scope=e,this.hostCustomizationsService=t,this.hostCustomizationsErrorsService=i,this.$element=r,this.$q=n,this.i18nService=o,this.vcService=a,this.hasGenericErrors=!1,this.hostCustomizationsErrors=[],this.isLastReadOperationImport=!1,this.hostCustomizationsImportWarningMessages=[],this.hostCustomizationsImportErrorMessages=[],this.validationData={},this.hasErrors=!1,this.i18n=o.getString}return e.prototype.$onInit=function(){var e=this;this.hostCustomizationsFileInput=this.$element.find(".import-host-customizations-file-input"),this.hostCustomizationsFileReader=new FileReader,this.submitCallback=this.onSubmit.bind(this),this.getValidationErrorsCallback=this.getValidationErrors.bind(this),this.getClientValidationErrorsCallback=this.getClientValidationErrors.bind(this),this.importOverrideSignPostOptions={title:null,message:this.i18nService.getString("HostProfileUi","editHostCustomizationsWizard.importPropertyOverrideInfo")},this.hostCustomizationsFileInput.on("change",function(t){return e.$scope.$evalAsync(function(){return e.onHostCustomizationsFileSelected(t.target.files[0])})}),$(this.hostCustomizationsFileReader).on("load",function(t){return e.$scope.$evalAsync(function(){return e.onHostCustomizationsFileLoad(t.target.result);
})}),this.$scope.$on("$destroy",function(){$.cleanData($(e.hostCustomizationsFileReader))}),this.vcService.is65VcOrLater(this.objectId).then(function(t){e.is65VcOrLater=t}),this.initValidationData(),this.getData()},e.prototype.initValidationData=function(){this.validationData.objectId=this.objectId,this.validationData.loading=!0,this.validationData.deferredHostSettingsSpec={_type:"com.vmware.vsphere.client.hostprofile.data.h5.ValidateHostCustomizationsSpec",forceValidationOnHosts:[],skipValidationOnHosts:[],isNewlyAssociatedProfile:!0,currentHostCustomizations:[],executeProfile:!1,formattedCustomizations:""}},e.prototype.onImportHostCustomizationsButtonClick=function(){this.hostCustomizationsFileInput.click()},e.prototype.onHostCustomizationsFileSelected=function(e){this.validationData.loading=!0,this.hostCustomizationsFileInput.prop("value",""),this.hostCustomizationsFileReader.readAsText(e)},e.prototype.onHostCustomizationsFileLoad=function(e){return e?void this.getCustomizations(e):void(this.validationData.loading=!1)},e.prototype.onSubmit=function(){return this.hostCustomizationsService.updateHostCustomizations(this.validationData.objectId,this.validationData.hostProfileId,this.validationData.deferredHostSettingsSpec.currentHostCustomizations).then(function(){return!0})},e.prototype.getValidationErrors=function(){var e=this;return this.validationData.loading?this.$q.resolve(!1):this.validationData.hostProfileId&&this.validationData.objectId&&this.hostCustomizations&&!this.hasErrors?(this.validationData.loading=!0,this.hostCustomizationsErrorsService.getValidationErrors(this.validationData).then(function(){return e.$q.resolve(!0)},this.handleValidationErrors.bind(this))):(this.validationData.loading=!1,this.$q.resolve(!1))},e.prototype.getClientValidationErrors=function(){return this.validationData.hostProfileId&&this.validationData.objectId&&this.hostCustomizations&&!this.hasErrors?this.hostCustomizationsErrorsService.getClientValidationErrors(this.validationData):[]},e.prototype.handleValidationErrors=function(e){var t=this;return this.validationData.loading=!1,this.hostCustomizationsErrors=e.paramErrors,e.invalidHosts.length>0?this.hostCustomizationsErrorsService.showSkipValidationDialog(this.validationData,e.invalidHosts).then(function(){return t.$q.resolve(!0)},this.handleValidationErrors.bind(this)):e.genericErrors.length>0?this.$q.resolve(e.genericErrors):this.$q.resolve(!1)},e.prototype.populateHostCustomizations=function(e,t){if(this.validationData.loading=!1,e&&e.length>0){var i=e[0].result;i&&i.length>0&&(this.hostCustomizations=e[0].result,this.validationData.deferredHostSettingsSpec.currentHostCustomizations=this.hostCustomizations,this.validationData.deferredHostSettingsSpec.forceValidationOnHosts=this.hostCustomizationsService.getCustomizationsHosts(this.hostCustomizations)),this.isLastReadOperationImport=t,this.hostCustomizationsImportResultDetailsSignPostOptions=void 0,this.hostCustomizationsImportStatus=void 0,this.hostCustomizationsImportErrorMessages=[],this.hostCustomizationsImportWarningMessages=[],this.hasErrors=!1,this.showGenericErrors([]);var r=e[0].error;if(r){var n=this.hostCustomizationsErrorsService.getCustomizationsErrorMessages(r);if(this.showGenericErrors(n),this.hasGenericErrors=n&&n.length>0,t){var o=this.hostCustomizationsErrorsService.getCustomizationsImportErrorAndWarningMessages(r);this.hostCustomizationsImportErrorMessages=o.errorMessages,this.hostCustomizationsImportWarningMessages=o.warningMessages;var a="";a=_.reduce(_.map(this.hostCustomizationsImportErrorMessages,function(e){return'\n                                    <div class="alert alert-danger alert-sm">\n                                       <div class="alert-items">\n                                       <div class="alert-item static">\n                                          <span class="alert-text">'+e+"</span>\n                                       </div>\n                                       </div>\n                                    </div>\n                                    "}),function(e,t){return e+t},a),a=_.reduce(_.map(this.hostCustomizationsImportWarningMessages,function(e){return'\n                                    <div class="alert alert-warning alert-sm">\n                                       <div class="alert-items">\n                                       <div class="alert-item static">\n                                          <span class="alert-text">'+e+"</span>\n                                       </div>\n                                       </div>\n                                    </div>\n                                    "}),function(e,t){return e+t},a),this.hostCustomizationsImportResultDetailsSignPostOptions={title:this.i18nService.getString("HostProfileUi","editHostCustomizationsWizard.importDetailsDialogTitle"),message:a}}this.hasErrors=!_.isEmpty(n)}else this.hasGenericErrors=!1;t&&(_.isEmpty(this.hostCustomizationsImportErrorMessages)?_.isEmpty(this.hostCustomizationsImportWarningMessages)?this.hostCustomizationsImportStatus="success":this.hostCustomizationsImportStatus="warning":this.hostCustomizationsImportStatus="error")}},e.prototype.getCustomizations=function(e){var i=this;if(this.validationData.hostProfileId){var r=new t;r.hostProfile=this.validationData.hostProfileId,r.isNewlyAssociatedProfile=!1,r.formattedHostCustomizations=e,r.currentHostCustomizations=this.hostCustomizations;var n=!!e;this.hostCustomizationsService.getHostCustomizations(this.validationData.objectId,r).then(function(e){return i.populateHostCustomizations(e,n)})}else this.validationData.loading=!1},e.prototype.getData=function(){var e=this;this.hostCustomizationsService.getAssociatedHostProfile(this.validationData.objectId).then(function(t){e.validationData.hostProfileId=t.associatedHostProfile,e.getCustomizations()})},e.$inject=["$scope","hostCustomizationsService","hostCustomizationsErrorsService","$element","$q","i18nService","vcService"],e}(),r=function(){function e(){this.controller=i,this.templateUrl="hostprofile-ui/resources/hostprofile/customizations/hostCustomizationsPage.html",this.bindings={objectId:"<",targetType:"<",showGenericErrors:"<",getValidationErrorsCallback:"=",getClientValidationErrorsCallback:"=",submitCallback:"="}}return e}();angular.module("com.vmware.vsphere.client.hostprofile").component("hostCustomizationsPage",new r)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t){this.mutationService=e,this.dataService=t}return e.prototype.getAssociatedHostProfile=function(e){return this.dataService.getProperties(e,["associatedHostProfile"])},e.prototype.getHostCustomizations=function(e,t){return this.mutationService.applyOnMultiEntity([e],"com.vmware.vsphere.client.hostprofile.data.h5.ReadHostCustomizationsSpec",t,"OP_IGNORE_ERROR")},e.prototype.updateHostCustomizations=function(e,t,i){return this.mutationService.applyOnMultiEntity([e],"com.vmware.vsphere.client.hostprofile.data.h5.UpdateHostCustomizationsSpec",{hostProfile:t,currentHostCustomizations:i})},e.prototype.resetHostCustomizations=function(e){return this.mutationService.applyOnMultiEntity([e],"com.vmware.vsphere.client.hostprofile.data.ResetHostCustomizationsSpec",{})},e.prototype.getCustomizationsHosts=function(e){var t=_.pluck(e,"hostMor").sort(function(e,t){return e.value.localeCompare(t.value)});return _.uniq(t,!0,function(e){return e.value})},e.prototype.filterCustomizations=function(e,t){var i=e.toLowerCase();return t.filter(function(e){var t=e.requiredValue.toLowerCase(),r=e.name.toLowerCase(),n=e.description.toLowerCase(),o=e.value.toLowerCase();return t.indexOf(i)!==-1||r.indexOf(i)!==-1||n.indexOf(i)!==-1||o.indexOf(i)!==-1})},e.$inject=["mutationService","dataService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("hostCustomizationsService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(){this.require={parentCtrl:"^hostCustomizations"},this.controllerAs="ctrl",this.bindings={item:"<"},this.controller=i,this.templateUrl="hostprofile-ui/resources/hostprofile/customizations/passwordTextInputTemplate.html"}return e}();e.PasswordTextInput=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.hostCustomizationsErrorsService=t,this.$element=i,this.HostProfileConstants=r,this.clarityModalService=n,this.value=this.i18nService.getString("HostProfileUi","hostCustomizations.maskedPassword"),this.requiredConfig={message:this.i18nService.getString("HostProfileUi","hostCustomizations.requiredField.error"),isVisible:!1}}return e.prototype.getErrorConfig=function(){return!this.requiredConfig.isVisible&&this.item.error?this.item.error:this.requiredConfig},e.prototype.openPasswordModal=function(){var e=this,t={title:this.i18nService.getString("HostProfileUi","editHostCustomizations.editPassword.title"),defaultButton:"submit",contentTemplate:"hostprofile-ui/resources/hostprofile/customizations/editPassword.html",dialogData:{value:"",matching:!0},onSubmit:function(){return!!t.dialogData.matching&&(e.item.value=t.dialogData.value,e.requiredConfig.isVisible=e.hostCustomizationsErrorsService.isPropertyRequiredAndEmpty(e.item),e.parentCtrl.updateHostCustomizationSetting(e.item),!0)}};this.clarityModalService.openOkCancelModal(t)},e.$inject=["i18nService","hostCustomizationsErrorsService","$element","HostProfileConstants","clarityModalService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").component("passwordTextInput",new t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.$window=t,this.i18nService=i,this.$scope.modalOptions.onSubmit=this.onSubmit.bind(this),this.objectId=this.$scope.modalOptions.dialogData.objectId}return e.prototype.onSubmit=function(){return this.$window.open("data/download/hostProfileExportData?objectId="+encodeURIComponent(this.objectId),"_blank"),!0},e.$inject=["$scope","$window","i18nService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("ExportHostProfileController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){angular.module("com.vmware.vsphere.client.hostprofile").constant("HostProfileConstants",{complianceStatus:{nonCompliant:"nonCompliant",unknown:"unknown",compliant:"compliant"},COMPOSITE_EXCEPTION:"com.vmware.vise.core.model.CompositeException",HOST_CUSTOMIZATION_IMPORT_EXCEPTION:"com.vmware.vsphere.client.hostprofile.data.HostCustomizationImportException",INVALID_PROFILE_REFERENCE_HOST:"com.vmware.vim.binding.vim.fault.InvalidProfileReferenceHost",BAD_REQUEST_EXCEPTION:"com.vmware.vise.search.transport.BadRequestException"})}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){var c=this;this.$scope=e,this.$element=t,this.i18nService=i,this.clusterHostProfileSettingsService=r,this.vcService=n,this.defaultUriSchemeUtil=o,this.dataService=a,this.localStorageService=s,this.REMEDIATION_RESULT_KEY="remediationTaskErrorResult_",this.isComplianceExpanded=!1,this.objectsToWatch=[],this.attachDetachViewHeaderAccessor={},this.splitterOptions=this.clusterHostProfileSettingsService.getSplitterOptions(),this.objectId=this.$scope._route.objectId,this.focusedItem=null,this.objectsToWatch=[this.objectId],this.liveRefreshProperties=["configStatus","complianceCheckState","remediationState","answerFileValidationState","entity","complianceStatus"],this.headerOptions={objectId:this.objectId,title:this.i18nService.getString("HostProfileUi","cluster.monitor.compliance.host"),actions:[{actionUid:"vsphere.core.hostProfile.actions.hostProfile.checkHostProfileCompliance",customLabel:this.i18nService.getString("HostProfileUi","hostProfile.action.checkCompliance")},{actionUid:"vsphere.core.hostProfile.actions.hostProfile.remediateMultipleHosts",customLabel:this.i18nService.getString("HostProfileUi","actionRemediateHostLabel")}]},n.is66VcOrLater(this.objectId).then(function(e){c.is66VcOrLater=e}),this.$scope.$on("hostProfileRemediationErrorsEvent",function(e,t){c.remediationErrorBannerVisible=t})}return e.prototype.refresh65ComplianceFailures=function(){this.selectedItemId=new String(this.selectedItemId)},e.prototype.onDataReceived=function(e){this.gridData=e,this.removeRemediationErrorsBanner(e)},e.prototype.onFocusGridRow=function(e){this.focusedItem=e,e&&(this.selectedItemId=this.defaultUriSchemeUtil.getVsphereObjectId(e.provider))},e.prototype.onRefreshActionInvoked=function(e){this.refreshContent()},e.prototype.showRemediationErrorBanner=function(e){e!==!0||this.remediationErrorBannerVisible||(this.remediationErrorBannerVisible=e)},e.prototype.hideRemediationErrorBanner=function(e){e===!1&&this.remediationErrorBannerVisible&&(this.remediationErrorBannerVisible=e)},e.prototype.onComplianceExpanded=function(){this.isComplianceExpanded=!0;var e=this.getCompliancePanel(),t=this.getSplitter();t.min(e,"400px"),e.height()<400&&t.size(e,"400px")},e.prototype.onComplianceCollapsed=function(){this.isComplianceExpanded=!1;var e=this.getCompliancePanel(),t=this.getSplitter();t.min(e,"240px")},e.prototype.getSplitterHolderClass=function(){return this.isComplianceExpanded?"splitter-holder-compliance-expanded":"splitter-holder-compliance-collapsed"},e.prototype.getCompliancePanel=function(){return this.$element.find(".profile-compliance-failure-section")},e.prototype.getSplitter=function(){return this.$element.find("[kendo-splitter]").data("kendoSplitter")},e.prototype.getComplianceTitle=function(){var e="";return this.focusedItem&&(e=this.focusedItem.hostName),this.i18nService.getString("HostProfileUi","compliance.status.labelWithPlaceholder",e)},e.prototype.refreshContent=function(){this.attachDetachViewHeaderAccessor&&this.attachDetachViewHeaderAccessor.refresh&&(this.attachDetachViewHeaderAccessor.refresh(),this.objectId=new String(this.objectId))},e.prototype.removeRemediationErrorsBanner=function(e){(!e||e&&0===e.length)&&(this.remediationErrorBannerVisible=!1,this.clearRemediationErrorsLocalStorage())},e.prototype.clearRemediationErrorsLocalStorage=function(){var e=this,t=this.REMEDIATION_RESULT_KEY+this.objectId;this.localStorageService.getUserData(t).then(function(i){i&&e.localStorageService.removeUserData(t)})},e.prototype.getHostComplianceCount=function(e){e?this.hostsCompliance={numberOfCompliantHosts:e.compliantHostCount,numberOfNonCompliantHosts:e.nonCompliantHostCount,numberOfUnknownHosts:e.unknownCompliantHostCount}:this.hostsCompliance=null},e.$inject=["$scope","$element","i18nService","clusterHostProfileSettingsService","vcService","defaultUriSchemeUtil","dataService","localStorageService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("HostProfileComplianceController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=com.vmware.vsphere.client.hostprofile.data.h5.ReadHostCustomizationsSpec,i=function(){function e(e,t){this.dataService=e,this.hostCustomizationsService=t}return e.prototype.setTargetUid=function(e){this.targetUid=e},e.prototype.getTargetUid=function(){return this.targetUid},e.prototype.getAssociatedHostProfile=function(){return this.dataService.getProperties(this.targetUid,["associatedHostProfile"])},e.prototype.getHostCustomizations=function(e){var i=new t;return i.hostProfile=e,i.isNewlyAssociatedProfile=!1,this.hostCustomizationsService.getHostCustomizations(this.targetUid,i)},e.prototype.setRemediationSpec=function(e){this.remediationSpec=e},e.prototype.getRemediationSpec=function(){return this.remediationSpec},e.prototype.setRebootHosts=function(e){this.rebootHosts=e},e.prototype.getRebootHosts=function(){return this.rebootHosts},e.$inject=["dataService","hostCustomizationsService"],e}();e.RemediateHostManager=i,angular.module("com.vmware.vsphere.client.hostprofile").factory("RemediateHostManager",["dataService","hostCustomizationsService",function(){return Function.prototype.bind.apply(i,[void 0,arguments[0],arguments[1]])}])}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.remediateHostPageService=t,this.dataService=i,this.i18nService=r,this.hidePrecheckButton=!1,this.remediationSpec={},this.loading=!1,this.rebootHosts=!0,this.manager=this.$scope.manager,this.manager.setRebootHosts(this.rebootHosts),this.wizardConfig=this.$scope.wizardConfig,this.wizardConfig.loading=!1,this.signPostConfig={message:this.buildSignPostMessage(),title:this.i18nService.getString("HostProfileUi","remediateHostWizard.readyToCompletePage.infoDialogTitle")},e.$watch(function(){if(n.rebootHosts)return n.rebootHosts},function(e,t){t!==e&&n.manager.setRebootHosts(n.rebootHosts)})}return e.prototype.precheckRemediation=function(){var e=this;this.hidePrecheckButton=!0;var t=this.$scope.manager.getTargetUid();this.wizardConfig.loading=!0,this.dataService.getProperties(t,["remediatePreCheckedData"]).then(function(t){var i=t.remediatePreCheckedData.remediateTree;e.treeListOptions=e.remediateHostPageService.getTreeListOptions(i),e.remediationSpec=t.remediatePreCheckedData.remediationSpec,e.manager.setRemediationSpec(e.remediationSpec),e.wizardConfig.loading=!1})},e.prototype.buildSignPostMessage=function(){var e=this.i18nService.getString("HostProfileUi","remediateHostWizard.readyToCompletePage.infoDialogMessageRequireReboot"),t=this.i18nService.getString("HostProfileUi","remediateHostWizard.readyToCompletePage.infoDialogMessageCheckBox");return e+"<br>"+t},e.$inject=["$scope","remediateHostPageService","dataService","i18nService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("RemediateHostPageController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.i18nService=e,this.vuiRemediateHostWizard=t,this.defaultUriSchemeUtil=i,this.mutationService=r,this.vuiConstants=n,this.columnRenderersRegistry=o,this.dataService=a,this.iconTextRenderer=this.columnRenderersRegistry.getColumnRenderer("icon-text")}return e.prototype.build=function(e,t){var i=this;return{title:this.getString("remediateHostWizard.reviewRemediateTasksList.title"),description:this.getString("remediateHostWizard.reviewRemediateTasksList.description"),contentUrl:"hostprofile-ui/resources/hostprofile/remediate/remediateHostPage.html",onCommit:function(){var e=t.getRemediationSpec();return e?(e.rebootHosts=t.getRebootHosts(),i.mutationService.applyOnMultiEntity([t.getTargetUid()],"com.vmware.vsphere.client.hostprofile.data.RemediationSpec",e)):i.dataService.getProperties(t.getTargetUid(),["remediatePreCheckedData"]).then(function(e){var r=e.remediatePreCheckedData.remediationSpec;r.rebootHosts=t.getRebootHosts(),i.mutationService.applyOnMultiEntity([t.getTargetUid()],"com.vmware.vsphere.client.hostprofile.data.RemediationSpec",r)}),!0},finishReady:function(){return!e.wizardConfig.loading}}},e.prototype.precheckRemediation=function(e,t){return this.mutationService.validate([e],"com.vmware.vsphere.client.hostprofile.data.PreRemediationSpec",{hosts:[this.defaultUriSchemeUtil.getManagedObjectReference(e)],hostCustomizations:t})},e.prototype.getTreeListOptions=function(e){return{dataSource:this.createRemediateTreeDataSource(e),sortable:!0,resizable:!1,columns:this.getColumnDefs(),height:"252px",selectable:"row"}},e.prototype.getColumnDefs=function(){var e=this;return[{title:this.getString("remediateHostWizard.readyToCompletePage.entityNameColumn"),template:function(t){return e.iconTextRenderer(["hostIcon","hostName"],t)}},{title:this.getString("remediateHostWizard.readyToCompletePage.stateColumn"),template:function(t){return e.iconTextRenderer(["descriptionIcon","description"],t)}}]},e.prototype.createRemediateTreeDataSource=function(e){var t=new kendo.data.TreeListDataSource({data:e,schema:{model:{id:"id",expanded:!1}}});return t.read(),t},e.prototype.getString=function(e){return this.i18nService.getString("HostProfileUi",e)},e.$inject=["i18nService","vuiRemediateHostWizard","defaultUriSchemeUtil","mutationService","vuiConstants","columnRenderersRegistry","dataService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("remediateHostPageService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.defaultUriSchemeUtil=e,this.mutationService=t,this.dataService=i,this.clarityModalService=r,this.i18nService=n,this.columnRenderersRegistry=o,this.managedEntityConstants=a,this.vuiConstants=s,this.iconTextRenderer=this.columnRenderersRegistry.getColumnRenderer("object-link")}return e.prototype.attachHostProfile=function(e,t){return this.mutationService.apply(this.defaultUriSchemeUtil.getVsphereObjectId(t.provider),"com.vmware.vsphere.client.hostprofile.data.AttachEntitiesSpec",{entitiesToAttach:[this.defaultUriSchemeUtil.getManagedObjectReference(e)]})},e.prototype.openModal=function(e,t){var i=this;this.dataService.getProperties(e,["name"]).then(function(r){var n=i.getTitle(t,r.name),o={title:n,dialogData:{objectId:e},defaultButton:"submit",contentTemplate:"hostprofile-ui/resources/hostprofile/attach/attachHostProfilePage.html",size:"lg"};i.clarityModalService.openOkCancelModal(o)})},e.prototype.filterSettings=function(e,t,i){var r=this,n=t.toLowerCase();return _.filter(e,function(e){return r.isSearchValuePresentedInProperties(e,n,i)})},e.prototype.isSearchValuePresentedInProperties=function(e,t,i){return _.some(i,function(i){var r=e[i];return!_.isNull(r)&&r.toLowerCase().indexOf(t)>=0})},e.prototype.getTitle=function(e,t){return e?this.i18nService.getString("HostProfileUi","attachWizard.title.attachProfile",t):this.i18nService.getString("HostProfileUi","attachWizard.title.changeProfile",t)},e.prototype.fetchData=function(e){var t=this,i="com.vmware.vsphere.client.h5.host.model.hostprofile.HostAttachHostProfileData";return this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).type===this.managedEntityConstants.CLUSTER&&(i="com.vmware.vsphere.client.hostprofile.data.h5.ClusterAttachHostProfileHostData"),this.dataService.getData(e,i).then(function(e){return t.filterHostProfileData(e)})},e.prototype.filterHostProfileData=function(e){var t=this,i=[];if(!e||!e.associatedHostProfile&&!e.compatibleHostProfileData)return i;if(e.associatedHostProfile){var r=this.defaultUriSchemeUtil.getVsphereObjectId(e.associatedHostProfile);i=_.filter(e.compatibleHostProfileData,function(e){var i=t.defaultUriSchemeUtil.getVsphereObjectId(e.provider);return i!==r})}else i=e.compatibleHostProfileData;return i},e.prototype.getGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:this.getColumnDefs(),height:"auto"}},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.i18nService.getString("HostProfileUi","HostProfileSelection.column.profile"),type:"string",field:"name",template:function(t){return e.iconTextRenderer([void 0,"name","vsphere-icon-Host_Policy"],t)}},{displayName:this.i18nService.getString("HostProfileUi","HostProfileSelection.column.description"),field:"description",type:"string"}]},e.$inject=["defaultUriSchemeUtil","mutationService","dataService","clarityModalService","i18nService","columnRenderersRegistry","managedEntityConstants","vuiConstants"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("attachHostProfileService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.clarityModalService=t,this.defaultUriSchemeUtil=i}return e.prototype.openCreateHostProfileDialog=function(e,t){void 0===t&&(t=!0);var i=t?this.i18nService.getString("HostProfileUi","createProfileTask.name"):this.i18nService.getString("HostProfileUi","duplicateProfileTask.name"),r={title:i,subTitle:t?"":{objectId:e},dialogData:{objectId:e,isExtractAction:t},defaultButton:"submit",contentTemplate:"hostprofile-ui/resources/hostprofile/create/createHostProfile.html",size:"lg"};this.clarityModalService.openOkCancelModal(r)},e.prototype.getCreateProfileFromHostSpec=function(e,t,i){return{_type:"com.vmware.vim.binding.vim.profile.host.HostProfile$HostBasedConfigSpec",name:e,annotation:t,enabled:!0,useHostProfileEngine:!0,host:this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(i)}},e.prototype.getDuplicateProfileSpec=function(e,t,i){return{_type:"com.vmware.vsphere.client.hostprofile.data.h5.DuplicateHostProfileSpec",profileName:e,profileDescription:t,profileRef:this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(i)}},e.$inject=["i18nService","clarityModalService","defaultUriSchemeUtil"],e}();e.CreateHostProfileService=t,angular.module("com.vmware.vsphere.client.hostprofile").service("createHostProfileService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.defaultUriSchemeUtil=e,this.i18nService=t,this.mutationService=i,this.dataService=r,this.clarityModalService=n,this.attachHostProfileService=o}return e.prototype.openDetachChangeHostProfileErrorDialog=function(e,t){var i=t?this.i18nService.getString("HostProfileUi","detachProfile.title"):this.i18nService.getString("HostProfileUi","attachWizard.title.changeProfile",e),r=t?this.i18nService.getString("HostProfileUi","detachProfile.error",e):this.i18nService.getString("HostProfileUi","actionChangeHostPrifle.error",e),n={title:i,subTitle:{text:e},message:r,icon:"icon-warning-32",submit:function(){},hideCancelButton:!0};this.clarityModalService.openConfirmationModal(n)},e.prototype.openDetachHostProfileDialog=function(e,t){var i=this,r={title:this.i18nService.getString("HostProfileUi","detachProfile.title"),subTitle:{text:t},message:this.i18nService.getString("HostProfileUi","detachProfile.text"),icon:"icon-warning-32",submit:function(){i.detachHostProfileAction(e)},defaultButton:"close",saveButtonLabel:this.i18nService.getString("Common","yes.label"),cancelButtonLabel:this.i18nService.getString("Common","no.label")};this.clarityModalService.openConfirmationModal(r)},e.prototype.detachHostProfileAction=function(e){var t=this;this.dataService.getData(e,"com.vmware.vsphere.client.h5.host.model.hostprofile.HostAttachHostProfileData").then(function(i){if(i.associatedHostProfile&&void 0!==i.associatedHostProfile){var r=t.defaultUriSchemeUtil.getVsphereObjectId(i.associatedHostProfile);t.mutationService.apply(r,"com.vmware.vsphere.client.hostprofile.data.AttachEntitiesSpec",{entitiesToDetach:[t.defaultUriSchemeUtil.getManagedObjectReference(e)]})}})},e.prototype.openDialog=function(e,t,i){var r=this;this.dataService.getData(e,"com.vmware.vsphere.client.h5.host.model.hostprofile.HostAttachHostProfileData").then(function(n){n&&n.associatedHostProfileForCluster?r.openDetachChangeHostProfileErrorDialog(n.hostName,i):i?t(e,n.hostName):t(e,!1)})},e.prototype.changeHostProfile=function(e){this.openDialog(e,this.attachHostProfileService.openModal.bind(this.attachHostProfileService),!1)},e.prototype.detachHostProfile=function(e){this.openDialog(e,this.openDetachHostProfileDialog.bind(this),!0)},e.prototype.openExportHostCustomizationsDialog=function(e){var t={title:this.i18nService.getString("HostProfileUi","exportCustomizationsDialog.title"),subTitle:{objectId:e},dialogData:{objectId:e},defaultButton:"submit",submitButtonTitle:this.i18nService.getString("HostProfileUi","saveButton.label"),contentTemplate:"hostprofile-ui/resources/hostprofile/customizations/exportHostCustomizations.html"};this.clarityModalService.openOkCancelModal(t)},e.prototype.openExportHostProfileDialog=function(e){var t={title:this.i18nService.getString("HostProfileUi","exportProfile.warning.title"),subTitle:{objectId:e},dialogData:{objectId:e},defaultButton:"submit",submitButtonTitle:this.i18nService.getString("HostProfileUi","saveButton.label"),contentTemplate:"hostprofile-ui/resources/hostprofile/export/exportHostProfile.html"};this.clarityModalService.openOkCancelModal(t)},e.$inject=["defaultUriSchemeUtil","i18nService","mutationService","dataService","clarityModalService","attachHostProfileService"],e}();e.HostProfileService=t,angular.module("com.vmware.vsphere.client.hostprofile").service("hostProfileService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.remediateHostPageService=e,this.vuiRemediateHostWizard=t,this.RemediateHostManager=i,this.dataService=r,this.$rootScope=n}return e.prototype.invokeWizard=function(e){var t=this,i=new this.RemediateHostManager;i.setTargetUid(e);var r=this.$rootScope.$new(),n=this.createWizardPages(r,i);this.dataService.getProperties(e,["name"]).then(function(e){if(e&&e.name){var o=e.name;t.vuiRemediateHostWizard.show(n,r,i,o)}})},e.prototype.createWizardPages=function(e,t){var i=[];return i.push(this.remediateHostPageService.build(e,t)),i},e.$inject=["remediateHostPageService","vuiRemediateHostWizard","RemediateHostManager","dataService","$rootScope"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("remediateHostWizardService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.wizardPageService=e,this.vuiWizardService=t,this.$rootScope=i,this.i18nService=r,this.mutationService=n}return e.prototype.show=function(e,t,i,r){this.wizardConfig={title:this.i18nService.getString("HostProfileUi","remediateHostWizard.title",r),pages:this.wizardPageService.initializePageStates(e),resizeMinHeight:500,onFinish:function(){return!0}},this.wizardScope=t,this.wizardScope.manager=i,this.wizardScope.wizardConfig=this.wizardConfig,this.vuiWizardService({scope:this.wizardScope,configObjectName:"wizardConfig"}).show()},e.$inject=["wizardPageService","vuiWizardService","$rootScope","i18nService","mutationService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("vuiRemediateHostWizard",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.$element=t,this.i18nService=i,this.clusterHostProfileSettingsService=r,this.vcService=n,this.defaultUriSchemeUtil=o,this.isComplianceExpanded=!1,this.objectsToWatch=[],this.attachDetachViewHeaderAccessor={},this.remediationErrorBannerVisible=!1,this.splitterOptions=this.clusterHostProfileSettingsService.getSplitterOptions(),this.objectId=this.$scope._route.objectId,this.focusedItem=null,this.objectsToWatch=[this.objectId],this.headerOptions=this.clusterHostProfileSettingsService.getHeaderOptions(this.objectId),this.liveRefreshProperties=["configStatus","complianceCheckState","remediationState","answerFileValidationState"],n.is66VcOrLater(this.objectId).then(function(e){a.is66VcOrLater=e}),this.$scope.$on("hostProfileRemediationErrorsEvent",function(e,t){a.remediationErrorBannerVisible=t})}return e.prototype.onDataReceived=function(e){this.gridData=e},e.prototype.refresh65ComplianceFailures=function(){this.selectedItemId=new String(this.selectedItemId)},e.prototype.onFocusGridRow=function(e){this.focusedItem=e,e&&(this.selectedItemId=this.defaultUriSchemeUtil.getVsphereObjectId(e.provider))},e.prototype.onComplianceExpanded=function(){this.isComplianceExpanded=!0;var e=this.getCompliancePanel(),t=this.getSplitter();t.min(e,"400px"),e.height()<400&&t.size(e,"400px")},e.prototype.onComplianceCollapsed=function(){this.isComplianceExpanded=!1;var e=this.getCompliancePanel(),t=this.getSplitter();t.min(e,"240px")},e.prototype.getSplitterHolderClass=function(){return this.isComplianceExpanded?"splitter-holder-compliance-expanded":"splitter-holder-compliance-collapsed"},e.prototype.showRemediationErrorBanner=function(e){e!==!0||this.remediationErrorBannerVisible||(this.remediationErrorBannerVisible=e)},e.prototype.hideRemediationErrorBanner=function(e){e===!1&&this.remediationErrorBannerVisible&&(this.remediationErrorBannerVisible=e);
},e.prototype.getCompliancePanel=function(){return this.$element.find(".profile-compliance-failure-section")},e.prototype.getSplitter=function(){return this.$element.find("[kendo-splitter]").data("kendoSplitter")},e.prototype.getComplianceTitle=function(){var e="";return this.focusedItem&&(e=this.focusedItem.hostName),this.i18nService.getString("HostProfileUi","compliance.status.labelWithPlaceholder",e)},e.prototype.refreshContent=function(){this.attachDetachViewHeaderAccessor&&this.attachDetachViewHeaderAccessor.refresh&&this.attachDetachViewHeaderAccessor.refresh()},e.$inject=["$scope","$element","i18nService","clusterHostProfileSettingsService","vcService","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("ClusterHostProfileSettingsController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.vuiConstants=e,this.i18nService=t,this.timeFormatterService=i,this.columnRenderersRegistry=r,this.defaultUriSchemeUtil=n,this.dataService=o,this.hostProfileConstants=a,this.mutationService=s}return e.prototype.getGridOptions=function(){return{searchable:!1,resizable:!1,data:[],selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],columnDefs:this.getColumnDefs(),height:"100%",pageConfig:{hidePager:!0}}},e.prototype.processHostsCompliance=function(e){var t={numberOfCompliantHosts:0,numberOfNonCompliantHosts:0,numberOfUnknownHosts:0},i=this.hostProfileConstants.complianceStatus;return _.each(e,function(e){switch(e.complianceResult.complianceStatus){case i.compliant:t.numberOfCompliantHosts+=1;break;case i.nonCompliant:t.numberOfNonCompliantHosts+=1;break;case i.unknown:t.numberOfUnknownHosts+=1}}),t},e.prototype.getSplitterOptions=function(){return{panes:[{min:"240px",size:"50%"},{min:"240px",size:"50%"}],orientation:this.vuiConstants.splitter.orientation.VERTICAL}},e.prototype.getHeaderOptions=function(e){return{objectId:e,title:this.getString("cluster.monitor.compliance.host"),actions:[{actionUid:"vsphere.core.hostProfile.actions.attachHostProfile",customLabel:this.getString("attachHostProfileButton.label")},{actionUid:"vsphere.core.hostProfile.actions.cluster.detachHostProfile",customLabel:this.getString("detachHostProfileClusterButton.label")},{actionUid:"vsphere.core.hostProfile.actions.changeHostProfile",customLabel:this.getString("changeHostProfileButton.label")},{actionUid:"vsphere.core.hostProfile.actions.cluster.checkHostProfileCompliance",customLabel:this.getString("hostProfile.action.checkCompliance")},{actionUid:"vsphere.core.hostProfile.actions.cluster.remediateMultipleHosts",customLabel:this.getString("actionRemediateHostLabel")}]}},e.prototype.getColumnDefs=function(){var e=this;return[{displayName:this.getString("HostCompliance.column.hostLabel"),field:"hostName",template:function(t){var i=e.defaultUriSchemeUtil.getVsphereObjectId(t.provider),r=e.columnRenderersRegistry.getColumnRenderer("object-link");return r(["hostRef","hostName","vsphere-icon-host"],{hostRef:i,hostName:t.hostName})}},{displayName:this.getString("HostCompliance.column.hostProfileComplianceLabel"),field:"complianceResult.complianceStatus",template:function(t){var i=e.hostProfileConstants.complianceStatus,r="vsphere-icon-status-unknown",n=e.getString("hpCompliance.unknown");t.complianceResult.complianceStatus===i.compliant?(r="vx-icon-statusCompliant",n=e.getString("hpCompliance.compliant")):t.complianceResult.complianceStatus===i.nonCompliant&&(r="vx-icon-statusNotCompliant",n=e.getString("hpCompliance.notCompliant"));var o=e.columnRenderersRegistry.getColumnRenderer("icon-text");return o(["icon","text"],{icon:r,text:n})}},{displayName:this.getString("HostCompliance.column.lastChecked"),field:"complianceResult.checkTime",template:function(t){var i=e.timeFormatterService.timestampToText(t.complianceResult.checkTime),r=e.columnRenderersRegistry.getColumnRenderer("text");return r(["text"],{text:i})}}]},e.prototype.requestHostComplianceData=function(e){return this.dataService.getData(e,"com.vmware.vsphere.client.hostprofile.data.h5.HostProfileComplianceFailuresData")},e.prototype.requestHostProfileSummary=function(e){return this.dataService.getProperties(e,["associatedHostProfileSummary"])},e.prototype.requestClusterHostProfileComplianceDetails=function(e){return this.dataService.getData(e,"com.vmware.vsphere.client.hostprofile.data.h5.ClusterHostProfileComplianceDetails")},e.prototype.getString=function(e){return this.i18nService.getString("HostProfileUi",e)},e.prototype.detachHostProfileFromCluster=function(e){this.mutationService.applyOnMultiEntity([e],"com.vmware.vsphere.client.hostprofile.data.DetachEntitiesSpec",{})},e.$inject=["vuiConstants","i18nService","timeFormatterService","columnRenderersRegistry","defaultUriSchemeUtil","dataService","HostProfileConstants","mutationService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").service("clusterHostProfileSettingsService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=com.vmware.vsphere.client.hostprofile.data.h5.ReadHostCustomizationsSpec,i=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){var p=this;this.$scope=e,this.hostProfileSettingsService=t,this.i18nService=i,this.$q=r,this.$element=n,this.dataService=o,this.hostCustomizationsService=a,this.defaultUriSchemeUtil=s,this.vcService=c,this.timeFormatterService=l,this.vuiConstants=d,this.localStorageService=u,this.REMEDIATION_RESULT_KEY="remediationTaskErrorResult_",this.isComplianceExpanded=!1,this.complianceStatus={},this.attachDetachViewHeaderAccessor={},this.remediationErrorBannerVisible=!1,this.splitterOptions={panes:[{min:"200px",size:"50%"},{min:"200px",size:"50%"}],orientation:this.vuiConstants.splitter.orientation.VERTICAL},this.loadingCustomizationsData=!1,this.objectId=this.$scope._route.objectId,this.objectsToWatch=[this.objectId],this.liveRefreshProperties=["configStatus","complianceStatus","entity","remediationState","complianceCheckState","answerFileValidationResult","answerFileValidationState"],this.headerOptions=this.hostProfileSettingsService.getHeaderOptions(this.objectId),this.customizationsHeaderOptions=this.hostProfileSettingsService.getCustomizationHeaderOptions(this.objectId),this.hostProfileNameHeaderText=this.i18nService.getString("HostUi","hostProfileNameHeaderText"),this.datagridOptions=this.hostProfileSettingsService.getDatagridOptions(),this.hostCustomizationsTitle=this.i18nService.getString("HostProfileUi","host.manage.settings.hostProfile.hostCustomization"),this.complianceFailureTitle=this.i18nService.getString("HostProfileUi","HostCompliance.treeView.title"),c.is65VcOrLater(this.objectId).then(function(e){p.is65VcOrLater=e}),c.is66VcOrLater(this.objectId).then(function(e){p.is66VcOrLater=e,p.getUserTimeFormatAndSetData()}),this.$scope.$on("hostProfileRemediationErrorsEvent",function(e,t){p.remediationErrorBannerVisible=t})}return e.prototype.onComplianceExpanded=function(){this.isComplianceExpanded=!0;var e=this.getCompliancePanel(),t=this.getSplitter();t.min(e,"400px"),e.height()<400&&t.size(e,"400px")},e.prototype.onComplianceCollapsed=function(e){this.isComplianceExpanded=!1;var t=this.getCompliancePanel(),i=this.getSplitter();if(i){i.min(t,"200px");var r=t.find("host-profile-host-settings-details"),n=Math.max(200,t.height()-r.height());i.size(t,n+"px")}},e.prototype.getSplitterHolderClass=function(){return this.isComplianceExpanded?"splitter-holder-compliance-expanded":"splitter-holder-compliance-collapsed"},e.prototype.showRemediationErrorBanner=function(e){e!==!0||this.remediationErrorBannerVisible||(this.remediationErrorBannerVisible=e)},e.prototype.hideRemediationErrorBanner=function(e){e===!1&&this.remediationErrorBannerVisible&&(this.remediationErrorBannerVisible=e)},e.prototype.getCompliancePanel=function(){return this.$element.find(".host-profile-host-settings-section")},e.prototype.getSplitter=function(){return this.$element.find("[kendo-splitter]").data("kendoSplitter")},e.prototype.getData=function(){var e=this;this.hostProfileSettingsService.getHostProfileSummary(this.objectId,this.is66VcOrLater).then(function(t){return e.setSummaryData(t)}).then(function(t){return e.hostProfileSettingsService.formatHostProfile(t)}).then(function(t){return e.setHostProfile(t)}).then(function(t){e.objectsToWatch=[e.objectId];var i=e.hostProfile?e.defaultUriSchemeUtil.getVsphereObjectId(e.hostProfile.profile):null;e.hostProfileId=i,e.hostProfile&&!e.is65VcOrLater&&e.objectsToWatch.push(i),e.getHostCustomizationsData(t)})},e.prototype.setSummaryData=function(e){var t;if(e&&e.associatedHostProfileSummary){var i=this.hostProfileSettingsService.extractComplianceDataFromProfileSummary(e,this.userTimeFormat);return this.complianceStatus=i.complianceStatus,this.complianceStatusFormatted=i.complianceStatusCheckTimeFormatted,this.showComplianceFailures=i.showComplianceFailures,this.showLastCheckedTime=i.showLastCheckedTime,t=this.$q.when(e.associatedHostProfileSummary)}},e.prototype.setHostProfile=function(e){return _.isUndefined(this.hostProfile)||_.isEqual(this.hostProfile,e)||(this.remediationErrorBannerVisible=!1,this.clearRemediationErrorsLocalStorage()),this.hostProfile=e,this.$q.when(e)},e.prototype.clearRemediationErrorsLocalStorage=function(){var e=this,t=this.REMEDIATION_RESULT_KEY+this.objectId;this.localStorageService.getUserData(t).then(function(i){i&&e.localStorageService.removeUserData(t)})},e.prototype.populateDatagird=function(e){this.datagridOptions.data=e},e.prototype.getHostCustomizationsData=function(e){var i=this;if(e&&e.profile){this.loadingCustomizationsData=!0;var r=new t;r.hostProfile=e.profile,r.isNewlyAssociatedProfile=!1,this.hostCustomizationsService.getHostCustomizations(this.objectId,r).then(function(e){if(e&&e.length>0){var t=e[0].result;t||(t=[]),i.populateDatagird(t)}i.loadingCustomizationsData=!1})}},e.prototype.refreshContent=function(){this.getUserTimeFormatAndSetData(),this.attachDetachViewHeaderAccessor&&this.attachDetachViewHeaderAccessor.refresh&&this.attachDetachViewHeaderAccessor.refresh()},e.prototype.getUserTimeFormatAndSetData=function(){var e=this;this.timeFormatterService.getUserTimeFormatPreference().then(function(t){e.userTimeFormat=t,e.getData()})},e.$inject=["$scope","hostHostProfileSettingsService","i18nService","$q","$element","dataService","hostCustomizationsService","defaultUriSchemeUtil","vcService","timeFormatterService","vuiConstants","localStorageService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("HostHostProfileSettingsController",i)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.i18nService=e,this.$q=t,this.dataService=i,this.timeFormatterService=r,this.defaultUriSchemeUtil=n,this.mutationService=o,this.$rootScope=a,this.columnRenderersRegistry=s,this.constants=c,this.hostProfileComplianceService=l,this.hostProfileConstants=d}return e.prototype.getHeaderOptions=function(e){return{title:this.i18nService.getString("HostUi","hostProfileNameHeaderText"),objectId:e,actions:[{actionUid:"vsphere.core.hostProfile.actions.attachHostProfile",customLabel:this.i18nService.getString("HostProfileUi","attachHostProfileButton.label")},{actionUid:"vsphere.core.hostProfile.actions.detachHostProfile",customLabel:this.i18nService.getString("HostProfileUi","detachHostProfileButton.label")},{actionUid:"vsphere.core.hostProfile.actions.changeHostProfile",customLabel:this.i18nService.getString("HostProfileUi","changeHostProfileButton.label")},{actionUid:"vsphere.core.hostProfile.actions.checkHostProfileCompliance",customLabel:this.i18nService.getString("HostProfileUi","hostProfile.action.checkCompliance")},{actionUid:"vsphere.core.hostProfile.actions.remediateHost",customLabel:this.i18nService.getString("HostProfileUi","actionRemediateHostLabel")}]}},e.prototype.getCustomizationHeaderOptions=function(e){return{title:this.i18nService.getString("HostProfileUi","host.manage.settings.hostProfile.hostCustomization"),objectId:e,actions:[{actionUid:"vsphere.core.hostProfile.actions.editHostCustomizations",customLabel:this.i18nService.getString("HostProfileUi","actionEditHostCustomizationsLabel")}]}},e.prototype.getHostProfileSummary=function(e,t){var i=this,r=null;return r=t?this.dataService.getData(e,"com.vmware.vsphere.client.hostprofile.data.h5.model.H5HostProfileSettingsData").then(function(e){return i.$q.when(e)}):this.dataService.getProperties(e,["associatedHostProfileSummary","hostProfileCompliance"]).then(function(e){return i.$q.when(e)})},e.prototype.formatHostProfile=function(e){var t=this.$q.defer();return e?this.$q.all([this.timeFormatterService.formatDate(e.creationTime),this.timeFormatterService.formatDate(e.lastUpdateTime)]).then(function(i){var r=i[0],n=i[1];t.resolve({name:e.name,createdAt:r,editedAt:n,profile:e.profile})}):t.resolve(""),t.promise},e.prototype.getDatagridOptions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("text");return{selectionMode:"single",sortMode:"single",searchable:!0,resizable:!0,columnDefs:[{field:"name",sortable:!0,searchable:!0,displayName:this.i18nService.getString("HostUi","hostCustomizations.column.propertyName"),template:function(e){return t(["name"],e)}},{field:"description",sortable:!0,searchable:!0,displayName:this.i18nService.getString("HostUi","hostCustomizations.column.path"),template:function(e){return t(["description"],e)}},{field:"value",sortable:!0,searchable:!0,displayName:this.i18nService.getString("HostUi","hostCustomizations.column.value"),template:function(i){var r;return r="password"===i.valueType?e.i18nService.getString("HostProfileUi","hostCustomizations.maskedPassword"):i.value?i.value:e.i18nService.getString("HostUi","settings.graphics.type.na"),t(["text"],{text:r})}}],data:[],height:"100%",pageConfig:{hidePager:!0}}},e.prototype.isCompliant=function(e){var t=this.constants.complianceStatus.compliant;return e&&e.complianceStatus===t},e.prototype.isUnknown=function(e){var t=this.constants.complianceStatus.unknown;return e&&(e.complianceStatus===t||null===e.complianceStatus)},e.prototype.extractComplianceDataFromProfileSummary=function(e,t){var i=e.hostProfileCompliance,r=this.hostProfileComplianceService.getStatuses(),n=i.complianceStatus,o=_.has(r,n)?r[n]:r[this.hostProfileConstants.complianceStatus.unknown],a=this.timeFormatterService.timestampToText(i.checkTime,t),s=!this.isCompliant(i)&&!this.isUnknown(i),c=!!n&&this.hostProfileConstants.complianceStatus.unknown!==n;return{complianceStatus:o,complianceStatusCheckTimeFormatted:a,showComplianceFailures:s,showLastCheckedTime:c}},e.$inject=["i18nService","$q","dataService","timeFormatterService","defaultUriSchemeUtil","mutationService","$rootScope","columnRenderersRegistry","HostProfileConstants","HostProfileComplianceService","HostProfileConstants"],e}();e.HostHostProfileSettingsService=t,angular.module("com.vmware.vsphere.client.hostprofile").service("hostHostProfileSettingsService",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.$rootScope=e,this.$scope=t,this.$timeout=i,this.dataService=r,this.vuiConstants=n,this.i18nService=o,this.actionsService=a,this.$log=s,this.vcService=c,this.EDIT_PROFILE="vsphere.core.hostProfile.actions.editHostProfile",this.CHANGE_HOST_PROFILE_REF="vsphere.core.hostProfile.actions.changeRefHostAction",this.COPY_HOST_PROFILE_SETTINGS_FROM_HOST_PROFILE="vsphere.core.hostProfile.actions.copySettingsFromHostProfile",this.profileDataLoading=!1,this.profileValidating=!1,this.showDropDown=!1,this.showCopyDropDown=!1,this.hostProfileId=this.$rootScope._route.objectId,this.objectsToWatch=[this.hostProfileId],this.liveRefreshProperties=["config"],this.validationStateProperty="validationState",this.actionUids=[this.EDIT_PROFILE,this.CHANGE_HOST_PROFILE_REF,this.COPY_HOST_PROFILE_SETTINGS_FROM_HOST_PROFILE],this.splitterOptions={orientation:n.splitter.orientation.HORIZONTAL,panes:[{min:"200px",size:"30%"},{min:"400px",size:"70%"}]},this.vcService.is65VcOrLater(this.hostProfileId).then(function(e){l.is65VcOrLater=e}),this.getInitialData(),this.getIsValidating("initialization"),this.evaluateActions(),this.invokeActionThrottle=_.debounce(this.actionsService.invokeAction.bind(this.actionsService),5e3,!0),this.$scope.$on("hostProfileEditedEvent",function(e,t){l.hostProfileId===t&&(l.$log.debug("Scheduling validation check after receiving 'hostProfileEditedEvent'"),l.profileValidating=!0,l.$timeout(function(){return l.getIsValidating("timeout")},5e3))})}return Object.defineProperty(e.prototype,"loadingText",{get:function(){return this.profileValidating?this.i18nService.getString("HostProfileUi","hostProfile.validating"):""},enumerable:!0,configurable:!0}),e.prototype.evaluateActions=function(){var e=this;this.actionsService.getActions(this.hostProfileId,this.actionUids).then(function(t){e.actionToRenderMap={},_.each(t,function(t){var i=t.action.uid;e.actionToRenderMap[i]={label:t.action.label,actionId:t.action.uid,isEnabled:t.available,eval:t}});var i=[];_.each(e.actionUids,function(t){e.actionToRenderMap[t]&&i.push(e.actionToRenderMap[t])}),e.actionsToRender=i})},e.prototype.invokeAction=function(e){this.invokeActionThrottle(e.eval,{selectedItemPath:this.selectedItemPath})},e.prototype.invokeEditAction=function(e,t){this.invokeActionThrottle(e.eval,{selectedItemPath:this.selectedItemPath,editType:t})},e.prototype.getInitialData=function(){var e=this;this.profileDataLoading=!0,this.dataService.getProperties(this.hostProfileId,["hostApplyProfileData","validationState"]).then(function(t){e.profileWrapper=t.hostApplyProfileData.result,e.validationState=t.validationState,e.profileDataLoading=!1})},e.prototype.getData=function(){var e=this;this.profileDataLoading=!0,this.dataService.getProperties(this.hostProfileId,["hostApplyProfileData"]).then(function(t){e.profileWrapper=t.hostApplyProfileData.result,e.profileDataLoading=!1})},e.prototype.refreshValidation=function(){this.getIsValidating("refresh"),this.getValidationState()},e.prototype.getIsValidating=function(e){var t=this;this.dataService.getProperties(this.hostProfileId,["isValidating"]).then(function(i){t.$log.debug("Resolved 'getIsValidating' returned "+i.isValidating+". Invoked by: "+e),t.profileValidating=i.isValidating})},e.prototype.getValidationState=function(){var e=this;this.dataService.getProperties(this.hostProfileId,["validationState"]).then(function(t){e.validationState=t.validationState})},e.prototype.invokeActionById=function(e){if(this.actionToRenderMap){var t=this.actionToRenderMap[e];this.actionsService.invokeAction(t.eval,{selectedItemPath:this.selectedItemPath})}},e.prototype.isActionAvailable=function(e){return this.actionToRenderMap&&this.actionToRenderMap[e]&&this.actionToRenderMap[e].isEnabled},e.prototype.isCopyAction=function(e){return e&&(this.isChangeHostReferenceAction(e)||this.isCopyHostProfileAction(e))},e.prototype.isChangeHostReferenceAction=function(e){return this.CHANGE_HOST_PROFILE_REF===e.actionId},e.prototype.isCopyHostProfileAction=function(e){return this.COPY_HOST_PROFILE_SETTINGS_FROM_HOST_PROFILE===e.actionId},e.$inject=["$rootScope","$scope","$timeout","dataService","vuiConstants","i18nService","actionsService","$log","vcService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("HostProfileSettingsController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.commonActionBarService=t,this.vuiConstants=i,this.i18nService=r,this.DUPLICATE_PROFILE="vsphere.core.hostProfile.actions.duplicateProfile",this.CHANGE_REF_HOST="vsphere.core.hostProfile.actions.changeRefHostAction",this.COPY_HOST_PROFILE_SETTINGS="vsphere.core.hostProfile.actions.copySettingsToHostProfiles",this.EXPORT_PROFILE="vsphere.core.hostProfile.actions.exportProfile",this.IMPORT_PROFILE="vsphere.core.hostProfile.actions.importProfile",this.EXTRACT_HOST_PROFILE_FROM_A_HOST="vsphere.core.hostProfile.actions.extractHostProfileFromAHost",this.DELETE_PROFILE="vsphere.core.hostProfile.actions.deleteProfile",this.ACTION_BAR_ACTIONS="actions",this.$scope.onSelectionChanged=function(e,t){n.actionBarOptions.actions=[],n.selectedProfiles=e,n.createOrUpdateActionBar()},this.actionBarOptions={actions:[]},this.actionDefs=[{actionId:this.EXTRACT_HOST_PROFILE_FROM_A_HOST,customLabel:this.i18nService.getString("HostProfileUi","action.extractHostProfileFromHost.label"),hideIcon:!0},{actionId:this.IMPORT_PROFILE},this.vuiConstants.actions.SEPARATOR,{actionId:this.DUPLICATE_PROFILE,customLabel:this.i18nService.getString("HostProfileUi","action.duplicateHostProfile.label"),isActionAvailable:function(e){return!_.isEmpty(n.selectedProfiles)&&e.available},hideIcon:!0},{actionId:this.CHANGE_REF_HOST,customLabel:this.i18nService.getString("HostProfileUi","actionChangeRefHostDescription"),isActionAvailable:function(e){return!_.isEmpty(n.selectedProfiles)&&e.available},hideIcon:!0},{actionId:this.COPY_HOST_PROFILE_SETTINGS,customLabel:this.i18nService.getString("HostProfileUi","actionCopyHostProfileSettingsDescription"),isActionAvailable:function(e){return!_.isEmpty(n.selectedProfiles)&&e.available},hideIcon:!0},{actionId:this.EXPORT_PROFILE,isActionAvailable:function(e){return!_.isEmpty(n.selectedProfiles)&&e.available},hideIcon:!0},{actionId:this.DELETE_PROFILE,isActionAvailable:function(e){return!_.isEmpty(n.selectedProfiles)&&e.available},hideIcon:!0}],this.createOrUpdateActionBar()}return e.prototype.createOrUpdateActionBar=function(){this.commonActionBarService.updateActionBar(this.actionBarOptions,this.ACTION_BAR_ACTIONS,this.getProfilesIds(),this.actionDefs)},e.prototype.getProfilesIds=function(){return _.pluck(this.selectedProfiles,"id")},e.$inject=["$scope","commonActionBarService","vuiConstants","i18nService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("HostProfilesSummaryViewController",t)}(hostprofile_ui||(hostprofile_ui={}));var hostprofile_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t,this.objectId=this.$scope._route.objectId}return e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.hostprofile").controller("RecentComplianceFailuresController",t)}(hostprofile_ui||(hostprofile_ui={}));var h5_vm;!function(e){h5=h5||{},h5.vm={angularModule:angular.module("com.vmware.vsphere.client.vm",["com.vmware.platform.ui","com.vmware.vsphere.client.commonModule"])},angular.module("com.vmware.vsphere.client.vm").run(["columnRenderersRegistry","i18nService",function(e,t){e.registerColumnRenderers({"host-name":function(t,i,r){var n=e.getColumnRenderer("object-link"),o="vsphere-icon-host";return i.hideHostIcon&&(o=""),n([t[0],t[1],o],i,r)},"detailed-tools-version-status":function(e,i){var r="",n=i[e[0]];if(n){var o=n.split("|",2),a=o[0],s=o[1];if("0"===a)r=t.getString("VmUi","guestToolsNA");else if(a){var c=t.getString("VmUi","tools."+a+".text");r=void 0===s||null===s?c:t.getString("VmUi","detailedToolsVersionStatus",s,c)}else r=s}return'<div title="'+r+'">'+r+"</div>"},"ha-protection-status":function(e,i){var r=i[e[0]],n=i[e[1]]?i[e[1]]:t.getString("VmUi","vmListItemData.na"),o="vui-icon-datagrid-status-unknown";return"true"===r?o="vsphere-icon-status-ok":"false"===r&&(o="vsphere-icon-status-error"),'<div class="object" title="'+n+'"><i class="'+o+'"></i>'+n+"</div>"},"storage-compliance-status":function(e,t){var i=t[e[0]],r=t[e[1]]?t[e[1]]:"",n="";switch(i){case"compliant":n="vsphere-icon-status-ok";break;case"nonCompliant":case"outOfDate":n="vsphere-icon-status-error";break;case"unknown":n="vui-icon-datagrid-status-unknown";break;case"notApplicable":n="vui-icon-datagrid-status-notApplicable"}return'<div class="object" title="'+r+'"><i class="'+n+'"></i>'+r+"</div>"},"is-present":function(e,i){var r=!!i[e[0]],n=t.getString("VmUi","VmDeviceManager.TPMNotPresent");return r&&(n=t.getString("VmUi","VmDeviceManager.TPMPresent")),'<div title="'+n+'">'+n+"</div>"},"managed-by":function(e,t){var i=_.escape(t[e[0]]),r=t[e[1]];return i&&!_.isEmpty(r)&&r.imageData?'<span><img src="data:image/png;base64, '+r.imageData+'"/>'+i+"</span>":i?i:""}})}]).run(["$rootScope","actionDialogService","mutationService","openConsoleService","createVmWizardService","powerOpsService","creationTypeConstants","migrateVmWizardService","$window","remoteConsoleService","markAsTemplateService","snapshotService","vscExportWizardLauncherService","i18nService","dataService","clarityModalService","contentLibraryService","upgradeVmHardwareService","keyboardShortcutService","vmToolsService","defaultUriSchemeUtil","managedEntityConstants","moveVmService","nameAndFolderValidatorService","vmDragAndDropService","vmRemovalService","vmFtService","createGuestOsCustomizationSpecWizardService","editGuestOsCustomizationSpecDialogService","fileSaverService","deleteGosSpecService","duplicateGosSpecService","importGosSpecService","ftVmService","customizeGosPreCheckSpecsService","customizeGosSelectSpecDialogService","browserService","unlockVmService","$injector",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D,w,b,I,_,T,E,V,M,O,A,k,R,N,U,L,F){h5.actions["vsphere.core.vm.actions.editNotes"]=function(e,t,r){var n=function(e,t,r){var n="com.vmware.vsphere.client.vm.VmNotesSpec",o={notes:t};return i.apply(e,n,o,r),!0},o={notesPropName:"config.annotation",onUpdateNotesCallback:n,focusTarget:r&&r.focusTarget};g.openModal(e,t,o,"common-module-ui/resources/common-module/views/notes/NotesDialog.html")},S.bindAction("ctrl+alt+b","vsphere.core.vm.powerOnAction"),h5.actions["vsphere.core.vm.actions.powerOn"]=function(e,t){o.powerOnVm(e,t)},S.bindAction("ctrl+alt+t","vsphere.core.vm.resetAction"),h5.actions["vsphere.core.vm.actions.reset"]=function(e,t){o.resetVMs(t)},S.bindAction("ctrl+alt+e","vsphere.core.vm.powerOffAction"),h5.actions["vsphere.core.vm.actions.powerOff"]=function(e,t){o.powerOffVm(t)},S.bindAction("ctrl+alt+d","vsphere.core.vm.shutdownGuestAction"),h5.actions["vsphere.core.vm.actions.shutdownGuest"]=function(e,t){o.shutdownGuest(t)},S.bindAction("ctrl+alt+r","vsphere.core.vm.rebootGuestAction"),h5.actions["vsphere.core.vm.actions.rebootGuest"]=function(e,t){o.rebootGuest(t)},S.bindAction("ctrl+alt+z","vsphere.core.vm.suspendAction"),h5.actions["vsphere.core.vm.actions.suspend"]=function(e,t){o.suspendVMs(t)},h5.actions["vsphere.core.vm.actions.installTools"]=function(e,t){g.openModal(e,t,{objectId:t[0],title:v.getString("VmUi","VmToolsPopupForm.singleInstall.title"),defaultButton:"submit"},"vm-ui/resources/vm/vmtools/vmInstallTools.html")},h5.actions["vsphere.core.vm.actions.upgradeTools"]=function(e,t){g.openModal(e,t,{objectId:t[0],title:v.getString("VmUi","VmToolsPopupForm.singleUpgrade.title"),defaultButton:"submit"},"vm-ui/resources/vm/vmtools/vmUpgradeTools.html")},h5.actions["vsphere.core.vm.actions.unmountTools"]=function(e,t){y.unmount(t)},h5.actions["vsphere.core.vm.actions.customizeGuestOs"]=function(e,t){var i=t[0];return R.customizeGosLoadData(i).then(function(e){var t={vmId:i,vmGuestOsFullName:e.guestFullName,vmGuestOsType:e.guestType,relevantSpecs:e.relevantSpecs};return N.open(t)})},h5.actions["vsphere.core.vm.actions.guestOSUserMapping"]=function(t,i){e&&e._navigateToViewAndObject&&e._navigateToViewAndObject("vsphere.core.vm.manage.settings.guestUserMappingsView",i[0])},h5.actions["vsphere.core.vm.installUpgradeToolsAction"]=function(e,t){y.installUpgrade(e,t)},h5.actions["vsphere.core.vm.vmQuestionAnswer"]=function(e,t,i){var r=t[0],n={title:v.getString("VmUi","VmQuestionAnswerView.titleNoEntityName"),subTitle:{objectId:r},contentTemplate:"vm-ui/resources/vm/views/questions/vmQuestionAnswerDialog.html",size:"lg",defaultButton:"submit",dialogData:{vmId:r,vmQuestionIssue:i}};g.openOkCancelModal(n)},h5.actions["vsphere.core.vm.actions.cryptoUnlock"]=function(e,t,i){L.unlockVm(e,t,i)},h5.actions["vsphere.core.vm.actions.takeSnapshot"]=function(e,t){u.openTakeSnapshotDialog(t,e)},h5.actions["vsphere.core.vm.actions.manageSnapshots"]=function(e,t){u.openManageSnapshotDialog(t,e)},h5.actions["vsphere.core.vm.actions.revertToLatestSnapshot"]=function(e,t){var i=t[0];u.getSnapshotsForVM(i,!0).then(function(e){u.onRevertToActionMenuClicked(i,e)})},h5.actions["vsphere.core.vm.actions.consolidateSnapshots"]=function(e,t){u.openConsolidateSnapshotDialog(t)},h5.actions["vsphere.core.vm.actions.deleteAllSnapshots"]=function(e,t){u.openRemoveAllSnapshotsConfirmationDialog(t[0])},h5.actions["vsphere.core.vm.actions.exportLogs"]=function(e,t){p.showSystemLogExportDialog(t)},h5.actions["vsphere.core.vm.actions.editSettings"]=function(e,t){g.openModal(e,t,void 0,"vm-ui/resources/vm/views/settings/vmHardwareModal.html")},h5.actions["vsphere.core.vm.actions.editEvcMode"]=function(e,t){var i={title:v.getString("VmUi","vmEvc.edit.dialogTitle"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"vm-ui/resources/vm/evc-mode/edit-vm-evc.view.html",size:"lg",dialogData:{vmId:t[0]}};g.openOkCancelModal(i)},h5.actions["vsphere.core.vm.actions.openConsole"]=function(e,t){var i=e.context,n=i.targetObjects[0];r.openConsole(t[0],n.value,n.serverGuid)},h5.actions["vsphere.core.vm.actions.launchRemoteConsole"]=function(e,t){t&&0!==t.length&&l.getRemoteConsoleUrl(t[0]).then(function(e){U.isFirefox()?c.open(e):c.location.href=e})},h5.actions["vsphere.core.vm.actions.downloadVMRC"]=function(e,t){window.open("http://www.vmware.com/go/download-vmrc")},h5.actions["vsphere.core.vm.actions.cloneVmToTemplate"]=function(e,t){var i={actionLabel:""};e&&e.action&&(i.actionLabel=e.action.label),n.showWizard(t[0],a.CLONE_VM_TO_TEMPLATE,i)},h5.actions["vsphere.core.vm.actions.cloneVmToVm"]=function(e,t){var i={actionLabel:""};e&&e.action&&(i.actionLabel=e.action.label),e&&e.additionalData&&e.additionalData.isScheduledTask&&(i.isScheduledTask=e.additionalData.isScheduledTask,i.schedulingData=e.additionalData.schedulingData),n.showWizard(t[0],a.CLONE_VM_TO_VM,i)},h5.actions["vsphere.core.vm.actions.cloneVmToLibrary"]=function(e,t){m.getProperties(t[0],["parent"]).then(function(e){var i=null;e.parent&&(i=P.getVsphereObjectId(e.parent)),n.showWizard(t[0],a.CLONE_AS_VMTEMPLATE_TO_LIBRARY,{folderUid:i})})},h5.actions["vsphere.core.vm.actions.cloneVappToLibrary"]=function(e,t){m.getProperties(t[0],["parent"]).then(function(e){var i=null;e.parent&&(i=P.getVsphereObjectId(e.parent)),n.showWizard(t[0],a.CLONE_VAPP_AS_VMTEMPLATE_TO_LIBRARY,{folderUid:i})})},h5.actions["vsphere.core.vm.actions.deployFromTemplate"]=function(e,t){n.showWizard(t[0],a.CLONE_TEMPLATE_TO_VM)},h5.actions["vsphere.core.vm.actions.convertTemplateToVmAction"]=function(e,t){n.showWizard(t[0],a.CONVERT_TEMPLATE_TO_VM)},h5.actions["vsphere.core.vm.actions.cloneTemplateToTemplate"]=function(e,t){n.showWizard(t[0],a.CLONE_TEMPLATE_TO_TEMPLATE)},h5.actions["vsphere.core.vm.actions.cloneTemplateToLibrary"]=function(e,t){var i=F.get("vscCloneVmToLibraryProxyService");i.openModal(t[0])},h5.actions["vsphere.core.vm.actions.markAsTemplate"]=function(e,t){d.markAsTemplate(t)},h5.actions["vsphere.core.vm.actions.exportAsOVF"]=function(e,t){if(0!==t.length){var i=t[0],r=F.get("vscExportOvfModalService");r.openExportOvfDialog(i)}},h5.actions["vsphere.core.vm.actions.upgradeVmVirtualHardware"]=function(e,t){f.upgradeVmHardware(e,t)},h5.actions["vsphere.core.vm.actions.scheduleUpgradeVmVirtualHardware"]=function(e,t){f.scheduleUpgradeVmHardware(e,t)},h5.actions["vsphere.core.vm.actions.upgradeVirtualHardwareActionCancel"]=function(e,t){f.cancelScheduledVmHardwareUpgrade(e,t)},h5.actions["vsphere.core.provisioning.actions.deployOVF"]=function(e,t){n.showWizard(t[0],a.DEPLOY_VM_FROM_OVF)},h5.actions["vsphere.core.vm.actions.vmMigrate"]=function(e,t,i){return i&&i.dropTarget?void b.retrieveMoveOrMigrateData(i.dropTarget,t).then(function(t){t.moveVms.length>0&&D.moveVms(t.moveVms,{dropTarget:t.moveTarget},e),t.migrateVms.length>0&&s.showWizard(t.migrateVms,{
dropTarget:t.migrateTarget},e)}):void s.showWizard(t,i,e)},h5.actions["vsphere.core.vm.actions.move"]=function(e,t,i){D.moveVms(t,i,e)},h5.actions["vsphere.core.vm.actions.dragAndDrop"]=function(e,t,i){b.moveOrMigrateVm(t,i)},h5.actions["vsphere.core.vm.actions.unregisterAction"]=function(e,t){I.unregisterVms(t)},h5.actions["vsphere.core.vm.actions.unregisterVmTemplateAction"]=function(e,t){I.unregisterVms(t)},h5.actions["vsphere.core.vm.actions.turnOffFt"]=function(e,t){_.turnOffFt(t)},h5.actions["vsphere.core.vm.actions.deleteAction"]=function(e,t){I.deleteVms(t)},h5.actions["vsphere.core.vm.actions.deleteTemplateAction"]=function(e,t){I.deleteVms(t)},h5.actions["vsphere.core.vm.actions.create"]=function(e,t){if(e.additionalData&&e.additionalData.isScheduledTask){var i={isScheduledTask:!!e.additionalData&&e.additionalData.isScheduledTask,schedulingData:e.additionalData?e.additionalData.schedulingData:null};n.showWizard(t[0],a.CREATE_FROM_SCRATCH,i)}else n.showWizard(t[0],a.CREATE_FROM_SCRATCH)},h5.actions["vsphere.core.vm.actions.registerVm"]=function(e,t,i){n.showWizard(t[0],a.REGISTER_VM,i)},h5.actions["vsphere.core.vm.gos.customization.new"]=function(e,t,i){var r=i.onActionInvoked;T.open(r,i.gosCustomizationSpecs)},h5.actions["vsphere.core.vm.gos.customization.edit"]=function(e,t,i){var r={specInfo:i.gosCustomizationSpecInfo,specDetails:i.gosCustomizationSpecDetails,allSpecs:i.gosCustomizationSpecs,onActionInvoked:i.onActionInvoked,iconClass:e.action.icon};E.open(r)},h5.actions["vsphere.core.vm.gos.customization.export"]=function(e,t,i){var r=i.gosCustomizationSpecInfo.name+".xml";V.save(i.gosCustomizationSpecXmlText,r)},h5.actions["vsphere.core.vm.gos.customization.delete"]=function(e,t,i){var r=i.gosCustomizationSpecInfo,n=i.onActionInvoked,o=e.action.confirmationTitle,a=e.action.confirmationText;return M.confirmDelete(o,a).then(function(){return M["delete"](r).then(function(e){n&&n("vsphere.core.vm.gos.customization.delete",e)})},function(){n("vsphere.core.vm.gos.customization.delete")})},h5.actions["vsphere.core.vm.gos.customization.duplicate"]=function(e,t,i){var r=i.gosCustomizationSpecInfo,n=i.gosCustomizationSpecs,o=i.onActionInvoked;return O.openDuplicateForm(r,n).then(function(e){o&&o("vsphere.core.vm.gos.customization.duplicate",e.result,e.openSpecForEdit)})},h5.actions["vsphere.core.vm.gos.customization.import"]=function(e,t,i){return A.openImportModal(i.gosCustomizationSpecs).then(function(e){var t=i.onActionInvoked;t&&i.onActionInvoked("vsphere.core.vm.gos.customization.import",e.result,e.invokeEdit)})},h5.actions["vsphere.core.vm.actions.vappOptions.edit"]=function(e,t,i){F.get("vcVappOptionsEditActionService").editVappOptions(t[0])},h5.actions["vsphere.core.vm.actions.viewOvfEnvironment"]=function(e,t,i){e.available&&t&&t.length&&F.get("vcVappViewOvfEnironmentService").showOvfEnvironment(t[0])},h5.actions["vsphere.core.vm.tpm.export"]=function(e,t,i){if(i&&i.algorithmName){var r=i.issuerName?".cer":".csr",n=i.algorithmName+r;V.save(i.rawData,n)}},h5.actions["vsphere.core.vm.actions.turnOnFt"]=function(e,t){k.openVmFaultToleranceWizard(t[0])},h5.actions["vsphere.core.vm.actions.resumeFt"]=function(e,t){k.resumeFaultTolerance(t[0])},h5.actions["vsphere.core.vm.actions.suspendFt"]=function(e,t){k.suspendFaultTolerance(t[0])},h5.actions["vsphere.core.vm.actions.migrateSecondaryFtVm"]=function(e,t){k.migrateSecondaryFtVm(t[0])},h5.actions["vsphere.core.vm.actions.testFailover"]=function(e,t){k.ftTestFailover(t[0])},h5.actions["vsphere.core.vm.actions.restartSecondary"]=function(e,t){k.ftRestartSecondary(t[0])}}])}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").run(["$templateCache",function(e){e.put("vm-ui/resources/vm/views/settings/vmEditSettings.html",'<div class="flexbox-column" tabindex="0">\n   <vx-activity-indicator size="large" is-visible="loading"></vx-activity-indicator>\n\n   <div ng-if="!!alertOptions && alertOptions.isVisible"\n        class="alert" ng-class="alertOptions.class">\n      <div class="alert-items">\n         <div class="alert-item">\n            <div class="alert-icon-wrapper">\n               <clr-icon class="alert-icon" ng-attr-shape="{{alertOptions.iconShape}}"></clr-icon>\n            </div>\n            <span class="alert-text">{{alertOptions.text}}</span>\n         </div>\n      </div>\n   </div>\n\n   <clr-tabs (clr-tabs-current-tab-link-changed)="onTabSelected($event)"\n             (clr-tabs-current-tab-index-changed)="onTabIndexChanged($event)"\n             (clr-tabs-current-tab-content-changed)="onTabContentActivated($event)"\n             ng-if="hardwareConfigData">\n      <clr-tab-link autofocus><span>{{::i18n(\'VmUi\', \'VmConfigControl.virtual_hardware\')}}</span></clr-tab-link>\n      <clr-tab-link ng-if="!deployVmtx"><span>{{::i18n(\'VmUi\', \'VmConfigControl.vm_options\')}}</span></clr-tab-link>\n\n      <clr-tab-content clr-tab-content-id="content1" clr-tab-content-active="true" class="vm-edit-settings-content">\n         <vm-hardware-settings></vm-hardware-settings>\n      </clr-tab-content>\n      <clr-tab-content clr-tab-content-id="content2" class="vm-edit-settings-content vm-options-content">\n         <vm-options ng-if="showVmOptions"></vm-options>\n      </clr-tab-content>\n   </clr-tabs>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmEditVappOptionsPage.html",'<!--Copyright 2018 VMware, Inc. All rights reserved. -- VMware Confidential-->\n<!-- this is how we must pass the value to the NG2 component,\n        otherwise we get the string `_route.objectId` as value of the vmId input-->\n<legacy-vapp-options-view\n      vm-id="_route.objectId">\n   </legacy-vapp-options-view>'),e.put("vm-ui/resources/vm/views/settings/vmHardwareEdit.html","<div vm-edit-settings></div>"),e.put("vm-ui/resources/vm/views/settings/vmHardwareModal.html",'<clr-modal\n   [clr-modal-static-backdrop]="true"\n   [(clr-modal-open)]="modalOptions.modalOpen"\n   [clr-modal-size]="\'lg\'"\n   [clr-modal-closable]="true"\n   class="VmHardwareModal body-overflow-hidden"\n   has-modal-button-group>\n   <h3 class="modal-title" modal-title\n       primary-title="modalOptions.title"\n       secondary-title="modalOptions.secondaryTitle"></h3>\n   <div class="modal-body edit-modal">\n      <vm-edit-settings></vm-edit-settings>\n   </div>\n\n   <div class="modal-footer" ng-hide="config.loading">\n      <button type="button" class="btn btn-outline" ng-click="closeModal()">\n         {{::i18n(\'Common\',\'cancelButtonLabel\')}}\n      </button>\n      <button type="button" class="btn btn-primary" ng-disabled="!isInputStateValid()" ng-click="save()">\n         {{::i18n(\'Common\',\'saveButtonLabel\')}}\n      </button>\n   </div>\n</clr-modal>\n'),e.put("vm-ui/resources/vm/views/settings/vmSdrsRulesPage.html","<vsc-vm-sdrs-rules></vsc-vm-sdrs-rules>"),e.put("vm-ui/resources/vm/views/settings/vmOptions/vmOptions.html",'<clr-stack-view class="clr-component vm-stack-view"\n                  ng-if="!config.loading"\n                  ng-form name="vmOptionsForm"\n                  vx-refreshable watch-objects=\'{{ctrl.vmId}}\'>\n   <general-options\n      config="hardwareConfigData.vmConfigContext.config"\n      vm-id="ctrl.vmId"\n      vm-config-context="hardwareConfigData.vmConfigContext"\n      guest-os-descriptor="hardwareConfigData.guestOsFamilyKey"\n      vm-params="vmParams"\n      modal-options="modalOptions"\n      expanded="ctrl.stackBlocksExpandedState.generalOptions">\n   </general-options>\n   <vsc-vmrc-options\n      [vm-config-context]="hardwareConfigData.vmConfigContext"\n      [vm-workflow-mode]="vmOptionsController.workflow"\n      [(is-stack-expanded)]="ctrl.stackBlocksExpandedState.vmrcOptions">\n   </vsc-vmrc-options>\n   <encryption-options\n      workflow-mode="vmOptionsController.workflow"\n      vm-storage-profile="vmOptionsController.vmStorageProfile"\n      storage-profiles="vmOptionsController.storageProfiles"\n      vm-storage-profile-assignments="vmOptionsController.vmStorageProfileAssignments"\n      hard-disks="vmOptionsController.hardDisks"\n      vm-config-context="hardwareConfigData.vmConfigContext"\n      datacenter-id="wizardViewData ? wizardViewData.getDatacenterId() : undefined"\n      on-alert="vmOptionsController.onAlert(options)"\n      does-tpm-exist="vmOptionsController.doesTPMExist()"\n      expanded="ctrl.stackBlocksExpandedState.encryptionOptions">\n   </encryption-options>\n   <standby-options\n      vm-workflow-mode="vmOptionsController.workflow"\n      vm-config-context="hardwareConfigData.vmConfigContext"\n      options="hardwareConfigData.vmConfigContext.config.defaultPowerOps"\n      on-change="vmOptionsController.onStandbyOptionsChange(standbyAction)"\n      network-devices="vmOptionsController.networkAdapterDevices"\n      expanded="ctrl.stackBlocksExpandedState.standbyOptions">\n   </standby-options>\n   <vmware-tools\n      vm-workflow-mode="vmOptionsController.workflow"\n      vm-default-power-operations="hardwareConfigData.vmConfigContext.config.defaultPowerOps"\n      vm-tools-options="hardwareConfigData.vmConfigContext.config.tools"\n      vm-power-state="hardwareConfigData.vmConfigContext.environment.powerState"\n      vm-tools-capabilities="hardwareConfigData.vmConfigContext.environment.configOption.capabilities"\n      vm-has-config-settings-privilege="vmOptionsController.hasVmConfigSettingsPrivilege()"\n      on-change="vmOptionsController.onVmwareToolsChange(vmToolsOptions)"\n      expanded="ctrl.stackBlocksExpandedState.vmwareTools">\n   </vmware-tools>\n   <vbs config-flags="hardwareConfigData.vmConfigContext.config.flags"\n         guest-os-descriptor="hardwareConfigData.vmConfigContext.environment.configOption.guestOSDescriptor[0]"\n         on-vbs-update="vmOptionsController.onVbsUpdate(vbsEnabled)"\n         visible="vmOptionsController.vbsVisible()"\n         vm-powered-on="vmOptionsController.isVmPoweredOn()">\n   </vbs>\n   <boot-options\n         vm-workflow-mode="vmOptionsController.workflow"\n         vm="hardwareConfigData.vm"\n         vm-config-context="hardwareConfigData.vmConfigContext"\n         on-bootoptions-update="vmOptionsController.onBootOptionsChanged(updatedModel)"\n         on-firmware-update="vmOptionsController.onFirmwareSelectionChanged(newFirmware)"\n         vbs-enabled="vmOptionsController.vbsEnabled"\n         vbs-properties="vmOptionsController.vbsProperties"\n         does-tpm-exist="vmOptionsController.doesTPMExist()"\n         expanded="ctrl.stackBlocksExpandedState.bootOptions">\n   </boot-options>\n   <vm-advanced-options\n      vm-workflow-mode="vmOptionsController.workflow"\n      advanced-options="hardwareConfigData.vmConfigContext.config.flags"\n      swap-placement-type="hardwareConfigData.vmConfigContext.config.swapPlacement"\n      vm-config-context="hardwareConfigData.vmConfigContext"\n      expanded="ctrl.stackBlocksExpandedState.vmAdvancedOptions">\n   </vm-advanced-options>\n\n   <vsc-vm-hw-npiv\n      [vm-config-context]="hardwareConfigData.vmConfigContext"\n      [vm-workflow-mode]="vmOptionsController.workflow"\n      [(expanded)]="ctrl.stackBlocksExpandedState.vmHwNpiv">\n   </vsc-vm-hw-npiv>\n\n</clr-stack-view>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareSettings.html",'<div class="vertical-flex-container flex-1 vm-edit-hardware" ng-form name="hardwareForm">\n\n      <div id="vmEditHardwareAddDevices" class="flex-row vm-edit-add-devices modal-button-group flex-shrink-0"\n            ng-hide="config.loading" style="height:24px;">\n         <button type="button" class="btn btn-sm btn-outline"\n               ng-disabled="!ctrl.isAddDeviceMenuEnabled()"\n               ng-click="ctrl.toggleAddDevicesMenu()">\n            {{i18n(\'VmUi\', \'VmDeviceManager.AddNewDevice\')}}\n         </button>\n         <div vx-menu="ctrl.addDevicesMenuConfig"></div>\n      </div>\n      <div vui-validation-banner="ctrl.banner" class="flex-shrink-0"></div>\n\n\n\n         <clr-stack-view class="clr-component vm-stack-view"\n               ng-if="!config.loading"\n               vx-refreshable watch-objects=\'{{ctrl.vmId}}\'\n               refresh=\'ctrl.getVmHardwareData()\'>\n\n            <!--Loads network selector html (from network-ui module) ahead of pages of VM options tab -->\n            <div network-selector/>\n\n            <!-- Encryption -->\n            <clr-stack-block ng-if="ctrl.isVmHomeEncrypted()">\n               <clr-stack-label>\n                  <span>{{::i18n(\'VmUi\', \'VmCryptConfig.encryptionLabel\')}}</span>\n               </clr-stack-label>\n\n               <clr-stack-content>\n                  <span\n                        aria-label="{{i18n(\'VmUi\', \'VmCryptConfig.encryptionLabel\') + \' - \'\n                        + i18n(\'VmUi\', \'VmCryptConfig.vmHomeEncrypted\') }}">\n                     {{::i18n(\'VmUi\', \'VmCryptConfig.vmHomeEncrypted\')}}\n                  </span>\n                  <vsc-sign-post\n                        [sign-post-content]="::i18n(\'VmUi\', \'VmCryptConfig.VmHomeEncryptTip\')"\n                        [sign-post-position]="\'bottom-left\'">\n                  </vsc-sign-post>\n               </clr-stack-content>\n            </clr-stack-block>\n\n            <vm-hardware-cpu\n               vm-workflow-mode="ctrl.vmWorkflowMode"\n               create-mode="ctrl.createMode"\n               deploy-vmtx-mode="ctrl.deployVmtxMode"\n               original-config="ctrl.originalConfig"\n               vm="ctrl.vmConfig"\n               vm-config-context="ctrl.vmConfigContext"\n               vbs-enabled="ctrl.vmConfigContext.config.flags.vbsEnabled"\n               expanded="ctrl.stackBlocksExpandedState.cpu">\n            </vm-hardware-cpu>\n\n            <vm-hardware-memory\n                  vm="ctrl.vmConfig"\n                  vm-config-context="ctrl.vmConfigContext"\n                  original-config="ctrl.originalConfig"\n                  selected-guest-os="ctrl.selectedGuestOs"\n                  create-mode="ctrl.createMode"\n                  deploy-vmtx-mode="ctrl.deployVmtxMode"\n                  expanded="ctrl.stackBlocksExpandedState.memory">\n            </vm-hardware-memory>\n\n            <vm-hardware-virtual-nvdimm\n                  ng-repeat="virtualNvdimm in ctrl.virtualMachineDevices\n                        .existingDevicesOfType(\'VirtualNVDIMM\')\n                        track by virtualNvdimm.getKey()"\n                  vm-workflow-mode="ctrl.vmWorkflowMode"\n                  nvdimm-device="virtualNvdimm"\n                  remove-callback="ctrl.removeDevice"\n                  vm-config-context="ctrl.vmConfigContext"\n                  ng-if="!ctrl.deployVmtxMode"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  selected-guest-os="ctrl.selectedGuestOs">\n            </vm-hardware-virtual-nvdimm>\n\n            <vm-hardware-virtual-nvdimm\n                  ng-repeat="virtualNvdimm in ctrl.virtualMachineDevices\n                     .newDevicesOfType(\'VirtualNVDIMM\')\n                     track by virtualNvdimm.getKey()"\n                  vm-workflow-mode="ctrl.vmWorkflowMode"\n                  nvdimm-device="virtualNvdimm"\n                  remove-callback="ctrl.removeDevice"\n                  vm-config-context="ctrl.vmConfigContext"\n                  ng-if="!ctrl.deployVmtxMode"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  selected-guest-os="ctrl.selectedGuestOs">\n            </vm-hardware-virtual-nvdimm>\n\n            <vm-hardware-nvdimm-controller\n                  ng-repeat="virtualNvdimmController in ctrl.virtualMachineDevices\n                     .devicesOfType(\'VirtualNVDIMMController\')\n                     track by virtualNvdimmController.getKey()"\n                  vm-workflow-mode="ctrl.vmWorkflowMode"\n                  nvdimm-controller-device="virtualNvdimmController"\n                  remove-callback="ctrl.removeDevice"\n                  vm-config-context="ctrl.vmConfigContext"\n                  ng-if="!ctrl.deployVmtxMode"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  selected-guest-os="ctrl.selectedGuestOs">\n            </vm-hardware-nvdimm-controller>\n\n            <!-- HDD grouping -->\n            <div class="stack-view"\n                  style="height: auto"\n                  ng-if="ctrl.isDiskGroupingRequired()">\n               <div class="stack-block stack-block-expandable vm-hardware-grouped-disks-block"\n                        ng-class="{\'stack-block-expanded\': ctrl.hardDisksStackExpanded}">\n                  <dt class="stack-block-label" ng-click="ctrl.hardDisksStackClicked()">{{i18n(\'VmUi\', \'DiskPage.groupedMode.label\')}}</dt>\n                  <dd class="stack-block-content" ng-click="ctrl.hardDisksStackClicked()">{{ctrl.totalHardDiskSizeText}}</dd>\n                  <div class="stack-children" ng-if="ctrl.hardDisksStackExpanded">\n                     <div class="stack-block"\n                           ng-repeat="virtualDiskDeviceEmbedded in ctrl.getSortedVirtualDisks()\n                                        track by virtualDiskDeviceEmbedded.getKey()">\n\n                        <div ng-if="ctrl.isNotRDMDisk(virtualDiskDeviceEmbedded)">\n                           <vm-hardware-virtual-disk class="virtual-disk-embedded"\n                                 inflated-device="virtualDiskDeviceEmbedded"\n                                 create-mode="ctrl.createMode"\n                                 clone-mode="ctrl.cloneMode"\n\t\t\t\t\t\t\t\t deploy-vmtx-mode="ctrl.deployVmtxMode"\n                                 vm-config-context="ctrl.vmConfigContext"\n                                 vm-storage-id="{{::ctrl.vmStorageId}}"\n                                 vm-assignments-properties="ctrl.vmAssignmentsProperties"\n                                 compute-resource-id="ctrl.computeResourceId"\n                                 vm-home-replication-group="ctrl.vmHomeReplicationGroup"\n                                 selected-storage-profile="ctrl.selectedStorageProfile"\n                                 selected-disk-format="ctrl.selectedDiskFormat"\n                                 storage-baseline-id="ctrl.storageBaselineId"\n                                 get-advanced-configuration-for-disk="ctrl.getAdvancedConfigurationForDisk(virtualDiskDeviceEmbedded)"\n                                 storage-profiles="ctrl.storageProfiles"\n                                 is-vm-encrypted="ctrl.isVmEncrypted"\n                                 virtual-machine-devices="ctrl.virtualMachineDevices"\n                                 can-choose-disk-location="ctrl.canChooseDiskLocation"\n                                 storage-locator-items-data="ctrl.storageLocatorItemsData"\n                                 remove-callback="ctrl.removeDevice"\n                                 vm-id="ctrl.vmId"\n                                 show-storage-pods="!ctrl.isXVc"\n                                 expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualDiskDeviceEmbedded.getKey()]"\n                                 keep-existing-profile-assignments="ctrl.keepExistingProfileAssignments"\n                                 is-grouping-hard-disks="true"\n                           ></vm-hardware-virtual-disk>\n                        </div>\n                        <div ng-if="!ctrl.isNotRDMDisk(virtualDiskDeviceEmbedded)">\n                           <vm-hardware-rdm-virtual-disk class="virtual-disk-embedded"\n                                 vm-workflow-mode="ctrl.vmWorkflowMode"\n                                 display-mode="3"\n                                 inflated-device="virtualDiskDeviceEmbedded"\n                                 vm-storage-id="{{::ctrl.vmStorageId}}"\n                                 vm-config-context="ctrl.vmConfigContext"\n                                 virtual-machine-devices="ctrl.virtualMachineDevices"\n                                 get-storage-for-disk="ctrl.getStorageForDisk(diskKey)"\n                                 storage-profiles="ctrl.storageProfiles"\n                                 selected-storage-profile="ctrl.selectedStorageProfile"\n                                 storage-locator-items-data="ctrl.storageLocatorItemsData"\n                                 vm-assignments-properties="ctrl.vmAssignmentsProperties"\n                                 compute-resource-id="ctrl.computeResourceId"\n                                 vm-home-replication-group="ctrl.vmHomeReplicationGroup"\n                                 remove-callback="ctrl.removeDevice"\n                                 vm-id="ctrl.vmId"\n                                 show-storage-pods="!ctrl.isXVc"\n                                 expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualDiskDeviceEmbedded.getKey()]"\n                                 is-grouping-hard-disks="true"\n                           ></vm-hardware-rdm-virtual-disk>\n                        </div>\n                     </div>\n                  </div>\n               </div>\n            </div>\n\n             <vm-hardware-virtual-disk ng-if="!ctrl.isDiskGroupingRequired()"\n                        ng-repeat="virtualDiskDevice in ctrl.virtualMachineDevices\n                            .existingDevicesOfType(\'VirtualDisk\')\n                            | filter: ctrl.isNotRDMDisk\n                            track by virtualDiskDevice.getKey()"\n                     inflated-device="virtualDiskDevice"\n                     create-mode="ctrl.createMode"\n                     clone-mode="ctrl.cloneMode"\n                     vm-config-context="ctrl.vmConfigContext"\n                     vm-storage-id="{{::ctrl.vmStorageId}}"\n                     vm-assignments-properties="ctrl.vmAssignmentsProperties"\n                     compute-resource-id="ctrl.computeResourceId"\n                     vm-home-replication-group="ctrl.vmHomeReplicationGroup"\n                     selected-storage-profile="ctrl.selectedStorageProfile"\n                     selected-disk-format="ctrl.selectedDiskFormat"\n                     storage-baseline-id="ctrl.storageBaselineId"\n                     get-advanced-configuration-for-disk="ctrl.getAdvancedConfigurationForDisk(virtualDiskDevice)"\n                     storage-profiles="ctrl.storageProfiles"\n                     is-vm-encrypted="ctrl.isVmEncrypted"\n                     virtual-machine-devices="ctrl.virtualMachineDevices"\n                     can-choose-disk-location="ctrl.canChooseDiskLocation"\n                     storage-locator-items-data="ctrl.storageLocatorItemsData"\n                     remove-callback="ctrl.removeDevice"\n                     vm-id="ctrl.vmId"\n                     show-storage-pods="!ctrl.isXVc"\n                     expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualDiskDevice.getKey()]"\n                     keep-existing-profile-assignments="ctrl.keepExistingProfileAssignments"\n                     is-grouping-hard-disks="false"\n             ></vm-hardware-virtual-disk>\n\n            <!-- TODO refactor vmHardwareController.js to\n            Typescript and use the vm-display-mode.ts instead of the\n            hardcoded value\n            https://www.pivotaltracker.com/story/show/139341171\n               -->\n            <vm-hardware-rdm-virtual-disk ng-if="!ctrl.isDiskGroupingRequired()"\n                  ng-repeat="virtualDiskDevice in ctrl\n                  .virtualMachineDevices\n                  .existingDevicesOfType(\'VirtualDisk\')\n                  | filter: ctrl.isRDMDisk\n                  track by virtualDiskDevice.getKey()"\n               vm-workflow-mode="ctrl.vmWorkflowMode"\n               display-mode="3"\n               inflated-device="virtualDiskDevice"\n               vm-storage-id="{{::ctrl.vmStorageId}}"\n               vm-config-context="ctrl.vmConfigContext"\n               virtual-machine-devices="ctrl.virtualMachineDevices"\n               get-storage-for-disk="ctrl.getStorageForDisk(diskKey)"\n               storage-profiles="ctrl.storageProfiles"\n               selected-storage-profile="ctrl.selectedStorageProfile"\n               storage-locator-items-data="ctrl.storageLocatorItemsData"\n               vm-assignments-properties="ctrl.vmAssignmentsProperties"\n               compute-resource-id="ctrl.computeResourceId"\n               vm-home-replication-group="ctrl.vmHomeReplicationGroup"\n               remove-callback="ctrl.removeDevice"\n               vm-id="ctrl.vmId"\n               show-storage-pods="!ctrl.isXVc"\n               expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualDiskDevice.getKey()]"\n               ng-if="!ctrl.deployVmtxMode"\n            ></vm-hardware-rdm-virtual-disk>\n\n            <vm-hardware-virtual-disk\n                  ng-repeat="virtualDiskDevice in ctrl\n                  .virtualMachineDevices\n                  .newDevicesOfType(\'VirtualDisk\')\n                  | filter: ctrl.isNotRDMDisk\n                   track by virtualDiskDevice.getKey()"\n               inflated-device="virtualDiskDevice"\n               create-mode="ctrl.createMode"\n               clone-mode="ctrl.cloneMode"\n               vm-config-context="ctrl.vmConfigContext"\n               vm-storage-id="{{::ctrl.vmStorageId}}"\n               selected-storage-profile="ctrl.selectedStorageProfile"\n               storage-baseline-id="ctrl.storageBaselineId"\n               get-advanced-configuration-for-disk="ctrl.getAdvancedConfigurationForDisk(virtualDiskDevice)"\n               vm-assignments-properties="ctrl.vmAssignmentsProperties"\n               compute-resource-id="ctrl.computeResourceId"\n               vm-home-replication-group="ctrl.vmHomeReplicationGroup"\n               get-storage-for-disk="ctrl.getStorageForDisk(diskKey)"\n               storage-profiles="ctrl.storageProfiles"\n               is-vm-encrypted="ctrl.isVmEncrypted"\n               virtual-machine-devices="ctrl.virtualMachineDevices"\n               set-storage-for-disk="ctrl.setStorageForDisk(storageInfo, device)"\n               can-choose-disk-location="ctrl.canChooseDiskLocation"\n               storage-locator-items-data="ctrl.storageLocatorItemsData"\n               remove-callback="ctrl.removeDevice"\n               vm-id="ctrl.vmId"\n               show-storage-pods="!ctrl.isXVc"\n               expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualDiskDevice.getKey()]"\n               keep-existing-profile-assignments="ctrl.keepExistingProfileAssignments"\n               autoscrollintoview="clr-stack-block"\n            ></vm-hardware-virtual-disk>\n\n            <vm-hardware-rdm-virtual-disk\n                  ng-repeat="virtualDiskDevice in ctrl\n                  .virtualMachineDevices\n                  .newDevicesOfType(\'VirtualDisk\')\n                  | filter: ctrl.isRDMDisk\n                  track by virtualDiskDevice.getKey()"\n               vm-workflow-mode="ctrl.vmWorkflowMode"\n               display-mode="0"\n               inflated-device="virtualDiskDevice"\n               vm-storage-id="{{::ctrl.vmStorageId}}"\n               vm-storage-object="ctrl.vmStorageObject"\n               vm-config-context="ctrl.vmConfigContext"\n               virtual-machine-devices="ctrl.virtualMachineDevices"\n               get-storage-for-disk="ctrl.getStorageForDisk(diskKey)"\n               storage-profiles="ctrl.storageProfiles"\n               selected-storage-profile="ctrl.selectedStorageProfile"\n               storage-locator-items-data="ctrl.storageLocatorItemsData"\n               set-storage-for-disk="ctrl.setStorageForDisk(storageInfo, device)"\n               vm-assignments-properties="ctrl.vmAssignmentsProperties"\n               compute-resource-id="ctrl.computeResourceId"\n               vm-home-replication-group="ctrl.vmHomeReplicationGroup"\n               remove-callback="ctrl.removeDevice"\n               is-vm-encrypted="ctrl.isVmEncrypted"\n               vm-id="ctrl.vmId"\n               show-storage-pods="!ctrl.isXVc"\n               expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualDiskDevice.getKey()]"\n               autoscrollintoview="clr-stack-block"\n\t\t\t   ng-if="!ctrl.deployVmtxMode"\n            ></vm-hardware-rdm-virtual-disk>\n\n            <vm-hardware-scsi-controller\n                  create-mode="ctrl.createMode"\n                  inflated-device="virtualScsiDevice"\n                  vm-config-context="ctrl.vmConfigContext"\n                  selected-guest-os="ctrl.selectedGuestOs"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  remove-callback="ctrl.removeDevice"\n                  expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualScsiDevice.getKey()]"\n                  ng-repeat="virtualScsiDevice in ctrl.virtualMachineDevices.existingDevicesOfType(\'VirtualSCSIController\') track by virtualScsiDevice.getKey()"\n                  ng-if="!ctrl.deployVmtxMode">\n            </vm-hardware-scsi-controller>\n\n            <vm-hardware-scsi-controller\n                  create-mode="ctrl.createMode"\n                  vm-config-context="ctrl.vmConfigContext"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  selected-guest-os="ctrl.selectedGuestOs"\n                  ng-if="virtualScsiDevice.getKey() < 0"\n                  inflated-device="virtualScsiDevice"\n                  remove-callback="ctrl.removeDevice"\n                  expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualScsiDevice.getKey()]"\n                  ng-repeat="virtualScsiDevice in ctrl.virtualMachineDevices.newDevicesOfType(\'VirtualSCSIController\') track by virtualScsiDevice.getKey()"\n                  ng-if="!ctrl.deployVmtxMode">\n            </vm-hardware-scsi-controller>\n\n            <vm-hardware-network\n                  ng-repeat="virtualNetworkDevice in ctrl.virtualMachineDevices.existingDevicesOfType(\'VirtualEthernetCard\') track by virtualNetworkDevice.getKey()"\n                  virtual-network-device="virtualNetworkDevice"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  network-provider="ctrl.networkProviderId"\n                  available-networks="ctrl.availableNetworks"\n                  network-privilege-map="ctrl.networkPrivilegeMap"\n                  vm-workflow-mode="ctrl.vmWorkflowMode"\n                  selected-guest-os="ctrl.selectedGuestOs"\n                  filter-networks-obj-id="ctrl.filterNetworksObjId"\n                  vm-config-context="ctrl.vmConfigContext"\n                  remove-callback="ctrl.removeDevice"\n                  vm-id="ctrl.vmId"\n                  deploy-vmtx-mode="ctrl.deployVmtxMode"\n                  expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualNetworkDevice.getKey()]"\n            ></vm-hardware-network>\n\n            <vm-hardware-network\n                  ng-repeat="virtualNetworkDevice in ctrl.virtualMachineDevices.newDevicesOfType(\'VirtualEthernetCard\') track by virtualNetworkDevice.getKey()"\n                  virtual-network-device="virtualNetworkDevice"\n                  virtual-machine-devices="ctrl.virtualMachineDevices"\n                  network-provider="ctrl.networkProviderId"\n                  available-networks="ctrl.availableNetworks"\n                  network-privilege-map="ctrl.networkPrivilegeMap"\n                  vm-workflow-mode="ctrl.vmWorkflowMode"\n                  selected-guest-os="ctrl.selectedGuestOs"\n                  filter-networks-obj-id="ctrl.filterNetworksObjId"\n                  vm-config-context="ctrl.vmConfigContext"\n                  remove-callback="ctrl.removeDevice"\n                  vm-id="ctrl.vmId"\n                  deploy-vmtx-mode="ctrl.deployVmtxMode"\n                  expanded="ctrl.stackBlocksExpandedState.virtualDevices[virtualNetworkDevice.getKey()]"\n            ></vm-hardware-network>\n\n      <vm-hardware-cdrom\n            ng-repeat="entry in ctrl.virtualMachineDevices.existingDevicesOfType(\'VirtualCdrom\') track by entry.getKey()"\n\t\t\tng-if="!ctrl.deployVmtxMode"\n            inflated-device="entry"\n            create-mode="ctrl.createMode"\n            vm-config-context="ctrl.vmConfigContext"\n            virtual-machine-devices-needed-for-controller-and-node="ctrl.virtualMachineDevices"\n            privileges="ctrl.privileges"\n            merged-inflated-devices="ctrl.mergedInflatedDevices"\n            remove-callback="ctrl.removeDevice"\n            compute-resource-id="{{ctrl.computeResourceId}}"\n            expanded="ctrl.stackBlocksExpandedState.virtualDevices[entry.getKey()]"\n            vm-id="ctrl.vmId"\n      ></vm-hardware-cdrom>\n\n      <vm-hardware-cdrom\n            ng-repeat="entry in ctrl.virtualMachineDevices.newDevicesOfType(\'VirtualCdrom\') track by entry.getKey()"\n            inflated-device="entry"\n            create-mode="ctrl.createMode"\n            vm-config-context="ctrl.vmConfigContext"\n            virtual-machine-devices-needed-for-controller-and-node="ctrl.virtualMachineDevices"\n            merged-inflated-devices="ctrl.mergedInflatedDevices"\n            remove-callback="ctrl.removeDevice"\n            compute-resource-id="{{ctrl.computeResourceId}}"\n            expanded="ctrl.stackBlocksExpandedState.virtualDevices[entry.getKey()]"\n            vm-id="ctrl.vmId"\n\t\t\tng-if="!ctrl.deployVmtxMode"\n      ></vm-hardware-cdrom>\n\n            <vm-hardware-usb-controller ng-repeat="item in ctrl.getUSBControllerList()"\n                 inflated-device="item"\n                 selected-guest-os="ctrl.selectedGuestOs"\n                 remove-callback="ctrl.removeDevice"\n                 vm-config-context="ctrl.vmConfigContext"\n                 virtual-machine-devices="ctrl.virtualMachineDevices"\n                 vm-workflow-mode="ctrl.vmWorkflowMode"\n                 expanded="ctrl.stackBlocksExpandedState.virtualDevices[item.getKey()]"\n                 ng-if="!ctrl.deployVmtxMode"\n            ></vm-hardware-usb-controller>\n\n            <vm-hardware-usb-device ng-repeat="item in ctrl.getUSBDeviceList()"\n                 ng-if="!ctrl.deployVmtxMode"\n                 inflated-device="item"\n                 selected-guest-os="ctrl.selectedGuestOs"\n                 remove-callback="ctrl.removeDevice"\n                 vm-config-context="ctrl.vmConfigContext"\n                 expanded="ctrl.stackBlocksExpandedState.virtualDevices[item.getKey()]"\n            ></vm-hardware-usb-device>\n\n           <vm-hw-pci-shared ng-repeat="item in ctrl.getPciSharedList()" inflated-device="item"></vm-hw-pci-shared>\n           <vm-hw-pci-device ng-repeat="item in ctrl.getPciDeviceList()" inflated-device="item"></vm-hw-pci-device>\n\n            <vm-hardware-video-card\n               ng-if="!ctrl.deployVmtxMode"\n               inflated-device="ctrl.getInflatedVideoCard()"\n            ></vm-hardware-video-card>\n\n      <vsc-vm-hardware-nvme-controller\n            ng-if="!ctrl.deployVmtxMode"\n            ng-repeat="nvmeDevice in ctrl.virtualMachineDevices.existingDevicesOfType(\'VirtualNVMEController\') track by nvmeDevice.getKey()"\n            [inflated-device]="nvmeDevice"\n            [remove-callback]="ctrl.removeDevice"\n            [power-state]="ctrl.vmConfigContext.environment.powerState"\n            [device-option]="ctrl.nvmeDeviceOption"\n            [workflow-mode]="ctrl.vmWorkflowMode"\n            [privileges]="ctrl.vmConfigContext.privileges"\n            [virtual-machine-devices]="ctrl.virtualMachineDevices"\n      ></vsc-vm-hardware-nvme-controller>\n\n      <vsc-vm-hardware-nvme-controller\n            ng-if="!ctrl.deployVmtxMode"\n            ng-repeat="nvmeDevice in ctrl.virtualMachineDevices.newDevicesOfType(\'VirtualNVMEController\') track by nvmeDevice.getKey()"\n            [inflated-device]="nvmeDevice"\n            [remove-callback]="ctrl.removeDevice"\n            [power-state]="ctrl.vmConfigContext.environment.powerState"\n            [device-option]="ctrl.nvmeDeviceOption"\n            [workflow-mode]="ctrl.vmWorkflowMode"\n            [privileges]="ctrl.vmConfigContext.privileges"\n            [virtual-machine-devices]="ctrl.virtualMachineDevices"\n      ></vsc-vm-hardware-nvme-controller>\n\n            <vm-hardware-tpm\n                    ng-if="!ctrl.deployVmtxMode"\n                    ng-repeat="ITEM in ctrl.getTpmList() track by ITEM.getKey()"\n                    tpm-device="ITEM"\n                    create-mode="ctrl.createMode"\n                    vm-powered-on="ctrl.isVmPoweredOn"\n                    remove-callback="ctrl.removeDevice"\n                    vm-id="ctrl.vmId"\n            ></vm-hardware-tpm>\n\n            <clr-stack-block\n                  ng-if="!ctrl.deployVmtxMode"\n                  ng-repeat="virtualVmciDevice in ctrl.virtualMachineDevices.existingDevicesOfType(\'VirtualVMCIDevice\') track by virtualVmciDevice.getKey()">\n               <clr-stack-label>\n                  <span>{{ ::virtualVmciDevice.getCurrentDevice().deviceInfo.label }}</span>\n               </clr-stack-label>\n               <clr-stack-content aria-label="{{virtualVmciDevice.getCurrentDevice().deviceInfo.label + \' - \'\n                  + virtualVmciDevice.getCurrentDevice().deviceInfo.summary}}"\n               ng-bind="virtualVmciDevice.getCurrentDevice().deviceInfo.summary"/>\n      </clr-stack-block>\n\n      <vsc-vm-hardware-sata-controller\n         ng-if="!ctrl.deployVmtxMode"\n         ng-repeat="sataDevice in ctrl.virtualMachineDevices.existingDevicesOfType(\'VirtualAHCIController\') track by sataDevice.getKey()"\n         [inflated-device]="sataDevice"\n         [remove-callback]="ctrl.removeDevice"\n         [power-state]="ctrl.vmConfigContext.environment.powerState"\n         [device-option]="ctrl.nvmeDeviceOption"\n         [workflow-mode]="ctrl.vmWorkflowMode"\n         [privileges]="ctrl.vmConfigContext.privileges"\n         [virtual-machine-devices]="ctrl.virtualMachineDevices"\n      ></vsc-vm-hardware-sata-controller>\n\n      <vsc-vm-hardware-sata-controller\n         ng-if="!ctrl.deployVmtxMode"\n         ng-repeat="sataDevice in ctrl.virtualMachineDevices.newDevicesOfType(\'VirtualAHCIController\') track by sataDevice.getKey()"\n         [inflated-device]="sataDevice"\n         [remove-callback]="ctrl.removeDevice"\n         [power-state]="ctrl.vmConfigContext.environment.powerState"\n         [device-option]="ctrl.nvmeDeviceOption"\n         [workflow-mode]="ctrl.vmWorkflowMode"\n         [privileges]="ctrl.vmConfigContext.privileges"\n         [virtual-machine-devices]="ctrl.virtualMachineDevices"\n      ></vsc-vm-hardware-sata-controller>\n\n      <vm-hw-serial-port\n         ng-repeat="item in ctrl.getSerialPortDeviceList() track by item.getKey()"\n         port="item"\n         expanded="ctrl.stackBlocksExpandedState.virtualDevices[item.getKey()]"\n      ></vm-hw-serial-port>\n\n            <vm-hardware-other ng-if="!ctrl.deployVmtxMode"></vm-hardware-other>\n         </clr-stack-view>\n\n   <span class="vm-hardware-version flex-shrink-0"\n         ng-show="ctrl.createMode">{{ ctrl.vmVersion }}</span>\n\n</div>\n'),
e.put("vm-ui/resources/vm/views/settings/vmOptions/bootOptions/boot-options-firmware-help-text.html","<div>\n   <p>\n      {{i18n('VmUi', 'VmCpu.bootOptions.firmware.Description')}}\n   </p>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmOptions/bootOptions/boot-options-secureBoot-help-text.html","<div>\n   <p>\n      {{i18n('VmUi', 'VmCpu.bootOptions.secureBoot.Description')}}\n   </p>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmOptions/bootOptions/bootOptions.html",'<clr-stack-block\n        ng-form\n        name="bootOptions"\n        class="boot-options"\n        [(clr-sb-expanded)] = "$ctrl.expanded">\n    <clr-stack-label>\n        {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.title\') }}\n    </clr-stack-label>\n\n    <clr-stack-content>\n        <div ng-if="!$ctrl.expanded">\n         {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.expand\') }}\n      </div>\n      <div ng-if="$ctrl.expanded">\n      </div>\n    </clr-stack-content>\n\n    <!-- Firmware Selection -->\n    <clr-stack-block>\n        <clr-stack-label>\n            {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.firmware\') }}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            <div class="select">\n                <select name="firmwareSelect"\n                        aria-label="{{$ctrl.i18n(\'VmUi\', \'BIOSOptions.firmware\')}}"\n                        data-test-id="firmwareSelect"\n                        ng-model="$ctrl.firmware"\n                        ng-options="option.id as option.displayName for option in $ctrl.viewModel.firmwareList"\n                        ng-disabled="$ctrl.isFirmwareDisabled()"></select>\n            </div>\n            <a ng-if="$ctrl.isVbsEnabled()"\n               vui-sign-post=\'$ctrl.signFirmwarePostParams\'\n               class=\'pull-right\'><img\n               ng-src="{{::$ctrl.i18n(\'CommonImages\', \'info\')}}"></a>\n\n           <clr-alert ng-if="$ctrl.viewModel.firmwareWarningFlag"\n                      [clr-alert-closable]="true"\n                      clr-alert-type="warning" [clr-alert-size-small]="true"\n                      data-test-id="firmwareWarning">\n              <clr-alert-item>\n                 <span class="alert-text" ng-bind="::$ctrl.i18n(\'VmUi\', \'BIOSOptions.firmware.warning\')"></span\n              </clr-alert-item>\n           </clr-alert>\n\n           <clr-alert ng-if="$ctrl.showFirmwareCompatibilityWarning()"\n                     [clr-alert-closable]="true"\n                     clr-alert-type="warning" [clr-alert-size-small]="true"\n                     data-test-id="firmwareCompatibilityWarning">\n               <clr-alert-item>\n                  <span class="alert-text"\n                        ng-bind="::$ctrl.getString(\'BIOSOptions.firmware.noncompatible.warning\')"></span>\n               </clr-alert-item>\n           </clr-alert>\n\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <!-- Secure Boot -->\n    <clr-stack-block ng-if="$ctrl.isSecureBootAllowed()">\n        <clr-stack-label>\n            {{ $ctrl.i18n(\'VmUi\', \'BIOSOptions.secureBoot.Title\') }}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            <input type="checkbox"\n                   name="efiSecureBootEnabledCheckbox"\n                   data-test-id="secureBoot"\n                   ng-model="$ctrl.viewModel.efiSecureBootEnabled"\n                   ng-disabled="$ctrl.isVbsEnabled()"\n                   ng-change="$ctrl.onPropertyChanged()"/>\n            <span ng-class="{\'div-disabled\': $ctrl.isVbsEnabled()}">\n                {{ $ctrl.i18n(\'VmUi\', \'BIOSOptions.secureBoot.Enable\') }}</span>\n            <a ng-if="$ctrl.isVbsEnabled()"\n               vui-sign-post=\'$ctrl.signSecureBootPostParams\'\n               class=\'pull-right\'><img\n                    ng-src="{{::$ctrl.i18n(\'CommonImages\', \'info\')}}"></a>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <!-- Boot Delay -->\n    <clr-stack-block ng-if="$ctrl.viewModel.bootOptionsSupported">\n        <clr-stack-label>\n            {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.delay\') }}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            <span ng-class="{\'div-disabled\': $ctrl.viewModel.bootDelayEditDisabled}">\n                {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.delay.description\') }}\n            </span>\n            <div>\n                <input type=\'number\'\n                       name="bootDelayNumeric"\n                       min={{$ctrl.viewModel.bootDelayMin}}\n                       max={{$ctrl.viewModel.bootDelayMax}}\n                       step={{$ctrl.viewModel.bootDelayStep}}\n                       ng-model-options="{ updateOn: \'blur\' }"\n                       ng-model="$ctrl.viewModel.bootDelay"\n                       ng-disabled="$ctrl.viewModel.bootDelayEditDisabled"\n                       ng-change="$ctrl.onPropertyChanged()"\n                       aria-label="{{$ctrl.i18n(\'VmUi\', \'BIOSOptions.delay.description\')}}"\n                       required/>\n                <span ng-class="{\'div-disabled\': $ctrl.viewModel.bootDelayEditDisabled}"\n                      class="inline-block">{{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.delay.ms\') }}\n                </span>\n            </div>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <!-- Force BIOS/EFI Options -->\n    <clr-stack-block ng-if="$ctrl.viewModel.bootOptionsSupported">\n        <clr-stack-label>\n            {{ ::$ctrl.getString(\'BIOSOptions.force\', $ctrl.viewModel.firmwareSelection.id) }}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            <input type="checkbox"\n                   name="forceSetupCheckbox"\n                   ng-model="$ctrl.viewModel.enterBIOSSetup"\n                   ng-disabled="$ctrl.viewModel.isEnterBIOSSetupEditDisabled"\n                   ng-change="$ctrl.onPropertyChanged()"/>\n            <span ng-class="{\'div-disabled\': $ctrl.viewModel.isEnterBIOSSetupEditDisabled}">\n                {{ ::$ctrl.getString(\'BIOSOptions.force.description\', $ctrl.viewModel.firmwareSelection.id) }}\n            </span>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <!-- BOOT Recovery -->\n    <clr-stack-block ng-if="$ctrl.viewModel.bootRetryOptionsSupported">\n        <clr-stack-label ng-attr-title="{{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.recovery\') }}">\n            {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.recovery\') }}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            <input class="inline-block"\n                   type="checkbox"\n                   name="retryDelayCheckbox"\n                   id="chkBxRecovery"\n                   ng-model="$ctrl.viewModel.bootRetryEnabled"\n                   ng-disabled="$ctrl.viewModel.bootRetryEditDisabled"\n                   ng-change="$ctrl.onPropertyChanged()"/>\n            <span ng-class="{\'div-disabled\': $ctrl.viewModel.bootRetryEditDisabled}">\n                {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.recovery.description\') }}\n            </span>\n            <div>\n                <input type="number"\n                       name="retryDelayNumeric"\n                       ng-disabled="$ctrl.isBootRetryDelayEditDisabled()"\n                       min="{{$ctrl.viewModel.retryDelayMin}}"\n                       max="{{$ctrl.viewModel.retryDelayMax}}"\n                       ng-model-options="{ updateOn: \'blur\' }"\n                       ng-model="$ctrl.viewModel.bootRetryDelay"\n                       aria-label="{{$ctrl.i18n(\'VmUi\', \'BIOSOptions.recovery.description\')}}"\n                       ng-change="$ctrl.onPropertyChanged()"/>\n                <span ng-class="{\'div-disabled\': $ctrl.isBootRetryDelayEditDisabled()}">\n                    {{ ::$ctrl.i18n(\'VmUi\', \'BIOSOptions.recovery.seconds\') }}\n                </span>\n            </div>\n        </clr-stack-content>\n    </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmOptions/encryption/encryption-options.html",'<clr-stack-block\n   ng-form\n   name="vm-encryption-options"\n   class="vm-encryption-options"\n   [(clr-sb-expanded)]="$ctrl.expanded"\n   (clr-sb-expanded-change)="$ctrl.expandedChanged($event)"\n>\n\n   <clr-stack-label>\n      {{::$ctrl.i18n(\'VmCryptConfig.encryptionLabel\')}}\n   </clr-stack-label>\n\n   <clr-stack-content>\n      {{::$ctrl.i18n(\'VmCryptConfig.vMotion.Expand\')}}\n   </clr-stack-content>\n\n   <clr-stack-block ng-if="$ctrl.displayEncryptVmBlock()">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmCryptConfig.encryptVM\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div ng-disabled="!!$ctrl.canNotEncryptReason || $ctrl.isVmPoweredOn()"\n              ng-class="{\'div-disabled\': !!$ctrl.canNotEncryptReason || $ctrl.isVmPoweredOn()}">\n            <div ng-if="!$ctrl.canChangeVmHomePolicy">\n               <div ng-if="$ctrl.isVmHomeEncrypted()">\n                  <span>{{$ctrl.vmStorageProfile.label}}</span>\n                  <vsc-sign-post [sign-post-position]="\'bottom-left\'"\n                                 [sign-post-content]="$ctrl.i18n(\'VmCryptConfig.VmHomeEncryptTip\')">\n                  </vsc-sign-post>\n               </div>\n               <div ng-if="!$ctrl.isVmHomeEncrypted()">\n                  <span>{{$ctrl.i18n("VmCryptConfig.vmHomeNoEncrypted")}}</span>\n               </div>\n            </div>\n\n            <div class="flex-row" ng-if="$ctrl.canChangeVmHomePolicy">\n               <storage-profile-menu\n                       class="storage-profile-menu-as-select"\n                       [selected-storage-profile]="$ctrl.selectedEncryptionProfile"\n                       [storage-profiles]="$ctrl.encryptionProfiles"\n                       [group-profiles]="false"\n                       [aria-label]="$ctrl.i18n(\'VmCryptConfig.encryptVM\')"\n                       (on-change)="$ctrl.onStorageProfileChanged($event)">\n               </storage-profile-menu>\n               <div class="can-not-encrypt-reason" ng-if="$ctrl.canNotEncryptReason">\n                  ({{$ctrl.canNotEncryptReason}})\n               </div>\n            </div>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.displayEncryptVmDisksBlock()">\n      <clr-stack-label>\n      </clr-stack-label>\n      <clr-stack-content>\n         <div ng-disabled="!$ctrl.canEncryptHdds || $ctrl.isVmPoweredOn()"\n              ng-class="{\'div-disabled\': !$ctrl.canEncryptHdds || $ctrl.isVmPoweredOn()}">\n            <div ng-repeat="disk in $ctrl.hardDisks track by $index"\n                 class="checkbox"\n                 ng-disabled="disk.isCreatedFromExistingDisk() || $ctrl.isVmPoweredOn() || disk.isRDMDisk()"\n                 ng-class="{\'div-disabled\': disk.isCreatedFromExistingDisk()\n                      || $ctrl.isVmPoweredOn() || disk.isRDMDisk() }">\n               <input type="checkbox" id="encryptHdd{{$index}}"\n                      ng-disabled="!$ctrl.canEncryptHdds || disk.isCreatedFromExistingDisk() || $ctrl.isVmPoweredOn()\n                           || disk.isRDMDisk()"\n                      ng-checked="$ctrl.hardDiskEncryptionStatuses[$index]"\n                      ng-click="$ctrl.toggleEncryptHardDisk(disk)">\n               <label for="encryptHdd{{$index}}">\n                  {{::$ctrl.i18n(\'VmCryptConfig.DiskPrefix\')}} {{$index}}\n               </label>\n            </div>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmCryptConfig.vMotionMode\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select\n                    ng-options="option as $ctrl.i18n(\'VmCryptConfig.vMotion.\' + option + \'.Text\') for option in $ctrl.encryptedVmotionModes"\n                    ng-model="$ctrl.migrateEncryption"\n                    [attr.aria-label]="$ctrl.i18n(\'VmCryptConfig.vMotionMode\')"\n                    ng-change="$ctrl.onMigrateEncryptionChanged()"\n                    ng-disabled="$ctrl.isVmotionReadOnly()">\n            </select>\n         </div>\n         <vsc-sign-post [sign-post-position]="\'bottom-middle\'"\n                        [sign-post-content-template]="$ctrl.buildSignPostContentVmotion()">\n         </vsc-sign-post>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmOptions/generalOptions/general-options.html",'<clr-stack-block\n   ng-form\n   name="vmGeneralOptions"\n   (clr-sb-expanded-change)="$ctrl.expandedChanged($event)"\n   [(clr-sb-expanded)]="$ctrl.expanded">\n   <clr-stack-label>\n      {{ ::$ctrl.i18n(\'GeneralOptions.title\') }}\n   </clr-stack-label>\n\n   <clr-stack-content>\n      <div ng-if="!$ctrl.expanded">\n         {{ ::$ctrl.i18n(\'GeneralOptions.vm_name_header\') }}\n         <span ng-if="!$ctrl.editMode" class="wrap-content">{{ ::$ctrl.vmName }}</span>\n         <span ng-if="$ctrl.editMode" class="wrap-content">{{ ::$ctrl.config.name }}</span>\n      </div>\n      <div ng-if="$ctrl.expanded"></div>\n   </clr-stack-content>\n\n   <clr-stack-block>\n      <clr-stack-label>{{ ::$ctrl.i18n(\'GeneralOptions.vm_name_body\') }}</clr-stack-label>\n      <clr-stack-content>\n         <span ng-if="!$ctrl.editMode" class="wrap-content">{{ ::$ctrl.vmName }}</span>\n         <input type="text" id= "name"\n                aria-label="{{::$ctrl.ARIA_LBL_NAME}}"\n                ng-model="$ctrl.config.name"\n                ng-if="$ctrl.editMode"\n                ng-disabled="$ctrl.isEditNameDisabled()">\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.editMode">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'GeneralOptions.vm_config_file\') }}</clr-stack-label>\n      <clr-stack-content>\n         {{ ::$ctrl.vmConfigFile }}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.editMode">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'GeneralOptions.vm_work_loc\') }}</clr-stack-label>\n      <clr-stack-content>\n         {{ ::$ctrl.vmWorkingLocation }}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>{{ ::$ctrl.i18n(\'GeneralOptions.gos_family\') }}</clr-stack-label>\n      <clr-stack-content>\n         <select id="gos-family-select" name="gosFamily"\n                 aria-label="{{::$ctrl.ARIA_LBL_GOS_FML}}"\n                 ng-model="$ctrl.gosFamily" ng-change="$ctrl.familyChanged()"\n                 ng-disabled="$ctrl.isEditGOSDisabled()"\n                 ng-options="option as option.name for option in $ctrl.gosFamilyOptions track by option.id">\n         </select>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>{{ ::$ctrl.i18n(\'GeneralOptions.gos_version\') }}</clr-stack-label>\n      <clr-stack-content>\n         <select id="gos-version-select" name="gosVersion"\n                 ng-model="$ctrl.gosVersion"\n                 aria-label="{{::$ctrl.ARIA_LBL_GOS_VER}}"\n                 data-test-id="gosVersionSelect"\n                 ng-change="$ctrl.versionChanged()"\n                 ng-disabled="$ctrl.isEditGOSDisabled()"\n                 ng-options="option as option.name for option in $ctrl.gosVersionOptions track by\n                          option.id">\n         </select>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmOptions/standbyOptions/standby-options.html",'<clr-stack-block\n   ng-form\n   name="vm-standby-options"\n   [(clr-sb-expanded)]="$ctrl.expanded">\n\n   <clr-stack-label>\n      {{::$ctrl.i18n(\'VmStandbyPage.title\')}}\n   </clr-stack-label>\n\n   <clr-stack-content>\n      <div ng-if="!$ctrl.expanded">\n         {{::$ctrl.i18n(\'VmStandbyPage.expand\')}}\n      </div>\n      <div ng-if="$ctrl.expanded">\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmStandbyPage.StandbyResponseLabel\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <span>{{::$ctrl.i18n(\'VmStandbyPage.StandbyResponse\')}}</span>\n         <br/>\n         <label class="normal-weight"\n                ng-class="{\'div-disabled\': $ctrl.isEditSettingsDisabled()}"\n                ng-repeat="option in $ctrl.standbyOptions">\n            <input type="radio"\n                  name="standbyMode"\n                  ng-value="option.value"\n                  aria-label="{{::option.label}}"\n                  ng-model="$ctrl.standbyValue"\n                  ng-disabled="$ctrl.isEditSettingsDisabled()"\n                  ng-change="$ctrl.onStandbyOptionsChange()"\n                  />\n            <span>{{ ::option.label }}</span>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.isWakeOnLanVisible()">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmStandbyPage.WakeOnLAN\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <span>{{::$ctrl.i18n(\'VmStandbyPage.WakeOnTraffic\')}}</span>\n         <br/>\n         <div ng-repeat="(key, device) in $ctrl.expandedDevices" class="inline-label">\n            <label class="normal-weight"\n                   ng-class="{\'div-disabled\': $ctrl.isEditWakeOnLanDisabled(device)}">\n               <input type="checkbox"\n                      aria-label="{{::$ctrl.getDeviceLabel(device)}}"\n                      name="device"\n                      ng-model="$ctrl.wakeOnLanValues[device.key]"\n                      ng-disabled="$ctrl.isEditWakeOnLanDisabled(device)"\n                      ng-change="$ctrl.onWakeOnLanChange(device)"\n               />\n               <span>{{ ::$ctrl.getDeviceLabel(device) }}</span>\n            </label>\n            <span ng-show="!$ctrl.isTypeSupported(device)" class="standby-adapter-label">\n               <span class="standby-adapter-not-supported">\n                     Not supported <!-- do we need a new i18n thing here? -->\n\n                  <!-- using a helper function runs into fun infinite loop digest issues -->\n                  <a vui-sign-post=\'{message: $ctrl.getErrorString(device)}\'>\n                     <img ng-src="{{$ctrl.i18n(\'info\', \'CommonImages\')}}">\n                  </a>\n               </span>\n            </span>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmOptions/vbs/vbs.html",'<clr-stack-block\n      ng-if="$ctrl.visible"\n      ng-form\n      name="vbs">\n   <clr-stack-label>\n      {{ $ctrl.i18n(\'VmUi\', \'VBS.title\') }}\n   </clr-stack-label>\n\n   <clr-stack-content>\n      <div>\n         <label class="normal-weight">\n            <input type="checkbox"\n                   data-test-id="vbsEnabledInput"\n                   ng-model="$ctrl.configFlags.vbsEnabled"\n                   ng-disabled="$ctrl.isDisabled()"\n                   aria-label="{{$ctrl.i18n(\'VmUi\', \'VBS.title\')}}"\n                   ng-change="$ctrl.onPropertyChanged()"/>\n            {{::$ctrl.i18n(\'VmUi\', \'VBS.enable\')}}\n         </label>\n      </div>\n      <div aria-live="polite">\n         <div id="vbsWarningWillTurnOn" class="alert alert-warning alert-sm"\n              ng-if="$ctrl.vbsWillTurnOn">\n            <div class="alert-item">\n               <span class="alert-text">{{$ctrl.i18n(\'VmUi\',\'BIOSOptions.vbs.will.turn.on\')}}</span>\n            </div>\n         </div>\n         <div id="vbsWarningWillTurnOff" class="alert alert-warning alert-sm"\n              ng-if="$ctrl.vbsWillTurnOff">\n            <div class="alert-item">\n               <span class="alert-text">{{$ctrl.i18n(\'VmUi\',\'BIOSOptions.vbs.will.turn.off\')}}</span>\n            </div>\n         </div>\n      </div>\n   </clr-stack-content>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmOptions/vmAdvancedOptions/vmAdvancedOptions.html",'<clr-stack-block\n        ng-form\n        name="ctrl.vmAdvancedOptions"\n        [(clr-sb-expanded)]="ctrl.expanded">\n    <clr-stack-label>\n        {{ ::ctrl.LBL_TITLE }}\n    </clr-stack-label>\n\n    <clr-stack-content>\n        <div ng-if="!ctrl.expanded">\n            {{ ::ctrl.LBL_EXPAND}}\n        </div>\n        <div ng-if="ctrl.expanded"></div>\n    </clr-stack-content>\n\n    <clr-stack-block>\n        <clr-stack-label>{{ ::ctrl.LBL_SETTINGS }}</clr-stack-label>\n        <clr-stack-content>\n            <label ng-class="{\'div-disabled\': ctrl.isDisableAccelerationDisabled()}"\n                  class="normal-weight"\n                  title="{{::ctrl.LBL_ACCEL}}">\n                <input name="disable-acceleration"\n                       aria-label="{{::ctrl.LBL_ACCEL}}"\n                       ng-disabled="ctrl.isDisableAccelerationDisabled()"\n                       type="checkbox"\n                       ng-model="ctrl.advancedOptions.disableAcceleration">\n                {{::ctrl.LBL_ACCEL}}\n            </label>\n            <br>\n            <label ng-class="{\'div-disabled\': ctrl.isEnableLoggingDisabled()}"\n                  class="normal-weight"\n                  title="{{::ctrl.LBL_LOGGING}}">\n                <input name="logging"\n                       aria-label="{{::ctrl.LBL_LOGGING}}"\n                       type="checkbox"\n                       ng-disabled="ctrl.isEnableLoggingDisabled()"\n                       ng-model="ctrl.advancedOptions.enableLogging">\n                {{::ctrl.LBL_LOGGING}}\n            </label>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block>\n        <clr-stack-label>{{ ::ctrl.LBL_MONITOR }}\n        </clr-stack-label>\n        <clr-stack-content>\n            <div class="select">\n                <select data-test-id="monitor-type-id"\n                   aria-label="{{::ctrl.LBL_MONITOR}}"\n                   ng-disabled="ctrl.isEditMonitorTypeDisabled()"\n                   ng-model="ctrl.advancedOptions.monitorType"\n                   ng-options="item as ctrl.getMonitorTypeLabel(item) for item in ctrl.monitorTypeList">\n                </select>\n            </div>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block>\n        <clr-stack-label>{{ ::ctrl.LBL_SWAP }}</clr-stack-label>\n        <clr-stack-content>\n            <label class="normal-weight" ng-repeat="item in ctrl.swapPlacementTypeOptions" >\n                <input type="radio"\n                       aria-label="{{::item.label}}"\n                       ng-value="item.id"\n                       ng-disabled="ctrl.isEditSwapFileLocationDisabled()"\n                       ng-model="ctrl.swapPlacementType"\n                       name="swap-placement-type"/>\n                <span ng-class="{\'div-disabled\': ctrl.isEditSwapFileLocationDisabled()}">\n                    {{ ::item.label }}\n                </span><br>\n                <span ng-class="{\'div-disabled\': ctrl.isEditSwapFileLocationDisabled()}">\n                    {{ ::item.description }}\n                </span>\n            </label>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <!--Configuration Parameters section -->\n\n   <clr-stack-block>\n      <clr-stack-label>\n          {{::ctrl.LBL_PARAMS}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <button class="btn btn-link"\n                 aria-label="{{::ctrl.LBL_PARAMS}}"\n                 ng-click="ctrl.openAdvancedEditConfigurationModal()">\n            {{::ctrl.LBL_EDIT_PARAMS}}\n         </button>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Latency sensitivity (Ls for short) section -->\n\n    <clr-stack-block ng-if="ctrl.isEditingLsLevelVisible()">\n        <clr-stack-label>{{ ::ctrl.LBL_LATENCY }}</clr-stack-label>\n        <clr-stack-content>\n            <div class="select">\n            <select data-test-id="latency-sensitivity-level-id"\n                    ng-disabled="ctrl.isEditingLsLevelDisabled()"\n                    ng-model="ctrl.getSetLsLevel" ng-model-options="{ getterSetter: true }"\n                    ng-options="item as ctrl.getLsLevelLabel(item) for item in ctrl.getLsLevelList()">\n                >\n            </select>\n            </div>\n        </clr-stack-content>\n    </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmOptions/vmwareTools/vmware-tools.html",'<clr-stack-block\n      ng-form\n      name="vmwareTools"\n      [(clr-sb-expanded)]="$ctrl.expanded">\n\n   <clr-stack-label>\n      {{ ::$ctrl.i18n(\'VMwareTools.title\') }}\n   </clr-stack-label>\n   <clr-stack-content>\n      <div ng-if="!$ctrl.expanded">\n         {{::$ctrl.i18n(\'VMwareTools.expand\')}}\n      </div>\n      <div ng-if="$ctrl.expanded">\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{ ::$ctrl.i18n(\'VMwareTools.operations\') }}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vsc-vm-power-operations [power-operations]="$ctrl.vmDefaultPowerOperations"\n            [vm-workflow-mode]="$ctrl.vmWorkflowMode"\n            [vm-power-state]="$ctrl.vmPowerState"\n            [vm-has-config-settings-privilege]="$ctrl.vmHasConfigSettingsPrivilege">\n         </vsc-vm-power-operations>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{ ::$ctrl.i18n(\'VMwareTools.upgrade\') }}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <label class="normal-weight" ng-attr-title="{{ ::$ctrl.i18n(\'VMwareTools.upgrade.policy\') }}"\n                ng-class="{\'div-disabled\': !$ctrl.toolsUpgradePolicyEnabled()}">\n            <input name="vmwareToolsUpgrades"\n                   aria-label="{{::$ctrl.ARIA_LBL_UPGRADE}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.vmToolsOptions.toolsUpgradePolicy\' ng-true-value="\'upgradeAtPowerCycle\'" ng-false-value="\'manual\'"\n                   ng-change="$ctrl.onVmwareToolsChange()"\n                   ng-disabled="!$ctrl.toolsUpgradePolicyEnabled()">\n            {{ ::$ctrl.i18n(\'VMwareTools.upgrade.policy\') }}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n   <clr-stack-block>\n      <clr-stack-label>\n         {{ ::$ctrl.i18n(\'VMwareTools.time\') }}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <label class="normal-weight" ng-attr-title="{{ ::$ctrl.i18n(\'VMwareTools.time.synch\') }}"\n                ng-class="{\'div-disabled\': $ctrl.syncTimeWithHostDisabled()}" >\n            <input name="syncTimeWithHost"\n                   aria-label="{{::$ctrl.ARIA_LBL_TIME_SYNC}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.vmToolsOptions.syncTimeWithHost\'\n                   ng-disabled="$ctrl.syncTimeWithHostDisabled()">\n            {{ ::$ctrl.i18n(\'VMwareTools.time.synch\') }}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{ ::$ctrl.i18n(\'VMwareTools.scripts\') }}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <label class="normal-weight"\n            ng-attr-title="{{ ::$ctrl.i18n(\'VMwareTools.scripts.after_power_on\') }}"\n            ng-class="{\'div-disabled\': !$ctrl.canChangeScriptOptions}" >\n            <input name="afterPowerOn"\n                   aria-label="{{::$ctrl.ARIA_LBL_AFTER_POWER_ON}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.vmToolsOptions.afterPowerOn\'\n                   ng-change=\'$ctrl.onVmwareToolsChange()\'\n                   ng-disabled=\'!$ctrl.canChangeScriptOptions\' >\n            {{ ::$ctrl.i18n(\'VMwareTools.scripts.after_power_on\') }}\n         </label>\n         <br/>\n         <label class="normal-weight"\n            ng-attr-title="{{ ::$ctrl.i18n(\'VMwareTools.scripts.after_resuming\') }}"\n            ng-class="{\'div-disabled\': !$ctrl.canChangeScriptOptions}" >\n            <input name="afterResume"\n                   aria-label="{{::$ctrl.ARIA_LBL_AFTER_RESUME}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.vmToolsOptions.afterResume\'\n                   ng-change=\'$ctrl.onVmwareToolsChange()\'\n                   ng-disabled=\'!$ctrl.canChangeScriptOptions\' >\n            {{ ::$ctrl.i18n(\'VMwareTools.scripts.after_resuming\') }}\n         </label>\n         <br/>\n         <label class="normal-weight"\n            ng-attr-title="{{ ::$ctrl.i18n(\'VMwareTools.scripts.before_suspending\') }}"\n            ng-class="{\'div-disabled\': !$ctrl.canChangeScriptOptions}" >\n            <input name="beforeGuestStandby"\n                   aria-label="{{::$ctrl.ARIA_LBL_BEFORE_SUSPEND}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.vmToolsOptions.beforeGuestStandby\'\n                   ng-change=\'$ctrl.onVmwareToolsChange()\'\n                   ng-disabled=\'!$ctrl.canChangeScriptOptions\' >\n            {{ ::$ctrl.i18n(\'VMwareTools.scripts.before_suspending\') }}\n         </label>\n         <br/>\n         <label class="normal-weight"\n            ng-attr-title="{{ ::$ctrl.i18n(\'VMwareTools.scripts.before_shutting_guest\') }}"\n            ng-class="{\'div-disabled\': !$ctrl.canChangeScriptOptions}" >\n            <input name="beforeGuestShutdown"\n                   aria-label="{{::$ctrl.ARIA_LBL_BEFORE_SHUTDOWN}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.vmToolsOptions.beforeGuestShutdown\'\n                   ng-change=\'$ctrl.onVmwareToolsChange()\'\n                   ng-disabled=\'!$ctrl.canChangeScriptOptions\' >\n            {{ ::$ctrl.i18n(\'VMwareTools.scripts.before_shutting_guest\') }}\n         </label>\n         <br/>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/common/vmsPowerOpsConfirmation.html",'<div>\n   <span class="power-ops-confirmation-text">{{ dialogOptions.actionDetails.dialogData.messageTxt }}</span>\n   <div ng-if(dialogOptions.actionDetails.dialogData.reasonsTxt)>\n      <br />\n      <span class="power-ops-confirmation-continue">{{ dialogOptions.actionDetails.dialogData.reasonsTxt }}</span>\n   </div>\n   <br />\n   <span class="power-ops-confirmation-continue">{{ dialogOptions.actionDetails.dialogData.continueTxt }}</span>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/sharesControl/sharesControl.html",'<div class="select">\n   <select name="{{ formSelectFieldName }}"\n           aria-label="{{::sharesAriaLabel}}"\n           ng-disabled="isDisabled"\n           ng-options="shareLevel.label for shareLevel in shareInfoLevels track by shareLevel.data"\n           ng-model="properties.selectedSharesLevel">\n   </select>\n</div>\n<vx-value-in-units name="{{ formInputFieldName }}"\n                quantity-aria-label="quantityAriaLabel"\n                quantity-caret-aria-label="quantityCaretAriaLabel"\n                type="number"\n                recommended-values="shareInfoValues"\n                ng-model="sharesInfo.shares"\n                is-disabled="isDisabled || !isShareLevelCustom"\n                min="{{ shareValueMin }}"\n                max="{{ shareValueMax }}"\n                error-messages="shareValueErrorMessages"\n                show-units="false">\n</vx-value-in-units>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCdrom/vmHardwareCdrom.html",'<clr-stack-block\n      class="vm-hardware-cdrom"\n      ng-form\n      name="vmHardwareCdRomForm{{device.key}}"\n      ng-class="{\'vm-ui-stackBlockEdited\': inflatedDevice.hasChanged()}"\n      [(clr-sb-expanded)]="expanded">\n   <clr-stack-label ng-class="{\'error-child-component\': hasError()}">\n      <span>{{ device.deviceInfo.label }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content ng-if="inflatedDevice.isMarkedForRemoval()">\n      {{::i18n(\'VmUi\', \'RemoveDevice.DeviceRemoved\')}}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         aria-label="{{ARIA_LBL_RESTORE}}"\n         ng-click="onRevertRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <clr-stack-content ng-if="!inflatedDevice.isMarkedForRemoval()">\n      <div class="select">\n         <select\n            aria-label="{{ARIA_LBL_MEDIA_TYPE}}"\n            name="editCdrom{{device.key}}MediaType"\n            ng-model="properties.mediaType"\n            ng-options="item as item.label for item in availableMediaTypes track by item.id"\n            ng-disabled="isCdRomDisabled()">\n         </select>\n      </div>\n      <div>\n         <label ng-if="!expanded && !isVmPoweredOn"\n                title="{{i18n(\'VmUi\', \'ConnectDevice.ConnectAtPowerOn\')}}"\n                class="normal-weight">\n            <input name="editCdrom{{device.key}}StartConnected"\n                   aria-label="{{ARIA_LBL_START_CONNECTED}}"\n                   type="checkbox"\n                   ng-model=\'properties.startConnected\'\n                   ng-disabled="isCdRomConnectedAtPowerOnDisabled()">\n            <span class="label-text-normal"\n                  ng-class="{\'label-text-disabled\': isCdRomConnectedAtPowerOnDisabled()}"\n                  ng-bind="i18n(\'VmUi\', \'ConnectDevice.ConnectAtPowerOnShort\')"/>\n         </label>\n         <label ng-if="isVmPoweredOn" class="normal-weight">\n            <input name="editCdrom{{device.key}}Connected"\n                   aria-label="{{ARIA_LBL_CONNECTED}}"\n                   type="checkbox"\n                   ng-disabled="isCdRomConnectedDisabled()"\n                   ng-model=\'properties.connected\'>\n            <span class="label-text-normal"\n                  ng-class="{\'label-text-disabled\': isCdRomConnectedDisabled()}"\n                  ng-bind="i18n(\'VmUi\', \'ConnectDevice.Connected\')"/>\n         </label>\n\n         <a class="vsphere-icon-action-remove remove-device stack-view-row-action"\n            aria-label="{{ARIA_LBL_REMOVE}}"\n            ng-disabled="shouldRemoveDeviceBeDisabled()"\n            ng-click="onCdRomRemoval()"></a>\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::i18n(\'VmUi\', \'GenericDevicePage.Status\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <label class="normal-weight">\n            <input name=\'editCdrom{{device.key}}StartConnected\'\n                   type="checkbox"\n                   aria-label="{{ARIA_LBL_START_CONNECTED}}"\n                   ng-model=\'properties.startConnected\'\n                   ng-disabled="isCdRomConnectedAtPowerOnDisabled()">\n            <span class="label-text-normal"\n                     ng-class="{\'label-text-disabled\': isCdRomConnectedAtPowerOnDisabled()}"\n                     ng-bind="i18n(\'VmUi\', \'ConnectDevice.ConnectAtPowerOn\')"/>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::i18n(\'VmUi\', \'CdromPage.Media\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div ng-if="isDatastoreISOFile()">\n            <label data-test-id="editCdromBackingFileName"\n                   aria-haspopup="true" role="tooltip"\n                   class="tooltip tooltip-validation tooltip-md"\n                   ng-class="{\'invalid\':hasEditCdRomError() && errors.isoError.isVisible}">\n               <input type="text"\n                      aria-label="{{ARIA_LBL_FILE}}"\n                      name="editCdrom{{device.key}}BackingFileName"\n                      ng-model="device.backing.fileName"\n                      ng-required="!inflatedDevice.isMarkedForRemoval()">\n               <span class="tooltip-content"\n                     ng-bind="errors.isoError.message">\n               </span>\n            </label>\n            <button name="editCdrom{{device.key}}BrowseForIso"\n                    aria-label="{{ARIA_LBL_BROWSE}}"\n                    class="button btn btn-default btn-sm"\n                    ng-click="browseForDatastoreIso()"\n                    type="button">\n               {{::i18n(\'VmUi\',\'CdromConfig.Browse\')}}\n            </button>\n         </div>\n         <div ng-if="isContentLibraryISOFile()">\n            <label data-test-id="editCdromCLBackingFileName"\n                   aria-haspopup="true" role="tooltip"\n                   class="tooltip tooltip-validation tooltip-md"\n                   ng-class="{\'invalid\':!inflatedDevice.isMarkedForRemoval() && errors.isoErrorForCL.isVisible}">\n               <input class="content-library-iso-file"\n                      aria-label="{{ARIA_LBL_FILE}}"\n                      type="text"\n                      name="editCdrom{{device.key}}CLBackingFileName"\n                      ng-model="properties.selectedIsoItem.friendlyName"\n                      readonly\n                      ng-required="!inflatedDevice.isMarkedForRemoval()">\n               <span class="tooltip-content"\n                     ng-bind="errors.isoErrorForCL.message">\n               </span>\n            </label>\n            <button name="editCdrom{{device.key}}BrowseForCLIso"\n                    aria-label="{{ARIA_LBL_BROWSE}}"\n                    class="button btn btn-default btn-sm"\n                    ng-click="browseForContentLibraryIso()"\n                    type="button">\n               {{::i18n(\'VmUi\',\'CdromConfig.Browse\')}}\n            </button>\n         </div>\n         <div ng-if="isClientDevice()">\n            {{::i18n(\'VmUi\', \'CdromPage.ConnectClient\')}}\n         </div>\n         <div data-test-id="hostDeviceList" ng-if="isHostDevice()" class="select" ng-class="{\'has-error\': isHostDeviceBackingInvalid()}">\n            <select name="editCdrom{{device.key}}cdromList"\n                    aria-label="{{ARIA_LBL_HOST}}"\n                    ng-model="properties.selectedCdrom"\n                    ng-change="onCdRomChanged(properties.selectedCdrom.name)"\n                    ng-options="getCdRomLabel(cdrom.name) for cdrom in cdromList track by cdrom.id">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::i18n(\'VmUi\', \'CdromPage.DeviceMode\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div class="select">\n            <select\n               aria-label="{{ARIA_LBL_MODE}}"\n               name="editCdrom{{device.key}}DeviceMode"\n               ng-model="properties.deviceMode"\n               ng-options="mode.label for mode in availableDeviceModes track by mode.id"\n               ng-disabled="isDeviceModeDisabled()">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::i18n(\'VmUi\', \'CdromPage.VirtualDeviceNode\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-controller-and-node\n            inflated-device="inflatedDevice"\n            power-state="vmConfigContext.environment.powerState"\n            selector-name="controllerNodeSelectorName"\n            virtual-machine-devices="virtualMachineDevicesNeededForControllerAndNode"\n            controller-selector-name="controllerSelectorName"\n            node="properties.controllerNode"\n            available-controllers="availableControllers"\n            device-controller="properties.controller"\n            privileges="vmConfigContext.privileges"\n            on-controller-change-callback="onControllerNodeChanged(deviceController, node)">\n         </vm-hardware-controller-and-node>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n\n'),
e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareControllerAndNode/vmHardwareControllerAndNode.html",'<div class="select">\n   <select\n      aria-label="{{ARIA_LBL_CTRL}}"\n      name="{{controllerSelectorName}}"\n      ng-disabled="disableSelection()"\n      ng-model="deviceController"\n      ng-options="option.getCurrentDevice().deviceInfo.label for option in availableControllers track by option.getKey()"\n      ng-change="onControllerChange(deviceController)">\n   </select>\n</div>\n\n<div class="select">\n   <select\n      name="{{selectorName}}"\n      aria-label="{{ARIA_LBL_NODE}}"\n      ng-disabled="disableSelection()"\n      ng-model="node"\n      ng-options="option.name for option in nodeOptions track by option.key"\n      ng-change="onControllerNodeChange(node)">\n   </select>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuAffinityHelpText.html","<div>\n   <p>\n      {{affinityText}}\n   </p>\n   <p>\n      {{i18n('VmUi', 'Affinity.Info.Label')}}\n   </p>\n   <p>\n      {{i18n('VmUi', 'Affinity.Info.Label2')}}\n   </p>\n   <p>\n      <strong>{{i18n('VmUi', 'Affinity.HtStatus.Label')}}</strong> {{htStatus}}\n   </p>\n   <p>\n      <strong>{{i18n('VmUi', 'Affinity.NumProcs.Label')}}</strong> {{numProcs}}\n   </p>\n   <p/>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuGeneralHelpText.html","<div>\n   {{i18n('VmUi', 'signpost.perSocket')}}\n   <p>{{i18n('VmUi', 'signpost.256CPU1')}}</p>\n   <p>{{i18n('VmUi', 'signpost.256CPU2')}}</p>\n</div>\n<div class=\"pull-right\">\n   <p>\n      <a href=\"{{cpuGeneralHelpUrl}}\" target=\"_blank\">{{i18n('Common', 'moreInformation')}}</a>\n   </p>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuMmuVirtualization6.7HostVm13HelpText.html","<div>\n    <p>\n        {{i18n('VmUi', 'VmCpu.CpuMmuVirt.Description')}}\n    </p>\n    <p>\n    {{i18n('VmUi', 'VmCpu.CpuMmuVirt.Additional.Description')}}\n    </p>\n    <p>\n        {{i18n('VmUi', 'VmCpu.CpuMmuVirt.Note')}}\n    </p>\n    <ul class=\"list\">\n        <li>\n            <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.automatic')}}</strong></div>\n            {{i18n('VmUi', 'CpuMmuVirt.Tooltip.automatic')}}\n        </li>\n        <li>\n            <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.software')}}</strong></div>\n            {{i18n('VmUi', 'CpuMmuVirt.Tooltip.software')}}\n        </li>\n        <li>\n            <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.hardwareCpu')}}</strong></div>\n            {{i18n('VmUi', 'CpuMmuVirt.Tooltip.hardwareCpu')}}\n        </li>\n        <li>\n            <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.hardwareCpuMmu')}}</strong></div>\n            {{i18n('VmUi', 'CpuMmuVirt.Tooltip.hardwareCpuMmu')}}\n        </li>\n    </ul>\n</div>"),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuMmuVirtualizationHelpText.html","<div>\n   <p>\n      {{i18n('VmUi', 'VmCpu.CpuMmuVirt.Description')}}\n   </p>\n   <p>\n      {{i18n('VmUi', 'VmCpu.CpuMmuVirt.Note')}}\n   </p>\n   <ul class=\"list\">\n      <li>\n         <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.automatic')}}</strong></div>\n         {{i18n('VmUi', 'CpuMmuVirt.Tooltip.automatic')}}\n      </li>\n      <li>\n         <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.software')}}</strong></div>\n         {{i18n('VmUi', 'CpuMmuVirt.Tooltip.software')}}\n      </li>\n      <li>\n         <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.hardwareCpu')}}</strong></div>\n         {{i18n('VmUi', 'CpuMmuVirt.Tooltip.hardwareCpu')}}\n      </li>\n      <li>\n         <div><strong>{{i18n('VmUi', 'CpuMmuVirt.Label.hardwareCpuMmu')}}</strong></div>\n         {{i18n('VmUi', 'CpuMmuVirt.Tooltip.hardwareCpuMmu')}}\n      </li>\n   </ul>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/nestedHVHelpText.html","<div>\n   <p>\n      {{i18n('VmUi', 'VmCpu.nestedHV.Description')}}\n   </p>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/vmHardwareCpu.html",'<clr-stack-block\n   class="numCpu"\n   [(clr-sb-expanded)]="expanded"\n   ng-class="{\'vm-ui-stackBlockEdited\': hasChanged()}"\n   ng-form\n   name="vmHardwareCpuForm">\n   <clr-stack-label ng-class="{\'error-child-component\': hasError()}">\n         <span>{{i18n(\'VmUi\', \'VmCpu.Title\')}}</span>\n   </clr-stack-label>\n\n   <clr-stack-content class="value">\n      <div class="select" ng-class="{ \'has-error\' : cpuCountError.isVisible }">\n         <select name="editCPU" autofocus\n                 aria-label="{{::i18n(\'VmUi\', \'VmCpu.Title\')}}"\n                 ng-model="vmConfigContext.config.hardware.numCPU"\n                 ng-options="option for option in numCpuOptions"\n                 ng-change="onCpuCountChange()"\n                 ng-disabled ="!isEditNumCpuEnabled()"\n                 vx-error="cpuCountError">\n         </select>\n      </div>\n      <a vui-sign-post=\'cpuGeneralHelpSignPostParams\' class="pull-right"><img ng-src="{{i18n(\'CommonImages\', \'info\')}}"></a>\n   </clr-stack-content>\n\n   <clr-stack-block ng-if="isMultipleCoresPerSocketSupported()" class="CoresPerSocket">\n      <clr-stack-label ng-bind="i18n(\'VmUi\', \'VmCpu.Label.CoresPerSocket\')"></clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select name="coresPerSocket"\n                    aria-label="{{::i18n(\'VmUi\', \'VmCpu.Label.CoresPerSocket\')}}"\n                    ng-model="vmConfigContext.config.hardware.numCoresPerSocket"\n                    ng-options="option for option in coresPerSocketOptions"\n                    ng-disabled="!isEditCoresPerSocketEnabled()">\n            </select>\n         </div>\n         <span ng-bind="i18n(\'VmUi\', \'VmCpu.Label.Sockets\')"/>\n         <span> {{vmConfigContext.config.hardware.numCPU / vmConfigContext.config.hardware.numCoresPerSocket}}</span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="CpuHotPlug">\n      <clr-stack-label ng-bind="i18n(\'VmUi\', \'VmCpu.Label.CpuHotPlug\')">\n      </clr-stack-label>\n      <clr-stack-content>\n         <input name="cpuHotPlug"\n                aria-label="{{::i18n(\'VmUi\', \'VmCpu.Label.CpuHotAdd\')}}"\n                type="checkbox"\n                ng-model="cpuHotPlug"\n                ng-model-options="{ getterSetter: true }"\n                ng-disabled="!isCpuHotPlugEnabled()"/>\n         <label>\n            <span ng-class="{\'label-text-disabled\': !isCpuHotPlugEnabled()}"\n                  class="label-text-normal"\n                  ng-bind="i18n(\'VmUi\', \'VmCpu.Label.CpuHotAdd\')"/>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="Reservation">\n      <clr-stack-label ng-bind="fieldLabel(\'Reservation\')"></clr-stack-label>\n      <clr-stack-content>\n         <vx-value-in-units name="cpuReservation"\n                            unit-aria-label="RSRV_UNIT_ARIA_LBL"\n                            quantity-caret-aria-label="RSRV_QUANTITY_CARET_ARIA_LBL"\n                            quantity-aria-label="RSRV_QUANTITY_ARIA_LBL"\n                            type="number"\n                            ng-model="vmConfigContext.config.cpuAllocation.reservation"\n                            unit-options="reservationUnitOptions"\n                            recommended-values="reservationRecommendations"\n                            max="{{reservationMax}}"\n                            is-disabled="!isEditReservationEnabled()"\n                            error-messages="reservationErrorMessages">\n         </vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="Limit">\n      <clr-stack-label ng-bind="fieldLabel(\'Limit\')">\n      </clr-stack-label>\n      <clr-stack-content>\n         <vx-value-in-units name="cpuLimit"\n                            unit-aria-label="LIMIT_UNIT_ARIA_LBL"\n                            quantity-caret-aria-label="LIMIT_QUANTITY_CARET_ARIA_LBL"\n                            quantity-aria-label="LIMIT_QUANTITY_ARIA_LBL"\n                            is-disabled="!isEditLimitEnabled()"\n                            recommended-values="limitRecommendations"\n                            ng-model="vmConfigContext.config.cpuAllocation.limit"\n                            unit-options="limitUnitOptions">\n         </vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="Shares">\n      <clr-stack-label ng-bind="fieldLabel(\'Shares\')">\n      </clr-stack-label>\n      <clr-stack-content>\n         <shares-control\n            shares-aria-label="SHARES_ARIA_LBL"\n            quantity-caret-aria-label="SHARES_CARET_ARIA_LBL"\n            quantity-aria-label="SHARES_QNT_ARIA_LBL"\n            is-disabled="!isEditSharesEnabled()"\n            form-input-field-name="CpuSharesValue"\n            form-select-field-name="CpuSharesLevels"\n            share-value-min="0"\n            share-value-max="1000000"\n            shares-value-map="sharesValueMap"\n            shares-info="sharesInfo">\n         </shares-control>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-show="!deployVmtxMode" class="CpuIdMask">\n      <clr-stack-label ng-bind="fieldLabel(\'CpuIdMask\')"></clr-stack-label>\n      <clr-stack-content>\n         <div class="select-cpuid-mask-row">\n            <select class="select-cpuid-mask"\n                    aria-label="{{::fieldLabel(\'CpuIdMask\')}}"\n                    name="cpuIdMask"\n                    ng-disabled="!isEditCpuIdEnabled()"\n                    ng-model="cpuIdMaskSelectedSetting"\n                    ng-options="option for option in cpuIdMaskSettings"\n                    ng-change="onCpuIdMaskChange()">\n            </select>\n            <a\n               class="advanced-cpuid-mask-edit"\n               href="javascript:void(0);"\n               aria-label="{{::i18n(\'VmUi\', \'VmCpu.CpuIdMask.Advanced\')}}"\n               ng-disabled="!isEditCpuIdEnabled()"\n               ng-click="onCpuIdMaskAdvanced()">\n                  {{::i18n(\'VmUi\', \'VmCpu.CpuIdMask.Advanced\')}}\n            </a>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="NestedHV">\n      <clr-stack-label ng-bind="fieldLabel(\'NestedHV\')"></clr-stack-label>\n      <clr-stack-content>\n         <input class="NestedHV" type="checkbox"\n                aria-label="{{::i18n(\'VmUi\', \'VmCpu.ExposeNestedHV\')}}"\n                data-test-id="NestedHV"\n                ng-disabled="isHVDisabled()"\n                ng-model="vmConfigContext.config.nestedHVEnabled"/>\n         <span ng-class="{\'div-disabled\': isHVDisabled()}"\n               class="label-text-normal"\n               ng-bind="i18n(\'VmUi\', \'VmCpu.ExposeNestedHV\')"/>\n         <a ng-if="isHVDisabled()" vui-sign-post=\'nestedHVSignPostParams\' class=\'pull-right\'><img ng-src="{{i18n(\'CommonImages\', \'info\')}}"></a>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="PerfCounters">\n      <clr-stack-label ng-bind="fieldLabel(\'PerfCounters\')"></clr-stack-label>\n      <clr-stack-content >\n         <div>\n            <input name="PerfCounters" type="checkbox"\n                   aria-label="{{::fieldLabel(\'PerfCounters\')}}"\n                   ng-disabled="isEnablePerfCountersIsDisabled()"\n                   ng-model="vmConfigContext.config.vPMCEnabled"/>\n            <span class="label-text-normal"\n                  ng-class="{\'div-disabled\': isEnablePerfCountersIsDisabled()}"\n                  ng-bind="i18n(\'VmUi\', \'VmCpu.EnablePerfCounters\')"/>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="isSchedulingAffinityShown() && !deployVmtxMode" class="CpuAffinity">\n      <clr-stack-label> {{::fieldLabel(\'CpuAffinity\')}}</clr-stack-label>\n      <clr-stack-content>\n         <input name="cpuAffinity"\n                aria-label="{{::fieldLabel(\'CpuAffinity\')}}"\n                type="text"\n                ng-model="fieldValue[\'CpuAffinity\']"\n                ng-change="onAffinityChange()"\n                vx-error="affinityError"\n                ng-disabled="!isSchedulingAffinityEnabled()"\n                ng-class="{\'has-error\': isAffinityInvalid()}"\n                class="edit-setting-input"/>\n         <a vui-sign-post=\'cpuAffinitySignPostParams\' class=\'pull-right\'><img ng-src="{{i18n(\'CommonImages\', \'info\')}}"></a>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class="CpuMmuVirtualization" ng-if="!showCpuMmuVirtualization && !deployVmtxMode">\n      <clr-stack-label ng-bind="fieldLabel(\'CpuMmuVirtualization\')"></clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <cpu-mmu-view\n               aria-label="fieldLabel(\'CpuMmuVirtualization\')"\n               vm-config-context="vmConfigContext"\n               create-mode="createMode"\n               on-cpu-mmu-change="onCpuMmuChange(selectedOption)">\n            </cpu-mmu-view>\n         </div>\n         <a vui-sign-post=\'cpuMmuVirtSignPostParams\' class=\'pull-right\'><img ng-src="{{i18n(\'CommonImages\', \'info\')}}"></a>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="ioMmuVirtualizationSupported && !deployVmtxMode" class="ioMmuVirtualization">\n      <clr-stack-label ng-bind="fieldLabel(\'ioMmuVirtualization\')"></clr-stack-label>\n      <clr-stack-content>\n         <input type="checkbox" ng-disabled="disableVvtdCheckbox()" ng-model="vm.vvtd" aria-label="{{::IOMMU_ARIA_LBL}}"/>\n         <span ng-class="{\'div-disabled\': disableVvtdCheckbox()}">{{::LBL_VVTD_ENABLED}}</span>\n         <a ng-if="showVvtdInfo()" vui-sign-post=\'vvtdSignPostParams\' class=\'pull-right\'><img ng-src="{{::INFO_PNG}}"></a>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareExistingDisk/select-existing-hard-disk.view.html",'<div>\n   <datastore-file-browser\n      object-id="modalOptions.dialogData.datastoreBrowserId"\n      datastore-ids="modalOptions.dialogData.datastoreIds"\n      initial-file-query-type="modalOptions.dialogData.initialFileQueryType"\n      filter-file-query-types="modalOptions.dialogData.filterFileQueryTypes"\n      show-vm-images-folder="modalOptions.dialogData.showVmImagesFolder"\n      selected-file-changed="modalOptions.dialogData.selectedFileChanged(selectedFile)">\n   </datastore-file-browser>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareMemory/vmHardwareMemory.html",'<clr-stack-block style="overflow-y: unset"\n      ng-form\n      name="vmHardwareMemoryForm"\n      [(clr-sb-expanded)]="expanded"\n      ng-class="{\'vm-ui-stackBlockEdited\': hasChanged()}"\n      class="memory">\n   <clr-stack-label ng-class="{\'error-child-component\': hasError()}">\n      <span>{{ ::i18n(\'VmUi\', \'VmMemory.Title\') }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content class="memory-heading">\n      <vx-value-in-units name="editMemory"\n                         unit-aria-label="ARIA_LBL_MEMORY"\n                         quantity-caret-aria-label="ARIA_LBL_MEMORY"\n                         quantity-aria-label="ARIA_LBL_MEMORY"\n                         ng-if="memoryOptions"\n                         is-disabled="isMemoryDisabled()"\n                         hot-plug-active="(vmConfigContext.environment.powerState === \'poweredOn\')"\n                         type="number"\n                         ng-model="vmConfigContext.config.hardware.memoryMB"\n                         default-unit="{{vmConfigContext.config.hardware.memoryUnitPreferred ? vmConfigContext.config.hardware.memoryUnitPreferred.label : i18n(\'VmUi\', \'Vm.Units.GB\')}}"\n                         unit-options="memoryOptions"\n                         unit-changed-callback="onUnitChanged"\n                         min="{{minAllowedMemory}}"\n                         max="{{maxAllowedMemory}}"\n                         mod="{{memoryIncrementSize}}"\n                         recommended-values="memoryRecommendations"\n                         custom-validators="memoryValidators"\n                         error-messages="memoryErrorMessages">\n      </vx-value-in-units>\n   </clr-stack-content>\n\n   <clr-stack-block class="memory-reservation" ng-if="!deployVmtxMode">\n      <clr-stack-label >{{ ::fieldLabel(\'Reservation\') }}</clr-stack-label>\n      <clr-stack-content>\n         <vx-value-in-units name="memoryReservation"\n                            unit-aria-label="ARIA_LBL_RSRV"\n                            quantity-caret-aria-label="ARIA_LBL_RSRV"\n                            quantity-aria-label="ARIA_LBL_RSRV"\n                            recommended-values="reservationRecommendations"\n                            min="0"\n                            type="number"\n                            max="{{limits.reservationMaxLimit}}"\n                            ng-model="vmConfigContext.config.memoryAllocation.reservation"\n                            default-unit="{{vmConfigContext.config.memoryAllocation.reservationMemoryUnitPreferred.label}}"\n                            unit-options="memoryOptions"\n                            unit-changed-callback="onReservationUnitChanged"\n                            error-messages="reservationErrorMessages"\n                            is-disabled="isReservationDisabled()">\n         </vx-value-in-units>\n         <div class="memory-reservation-locked-max" ng-if="vmConfigContext.environment.configOption.capabilities.memoryReservationLockSupported">\n            <input name="memoryReservationLockedToMax"\n                   aria-label="{{::i18n(\'VmUi\', \'VmMemory.Label.MemoryReservationLockedToMax\')}}"\n                   ng-change="onMemoryReservationLockedToMax()"\n                   ng-disabled="isMaxReservationDisabled()"\n                   ng-model = "vmConfigContext.config.memoryReservationLockedToMax"\n                   type="checkbox"/>\n            <span class="label-text-normal"\n                  ng-class="{\'label-text-disabled\': isMaxReservationDisabled()}"\n                  ng-bind="i18n(\'VmUi\', \'VmMemory.Label.MemoryReservationLockedToMax\')"/>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="Limit">\n      <clr-stack-label >{{ ::fieldLabel(\'Limit\') }}</clr-stack-label>\n      <clr-stack-content>\n         <vx-value-in-units name="memoryLimit"\n                            unit-aria-label="ARIA_LBL_LIMIT"\n                            quantity-caret-aria-label="ARIA_LBL_LIMIT"\n                            quantity-aria-label="ARIA_LBL_LIMIT"\n                            recommended-values="limitRecommendations"\n                            min="{{limits.reservation}}"\n                            ng-model="vmConfigContext.config.memoryAllocation.limit"\n                            default-unit="{{vmConfigContext.config.memoryAllocation.limitMemoryUnitPreferred.label}}"\n                            unit-changed-callback="onLimitUnitChanged"\n                            unit-options="memoryOptions"\n                            error-messages="memoryErrorMessages"\n                            is-disabled="isLimitDisabled()">\n         </vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="Shares">\n      <clr-stack-label>{{ ::fieldLabel(\'Shares\') }}</clr-stack-label>\n      <clr-stack-content>\n         <shares-control\n            shares-aria-label="ARIA_LBL_SHARES"\n            quantity-caret-aria-label="ARIA_LBL_SHARES"\n            quantity-aria-label="ARIA_LBL_SHARES"\n            form-input-field-name="MemorySharesValue"\n            form-select-field-name="MemorySharesLevels"\n            share-value-min="{{MIN_SHARES_VALUE}}"\n            share-value-max="{{MAX_SHARES_VALUE}}"\n            shares-value-map="sharesValueMap"\n            shares-info="sharesInfo"\n            is-disabled="isSharesDisabled()">\n         </shares-control>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!deployVmtxMode" class="memoryHotAdd">\n      <clr-stack-label>{{ ::i18n(\'VmUi\', \'VmMemory.Label.MemoryHotPlug\') }}</clr-stack-label>\n      <clr-stack-content>\n         <label>\n            <input name="memoryHotAdd"\n                   aria-label="{{::i18n(\'VmUi\', \'VmMemory.Label.MemoryHotPlug\')}}"\n                   ng-model="vmConfigContext.config.memoryHotAddEnabled"\n                   type="checkbox"\n                   ng-disabled="isMemoryHotPlugDisabled()"/>\n         <span class="label-text-normal"\n               ng-class="{\'label-text-disabled\': isMemoryHotPlugDisabled()}"\n               ng-bind="i18n(\'VmUi\', \'VmMemory.Label.MemoryHotAdd\')"/>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareNetwork/vm-hardware-network.html",'<!---->\n<clr-stack-block\n      class="vm-hardware-network"\n      ng-form\n      deviceLabel={{::$ctrl.device.deviceInfo.label}}\n      name="$ctrl.vmHardwareNetworkForm"\n      [(clr-sb-expanded)]="$ctrl.expanded"\n      ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.virtualNetworkDevice.hasChanged()}">\n   <clr-stack-label ng-class="{\'error-child-component\': $ctrl.hasError()}">\n      <span>{{::$ctrl.device.deviceInfo.label}}</span>\n      <span class="vx-icon-warn" ng-if="$ctrl.showDeviceWarning"></span>\n   </clr-stack-label>\n\n   <clr-stack-content ng-if="$ctrl.virtualNetworkDevice.isMarkedForRemoval()">\n      {{::$ctrl.i18n(\'RemoveDevice.DeviceRemoved\')}}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         tabindex="0"\n         aria-label="{{::$ctrl.ARIA_LBL_RESTORE}}"\n         ng-click="$ctrl.revertRemoval()">\n      </a>\n   </clr-stack-content>\n   <clr-stack-content ng-if="!$ctrl.virtualNetworkDevice.isMarkedForRemoval()">\n      <div data-test-id="editNetwork"\n           class="vm-edit-network-selector"  network-selector\n           network-selector-name="\'editNetwork\' + $ctrl.device.key"\n           ng-class="{\'has-error\' : !$ctrl.selectedNetworkValid}"\n           object-ref="$ctrl.networkSelectorModel.objectRef"\n           mode="$ctrl.networkSelectorModel.mode"\n           filter-spec="$ctrl.networkSelectorModel.filterSpec"\n           dialog-spec="$ctrl.networkSelectorModel.dialogSpec"\n           prefetched-networks="$ctrl.networkSelectorModel.prefetchedNetworks"\n           preselected-network="$ctrl.networkSelectorModel.selectedNetwork"\n           on-selected-networks="$ctrl.onNetworkSelectionChanged(selectedNetworks)"\n           on-preload-networks="$ctrl.onPreloadNetworks()"\n           preload-networks="true"\n           error-config="$ctrl.errorConfig"\n           is-disabled="$ctrl.isNetworkSelectDisabled()"\n      ></div>\n\n      <div>\n         <label ng-if="!$ctrl.deployVmtxMode && !$ctrl.expanded && !$ctrl.isVmPoweredOn()"\n                data-test-id="startConnectedInHeader"\n                title="{{::$ctrl.i18n(\'ConnectDevice.ConnectAtPowerOn\')}}"\n                class="normal-weight">\n            <input name="editNetwork{{$ctrl.device.key}}StartConnected"\n                   aria-label="{{::$ctrl.ARIA_LBL_START_CONNECTED}}"\n                   type="checkbox"\n                   test-id = "startConnected"\n                   title="{{::$ctrl.i18n(\'ConnectDevice.ConnectAtPowerOn\')}}"\n                   ng-model=\'$ctrl.properties.connectAtPowerOn\'\n                   ng-change="$ctrl.onConnectAtPowerOnChange()"\n                   ng-disabled="$ctrl.isConnectedAtPowerOnDisabled()">\n            {{::$ctrl.i18n(\'ConnectDevice.ConnectAtPowerOnShort\')}}\n         </label>\n         <label class="normal-weight"\n                data-test-id="Connected"\n                ng-if="!$ctrl.deployVmtxMode && $ctrl.isVmPoweredOn()">\n            <input name="editNetwork{{$ctrl.device.key}}Connected"\n                   aria-label="{{::$ctrl.ARIA_LBL_CONNECTED}}"\n                   type="checkbox"\n                   ng-model=\'$ctrl.properties.connected\'\n                   ng-change="$ctrl.onConnectChange()"\n                   ng-disabled="$ctrl.isConnectedDisabled()"\n            />\n            {{::$ctrl.i18n(\'ConnectDevice.Connected\')}}\n         </label>\n         <a class="vsphere-icon-action-remove remove-device stack-view-row-action"\n            tabindex="0"\n            aria-label="{{::$ctrl.ARIA_LBL_REMOVE}}"\n            ng-disabled="$ctrl.isRemoveDisabled()"\n            ng-click="$ctrl.onRemoveDevice()"></a>\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'GenericDevicePage.Status\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <label data-test-id="startConnectedInBody"\n            ng-if="$ctrl.expanded"\n            class="normal-weight">\n            <input type="checkbox"\n                   aria-label="{{::$ctrl.ARIA_LBL_START_CONNECTED}}"\n                   ng-model="$ctrl.properties.connectAtPowerOn"\n                   ng-change="$ctrl.onConnectAtPowerOnChange()"\n                   ng-disabled="$ctrl.isConnectedAtPowerOnDisabled()"/>\n            {{::$ctrl.i18n(\'ConnectDevice.ConnectAtPowerOn\')}}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.showPortID">\n      <clr-stack-label>{{::$ctrl.LBL_PORT_ID}}</clr-stack-label>\n      <clr-stack-content>\n         <label ng-class="{\'invalid\': $ctrl.portIsInvalid}"\n                test-id="portKeyLabel"\n                aria-haspopup="true"\n                role="tooltip"\n                class="tooltip tooltip-validation tooltip-lg tooltip-top-left">\n         <input test-id="portKey" type="text" ng-model="$ctrl.port" autocomplete="off"/>\n         <span class="tooltip-content">{{::$ctrl.LBL_PORT_ID_ERR}}</span>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmNetView.adapterType\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div class="select">\n            <select\n               data-test-id="editNetworkAdapterType"\n               name="networkAdapterType"\n               aria-label="{{::$ctrl.ARIA_LBL_NIC_TYPE}}"\n               ng-model="$ctrl.properties.selectedAdapterType"\n               ng-options="$ctrl.getEthernetCardLabel(adapterType.type.name) for adapterType in $ctrl.adapterTypes"\n               ng-disabled="$ctrl.isNetworkAdapterDisabled()"\n               ng-change="$ctrl.onNetworkAdapterTypeChange()">\n            </select>\n         </div>\n         <div test-id="hotadd-error" ng-if="$ctrl.showHotAddError">\n            <span class="vx-icon-error"></span>\n            <span>{{::$ctrl.hotAddErrorText}}</span>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode && $ctrl.shouldDisplayPVRDMADeviceProtocol()">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmNetView.deviceProtocol\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div class="select">\n            <select\n               name="deviceProtocol"\n               ng-model="$ctrl.device.deviceProtocol"\n               ng-options="$ctrl.getDeviceProtocolLabel(deviceProtocol) for deviceProtocol in $ctrl.deviceProtocols"\n               ng-disabled="$ctrl.isNetworkAdapterDisabled()">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode && $ctrl.isUptCompatibilityVisible()">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NetworkPage.UptCompatibility\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <label>\n            <input data-test-id="direct-io-checkbox"\n                   type="checkbox"\n                   aria-label="{{::$ctrl.ARIA_LBL_UPT}}"\n                   ng-model="$ctrl.uptCompatibility"\n                   ng-model-options="{ getterSetter: true }"\n                   ng-disabled="$ctrl.isEditUptCompatibilityDisabled()"/>\n            {{::$ctrl.i18n(\'NetworkPage.UptCompatibility.Enable\')}}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if=$ctrl.isMemWarnVisible>\n      <clr-stack-label></clr-stack-label>\n      <clr-stack-content>\n         <div><span class="vx-icon-warn"></span><span test-id="mem-txt">{{$ctrl.memWarnText}}</span>\n         </div>\n      </clr-stack-content>\n\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.isSriovWarningVisible">\n      <clr-stack-content>\n         <div><span class="vx-icon-warn"></span><span test-id="sriov-note">{{ ::$ctrl.sriovWarningText}}</span></div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n\n\n   <clr-stack-block ng-if="$ctrl.isSriovVisible()">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NetworkPage.PhysicalFunction\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div class="select" ng-if="$ctrl.isSriovSelectVisible()">\n            <select\n               aria-label="{{::$ctrl.ARIA_LBL_SRIOV_PF}}"\n               ng-model="$ctrl.sriovValue"\n               ng-options="item.label for item in $ctrl.sriovList() track by item.pnic">\n            </select>\n         </div>\n         <label ng-if="$ctrl.isSriovLabelVisible()">{{$ctrl.getSriovLabelText()}}</label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode && $ctrl.properties.reservationSupported">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NetworkPage.Shares\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <shares-control name="shares"\n            shares-aria-label="$ctrl.ARIA_LBL_SHARES"\n            quantity-caret-aria-label="$ctrl.ARIA_LBL_SHARES"\n            quantity-aria-label="$ctrl.ARIA_LBL_SHARES"\n            form-input-field-name="sharesValue"\n            form-select-field-name="sharesLevels"\n            share-value-min="1"\n            share-value-max="100"\n            shares-value-map="$ctrl.sharesValueMap"\n            shares-info="$ctrl.resourceAllocation.share">\n         </shares-control>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode && $ctrl.properties.reservationSupported">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NetworkPage.Reservation\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <vx-value-in-units name="reservation"\n                            unit-aria-label="$ctrl.ARIA_LBL_RSRV"\n                            quantity-caret-aria-label="$ctrl.ARIA_LBL_RSRV"\n                            quantity-aria-label="$ctrl.ARIA_LBL_RSRV"\n                            type="number"\n                            ng-model="$ctrl.resourceAllocation.reservation"\n                            ng-change="$ctrl.onReservationChanged()"\n                            unit-options="$ctrl.reservationUnitOptions"\n                            recommended-values="$ctrl.reservationRecommendations"\n                            min="0"\n                            max="{{$ctrl.reservationMax}}"\n                            error-messages="$ctrl.reservationErrorMessages">\n         </vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode && $ctrl.properties.reservationSupported">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NetworkPage.Limit\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <vx-value-in-units name="limit"\n                            unit-aria-label="$ctrl.ARIA_LBL_LIMIT"\n                            quantity-caret-aria-label="$ctrl.ARIA_LBL_LIMIT"\n                            quantity-aria-label="$ctrl.ARIA_LBL_LIMIT"\n                            ng-model="$ctrl.resourceAllocation.limit"\n                            ng-change="$ctrl.onLimitChanged()"\n                            unit-options="$ctrl.reservationUnitOptions"\n                            recommended-values="$ctrl.limitRecommendations"\n                            error-messages="{bug:1867123}"\n                            custom-validators="$ctrl.limitValidators">\n         </vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n\n\n   <clr-stack-block ng-if="!$ctrl.deployVmtxMode">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmNetView.macAddress\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <mac-address-control\n            address-type="$ctrl.device.addressType"\n            assigned-mac-address="$ctrl.device.macAddress"\n            ng-disabled="$ctrl.isMacAddressDisabled()"\n         ></mac-address-control>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--SRIOV ONLY: Allow guest OS MTU change true/false -->\n\n   <clr-stack-block ng-if="$ctrl.isMtuChangeVisible">\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'VmNetView.allowGuestOSMtuChange\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div class="select">\n            <select ng-disabled="!$ctrl.isMtuChangeEditable"\n                 aria-label="{{::$ctrl.ARIA_LBL_MTU}}"\n                 test-id="mtu-change"\n                 ng-model="$ctrl.mtuChangeValue"\n                 ng-options="item as item.label for item in $ctrl.mtuChangeList track by item.id">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--END OF "Allow guest OS MTU change" section"-->\n\n</clr-stack-block>\n'),
e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareNvdimmController/vm-hardware-nvdimm-controller.component.html",'<clr-stack-block\n      ng-form\n      name="vmHardwareNvdimmControllerForm"\n      [(clr-sb-expanded)]="expanded"\n      ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.nvdimmControllerDevice.hasChanged()}"\n      class="virtual-nvdimm">\n   <clr-stack-label>\n      <span>{{ ::$ctrl.deviceName }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content ng-if="$ctrl.nvdimmControllerDevice.isMarkedForRemoval()">\n      {{::$ctrl.i18n(\'RemoveDevice.DeviceRemoved\')}}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n            ng-click="$ctrl.revertNvdimmControllerRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <clr-stack-content ng-if="!$ctrl.nvdimmControllerDevice.isMarkedForRemoval()">\n      <!-- A dummy label in order to push the below button right.\n          For now it is simpler than doing CSS acrobatics.-->\n      <clr-stack-label>\n      </clr-stack-label>\n      <a class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"\n            ng-disabled="$ctrl.isRemoveDisabled"\n            ng-click="$ctrl.removeNvdimmController()"></a>\n   </clr-stack-content>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NVDIMM.availableCapacity\')}}\n      </clr-stack-label>\n      <clr-stack-content data-test-id="nvdimm-available-capacity">\n         <span>\n            {{$ctrl.getAvailablePmemCapacity() | bytes:\'MB\'}}\n         </span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label>\n         {{::$ctrl.i18n(\'NVDIMM.supportedByGuest\')}}\n      </clr-stack-label>\n      <clr-stack-content data-test-id="nvdimm-supported-by-guest">\n         <span>\n            {{$ctrl.getSupportedPmemByGuestOs() | bytes:\'MB\'}}\n         </span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block data-test-id="nvdimm-total-nvdimm-summary">\n      <clr-stack-label>\n         {{::$ctrl.i18n("VMDIMM.totalNVDIMMs.label")}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <span>\n            {{$ctrl.getNvDimmDeviceSummary()}}\n         </span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareOther/vmHardwareOther.html",'<clr-stack-block [(clr-sb-expanded)]="ctrl.stackBlocksExpandedState.other">\n   <clr-stack-label>\n      {{ ::i18n(\'VmUi\', \'VmHardwareView.OtherHardware\') }}\n   </clr-stack-label>\n\n   <clr-stack-content>\n      <div ng-if="!expanded">\n         {{ i18n(\'VmUi\', \'VmHardwareView.AdditionalHardware\') }}\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block class="controllers">\n      <clr-stack-label ng-bind="::i18n(\'VmUi\', \'VmOtherHardwareView.Controllers\')"></clr-stack-label>\n      <clr-stack-content>\n         <div class="controller vm-hardware-generic"\n              ng-repeat="inflatedDevice in ::ctrl.virtualControllers | deviceTypeFilter:\'VirtualSCSIController\' track by inflatedDevice.getKey()"\n              ng-bind="vmHardwareOtherCtrl.getSummaryText(inflatedDevice, \'VirtualController\')">\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class="scsi-adapters">\n      <clr-stack-label\n                       ng-bind="i18n(\'VmUi\', \'VmOtherHardwareView.ScsiAdapters\')"></clr-stack-label>\n      <clr-stack-content>\n         <div class="scsi-adapter vm-hardware-generic"\n              ng-repeat="inflatedDevice in ::ctrl.virtualScsiControllers track by inflatedDevice.getKey()"\n              ng-bind="vmHardwareOtherCtrl.getSummaryText(inflatedDevice, \'VirtualSCSIController\')">\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class="input-devices">\n      <clr-stack-label\n                       ng-bind="::i18n(\'VmUi\', \'VmOtherHardwareView.InputDevices\')"></clr-stack-label>\n\n      <clr-stack-content>\n         <div class="input-device vm-hardware-generic"\n              ng-repeat="inflatedDevice in ::ctrl.inputDevices track by inflatedDevice.getKey()"\n              ng-bind="vmHardwareOtherCtrl.getSummaryText(inflatedDevice, \'InputDevice\')">\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n\n\n\n\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwarePciDevice/vm-hw-pci-device.html",'<clr-stack-block\n   class="vm-hardware-usb-controller"\n   deviceLabel="$ctrl.deviceLabel">\n\n   <clr-stack-label test-id="pci-block-label">{{$ctrl.deviceLabel}}\n      <span class="vx-icon-warn" ng-if="$ctrl.showDeviceWarning()"></span>\n   </clr-stack-label>\n\n   <!--Header section - device selector and removal icon -->\n\n   <clr-stack-content ng-if="!$ctrl.isMarkedForRemoval()">\n\n      <div class="select"><select ng-model="$ctrl.deviceValue" test-id="pci-label"\n                                  ng-disabled="$ctrl.isEditDeviceValueDisabled()"\n              ng-options="item as item.label for item in $ctrl.deviceList() track by item.key">\n      </select></div>\n\n      <a class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"\n         ng-click="$ctrl.removeDevice()" ng-disabled="$ctrl.isRemoveDisabled()" test-id="remove"></a>\n\n   </clr-stack-content>\n\n   <!--Alternate header when device marked for removal -->\n\n   <clr-stack-content ng-if="$ctrl.isMarkedForRemoval()">\n      {{ $ctrl.i18nService.getString(\'VmUi\', \'RemoveDevice.DeviceRemoved\') }}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         ng-click="$ctrl.revertRemoval()" test-id="restore"> </a>\n   </clr-stack-content>\n\n   <!--Reserve memory-->\n\n   <clr-stack-block ng-if="$ctrl.showMemorySection()">\n      <clr-stack-label></clr-stack-label>\n      <clr-stack-content>\n         <div><span class="vx-icon-warn"></span><span test-id="mem-txt">{{$ctrl.i18n(\'Warning\')}}</span>\n         </div>\n      </clr-stack-content>\n\n      <clr-stack-content>\n         <button ng-click="$ctrl.reserveAllMemory()" test-id="mem-btn">\n            {{$ctrl.i18n("Reserve")}}\n         </button>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Note: Some virtual machine operations are unavailable when PCI/PCIe passthrough devices are present. -->\n   <!--You cannot suspend, migrate with vMotion, or take or restore snapshots of such virtual machines.-->\n\n   <clr-stack-block>\n      <clr-stack-content>\n         <div><span class="vx-icon-warn"></span><span test-id="note">{{$ctrl.i18n(\'Note\')}}</span></div>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwarePciDevice/vm-hw-pci-shared.html",'<clr-stack-block class="vm-hardware-usb-controller">\n\n   <!-- Warning icon (when not all memory is reserved) -->\n\n   <clr-stack-label test-id="pci-block-label">{{$ctrl.deviceLabel}}\n      <span class="vx-icon-warn" ng-if="$ctrl.showDeviceWarning()"></span>\n   </clr-stack-label>\n\n   <!--Header section -->\n\n   <clr-stack-content ng-if="!$ctrl.isMarkedForRemoval()">\n      <div class="select"><select ng-model="$ctrl.pluginValue"\n                                  ng-options="item as item for item in $ctrl.pluginList">\n      </select></div>\n      <a test-id="remove"\n         class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"\n         ng-click="$ctrl.removeDevice()" ng-disabled="$ctrl.isRemoveDisabled()"></a>\n   </clr-stack-content>\n\n   <!--Alternate header when device marked for removal -->\n\n   <clr-stack-content ng-if="$ctrl.isMarkedForRemoval()">\n      {{ $ctrl.i18nService.getString(\'VmUi\', \'RemoveDevice.DeviceRemoved\') }}\n      <a test-id="restore"\n         class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n      <a test-id="restsore"\n         class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         ng-click="$ctrl.revertRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <!-- GPU profile selector -->\n\n   <clr-stack-block>\n      <clr-stack-label>{{ ::$ctrl.i18n("GPUProfile")}}</clr-stack-label>\n      <!--Either select dropdown or input text -->\n\n      <clr-stack-content ng-if="$ctrl.isProfileSelectVisible()">\n         <div class="select"><select ng-model="$ctrl.profile" ng-disable="$ctrl=isProfileValueDisabled()"\n                                     ng-options="item as item for item in $ctrl.profileList">\n         </select></div>\n      </clr-stack-content>\n\n      <clr-stack-content ng-if="$ctrl.isProfileInputVisible()">\n         <input type="text" ng-model="$ctrl.profile" ng-disable="$ctrl=isProfileValueDisabled()"/>\n      </clr-stack-content>\n\n   </clr-stack-block>\n\n   <!--Reserve memory-->\n\n   <clr-stack-block ng-if="$ctrl.showMemorySection()">\n      <clr-stack-label></clr-stack-label>\n      <clr-stack-content>\n         <div><span class="vx-icon-warn"></span><span test-id="mem-txt">{{$ctrl.i18n(\'Warning\')}}</span>\n         </div>\n      </clr-stack-content>\n\n      <clr-stack-content>\n         <button ng-click="$ctrl.reserveAllMemory()" test-id="mem-btn">\n            {{$ctrl.i18n("Reserve")}}\n         </button>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Note: Some virtual machine operations are unavailable when PCI/PCIe passthrough devices are present. -->\n   <!--You cannot suspend, migrate with vMotion, or take or restore snapshots of such virtual machines.-->\n\n   <clr-stack-block>\n      <clr-stack-content>\n         <div><span class="vx-icon-warn"></span><span test-id="note">{{$ctrl.i18n(\'Note\')}}</span>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareRDMVirtualDisk/vm-hardware-rdm-virtual-disk.html",'<clr-stack-block\n      class="virtual-disk"\n      ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.hasChanged()}"\n      ng-form\n      name="$ctrl.vmHardwareRdmVirtualDisk{{$ctrl.formKey}}"\n      [(clr-sb-expanded)]="$ctrl.expanded"\n      (clr-sb-expanded-change)="$ctrl.expandedChanged($event)"\n      [(clr-sb-expandable)]="$ctrl.isExpandable()"\n      ng-switch="$ctrl.expanded">\n\n   <clr-stack-label ng-class="{\'error-child-component\': $ctrl.hasError()}">\n      <span>{{::$ctrl.deviceLabel}}</span>\n   </clr-stack-label>\n\n   <clr-stack-content ng-if="$ctrl.markedForRemoval()">\n      {{::$ctrl.deviceRemovedLabel}}\n      <label class="normal-weight" ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         <input name="destroyDisk"\n                aria-label="{{::$ctrl.deviceRemovedLabel}}"\n                type="checkbox"\n                ng-model="$ctrl.destroyDisk"\n                ng-change="$ctrl.onDiskDistroyStatusChange()"\n         />\n\n         <span tabindex="0" ng-bind="::$ctrl.deleteFilesLabel"></span>\n      </label>\n      <a tabindex="0" aria-label="{{::$ctrl.revertRemovalLabel}}"\n            class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         ng-click="$ctrl.revertRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <clr-stack-content ng-if="!$ctrl.markedForRemoval()">\n      <div tabindex="0" ng-if="$ctrl.isGroupingHardDisks">\n         {{$ctrl.getDiskText()}} | {{$ctrl.getSelectedVirtualNodeText()}}\n\t  </div>\n      <div>\n         <vx-value-in-units name="capacity"\n                            ng-if="$ctrl.capacity.validUnits && !$ctrl.isGroupingHardDisks"\n                            is-disabled="true"\n                            type="number"\n                            ng-model-options = "{allowInvalid: true,\n                                 getterSetter: true}"\n                            ng-model="$ctrl.capacity.valueInMB"\n                            unit-options="$ctrl.capacity.validUnits"\n                            min="{{$ctrl.capacity.minInMB}}"\n                            max="{{$ctrl.capacity.maxInMB}}"\n                            default-unit="{{$ctrl.capacity.memoryUnitPreferred}}"\n                            error-messages="$ctrl.errorMessages"\n                            custom-validators="$ctrl.validators">\n         </vx-value-in-units>\n      </div>\n\n      <a class="vsphere-icon-action-remove remove-device stack-view-row-action"\n         ng-disabled="$ctrl.isRemoveDisabled()"\n         tabindex="0"\n         aria-label="{{::$ctrl.removeLabel}}"\n         ng-click="$ctrl.onRemove()"></a>\n   </clr-stack-content>\n\n   <!-- Dummy element to render when not expanded to force label to take space -->\n   <clr-stack-block ng-if="!$ctrl.expanded">\n      <clr-stack-label>\n      </clr-stack-label>\n      <clr-stack-content>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Storage Profile -->\n   <clr-stack-block ng-if="$ctrl.shouldDisplayStorageProfile">\n      <clr-stack-label ng-attr-title="{{ ::$ctrl.storageProfileLabel }}"\n                       ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.storageProfileLabel}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div>\n            <div>\n               <vm-hardware-virtual-disk-storage-profile\n                  name="storage-profile"\n                  aria-label="$ctrl.storageProfileLabel"\n                  display-mode="$ctrl.displayMode"\n                  vm-storage-profile-metadata="$ctrl.vmStorageProfileMetadata"\n                  on-change="$ctrl.onStorageProfileChange(selectedProfile)"\n                  error-config="$ctrl.diskProfileErrorConfig">\n               </vm-hardware-virtual-disk-storage-profile>\n            </div>\n            <div ng-if="$ctrl.isEncryptionProfileApplied()">\n               <clr-icon shape="info-circle" class="is-highlight" size="20"></clr-icon>\n               <span tabindex="0">{{::$ctrl.i18n(\'DiskPage.encryptionPolicyDecription\')}}</span>\n            </div>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Disk Location -->\n   <clr-stack-block class="vm-disk-block" ng-if="$ctrl.isNewDevice()">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.locationLabel}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-location\n            display-mode="$ctrl.displayMode"\n            aria-label="$ctrl.locationLabel"\n            vm-storage-profile-metadata="$ctrl.vmStorageProfileMetadata"\n            vm-storage-browser-metadata="$ctrl.vmStorageBrowserMetadata"\n            on-change="$ctrl.onLocationChange(selectedStorageProfile, selectedStorageItem)"\n            vm-id="$ctrl.vmId"\n            disk-location-error="$ctrl.diskLocationError"\n            datastore="$ctrl.vmConfigContext.environment.configTarget.datastore"\n            selected-storage="$ctrl.selectedStorage"\n            show-storage-pods="$ctrl.showStoragePods">\n         </vm-hardware-virtual-disk-location>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Disk Sharing-->\n   <clr-stack-block ng-switch-when="true">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.sharingLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-sharing\n            aria-label="$ctrl.sharingLabel"\n            display-mode="$ctrl.displayMode"\n            sharing-info="$ctrl.sharingInfo"\n            on-change="$ctrl.onSharingChange(sharing)">\n         </vm-hardware-virtual-disk-sharing>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Physical LUN -->\n   <clr-stack-block ng-if="$ctrl.shouldDisplayPhysicalLun">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.physicalLunLabel}}\n      </clr-stack-label>\n      <clr-stack-content class="wrap-content">\n         <span tabindex="0"\n               aria-label="{{$ctrl.physicalLunLabel + \' - \' + $ctrl.physicalLunInfo.name}}">\n            {{::$ctrl.physicalLunInfo.name}}\n         </span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Disk Compatibility Mode -->\n   <clr-stack-block ng-if="$ctrl.shouldDisplayCompatibilityMode">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.compatibilityModeLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-compatibility-mode\n            aria-label="$ctrl.compatibilityModeLabel"\n            is-disabled="!$ctrl.isCompatibilityModeEditable"\n            compatibility-mode-info="$ctrl.compatibilityModeInfo"\n            on-change="$ctrl.onCompatibilityModeChange(compatibilityMode)">\n         </vm-hardware-virtual-disk-compatibility-mode>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Disk Mode -->\n   <clr-stack-block ng-if="$ctrl.shouldDisplayDiskMode">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.diskModeLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-mode\n            is-disabled="$ctrl.isDiskModeDisabled()"\n            aria-label="$ctrl.diskModeLabel"\n            disk-mode-info="$ctrl.diskModeInfo"\n            on-change="$ctrl.onDiskModeChange(diskMode)">\n         </vm-hardware-virtual-disk-mode>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Disk Provisioning-->\n\n   <!--Disk Page-->\n   <clr-stack-block ng-if="$ctrl.displayDiskFile">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.diskFileLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <span tabindex="0"\n         aria-label="{{$ctrl.diskFileLabel + \' - \' + $ctrl.diskFile}}">\n            {{$ctrl.diskFile}}\n         </span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Disk Shares-->\n   <clr-stack-block ng-switch-when="true">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.sharesLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-shares display-mode="$ctrl.displayMode"\n                                          aria-label="$ctrl.sharesLabel"\n                                          shares-context="$ctrl.sharesContext"\n                                          is-disabled="$ctrl.isSharesDisabled()"\n                                          on-change="$ctrl.onSharesChange(shares)">\n         </vm-hardware-virtual-disk-shares>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Limit IOPS-->\n   <clr-stack-block ng-switch-when="true">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.iopsLimitLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-iops iops-limit="$ctrl.iopsLimit"\n                                        aria-label="$ctrl.iopsLimitLabel"\n                                        on-change="$ctrl.onIopsLimitChange(iopsLimit)"\n                                        is-disabled="$ctrl.isEditIopsLimitDisabled()">\n         </vm-hardware-virtual-disk-iops>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Cache Reservation-->\n   <clr-stack-block ng-if="$ctrl.shouldDisplayFlashCache">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.cacheReservationLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-flash-read-cache flash-cache-reservation-info="$ctrl.flashCacheInfo"\n                                                    aria-label="$ctrl.cacheReservationLabel"\n                                                    is-disabled="$ctrl.isFlashCacheReservationDisabled"\n                                                    on-change="$ctrl.onFlashCacheReservationChange(flashCacheReservation)">\n         </vm-hardware-virtual-disk-flash-read-cache>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--Virtual Device Node-->\n   <clr-stack-block ng-switch-when="true">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': $ctrl.isGroupingHardDisks}">\n         {{::$ctrl.deviceNodeLabel}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-controller-and-node\n            inflated-device="$ctrl.deviceNodeInfo.inflatedDevice"\n            virtual-machine-devices="$ctrl.deviceNodeInfo.virtualMachineDevices"\n            selector-name="$ctrl.deviceNodeInfo.controllerNodeSelectorName"\n            controller-selector-name="$ctrl.deviceNodeInfo.controllerSelectorName"\n            available-controllers="$ctrl.deviceNodeInfo.virtualDiskSettingsForm.controllers.options"\n            device-controller="$ctrl.deviceNodeInfo.virtualDiskSettingsForm.controllers.selection"\n            node="$ctrl.deviceNodeInfo.virtualDiskSettingsForm.selectedControllerNode"\n            power-state="$ctrl.deviceNodeInfo.vmConfigContext.environment.powerState"\n            privileges="$ctrl.deviceNodeInfo.vmConfigContext.privileges"\n            on-controller-change-callback="$ctrl.onDiskControllerChange"\n            >\n         </vm-hardware-controller-and-node>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareScsiController/vmHardwareScsiController.html",'<clr-stack-block\n      class="vm-hardware-scsi-controller"\n      ng-form\n      name="$ctrl.vmHardwareScsiControllerForm"\n      ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.inflatedDevice.hasChanged()}"\n      [(clr-sb-expanded)]="$ctrl.expanded">\n    <clr-stack-label>\n        {{ $ctrl.device.deviceInfo.label }}\n    </clr-stack-label>\n\n    <clr-stack-content ng-if="$ctrl.inflatedDevice.isMarkedForRemoval()">\n        {{::$ctrl.i18n(\'RemoveDevice.DeviceRemoved\')}}\n        <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n           ng-click="$ctrl.inflatedDevice.revertRemoval()">\n        </a>\n    </clr-stack-content>\n    <clr-stack-content ng-if="!$ctrl.inflatedDevice.isMarkedForRemoval()">\n        <label class="normal-weight" name="deviceType">\n          {{ $ctrl.deviceName }}\n        </label>\n        <a class="vsphere-icon-action-remove remove-device stack-view-row-action"\n           ng-disabled="!$ctrl.isRemoveScsiControllerEnabled()"\n           ng-click="$ctrl.onScsiControllerRemove()"></a>\n    </clr-stack-content>\n\n    <clr-stack-block>\n        <clr-stack-label>\n            {{ ::$ctrl.LBL_TYPE }}\n        </clr-stack-label>\n        <clr-stack-content>\n            <div class="select">\n                <select name="editScsiController{{$ctrl.device.key}}TypeList"\n                        aria-label="{{::$ctrl.LBL_TYPE}}"\n                        ng-disabled="$ctrl.isEditScsiControllerDisabled()"\n                        ng-model="$ctrl.properties.selectedScsiType"\n                        ng-options="scsiType.name for scsiType in $ctrl.scsiTypeList track by scsiType.id"\n                        ng-change="$ctrl.onScsiControllerTypeChange()">\n                </select>\n            </div>\n            <div class="unsupported-scsi-type-warning" ng-if="$ctrl.unsupportedWarning">\n                <span class="vx-icon-warn"></span>\n                <span>{{$ctrl.unsupportedWarning}}</span>\n            </div>\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block>\n        <clr-stack-label>\n            {{ ::$ctrl.LBL_SHARING }}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            <div class="select">\n               <select name="editBusSharing{{$ctrl.device.key}}List"\n                       aria-label="{{::$ctrl.LBL_SHARING}}"\n                       ng-disabled="$ctrl.isEditScsiControllerDisabled()"\n                       ng-model="$ctrl.properties.selectedBusSharing"\n                       ng-change="$ctrl.onScsiBusSharingChange()"\n                       ng-options="busSharing.name for busSharing in $ctrl.busSharingList track by busSharing.id">\n               </select>\n            </div>\n        </clr-stack-content>\n    </clr-stack-block>\n\n</clr-stack-block>\n\n\n\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareSerialPort/vm-hardware-serial-port-file-browser.html",'<div ng-controller="vmHardwareSerialPortFileBrowserController as ctrl">\n   <span>{{ ::ctrl.i18n("SerialPortPage.FileBrowser.Subtitle") }}</span>\n\n   <form name="serialPortFileBrowserForm">\n      <section class="form-block">\n         <div class="form-group">\n            <label for="serial-port-save-as">{{ ::ctrl.i18n("SerialPortPage.FileBrowser.SaveAs") }}</label>\n            <input type="text" id="serial-port-save-as" size="35"\n                  ng-model="ctrl.formData.fileName"\n                  placeholder="{{ ::ctrl.i18n(\'SerialPortPage.FileBrowser.SaveAs.Placeholder\') }}">\n         </div>\n\n         <div class="form-group">\n            <label>{{ ::ctrl.i18n("SerialPortPage.FileBrowser.SaveTo") }}</label>\n            <datastore-file-browser\n                  object-id="ctrl.dsFileBrowserData.vmId"\n                  datastore-ids="ctrl.dsFileBrowserData.datastoreIds"\n                  initial-file-query-type="ctrl.dsFileBrowserData.initialFileQueryType"\n                  show-vm-images-folder="ctrl.dsFileBrowserData.showVmImagesFolder"\n                  disable-preselect="ctrl.dsFileBrowserData.disablePreselect"\n                  selected-tree-item="ctrl.formData.selectedTreeItem">\n            </datastore-file-browser>\n         </div>\n\n         <div class="form-group" ng-if="ctrl.hasValidFileNameAndFolderLocation()">\n            <label>{{ ::ctrl.i18n("vmProvisioningFinishPage.DiskFilePath") }}</label>\n            <span>{{ ctrl.getFilePath() }}</span>\n         </div>\n      </section>\n   </form>\n</div>'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareSerialPort/vm-hw-serial-port.html",'<clr-stack-block\n   ng-form name="$ctrl.form"\n   ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.hasChanged}"\n   [(clr-sb-expanded)]="$ctrl.expanded">\n\n   <!-- Backing type (file, device, pipe, network) and checkbox (either connect or Connect or Connect at power on)-->\n\n   <clr-stack-label test-id="serial-block-label"\n                    ng-class="{\'error-child-component\': !$ctrl.revalidate()}">\n      <span>{{::$ctrl.deviceLabel}}</span>\n   </clr-stack-label>\n\n   <clr-stack-content ng-if=$ctrl.NotMarkedForRemoval>\n      <div class="select"><select test-id="backing"\n                                  ng-model=$ctrl.backingValue\n                                  ng-disabled=$ctrl.isEditDisabled\n                                  ng-options="item as $ctrl.getBackingLabel(item) for item in $ctrl.backingList track by $ctrl.getBackingLabel(item)"></select>\n      </div>\n\n      <label ng-if="$ctrl.showStartConnectedInHeader" ng-class={"div-disabled":$ctrl.isConnectDisabled}>\n         <input type="checkbox" test-id="startConnected"\n                ng-model=\'$ctrl.startConnected\'\n                ng-disabled="$ctrl.isConnectDisabled">\n         {{::$ctrl.LABELS.START_CONNECTED_SHORT}}\n      </label>\n\n      <label ng-if="$ctrl.showConnectedInHeader" ng-class={"div-disabled":$ctrl.isConnectDisabled}>\n         <input test-id="connected" type="checkbox" ng-model=\'$ctrl.connected\'\n                ng-disabled="$ctrl.isConnectDisabled"> {{ ::$ctrl.LABELS.CONNECTED}}\n      </label>\n\n      <a class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"\n         ng-click="$ctrl.remove()" ng-disabled="$ctrl.isRemoveDisabled"\n         test-id="remove"></a>\n\n   </clr-stack-content>\n\n\n   <!--Alternate header when device marked for removal -->\n\n   <clr-stack-content ng-if="$ctrl.isMarkedForRemoval">\n      {{::$ctrl.LABELS.REMOVING }}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         ng-click="$ctrl.restore()" test-id="restore"> </a>\n   </clr-stack-content>\n\n   <!--First row - label "Status", checkbox "Connect at power on"-->\n\n   <clr-stack-block>\n      <clr-stack-label>{{ ::$ctrl.LABELS.STATUS}}</clr-stack-label>\n      <clr-stack-content>\n         <label ng-class={"div-disabled":$ctrl.isConnectDisabled}>\n            <input type="checkbox" test-id="startConnected2"\n                  ng-model=\'$ctrl.startConnected\'\n                  ng-disabled="$ctrl.isConnectDisabled">\n            {{::$ctrl.LABELS.START_CONNECTED}}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- FILE BACKING -->\n\n   <clr-stack-block ng-if="$ctrl.showFileBacking">\n      <clr-stack-label> {{ ::$ctrl.LABELS.OUTPUT_FILE}}</clr-stack-label>\n      <clr-stack-content>\n\n         <label for="file" aria-haspopup="true" role="tooltip"\n               class="tooltip tooltip-validation tooltip-lg tooltip-top-left"\n               ng-class="{\'invalid\': $ctrl.isFileInvalid}">\n            <input id=file test-id="file" type="text" size="30" ng-model="$ctrl.file"\n                  placeholder={{::$ctrl.filePlaceHolder}} disabled>\n            <span class="tooltip-content">{{$ctrl.fileError}}</span>\n         </label>\n\n         <button class="btn btn-sm btn-link" id="browse" test-id="browse"\n               ng-disabled="$ctrl.isEditDisabled"\n               ng-click="$ctrl.browse()">\n            {{ ::$ctrl.LABELS.BROWSE}}\n         </button>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- PHYSICAL SERIAL PORT BACKING (aka device backing) -->\n\n   <clr-stack-block ng-if="$ctrl.showDeviceBacking">\n      <clr-stack-label> {{::$ctrl.LABELS.PHYSICAL}}</clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select test-id="device"\n                    ng-model="$ctrl.deviceValue"\n                    ng-disabled="$ctrl.isEditDisabled"\n                    ng-options="item as item for item in $ctrl.deviceList"></select>\n\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- URI (network) BACKING -->\n\n   <clr-stack-block ng-if="$ctrl.showURIBacking">\n      <clr-stack-label> {{ ::$ctrl.LABELS.DIRECTION}}</clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select test-id="dir"\n                    ng-model="$ctrl.directionValue"\n                    ng-disabled="$ctrl.isEditDisabled"\n                    ng-options="item as $ctrl.getDirectionLabel(item) for item in $ctrl.directionList">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.showURIBacking">\n      <clr-stack-label> {{ ::$ctrl.LABELS.PORT_URI}}</clr-stack-label>\n      <clr-stack-content>\n         <label for="service" aria-haspopup="true" role="tooltip"\n                class="tooltip tooltip-validation tooltip-lg tooltip-top-left"\n                ng-class="{\'invalid\': $ctrl.isServiceInvalid}">\n            <input id="service" test-id="service" type="text"\n                   ng-disabled="$ctrl.isEditDisabled"\n                   ng-model="$ctrl.serviceURI"/>\n            <span class="tooltip-content">{{$ctrl.serviceError}}</span>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.showURIBacking">\n      <clr-stack-label></clr-stack-label>\n      <clr-stack-content>\n         <input id="vspc" test-id="vspc" type="checkbox"\n               ng-disabled="$ctrl.isEditDisabled"\n               ng-model="$ctrl.vspc"/>\n         <label for="vspc" ng-class={"div-disabled":$ctrl.isEditDisabled}>\n            {{::$ctrl.LABELS.USE_VSPCURI}}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.showProxy && $ctrl.vspc">\n      <clr-stack-label> {{ ::$ctrl.LABELS.VSPCURI}}</clr-stack-label>\n      <clr-stack-content>\n         <label for="proxy" aria-haspopup="true" role="tooltip"\n                class="tooltip tooltip-validation tooltip-lg tooltip-top-left"\n                ng-class="{\'invalid\': $ctrl.isProxyInvalid}">\n            <input id="proxy" test-id="proxy" type="text" ng-model="$ctrl.proxy"\n                   ng-disabled="$ctrl.isProxyDisabled"/>\n            <span class="tooltip-content">{{$ctrl.proxyError}}</span>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- PIPE BACKING -->\n\n   <clr-stack-block ng-if="$ctrl.showPipeBacking">\n      <clr-stack-label> {{ ::$ctrl.LABELS.PIPE_NAME}}</clr-stack-label>\n      <clr-stack-content>\n         <label for="pipe" aria-haspopup="true" role="tooltip"\n                class="tooltip tooltip-validation tooltip-lg tooltip-top-left"\n                ng-class="{\'invalid\': $ctrl.isPipeInvalid}">\n            <input test-id="pipe" id="pipe" type="text"\n                   ng-model="$ctrl.pipe"\n                   ng-disabled="$ctrl.isEditDisabled"\n            />\n            <span class="tooltip-content">{{$ctrl.port.getPipeError()}}</span>\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.showPipeBacking">\n      <clr-stack-label> {{ ::$ctrl.LABELS.NEAR_END}}</clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select test-id="near"\n                    ng-model="$ctrl.nearEndValue"\n                    ng-disabled="$ctrl.isEditDisabled"\n                    ng-options="item as $ctrl.getNearEndLabel(item) for item in $ctrl.nearEndList">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.showPipeBacking">\n      <clr-stack-label> {{ ::$ctrl.LABELS.FAR_END}}</clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select\n               test-id="far"\n               ng-model="$ctrl.farEndValue"\n               ng-disabled="$ctrl.isEditDisabled"\n               ng-options="item as $ctrl.getFarEndLabel(item) for item in $ctrl.farEndList">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.expanded">\n      <clr-stack-label>{{::$ctrl.LABELS.IO_MODE }}</clr-stack-label>\n      <clr-stack-content>\n         <div ng-class={"disabled":$ctrl.isEditDisabled}>\n            <input type="checkbox" id="yield{{$ctrl.ID}}" test-id="yield"\n                  ng-model="$ctrl.yield"\n                  ng-disabled="$ctrl.isEditDisabled">\n            <label ng-class={"div-disabled":$ctrl.isEditDisabled}\n                  for="yield{{$ctrl.ID}}">{{::$ctrl.LABELS.YIELD_CPU}}</label>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n   <!--END OF THE PAGE -->\n</clr-stack-block>\n'),
e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareTpm/tpm-help-text.html",'<div>\n    <p class="tpm-help-text">\n        {{actionableText}}\n        {{extraText}}\n        <a target="_blank"\n           href="{{kbArticleLink}}">\n            {{linkLabel}}\n        </a>\n    </p>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareTpm/vm-hardware-tpm.component.html",'<clr-modal\n        [(clr-modal-open)]="$ctrl.showModal"\n        [clr-modal-closable]="true"\n        class="delete-tpm-modal">\n    <h3 class="modal-title">\n        {{ ::$ctrl.i18n(\'VmDeviceManager.TpmModal.Title\') }}\n    </h3>\n    <div class="modal-body">\n        <p>\n            {{ ::$ctrl.i18n(\'VmDeviceManager.TpmModal.Body\') }}\n        </p>\n    </div>\n    <div class="modal-footer">\n        <button type="button" class="btn btn-outline" ng-click="$ctrl.onCancelModalWarning()">\n            {{ ::$ctrl.i18n(\'VmDeviceManager.TpmModal.Footer.CancelButton\') }}\n        </button>\n        <button type="button" class="btn btn-warning" ng-click="$ctrl.onAcceptModalWarning()">\n            {{ ::$ctrl.i18n(\'VmDeviceManager.TpmModal.Footer.DeleteButton\') }}\n        </button>\n    </div>\n</clr-modal>\n\n<clr-stack-block\n        class="vm-hardware-tpm"\n        name="vmHardwareCdRomForm{{$ctrl.tpmDevice.getCurrentDevice().key}}"\n        ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.tpmDevice.hasChanged()}">\n   <clr-stack-label class="tpm_label">\n         {{ ::$ctrl.i18n(\'VmDeviceManager.NewTPM\') }}\n   </clr-stack-label>\n\n    <clr-stack-content ng-if="$ctrl.tpmDevice.isMarkedForRemoval()">\n        <span>\n            {{ ::$ctrl.i18n(\'RemoveDevice.DeviceRemoved\') }}\n        </span>\n        <a aria-label="{{ ::$ctrl.i18n(\'RemoveDevice.RevertRemoval\')}}"\n              class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n           ng-click="$ctrl.tpmDevice.revertRemoval()">\n        </a>\n    </clr-stack-content>\n    <clr-stack-content ng-if="!$ctrl.tpmDevice.isMarkedForRemoval()">\n        <span>\n            <label class="normal-weight">\n                <span ng-if="$ctrl.tpmDevice.state === $ctrl.tpmDevice.CONNECTED">\n                    {{ $ctrl.i18n(\'VmDeviceManager.TPMPresent\') }}\n                </span>\n\n                <span ng-if="$ctrl.tpmDevice.state === $ctrl.tpmDevice.CONNECTING">\n                    {{ $ctrl.i18n(\'VmDeviceManager.TPMConnecting\') }}\n                </span>\n\n                <span class="error-border" ng-if="$ctrl.tpmDevice.state === $ctrl.tpmDevice.NOT_CONNECTED">\n                    {{ $ctrl.i18n(\'VmDeviceManager.TPMInvalid\') }}\n                </span>\n            </label>\n            <a vui-sign-post="$ctrl.tpmSignPostParams" class="pull-right ng-isolate-scope k-state-border-down">\n                <img ng-src="resources/img/info_normal.png" src="resources/img/info_normal.png">\n            </a>\n        </span>\n        <a ng-class="{\'div-disabled\': $ctrl.isTpmRemovalDisabled()}"\n           aria-label="{{ ::$ctrl.i18n(\'VmDeviceManager.TPMRemove\')}}"\n           class="vsphere-icon-action-remove remove-device stack-view-row-action"\n           ng-disabled="$ctrl.isTpmRemovalDisabled()"\n           ng-click="$ctrl.onTpmRemoval()"></a>\n    </clr-stack-content>\n\n   <clr-stack-block ng-repeat="tpmCertificate in $ctrl.tpmCertificates">\n      <clr-stack-label>\n         {{ tpmCertificate.algorithmName }}-{{tpmCertificate.publicKeyAlgorithmName}}\n      </clr-stack-label>\n      <clr-stack-content>\n             <tpm-certificate-selector\n                    tpm-certificate="tpmCertificate"\n                    on-certificate-change="$ctrl.onCertificateUpdate(uploadedCertificate, originalCertificate)"\n             >\n             </tpm-certificate-selector>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareUsbController/vm-hardware-usb-controller.html",'<clr-stack-block [(clr-sb-expanded)]="$ctrl.expanded" class="vm-hardware-usb-controller">\n\n   <clr-stack-label>{{$ctrl.getDeviceLabel()}}\n      <span class="vx-icon-warn" ng-if="$ctrl.isUnsupportedByGuest()"/>\n   </clr-stack-label>\n\n   <!--Header section -->\n\n   <clr-stack-content ng-if="!$ctrl.isMarkedForRemoval()">\n\n      <!-- Readonly label 2.0 vs 3.0 for existing USB controller-->\n\n      <label data-test-id="usb-type-label-id" ng-if="!$ctrl.isUsbTypeEditable()">\n         {{$ctrl.getUSBLabel()}}\n      </label>\n\n      <!-- Selectable USB type ( 2.0 vs 3.0) - when adding USB controller -->\n\n      <div class="select" ng-if="$ctrl.isUsbTypeEditable()">\n         <select data-test-id="usb-type-select-id"\n                 aria-label="{{::$ctrl.getDeviceLabel()}}"\n                 ng-model="$ctrl.usbType"\n                 ng-options="item as $ctrl.getUsbTypeLabel(item) for item in $ctrl.getUsbTypeList()">\n         </select>\n      </div>\n\n      <!-- Device removal icon-->\n\n      <a class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"\n         ng-disabled="$ctrl.isRemoveDisabled()"\n         ng-click="$ctrl.removeDevice()"></a>\n\n   </clr-stack-content>\n\n   <!--Alternate header when device marked for removal -->\n\n   <clr-stack-content ng-if="$ctrl.isMarkedForRemoval()">\n      {{ ::$ctrl.i18nService.getString(\'VmUi\', \'RemoveDevice.DeviceRemoved\') }}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         ng-click="$ctrl.revertRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <!--Body section - guest warning text as needed -->\n\n   <clr-stack-block>\n      <clr-stack-content>\n         <div ng-if="$ctrl.isUnsupportedByGuest()">\n            <span class="vx-icon-warn"/>\n            <span>{{$ctrl.i18n(\'NoGuestDriver\')}}</span>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareUsbDevice/vm-hardware-usb-device.html",'<clr-stack-block [(clr-sb-expanded)]="$ctrl.expanded"\n      class="vm-hardware-usb-controller"\n      ng-form name="$ctrl.vmHardwareUsbDevice">\n\n   <clr-stack-label ng-class="{ \'error-child-component\': $ctrl.hasError() }">\n      <span>{{$ctrl.getDeviceLabel()}}</span>\n   </clr-stack-label>\n\n   <!--Header section -->\n\n   <!--Selector to choose host USB device (new device only) -->\n\n   <clr-stack-content ng-if="$ctrl.isNew()">\n\n      <div class="select" ng-if="$ctrl.isNew()" ng-class="{ \'has-error\' : $ctrl.hasError() }">\n         <select name="newDevice"\n                 test-id="usb-select"\n                 ng-model="$ctrl.hostUsb"\n                 ng-change="$ctrl.validateUSBSelection()"\n                 ng-options="item as $ctrl.getHostUsbLabel(item) for item in $ctrl.getHostUsbList() track by item.physicalPath"\n                 vx-error="$ctrl.usbError">\n         </select>\n      </div>\n\n      <a class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"  ng-if="$ctrl.isNew()"  ng-click="$ctrl.removeDevice()" ></a>\n\n   </clr-stack-content>\n\n   <!--Readonly label showing Host USB device (editing device) -->\n\n   <clr-stack-content ng-if="!$ctrl.isNew()">\n\n      <label test-id="usb-device-label"\n             ng-if="!$ctrl.isMarkedForRemoval()">\n         {{$ctrl.getUsbDeviceLabel()}}\n      </label>\n\n      <!-- Device removal icon-->\n\n      <a class="vsphere-icon-action-remove pull-right remove-device stack-view-row-action"\n         ng-if="!$ctrl.isNew() && !$ctrl.isMarkedForRemoval()"\n         ng-disabled="$ctrl.isRemoveDisabled()"\n         ng-click="$ctrl.removeDevice()"></a>\n\n   </clr-stack-content>\n\n\n   <!--Alternate header when device marked for removal/restore icons -->\n\n   <clr-stack-content ng-if="$ctrl.isMarkedForRemoval()">\n      {{ ::$ctrl.i18nService.getString(\'VmUi\', \'RemoveDevice.DeviceRemoved\') }}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         ng-click="$ctrl.revertRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <!--showing existing device-->\n\n   <!-- Row 1 - says: "USB Device ||| This device is currently present/not present on the host  "-->\n\n   <clr-stack-block ng-if="!$ctrl.isNew()">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'USBDevice\')}}</clr-stack-label>\n      <clr-stack-content>\n         <label test-id="device-present">\n            {{ ::($ctrl.isDevicePresent()? $ctrl.i18n(\'Present\'):\n            $ctrl.i18n(\'NotPresent\')) }}\n         </label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Row 2 - says:  USB Unique ID ||| host:bla1 path: bla2 -->\n\n   <clr-stack-block ng-if="!$ctrl.isNew()">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'USBUniqueID\')}}</clr-stack-label>\n      <clr-stack-content><label test-id="unique-id">{{ ::$ctrl.USBUniqueID}}</label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Row 3 - says : Status Connected/Disconnected -->\n\n   <clr-stack-block ng-if="!$ctrl.isNew()">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'Status\')}}</clr-stack-label>\n      <clr-stack-content><label test-id="connection-status">{{\n         ::$ctrl.getUSBConnectionStatusText()}}</label></clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Row 4 - says: vMotion support |||\n   - Connection to this device will persist through a migration with vMotion\n   OR\n   - Cannot migrate with vMotion while device is connected.\n   -->\n\n   <clr-stack-block ng-if="!$ctrl.isNew()">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'VMotionSupport\')}}</clr-stack-label>\n      <clr-stack-content>\n         <label data-test-id="vmotion-support">{{\n            ::$ctrl.getVMotionSupportText()}}</label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!--ADDING NEW DEVICE - only visible when adding new USB device -->\n\n   <!--Dumb port from C# - if device configured AND connected to another running VM - show that VM  -->\n\n   <clr-stack-block ng-if="$ctrl.isNew()">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'SelectHostDevice\')}}</clr-stack-label>\n      <clr-stack-content><label test-id="device-available">{{\n         $ctrl.getDeviceAvailableText()}}</label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <!-- Checkbox for vMotion -->\n\n   <clr-stack-block ng-if="$ctrl.isNew()">\n      <clr-stack-label>{{ ::$ctrl.i18n(\'VMotionSupport\')}}</clr-stack-label>\n\n      <clr-stack-content>\n         <label><input type="checkbox"  name="vMotion" ng-model="$ctrl.vMotion"/>{{ ::$ctrl.i18n(\'VMotionConnected\')}}</label>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVideoCard/vm-hw-video-card.html",'<clr-stack-block\n   class="video"\n   ng-form name="$ctrl.vmHardwareVideoCardForm"\n   ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.hasChanged()}"\n   [(clr-sb-expanded)]="$ctrl.expanded">\n\n   <clr-stack-label ng-class="{\'error-child-component\': $ctrl.hasError()}">\n      <span>{{ ::$ctrl.i18n(\'Title\') }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content>\n      <div class="select">\n         <select\n            test-id="useAutoDetect"\n            aria-label="{{::$ctrl.ARIA_LBL_VIDEO}}"\n            ng-model="$ctrl.useAutoDetect"\n            ng-disabled="$ctrl.useAutoDetect_isEditDisabled()"\n            ng-options="item as $ctrl.useAutoDetect_Text(item) for item in $ctrl.useAutoDetect_List()"></select>\n      </div>\n      </select>\n   </clr-stack-content>\n\n   <clr-stack-block>\n\n      <clr-stack-label>{{ $ctrl.i18n(\'NumberOfDisplays\') }}</clr-stack-label>\n\n      <clr-stack-content ng-if="$ctrl.expanded">\n         <div class="select">\n            <select test-id="numberOfDisplays"\n                    aria-label="{{::$ctrl.ARIA_LBL_NUM_DISPLAYS}}"\n                    ng-model="$ctrl.numberOfDisplays"\n                    ng-disabled="$ctrl.numberOfDisplays_isEditDisabled()"\n                    ng-options="item as item for item in $ctrl.numberOfDisplays_List() track by item"></select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.expanded">\n      <clr-stack-label>{{ $ctrl.i18n(\'TotalVideoMemory\') }}</clr-stack-label>\n      <clr-stack-content>\n\n         <label aria-haspopup="true" role="tooltip"\n                class="tooltip tooltip-validation  tooltip-lg tooltip-top-left"\n                ng-class="{\'invalid\': $ctrl.videoRamSizeInKB_isInvalid()}">\n\n            <input type="text"\n                   aria-label="{{::$ctrl.ARIA_LBL_VRAM}}"\n                   test-id="videoRamSizeInKB"\n                   name="videoRamSizeInKB"\n                   ng-model="$ctrl.videoRamSizeInKB"\n                   ng-disabled="$ctrl.videoRamSizeInKB_isEditDisabled()"/>\n\n            <span class="tooltip-content">{{ $ctrl.videoRamSizeInKB_getError() }}</span></label>\n         <span>{{::$ctrl.i18n(\'MB\')}}</span>\n\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.expanded && $ctrl.enable3DSupport_isVisible()">\n      <clr-stack-label>\n         {{ ::$ctrl.i18n(\'3DGraphics\') }}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <input type="checkbox"\n                aria-label="{{::$ctrl.ARIA_LBL_3D}}"\n                test-id="enable3DSupport"\n                ng-model="$ctrl.enable3DSupport"\n                ng-disabled="$ctrl.enable3DSupport_isEditDisabled()"/>\n         <span ng-class="{\'div-disabled\': $ctrl.enable3DSupport_isEditDisabled()}">{{::$ctrl.i18n(\'Enable3DSupport\')}}</span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.expanded && $ctrl.getAutoIncreaseVisible()">\n      <span >{{ $ctrl.getAutoIncreaseText() }}</span>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.expanded && $ctrl.use3dRenderer_isVisible()">\n      <clr-stack-label>{{ $ctrl.i18n(\'3DRenderer\') }}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select\n                 test-id="use3dRenderer"\n                 aria-label="{{$ctrl.ARIA_LBL_3DRNDR}}"\n                 ng-model="$ctrl.use3dRenderer"\n                 ng-disabled="$ctrl.use3dRenderer_isEditDisabled()"\n                 ng-options="item as $ctrl.use3dRenderer_Text(item) for item in $ctrl.use3dRenderer_List() track by item">\n         </select></div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="$ctrl.expanded && $ctrl.graphicsMemorySizeInMB_isVisible()">\n      <clr-stack-label>{{ $ctrl.i18n(\'3DMemory\') }}</clr-stack-label>\n      <clr-stack-content>\n         <label ng-class="{\'invalid\': $ctrl.graphicsMemorySizeInMB_isInvalid()}"\n                aria-haspopup="true"\n                role="tooltip"\n                class="tooltip tooltip-validation tooltip-lg tooltip-top-left">\n            <input type="text"\n                   aria-label="{{::$ctrl.ARIA_LBL_3DRAM}}"\n                   name="graphicsMemorySizeInMB"\n                   test-id="graphicsMemorySizeInMB"\n                   ng-model="$ctrl.graphicsMemorySizeInMB"\n                   ng-disabled="$ctrl.graphicsMemorySizeInMB_isEditDisabled()"/>\n\n            <span\n               class="tooltip-content">{{ $ctrl.graphicsMemorySizeInMB_getError() }}</span></label>\n         <span>{{::$ctrl.i18n(\'MB\')}}</span>\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDisk/select-iso-file.view.html",'<div>\n   <datastore-file-browser\n      object-id="modalOptions.dsFileBrowserData.datastoreBrowserId"\n      datastore-ids="modalOptions.dsFileBrowserData.datastoreIds"\n      initial-file-query-type="modalOptions.dsFileBrowserData.initialFileQueryType"\n      filter-file-query-types="modalOptions.dsFileBrowserData.filterFileQueryTypes"\n      show-vm-images-folder="modalOptions.dsFileBrowserData.showVmImagesFolder"\n      selected-file-changed="modalOptions.dsFileBrowserData.selectedFileChanged(selectedFile)"\n      tabindex="0"\n      autofocus>\n   </datastore-file-browser>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDisk/vmDatastoreLocationBrowserDialog.html",'<div ng-controller="VmDatastoreLocationBrowserController as ctrl"\n     class="flex-column fill-parent">\n    <span>\n        {{ctrl.descriptionText}}\n    </span>\n   <storage-locator\n         class="flex-column flex-auto storage-selector-dialog"\n         storage-locator-items-data="modalOptions.storageData.storageLocatorItemsData"\n         selected-item="modalOptions.storageData.selectedStorageItem"\n         storage-profiles-data="modalOptions.storageProfilesData"\n         pod-display-disabled="modalOptions.disableSdrs"\n         datagrid-preselect="true"\n         on-selection-changed="modalOptions.onSelectionChanged(selectedItem)"\n         tabindex="0"\n         autofocus>\n   </storage-locator>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDisk/vmHardwareVirtualDisk.html",'<clr-stack-block\n   class="virtual-disk"\n   ng-class="{\'vm-ui-stackBlockEdited\': ctrl.inflatedDevice.hasChanged(),\n               \'virtual-disk-grouped\': ctrl.isGroupingHardDisks}"\n   ng-form\n   device-label="{{ctrl.deviceName}}"\n   name="ctrl.vmHardwareVirtualDiskForm{{ctrl.formKey}}"\n   [(clr-sb-expandable)]="ctrl.isExpandable()"\n   [(clr-sb-expanded)]="ctrl.expanded"\n   (clr-sb-expanded-change)="ctrl.expandedChanged($event)"\n   ng-switch="ctrl.expanded">\n\n   <clr-stack-label ng-class="{\'error-child-component\': ctrl.hasError()}">\n      <span>{{ ::ctrl.deviceName }}</span>\n   </clr-stack-label>\n\n\n   <clr-stack-content ng-if="ctrl.inflatedDevice.isMarkedForRemoval()">\n      <span ng-if="!ctrl.isPmemDisk">\n         {{::ctrl.i18n(\'VmUi\', \'RemoveDevice.DeviceRemoved\')}}\n      </span>\n      <span ng-if="ctrl.isPmemDisk">\n         {{::ctrl.i18n(\'VmUi\', \'RemoveDevice.DeviceAndContentsRemoved\')}}\n      </span>\n\n      <label class="normal-weight" ng-if="!ctrl.isPmemDisk">\n         <input name="diskDestroyFileOperation"\n                aria-label="{{::ctrl.ARIA_LBL_DESTROY}}"\n                type="checkbox"\n                ng-model="ctrl.deleteFilesFromDisk"\n                ng-change="ctrl.updateDiskFileOperation()"\n         />\n\n         <span ng-bind="::ctrl.i18n(\'VmUi\', \'DeviceDeletedControl.DeleteFiles\')"></span>\n      </label>\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n         aria-label="{{::ctrl.ARIA_LBL_RESTORE}}"\n         ng-click="ctrl.revertRemoval()">\n      </a>\n   </clr-stack-content>\n\n   <clr-stack-content ng-if="!ctrl.inflatedDevice.isMarkedForRemoval()">\n      <div class="hdd-label">\n         <div ng-if="ctrl.shouldShowDiskSizeLabelOnly()">\n            {{ctrl.getDiskText()}} | {{ctrl.getSelectedVirtualNodeText()}}\n         </div>\n         <vx-value-in-units name="editDisk{{ctrl.formKey}}"\n                            ng-if="!ctrl.shouldShowDiskSizeLabelOnly()"\n                            is-disabled="ctrl.shouldDisableDiskEdit()"\n                            type="number"\n                            ng-model-options = "{allowInvalid: true}"\n                            ng-model="ctrl.virtualDiskSettingsForm.capacity.valueInMB"\n                            unit-options="ctrl.virtualDiskSettingsForm.capacity.validUnits"\n                            unit-changed-callback="ctrl.unitChangedCallback"\n                            min="{{ctrl.getMin()}}"\n                            max="{{ctrl.getMax()}}"\n                            default-unit="{{ctrl.virtualDiskSettingsForm.capacity.memoryUnitPreferred.label}}"\n                            error-messages="ctrl.errorMessages"\n                            custom-validators="ctrl.customValidators"\n                            ng-change="ctrl.onValueChanged()"\n                            unit-aria-label="ctrl.ARIA_LBL_CAPACITY"\n                            quantity-caret-aria-label="ctrl.ARIA_LBL_CAPACITY"\n                            quantity-aria-label="ctrl.ARIA_LBL_CAPACITY"\n                            style="flex: 0 0 auto">\n         </vx-value-in-units>\n\n         <div ng-if="ctrl.getDiskEncryptionStatus()">\n            <clr-icon shape="info-circle" class="is-highlight" size="20"></clr-icon>\n            <span>{{ctrl.getDiskEncryptionStatus()}}</span>\n         </div>\n\n         <vsc-sign-post ng-if="ctrl.isPmemDisk"\n               class="pmem-label"\n               [sign-post-position]="\'top-left\'"\n               [sign-post-content]="ctrl.i18n(\'VmUi\', \'DiskPage.pmemDisk\')">\n         </vsc-sign-post>\n      </div>\n\n      <a class="vsphere-icon-action-remove remove-device stack-view-row-action"\n         tabIndex="0"\n         aria-label="{{::ctrl.ARIA_LBL_REMOVE}}"\n         ng-disabled="ctrl.isRemoveDisabled()"\n         ng-click="ctrl.onRemoveHardDisk()"></a>\n   </clr-stack-content>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.MaximumSize\')}}\n      </clr-stack-label>\n      <clr-stack-content data-test-id="max-size-container">\n         <span ng-if="ctrl.virtualDiskSettingsForm.capacity.isMaxAvailable && !ctrl.isPmemDisk">\n            <span\n                  aria-label="{{ctrl.i18n(\'VmUi\', \'DiskPage.MaximumSize\') + \' - \'\n                   + (ctrl.virtualDiskSettingsForm.capacity.maxInMB | bytes:\'MB\')}}">\n               {{ctrl.virtualDiskSettingsForm.capacity.maxInMB | bytes:\'MB\' }}\n            </span>\n         </span>\n         <span ng-if="ctrl.isPmemDisk">\n            {{ ctrl.getPmemMax() | bytes:\'MB\' }}\n         </span>\n         <span ng-if="!ctrl.virtualDiskSettingsForm.capacity.isMaxAvailable && !ctrl.isPmemDisk"\n               ng-bind="ctrl.i18n(\'VmUi\', \'DiskPage.SizeNotAvailable\')"></span>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.showVmStoragePolicy(ctrl.expanded)">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.Profile\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div>\n            <div>\n               <storage-profile read-only="ctrl.areStorageProfilesReadOnly()"\n                                name="storage-profile"\n                                selected-storage-profile="ctrl.virtualDiskSettingsForm.storageProfile.selection"\n                                storage-profiles="ctrl.virtualDiskSettingsForm.storageProfile.options"\n                                on-change-callback="ctrl.updateProfileFromUiCallback"\n                                select-aria-label="ctrl.ARIA_LBL_PROFILE"\n                                error-config="ctrl.diskProfileErrorConfig">\n               </storage-profile>\n            </div>\n            <div ng-if="ctrl.isEncryptionProfileApplied">\n               <clr-icon shape="info-circle" class="is-highlight" size="20"></clr-icon>\n               <span>{{::ctrl.i18n(\'VmUi\', \'DiskPage.encryptionPolicyDecription\')}}</span>\n            </div>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.inflatedDevice.isNew() && ctrl.expanded && !ctrl.inflatedDevice.isCreatedFromExistingDisk()" class="vm-disk-block">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.Location\')}}</clr-stack-label>\n      <clr-stack-content>\n         <div class="select" ng-class="{\'has-error\' : ctrl.diskLocationErrorConfig.isVisible, \'div-disabled\': ctrl.isPmemDisk}">\n            <select class="location-select"\n                    aria-label="{{::ctrl.ARIA_LBL_LOCATION}}"\n                    name="disk-location"\n                    ng-options="option.name for option in ctrl.datastores.options track by option.name"\n                    ng-model="ctrl.datastores.selection"\n                    ng-change="ctrl.onDatastoreSelectionChange(ctrl.datastores.selection, {{ctrl.datastores.selection | json}})"\n                    vx-error="ctrl.diskLocationErrorConfig">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.showReplicationGroup(ctrl.expanded)">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.ProtectionGroup\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div class="select replication-group-container" ng-class="{\'has-error\' : ctrl.replicationGroupErrorConfig.isVisible}">\n            <select class="replication-group-select"\n                    aria-label="{{::ctrl.ARIA_LBL_RGROUP}}"\n                    ng-model="ctrl.selectedReplicationGroupItem"\n                    name="replication-group"\n                    ng-options="rgItem as rgItem.label for rgItem in ctrl.replicationGroupItems"\n                    ng-change="ctrl.onReplicationGroupSelectionChange()"\n                    vx-error="ctrl.replicationGroupErrorConfig">\n\n               <option ng-if="!ctrl.selectedReplicationGroupItem" value="">\n                  {{::ctrl.i18n("VmUi", "DiskPage.ProtectionGroupHint")}}\n               </option>\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && !ctrl.createMode && ctrl.expanded && !ctrl.inflatedDevice.isCreatedFromExistingDisk() && !ctrl.isPmemDisk">\n\n      <clr-stack-label ng-if="ctrl.inflatedDevice.isNew()"\n                       ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.DiskProvisioning\')}}\n      </clr-stack-label>\n      <clr-stack-content ng-if="ctrl.inflatedDevice.isNew()">\n         <div class="select">\n            <select ng-options="option.name for option in ctrl.virtualDiskSettingsForm.diskProvisioningOptions"\n                    ng-model="ctrl.virtualDiskSettingsForm.selectedDiskProvisioningOption"\n                    ng-change="ctrl.updateDiskProvisioningType(ctrl.virtualDiskSettingsForm.selectedDiskProvisioningOption.type)"\n                    aria-label="{{::ctrl.ARIA_LBL_PROVISION}}"\n                    ng-if="!ctrl.isPmemDisk">\n            </select>\n            <select ng-if="ctrl.isPmemDisk" ng-disabled="true">\n               <option>{{::ctrl.i18n(\'VmUi\', \'DiskPage.storedOnPmem\')}}</option>\n            </select>\n         </div>\n      </clr-stack-content>\n\n      <clr-stack-label ng-if="!ctrl.inflatedDevice.isNew()"\n                       ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.Type\')}}\n      </clr-stack-label>\n      <clr-stack-content ng-if="!ctrl.inflatedDevice.isNew()">{{ctrl.virtualDiskSettingsForm.diskProvisioningName}}</clr-stack-content>\n\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.createMode && ctrl.expanded && !ctrl.inflatedDevice.isCreatedFromExistingDisk()">\n\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.DiskProvisioning\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select ng-options="option.name for option in ctrl.virtualDiskSettingsForm.diskProvisioningOptions"\n                    ng-model="ctrl.virtualDiskSettingsForm.selectedDiskProvisioningOption"\n                    ng-change="ctrl.updateDiskProvisioningType(ctrl.virtualDiskSettingsForm.selectedDiskProvisioningOption.type)"\n                    ng-if="!ctrl.isPmemDisk">\n            </select>\n            <select ng-if="ctrl.isPmemDisk" ng-disabled="true">\n               <option>{{::ctrl.i18n(\'VmUi\', \'DiskPage.storedOnPmem\')}}</option>\n            </select>\n         </div>\n      </clr-stack-content>\n\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.expanded">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.Sharing\')}}\n      </clr-stack-label>\n      <clr-stack-content>\n         <div class="select">\n            <select ng-options="option.name for option in ctrl.virtualDiskSettingsForm.sharing.options"\n                    ng-model="ctrl.virtualDiskSettingsForm.sharing.selection"\n                    ng-disabled="ctrl.isDiskSharingDisabled()"\n                    ng-change="ctrl.inflatedDevice.updateSharing(ctrl.virtualDiskSettingsForm.sharing.selection.value)"\n                    aria-label="{{::ctrl.ARIA_LBL_SHARING}}"\n            ></select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.showDiskFile()">\n   <!--<clr-stack-block ng-if="!ctrl.createMode && expanded && ctrl.virtualDiskSettingsForm.diskFile">-->\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.DiskFile\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         {{ctrl.virtualDiskSettingsForm.diskFile}}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.shouldDisplayShares(ctrl.expanded)">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.Shares\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <shares-control\n            shares-aria-label="ctrl.ARIA_LBL_SHARES"\n            quantity-caret-aria-label="ctrl.ARIA_LBL_SHARES"\n            quantity-aria-label="ctrl.ARIA_LBL_SHARES"\n            show-recommendations="false"\n            form-input-field-name="DiskSharesValue{{ctrl.formKey}}"\n            form-select-field-name="DiskSharesLevels{{ctrl.formKey}}"\n            share-value-min="{{ctrl.virtualDiskSettingsForm.shares.min}}"\n            share-value-max="{{ctrl.virtualDiskSettingsForm.shares.max}}"\n            shares-value-map="ctrl.virtualDiskSettingsForm.shares.presetOptions"\n            shares-info="ctrl.virtualDiskSettingsForm.shares.value"\n            is-disabled="ctrl.isEditSharesDisabled()">\n         </shares-control>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.shouldDisplayIOPS(ctrl.expanded)">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.LimitIOPs\')}}\n      </clr-stack-label>\n\n      <clr-stack-content class="iops-control">\n         <div class="select">\n            <select\n               aria-label="{{::ctrl.ARIA_LBL_LIMIT_IOPS}}"\n               name="iopsLimitSelect{{ formKey }}"\n               ng-options="iopsLimitSelect.label for iopsLimitSelect in ctrl.iopsLimitDetails.iopsLimitSelectList track by iopsLimitSelect.data"\n               ng-model="ctrl.iopsLimitDetails.iopsLimitSelection"\n               ng-change="ctrl.iopsLimitDetails.selectChange()"\n               ng-disabled="ctrl.isEditIopsLimitDisabled()">\n            </select>\n         </div>\n         <vx-value-in-units\n            ng-if="ctrl.iopsLimitDetails.iopsLimitSelection.data == \'custom\'"\n            name="IopsLimitValue{{ctrl.formKey}}"\n            recommended-values="ctrl.iopsLimitDetails.iopsRecommendations"\n            is-disabled="ctrl.isEditIopsLimitDisabled()"\n            ng-model="ctrl.virtualDiskSettingsForm.ioLimit"\n            ng-change="ctrl.inflatedDevice.updateStorageIOAllocation(ctrl.virtualDiskSettingsForm.ioLimit)"\n            min="{{ ctrl.iopsLimitDetails.min }}"\n            max="{{ ctrl.iopsLimitDetails.max }}"\n            error-messages="ctrl.iopsLimitDetails.errorMessage"\n            show-units="false"\n            unit-aria-label="ctrl.ARIA_LBL_LIMIT_IOPS"\n            quantity-caret-aria-label="ctrl.ARIA_LBL_LIMIT_IOPS"\n            quantity-aria-label="ctrl.ARIA_LBL_LIMIT_IOPS"\n         ></vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.virtualDiskSettingsForm.isFlashCacheCompatible && ctrl.expanded">\n\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.CacheReservation\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vx-value-in-units name="ctrl.editDiskCacheReservation{{ctrl.formKey}}"\n                            type="number"\n                            is-disabled="ctrl.isEditFlashReadCacheDisabled()"\n                            ng-model="ctrl.virtualDiskSettingsForm.flashCacheReservation.valueInMB"\n                            unit-options="ctrl.virtualDiskSettingsForm.flashCacheReservation.validUnits"\n                            ng-change="ctrl.updateFlashCacheReservation(ctrl.virtualDiskSettingsForm.flashCacheReservation.valueInMB)"\n                            custom-validators="ctrl.virtualDiskSettingsForm.flashCacheReservation.customValidators"\n                            error-messages="ctrl.virtualDiskSettingsForm.flashCacheReservation.errorMessages"\n                            unit-aria-label="ctrl.ARIA_LBL_CACHE"\n                            quantity-caret-aria-label="ctrl.ARIA_LBL_CACHE"\n                            quantity-aria-label="ctrl.ARIA_LBL_CACHE"\n                            default-unit="{{ctrl.virtualDiskSettingsForm.flashCacheReservation.defaultUnit}}">\n         </vx-value-in-units>\n      </clr-stack-content>\n   </clr-stack-block>\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.expanded">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.DiskMode\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <div class="select">\n            <select name="editDiskMode{{ctrl.formKey}}"\n                    aria-label="{{::ctrl.ARIA_LBL_DISK_MODE}}"\n                    ng-disabled="ctrl.isEditDiskModeDisabled()"\n                    ng-options="option.name for option in ctrl.virtualDiskSettingsForm.diskMode.options"\n                    ng-model="ctrl.virtualDiskSettingsForm.diskMode.selection"\n                    ng-change="ctrl.inflatedDevice.updateDiskMode(ctrl.virtualDiskSettingsForm.diskMode.selection.value)">\n            </select>\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if="!ctrl.deployVmtxMode && ctrl.expanded">\n      <clr-stack-label ng-class="{\'stack-block-is-nested\': ctrl.isGroupingHardDisks}">\n         {{::ctrl.i18n(\'VmUi\', \'DiskPage.VirtualDeviceNode\')}}\n      </clr-stack-label>\n\n      <clr-stack-content>\n         <vm-hardware-controller-and-node\n            inflated-device="ctrl.inflatedDevice"\n            virtual-machine-devices="ctrl.virtualMachineDevices"\n            selector-name="ctrl.controllerNodeSelectorName"\n            controller-selector-name="ctrl.controllerSelectorName"\n            available-controllers="ctrl.virtualDiskSettingsForm.controllers.options"\n            device-controller="ctrl.virtualDiskSettingsForm.controllers.selection"\n            node="ctrl.virtualDiskSettingsForm.selectedControllerNode"\n            power-state="ctrl.vmConfigContext.environment.powerState"\n            privileges="ctrl.vmConfigContext.privileges"\n            on-controller-change-callback="ctrl.updateDiskController">\n         </vm-hardware-controller-and-node>\n      </clr-stack-content>\n   </clr-stack-block>\n\n\n</clr-stack-block>\n'),
e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskType/vm-hardware-virtual-disk-type.html",'<div ng-bind="$ctrl.provisioningTypeLabel"></div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualNvdimm/vm-hardware-virtual-nvdimm.component.html",'<clr-stack-block\n      ng-form\n      name="vmHardwareNvdimmForm"\n      [(clr-sb-expanded)]="expanded"\n      ng-class="{\'vm-ui-stackBlockEdited\': $ctrl.nvdimmDevice.hasChanged()}"\n      class="virtual-nvdimm">\n   <clr-stack-label ng-class="{\'error-child-component\': $ctrl.hasError()}">\n      <span>{{ ::$ctrl.deviceName }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content ng-if="$ctrl.nvdimmDevice.isMarkedForRemoval()">\n      {{::$ctrl.i18n(\'RemoveDevice.DeviceAndContentsRemoved\')}}\n      <a class="vx-icon-reset_green pull-right restore-device stack-view-row-action"\n            ng-click="$ctrl.revertNvdimmRemoval()">\n      </a>\n   </clr-stack-content>\n\n\n   <clr-stack-content ng-if="!$ctrl.nvdimmDevice.isMarkedForRemoval()">\n      <vx-value-in-units name="editNVDIMMMemory"\n            ng-if="$ctrl.memoryOptions"\n            is-disabled="!$ctrl.isGrowthEnabled"\n            hot-plug-active="$ctrl.isGrowthEnabled"\n            type="number"\n            ng-model="$ctrl.dummyCapacity"\n            default-unit="{{$ctrl.defaultMemoryUnit}}"\n            unit-options="$ctrl.memoryOptions"\n            min="{{$ctrl.minAllowedCapacity}}"\n            max="{{$ctrl.maxAllowedCapacity}}"\n            mod="{{$ctrl.growthGranularityMB}}"\n            error-messages="$ctrl.capacityErrorMessages"\n            value-changed-callback="$ctrl.onCapacityChange(value)">\n      </vx-value-in-units>\n      <a class="vsphere-icon-action-remove remove-device stack-view-row-action"\n            ng-disabled="$ctrl.isRemoveDisabled"\n            ng-click="$ctrl.removeNvdimm()"></a>\n   </clr-stack-content>\n\n</clr-stack-block>'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuMmu/cpu-mmu-view.html",'<select name="cpuMmu"\n        area-label="$ctrl.ariaLabel"\n        ng-disabled="$ctrl.isCpuMmuDisabled()"\n        ng-options="option.label for option in $ctrl.cpuMmuOptions"\n        ng-model="$ctrl.selectedOption"\n        ng-change="$ctrl.onChange()">\n</select>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareTpm/tpmCertificateSelector/tpm-certificate-selector.component.html",'<span>\n    {{$ctrl.selectedCertificate.issuerNameCN}}\n    <button aria-label="{{$ctrl.selectedCertificate.algorithmName\n        + \' / \' + $ctrl.selectedCertificate.publicKeyAlgorithmName\n        + \' - \' + $ctrl.i18n(\'VmDeviceManager.TPMReplaceCertificate\')}}"\n          class="tpm-certificate-replace-btn btn btn-outline btn-sm"\n            ng-click="$ctrl.openFileSelector()">\n        {{$ctrl.i18n(\'VmDeviceManager.TPMReplaceCertificate\')}}\n    </button>\n</span>\n<div class="alert alert-danger alert-sm" ng-show="!$ctrl.invalidCertAlertOptions.isClosed">\n    <div class="alert-item">\n        <span aria-live="polite" class="alert-text">{{$ctrl.invalidCertAlertOptions\n            .text}}</span>\n    </div>\n</div>\n<input id="tpm-certificate-upload-file-input"\n       class="tpm-certificate-upload-file-input"\n       type="file"\n       file-on-change="$ctrl.uploadCertificate(files)"\n       accept=".cer"/>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskCompatibilityMode/vm-hardware-virtual-disk-compatibility-mode.html",'<div class="select">\n   <select ng-disabled="$ctrl.isDisabled"\n           aria-label="{{::$ctrl.ariaLabel}}"\n           ng-options="option as option.name for option in $ctrl.compatibilityModeInfo.options track by option.value"\n           ng-model="$ctrl.compatibilityModeInfo.selection"\n           ng-change="$ctrl.onCompatibilityModeChange($ctrl.compatibilityModeInfo.selection)">\n   </select>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskFlashReadCache/vm-hardware-virtual-disk-flash-read-cache.html",'<vx-value-in-units type="number"\n                   aria-label="{{::$ctrl.ariaLabel}}"\n                   is-disabled="$ctrl.isDisabled"\n                   ng-model="$ctrl.flashCacheReservationInfo.valueInMB"\n                   unit-options="$ctrl.flashCacheReservationInfo.validUnits"\n                   ng-change="$ctrl.onFlashCacheReservationChange()">\n</vx-value-in-units>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskIops/vm-hardware-virtual-disk-iops.html",'\n<div class="iops-control">\n   <div class="select">\n      <select\n         data-test-id="iops-control"\n         aria-label="{{::$ctrl.ariaLabel}}"\n         ng-options="iopsLimitSelect.label for iopsLimitSelect in $ctrl.iopsLimitDetails.iopsLimitSelectList track by iopsLimitSelect.data"\n         ng-model="$ctrl.iopsLimitDetails.iopsLimitSelection"\n         ng-change="$ctrl.onIopsLimitSelectionChange()"\n         ng-disabled="$ctrl.isDisabled">\n      </select>\n   </div>\n   <vx-value-in-units\n      ng-if="$ctrl.isCustom()"\n      recommended-values="$ctrl.iopsLimitDetails.iopsRecommendations"\n      ng-model="$ctrl.iopsLimit"\n      ng-change="$ctrl.onIopsLimitValueChange()"\n      is-disabled="$ctrl.isDisabled"\n      min="{{ $ctrl.iopsLimitDetails.min }}"\n      max="{{ $ctrl.iopsLimitDetails.max }}"\n      error-messages="$ctrl.iopsLimitDetails.errorMessage"\n      show-units="false"\n   ></vx-value-in-units>\n</div>\n'),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskMode/vm-hardware-virtual-disk-mode-sign-post.html","<div class=\"disk-mode-sign-post\">\n   <ul>\n      <li data-test-id=\"dependent\">\n         <strong>{{i18n('VmUi', 'DiskConfig.persistent')}}</strong>\n         <div>{{i18n('VmUi', 'DiskConfig.persistentTip')}}</div>\n      </li>\n      <li data-test-id=\"independent_persistent\">\n         <strong>{{i18n('VmUi', 'DiskConfig.independent_persistent')}}</strong>\n         <div>{{i18n('VmUi', 'DiskConfig.independent_persistentTip')}}</div>\n      </li>\n      <li data-test-id=\"independent_nonpersistent\">\n         <strong>{{i18n('VmUi', 'DiskConfig.independent_nonpersistent')}}</strong>\n         <div>{{i18n('VmUi', 'DiskConfig.independent_nonpersistentTip')}}</div>\n      </li>\n   </ul>\n</div>\n"),e.put("vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskMode/vm-hardware-virtual-disk-mode.html",'<div class="select">\n   <select data-test-id="diskMode"\n           aria-label="{{::$ctrl.ariaLabel}}"\n           ng-disabled="$ctrl.isDisabled"\n           ng-options="option as option.name for option in $ctrl.diskModeInfo.options track by option.value"\n           ng-model="$ctrl.diskModeInfo.selection"\n           ng-change="$ctrl.onDiskModeChange($ctrl.diskModeInfo.selection)">\n   </select>\n</div>\n<a vui-sign-post=\'$ctrl.diskModeSignPostParams\' class=\'pull-right\'>\n   <img ng-src="{{$ctrl.i18n(\'CommonImages\', \'info\')}}"/>\n</a>\n')}]);var h5_vm;!function(e){var t=function(){function e(){}return e.ADD="add",e.EDIT="edit",e.REMOVE="remove",e}();e.DeviceOperationConstants=t,angular.module("com.vmware.vsphere.client.vm").constant("deviceOperationConstants",t)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=function(){function e(){}return e.CDROM="VirtualCdrom",e.ETHERNET="VirtualEthernetCard",e.VIDEO_CARD="VirtualVideoCard",e.VirtualPCIPassthrough="VirtualPCIPassthrough",e.EXISTINGHARDDISK="ExistingHardDisk",e.INPUT_DEVICE="InputDevice",e.RDMDISK="RDMDisk",e.SCSICONTROLLER="VirtualSCSIController",e.PVSCISI="ParaVirtualSCSIController",e.BUS_LOGIC="VirtualBusLogicController",e.LSI_LOGIC="VirtualLsiLogicController",e.LSI_LOGIC_SAS="VirtualLsiLogicSASController",e.IDE="VirtualIDEController",e.VIRTUAL_CONTROLLER="VirtualController",e.VIRTUALDISK="VirtualDisk",e.VIRTUAL_SATA_CONTROLLER="VirtualSATAController",e.VIRTUAL_USB_CONTROLLER="VirtualUSBController",e.VIRTUAL_USB_XHCI_CONRTOLLER="VirtualUSBXHCIController",e.VIRTUAL_USB="VirtualUSB",e.NVME_CONTROLLER="VirtualNVMEController",e.TPM="VirtualTPM",e.NVDIMM="VirtualNVDIMM",e.VIRTUAL_SIO_CONTROLLER="VirtualSIOController",e.VIRTUAL_SERIAL_PORT="VirtualSerialPort",e}();e.DeviceTypeConstants=t;var i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.DeviceType=i,angular.module("com.vmware.vsphere.client.vm").constant("deviceTypeConstants",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").constant("diskBackingInfoConstants",{FLATVER2:"com.vmware.vim.binding.vim.vm.device.VirtualDisk$FlatVer2BackingInfo",RAWDISKMAPPING:"com.vmware.vim.binding.vim.vm.device.VirtualDisk$RawDiskMappingVer1BackingInfo",SESPARSE:"com.vmware.vim.binding.vim.vm.device.VirtualDisk$SeSparseBackingInfo",LOCALPMEM:"com.vmware.vim.binding.vim.vm.device.VirtualDisk$LocalPMemBackingInfo"});var h5_vm;!function(e){var t=function(){function e(){}return e.WINDOWS="windowsGuest",e.LINUX="linuxGuest",e.OTHER="otherGuestFamily",e}();e.GosFamilyConstants=t,angular.module("com.vmware.vsphere.client.vm").constant("gosFamilyConstants",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").constant("guestosCustomizationConstants",{UNCUSTOMIZABLE:"UNCUSTOMIZABLE_GUEST",MISSING_WINDOWS:"MISSING_WINDOWS_CUSTOMIZATION",MISSING_LINUX:"MISSING_LINUX_CUSTOMIZATION",TYPE_WINDOWS:"Windows",TYPE_LINUX:"Linux",TYPE_OTHER:"Unknown"});var h5_vm;!function(e){var t=function(){function e(){}return e.STD_NETWORK="com.vmware.vim.binding.vim.vm.NetworkInfo",e.NSX_NETWORK="com.vmware.vim.binding.vim.vm.OpaqueNetworkInfo",e.DVSWITCH="com.vmware.vim.binding.vim.dvs.DistributedVirtualSwitchInfo",e.DVPORGGROUP="com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroupInfo",e}();e.NetworkType=t;var i=function(){function e(){}return e.STD_NETWORK="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$NetworkBackingInfo",e.NSX_NETWORK="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$OpaqueNetworkBackingInfo",e.DVPORGGROUP="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$DistributedVirtualPortBackingInfo",e}();e.NetBackingType=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){!function(e){e[e.OVF=0]="OVF",e[e.OVA=1]="OVA",e[e.INVALID=2]="INVALID"}(e.DeployWorkflowType||(e.DeployWorkflowType={}));var t=(e.DeployWorkflowType,function(){function e(){}return e.DEPLOYMENT_LOCAL="LOCAL",e.DEPLOYMENT_URL="URL",e.TEMPLATE_TYPE_OVF="OVF",e.TEMPLATE_TYPE_OVA="OVA",e}());e.OvfDeployConstants=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.POWERED_ON="poweredOn",e.POWERED_OFF="poweredOff",e.SUSPENDED="suspended",e}();e.PowerState=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.VM_CONFIG_RESOURCE="VirtualMachine.Config.Resource",e.VM_CONFIG_ADVANCEDCONFIG="VirtualMachine.Config.AdvancedConfig",e.VM_CONFIG_MKSCONTROL="VirtualMachine.Config.MksControl",e.VM_HOST_USB_DEVICE="VirtualMachine.Config.HostUSBDevice",e.VM_ADDREMOVEDEVICE="VirtualMachine.Config.AddRemoveDevice",e.VM_ADDREMOVEDEVICE_PRIVILEGE="VirtualMachine.Config.AddRemoveDevice",e.VM_REMOVEDISK_PRIVILEGE="VirtualMachine.Config.RemoveDisk",e.DATASTORE_ALLOCATESPACE_PRIVILEGE="Datastore.AllocateSpace",e.VM_DISKEXTEND_PRIVILEGE="VirtualMachine.Config.DiskExtend",e.VM_EDITDEVICE_PRIVILEGE="VirtualMachine.Config.EditDevice",e.VM_RESOURCE_PRIVILEGE="VirtualMachine.Config.Resource",e.VM_ADDNEWDISK_PRIVILEGE="VirtualMachine.Config.AddNewDisk",e.VM_RAWDEVICE_PRIVILEGE="VirtualMachine.Config.RawDevice",e.VM_ADDEXISTINGDISK_PRIVILEGE="VirtualMachine.Config.AddExistingDisk",e.VM_CONFIG_SWAPFILEPLACEMENT="VirtualMachine.Config.SwapPlacement",e.VM_REMOVE_SNAPSHOT="VirtualMachine.State.RemoveSnapshot",e.VM_REVERT_SNAPSHOT="VirtualMachine.State.RevertToSnapshot",e.VM_RENAME_SNAPSHOT="VirtualMachine.State.RenameSnapshot",e.VM_CONFIG_RENAME="VirtualMachine.Config.Rename",e.VM_CONFIG_SETTINGS="VirtualMachine.Config.Settings",e.VM_CONFIG_CPU_COUNT="VirtualMachine.Config.CPUCount",e.VM_CONFIG_MEMORY="VirtualMachine.Config.Memory",e.NETWORK_ASSIGN="Network.Assign",e.VM_INTERACT_DEVICE_CONNECTION="VirtualMachine.Interact.DeviceConnection",e.VM_INTERACT_SET_CD_MEDIA="VirtualMachine.Interact.SetCDMedia",e.VM_INTERACT_POWER_ON="VirtualMachine.Interact.PowerOn",e.STORAGE_PROFILE_VIEW="StorageProfile.View",e.CRYPTOGRAPHER_MANAGE_KEY_SERVERS="Cryptographer.ManageKeyServers",e.CRYPTOGRAPHER_MANAGE_ENCRYPTION_POLICY="Cryptographer.ManageEncryptionPolicy",e.CRYPTOGRAPHER_ENCRYPT_NEW_VM="Cryptographer.EncryptNew",e.CRYPTOGRAPHER_ENCRYPT="Cryptographer.Encrypt",e.VM_INVENTORY_REGISTER="VirtualMachine.Inventory.Register",e.VM_INVENTORY_CREATE_FROM_EXISTING="VirtualMachine.Inventory.CreateFromExisting",e.VM_INVENTORY_CREATE="VirtualMachine.Inventory.Create",e.ADD_LIBRARY_ITEM="ContentLibrary.AddLibraryItem",e.VAPP_IMPORT="VApp.Import",e}();e.Privileges=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.VM_TEMPLATE="VM Template",e.OVF_TEMPLATE="OVF",e}();e.TemplateType=t;var i=function(){function e(){}return e.NEW_TEMPLATE="new",e.UPDATE_TEMPLATE="update",e}();e.CloneType=i}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").constant("vmFtConstants",{ftState:{DISABLED:"disabled",ENABLED:"enabled",NEED_SECONDARY:"needSecondary",STARTING:"starting",RUNNING:"running",PROTECTED:"protected",ENABLED_POWERED_ON:"enabledPoweredOn",ENABLED_NOT_POWERED_ON:"enabledNotPoweredOn",NOT_RUNNING:"notRunning",NOT_PROTECTED:"notProtected",NOT_CONFIGURED:"notConfigured"},fileTypes:{VIRTUAL_DISK:"itemTypeDisk",CONFIGURATION:"itemTypeConfiguration",TIE_BREAKER:"itemTypeFtMetainfFile"},storageSelectionModes:{BASIC_MODE:"basicMode",ADVANCED_MODE:"advancedMode"}});var h5_vm;!function(e){var t=function(){function e(e){this._i18nService=e}return e.prototype.validateComputerName=function(e,t){if(!t)return[this.errorMessage("computerNameEmpty")];if(t.length>e)return[this.errorMessage("computerNameTooLong",[e])];var i=new RegExp("^(?![0-9]+$)(\\*$|[a-zA-Z0-9-]+$)");return i.test(t)?[]:[this.errorMessage("invalidComputerNameError")]},e.prototype.validateDomainName=function(t){if(!t)return[this.errorMessage("invalidDomainNameEmptyError")];var i=_.some(t.split("."),function(t){return t.length>e.MAX_CHARS_DOMAIN});return i?[this.errorMessage("invalidDomainNameLabelLength")]:t.length>e.MAX_CHARS_DOMAIN_WHOLE?[this.errorMessage("invalidDomainNameLength")]:[]},e.prototype.errorMessage=function(e,t){return void 0===t&&(t=[]),(i=this._i18nService).getString.apply(i,["VmUi","customizationSpec.computerNamePage."+e].concat(t));var i},e.$inject=["i18nService"],e.MAX_CHARS_WIN=15,e.MAX_CHARS_LIN=63,e.MAX_CHARS_DOMAIN=63,e.MAX_CHARS_DOMAIN_WHOLE=255,e}();e.GosComputerNameValidationService=t,angular.module("com.vmware.vsphere.client.vm").service("gosComputerNameValidationService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){return function(){return new i(e)}}return e.$inject=["i18nService"],e}(),i=function(){function e(e){this.i18nService=e}return e.prototype.validatePage=function(){var e="";return this.mutationSpec.schedulingSpec.isFormStatusValid===!1||null===this.mutationSpec.schedulingSpec.recurrence?(e=this.i18nService.getString("VmUi","wizard.scheduleTaskPage.invalidSchedulerError"),{error:e}):{}},e.prototype.submitPage=function(){return{invalidateNextPages:!1}},e.prototype.resetForm=function(){},e.$inject=["i18nService"],e}();e.VmWizardScheduleTaskPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("vmWizardScheduleTaskPageModel",t)}(h5_vm||(h5_vm={}));var ScheduledMutationOperationSpec=com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec,h5_vm;!function(e){var t=function(){function e(e){this.mutationService=e}return e.prototype.createScheduledTask=function(e){return this.mutationService.add("com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec",e)},e.$inject=["mutationService"],e}();e.VmCreateScheduledTaskMutationService=t,angular.module("com.vmware.vsphere.client.vm").service("vmCreateScheduledTaskMutationService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vmVuiWizardPageBuilder=t,this.creationTypeConstants=i,this.vmWizardScheduleTaskPageModel=r}return e.prototype.build=function(e){var t=new this.vmWizardScheduleTaskPageModel;t.mutationSpec=e.scheduleTaskData.schedulingData,t.isScheduledTaskFlow=e.scheduleTaskData.isScheduledTask,e.vmWizardScheduleTaskPageModel=t;var i=this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ScheduledOpsUi","Wizard.scheduleTaskPage.title"),contentUrl:"vm-ui/resources/vm/common/scheduleTaskWizard/scheduleTaskPage/vmCreateWizardSchedulePage.html",model:t});return i},e.$inject=["i18nService","vmVuiWizardPageBuilder","creationTypeConstants","vmWizardScheduleTaskPageModel"],e}();e.VmCreateScheduleTaskPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmCreateScheduleTaskPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.wizardPageService=t,this.vscSchedulingHelper=i}return e.prototype.build=function(e,t){var i=this;return{title:this.i18nService.getString("VmUi","wizard.scheduleTaskPage.title"),contentUrl:"vm-ui/resources/vm/common/scheduleTaskWizard/scheduleTaskPage/vmWizardScheduleTaskPage.html",disableNext:function(){return e.migrationWizardManager.vmWizardScheduleTaskPageModel.isValidating},onCommit:function(){return i.onCommit(e)}}},e.prototype.onCommit=function(e){return e.migrationWizardManager.vmWizardScheduleTaskPageModel.mutationSpec.schedulingSpec.isFormStatusValid===!1||null===e.migrationWizardManager.vmWizardScheduleTaskPageModel.mutationSpec.schedulingSpec.recurrence?(this.wizardPageService.markPageIncompleteWithErrors(e.wizardConfig,[this.i18nService.getString("VmUi","wizard.scheduleTaskPage.invalidSchedulerError")]),!1):(e.wizardConfig.validationBanner.messages=[],this.wizardPageService.markPageComplete(e.wizardConfig,e.attributes.creationType),!0)},e.$inject=["i18nService","wizardPageService","vscSchedulingHelper"],e}();e.VmMigrationScheduleTaskPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrationScheduleTaskPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.label=e,this.multiplier=t}return e}();e.Unit=t;var i=function(){function e(){}return e.MB=new t("MB",1),e.GB=new t("GB",Math.pow(2,10)),e.TB=new t("TB",Math.pow(2,20)),e}();e.DiskUnit=i}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("zoneDigestPatchService",["$rootScope",function(e){this.digest=function(){e.$$phase||e.$apply()}}]);var vm_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.clarityModalService=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.datastoreBrowserConstants=r,this.contentLibraryService=n}return e.prototype.openContentLibraryIsoSelector=function(e,t,i,r){var n=this;this.okHandler=i,this.cancelHandler=r;var o={i18nService:this.i18nService,computeResourceId:e,selectedIsoItem:t,onSelectedIsoItemChanged:function(e){n.modalOptions.dialogData.selectedIsoItem=e,n.modalOptions.submitDisabled=!1,n.modalOptions.dialogData.errorMessages=[]},errorMessages:[],validating:!1};return this.modalOptions={title:this.i18nService.getString("VmUi","contentLibISO.infoHeader"),contentTemplate:"vm-ui/resources/vm/content-library-iso-selector-modal/content-library-iso-selector-modal.html",defaultButton:"submit",size:"lg",dialogData:o,hideSubmitButton:!1,submitDisabled:!o.selectedIsoItem||!o.selectedIsoItem.name,onSubmit:function(){return null!==o.selectedIsoItem&&!n.modalOptions.dialogData.validating&&(n.modalOptions.dialogData.validating=!0,n.contentLibraryService.getContentLibraryItemWithIso(o.selectedIsoItem).then(function(e){return n.modalOptions.dialogData.validating=!1,e&&e.contentLibraryItemByItemId?Array.isArray(e.contentLibraryItemByItemId.errorMessages)&&e.contentLibraryItemByItemId.errorMessages.length>0?(o.errorMessages=e.contentLibraryItemByItemId.errorMessages,n.modalOptions.submitDisabled=!0,!1):(o.selectedIsoItem.friendlyName=e.contentLibraryItemByItemId.friendlyName,o.selectedIsoItem.isoPath=e.contentLibraryItemByItemId.isoPath,o.errorMessages=[],angular.isFunction(n.okHandler)&&n.okHandler(o.selectedIsoItem),!0):(o.errorMessages=[n.i18nService.getString("VmUi","CdromPage.clTimeOutPopupMessage")],n.modalOptions.submitDisabled=!0,n.modalOptions.dialogData.validating=!1,!1)},function(){return n.modalOptions.dialogData.validating=!1,!1}))},onCancel:function(){angular.isFunction(n.cancelHandler)&&n.cancelHandler()}},this.clarityModalService.openOkCancelModal(this.modalOptions),this.modalOptions},e.$inject=["clarityModalService","i18nService","defaultUriSchemeUtil","datastoreBrowserConstants","contentLibraryService"],e}();e.ContentLibraryIsoSelectorModalService=t,angular.module("com.vmware.vsphere.client.vm").service("contentLibraryIsoSelectorModalService",t)}(vm_ui||(vm_ui={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.VmCustomizationSpecification,i=function(){function e(e){this.mutationService=e}return e.prototype.apply=function(e,i){var r=new t;return r.spec=i,this.mutationService.apply(e,r._type,r),!0},e.$inject=["mutationService"],e}();e.CustomizeGosApplySpecService=i,angular.module("com.vmware.vsphere.client.vm").service("customizeGosApplySpecService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this._vmId=e,this._vmGuestOsFullName=t}return Object.defineProperty(e.prototype,"vmId",{get:function(){return this._vmId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vmGuestOsFullName",{get:function(){return this._vmGuestOsFullName},enumerable:!0,configurable:!0}),e}();e.CustomizeGosPageModelBase=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.dataService=e,this.i18nService=t,this.clarityModalService=i,this.$q=r,this.defaultUriSchemeUtil=n,this.CUSTOMIZE_GOS_SPEC_DATA="customizeGosSpecData",this.i18n=this.i18nService.getString}return e.prototype.customizeGosLoadData=function(e){var t=this;return this.loadData(e).then(function(e){var i=t.validateData(e);return i?(t.clarityModalService.openConfirmationModal({title:t.i18n("VmUi","customizeGuestOs.title"),message:i,submit:function(){},icon:"vui-icon32-error",preserveNewlines:!0,saveButtonLabel:t.i18n("Common","close.label"),cancelButtonLabel:null,hideCancelButton:!0}),t.$q.reject(void 0)):t.$q.resolve(e)})},e.prototype.cloneCustomizeGosLoadData=function(e,t,i){var r=this;return void 0===t&&(t=!1),this.loadData(e,i).then(function(e){var i=r.validateDataInternal(e,t),n={error:i,data:e};return r.$q.resolve(n)})},e.prototype.validateData=function(e){return this.validateDataInternal(e)},e.prototype.loadData=function(e,t){var i=this,r=t?t:this.defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(e),n={propertyParams:[{propertyName:this.CUSTOMIZE_GOS_SPEC_DATA,parameterType:"java.lang.String",parameter:r}]};return this.dataService.getProperties(e,[this.CUSTOMIZE_GOS_SPEC_DATA],n).then(function(e){var t=e[i.CUSTOMIZE_GOS_SPEC_DATA];return t})},e.prototype.validateDataInternal=function(e,t){void 0===t&&(t=!1);var i="";if(!e.vmCustomizePrivGranted)return this.i18n("VmUi","CustomizeGuestOsProvisioningPage.content.no_permissions_vm");if(!e.vcReadSpecPrivGranted)return this.i18n("VmUi","CustomizeGuestOsProvisioningPage.content.no_read_permissions");if(t)return i;if(e.pendingCustomization)return this.i18n("VmUi","customizationManager.error.pendingCustomization");switch(e.compatibility){case"MISSING_WINDOWS_CUSTOMIZATION":i=this.i18n("VmUi","CustomizationDataProvider.missing_windows");break;case"MISSING_LINUX_CUSTOMIZATION":i=this.i18n("VmUi","CustomizationDataProvider.missing_linux");break;case"UNCUSTOMIZABLE_GUEST":i=this.i18n("VmUi","CustomizationDataProvider.cannot_customize")}return i},e.$inject=["dataService","i18nService","clarityModalService","$q","defaultUriSchemeUtil"],e}();e.CustomizeGosPreCheckSpecsService=t,angular.module("com.vmware.vsphere.client.vm").service("customizeGosPreCheckSpecsService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t,i,r,n,o){this.$q=e,this.i18nService=t,this.clarityModalService=i,this.vuiConstants=r,this.customizeGosApplySpecService=n,this.customizeGosUserSettingsDialogService=o}return t.prototype.open=function(t){this.context=t;var i={contentTemplate:"vm-ui/resources/vm/customize-guest-os/select-spec/customize-gos-select-spec-page.html",title:this.i18nService.getString("VmUi","customizeGuestOs.title"),subTitle:{objectId:this.context.vmId},size:"lg",defaultButton:"submit",onSubmit:this.onDialogSubmit.bind(this)};this.pageModel=new e.CustomizeGosSelectSpecPageModel(this.context.vmId,this.context.vmGuestOsFullName,this.context.relevantSpecs),i.dialogData={selectSpecPageModel:this.pageModel},this.dialogOptions=i,this.clarityModalService.openOkCancelModal(this.dialogOptions)},t.prototype.onDialogSubmit=function(){var e=this,t=this.pageModel.onPageCommit?this.pageModel.onPageCommit():this.$q.resolve([]);return t.then(function(t){if(e.dialogOptions.alerts=[],t&&t.length>0)return e.dialogOptions.alerts=t.map(function(t){return{text:t,type:e.vuiConstants.validationBanner.type.ERROR}}),e.$q.resolve(!1);if(!e.pageModel.specification)throw new Error("Invalid specification");var i=e.pageModel.specification;if(e.pageModel.hasUnknownNameGen||e.pageModel.hasUnknownIpv4Gen||e.pageModel.hasUnknownIpv6Gen)return e.promptForUserSettings().then(function(t){if(t){var r={vmId:e.context.vmId,vmGuestOsFullName:e.context.vmGuestOsFullName,vmGuestOsType:e.context.vmGuestOsType,specification:i,hasUnknownNameGen:e.pageModel.hasUnknownNameGen,hasUnknownIpv4Gen:e.pageModel.hasUnknownIpv4Gen,hasUnknownIpv6Gen:e.pageModel.hasUnknownIpv6Gen,focusTarget:e.dialogOptions.focusTarget};e.dialogOptions.focusTarget=null,e.customizeGosUserSettingsDialogService.open(r)}return t});var r=e.customizeGosApplySpecService.apply(e.context.vmId,i);return e.$q.resolve(r)})},t.prototype.promptForUserSettings=function(){var e=this.$q.defer();return this.clarityModalService.openConfirmationModal({title:this.i18nService.getString("VmUi","customizeGuestOs.openUserSettingsPrompt.title"),message:this.i18nService.getString("VmUi","customizeGuestOs.openUserSettingsPrompt.text"),submit:function(){e.resolve(!0)},onCancel:function(){e.resolve(!1)},showXIcon:!1,clarityIcon:{shape:"warning","class":"is-warning",size:48},preserveNewlines:!0,saveButtonLabel:this.i18nService.getString("Common","yes.label"),cancelButtonLabel:this.i18nService.getString("Common","no.label")}),e.promise},t.$inject=["$q","i18nService","clarityModalService","vuiConstants","customizeGosApplySpecService","customizeGosUserSettingsDialogService"],t}();e.CustomizeGosSelectSpecDialogService=t,angular.module("com.vmware.vsphere.client.vm").service("customizeGosSelectSpecDialogService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.pageService=e,this.i18nService=t,this.vuiConstants=i,this.timeFormatterService=r,this.$q=n,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.model.onPageCommit=this.onPageCommit.bind(this),this.specsGridOptions=this.buildGridConfiguration(),this.specsGridOptions.data=_.sortBy(this.model.relevantSpecs,function(e){return e.name.toLowerCase()})},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.onPageCommit=function(){return this.validateSelection()},e.prototype.buildGridConfiguration=function(){var e=this;return{columnDefs:[{field:"name",displayName:this.i18n("VmUi","CustomizeGuestOsProvisioningPage.content.name")},{field:"type",displayName:this.i18n("VmUi","CustomizeGuestOsProvisioningPage.content.type"),width:120},{field:"lastUpdateTime",searchable:!1,displayName:this.i18n("VmUi","customizationManager.customizationSpecList.lastModifiedColumnHeader"),template:function(t){return e.timeFormatterService.timestampToText(parseInt(t.lastUpdateTime))},width:200}],selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!1,resizable:!0,height:"100%",selectedItems:[],data:[]}},e.prototype.validateSelection=function(){var e=this;if(this.model.specification=void 0,this.model.hasUnknownNameGen=!1,this.model.hasUnknownIpv4Gen=!1,this.model.hasUnknownIpv6Gen=!1,!this.specsGridOptions.selectedItems||1!==this.specsGridOptions.selectedItems.length)return this.$q.resolve([this.i18n("VmUi","customizeGuestOs.selectSpecPage.no_selection")]);var t=this.specsGridOptions.selectedItems[0];return this.pageService.validateSpec(this.model.vmId,t.name).then(function(t){return e.parseValidationResult(t)})},e.prototype.parseValidationResult=function(e){if(!e)return[this.i18n("VmUi","customizeGuestOs.selectSpecPage.error_loading_data")];var t=[];if(e.isPublicKeyTheSame||t.push(this.i18n("VmUi","customizeGuestOs.selectSpecPage.invalid_public_key")),e.areTypicalNetworkingSettingsUsed||e.isNetworkCardsCountTheSame||t.push(this.i18n("VmUi","customizeGuestOs.selectSpecPage.incorrect_nic_count",e.specInfoName)),t.length>0)return t;var i=e.spec,r=i.options;return r&&r.deleteAccounts&&(r.deleteAccounts=!1),this.model.specification=i,this.model.hasUnknownNameGen=e.hasUnknownNameTypeGen,this.model.hasUnknownIpv4Gen=e.hasUnknownIpv4TypeGen,this.model.hasUnknownIpv6Gen=e.hasUnknownIpv6TypeGen,[]},e.$inject=["customizeGosSelectSpecPageService","i18nService","vuiConstants","timeFormatterService","$q"],e}();e.CustomizeGosSelectSpecPageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/customize-guest-os/select-spec/customize-gos-select-spec-page.component.html",this.bindings={model:"<"}}return e}();e.CustomizeGosSelectSpecPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("customizeGosSelectSpecPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.CustomizeGosPageModelBase,i=function(e){function t(t,i,r){e.call(this,t,i),this._relevantSpecs=r}return __extends(t,e),Object.defineProperty(t.prototype,"relevantSpecs",{get:function(){return this._relevantSpecs},enumerable:!0,configurable:!0}),t}(t);e.CustomizeGosSelectSpecPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.mutationService=e}return e.prototype.validateSpec=function(e,t){return this.mutationService.validate(e,"java.lang.String",angular.toJson(t)).then(function(e){return e.result})},e.$inject=["mutationService"],e}();e.CustomizeGosSelectSpecPageService=t,angular.module("com.vmware.vsphere.client.vm").service("customizeGosSelectSpecPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t,i,r,n){this.i18nService=e,this.clarityModalService=t,this.vuiConstants=i,this.customizeGosApplySpecService=r,this.$q=n}return t.prototype.open=function(t){this.context=t;var i={contentTemplate:"vm-ui/resources/vm/customize-guest-os/user-settings/customize-gos-user-settings-page.html",title:this.i18nService.getString("VmUi","customizeGuestOs.title"),subTitle:{objectId:this.context.vmId},defaultButton:"submit",onSubmit:this.onDialogSubmit.bind(this),submitButtonTitle:this.i18nService.getString("VmUi","customizeGuestOs.dialog.saveButton"),focusTarget:t.focusTarget};this.pageModel=new e.CustomizeGosUserSettingsPageModel(this.context.vmId,this.context.vmGuestOsFullName,this.context.vmGuestOsType,this.context.specification),
this.pageModel.hasUnknownNameGen=this.context.hasUnknownNameGen,this.pageModel.hasUnknownIpv4Gen=this.context.hasUnknownIpv4Gen,this.pageModel.hasUnknownIpv6Gen=this.context.hasUnknownIpv6Gen,i.dialogData={userSettingsPageModel:this.pageModel},this.dialogOptions=i,this.clarityModalService.openOkCancelModal(this.dialogOptions)},t.prototype.onDialogSubmit=function(){var e=this,t=this.pageModel.onPageCommit?this.pageModel.onPageCommit():this.$q.resolve([]);return t.then(function(t){if(e.dialogOptions.alerts=[],t&&t.length>0)return e.dialogOptions.alerts=t.map(function(t){return{text:t,type:e.vuiConstants.validationBanner.type.ERROR}}),!1;if(!e.pageModel.specification)throw new Error("Invalid specification");return e.customizeGosApplySpecService.apply(e.context.vmId,e.pageModel.specification)})},t.$inject=["i18nService","clarityModalService","vuiConstants","customizeGosApplySpecService","$q"],t}();e.CustomizeGosUserSettingsDialogService=t,angular.module("com.vmware.vsphere.client.vm").service("customizeGosUserSettingsDialogService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.UnknownIpGenerator,i=com.vmware.vim.binding.vim.vm.customization.UnknownIpV6Generator,r=com.vmware.vim.binding.vim.vm.customization.FixedName,n=com.vmware.vim.binding.vim.vm.customization.FixedIp,o=com.vmware.vim.binding.vim.vm.customization.FixedIpV6,a=com.vmware.vim.binding.vim.vm.customization.IPSettings$IpV6AddressSpec,s=function(){function e(){}return e}();e.IpGenAdapterMapping=s;var c=function(){function c(e,r,n,o,a,s){this.i18nService=e,this.$q=r,this.computerNameValidationService=n,this.ipParserService=o,this.$timeout=a,this.$element=s,this.UNKNOWN_IP_GEN_TYPE=(new t)._type,this.UNKNOWN_IPV6_GEN_TYPE=(new i)._type,this.GOS_TYPE_WINDOWS="Windows",this.i18n=e.getString}return c.prototype.$onInit=function(){var e=this;this.model.onPageCommit=this.onPageCommit.bind(this),this.mainTitle=this.i18n("VmUi","CustomizationParametersPageBase.nic.mainTitle"),this.model.hasUnknownNameGen&&(this.initComputerNameModel(),this.initComputerNameLabels()),this.initNicLabels(),this.initNicModels(),this.$timeout(function(){var t=e.$element[0].querySelector("input,[role='button']");t&&t.focus()},0)},c.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},c.prototype.onPageCommit=function(){this.validateComputerName(),this.validateAllNics();var e=this.isComputerNameValid()&&this.areAllNicsValid()?[]:[this.i18n("VmUi","CustomizationParametersPageBase.validation_error")];return 0===e.length&&this.applyAdapterChanges(),this.$q.resolve(e)},c.prototype.expandedChanged=function(e,t){t.expanded=e,t.alerts=0,t.expanded||_.each(t.errors,function(e){e&&(t.alerts+=1)})},c.prototype.shouldExpand=function(e){return 0===e&&this.nicSettingsMapWrapper&&1===this.nicSettingsMapWrapper.length},c.prototype.applyAdapterChanges=function(){if(this.nicSettingsMapWrapper)for(var e=0,t=this.nicSettingsMapWrapper;e<t.length;e++){var i=t[e];i.adapterMapping.adapter.gateway=[],i.defaultGateway&&i.adapterMapping.adapter.gateway.push(i.defaultGateway),i.alternateGateway&&i.adapterMapping.adapter.gateway.push(i.alternateGateway),i.isIpv6Unknown&&(i.adapterMapping.adapter.ipV6Spec.gateway=i.ipv6Gateways)}},c.prototype.initComputerNameModel=function(){var t=this.model.specification.identity;this.model.vmGuestOsType===this.GOS_TYPE_WINDOWS?(this.nameGenerator=t.userData.computerName=new r,this.nameMaxLength=e.GosComputerNameValidationService.MAX_CHARS_WIN):(this.nameGenerator=t.hostName=new r,this.nameMaxLength=e.GosComputerNameValidationService.MAX_CHARS_LIN),this.nameGenerator.name=""},c.prototype.initComputerNameLabels=function(){this.computerNameLabel=this.i18n("VmUi","CustomizationParametersPageBase.name.label"),this.computerNameLengthWarning=this.i18n("VmUi","CustomizationParametersPageBase.name.warning",this.nameMaxLength)},c.prototype.initNicLabels=function(){this.ipv4AddressLabel=this.i18n("VmUi","CustomizationParametersPageBase.nic.ipv4Address"),this.ipv4SubnetMaskLabel=this.i18n("VmUi","CustomizationParametersPageBase.nic.ipv4SubnetMask"),this.ipv6AddressLabel=this.i18n("VmUi","CustomizationParametersPageBase.nic.ipv6Address"),this.ipv6PrefixLabel=this.i18n("VmUi","CustomizationParametersPageBase.nic.ipv6PrefixInput")},c.prototype.initNicModels=function(){if(this.nicSettingsMapWrapper=[],this.model.specification.nicSettingMap)for(var e=0;e<this.model.specification.nicSettingMap.length;e++){var t=this.model.specification.nicSettingMap[e],i=new s;if(i.adapterMapping=t,i.errors={},i.expanded=!1,this.nicSettingsMapWrapper.push(i),i.isIpv4Unknown=this.isIpv4Unknown(t),i.errors.isIpv4AddressInvalid=!1,i.errors.isIpv4SubnetInvalid=!1,i.isIpv4Unknown&&(t.adapter.ip=new n,t.adapter.gateway&&t.adapter.gateway.length>0&&(i.defaultGateway=t.adapter.gateway[0]),t.adapter.gateway&&t.adapter.gateway.length>1&&(i.alternateGateway=t.adapter.gateway[1])),i.isIpv6Unknown=this.isIpv6Unknown(t),i.errors.isIpv6AddressInvalid=!1,i.errors.isIpv6SubnetInvalid=!1,i.isIpv6Unknown){i.ipv6Gateways=[],t.adapter.ipV6Spec.gateway&&t.adapter.ipV6Spec.gateway.length>0&&(i.ipv6Gateways=t.adapter.ipV6Spec.gateway);var r=new o,c=new a;c.ip=[r],t.adapter.ipV6Spec=c}this.buildGridOptions(i)}},c.prototype.getNicHeaderName=function(e){return this.i18n("VmUi","CustomizationParametersPageBase.nic.title",e)},c.prototype.isIpv4Unknown=function(e){return e&&e.adapter&&e.adapter.ip&&e.adapter.ip._type===this.UNKNOWN_IP_GEN_TYPE},c.prototype.isIpv6Unknown=function(e){return e&&e.adapter&&e.adapter.ipV6Spec&&e.adapter.ipV6Spec.ip&&e.adapter.ipV6Spec.ip.length>0&&e.adapter.ipV6Spec.ip[0]._type===this.UNKNOWN_IPV6_GEN_TYPE},c.prototype.isComputerNameValid=function(){return!this.nameError},c.prototype.validateComputerName=function(){var e=this.model.hasUnknownNameGen?this.computerNameValidationService.validateComputerName(this.nameMaxLength,this.nameGenerator.name):[];this.nameError=_.isEmpty(e)?void 0:e[0]},c.prototype.areAllNicsValid=function(){return!_.some(this.nicSettingsMapWrapper,function(e){return _.some(e.errors,function(e){return e})})},c.prototype.validateAllNics=function(){if(this.nicSettingsMapWrapper)for(var e=0,t=this.nicSettingsMapWrapper;e<t.length;e++){var i=t[e];this.validateNicIpv4Address(i),this.validateNicIpv4Subnet(i),this.validateDefaultGateway(i),this.validateAlternateGateway(i),this.validateNicIpv6Address(i),this.validateNicIpv6Subnet(i),this.expandedChanged(i.expanded,i)}},c.prototype.validateNicIpv4Address=function(e){e.isIpv4Unknown&&(e.errors.isIpv4AddressInvalid=!this.ipParserService.isIpv4AddressValid(e.adapterMapping.adapter.ip.ipAddress))},c.prototype.validateNicIpv4Subnet=function(e){e.isIpv4Unknown&&(e.errors.isIpv4SubnetInvalid=!this.ipParserService.isSubnetMaskValid(e.adapterMapping.adapter.subnetMask))},c.prototype.validateNicIpv6Address=function(e){e.isIpv6Unknown&&(e.errors.isIpv6AddressInvalid=!this.ipParserService.isIpv6AddressValid(e.adapterMapping.adapter.ipV6Spec.ip[0].ipAddress))},c.prototype.validateNicIpv6Subnet=function(e){e.isIpv6Unknown&&(e.errors.isIpv6SubnetInvalid=!this.ipParserService.isSubnetPrefixValid(e.adapterMapping.adapter.ipV6Spec.ip[0].subnetMask))},c.prototype.validateDefaultGateway=function(e){e.isIpv4Unknown&&(e.errors.defaultGatewayInvalid=!!e.defaultGateway&&!this.ipParserService.isIpv4AddressValid(e.defaultGateway))},c.prototype.validateAlternateGateway=function(e){e.isIpv4Unknown&&(e.errors.alternateGatewayInvalid=!!e.alternateGateway&&!this.ipParserService.isIpv4AddressValid(e.alternateGateway))},c.prototype.validateGateway=function(e,t){if(!e)return void(t.ipv6GatewayInvalidMessage="");var i=this.ipParserService.isIpv6AddressValid(e),r=_.any(t.ipv6Gateways,function(t){return t===e});i||(t.ipv6GatewayInvalidMessage=this.i18nService.getString("VmUi","CustomizationParametersPageBase.nic.error.ipv6.address")),r&&(t.ipv6GatewayInvalidMessage=this.i18nService.getString("VmUi","CustomizationParametersPageBase.nic.error.ipv6.duplicate",e)),i&&!r&&(t.ipv6GatewayInvalidMessage="")},c.prototype.addGateway=function(e){this.validateGateway(e.lastGateway,e),e.lastGateway&&!e.ipv6GatewayInvalidMessage&&(e.ipv6Gateways.push(e.lastGateway),e.ipv6GridGatewaysOptions.data=e.ipv6Gateways,e.lastGateway="")},c.prototype.buildGridOptions=function(e){var t=this,i={};i.columnDefinitions=[{displayName:this.i18nService.getString("VmUi","CustomizationParametersPageBase.nic.ipv6.gateway"),type:"string"}],i.data=e.ipv6Gateways,i.deleteLabel=this.i18nService.getString("VmUi","CustomizationParametersPageBase.nic.delete.label"),i.deleteTooltip=this.i18nService.getString("VmUi","CustomizationParametersPageBase.nic.delete.tooltip"),i.onDelete=function(i){t.deleteGatewayFromList(i,e)},i.placeholder=this.i18nService.getString("VmUi","CustomizationParametersPageBase.noGateways"),i.gridLabel=this.i18nService.getString("VmUi","CustomizationParametersPageBase.ipv6GatewaysDescription"),e.ipv6GridGatewaysOptions=i},c.prototype.deleteGatewayFromList=function(e,t){if(e){var i=_.findIndex(t.ipv6Gateways,function(t){return t===e});i<0||t.ipv6Gateways.splice(i,1)}},c.$inject=["i18nService","$q","gosComputerNameValidationService","ipParserService","$timeout","$element"],c}();e.CustomizeGosUserSettingsPageController=c;var l=function(){function e(){this.controller=c,this.templateUrl="vm-ui/resources/vm/customize-guest-os/user-settings/customize-gos-user-settings-page.component.html",this.bindings={model:"<"}}return e}();e.CustomizeGosUserSettingsPageComponent=l,angular.module("com.vmware.vsphere.client.vm").component("customizeGosUserSettingsPage",new l)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.CustomizeGosPageModelBase,i=function(e){function t(t,i,r,n){e.call(this,t,i),this._vmGuestOsType=r,this._specification=n}return __extends(t,e),Object.defineProperty(t.prototype,"vmGuestOsType",{get:function(){return this._vmGuestOsType},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"specification",{get:function(){return this._specification},enumerable:!0,configurable:!0}),t}(t);e.CustomizeGosUserSettingsPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.vmEvcService=t,this.$rootScope=i,this.vendorEvcModes=[],this.i18n=e.getString}return e.prototype.$onInit=function(){this.onSubmit=this.onSubmit||this.applyEvcMode.bind(this),this.initEvcVendors(),this.loadVmEvcData(),this.addVendorChangeListener()},e.prototype.$onDestroy=function(){this.removeVendorChangeListener()},e.prototype.isFakeEvcVendor=function(){return this.selectedEvcVendor===this.evcVendors.NONE||this.selectedEvcVendor===this.evcVendors.CUSTOM},e.prototype.applyEvcMode=function(){return this.selectedEvcVendor!==this.evcVendors.CUSTOM&&this.vmEvcService.applyEvcMode(this.vmId,this.selectedEvcMode.featureMasks),!0},e.prototype.initEvcVendors=function(){this.evcVendorsHeader={title:this.i18n("VmUi","vmEvc.edit.selectEvcMode")},this.evcModeDescriptionHeader={title:this.i18n("VmUi","vmEvc.edit.evcModeDescription")},this.evcVendors={NONE:"NONE",AMD:"AMD",INTEL:"INTEL",CUSTOM:"CUSTOM"}},e.prototype.loadVmEvcData=function(){var e=this;this.setPageBusy(!0),this.vmEvcService.loadEditEvcData(this.vmId).then(function(t){t&&(e.evcModesByVendorMap=t.evcModesByVendor,e.selectedEvcVendor=t.vendor,e.isCurrentEvcModeCustom=e.selectedEvcVendor===e.evcVendors.CUSTOM,e.onVendorChange(),e.selectEvcModeByKey(t.key))}).then(function(){e.setPageBusy(!1)})},e.prototype.addVendorChangeListener=function(){var e=this;this.unbindEvcVendorWatch=this.$rootScope.$watch(function(){return e.selectedEvcVendor},function(t,i){t!==i&&(e.onVendorChange(),e.selectFirstEvcModeIfNeeded())})},e.prototype.removeVendorChangeListener=function(){this.unbindEvcVendorWatch&&this.unbindEvcVendorWatch()},e.prototype.onVendorChange=function(){if(!this.evcModesByVendorMap)return void(this.vendorEvcModes=[]);for(var e in this.evcModesByVendorMap)if(e===this.selectedEvcVendor){this.vendorEvcModes=this.evcModesByVendorMap[e];break}},e.prototype.selectEvcModeByKey=function(e){this.selectedEvcMode=_.find(this.vendorEvcModes,function(t){return t.key===e})},e.prototype.selectFirstEvcModeIfNeeded=function(){_.isEmpty(this.vendorEvcModes)||_.contains(this.vendorEvcModes,this.selectedEvcMode)||(this.selectedEvcMode=this.vendorEvcModes[0])},e.prototype.setPageBusy=function(e){this.loading=e},e.$inject=["i18nService","vmEvcService","$rootScope"],e}();e.EditVmEvcController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/evc-mode/edit-vm-evc.component.html",this.bindings={vmId:"<",onSubmit:"="}}return e}();e.EditVmEvcComponent=i,angular.module("com.vmware.vsphere.client.vm").component("editVmEvc",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.data.VmEvcSpec,i=function(){function e(e,t){this.dataService=e,this.mutationService=t,this.EVC_DATA="vmEvcData",this.EDIT_EVC_DATA="vmEditEvcData"}return e.prototype.loadEvcData=function(e){var t=this;return this.dataService.getProperties(e,[this.EVC_DATA]).then(function(e){return e[t.EVC_DATA]})},e.prototype.loadEditEvcData=function(e){var t=this;return this.dataService.getProperties(e,[this.EDIT_EVC_DATA]).then(function(e){return e[t.EDIT_EVC_DATA]})},e.prototype.applyEvcMode=function(e,i){var r=new t;return r.featureMasks=i,this.mutationService.apply(e,r._type,r)},e.$inject=["dataService","mutationService"],e}();e.VmEvcService=i,angular.module("com.vmware.vsphere.client.vm").service("vmEvcService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=(function(){function e(){}return e}(),function(){function e(e,t){this.i18nService=e,this.vmEvcService=t,this.EDIT_EVC_ACTION_UID="vsphere.core.vm.editEvcModeAction",this.CONNECTION_STATE_PROP_NAME="runtime.powerState",this.EVC_MODE_KEY_PROP_NAME="runtime.minRequiredEVCModeKey",this.isFakeEvcVendor=!0,this.settingsViewHeaderAccessor={},this.i18n=e.getString}return e.prototype.$onInit=function(){this.watchForObjects=[this.vmId],this.evcDataProperties=[this.EVC_MODE_KEY_PROP_NAME],this.configureEvcAvailabilityProperties=[this.CONNECTION_STATE_PROP_NAME],this.headerOptions={title:this.i18n("VmUi","vmEvc.view.title"),objectId:this.vmId,actions:[{actionUid:this.EDIT_EVC_ACTION_UID,customLabel:this.i18n("VmUi","vmEvc.edit.actionCustomLabel")}]},this.evcVendors={NONE:"NONE",AMD:"AMD",INTEL:"INTEL",CUSTOM:"CUSTOM"},this.loadEvcData()},e.prototype.refreshEvcData=function(){this.loadEvcData()},e.prototype.refreshConfigureEvcAvailability=function(){"function"==typeof this.settingsViewHeaderAccessor.refresh&&this.settingsViewHeaderAccessor.refresh()},e.prototype.loadEvcData=function(){var e=this;this.setPageBusy(!0),this.vmEvcService.loadEvcData(this.vmId).then(function(t){e.currentEvcMode=t,e.currentEvcMode&&(e.isFakeEvcVendor=e.currentEvcMode.vendor===e.evcVendors.NONE||e.currentEvcMode.vendor===e.evcVendors.CUSTOM,e.headerOptions.title=e.getTitle(),e.cpuidFeaturesList=e.generateCpuidFeaturesListData())}).then(function(){e.setPageBusy(!1)})},e.prototype.getTitle=function(){return this.currentEvcMode.vendor?this.currentEvcMode.vendor===this.evcVendors.NONE?this.i18n("VmUi","vmEvc.view.evcDisabledLabel"):this.currentEvcMode.vendor===this.evcVendors.CUSTOM?this.i18n("VmUi","vmEvc.view.evcCustomLabel"):this.i18n("VmUi","vmEvc.view.evcEnabledLabel"):this.i18n("VmUi","vmEvc.view.title")},e.prototype.setPageBusy=function(e){this.loading=e},e.prototype.generateCpuidFeaturesListData=function(){var e=this,t=[];return this.currentEvcMode.guaranteedCPUFeatures?(this.currentEvcMode.guaranteedCPUFeatures.forEach(function(i){var r=i.level;r<0&&(r=4294967295+r+1);var n={register:e.i18n("VmUi","vmEvc.view.cpuidFeaturesFlagLeafLabel",r.toString(16)),value:"",isLeaf:!0};t.push(n);var o={register:"eax",value:i.eax,isLeaf:!1};t.push(o);var a={register:"ebx",value:i.ebx,isLeaf:!1};t.push(a);var s={register:"ecx",value:i.ecx,isLeaf:!1};t.push(s);var c={register:"edx",value:i.edx,isLeaf:!1};t.push(c)}),t):t},e.$inject=["i18nService","vmEvcService"],e}());e.VmEvcController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/evc-mode/vm-evc.component.html",this.bindings={vmId:"<"}}return e}();e.VmEvcComponent=i,angular.module("com.vmware.vsphere.client.vm").component("vmEvc",new i)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").filter("render3d",["$filter","i18nService",function(e,t){"use strict";var i={automatic:"VideoCardPage.automatic",software:"VideoCardPage.software",hardware:"VideoCardPage.hardware"};return function(e){var r=i[e];return r=r||i.automatic,t.getString("VmUi",r)}}]);var h5_vm;!function(e){var t=function(){function e(){}return e}();e.CrudGridConfiguration=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.$scope=e,this.vuiConstants=t}return e.prototype.$onInit=function(){var e=this;this.datagridOptions=this.getGridOptions(),this.updateActionBar(),this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){e.onSelectionChanged.call(e,t,i)})},e.prototype.onSelectionChanged=function(e,t){JSON.stringify(e)!==JSON.stringify(t)&&(!e||0===e.length||e.length>1?this.updateActionBar():this.updateActionBar(e[0]))},e.prototype.updateActionBar=function(e){var t=this;this.datagridOptions.actionBarOptions=this.datagridOptions.actionBarOptions||{},this.datagridOptions.actionBarOptions.actions=[{enabled:!0,onClick:function(e,i){t.onAddInternal()},iconClass:"vx-icon-addIcon",label:this.configuration.addLabel,tooltipText:this.configuration.addTooltip},{enabled:!!e,onClick:function(i,r){t.onEditInternal(e)},iconClass:"vx-icon-edit16x16",label:this.configuration.editLabel,tooltipText:this.configuration.editTooltip},{enabled:!!e,onClick:function(i,r){t.onDeleteInternal(e)},iconClass:"vx-icon-deleteIcon",label:this.configuration.deleteLabel,tooltipText:this.configuration.deleteTooltip}]},e.prototype.onAddInternal=function(){this.configuration.onAdd(),this.refreshGrid()},e.prototype.onEditInternal=function(e){this.configuration.onEdit(e),this.refreshGrid()},e.prototype.onDeleteInternal=function(e){this.configuration.onDelete(e),this.refreshGrid()},e.prototype.getGridOptions=function(){return{sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,searchable:!1,resizable:!1,reorderable:!1,data:this.configuration.data,columnDefs:this.configuration.columnDefinitions,selectedItems:[],height:this.configuration.height}},e.prototype.refreshGrid=function(){this.datagridOptions.data=this.configuration.data.slice()},e.$inject=["$scope","vuiConstants"],e}();e.CrudGridController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/common/components/crud-grid/crud-grid.component.html",this.bindings={configuration:"<"}}return e}();e.CrudGridComponent=i,angular.module("com.vmware.vsphere.client.vm").component("crudGrid",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.vuiConstants=t,this.i18n=i}return e.prototype.$onInit=function(){var e=this;this.gridOptions=this.createDataGridOptions(),this.refreshGridDataSource(),this.refreshGridData=function(){e.refreshGridDataSource()},this.$scope.$watch(function(){return e.gridOptions.selectedItems},function(t,i){e.onSelectionChanged.call(e,t,i)})},e.prototype.$onDestroy=function(){},e.prototype.onAddClicked=function(){this.currentText&&(this.model.push(this.currentText),this.refreshGridDataSource())},e.prototype.onDeleteClicked=function(){void 0!==this.currentIndex&&(this.model.splice(this.currentIndex,1),this.refreshGridDataSource())},e.prototype.onMoveUpClicked=function(){if(void 0!==this.currentIndex&&0!==this.currentIndex){var e=this.currentIndex,t=e-1;this.swapItems(e,t),this.currentIndex=t}},e.prototype.onMoveDownClicked=function(){if(void 0!==this.currentIndex&&this.currentIndex+1!==this.model.length){var e=this.currentIndex,t=e+1;this.swapItems(e,t),this.currentIndex=t}},e.prototype.getCurrentTextPlaceholder=function(){return this.i18n.getString("VmUi",this.labelKey||"customizationManager.customizationSpecDetailsView.dnsSearchPathPlaceholder")},e.prototype.getAriaLabel=function(){return this.ariaLabelKey?this.i18n.getString("VmUi",this.ariaLabelKey):""},e.prototype.swapItems=function(e,t){var i=this.model[e];this.model.splice(e,1),this.model.splice(t,0,i);var r=this.gridOptions.dataSource.at(e);this.gridOptions.dataSource.remove(r),this.gridOptions.dataSource.insert(t,r)},e.prototype.onSelectionChanged=function(e,t){e===t||_.isEqual(e,t)||(!e||0===e.length||e.length>1?(this.currentIndex=void 0,this.currentText=void 0):(this.currentIndex=this.gridOptions.dataSource.indexOf(e[0]),this.currentText=e[0].name))},e.prototype.refreshGridDataSource=function(){this.currentIndex=void 0,this.currentText=void 0,this.gridOptions.data=_.map(this.model,function(e,t){return{name:e,order:t}})},e.prototype.createDataGridOptions=function(){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,searchable:!1,resizable:!1,reorderable:!1,selectedItems:[],columnDefs:[{field:"name",sortable:!1,searchable:!1}],data:[],height:"100%"}},e.$inject=["$scope","vuiConstants","i18nService"],e}();e.EntryListController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/common/components/entryList/entry-list.component.html",this.bindings={model:"<",labelKey:"<?",ariaLabelKey:"<?",refreshGridData:"=?"}}return e}();e.EntryListComponent=i,angular.module("com.vmware.vsphere.client.vm").component("entryList",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){!function(e){e[e.IMPORT_FILE=1]="IMPORT_FILE",e[e.CREATE_FILE=2]="CREATE_FILE"}(e.CustomSysprepFileOption||(e.CustomSysprepFileOption={}));e.CustomSysprepFileOption}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e}();e.GosBasePageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.Specification,i=com.vmware.vim.binding.vim.vm.customization.LinuxPrep,r=com.vmware.vim.binding.vim.vm.customization.LinuxOptions,n=com.vmware.vim.binding.vim.vm.customization.Sysprep,o=com.vmware.vim.binding.vim.vm.customization.WinOptions,a=com.vmware.vim.binding.vim.vm.customization.UserData,s=com.vmware.vim.binding.vim.vm.customization.SysprepText,c=com.vmware.vim.binding.vim.vm.customization.FixedName,l=com.vmware.vim.binding.vim.vm.customization.PrefixNameGenerator,d=com.vmware.vim.binding.vim.vm.customization.CustomNameGenerator,u=com.vmware.vim.binding.vim.vm.customization.VirtualMachineNameGenerator,p=com.vmware.vim.binding.vim.vm.customization.UnknownNameGenerator,v=com.vmware.vim.binding.vim.vm.customization.GlobalIPSettings,m=com.vmware.vim.binding.vim.vm.customization.GuiUnattended,g=com.vmware.vim.binding.vim.vm.customization.LicenseFilePrintData,h=com.vmware.vim.binding.vim.vm.customization.Password,f=com.vmware.vim.binding.vim.vm.customization.Identification,S=com.vmware.vim.binding.vim.vm.customization.GuiRunOnce,y=function(){function y(e,t,i,r,n,o){this.$q=e,this.gosCustomizationHelperService=t,this.i18nService=i,this.defaultUriSchemeUtil=r,this.gosSpecNetworkService=n,this.ipParserService=o,this.DOMAIN_DEFAULT="DOMAIN",this.WORKGROUP_DEFAULT="WORKGROUP"}return y.prototype.setModelDefaults=function(t,i,r){var n=t.gosNameAndOsPageModel;n.gosType=i,n.gosTypeChanged=r,n.originalSpecName=void 0,n.specName="",n.description="",n.isSidGenerated=!0;var o=t.computerNamePageModel;o.type=n.gosType,o.setNameOption=e.ComputerNameOption.USE_VM_NAME,o.computerName="",o.isAppendNumericValue=!1,o.generateNameArgument="",o.domainName="";var a=t.registrationInformationPageModel;a.ownerName="",a.organizationName="";var s=t.windowsLicensePageModel;s.productKey="",s.isIncludeServerLicenseInfo=!0,s.isServerLicenseModePerServer=!0,s.maxConnections=y.AUTO_USERS_MIN;var c=t.timeZonePageModel;c.timeZoneArea="",c.timeZoneLocation="",c.timeZoneWinCode=0,c.hwClockUTC=!0;var l=t.networkPageModel;l.networkSettingsType=e.GosNetworkSettingsType.STANDARD,l.adapterMappingWrappers=this.gosSpecNetworkService.getInitialNetworkCards(),l.dnsSuffixList=[];var d=t.dnsSettingsPageModel;d.primaryDns="",d.secondaryDns="",d.tertiaryDns="",d.dnsSearchPath=[];var u=t.administratorPasswordPageModel;u.autoLogon=!1,u.password="",u.confirmedPassword="",u.isPasswordChanged=!1,u.logonTimes=1;var p=t.customSysprepFilePageModel;p.fileOption=e.CustomSysprepFileOption.IMPORT_FILE,p.sysprepContent="",p.sysprepImportFileContent="",p.sysprepImportFileName="";var v=t.workgroupDomainPageModel;v.networkOption=e.WorkgroupDomainTypeOption.WORKGROUP,v.workgroup=this.WORKGROUP_DEFAULT,v.domain=this.DOMAIN_DEFAULT,v.username="",v.password="",v.confirmPassword="",v.isDomainPasswordChanged=!1;var m=t.commandsPageModel;m.commands=[]},y.prototype.populatePageModels=function(e,t,i){e.gosNameAndOsPageModel&&(this.populateNameAndOsModel(e,t,i),this.updateDependentModels(e,e.gosNameAndOsPageModel)),e.computerNamePageModel&&(this.populateComputerNameModel(e,t,i),this.updateDependentModels(e,e.computerNamePageModel)),e.registrationInformationPageModel&&(this.populateRegistrationInformationModel(e,i),this.updateDependentModels(e,e.registrationInformationPageModel)),e.windowsLicensePageModel&&(this.populateWindowsLicenseModel(e,t,i),this.updateDependentModels(e,e.windowsLicensePageModel)),e.timeZonePageModel&&(this.populateTimeZoneModel(e,t,i),this.updateDependentModels(e,e.timeZonePageModel)),e.networkPageModel&&(this.populateNetworkPageModel(e,i),this.updateDependentModels(e,e.networkPageModel)),e.dnsSettingsPageModel&&(this.populateDnsSettingsModel(e,t,i),this.updateDependentModels(e,e.dnsSettingsPageModel)),e.customSysprepFilePageModel&&(this.populateCustomSysprepFileModel(e,t,i),this.updateDependentModels(e,e.customSysprepFilePageModel)),e.administratorPasswordPageModel&&(this.populateAdministratorPasswordModel(e,t,i),this.updateDependentModels(e,e.administratorPasswordPageModel)),e.commandsPageModel&&(this.populateCommandsModel(e,t,i),this.updateDependentModels(e,e.commandsPageModel)),e.osOptionsPageModel&&(this.populateOsOptionsModel(e,t,i),this.updateDependentModels(e,e.osOptionsPageModel)),e.workgroupDomainPageModel&&(this.populateWorkgroupDomainModel(e,t,i),this.updateDependentModels(e,e.workgroupDomainPageModel))},y.prototype.updateDependentModels=function(t,i){if(i)if(i instanceof e.GosNameAndOsPageModel)this.nameAndOsModelChanged(t);else if(i instanceof e.GosComputerNamePageModel)this.computerNameModelChanged(t);else if(i instanceof e.GosRegistrationInformationPageModel)this.registrationInformationModelChanged(t);else if(i instanceof e.GosWindowsLicensePageModel)this.windowsLicenseModelChanged(t);else if(i instanceof e.GosTimeZonePageModel)this.timeZoneModelChanged(t);else if(i instanceof e.GosDnsSettingsPageModel)this.dnsSettingsModelChanged(t);else if(i instanceof e.GosNetworkPageModel)this.networkPageModelChanged(t);else if(i instanceof e.GosAdministratorPasswordPageModel)this.administratorPassModelChanged(t);else if(i instanceof e.GosCommandsPageModel)this.commandsModelChanged(t);else if(i instanceof e.GosCustomSysprepFilePageModel)this.customSysprepFileModelChanged(t);else{if(!(i instanceof e.GosWorkgroupDomainPageModel))throw new Error("Unknown page model type");this.workgroupDomainModelChanged(t)}},y.prototype.populateNameAndOsModel=function(t,i,r){var n=t.gosNameAndOsPageModel;n.gosType=this.gosCustomizationHelperService.getGosType(r.identity),n.specName=i.name,n.description=i.description,n.vc=i.vcService,n.isEditMode=!0,n.gosType!==e.GosType.LINUX?n.isSidGenerated=r.options.changeSID:n.isSidGenerated=!0},y.prototype.populateRegistrationInformationModel=function(e,t){var i=e.registrationInformationPageModel,r=this.gosCustomizationHelperService.isSysPrep(t);if(t&&r){var n=t.identity.userData;i.ownerName=n.fullName,i.organizationName=n.orgName}},y.prototype.nameAndOsModelChanged=function(c){var l=c.gosNameAndOsPageModel,d={customSysprepFilePageModel:c.customSysprepFilePageModel,computerName:c.computerNamePageModel,timeZone:c.timeZonePageModel,network:c.networkPageModel,finish:c.finishPageModel};if(!l.vc||!l.vc.serviceGuid)throw new Error("sourceModel.vc.serviceGuid is not set ");if(d.customSysprepFilePageModel&&(d.customSysprepFilePageModel.vcServerGuid=l.vc.serviceGuid),d.computerName&&(d.computerName.vcServiceGuid=l.vc.serviceGuid,d.computerName.type=l.gosType),d.network&&(d.network.vcServiceGuid=l.vc.serviceGuid,d.network.type=l.gosType),d.timeZone){if(!l.vc)throw new Error("VC info is not defined");d.timeZone.customizationSpecManagerUrn=this.defaultUriSchemeUtil.getVsphereObjectId(l.vc.content.customizationSpecManager),d.timeZone.type=l.gosType}if(d.finish.specName=l.specName,d.finish.description=l.description,d.finish.customizationSpecManager=l.vc.content.customizationSpecManager,d.finish.specDetails||(d.finish.specDetails=new t),l.gosType!==e.GosType.LINUX&&(d.finish.specDetails.options=new o,d.finish.specDetails.options.changeSID=l.isSidGenerated),d.finish.gosType!==l.gosType)switch(d.finish.gosType=l.gosType,l.gosType){case e.GosType.LINUX:var u=new i;d.finish.specDetails.options=new r,d.finish.specDetails.identity=u;break;case e.GosType.WINDOWS:var p=new n;p.userData=new a,p.guiUnattended=new m,d.finish.specDetails.identity=p;break;case e.GosType.WINDOWS_CUSTOM_SYSPREP:d.finish.specDetails.identity=new s;break;default:throw new Error("Invalid GOS type")}},y.prototype.populateComputerNameModel=function(t,r,n){var o=t.computerNamePageModel,a=this.gosCustomizationHelperService.getNameGenerator(n);switch(o.vcServiceGuid=r.vcService.serviceGuid,o.computerName="",o.isAppendNumericValue=!1,o.generateNameArgument="",a._type){case e.GosCustomizationHelperService.COMPUTER_NAME_TYPE_FIXED_NAME:o.setNameOption=e.ComputerNameOption.ENTER_NAME,o.computerName=a.name;break;case e.GosCustomizationHelperService.COMPUTER_NAME_TYPE_PREFIX_NAME_GENERATOR:o.setNameOption=e.ComputerNameOption.ENTER_NAME,o.computerName=a.base,o.isAppendNumericValue=!0;break;case e.GosCustomizationHelperService.COMPUTER_NAME_TYPE_VIRTUAL_MACHINE_NAME_GENERATOR:o.setNameOption=e.ComputerNameOption.USE_VM_NAME;break;case e.GosCustomizationHelperService.COMPUTER_NAME_TYPE_CUSTOM_NAME_GENERATOR:o.setNameOption=e.ComputerNameOption.GENERATE_NAME;break;case e.GosCustomizationHelperService.COMPUTER_NAME_TYPE_UNKNOWN_NAME_GENERATOR:o.setNameOption=e.ComputerNameOption.DEPLOY_WIZARD,o.generateNameArgument=a.argument;break;default:throw new Error("Unknown computer name option")}o.domainName="",n.identity._type===(new i)._type&&(o.domainName=n.identity.domain)},y.prototype.computerNameModelChanged=function(t){var r=t.computerNamePageModel,o={network:t.networkPageModel,finish:t.finishPageModel};o.network&&(o.network.isNameIpGeneratorDefined=r.isNameIpGeneratorDefined);var a;switch(r.setNameOption){case e.ComputerNameOption.ENTER_NAME:r.isAppendNumericValue?(a=new l,a.base=r.computerName):(a=new c,a.name=r.computerName);break;case e.ComputerNameOption.USE_VM_NAME:a=new u;break;case e.ComputerNameOption.GENERATE_NAME:a=new d,a.argument=r.generateNameArgument;break;case e.ComputerNameOption.DEPLOY_WIZARD:a=new p;break;default:throw new Error("Unknown computer name option")}o.finish.specDetails.identity instanceof i?o.finish.specDetails.identity.hostName=a:o.finish.specDetails.identity instanceof n&&(o.finish.specDetails.identity.userData.computerName=a),o.finish.specDetails.identity.domain=r.domainName},y.prototype.registrationInformationModelChanged=function(e){var t=e.registrationInformationPageModel,i={finish:e.finishPageModel};i.finish.specDetails.identity instanceof n&&(i.finish.specDetails.identity.userData.fullName=t.ownerName,i.finish.specDetails.identity.userData.orgName=t.organizationName);
},y.prototype.populateWindowsLicenseModel=function(e,t,i){var r=e.windowsLicensePageModel,n=i.identity.userData;if(r.productKey=_.isEmpty(n.productId)?"":n.productId,r.isIncludeServerLicenseInfo=this.gosCustomizationHelperService.isServerLicensingIncluded(i),r.isIncludeServerLicenseInfo){var o=i.identity.licenseFilePrintData;r.isServerLicenseModePerServer="perServer"===o.autoMode,r.maxConnections=o.autoUsers}else r.isServerLicenseModePerServer=!0,r.maxConnections=y.AUTO_USERS_MIN},y.prototype.windowsLicenseModelChanged=function(e){var t=e.windowsLicensePageModel,i={finish:e.finishPageModel},r=i.finish.specDetails.identity;if(r.userData.productId=t.productKey,t.isIncludeServerLicenseInfo){var n=new g;n.autoMode=t.isServerLicenseModePerServer?"perServer":"perSeat",n.autoUsers=t.maxConnections,r.licenseFilePrintData=n}else delete r.licenseFilePrintData},y.prototype.populateTimeZoneModel=function(t,r,o){var a=t.timeZonePageModel;if(o.identity._type===(new i)._type){a.hwClockUTC=o.identity.hwClockUTC;var s=o.identity.timeZone;if(s){var c=o.identity.timeZone.split(e.GosCustomizationHelperService.AREA_LOCATION_SEPARATOR);a.timeZoneArea=c[0],c.shift();var l=c.join(e.GosCustomizationHelperService.AREA_LOCATION_SEPARATOR);a.timeZoneLocation=l}}else o.identity._type===(new n)._type&&(a.timeZoneWinCode=o.identity.guiUnattended.timeZone)},y.prototype.timeZoneModelChanged=function(t){var r=t.timeZonePageModel,o={finish:t.finishPageModel};if(o.finish.specDetails.identity instanceof i){var a=o.finish.specDetails.identity;r.timeZoneArea&&r.timeZoneLocation&&(a.timeZone=r.timeZoneArea+e.GosCustomizationHelperService.AREA_LOCATION_SEPARATOR+r.timeZoneLocation),a.hwClockUTC=r.hwClockUTC}else{if(!(o.finish.specDetails.identity instanceof n))throw new Error("Invalid identity type of GOS customization specification");var a=o.finish.specDetails.identity;a.guiUnattended.timeZone=r.timeZoneWinCode}},y.prototype.populateDnsSettingsModel=function(e,t,i){var r=e.dnsSettingsPageModel;r.primaryDns=this.gosCustomizationHelperService.getPrimaryDnsServer(i),r.secondaryDns=this.gosCustomizationHelperService.getSecondaryDnsServer(i),r.tertiaryDns=this.gosCustomizationHelperService.getTertiaryDnsServer(i),r.dnsSearchPath=angular.copy(this.gosCustomizationHelperService.getDnsSuffixList(i))},y.prototype.dnsSettingsModelChanged=function(e){var t=e.dnsSettingsPageModel,i={finish:e.finishPageModel};i.finish.specDetails.globalIPSettings=new v;var r,n=[];""!==t.primaryDns&&(r=t.primaryDns,this.ipParserService.isIpv4AddressValid(r)&&(r=ipaddr.parse(r).toString()),n.push(r)),""!==t.secondaryDns&&(r=t.secondaryDns,this.ipParserService.isIpv4AddressValid(r)&&(r=ipaddr.parse(r).toString()),n.push(r)),""!==t.tertiaryDns&&(r=t.tertiaryDns,this.ipParserService.isIpv4AddressValid(r)&&(r=ipaddr.parse(r).toString()),n.push(r)),i.finish.specDetails.globalIPSettings.dnsServerList=n,i.finish.specDetails.globalIPSettings.dnsSuffixList=t.dnsSearchPath},y.prototype.populateNetworkPageModel=function(t,i){var r=t.networkPageModel;_.isNull(i.globalIPSettings.dnsSuffixList)&&(i.globalIPSettings.dnsSuffixList=[]),r.dnsSuffixList=i.globalIPSettings.dnsSuffixList,r.networkSettingsType=this.gosSpecNetworkService.isNetworkTypeStandard(i)?e.GosNetworkSettingsType.STANDARD:e.GosNetworkSettingsType.CUSTOM,e.GosNetworkSettingsType.CUSTOM===r.networkSettingsType?r.adapterMappingWrappers=this.gosSpecNetworkService.createAdapterMappingWrappersFromSpecification(i):r.adapterMappingWrappers=this.gosSpecNetworkService.getInitialNetworkCards()},y.prototype.networkPageModelChanged=function(i){var r=i.networkPageModel,n={computerName:i.computerNamePageModel,finish:i.finishPageModel};if(n.computerName&&(n.computerName.isNameIpGeneratorDefined=r.isNameIpGeneratorDefined),n.finish.specDetails||(n.finish.specDetails=new t),n.finish.specDetails.globalIPSettings||(n.finish.specDetails.globalIPSettings=new v),n.finish.specDetails.nicSettingMap=[],e.GosNetworkSettingsType.STANDARD===r.networkSettingsType)return void n.finish.specDetails.nicSettingMap.push(this.gosSpecNetworkService.createNewAdapterMappingWrapper("").adapterMapping);for(var o=0,a=r.adapterMappingWrappers;o<a.length;o++){var s=a[o];n.finish.specDetails.nicSettingMap.push(s.adapterMapping)}n.finish.specDetails.globalIPSettings.dnsSuffixList=r.dnsSuffixList},y.prototype.populateAdministratorPasswordModel=function(e,t,i){var r=e.administratorPasswordPageModel,n=i.identity;r.password=n.guiUnattended.password?n.guiUnattended.password.value:"",r.isPreviousPasswordBlank=""===r.password,r.confirmedPassword=r.password,r.autoLogon=n.guiUnattended.autoLogon,r.logonTimes=n.guiUnattended.autoLogonCount},y.prototype.populateCustomSysprepFileModel=function(t,i,r){var n=t.customSysprepFilePageModel,o=r.identity;o.value&&(n.fileOption=e.CustomSysprepFileOption.CREATE_FILE,n.sysprepContent=o.value)},y.prototype.populateCommandsModel=function(e,t,i){var r=e.commandsPageModel,n=i.identity;n.guiRunOnce&&n.guiRunOnce.commandList?r.commands=angular.copy(n.guiRunOnce.commandList):r.commands=[]},y.prototype.populateOsOptionsModel=function(e,t,i){},y.prototype.populateWorkgroupDomainModel=function(t,i,r){var n=t.workgroupDomainPageModel,o=r.identity;if(_.isEmpty(o.identification.joinWorkgroup)){n.networkOption=e.WorkgroupDomainTypeOption.DOMAIN,n.workgroup=this.WORKGROUP_DEFAULT,n.domain=o.identification.joinDomain,n.username=o.identification.domainAdmin;var a=o.identification.domainAdminPassword;n.password=_.isEmpty(a)?"":a.value,n.confirmPassword=_.isEmpty(a)?"":a.value}else n.networkOption=e.WorkgroupDomainTypeOption.WORKGROUP,n.workgroup=o.identification.joinWorkgroup,n.domain=this.DOMAIN_DEFAULT},y.prototype.administratorPassModelChanged=function(t){var i={administratorPasswordPageModel:t.administratorPasswordPageModel,nameAndOsPageModel:t.gosNameAndOsPageModel},r={finish:t.finishPageModel};if(i.nameAndOsPageModel.gosType===e.GosType.WINDOWS){var n=r.finish.specDetails.identity,o=i.administratorPasswordPageModel.password;if(o&&!_.isEmpty(o)){var a=new h;a.plainText=!1,a.value=o,r.finish.encryptAdminPassword=i.administratorPasswordPageModel.isPasswordChanged,n.guiUnattended.password=a}else n.guiUnattended.password&&delete n.guiUnattended.password;n.guiUnattended.autoLogon=i.administratorPasswordPageModel.autoLogon,n.guiUnattended.autoLogonCount=i.administratorPasswordPageModel.logonTimes}},y.prototype.commandsModelChanged=function(e){var t=e.commandsPageModel,i={finish:e.finishPageModel},r=i.finish.specDetails.identity;return t.commands&&t.commands.length?(r.guiRunOnce=new S,void(r.guiRunOnce.commandList=t.commands)):void(r.guiRunOnce&&delete r.guiRunOnce)},y.prototype.customSysprepFileModelChanged=function(t){var i=t.customSysprepFilePageModel,r={finish:t.finishPageModel},n=r.finish.specDetails.identity;n.value=i.fileOption===e.CustomSysprepFileOption.CREATE_FILE?i.sysprepContent:i.sysprepImportFileContent},y.prototype.workgroupDomainModelChanged=function(t){var i=t.workgroupDomainPageModel,r={finish:t.finishPageModel},n=r.finish.specDetails.identity;n.identification=new f,i.networkOption===e.WorkgroupDomainTypeOption.WORKGROUP?n.identification.joinWorkgroup=i.workgroup:(n.identification.joinDomain=i.domain,n.identification.domainAdmin=i.username,i.password&&(n.identification.domainAdminPassword=new h,n.identification.domainAdminPassword.value=i.password,n.identification.domainAdminPassword.plainText=!1,r.finish.encryptDomainPassword=i.isDomainPasswordChanged))},y.$inject=["$q","gosCustomizationHelperService","i18nService","defaultUriSchemeUtil","gosSpecNetworkService","ipParserService"],y.AUTO_USERS_MIN=5,y}();e.GosSpecModelManagerService=y,angular.module("com.vmware.vsphere.client.vm").service("gosSpecModelManagerService",y)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.validateName=function(t,i,r,n){void 0===i&&(i=!1),t=t.trim();var o=i?e.LONG_ERROR_KEYS:e.SHORT_ERROR_KEYS;if(!t)return this.i18nService.getString("VmUi",o.emptySpecName);if(this.byteCount(t)>e.MAX_NAME_LENGTH)return this.i18nService.getString("VmUi",o.tooLongSpecName);if(!r)return"";for(var a=0,s=r;a<s.length;a++){var c=s[a];if(c.name===t&&(!n||c.vCenterName===n))return this.i18nService.getString("VmUi",o.specNameAlreadyExists)}return""},e.prototype.byteCount=function(e){return encodeURI(e).split(/%..|./).length-1},e.MAX_NAME_LENGTH=255,e.SHORT_ERROR_KEYS={emptySpecName:"guestOsCustomization.nameAndTargetOsPage.emptySpecNameError",tooLongSpecName:"customizationSpec.nameAndOsPage.tooLongSpecNameError",specNameAlreadyExists:"customizationSpec.nameAndOsPage.specNameAlreadyExists"},e.LONG_ERROR_KEYS={emptySpecName:"customizationSpec.nameAndOsPage.emptySpecNameError",tooLongSpecName:e.SHORT_ERROR_KEYS.tooLongSpecName,specNameAlreadyExists:e.SHORT_ERROR_KEYS.specNameAlreadyExists},e.$inject=["i18nService"],e}();e.GosSpecValidationService=t,angular.module("com.vmware.vsphere.client.vm").service("gosSpecValidationService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e}();e.AdapterMappingWrapper=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.value=e}return e.WINDOWS_VALUE="windows",e.WINDOWS_CUSTOM_SYSPREP_VALUE="windowsWithCustomSysPrep",e.LINUX_VALUE="linux",e.WINDOWS=new e(e.WINDOWS_VALUE),e.WINDOWS_CUSTOM_SYSPREP=new e(e.WINDOWS_CUSTOM_SYSPREP_VALUE),e.LINUX=new e(e.LINUX_VALUE),e.NONE=new e(""),e}();e.GosType=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.value=e}return e.STANDART_VALUE="standard",e.CUSTOM_VALUE="custom",e.STANDARD=new e(e.STANDART_VALUE),e.CUSTOM=new e(e.CUSTOM_VALUE),e.NONE=new e(""),e}();e.GosNetworkSettingsType=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){!function(e){e[e.WORKGROUP=1]="WORKGROUP",e[e.DOMAIN=2]="DOMAIN"}(e.WorkgroupDomainTypeOption||(e.WorkgroupDomainTypeOption={}));e.WorkgroupDomainTypeOption}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.GosType,i=com.vmware.vsphere.client.vm.customizations.VmCustomizationSpec,r=function(){function e(e,i,r,n,o,a,s,c){this.gosSpecCreatePagesService=e,this.gosSpecModelManagerService=i,this.wizardPageService=r,this.$rootScope=n,this.vuiService=o,this.i18nService=a,this.mutationService=s,this.$q=c,this.defaultFlowId=t.WINDOWS}return e.prototype.open=function(e,t){this.onActionInvoked=e,this.wizardScope=this.$rootScope.$new(),this.wizardScope.allSpecs=t;var i=this.buildWizardConfig();this.wizardScope.config={title:this.i18nService.getString("VmUi","customizationSpecWizard.title"),cssClass:"provisioning-vm-wizards"},this.wizardScope.config.pages=i.pages,this.wizardScope.config.flows=i.flows,this.wizardScope.config.onFinish=i.onFinish,this.selectedFlowId=this.defaultFlowId,this.gosSpecModelManagerService.setModelDefaults(this.wizardScope,this.defaultFlowId,this.onWizardFlowChange.bind(this)),this.vuiService.createWizard({scope:this.wizardScope,configObjectName:"config"}).show()},e.prototype.buildWizardConfig=function(){var e=[t.WINDOWS,t.WINDOWS_CUSTOM_SYSPREP,t.LINUX],i=this.gosSpecCreatePagesService.createNameAndOsPage(this.wizardScope,this.onPageCommit.bind(this),this.defaultFlowId,e),r=this.gosSpecCreatePagesService.getWizardFlows(this.wizardScope,this.onPageCommit.bind(this));return{flows:this.wizardPageService.initializeFlowStates(r),pages:[i],onFinish:this.onWizardComplete.bind(this)}},e.prototype.onWizardFlowChange=function(e){this.selectedFlowId=e,this.wizardScope.config.currentPage.decisionOptions.selectedFlowId=this.selectedFlowId,this.wizardPageService.initializeFlowStates(this.wizardScope.config.flows)},e.prototype.onPageCommit=function(e){var t=this,i=e.onPageCommit?e.onPageCommit():this.$q.resolve([]);return i.then(function(i){return!!i&&(t.wizardPageService.clearErrors(t.wizardScope.config),i&&i.length>0?(t.wizardPageService.markPageIncompleteWithErrors(t.wizardScope.config,i),!1):(t.gosSpecModelManagerService.updateDependentModels(t.wizardScope,e),t.wizardPageService.markPageComplete(t.wizardScope.config,t.selectedFlowId),!0))})},e.prototype.onWizardComplete=function(){var e=this,t=this.wizardScope.finishPageModel,r=new i;r.config=t.buildSpec(),t.addWindowsParams(r),r.customizationSpecManager=t.customizationSpecManager;var n=this.i18nService.getString("VmUi","customizationSpec.createSpecOperationName");return this.mutationService.add(r._type,r,n).then(function(t){e.onActionInvoked("vsphere.core.vm.gos.customization.new",t)}),!0},e.$inject=["gosSpecCreatePagesService","gosSpecModelManagerService","wizardPageService","$rootScope","vuiService","i18nService","mutationService","$q"],e}();e.CreateGuestOsCustomizationSpecWizardService=r,angular.module("com.vmware.vsphere.client.vm").service("createGuestOsCustomizationSpecWizardService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.customizations.VmCustomizationRemovalSpec,i=function(){function e(e,t,i,r){this.defaultUriSchemeUtil=e,this.mutationService=t,this.actionConfirmationService=i,this.$q=r}return e.prototype.confirmDelete=function(e,t){var i=this.$q.defer(),r={useClarity:!0,title:e,message:t,yesHandler:function(){i.resolve()},noHandler:function(){i.reject()}};return this.actionConfirmationService.showConfirmationDialog(r),i.promise},e.prototype["delete"]=function(e){var i=new t;i.specName=e.name;var r=this.defaultUriSchemeUtil.getVsphereObjectId(e.vcService.content.customizationSpecManager);return this.mutationService.remove(r,i._type,i)},e.$inject=["defaultUriSchemeUtil","mutationService","actionConfirmationService","$q"],e}();e.DeleteGosSpecService=i,angular.module("com.vmware.vsphere.client.vm").service("deleteGosSpecService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.customizations.VmCustomizationDuplicateSpec,i=function(){function e(e,t,i,r,n,o,a){this.$q=e,this.i18nService=t,this.vuiConstants=i,this.userSessionService=r,this.gosSpecValidationService=n,this.duplicateGosSpecService=o,this.idGeneratorService=a,this.name="",this.description="",this.vcLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.vcLabel"),this.nameLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.name"),this.descriptionLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.description"),this.customizationSectionLabel=this.i18nService.getString("VmUi","guestOsCustomization.nameAndTargetOsPage.vmCustomizationSection")}return e.prototype.$onInit=function(){var e=this;this.sourceSpecManagerRef=this.sourceSpecInfo.vcService.content.customizationSpecManager,this.retrieveVcenterData(),this.onSubmit=function(){return e.submitForm()},this.createAriaIds()},e.prototype.createAriaIds=function(){this.descriptionId=this.idGeneratorService.nextId("descriptionId"),this.vcId=this.idGeneratorService.nextId("vcId"),this.nameId=this.idGeneratorService.nextId("nameId"),this.customizationSectionLabelId=this.idGeneratorService.nextId("customizationSectionLabelId"),this.invalidNameMessageId=this.idGeneratorService.nextId("invalidNameMessageId")},e.prototype.isNameValid=function(){return this.invalidNameMessage=this.gosSpecValidationService.validateName(this.name,!1,this.allSpecs,this.vCenter.name),!this.invalidNameMessage},e.prototype.retrieveVcenterData=function(){var e=this;this.submitDisabled=!0,this.userSessionService.getAllServersInfo().then(function(t){e.vCentersData=t.serversInfo,e.vCentersData&&e.vCentersData.length>0&&(e.vCenter=e.vCentersData[0])}).then(function(){e.submitDisabled=!1})},e.prototype.submitForm=function(){var e=this,i=this.gosSpecValidationService.validateName(this.name,!0,this.allSpecs,this.vCenter.name);if(this.createAlerts(i?[i]:[]),i)return this.$q.resolve(!1);this.submitDisabled=!0;var r=new t;return r.sourceSpecName=this.sourceSpecInfo.name,r.sourceSpecManagerRef=this.sourceSpecManagerRef,r.newSpecName=this.name,r.newSpecDesc=this.description,r.targetVcGuid=this.vCenter.serviceGuid,this.duplicateGosSpecService.validateSpec(r).then(function(t){return e.submitDisabled=!1,!t.isValid&&t.errors&&t.errors.length>0&&e.createAlerts(t.errors),t.isValid?t.keyValidationSucceeded?e.duplicateGosSpecService.duplicateSpec(r).then(function(t){return!t.isValid&&t.errors&&t.errors.length>0&&e.createAlerts(t.errors),t.isValid}):(e.duplicateGosSpecService.confirmKeyChange(r),t.isValid):t.isValid})},e.prototype.createAlerts=function(e){var t=this;this.alerts=[],_.each(e,function(e){var i={type:t.vuiConstants.validationBanner.type.ERROR,text:e};t.alerts.push(i)})},e.$inject=["$q","i18nService","vuiConstants","userSessionService","gosSpecValidationService","duplicateGosSpecService","idGeneratorService"],e}(),r=function(){function e(){this.bindings={sourceSpecInfo:"<",allSpecs:"<",alerts:"=",onSubmit:"=",submitDisabled:"="},this.controller=i,this.templateUrl="vm-ui/resources/vm/guest-os-customization/duplicate/duplicate-gos-spec.component.html"}return e}();e.DuplicateGosSpecComponent=r,angular.module("com.vmware.vsphere.client.vm").component("duplicateGosSpec",new r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.$q=e,this.i18nService=t,this.clarityModalService=i,this.mutationService=r,this.defaultUriSchemeUtil=n,this.duplicateGosSpecResult={result:void 0,openSpecForEdit:!1}}return e.prototype.openDuplicateForm=function(e,t){var i=this;this.duplicateGosSpecDefered=this.$q.defer(),this.duplicateGosSpecResult={result:void 0,openSpecForEdit:!1};var r={title:this.i18nService.getString("VmUi","guestOsCustomization.duplicate"),contentTemplate:"vm-ui/resources/vm/guest-os-customization/duplicate/duplicate-gos-spec.view.html",defaultButton:"submit",dialogData:{sourceCustomizationSpecInfo:e,allCustomizationSpecs:t},onCancel:function(){i.duplicateGosSpecDefered.reject()}};return this.clarityModalService.openOkCancelModal(r),this.duplicateGosSpecDefered.promise},e.prototype.validateSpec=function(e){var t=this;this.duplicateGosSpecResult.openSpecForEdit=!1;var i=this.defaultUriSchemeUtil.getVsphereObjectId(e.sourceSpecManagerRef);return this.mutationService.validate(i,e._type,e).then(function(e){if(!e||!e.result||e.error){var i=t.i18nService.getString("VmUi","guestOsCustomization.duplicate.error");return t.$q.resolve({isValid:!1,errors:[i]})}var r=e.result;if(!r.hasVcPrivileges){var n=t.i18nService.getString("VmUi","customizationSpec.nameAndOsPage.noPrivileges");return t.$q.resolve({isValid:!1,errors:[n]})}return t.$q.resolve({isValid:!0,keyValidationSucceeded:r.keyValidationSucceeded})})},e.prototype.duplicateSpec=function(e){var t=this;return this.mutationService.add(e._type,e).then(function(e){return t.duplicateGosSpecResult.result=e,t.duplicateGosSpecDefered.resolve(t.duplicateGosSpecResult),{isValid:!0}},function(e){t.duplicateGosSpecDefered.reject();var i=t.i18nService.getString("VmUi","guestOsCustomization.duplicate.error");return{isValid:!1,errors:[i]}})},e.prototype.confirmKeyChange=function(e){var t=this,i={title:this.i18nService.getString("VmUi","importCustomizationSpec.invalidKey.title"),message:this.i18nService.getString("VmUi","importCustomizationSpec.invalidKey.text"),saveButtonLabel:this.i18nService.getString("Common","alert.continue"),icon:null,clarityIcon:{shape:"warning","class":"is-warning",size:48},submit:function(){t.duplicateSpec(e),t.duplicateGosSpecResult.openSpecForEdit=!0},onCancel:function(){t.duplicateGosSpecDefered.reject(),t.duplicateGosSpecResult.openSpecForEdit=!1},preserveNewlines:!0};this.clarityModalService.openConfirmationModal(i)},e.$inject=["$q","i18nService","clarityModalService","mutationService","defaultUriSchemeUtil"],e}();e.DuplicateGosSpecService=t,angular.module("com.vmware.vsphere.client.vm").service("duplicateGosSpecService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.GosType,i=com.vmware.vsphere.client.vm.customizations.VmCustomizationEditSpec,r=function(){function e(e,i,r,n,o,a,s,c,l,d){this.gosCustomizationHelperService=e,this.gosSpecCreatePagesService=i,this.gosSpecModelManagerService=r,this.vxMultiPageDialogService=n,this.defaultUriSchemeUtil=o,this.$rootScope=a,this.i18nService=s,this.vuiConstants=c,this.mutationService=l,this.$q=d,this.gosType=t.NONE}return e.prototype.open=function(e){this.specInfo=e.specInfo,this.specDetails=e.specDetails,this.onActionInvoked=e.onActionInvoked,this.gosType=this.gosCustomizationHelperService.getGosType(e.specDetails.identity),this.dialogScope=this.$rootScope.$new(),this.dialogScope.dialogConfig={},this.dialogScope.allSpecs=e.allSpecs;var t=this.specInfo.name;_.extend(this.dialogScope.dialogConfig,{title:this.i18nService.getString("VmUi","editSpecWizard.title",t),iconClass:e.iconClass,pages:this.gosSpecCreatePagesService.getDialogPages(this.dialogScope,this.gosType,this.onPageCommit.bind(this)),show:!0,loading:!1,loadingMessage:this.i18nService.getString("CommonUi","wizard.loading"),confirmOptions:{onClick:this.onDialogComplete.bind(this)},height:"720px",resizable:!0,draggable:!0,maximizable:!0});var i={scope:this.dialogScope,configObjectName:"dialogConfig"};this.gosSpecModelManagerService.populatePageModels(this.dialogScope,e.specInfo,e.specDetails),this.vxMultiPageDialogService(i)},e.prototype.onDialogComplete=function(){var e=this,t=this.dialogScope.finishPageModel,r=new i;r.config=t.buildSpec(),t.addWindowsParams(r),r.customizationSpecManager=t.customizationSpecManager,r.oldName=this.specInfo.name,r.newName=r.config.info.name,r.isSpecModified=!0;var n=this.defaultUriSchemeUtil.getVsphereObjectId(r.customizationSpecManager),o=this.i18nService.getString("VmUi","customizationSpec.editSpecOperationName");return this.mutationService.apply(n,r._type,r,o).then(function(t){e.onActionInvoked("vsphere.core.vm.gos.customization.edit",t)}),!0},e.prototype.onPageCommit=function(e){var t=this,i=e.onPageCommit?e.onPageCommit():this.$q.resolve([]);return i.then(function(i){return t.clearValidationMessages(),!!i&&(i&&i.length>0?(t.showValidationErrors(i),!1):(t.gosSpecModelManagerService.updateDependentModels(t.dialogScope,e),!0))})},e.prototype.showValidationErrors=function(e){var t=this;if(e){var i=e.map(function(e){return{text:e,type:t.vuiConstants.validationBanner.type.ERROR}});this.dialogScope.dialogConfig.validationBanner.messages=i}},e.prototype.clearValidationMessages=function(){this.dialogScope.dialogConfig.validationBanner.messages=[]},e.$inject=["gosCustomizationHelperService","gosSpecCreatePagesService","gosSpecModelManagerService","vxMultiPageDialogService","defaultUriSchemeUtil","$rootScope","i18nService","vuiConstants","mutationService","$q"],e}();e.EditGuestOsCustomizationSpecDialogService=r,angular.module("com.vmware.vsphere.client.vm").service("editGuestOsCustomizationSpecDialogService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.$q=e,this.$element=t,this.$timeout=i,this.i18nService=r,this.vuiConstants=n,this.userSessionService=o,this.gosSpecValidationService=a,this.importGosSpecService=s,this.name="",this.description="",this.vcLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.vcLabel"),this.nameLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.name"),this.descriptionLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.description"),this.sourceLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.sourceFile"),this.browseButtonLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.browseLabel"),this.loadingLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.loadingLabel"),this.fileNameToDisplay=this.i18nService.getString("VmUi","guestOsCustomization.import.sourceFile.noFileSelected"),this.customizationSectionLabel=this.i18nService.getString("VmUi","guestOsCustomization.nameAndTargetOsPage.vmCustomizationSection"),this.sourceFileSectionLabel=this.i18nService.getString("VmUi","guestOsCustomization.import.sourceFileLabel")}return e.prototype.$onInit=function(){var e=this;this.retrieveVcenterData(),this.importSpecInput=this.$element.find(".gos-spec-file-input"),this.importSpecInput.on("change",function(t){t.target.files&&t.target.files.length&&(e.alerts=[],e.validateSpecName(),e.onFileSelected(t).then(function(){e.validateSpecName()})["catch"](function(t){e.createAlerts([t])}))}),this.onSubmit=function(){return e.submitForm()}},e.prototype.onChooseFileClicked=function(){var e=this;this.$timeout(function(){e.importSpecInput.click()},0)},e.prototype.validateSpecName=function(){this.invalidNameMessage=this.gosSpecValidationService.validateName(this.name,!1,this.allSpecs,this.vCenter.name)},e.prototype.onFileSelected=function(e){var t=this,i=this.$q.defer();this.file=e.target.files[0],this.fileNameToDisplay=this.file.name,this.$element.find(".gos-spec-file-input").val(""),this.name="",this.description="";var r=this.importGosSpecService.validateFileMetadata(this.file);return r?i.reject(r):this.importGosSpecService.loadFile(this.file).then(function(e){var r=t.importGosSpecService.retrieveNameAndDescription(e);t.name=r.name,t.description=r.description,i.resolve()})["catch"](function(e){i.reject(e)}),i.promise},e.prototype.retrieveVcenterData=function(){var e=this;this.submitDisabled=!0,this.userSessionService.getAllServersInfo().then(function(t){e.vCentersData=t.serversInfo,e.vCentersData&&e.vCentersData.length>0&&(e.vCenter=e.vCentersData[0]),e.submitDisabled=!1})},e.prototype.submitForm=function(){var e=this,t=this.vCenter.content.customizationSpecManager;return this.submitDisabled=!0,this.importGosSpecService.validateForm(this.vCenter.serviceGuid,this.file,this.name,this.allSpecs,this.vCenter.name,t).then(function(t){return e.submitDisabled=!1,t.errors.length>0?(e.createAlerts(t.errors),e.$q.when(!1)):(e.onValidationComplete(t.result),e.$q.when(!0))})},e.prototype.createAlerts=function(e){var t=this;this.alerts=[],_.each(e,function(e){var i={type:t.vuiConstants.validationBanner.type.ERROR,text:e};t.alerts.push(i)})},e.prototype.onValidationComplete=function(e){this.importGosSpecService.parseValidationResponse(e,this.vCenter.content.customizationSpecManager,this.name,this.description)},e.$inject=["$q","$element","$timeout","i18nService","vuiConstants","userSessionService","gosSpecValidationService","importGosSpecService"],e}(),i=function(){function e(){this.bindings={onSubmit:"=",closeModal:"<",alerts:"=",allSpecs:"<",submitDisabled:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/import/import-gos-spec.component.html"}return e}();e.ImportGosSpecComponent=i,angular.module("com.vmware.vsphere.client.vm").component("importGosSpec",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.customizations.VmCustomizationImportSpec,i=com.vmware.vsphere.client.vm.customizations.VmCustomizationImportValidationSpec,r=function(){function e(e,t,i,r,n,o,a,s){this.i18nService=e,this.mutationService=t,this.clarityModalService=i,this.authorizationService=r,this.defaultUriSchemeUtil=n,this.gosSpecValidationService=o,this.logService=a,this.$q=s,this.IMPORT_GUEST_OS_SPEC_PRIVILEGES=["VirtualMachine.Provisioning.ModifyCustSpecs","VirtualMachine.Provisioning.ReadCustSpecs"],this.MAX_FILE_SIZE_BYTES=10485760,this.log=a("importGosSpecService")}return e.prototype.openImportModal=function(e){var t=this;this.deferredSpecImport=this.$q.defer();var i={title:this.i18nService.getString("VmUi","guestOsCustomization.import"),contentTemplate:"vm-ui/resources/vm/guest-os-customization/import/import-gos-spec.view.html",defaultButton:"submit",dialogData:{allCustomizationSpecs:e},onCancel:function(){t.reader&&t.reader.abort(),t.deferredSpecImport.reject()}};return this.clarityModalService.openOkCancelModal(i),this.deferredSpecImport.promise},e.prototype.validateForm=function(e,t,i,r,n,o){var a=[],s=this.gosSpecValidationService.validateName(i,!0,r,n);s&&a.push(s);var c=this.validateFileMetadata(t);c&&a.push(c);var l={result:null,errors:a};if(a.length>0)return this.$q.when(l);var d={privilegeCheck:this.checkVCenterPrivileges(e),fileCheck:this.validateFile(o)};return this.$q.all(d).then(function(e){var t=e.privilegeCheck;if(t&&a.push(t),e.fileCheck){var i=e.fileCheck.errors;if(i.length>0&&(l.errors=a.concat(i)),0===a.length)return e.fileCheck}return l})},e.prototype.loadFile=function(e){var t=this,i=this.$q.defer();return this.reader=new FileReader,this.reader.readAsText(e),this.reader.onload=function(){t.reader&&(t.xmlContent=t.reader.result,i.resolve(t.xmlContent))},this.reader.onerror=function(){var e=t.i18nService.getString("VmUi","importCustomizationSpec.errorImporting");i.reject(e)},i.promise},e.prototype.retrieveNameAndDescription=function(e){var t;try{t=jQuery.parseXML(e)}catch(i){this.log.log(i)}return{name:t?$(t).find("info name").text():"",description:t?$(t).find("info description").text():""}},e.prototype.validateFile=function(e){var t=this.$q.defer();if(this.xmlContent)this.onFileLoaded(e,t);else{var i=this.i18nService.getString("VmUi","importCustomizationSpec.errorImporting"),r={result:null,errors:[i]};t.resolve(r)}return t.promise},e.prototype.onFileLoaded=function(e,t){var r=this,n={result:null,errors:[]},o=this.xmlContent,a=new i;a.customizationSpecManager=e,a.customizationSpecText=o;var s=this.defaultUriSchemeUtil.getVsphereObjectId(e),c=this.mutationService.validate(s,a._type,a);c.then(function(e){if(e&&e.result&&!e.error)n.result=e.result;else{var i=r.i18nService.getString("VmUi","importCustomizationSpec.errorImporting");n.errors=[i]}t.resolve(n)})["catch"](function(){var e=r.i18nService.getString("VmUi","importCustomizationSpec.errorImporting");n.errors=[e],t.resolve(n)})},e.prototype.validateFileMetadata=function(e){return e?!e.size||e.size&&0===e.size?this.i18nService.getString("VmUi","guestOsCustomization.import.emptyFile"):e.size>this.MAX_FILE_SIZE_BYTES?this.i18nService.getString("VmUi","guestOsCustomization.import.maxSizeExceededError"):"":this.i18nService.getString("VmUi","guestOsCustomization.import.noFileSelected")},e.prototype.checkVCenterPrivileges=function(e){var t=this,i=this.defaultUriSchemeUtil.getRootFolder(e);return this.authorizationService.checkGrantedPrivileges(i,this.IMPORT_GUEST_OS_SPEC_PRIVILEGES).then(function(e){var i=_.some(e,function(e){return!e});return i?t.i18nService.getString("VmUi","customizationSpec.nameAndOsPage.noPrivileges"):""})},e.prototype.parseValidationResponse=function(e,i,r,n){var o=e.customizationSpecItem.info;o.name=r,o.description=n;var a=new t;a.customizationSpecManager=i,a.customizationSpecItem=e.customizationSpecItem;var s=this.i18nService.getString("VmUi","importRequest.Operation");e.validationSucceeded?this.addSpec(a,s,!1):this.confirmChangeKey(a,s)},e.prototype.confirmChangeKey=function(e,t){var i=this,r={title:this.i18nService.getString("VmUi","importCustomizationSpec.invalidKey.title"),message:this.i18nService.getString("VmUi","importCustomizationSpec.invalidKey.text"),saveButtonLabel:this.i18nService.getString("Common","alert.continue"),icon:null,clarityIcon:{shape:"warning","class":"is-warning",size:48},submit:function(){i.addSpec(e,t,!0)},onCancel:function(){i.deferredSpecImport.reject()},preserveNewlines:!0};this.clarityModalService.openConfirmationModal(r)},e.prototype.addSpec=function(e,t,i){var r=this;this.mutationService.add(e._type,e,t).then(function(e){var t={result:e,invokeEdit:i};r.deferredSpecImport.resolve(t)})["catch"](function(){r.deferredSpecImport.reject()})},e.$inject=["i18nService","mutationService","clarityModalService","authorizationService","defaultUriSchemeUtil","gosSpecValidationService","logService","$q"],e}();e.ImportGosSpecService=r,angular.module("com.vmware.vsphere.client.vm").service("importGosSpecService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.GosType,i=function(){function e(e,t){this._i18nService=e,this.gosSpecNetworkService=t}return e.prototype.isLinuxPrep=function(t){return!!t&&t.identity._type===e.IDENTITY_TYPE_LINUX_PREP},e.prototype.isSysPrep=function(t){return!!t&&t.identity._type===e.IDENTITY_TYPE_SYS_PREP},e.prototype.isSysPrepText=function(t){return!!t&&t.identity._type===e.IDENTITY_TYPE_SYS_PREP_TEXT;
},e.prototype.getGosType=function(i){switch(i._type){case e.IDENTITY_TYPE_LINUX_PREP:return t.LINUX;case e.IDENTITY_TYPE_SYS_PREP:return t.WINDOWS;case e.IDENTITY_TYPE_SYS_PREP_TEXT:return t.WINDOWS_CUSTOM_SYSPREP}return t.NONE},e.prototype.getNameGenerator=function(e){var t;if(this.isSysPrep(e)){var i=e.identity;t=i.userData.computerName}else{var r=e.identity;t=r.hostName}return t},e.prototype.getComputerName=function(t){if(!t||this.isSysPrepText(t))return"";var i=this.getNameGenerator(t),r="";return i._type===e.COMPUTER_NAME_TYPE_FIXED_NAME?r=i.name:i._type===e.COMPUTER_NAME_TYPE_PREFIX_NAME_GENERATOR?r=this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.suffixed",i.base):i._type===e.COMPUTER_NAME_TYPE_VIRTUAL_MACHINE_NAME_GENERATOR?r=this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.useVmName"):i._type===e.COMPUTER_NAME_TYPE_CUSTOM_NAME_GENERATOR?r=this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.useCustom"):i._type===e.COMPUTER_NAME_TYPE_UNKNOWN_NAME_GENERATOR&&(r=this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.askUser")),r},e.prototype.getTimeZone=function(e){if(!e)return"";if(this.isLinuxPrep(e)){var t=this.getTimeZoneArea(e),i=this.getTimeZoneLocation(e);return t&&i?this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.timezone",t,i):this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.emptyTimezone")}return this.isSysPrep(e)?this._i18nService.getString("CommonTimeZones","timeZoneWindows."+e.identity.guiUnattended.timeZone):""},e.prototype.getTimeZoneArea=function(t){if(!t||!this.isLinuxPrep(t))return"";var i=t.identity.timeZone;if(!i)return"";var r=i.split(e.AREA_LOCATION_SEPARATOR);return _.isEmpty(r)?"":this._i18nService.getString("CommonTimeZones","timeZoneLinux.Area."+r[0])},e.prototype.getTimeZoneLocation=function(t){if(!t||!this.isLinuxPrep(t))return"";var i=t.identity.timeZone;if(!i)return"";var r=i.split(e.AREA_LOCATION_SEPARATOR);if(r.length<2)return"";r.shift();var n=r.join(e.AREA_LOCATION_SEPARATOR);return this._i18nService.getString("CommonTimeZones","timeZoneLinux.Location."+n)},e.prototype.getHardwareClock=function(e){return e&&this.isLinuxPrep(e)?null===e.identity.hwClockUTC?this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.hwClockNotSet"):e.identity.hwClockUTC?this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.hwClockUtc"):this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.hwClockLocalTime"):""},e.prototype.isNetworkTypical=function(e){return this.gosSpecNetworkService.isNetworkTypeStandard(e)},e.prototype.getNetworkTypeString=function(e){return this.gosSpecNetworkService.isNetworkTypeStandard(e)?this._i18nService.getString("VmUi","customizationSpec.summaryPage.networkSettings.standard"):this._i18nService.getString("VmUi","customizationSpec.summaryPage.networkSettings.custom")},e.prototype.getNicIpSettings=function(e){var t=this,i=[];return e&&e.nicSettingMap&&_.each(e.nicSettingMap,function(e){var r=t.gosSpecNetworkService.getIPv4NicSettingSummary(e.adapter.ip),n=t.gosSpecNetworkService.getIPv6NicSettingSummary(e.adapter.ipV6Spec),o={IPv4:r,IPv6:n};i.push(o)}),i},e.prototype.getDnsServers=function(e){return e&&this.isLinuxPrep(e)&&e.globalIPSettings&&e.globalIPSettings.dnsServerList?e.globalIPSettings.dnsServerList:[]},e.prototype.getPrimaryDnsServer=function(e){var t=this.getDnsServers(e);return t.length>0?t[0]:""},e.prototype.getSecondaryDnsServer=function(e){var t=this.getDnsServers(e);return t.length>1?t[1]:""},e.prototype.getTertiaryDnsServer=function(e){var t=this.getDnsServers(e);return t.length>2?t[2]:""},e.prototype.getDnsAndDomain=function(e){return e&&e.globalIPSettings.dnsServerList&&!_.isEmpty(e.globalIPSettings.dnsServerList)?e.globalIPSettings.dnsServerList[0]:""},e.prototype.getDnsSuffixList=function(e){return e&&this.isLinuxPrep(e)&&e.globalIPSettings&&e.globalIPSettings.dnsSuffixList?e.globalIPSettings.dnsSuffixList:[]},e.prototype.getRegistrationInfo=function(e){if(!e||!this.isSysPrep(e))return"";var t=e.identity.userData;return this._i18nService.getString("VmUi","guestOsCustomization.regInfoFormat",t.fullName,t.orgName)},e.prototype.getWindowsLicenseKeyHeader=function(e){if(!e||!this.isSysPrep(e))return"";var t=e.identity.userData;return t.productId&&!_.isEmpty(t.productId)?this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.licenseKeyHeader",t.productId):this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.noLicenseKey")},e.prototype.getWindowsLicenseKey=function(e){if(!e||!this.isSysPrep(e))return"";var t=e.identity.userData;return t.productId&&!_.isEmpty(t.productId)?t.productId:this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.noLicenseKey")},e.prototype.isServerLicensingIncluded=function(e){if(!e||!this.isSysPrep(e))return!1;var t=e.identity.licenseFilePrintData;return!!t},e.prototype.isServerLicensingMpdePerServer=function(e){if(!e||!this.isSysPrep(e))return"";var t=e.identity.licenseFilePrintData;return t?"perServer"===t.autoMode?this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.licenseServerModePerServer",t.autoUsers):this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.licenseServerModePerSeat",t.autoUsers):""},e.prototype.getServerLicensingInfo=function(e){if(!e||!this.isSysPrep(e))return"";var t=e.identity.licenseFilePrintData;return t?"perServer"===t.autoMode?this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.licenseServerModePerServer",t.autoUsers):this._i18nService.getString("VmUi","customizationManager.customizationSpecViewData.licenseServerModePerSeat",t.autoUsers):""},e.prototype.isAutoLogon=function(e){if(!e||!this.isSysPrep(e))return!1;var t=e.identity.guiUnattended;return!!t&&t.autoLogon},e.prototype.getAutoLogonCount=function(e){if(!e||!this.isSysPrep(e))return NaN;var t=e.identity.guiUnattended;return t?t.autoLogonCount:NaN},e.prototype.getWorkgroup=function(e){if(!e||!this.isSysPrep(e))return"";var t=e.identity.identification;return t.joinWorkgroup},e.prototype.getDomain=function(e){if(!e)return"";if(this.isLinuxPrep(e))return e.identity.domain;if(this.isSysPrep(e)){var t=e.identity.identification;return t.joinDomain}return""},e.prototype.generateNewSID=function(e){if(!e||this.isLinuxPrep(e))return!1;var t=e.options;return t.changeSID},e.prototype.gosTypeToString=function(e){switch(e){case t.WINDOWS:case t.WINDOWS_CUSTOM_SYSPREP:return this._i18nService.getString("VmUi","customizationSpec.nameAndOsPage.specTypeWindows");case t.LINUX:return this._i18nService.getString("VmUi","customizationSpec.nameAndOsPage.specTypeLinux");default:return""}},e.prototype.getRunOnceCommands=function(e){if(!e||!this.isSysPrep(e))return[];var t=e.identity.guiRunOnce;return!t||_.isEmpty(t.commandList)?[]:t.commandList},e.prototype.getLoginType=function(e){return e.identity.guiUnattended.autoLogon?this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.loginAsAdmin"):this._i18nService.getString("VmUi","customizationManager.customizationSpecDetailsView.doNotloginAsAdmin")},e.prototype.getAutomaticLogonTimes=function(e){return e.identity.guiUnattended.autoLogon?e.identity.guiUnattended.autoLogonCount:null},e.prototype.getDomainUsername=function(e){return e.identity.identification?e.identity.identification.domainAdmin:""},e.prototype.getCommands=function(e){var t=e.identity;return t&&t.guiRunOnce&&t.guiRunOnce.commandList?t.guiRunOnce.commandList:[]},e.$inject=["i18nService","gosSpecNetworkService"],e.IDENTITY_TYPE_LINUX_PREP="com.vmware.vim.binding.vim.vm.customization.LinuxPrep",e.IDENTITY_TYPE_SYS_PREP="com.vmware.vim.binding.vim.vm.customization.Sysprep",e.IDENTITY_TYPE_SYS_PREP_TEXT="com.vmware.vim.binding.vim.vm.customization.SysprepText",e.ADAPTER_TYPE_DHCP="com.vmware.vim.binding.vim.vm.customization.DhcpIpGenerator",e.ADAPTER_TYPE_FIXED_IP="com.vmware.vim.binding.vim.vm.customization.FixedIp",e.ADAPTER_TYPE_UNKNOWUN_IP="com.vmware.vim.binding.vim.vm.customization.UnknownIpGenerator",e.ADAPTER_TYPE_CUSTOM_IP="com.vmware.vim.binding.vim.vm.customization.CustomIpGenerator",e.ADAPTER_TYPE_DHCP_V6="com.vmware.vim.binding.vim.vm.customization.DhcpIpV6Generator",e.ADAPTER_TYPE_FIXED_IP_V6="com.vmware.vim.binding.vim.vm.customization.FixedIpV6",e.ADAPTER_TYPE_UNKNOWUN_IP_V6="com.vmware.vim.binding.vim.vm.customization.UnknownIpV6Generator",e.ADAPTER_TYPE_CUSTOM_IP_V6="com.vmware.vim.binding.vim.vm.customization.CustomIpV6Generator",e.IPV6_ADDRESS_SPEC_TYPE="com.vmware.vim.binding.vim.vm.customization.IPSettings$IpV6AddressSpec",e.COMPUTER_NAME_TYPE_FIXED_NAME="com.vmware.vim.binding.vim.vm.customization.FixedName",e.COMPUTER_NAME_TYPE_PREFIX_NAME_GENERATOR="com.vmware.vim.binding.vim.vm.customization.PrefixNameGenerator",e.COMPUTER_NAME_TYPE_VIRTUAL_MACHINE_NAME_GENERATOR="com.vmware.vim.binding.vim.vm.customization.VirtualMachineNameGenerator",e.COMPUTER_NAME_TYPE_CUSTOM_NAME_GENERATOR="com.vmware.vim.binding.vim.vm.customization.CustomNameGenerator",e.COMPUTER_NAME_TYPE_UNKNOWN_NAME_GENERATOR="com.vmware.vim.binding.vim.vm.customization.UnknownNameGenerator",e.DEFAULT_NUMBER_OF_NICS=1,e.AREA_LOCATION_SEPARATOR="/",e}();e.GosCustomizationHelperService=i,angular.module("com.vmware.vsphere.client.vm").service("gosCustomizationHelperService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){var l=this;this.$scope=e,this.i18nService=t,this.userSessionService=i,this.vuiConstants=r,this.listService=n,this.columnRenderersRegistry=o,this.helperService=a,this.vcH5ConstantsService=s,this.timeFormatterService=c,this.invokeEditAction=!1,this.$scope.i18n=this.i18nService.getString,this.displayNoPermissions=!1,this.displayGrid=!1,this.isLoadingSpecInfos=!1,this.isLoadingSpecDetails=!1,this.loadingLabel=this.i18nService.getString("Common","loadingTitle"),this.gridOptions=this.createDataGridOptions(),this.selectedSpecInfo=void 0,this.selectedSpecDetails=void 0,this.selectedSpecXmlText=void 0,this.selectedSpecDetailsNicIpSettings=[],this.selectedSpecDetailsDnsSuffixList=[],this.updateActionBar(),e.$on(this.vcH5ConstantsService.DATA_REFRESH_INVOCATION_EVENT,function(){l.retrieveVCentersData()}),this.retrieveVCentersData(),this.splitterOptions={orientation:this.vuiConstants.splitter.orientation.VERTICAL,panes:[{min:"250px",size:"50%"},{min:"250px",size:"50%"}]},this.$scope.$watch(function(){return l.gridOptions.selectedItems},function(e,t){l.onSpecInfoChanged.call(l,e,t)}),this.preselectComparator=function(e){return l.preselectComparatorInternal(e)}}return e.prototype.getSelectedSpecName=function(){return this.selectedSpecInfo?this.selectedSpecInfo.name:""},e.prototype.getSelectedSpecType=function(){return this.selectedSpecInfo?this.selectedSpecInfo.type:""},e.prototype.getSelectedSpecDescription=function(){return this.selectedSpecInfo?this.selectedSpecInfo.description:""},e.prototype.isSelectedSpecDetailsLinuxPrep=function(){return this.helperService.isLinuxPrep(this.selectedSpecDetails)},e.prototype.isSelectedSpecDetailsSysPrep=function(){return this.helperService.isSysPrep(this.selectedSpecDetails)},e.prototype.isSelectedSpecDetailsSysPrepText=function(){return this.helperService.isSysPrepText(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsComputerName=function(){return this.helperService.getComputerName(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsTimeZone=function(){return this.helperService.getTimeZone(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsTimeZoneArea=function(){return this.helperService.getTimeZoneArea(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsTimeZoneLocation=function(){return this.helperService.getTimeZoneLocation(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsHardwareClock=function(){return this.helperService.getHardwareClock(this.selectedSpecDetails)},e.prototype.isSelectedSpecDetailsNetworkTypical=function(){return this.helperService.isNetworkTypical(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsNicIpSettings=function(){return this.selectedSpecDetailsNicIpSettings},e.prototype.hasOsOptions=function(){return!(!this.selectedSpecDetails||!this.selectedSpecDetails.options)},e.prototype.hasDnsServers=function(){return!_.isEmpty(this.helperService.getDnsServers(this.selectedSpecDetails))},e.prototype.getPrimaryDnsServer=function(){return this.helperService.getPrimaryDnsServer(this.selectedSpecDetails)},e.prototype.getSecondaryDnsServer=function(){return this.helperService.getSecondaryDnsServer(this.selectedSpecDetails)},e.prototype.getTertiaryDnsServer=function(){return this.helperService.getTertiaryDnsServer(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsDnsAndDomain=function(){return this.helperService.getDnsAndDomain(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsDnsSuffixList=function(){return this.selectedSpecDetailsDnsSuffixList},e.prototype.getSelectedSpecDetailsRegistrationInfo=function(){return this.helperService.getRegistrationInfo(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsWindowsLicenseKeyHeader=function(){return this.helperService.getWindowsLicenseKeyHeader(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsWindowsLicenseKey=function(){return this.helperService.getWindowsLicenseKey(this.selectedSpecDetails)},e.prototype.isSelectedSpecDetailsServerLicensingIncluded=function(){return this.helperService.isServerLicensingIncluded(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsServerLicensingInfo=function(){return this.helperService.getServerLicensingInfo(this.selectedSpecDetails)},e.prototype.isSelectedSpecDetailsAutoLogon=function(){return this.helperService.isAutoLogon(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsAutoLogons=function(){return this.helperService.getAutoLogonCount(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsWorkgroup=function(){return this.helperService.getWorkgroup(this.selectedSpecDetails)},e.prototype.getSelectedSpecDetailsDomain=function(){return this.helperService.getDomain(this.selectedSpecDetails)},e.prototype.isSelectedSpecDetailsGenerateSID=function(){return this.helperService.generateNewSID(this.selectedSpecDetails)},e.prototype.getRunOnceCommands=function(){return this.helperService.getRunOnceCommands(this.selectedSpecDetails)},e.prototype.onSpecInfoChanged=function(e,t){e===t||_.isEqual(e,t)||(!e||0===e.length||e.length>1?(this.selectedSpecInfo=void 0,this.selectedSpecDetails=void 0,this.selectedSpecXmlText=void 0,this.preselectItemName=void 0,this.selectedSpecDetailsNicIpSettings=[],this.selectedSpecDetailsDnsSuffixList=[],this.updateActionBar()):(this.selectedSpecInfo=e[0],this.preselectItemName=e[0].name,this.retrieveSpecDetails()))},e.prototype.getSysPrepText=function(){return this.selectedSpecDetails?this.selectedSpecDetails.identity.value:""},e.prototype.retrieveVCentersData=function(){var e=this;this.timeFormatterService.getUserTimeFormatPreference().then(function(t){e.savedDateTimeFormat=t}),this.userSessionService.getAllServersInfo().then(function(t){return t.serversInfo&&0===t.serversInfo.length?(e.updateActionBar(!0),void(e.displayGrid=!0)):void e.listService.filterVcs(t.serversInfo).then(function(t){e.vCentersData=t,e.vCentersData&&e.vCentersData.length>0?(e.retrieveSpecInfos(),e.displayGrid=!0):e.displayNoPermissions=!0})})},e.prototype.retrieveSpecInfos=function(){var e=this;return this.isLoadingSpecInfos=!0,this.listService.retrieveSpecInfos(this.vCentersData).then(function(t){e.gridOptions.data=t}).then(function(){e.isLoadingSpecInfos=!1,e.contextActionsDisabled&&(e.contextActionsDisabled=!1,e.updateActionBar())})},e.prototype.retrieveSpecDetails=function(){var e=this;this.selectedSpecInfo&&(this.isLoadingSpecDetails=!0,this.listService.retrieveSpecs(this.selectedSpecInfo.vcService,this.selectedSpecInfo.name).then(function(t){e.selectedSpecDetails=t.customizationSpec.spec,e.selectedSpecXmlText=t.specItemXMLText,e.selectedSpecDetailsNicIpSettings=e.helperService.getNicIpSettings(e.selectedSpecDetails),e.selectedSpecDetailsDnsSuffixList=e.helperService.getDnsSuffixList(e.selectedSpecDetails)}).then(function(){return e.isLoadingSpecDetails=!1,e.updateActionBar()}).then(function(){e.invokeEditAction&&(e.listService.invokeEdit(e.selectedSpecInfo,e.selectedSpecDetails,e.gridOptions.data,e.onActionInvoked.bind(e)),e.invokeEditAction=!1)}))},e.prototype.createDataGridOptions=function(){var e=this,t=this.columnRenderersRegistry.getColumnRenderer("vcenter-name");return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,searchable:!0,resizable:!0,reorderable:!1,selectedItems:[],columnDefs:[{field:"name",sortable:!0,searchable:!0,displayName:this.i18nService.getString("VmUi","customizationManager.customizationSpecList.nameColumnHeader")},{field:"type",sortable:!0,searchable:!0,displayName:this.i18nService.getString("VmUi","customizationManager.customizationSpecList.guestOsColumnHeader")},{field:"lastUpdateTime",sortable:!0,searchable:!1,displayName:this.i18nService.getString("VmUi","customizationManager.customizationSpecList.lastModifiedColumnHeader"),template:function(t){return e.timeFormatterService.timestampToText(parseInt(t.lastUpdateTime),e.savedDateTimeFormat)}},{field:"vCenterName",sortable:!0,searchable:!0,displayName:this.i18nService.getString("Common","vcColumnHeader"),template:function(e){return t(["vCenterName"],e,{navigatable:!1})}}],data:[],height:"100%",columnMenu:{sortable:!1,messages:{columns:this.i18nService.getString("CommonUi","listview.showColumnsMenu"),filter:this.i18nService.getString("CommonUi","listview.filterMenu")}}}},e.prototype.updateActionBar=function(e){return void 0===e&&(e=!1),this.listService.updateActionBar(this.gridOptions,this.selectedSpecInfo,this.selectedSpecDetails,this.selectedSpecXmlText,this.onActionInvoked.bind(this),this.beforeActionInvoked.bind(this),e)},e.prototype.preselectComparatorInternal=function(e){var t=!1;return this.preselectItemName&&(t=e.name===this.preselectItemName),t},e.prototype.onActionInvoked=function(e,t,i){if(e)switch(e){case"vsphere.core.vm.gos.customization.new":case"vsphere.core.vm.gos.customization.edit":this.onSpecCreated(t);break;case"vsphere.core.vm.gos.customization.duplicate":this.onSpecDuplicated(t,i);break;case"vsphere.core.vm.gos.customization.import":this.onSpecImported(t,i);break;case"vsphere.core.vm.gos.customization.delete":this.onSpecDeleted(t)}},e.prototype.beforeActionInvoked=function(){this.contextActionsDisabled=!0,this.updateActionBar(this.contextActionsDisabled)},e.prototype.onSpecCreated=function(e){var t=this;this.retrieveSpecInfos().then(function(){t.preselectItemName=e.result})},e.prototype.onSpecDuplicated=function(e,t){var i=this;this.retrieveSpecInfos().then(function(){i.preselectItemName=e.result,i.invokeEditAction=t})},e.prototype.onSpecImported=function(e,t){var i=this;this.retrieveSpecInfos().then(function(){i.preselectItemName=e.result.info.name,i.invokeEditAction=t})},e.prototype.onSpecDeleted=function(e){if(!e)return this.contextActionsDisabled=!1,void this.updateActionBar();var t=e.result;this.setPreselectNameOnDelete(t),this.retrieveSpecInfos()},e.prototype.setPreselectNameOnDelete=function(e){if(1===this.gridOptions.data.length&&this.gridOptions.data[0].name===e)return void(this.preselectItemName=void 0);for(var t=0;t<this.gridOptions.data.length;t++)if(this.gridOptions.data[t].name===e)return t+1<this.gridOptions.data.length?void(this.preselectItemName=this.gridOptions.data[t+1].name):void(this.preselectItemName=this.gridOptions.data[t-1].name)},e.$inject=["$scope","i18nService","userSessionService","vuiConstants","gosCustomizationListService","columnRenderersRegistry","gosCustomizationHelperService","vcH5ConstantsService","timeFormatterService"],e}(),i=function(){function e(){this.templateUrl="vm-ui/resources/vm/guest-os-customization/list/gos-customization-list.component.html",this.controller=t}return e}();e.GuestOsCustomizationListComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosCustomizationList",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=com.vmware.vim.binding.vim.CustomizationSpecInfo,i=com.vmware.vise.mvc.model.data.ParamSpec,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.CustomizationSpecInfoCustom=r;var n=function(){function e(){}return e.prototype.reset=function(){this.editActionEval=void 0,this.editPrivsGranted=!0,this.deletePrivsGranted=!0,this.exportPrivsGranted=!0,this.contextActionsDisabled=!1},e.prototype.isEditSpecActionAvailable=function(e){return this.editActionEval=e,e.available&&this.editPrivsGranted&&!!this.specInfo&&!!this.specDetails},e.prototype.isExportSpecActionAvailable=function(e){return e.available&&this.exportPrivsGranted&&!!this.specDetails&&!!this.specXmlText&&!_.isEmpty(this.specXmlText)},e.prototype.isDeleteSpecActionAvailable=function(e){return e.available&&this.deletePrivsGranted&&!!this.specInfo&&!!this.specDetails},e.prototype.isDuplicateSpecActionAvailable=function(e){return e.available&&!!this.specInfo&&!!this.specDetails},e}(),o=function(){function e(e,t,i,r,o,a,s,c){this.$q=e,this.dataService=t,this.defaultUriSchemeUtil=i,this.datagridActionBarService=r,this.authorizationService=o,this.vuiConstants=a,this.i18nService=s,this.actionsService=c,this.INFO_PROPERTY="info",this.CUSTOMIZATION_SPEC_PROPERTY="customizationSpec",this.XML_TEXT_PROPERTY="specItemXMLText",this.MODIFY_SPEC_PRIV="VirtualMachine.Provisioning.ModifyCustSpecs",this.READ_SPEC_PRIV="VirtualMachine.Provisioning.ReadCustSpecs",this.ACTIONS={NEW:{uid:"vsphere.core.vm.gos.customization.new",privs:[]},IMPORT:{uid:"vsphere.core.vm.gos.customization.import",privs:[]},EDIT:{uid:"vsphere.core.vm.gos.customization.edit",privs:[this.MODIFY_SPEC_PRIV,this.READ_SPEC_PRIV]},DUPLICATE:{uid:"vsphere.core.vm.gos.customization.duplicate",privs:[]},EXPORT:{uid:"vsphere.core.vm.gos.customization.export",privs:[this.READ_SPEC_PRIV]},DELETE:{uid:"vsphere.core.vm.gos.customization.delete",privs:[this.MODIFY_SPEC_PRIV]}},this.ALL_ACTIONS_PRIVS=_.union(this.ACTIONS.NEW.privs,this.ACTIONS.IMPORT.privs,this.ACTIONS.EDIT.privs,this.ACTIONS.DELETE.privs,this.ACTIONS.DUPLICATE.privs,this.ACTIONS.EXPORT.privs),this.VC_NO_ERROR="noError",this.actionsContext=new n}return e.prototype.retrieveSpecInfos=function(e){var t=this,i=[],r={};return _.each(e,function(e){if(e&&e.content&&e.content.customizationSpecManager){var n=t.defaultUriSchemeUtil.getVsphereObjectId(e.content.customizationSpecManager);i.push(n),r[n]=e}}),i.length>0?this.dataService.getPropertiesForObjects(i,[this.INFO_PROPERTY]).then(function(e){var i=[];return _.each(e,function(e,n){var o=e.info,a=r[n];o=t.formatSpecsData(o,a),i=_.union(i,o)}),_.sortBy(i,function(e){return e.name.toLowerCase()})}):this.$q.when([])},e.prototype.filterVcs=function(e){var t=this,i=[],r={},n=[];return _.each(e,function(e){if(e&&e.errorCode===t.VC_NO_ERROR&&e.serviceGuid){var n=t.defaultUriSchemeUtil.getRootFolder(e.serviceGuid);r[n]=t.authorizationService.checkGrantedPrivilege(n,t.READ_SPEC_PRIV),i.push(n)}}),this.$q.all(r).then(function(i){return _.each(e,function(e){if(e&&e.serviceGuid){var r=t.defaultUriSchemeUtil.getRootFolder(e.serviceGuid);i[r]&&n.push(e)}}),n})},e.prototype.formatSpecsData=function(e,t){return _.each(e,function(e){e.vcService=t,e.vCenterName=t.name}),e},e.prototype.retrieveSpecs=function(e,t){var r=e.content.customizationSpecManager,n=this.defaultUriSchemeUtil.getVsphereObjectId(r),o=new i;o.propertyName=this.CUSTOMIZATION_SPEC_PROPERTY,o.parameterType="java.lang.String",o.parameter=t;var a=new i;return a.propertyName=this.XML_TEXT_PROPERTY,a.parameterType="java.lang.String",a.parameter=t,this.dataService.getProperties(n,[this.CUSTOMIZATION_SPEC_PROPERTY,this.XML_TEXT_PROPERTY],{propertyParams:[o,a]})},e.prototype.invokeEdit=function(e,t,i,r){if(e&&t&&r){var n=this.actionsContext.editActionEval;if(n){var o=n.available&&this.actionsContext.editPrivsGranted;if(o){var a={gosCustomizationSpecInfo:e,gosCustomizationSpecDetails:t,gosCustomizationSpecs:i,onActionInvoked:r};this.actionsService.invokeAction(n,a)}}}},e.prototype.updateActionBar=function(e,t,i,r,n,o,a){var s=this;void 0===a&&(a=!1),this.actionsContext.specInfo=t,this.actionsContext.specDetails=i,this.actionsContext.specXmlText=r,this.actionsContext.reset(),this.actionsContext.contextActionsDisabled=a;var c;if(!this.actionsContext.contextActionsDisabled&&this.actionsContext.specInfo){var l=this.actionsContext.specInfo.vcService.serviceGuid,d=this.defaultUriSchemeUtil.getRootFolder(l);c=this.authorizationService.checkPrivileges(d,this.ALL_ACTIONS_PRIVS)}else c=this.$q.resolve([]);return c.then(function(a){a&&a.length>0&&_.each(a,function(e,t){var i=s.ALL_ACTIONS_PRIVS[t];_.contains(s.ACTIONS.EDIT.privs,i)&&(s.actionsContext.editPrivsGranted=s.actionsContext.editPrivsGranted&&e),_.contains(s.ACTIONS.EXPORT.privs,i)&&(s.actionsContext.exportPrivsGranted=s.actionsContext.exportPrivsGranted&&e),_.contains(s.ACTIONS.DELETE.privs,i)&&(s.actionsContext.deletePrivsGranted=s.actionsContext.deletePrivsGranted&&e)});var c;return c=[{actionId:s.ACTIONS.NEW.uid,isActionAvailable:function(e){return e.available},getActionInvocationContext:function(){return{gosCustomizationSpecs:e.data,onActionInvoked:n}}},{actionId:s.ACTIONS.IMPORT.uid,isActionAvailable:function(e){return e.available},getActionInvocationContext:function(){return{gosCustomizationSpecs:e.data,onActionInvoked:n}}},s.vuiConstants.actions.SEPARATOR,{actionId:s.ACTIONS.EDIT.uid,isActionAvailable:function(e){return!s.actionsContext.contextActionsDisabled&&s.actionsContext.isEditSpecActionAvailable(e)},getActionInvocationContext:function(){return{gosCustomizationSpecInfo:s.actionsContext.specInfo,gosCustomizationSpecDetails:s.actionsContext.specDetails,gosCustomizationSpecs:e.data,onActionInvoked:n}}},{actionId:s.ACTIONS.DUPLICATE.uid,isActionAvailable:function(e){return!s.actionsContext.contextActionsDisabled&&s.actionsContext.isDuplicateSpecActionAvailable(e)},getActionInvocationContext:function(){return{gosCustomizationSpecInfo:s.actionsContext.specInfo,gosCustomizationSpecs:e.data,onActionInvoked:n}}},{actionId:s.ACTIONS.EXPORT.uid,isActionAvailable:function(e){return!s.actionsContext.contextActionsDisabled&&s.actionsContext.isExportSpecActionAvailable(e)},getActionInvocationContext:function(){return{gosCustomizationSpecInfo:t,gosCustomizationSpecXmlText:r,gosCustomizationSpecDetails:i}}},{actionId:s.ACTIONS.DELETE.uid,isActionAvailable:function(e){return!s.actionsContext.contextActionsDisabled&&s.actionsContext.isDeleteSpecActionAvailable(e)},onInvokeAction:function(e){o&&o();var t=e.action.confirmationText;if(s.actionsContext.specInfo&&t){var i=s.actionsContext.specInfo.name;t=s.i18nService.interpolate(t,[i]),e.action.confirmationText=t}},getActionInvocationContext:function(){return{gosCustomizationSpecInfo:s.actionsContext.specInfo,onActionInvoked:n}}}],e.actionsOptions=e.actionsOptions||{},s.datagridActionBarService.updateActionBar(e,[],c)})},e.$inject=["$q","dataService","defaultUriSchemeUtil","datagridActionBarService","authorizationService","vuiConstants","i18nService","actionsService"],e}();e.GosCustomizationListService=o,angular.module("com.vmware.vsphere.client.vm").service("gosCustomizationListService",o)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18n=e,this.$q=t,this.clarityModalService=i,this.passwordMismatch=!1}return e.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this)},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.onPasswordChanged=function(){this.model.isPasswordChanged=!0,this.model.isPreviousPasswordBlank=!1},e.prototype.validatePassword=function(){this.passwordMismatch=this.model.password!==this.model.confirmedPassword},e.prototype.onCommit=function(){var e=this;if(this.model.password!==this.model.confirmedPassword){this.validatePassword();var t=this.i18n.getString("VmUi","customizationSpec.workgroupDomainPage.errorMessage.passwordsMismatch");return this.$q.resolve([t])}if(_.isEmpty(this.model.password)&&!this.model.isPreviousPasswordBlank){var i=this.$q.defer(),r={title:this.i18n.getString("VmUi","customizationSpec.adminPasswordPage.blankPwdWarningTitle"),message:this.i18n.getString("VmUi","customizationSpec.adminPasswordPage.blankPwdWarning"),submit:function(){i.resolve(!0)},onCancel:function(){i.resolve(!1)},preserveNewlines:!0,clarityIcon:{shape:"warning","class":"is-warning",size:48},saveButtonLabel:this.i18n.getString("Common","yes.label"),cancelButtonLabel:this.i18n.getString("Common","no.label")};return this.clarityModalService.openConfirmationModal(r),i.promise.then(function(t){return t?(e.model.isPreviousPasswordBlank=!0,e.$q.when([])):null})}return this.$q.resolve([])},e.$inject=["i18nService","$q","clarityModalService"],e}();e.GosAdministratorPasswordPageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/administrator-password/gos-administrator-password-page.component.html",this.bindings={model:"<"}}return e}();e.GosAdministratorPasswordPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosAdministratorPasswordPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosAdministratorPasswordPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t}return e.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this)},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.onCommit=function(){return this.$q.resolve([])},e.$inject=["i18nService","$q"],e}();e.GosCommandsPageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/commands/gos-commands-page.component.html",this.bindings={model:"<"}}return e}();e.GosCommandsPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosCommandsPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosCommandsPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.value=e}return e.ENTER_NAME_VALUE="enterName",e.USE_VM_NAME_VALUE="useVmName",e.DEPLOY_WIZARD_VALUE="deployWizard",e.GENERATE_NAME_VALUE="generateName",e.ENTER_NAME=new e(e.ENTER_NAME_VALUE),e.USE_VM_NAME=new e(e.USE_VM_NAME_VALUE),e.DEPLOY_WIZARD=new e(e.DEPLOY_WIZARD_VALUE),e.GENERATE_NAME=new e(e.GENERATE_NAME_VALUE),e}();e.ComputerNameOption=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.GosType,i=function(){function i(t,i,r,n,o){this.$q=t,this.defaultUriSchemeUtil=i,this.dataService=r,this.computerNameValidationService=n,this.i18nService=o,this.nameOption=e.ComputerNameOption,this.isNameIpGeneratorDefined=!1}return i.prototype.i18n=function(e){
for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService.getString("VmUi",e,t)},i.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this),this.invalidNameMessage="",this.invalidDomainMessage="";var i;if(t.WINDOWS===this.model.type)i=e.GosComputerNameValidationService.MAX_CHARS_WIN;else{if(t.LINUX!==this.model.type)throw new Error("Invalid Guest OS selected.");i=e.GosComputerNameValidationService.MAX_CHARS_LIN}this.useVmNameSignPostMessage=this.i18n("customizationSpec.computerNamePage.useVmName.subscription",i),this.useVmNameSubscriptionParams={title:this.i18nService.getString("Common","help"),message:this.useVmNameSignPostMessage},this.enterNameIncludeUniqueNumber=this.i18n("customizationSpec.computerNamePage.enterName.includeUniqueNumber"),this.enterNameIncludeUniqueNumberSignPostMessage=this.i18n("customizationSpec.computerNamePage.enterName.includeUniqueNumber.subscription",i),this.enterNameIncludeUniqueNumberSubscriptionParams={title:this.i18nService.getString("Common","help"),message:this.enterNameIncludeUniqueNumberSignPostMessage},this.getCustomNameAvailabilityIfNeeded()},i.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},i.prototype.onCommit=function(){var e=[];return e=e.concat(this.validateComputerName()),e=e.concat(this.validateDomain()),this.onNameChanged(),this.onDomainChanged(),this.$q.resolve(e)},i.prototype.isLinux=function(){return t.LINUX===this.model.type},i.prototype.validateComputerName=function(){if(e.ComputerNameOption.ENTER_NAME!==this.model.setNameOption)return[];var i=this.model.type===t.WINDOWS?e.GosComputerNameValidationService.MAX_CHARS_WIN:e.GosComputerNameValidationService.MAX_CHARS_LIN;return this.computerNameValidationService.validateComputerName(i,this.model.computerName)},i.prototype.onNameChanged=function(){this.invalidNameMessage=this.validateComputerName()[0]},i.prototype.validateDomain=function(){return this.isLinux()?this.computerNameValidationService.validateDomainName(this.model.domainName):[]},i.prototype.onDomainChanged=function(){this.invalidDomainMessage=this.validateDomain()[0]},i.prototype.getCustomNameAvailabilityIfNeeded=function(){var e=this;if(void 0!==this.model.isNameIpGeneratorDefined)return void(this.isNameIpGeneratorDefined=this.model.isNameIpGeneratorDefined);var t=this.defaultUriSchemeUtil.getRootFolder(this.model.vcServiceGuid);this.dataService.getProperties(t,["isNameIpGeneratorDefined"]).then(function(t){t&&(e.isNameIpGeneratorDefined=t.isNameIpGeneratorDefined,e.model.isNameIpGeneratorDefined=t.isNameIpGeneratorDefined)})},i.$inject=["$q","defaultUriSchemeUtil","dataService","gosComputerNameValidationService","i18nService"],i.FQDN_LABEL_MAX_LENGTH=63,i.FQDN_MAX_LENGTH=255,i}();e.GosComputerNamePageController=i;var r=function(){function e(){this.controller=i,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/computer-name/gos-computer-name-page.component.html",this.bindings={model:"<"}}return e}();e.GosComputerNamePageComponent=r,angular.module("com.vmware.vsphere.client.vm").component("gosComputerNamePage",new r)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosComputerNamePageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(t,i,r,n){this.$q=t,this.i18n=i,this.$element=r,this.vcService=n,this.IMPORT_FILE=e.CustomSysprepFileOption.IMPORT_FILE,this.CREATE_FILE=e.CustomSysprepFileOption.CREATE_FILE}return t.prototype.$onInit=function(){var e=this,t=this.$element.find(".select-sysprep-file-input");t.on("change",function(t){e.onFileChosen(t)}),this.model.onPageCommit=this.onCommit.bind(this);var i="customizationSpec.customSysprepFilePage.pageDirections.postVista",r=".xml";this.vcService.is67VcOrLaterByGuid(this.model.vcServerGuid).then(function(e){e||(i="customizationSpec.customSysprepFilePage.pageDirections.preVista",r=".inf, .xml")}).then(function(){e.sysprepAnswerFileDesc=e.i18n.getString("VmUi",i),e.sysprepAnswerFileFilter=r})},t.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},t.prototype.onCommit=function(){if(this.model.fileOption===e.CustomSysprepFileOption.IMPORT_FILE){if(_.isEmpty(this.model.sysprepImportFileName)){var t=this.i18n.getString("VmUi","customizationSpec.customSysprepFilePage.selectSysprepFile");return this.$q.resolve([t])}if(_.isEmpty(this.model.sysprepImportFileContent.trim())){var t=this.i18n.getString("VmUi","customizationSpec.customSysprepFilePage.emptySysprepFile");return this.$q.resolve([t])}}else if(_.isEmpty(this.model.sysprepContent.trim())){var t=this.i18n.getString("VmUi","customizationSpec.customSysprepFilePage.insertSysprepText");return this.$q.resolve([t])}return this.$q.resolve([])},t.prototype.onBrowseFileClicked=function(){var e=this.$element.find(".select-sysprep-file-input");e.click()},t.prototype.onFileChosen=function(e){var t=this;e.target.files&&e.target.files.length>0&&(this.model.sysprepImportFileName=e.target.files[0].name,this.reader=new FileReader,this.reader.readAsText(e.target.files[0]),this.reader.onload=function(){t.model.sysprepContent=t.reader.result.trim(),t.model.sysprepImportFileContent=t.model.sysprepContent})},t.$inject=["$q","i18nService","$element","vcService"],t}();e.GosCustomSysprepFilePageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/custom-sysprep-file/gos-custom-sysprep-file-page.component.html",this.bindings={model:"<"}}return e}();e.GosCustomSysprepFilePageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosCustomSysprepFilePage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosCustomSysprepFilePageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.$q=e,this.ipParser=t,this.i18n=i,this.PRIMARY_DNS="primary",this.SECONDARY_DNS="secondary",this.TERTIARY_DNS="tertiary",this.primaryInvalid=!1,this.secondaryInvalid=!1,this.tertiaryInvalid=!1}return e.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this)},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.onCommit=function(){var e=[];return this.isDnsValid(this.model.primaryDns)&&this.isDnsValid(this.model.secondaryDns)&&this.isDnsValid(this.model.tertiaryDns)||(this.validateDNS(this.PRIMARY_DNS),this.validateDNS(this.SECONDARY_DNS),this.validateDNS(this.TERTIARY_DNS),e.push(this.i18n.getString("VmUi","guestOsCustomization.dnsSettingsPage.invalidIpAddress"))),this.$q.resolve(e)},e.prototype.validateDNS=function(e){switch(e){case this.PRIMARY_DNS:this.primaryInvalid=!this.isDnsValid(this.model.primaryDns);break;case this.SECONDARY_DNS:this.secondaryInvalid=!this.isDnsValid(this.model.secondaryDns);break;case this.TERTIARY_DNS:this.tertiaryInvalid=!this.isDnsValid(this.model.tertiaryDns)}},e.prototype.isDnsValid=function(e){return!(e&&!_.isEmpty(e)&&!this.ipParser.isIpv4AddressValid(e)&&!this.ipParser.isIpv6AddressValid(e))},e.$inject=["$q","ipParserService","i18nService"],e}();e.GosDnsSettingsPageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/dns-settings/gos-dns-settings-page.component.html",this.bindings={model:"<"}}return e}();e.GosDnsSettingsPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosDnsSettingsPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosDnsSettingsPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.LinuxPrep,i=com.vmware.vim.binding.vim.vm.customization.SysprepText,r=com.vmware.vim.binding.vim.vm.customization.Sysprep,n=function(){function e(e,t,i){this.$q=e,this.i18nService=t,this.helperService=i,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this),this.nics=this.getNics()},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.getSpecTypeString=function(e){return this.helperService.gosTypeToString(e)},e.prototype.onCommit=function(){return this.$q.resolve([])},e.prototype.isLinuxPrep=function(){return this.model.specDetails.identity instanceof t},e.prototype.isSysPrep=function(){return this.model.specDetails.identity instanceof r},e.prototype.isSysPrepText=function(){return this.model.specDetails.identity instanceof i},e.prototype.getComputerName=function(){return this.helperService.getComputerName(this.model.specDetails)},e.prototype.getDomainName=function(){return this.helperService.getDomain(this.model.specDetails)},e.prototype.getProductKey=function(){return this.helperService.getWindowsLicenseKey(this.model.specDetails)},e.prototype.isServerLicensingIncluded=function(){return this.helperService.isServerLicensingIncluded(this.model.specDetails)},e.prototype.getServerLicensingInfo=function(){return this.helperService.getServerLicensingInfo(this.model.specDetails)},e.prototype.getTimeZone=function(){return this.helperService.getTimeZone(this.model.specDetails)},e.prototype.getHardwareClock=function(){return this.helperService.getHardwareClock(this.model.specDetails)},e.prototype.getRegInfoName=function(){return this.helperService.getRegistrationInfo(this.model.specDetails)},e.prototype.getPrimaryDns=function(){return this.helperService.getPrimaryDnsServer(this.model.specDetails)},e.prototype.getSecondaryDns=function(){return this.helperService.getSecondaryDnsServer(this.model.specDetails)},e.prototype.getTertiaryDns=function(){return this.helperService.getTertiaryDnsServer(this.model.specDetails)},e.prototype.getDnsSuffixList=function(){return this.helperService.getDnsSuffixList(this.model.specDetails)},e.prototype.getNetworkType=function(){return this.helperService.getNetworkTypeString(this.model.specDetails)},e.prototype.getLogInType=function(){return this.helperService.getLoginType(this.model.specDetails)},e.prototype.getAutomaticLogonTimes=function(){return this.helperService.getAutomaticLogonTimes(this.model.specDetails)},e.prototype.getWorkgroup=function(){return this.helperService.getWorkgroup(this.model.specDetails)},e.prototype.getDomain=function(){return this.helperService.getDomain(this.model.specDetails)},e.prototype.getDomainUsername=function(){return this.helperService.getDomainUsername(this.model.specDetails)},e.prototype.getGenerateNewSIDText=function(){var e=this.helperService.generateNewSID(this.model.specDetails);return e?this.i18n("VmUi","customizationManager.customizationSpecDetailsView.generateSID"):this.i18n("VmUi","customizationManager.customizationSpecDetailsView.doNotGenerateSID")},e.prototype.getNics=function(){return this.helperService.isNetworkTypical(this.model.specDetails)?[]:this.helperService.getNicIpSettings(this.model.specDetails)},e.prototype.getCommands=function(){return this.helperService.getCommands(this.model.specDetails)},e.$inject=["$q","i18nService","gosCustomizationHelperService"],e}();e.GosFinishPageController=n;var o=function(){function e(){this.controller=n,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/finish/gos-finish-page.component.html",this.bindings={model:"<"}}return e}();e.GosFinishPageComponent=o,angular.module("com.vmware.vsphere.client.vm").component("gosFinishPage",new o)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=com.vmware.vim.binding.vim.CustomizationSpecItem,r=com.vmware.vim.binding.vim.CustomizationSpecInfo,n=com.vmware.vim.binding.vim.vm.customization.Sysprep,o=function(t){function o(){t.apply(this,arguments)}return __extends(o,t),o.prototype.buildSpec=function(){var t=new r;switch(t.name=this.specName,t.description=this.description,this.gosType){case e.GosType.WINDOWS:case e.GosType.WINDOWS_CUSTOM_SYSPREP:t.type="Windows";break;case e.GosType.LINUX:t.type="Linux";break;default:t.type=""}var n=new i;return n.spec=this.specDetails,n.info=t,n},o.prototype.addWindowsParams=function(t){this.gosType===e.GosType.WINDOWS&&(t.config.spec.identity instanceof n&&!_.isEmpty(t.config.spec.identity.guiUnattended.password)&&(t.encryptAdminPassword=this.encryptAdminPassword),t.config.spec.identity instanceof n&&!_.isEmpty(t.config.spec.identity.identification.domainAdminPassword)&&(t.encryptDomainPassword=this.encryptDomainPassword))},o}(t);e.GosFinishPageModel=o}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.$q=t,this.vuiConstants=i}return t.prototype.createNameAndOsPage=function(t,i,r,n){void 0===n&&(n=[]),t.gosNameAndOsPageModel||(t.gosNameAndOsPageModel=new e.GosNameAndOsPageModel),t.gosNameAndOsPageModel.allSpecs=t.allSpecs;var o={title:this.i18nService.getString("VmUi","guestOsCustomization.nameAndTargetOsPage.title"),description:this.i18nService.getString("VmUi","customizationSpec.nameAndOsPage.description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/name-and-os/gos-name-and-os-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,decisionOptions:{flowIds:n,selectedFlowId:r},onCommit:function(){return i(t.gosNameAndOsPageModel)}};return o},t.prototype.getWizardFlows=function(t,i){var r=this.createAllPages(t,i),n=[{id:e.GosType.WINDOWS,pages:this.getPagesByType(r,e.GosType.WINDOWS)},{id:e.GosType.WINDOWS_CUSTOM_SYSPREP,pages:this.getPagesByType(r,e.GosType.WINDOWS_CUSTOM_SYSPREP)},{id:e.GosType.LINUX,pages:this.getPagesByType(r,e.GosType.LINUX)}];return n},t.prototype.getDialogPages=function(e,t,i){var r=this,n=this.createFlowPages(t,e,i),o=this.createNameAndOsPage(e,i,t),a=n,s=[];return s.push(o),s=s.concat(a),s.forEach(function(e){e.state=r.vuiConstants.wizard.pageState.COMPLETED}),s},t.prototype.createFlowPages=function(t,i,r){if(e.GosType.WINDOWS===t)return[this.createRegistrationInformationPage(i,r),this.createComputerNamePage(i,r),this.createWindowsLicensePage(i,r),this.createAdministratorPasswordPage(i,r),this.createTimeZonePage(i,r),this.createCommandsPage(i,r),this.createNetworkPage(i,r),this.createWorkgroupDomainPage(i,r),this.createFinishPage(i)];if(e.GosType.WINDOWS_CUSTOM_SYSPREP===t)return[this.createCustomSysprepFilePage(i,r),this.createNetworkPage(i,r),this.createFinishPage(i)];if(e.GosType.LINUX===t)return[this.createComputerNamePage(i,r),this.createTimeZonePage(i,r),this.createNetworkPage(i,r),this.createDnsSettingsPage(i,r),this.createFinishPage(i)];throw new Error("Unsupported flow")},t.prototype.createAllPages=function(e,t){return{customSysprepFilePage:this.createCustomSysprepFilePage(e,t),registrationInformationPage:this.createRegistrationInformationPage(e,t),computerNamePage:this.createComputerNamePage(e,t),windowsLicensePage:this.createWindowsLicensePage(e,t),administratorPasswordPage:this.createAdministratorPasswordPage(e,t),timeZonePage:this.createTimeZonePage(e,t),commandsPage:this.createCommandsPage(e,t),networkPage:this.createNetworkPage(e,t),workgroupDomainPage:this.createWorkgroupDomainPage(e,t),dnsSettingsPage:this.createDnsSettingsPage(e,t),finishPage:this.createFinishPage(e)}},t.prototype.getPagesByType=function(t,i){if(e.GosType.WINDOWS===i)return[t.registrationInformationPage,t.computerNamePage,t.windowsLicensePage,t.administratorPasswordPage,t.timeZonePage,t.commandsPage,t.networkPage,t.workgroupDomainPage,t.finishPage];if(e.GosType.WINDOWS_CUSTOM_SYSPREP===i)return[t.customSysprepFilePage,t.networkPage,t.finishPage];if(e.GosType.LINUX===i)return[t.computerNamePage,t.timeZonePage,t.networkPage,t.dnsSettingsPage,t.finishPage];throw new Error("Unsupported flow")},t.prototype.createComputerNamePage=function(t,i){t.computerNamePageModel||(t.computerNamePageModel=new e.GosComputerNamePageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.computerNamePage.title"),description:this.i18nService.getString("VmUi","customizationSpec.computerNamePage.description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/computer-name/gos-computer-name-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.computerNamePageModel)}};return r},t.prototype.createWindowsLicensePage=function(t,i){t.windowsLicensePageModel||(t.windowsLicensePageModel=new e.GosWindowsLicensePageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.windowsLicensePage.title"),description:this.i18nService.getString("VmUi","customizationSpec.windowsLicensePage.pageInfoNew"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/windows-license/gos-windows-license-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.windowsLicensePageModel)}};return r},t.prototype.createDnsSettingsPage=function(t,i){t.dnsSettingsPageModel||(t.dnsSettingsPageModel=new e.GosDnsSettingsPageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.dnsSettingsPage.title"),description:this.i18nService.getString("VmUi","customizationSpec.dnsDomainSettingsPage.description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/dns-settings/gos-dns-settings-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.dnsSettingsPageModel)}};return r},t.prototype.createCustomSysprepFilePage=function(t,i){t.customSysprepFilePageModel||(t.customSysprepFilePageModel=new e.GosCustomSysprepFilePageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.customSysPrepPagePage.title"),description:this.i18nService.getString("VmUi","customizationSpec.customSysprepFilePage.pageInfoNew"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/custom-sysprep-file/gos-custom-sysprep-file-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.customSysprepFilePageModel)}};return r},t.prototype.createRegistrationInformationPage=function(t,i){t.registrationInformationPageModel||(t.registrationInformationPageModel=new e.GosRegistrationInformationPageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.registrationInformationPage.title"),description:this.i18nService.getString("VmUi","guestOsCustomization.new.registrationInformationPage.Description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/registration-information/gos-registration-information-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.registrationInformationPageModel)}};return r},t.prototype.createTimeZonePage=function(t,i){t.timeZonePageModel||(t.timeZonePageModel=new e.GosTimeZonePageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.timeZonePage.title"),description:this.i18nService.getString("VmUi","customizationSpec.timeZonePage.description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/time-zone/gos-time-zone-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.timeZonePageModel)}};return r},t.prototype.createNetworkPage=function(t,i){t.networkPageModel||(t.networkPageModel=new e.GosNetworkPageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.networkPage.title"),description:this.i18nService.getString("VmUi","customizationSpec.networkPage.description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/network/gos-network-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.networkPageModel)}};return r},t.prototype.createFinishPage=function(t){t.finishPageModel||(t.finishPageModel=new e.GosFinishPageModel);var i={title:this.i18nService.getString("CommonUi","SummaryPage.title"),description:this.i18nService.getString("CommonUi","SummaryPage.description"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/finish/gos-finish-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return!0}};return i},t.prototype.createAdministratorPasswordPage=function(t,i){t.administratorPasswordPageModel||(t.administratorPasswordPageModel=new e.GosAdministratorPasswordPageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.administratorPasswordPage.title"),description:this.i18nService.getString("VmUi","customizationSpec.adminPasswordPage.pageInfoNew"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/administrator-password/gos-administrator-password-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.administratorPasswordPageModel)}};return r},t.prototype.createCommandsPage=function(t,i){t.commandsPageModel||(t.commandsPageModel=new e.GosCommandsPageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.runOnceCommandsPage.title"),description:this.i18nService.getString("VmUi","customizationSpec.runOncePage.pageInfoNew"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/commands/gos-commands-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.commandsPageModel)}};return r},t.prototype.createWorkgroupDomainPage=function(t,i){t.workgroupDomainPageModel||(t.workgroupDomainPageModel=new e.GosWorkgroupDomainPageModel);var r={title:this.i18nService.getString("VmUi","guestOsCustomization.workGroupOrDomainPage.title"),description:this.i18nService.getString("VmUi","customizationSpec.workgroupDomainPage.pageInfoNew"),contentUrl:"vm-ui/resources/vm/guest-os-customization/pages/workgroup-domain/gos-workgroup-domain-page.html",state:this.vuiConstants.wizard.pageState.INCOMPLETE,onCommit:function(){return i(t.workgroupDomainPageModel)}};return r},t.$inject=["i18nService","$q","vuiConstants"],t}();e.GosSpecCreatePagesService=t,angular.module("com.vmware.vsphere.client.vm").service("gosSpecCreatePagesService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.GosType,i=function(){function e(e,t,i,r,n){this.$q=e,this.i18nService=t,this.userSessionService=i,this.gosSpecValidationService=r,this.gosNameAndOsValidationService=n,this.i18n=t.getString}return e.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this),this.model.isEditMode&&!this.model.originalSpecName&&(this.model.originalSpecName=this.model.specName),this.specTypeOptions=this.initializeSpecTypeOptions(),this.selectedSpecType=this.getInitialSpecTypeOption(),this.retrieveVcOptions(),this.isSysprepTextType=t.WINDOWS_CUSTOM_SYSPREP.value===this.model.gosType.value},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.onCommit=function(){var e=this.gosSpecValidationService.validateName(this.model.specName,!0,this.onlyOtherSpecs(),this.selectedVc?this.selectedVc.name:"");return this.model.isEditMode?this.$q.resolve(e?[e]:[]):this.$q.all([this.$q.resolve(e),this.gosNameAndOsValidationService.checkCreateNewGosSpecPrivileges(this.selectedVc)]).then(function(e){return _.without(_.flatten(e),"")})},e.prototype.onSpecTypeChange=function(){var e;e=this.isLinuxprepType()?t.LINUX:this.isSysprepTextType?t.WINDOWS_CUSTOM_SYSPREP:t.WINDOWS,this.model.gosType=e},e.prototype.isLinuxprepType=function(){return!!this.selectedSpecType&&t.LINUX.value===this.selectedSpecType.type.value},e.prototype.onVcChange=function(){this.model.vc=this.selectedVc},e.prototype.onSysprepTypeChange=function(){var e=this.isSysprepTextType?t.WINDOWS_CUSTOM_SYSPREP:t.WINDOWS;this.model.gosType=e},e.prototype.isSysprepTextDisabled=function(){return this.model.isEditMode||this.isLinuxprepType()},e.prototype.validateSpecName=function(){this.invalidMessage=this.gosSpecValidationService.validateName(this.model.specName,!1,this.onlyOtherSpecs(),this.selectedVc?this.selectedVc.name:"")},e.prototype.onlyOtherSpecs=function(){var e=this;if(this.model.allSpecs)return this.model.allSpecs.filter(function(t){return t.name!==e.model.originalSpecName})},e.prototype.initializeSpecTypeOptions=function(){return[{label:this.i18n("VmUi","customizationSpec.nameAndOsPage.specTypeWindows"),type:t.WINDOWS},{label:this.i18n("VmUi","customizationSpec.nameAndOsPage.specTypeLinux"),type:t.LINUX}]},e.prototype.retrieveVcOptions=function(){var e=this;this.userSessionService.getAllServersInfo().then(function(t){e.vcOptions=t.serversInfo,e.vcOptions&&e.vcOptions.length>0&&(e.selectedVc=e.choosePreselectedVc(e.vcOptions,e.model),e.model.vc=e.selectedVc)})},e.prototype.getInitialSpecTypeOption=function(){var e=this;return _.find(this.specTypeOptions,function(i){switch(i.type){case t.LINUX:return e.model.gosType===t.LINUX;case t.WINDOWS:return e.model.gosType===t.WINDOWS||e.model.gosType===t.WINDOWS_CUSTOM_SYSPREP;default:return!1}})},e.prototype.choosePreselectedVc=function(e,t){if(e&&!(e.length<1))return t.vc?t.vc:e[0]},e.$inject=["$q","i18nService","userSessionService","gosSpecValidationService","gosNameAndOsValidationService"],e}();e.GosNameAndOsPageController=i;var r=function(){function e(){this.controller=i,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/name-and-os/gos-name-and-os-page.component.html",this.bindings={model:"<"}}return e}();e.GosNameAndOsPageComponent=r,angular.module("com.vmware.vsphere.client.vm").component("gosNameAndOsPage",new r)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments),this.isEditMode=!1}return __extends(t,e),Object.defineProperty(t.prototype,"gosType",{get:function(){return this.type},set:function(e){this.type=e,this.gosTypeChanged&&this.gosTypeChanged(this.type)},enumerable:!0,configurable:!0}),t}(t);e.GosNameAndOsPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.$q=e,this.i18nService=t,this.authorizationService=i,this.defaultUriSchemeUtil=r,this.mutationService=n}return e.prototype.checkCreateNewGosSpecPrivileges=function(e){var t=this;if(!e||!e.serviceGuid)return this.$q.resolve(["vcInfo invalid"]);var i=this.defaultUriSchemeUtil.getRootFolder(e.serviceGuid);return this.authorizationService.checkPrivileges(i,["VirtualMachine.Provisioning.ModifyCustSpecs","VirtualMachine.Provisioning.ReadCustSpecs"]).then(function(e){var i=e[0],r=e[1];return i&&r?t.$q.resolve([]):t.$q.resolve([t.i18nService.getString("VmUi","customizationSpec.nameAndOsPage.noPrivileges")])})},e.$inject=["$q","i18nService","authorizationService","defaultUriSchemeUtil","mutationService"],e}();e.GosNameAndOsValidationService=t,angular.module("com.vmware.vsphere.client.vm").service("gosNameAndOsValidationService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.DhcpIpV6Generator,i=function(){function i(i,r,n){var o=this;this.i18nService=i,this.gosSpecNetworkService=r,this.ipParser=n,this.OPTION_TYPE_DHCP="useDhcp",this.OPTION_DNS_MANUAL="dnsManual",this.IPV4_TYPE_DHCP=e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP,this.PREFERRED_DNS="preferredDns",this.ALTERNATE_DNS="alternateDns",this.TITLE_LOCALE="customizationSpec.networkPage.properties.dns.pageTitle",this.validationErrors={},this.populateData=function(){var e=o.adapterMapping.adapter;o.isDhcpEnabled=e.ip._type===o.IPV4_TYPE_DHCP,e.ipV6Spec&&e.ipV6Spec.ip&&e.ipV6Spec.ip.length&&e.ipV6Spec.ip[0]instanceof t&&(o.isDhcpEnabled=!0);var i=e.dnsServerList;i&&i.length?(o.dnsType=o.OPTION_DNS_MANUAL,o.preferredDns=i[0],i.length>1&&(o.alternateDns=i[1])):o.isDhcpEnabled?o.dnsType=o.OPTION_TYPE_DHCP:o.dnsType=o.OPTION_DNS_MANUAL},this.i18n=this.i18nService.getString}return i.prototype.$onInit=function(){var e=this;this.adapterMapping=this.adapterWrapper.adapterMapping,this.populateData(),this.updateDnsTab=function(){e.updateData(),e.populateData()},this.editDns=function(){e.updateData()}},i.prototype.updateData=function(){var e=[];this.dnsType===this.OPTION_DNS_MANUAL&&(this.preferredDns&&e.push(this.getNormalizedDnsAddress(this.preferredDns)),this.alternateDns&&e.push(this.getNormalizedDnsAddress(this.alternateDns))),this.adapterMapping.adapter.dnsServerList=e},i.prototype.getNormalizedDnsAddress=function(e){var t=this.ipParser.isIpv4AddressValid(e);if(!t)return e;var i=ipaddr.parse(e);return i.toString()},i.prototype.dnsTypeChanged=function(){this.validationErrors={},this.dnsType===this.OPTION_DNS_MANUAL?(this.validateDns(this.PREFERRED_DNS),this.validateDns(this.ALTERNATE_DNS)):this.setValidationErrors(!0)},i.prototype.setValidationErrors=function(e){var t=this;if(e||_.contains(this.submitErrors,this.TITLE_LOCALE)){if(e){var i=_.findIndex(this.submitErrors,function(e){return e===t.TITLE_LOCALE});if(i<0)return;this.submitErrors.splice(i,1)}}else this.submitErrors.push(this.TITLE_LOCALE)},i.prototype.validateDns=function(e){var t=e===this.PREFERRED_DNS?this.preferredDns:this.alternateDns,i=!t||this.ipParser.isAddressValid(t);i?this.validationErrors[e]=null:this.validationErrors[e]=this.i18n("VmUi","customizationSpec.networkPage.properties.dns.error.address"),this.validationErrors.preferredDns||this.validationErrors.alternateDns?this.setValidationErrors(!1):this.setValidationErrors(!0)},i.$inject=["i18nService","gosSpecNetworkService","ipParserService"],i}(),r=function(){function e(){this.bindings={adapterWrapper:"<",dnsSuffixList:"=",updateDnsTab:"=",submitErrors:"=",editDns:"=",refreshGridData:"="},this.controller=i,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/network/edit/dns-tab/edit-dns-tab.component.html"}return e}();e.EditDnsTabComponent=r,angular.module("com.vmware.vsphere.client.vm").component("editDnsTab",new r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t){this.i18nService=e,this.vuiConstants=t,this.DNS_TITLE="customizationSpec.networkPage.properties.dns.pageTitle",this.IPV4_TITLE="customizationSpec.networkPage.properties.ipv4.pageTitle",this.IPV6_TITLE="customizationSpec.networkPage.properties.ipv6.pageTitle",this.WINS_TITLE="customizationSpec.networkPage.properties.wins.pageTitle",this.validationErrors=[],this.refreshGridData=function(){},this.i18n=this.i18nService.getString}return t.prototype.$onInit=function(){var e=this;this.validationErrors=[],this.onSubmit=function(){if(!e.validateTabs()){var t={type:e.vuiConstants.validationBanner.type.ERROR,text:e.i18n("VmUi","customizationSpecWizard.pageValidationError")};return e.alerts=[t],!1}return e.editNic(),!0}},t.prototype.$doCheck=function(){this.submitDisabled=this.validationErrors&&this.validationErrors.length>0},t.prototype.isGosWindows=function(){return this.customizationSpecType===e.GosType.WINDOWS||this.customizationSpecType===e.GosType.WINDOWS_CUSTOM_SYSPREP},t.prototype.showTabError=function(e){return _.some(this.validationErrors,function(t){return t===e})},t.prototype.onTabSelected=function(e){2===e&&this.refreshGridData()},t.prototype.validateTabs=function(){var e=this.editIpv4(),t=this.editIpv6(),i=!this.isGosWindows()||this.editWins();return this.isGosWindows()&&this.editDns(),e&&t&&i},t.$inject=["i18nService","vuiConstants"],t}();e.GosNetworkPageEditController=t;
var i=function(){function e(){this.bindings={adapterWrapper:"<",customizationSpecType:"<",isNameIpGeneratorDefined:"<",editNic:"<",alerts:"=",onSubmit:"=",validationErrors:"=",submitDisabled:"=",dnsSuffixList:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/network/edit/gos-network-page-edit.component.html"}return e}();e.GosNetworkPageEditComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosNetworkPageEdit",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.DhcpIpGenerator,i=com.vmware.vim.binding.vim.vm.customization.UnknownIpGenerator,r=com.vmware.vim.binding.vim.vm.customization.CustomIpGenerator,n=com.vmware.vim.binding.vim.vm.customization.FixedIp,o=function(){function o(t,i,r){this.i18nService=t,this.gosSpecNetworkService=i,this.ipParser=r,this.ADAPTER_TYPE_DHCP=e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP,this.ADAPTER_TYPE_UNKNOWUN_IP=e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP,this.ADAPTER_TYPE_CUSTOM_IP=e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP,this.ADAPTER_TYPE_FIXED_IP=e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP,this.FIXED_IP_ADDRESS="fixedIpAddress",this.SUBNET_MASK="subnetMask",this.DEFAULT_GATEWAY="defaultGateway",this.ALTERNATE_GATEWAY="alternateGateway",this.TITLE_LOCALE="customizationSpec.networkPage.properties.ipv4.pageTitle",this.validationErrors={},this.i18n=this.i18nService.getString}return o.prototype.$onInit=function(){var e=this;this.adapterMapping=this.adapterWrapper.adapterMapping,this.ipv4Type=this.adapterMapping.adapter.ip._type,this.populateData(),this.setSubnetAndGatewayDisabled(),this.editIpv4=function(){return e.preSubmit()}},o.prototype.setIPv4Generator=function(){switch(this.ipv4Type){case e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP:this.adapterMapping.adapter.ip=new t;break;case e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP:this.adapterMapping.adapter.ip=new i;break;case e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP:var o=new r;o.argument="",this.adapterMapping.adapter.ip=o;break;case e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP:var a=new n;a.ipAddress="",this.adapterMapping.adapter.ip=a}this.ipv4Type!==e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP&&this.clearFixedValidations(),this.ipv4Type!==e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP&&this.ipv4Type!==e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP&&this.clearGeneralValidations(),this.setSubnetAndGatewayDisabled(),this.setValidationErrors(this.preSubmit()),this.updateDnsTab&&"function"==typeof this.updateDnsTab&&this.updateDnsTab()},o.prototype.validateIPv4=function(t,i){switch(i){case this.FIXED_IP_ADDRESS:this.validationErrors.ipv4Error=this.validateIPv4Internal(t,!0);break;case this.SUBNET_MASK:var r=this.ipv4Type===e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP;this.validationErrors.subnetMaskError=this.validateIPv4Internal(t,r,"mask");break;case this.DEFAULT_GATEWAY:this.validationErrors.defaultGatewayError=this.validateIPv4Internal(t,!1);break;case this.ALTERNATE_GATEWAY:this.validationErrors.alternateGatewayError=this.validateIPv4Internal(t,!1)}this.setValidationErrors(this.preSubmit())},o.prototype.setValidationErrors=function(e){e||_.contains(this.submitErrors,this.TITLE_LOCALE)?e&&(this.submitErrors=_.without(this.submitErrors,this.TITLE_LOCALE)):this.submitErrors.push(this.TITLE_LOCALE)},o.prototype.clearFixedValidations=function(){this.validationErrors.ipv4Error="",this.clearGeneralValidations()},o.prototype.clearGeneralValidations=function(){this.validationErrors.subnetMaskError="",this.validationErrors.defaultGatewayError="",this.validationErrors.alternateGatewayError=""},o.prototype.showFixedValidations=function(){return this.validationErrors.ipv4Error=this.validateIPv4Internal(this.ipAddress,!0),this.showGeneralValidations()&&!this.validationErrors.ipv4Error},o.prototype.showGeneralValidations=function(){var t=this.ipv4Type===e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP;this.validationErrors.subnetMaskError=this.validateIPv4Internal(this.subnetMask,t,"mask"),this.validationErrors.defaultGatewayError=this.validateIPv4Internal(this.defaultGateway,!1),this.validationErrors.alternateGatewayError=this.validateIPv4Internal(this.alternateGateway,!1);var i=_.all(this.validationErrors,function(e){return!e});return i},o.prototype.validateIPv4Internal=function(e,t,i){var r="customizationSpec.networkPage.properties.ipv4.error.";return r+=void 0!==i?i:"address",e?this.ipParser.isIpv4AddressValid(e)&&("mask"!==i||this.ipParser.isSubnetMaskValid(e))?"":this.i18n("VmUi",r):t?this.i18n("VmUi",r):""},o.prototype.preSubmit=function(){var t=!0;return this.ipv4Type===e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP&&(t=this.showFixedValidations()),this.ipv4Type!==e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP&&this.ipv4Type!==e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP||(t=this.showGeneralValidations()),!!t&&(this.updateData(),!0)},o.prototype.updateData=function(){switch(this.ipv4Type){case e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP:this.adapterMapping.adapter.subnetMask="",this.adapterMapping.adapter.gateway=[];break;case e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP:this.adapterMapping.adapter.ip.argument=this.argument,this.updateSubnetAndGatewayData();break;case e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP:this.updateSubnetAndGatewayData();break;case e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP:this.ipAddress=ipaddr.parse(this.ipAddress).toString(),this.adapterMapping.adapter.ip.ipAddress=this.ipAddress,this.updateSubnetAndGatewayData()}this.adapterWrapper.ipV4Address=this.gosSpecNetworkService.getIPv4NicSettingSummary(this.adapterMapping.adapter.ip)},o.prototype.populateData=function(){switch(this.ipv4Type){case e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP:this.populateSubnetAndGatewayData();break;case e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP:this.argument=this.adapterMapping.adapter.ip.argument,this.populateSubnetAndGatewayData();break;case e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP:this.ipAddress=this.adapterMapping.adapter.ip.ipAddress,this.populateSubnetAndGatewayData()}},o.prototype.updateSubnetAndGatewayData=function(){this.subnetMask&&(this.subnetMask=ipaddr.parse(this.subnetMask).toString()),this.adapterMapping.adapter.subnetMask=this.subnetMask;var e=[];this.defaultGateway&&(this.defaultGateway=ipaddr.parse(this.defaultGateway).toString(),e.push(this.defaultGateway)),this.alternateGateway&&(this.alternateGateway=ipaddr.parse(this.alternateGateway).toString(),e.push(this.alternateGateway)),this.adapterMapping.adapter.gateway=e},o.prototype.populateSubnetAndGatewayData=function(){this.adapterMapping.adapter.subnetMask&&(this.subnetMask=this.adapterMapping.adapter.subnetMask);var e=this.adapterMapping.adapter.gateway;e&&e.length>0&&(e[0]&&(this.defaultGateway=e[0]),e[1]&&(this.alternateGateway=e[1]))},o.prototype.setSubnetAndGatewayDisabled=function(){this.subnetAndGatewayDisabled=this.ipv4Type===e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP},o.$inject=["i18nService","gosSpecNetworkService","ipParserService"],o}(),a=function(){function e(){this.bindings={adapterWrapper:"<",isNameIpGeneratorDefined:"<",editIpv4:"=",updateDnsTab:"=",submitErrors:"="},this.controller=o,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/network/edit/ipv4-tab/edit-ipv4-tab.component.html"}return e}();e.EditIpv4TabComponent=a,angular.module("com.vmware.vsphere.client.vm").component("editIpv4Tab",new a)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.DhcpIpV6Generator,i=com.vmware.vim.binding.vim.vm.customization.IPSettings$IpV6AddressSpec,r=com.vmware.vim.binding.vim.vm.customization.FixedIpV6,n=com.vmware.vim.binding.vim.vm.customization.UnknownIpV6Generator,o=com.vmware.vim.binding.vim.vm.customization.CustomIpV6Generator,a=function(){function a(t,i,r){this.i18nService=t,this.gosSpecNetworkService=i,this.ipParser=r,this.DO_NOT_USE_IPV6="doNotUseIpv6",this.ADAPTER_TYPE_DHCP=e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP_V6,this.ADAPTER_TYPE_UNKNOWUN_IP=e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP_V6,this.ADAPTER_TYPE_CUSTOM_IP=e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP_V6,this.ADAPTER_TYPE_FIXED_IP=e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP_V6,this.TITLE_LOCALE="customizationSpec.networkPage.properties.ipv6.pageTitle",this.gridAddressesOptions={},this.gridGatewaysOptions={},this.gateways=[],this.validationErrors={},this.ipAddressesList=[]}return a.prototype.$onInit=function(){var e=this;this.i18n=this.i18nService.getString,this.adapterMapping=this.adapterWrapper.adapterMapping,this.ipv6Type=this.getSpecType(),this.populateData(),this.initGrids(),this.editIpv6=function(){return e.preSubmit()}},a.prototype.initGrids=function(){this.gridAddressesOptions.columnDefinitions=this.getAddressesColumnDefs(),this.gridAddressesOptions.data=this.ipAddressesList,this.gridAddressesOptions.deleteLabel=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.delete.label"),this.gridAddressesOptions.deleteTooltip=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.delete.tooltip"),this.gridAddressesOptions.onDelete=this.deleteAddressFromList.bind(this),this.gridGatewaysOptions.columnDefinitions=this.getGatewaysColumnDefs(),this.gridGatewaysOptions.data=this.gateways,this.gridGatewaysOptions.deleteLabel=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.delete.label"),this.gridGatewaysOptions.deleteTooltip=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.delete.tooltip"),this.gridGatewaysOptions.onDelete=this.deleteGatewayFromList.bind(this)},a.prototype.typeChanged=function(){this.ipv6Type!==this.DO_NOT_USE_IPV6&&this.ipv6Type!==this.ADAPTER_TYPE_DHCP||(this.validationErrors.gateway=null),this.ipv6Type!==this.ADAPTER_TYPE_FIXED_IP&&(this.validationErrors.ipAddress=null,this.validationErrors.prefixLength=null);var e=this.validate();this.setValidationErrors(e),this.updateData(),this.updateDnsTab&&"function"==typeof this.updateDnsTab&&this.updateDnsTab()},a.prototype.setValidationErrors=function(e){e||_.contains(this.submitErrors,this.TITLE_LOCALE)?e&&(this.submitErrors=_.without(this.submitErrors,this.TITLE_LOCALE)):this.submitErrors.push(this.TITLE_LOCALE)},a.prototype.addAddress=function(){if(this.validateIPv6(this.ipAddress),this.validatePrefixLength(this.prefixLength),!this.validationErrors.ipAddress&&!this.validationErrors.prefixLength){var e=new r;e.ipAddress=this.ipAddress,this.prefixLength&&(e.subnetMask=this.prefixLength),this.ipAddressesList.push(e),this.gridAddressesOptions.data=this.ipAddressesList,this.ipAddress="",this.prefixLength=void 0,this.setValidationErrors(!0)}},a.prototype.addGateway=function(){this.validateGateway(this.gateway),this.gateway&&!this.validationErrors.gateway&&(this.gateways.push(this.gateway),this.gridGatewaysOptions.data=this.gateways,this.gateway="")},a.prototype.validateGateway=function(e){if(!e)return void(this.validationErrors.gateway=null);var t=this.ipParser.isIpv6AddressValid(e),i=_.any(this.gateways,function(t){return t===e});t||(this.validationErrors.gateway=this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.dialog.error.address")),i&&(this.validationErrors.gateway=this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.dialog.error.duplicate",e)),t&&!i&&(this.validationErrors.gateway=null)},a.prototype.validateIPv6=function(e){var t=this.ipParser.isIpv6AddressValid(e),i=_.any(this.ipAddressesList,function(t){return t.ipAddress===e});t||(this.validationErrors.ipAddress=this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.dialog.error.address")),i&&(this.validationErrors.ipAddress=this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.dialog.error.duplicate",e)),t&&!i&&(this.validationErrors.ipAddress=null)},a.prototype.validatePrefixLength=function(e){this.ipParser.isSubnetPrefixValid(e)?this.validationErrors.prefixLength=null:this.validationErrors.prefixLength=this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.dialog.error.prefix")},a.prototype.getSpecType=function(){var e=this.adapterMapping.adapter;if(!e.ipV6Spec)return this.DO_NOT_USE_IPV6;if(!e.ipV6Spec.ip||!e.ipV6Spec.ip.length)return this.DO_NOT_USE_IPV6;var t=e.ipV6Spec.ip[0];return t._type},a.prototype.populateData=function(){if(this.ipv6Type!==this.DO_NOT_USE_IPV6){var e=this.adapterMapping.adapter;e.ipV6Spec.gateway&&e.ipV6Spec.gateway.length?this.gateways=e.ipV6Spec.gateway:this.gateways=[],this.ipv6Type===this.ADAPTER_TYPE_CUSTOM_IP&&(this.argument=e.ipV6Spec.ip[0].argument),this.ipv6Type===this.ADAPTER_TYPE_FIXED_IP&&(this.ipAddressesList=e.ipV6Spec.ip)}},a.prototype.preSubmit=function(){var e=this.validate();return!!e&&(this.updateData(),!0)},a.prototype.validate=function(){var e=!0;return this.ipv6Type!==this.ADAPTER_TYPE_FIXED_IP||this.ipAddressesList&&this.ipAddressesList.length||(e=!1,this.validationErrors.ipAddress=this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.error.required")),e},a.prototype.updateData=function(){var e=this.adapterMapping.adapter;return this.ipv6Type===this.DO_NOT_USE_IPV6?(delete e.ipV6Spec,void(this.adapterWrapper.ipV6Address=this.gosSpecNetworkService.getIPv6NicSettingSummary(e.ipV6Spec))):(e.ipV6Spec=new i,e.ipV6Spec.gateway=this.gateways,e.ipV6Spec.ip=this.getIpGenerators(),void(this.adapterWrapper.ipV6Address=this.gosSpecNetworkService.getIPv6NicSettingSummary(e.ipV6Spec)))},a.prototype.getIpGenerators=function(){switch(this.ipv6Type){case this.ADAPTER_TYPE_UNKNOWUN_IP:return[new n];case this.ADAPTER_TYPE_CUSTOM_IP:var e=new o;return e.argument=this.argument,[e];case this.ADAPTER_TYPE_FIXED_IP:return this.ipAddressesList}return[new t]},a.prototype.getAddressesColumnDefs=function(){return[{displayName:this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.address"),field:"ipAddress",type:"string","class":"ipv6-address-col"},{displayName:this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.prefix"),field:"subnetMask",type:"string"}]},a.prototype.getGatewaysColumnDefs=function(){return[{displayName:this.i18n("VmUi","customizationSpec.networkPage.properties.ipv6.gateway"),type:"string"}]},a.prototype.deleteAddressFromList=function(e){if(e){var t=_.findIndex(this.ipAddressesList,function(t){return t.ipAddress===e.ipAddress});t<0||(this.ipAddressesList.splice(t,1),this.setValidationErrors(this.validate()))}},a.prototype.deleteGatewayFromList=function(e){if(e){var t=_.findIndex(this.gateways,function(t){return t===e});t<0||this.gateways.splice(t,1)}},a.$inject=["i18nService","gosSpecNetworkService","ipParserService"],a}(),s=function(){function e(){this.bindings={adapterWrapper:"<",isNameIpGeneratorDefined:"<",editIpv6:"=",submitErrors:"=",updateDnsTab:"="},this.controller=a,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/network/edit/ipv6-tab/edit-ipv6-tab.component.html"}return e}();e.EditIpv6TabComponent=s,angular.module("com.vmware.vsphere.client.vm").component("editIpv6Tab",new s)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){var i=this;this.i18nService=e,this.ipParserService=t,this.TITLE_LOCALE="customizationSpec.networkPage.properties.wins.pageTitle",this.validationErrors={},this.i18nForTab=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return(n=i.i18nService).getString.apply(n,["VmUi","customizationSpec.networkPage.properties.wins."+e].concat(t));var n}}return e.prototype.$onInit=function(){var e=this;this.adapterMapping=this.adapterWrapper.adapterMapping,this.populateData(),this.editWins=function(){return e.preSubmit()}},e.prototype.validatePrimaryWins=function(){this.validationErrors.primaryWins=this.validateIpInternal(this.primaryWins),this.setValidationErrors(this.areAllFieldsValid())},e.prototype.validateSecondaryWins=function(){this.validationErrors.secondaryWins=this.validateIpInternal(this.secondaryWins),this.setValidationErrors(this.areAllFieldsValid())},e.prototype.validateAll=function(){this.validatePrimaryWins(),this.validateSecondaryWins()},e.prototype.areAllFieldsValid=function(){return _.all(this.validationErrors,function(e){return!e})},e.prototype.validateIpInternal=function(e){return!e||this.ipParserService.isIpv4AddressValid(e)||this.ipParserService.isIpv6AddressValid(e)?"":this.i18nForTab("error.address")},e.prototype.preSubmit=function(){return this.validateAll(),!!this.areAllFieldsValid()&&(this.updateData(),!0)},e.prototype.setValidationErrors=function(e){e||_.contains(this.submitErrors,this.TITLE_LOCALE)?e&&(this.submitErrors=_.without(this.submitErrors,this.TITLE_LOCALE)):this.submitErrors.push(this.TITLE_LOCALE)},e.prototype.updateData=function(){this.primaryWins&&(this.primaryWins=ipaddr.parse(this.primaryWins).toString()),this.secondaryWins&&(this.secondaryWins=ipaddr.parse(this.secondaryWins).toString()),this.adapterMapping.adapter.primaryWINS=this.primaryWins,this.adapterMapping.adapter.secondaryWINS=this.secondaryWins},e.prototype.populateData=function(){this.primaryWins=this.adapterMapping.adapter.primaryWINS||"",this.secondaryWins=this.adapterMapping.adapter.secondaryWINS||""},e.$inject=["i18nService","ipParserService"],e}(),i=function(){function e(){this.bindings={adapterWrapper:"<",submitErrors:"=",editWins:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/network/edit/wins-tab/edit-wins-tab.component.html"}return e}();e.EditWinsTabComponent=i,angular.module("com.vmware.vsphere.client.vm").component("editWinsTab",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(t,i,r,n,o,a,s,c){this.$q=t,this.i18nService=i,this.vuiConstants=r,this.gosSpecNetworkService=n,this.clarityModalService=o,this.featureFlagsService=a,this.defaultUriSchemeUtil=s,this.dataService=c,this.NETWORK_SETTINGS_STANDARD=e.GosNetworkSettingsType.STANDARD,this.NETWORK_SETTINGS_CUSTOM=e.GosNetworkSettingsType.CUSTOM}return t.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this),this.gridConfiguration=this.generateGridConfiguration(),this.i18n=this.i18nService.getString},t.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},t.prototype.onCommit=function(){return this.$q.resolve([])},t.prototype.customSettingsGridDisabled=function(){return this.model.networkSettingsType===e.GosNetworkSettingsType.STANDARD},t.prototype.generateGridConfiguration=function(){var t=new e.CrudGridConfiguration;return t.data=this.model.adapterMappingWrappers,t.columnDefinitions=this.getColumnDefs(),t.height="250",t.addLabel=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.add.label"),t.addTooltip=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.add.tooltip"),t.onAdd=this.addNewNicMapping.bind(this),t.editLabel=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.edit.label"),t.editTooltip=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.edit.tooltip"),t.onEdit=this.editNicMapping.bind(this),t.deleteLabel=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.delete.label"),t.deleteTooltip=this.i18nService.getString("VmUi","customizationSpec.networkPage.actionButton.delete.tooltip"),t.onDelete=this.deleteNicMapping.bind(this),t},t.prototype.getColumnDefs=function(){return[{displayName:this.i18nService.getString("VmUi","customizationSpec.networkPage.settingsList.description"),field:"description",type:"string",sortable:!0},{displayName:this.i18nService.getString("VmUi","customizationSpec.networkPage.settingsList.iPv4Address"),field:"ipV4Address",type:"string",sortable:!0},{displayName:this.i18nService.getString("VmUi","customizationSpec.networkPage.settingsList.iPv6Address"),field:"ipV6Address",type:"string",sortable:!0}]},t.prototype.addNewNicMapping=function(){this.model.adapterMappingWrappers=this.model.adapterMappingWrappers||[];var e=this.i18nService.getString("VmUi","customizationManager.customizationSpecViewData.nicNameFormat",this.model.adapterMappingWrappers.length+1),t=this.gosSpecNetworkService.createNewAdapterMappingWrapper(e);this.model.adapterMappingWrappers.push(t)},t.prototype.editNicMapping=function(e){var t=this;if(e){this.getCustomNameAvailabilityIfNeeded();var i=angular.copy(e),r=angular.copy(this.model.dnsSuffixList),n=[],o={title:this.i18nService.getString("VmUi","customizationSpec.networkPage.editDialog.title"),subTitle:{text:i.description},size:"xl",defaultButton:"submit",contentTemplate:"vm-ui/resources/vm/guest-os-customization/pages/network/edit/gos-network-page-edit.html",dialogData:{adapterWrapper:i,dnsSuffixList:r,customizationSpecType:this.model.type,isNameIpGeneratorDefined:this.model.isNameIpGeneratorDefined,validationErrors:n,editNic:function(){t.editNic(i,r)}}};this.clarityModalService.openOkCancelModal(o)}},t.prototype.editNic=function(e,t){var i=this.model.adapterMappingWrappers,r=_.findIndex(i,function(t){return t.description===e.description});r>-1&&(i[r]=e),this.model.dnsSuffixList=t},t.prototype.deleteNicMapping=function(e){if(e){var t=this.model.adapterMappingWrappers,i=_.findIndex(t,function(t){return t.description===e.description});i<0||(t.splice(i,1),this.gosSpecNetworkService.updateAdapterMappingNames(i,t))}},t.prototype.getCustomNameAvailabilityIfNeeded=function(){var e=this;if(void 0===this.model.isNameIpGeneratorDefined){var t=this.defaultUriSchemeUtil.getRootFolder(this.model.vcServiceGuid);this.dataService.getProperties(t,["isNameIpGeneratorDefined"]).then(function(t){e.model.isNameIpGeneratorDefined=t.isNameIpGeneratorDefined})}},t.$inject=["$q","i18nService","vuiConstants","gosSpecNetworkService","clarityModalService","featureFlagsService","defaultUriSchemeUtil","dataService"],t}();e.GosNetworkPageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/network/gos-network-page.component.html",this.bindings={model:"<"}}return e}();e.GosNetworkPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosNetworkPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosNetworkPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.customization.DhcpIpGenerator,i=com.vmware.vim.binding.vim.vm.customization.AdapterMapping,r=com.vmware.vim.binding.vim.vm.customization.IPSettings,n=function(){function n(e){this.i18nService=e}return n.prototype.getIPv4NicSettingSummary=function(t){return t._type===e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP?this.getString("nicSettingsUseDhcp"):t._type===e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP?this.getString("nicSettingsPromptUser"):t._type===e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP?this.getString("nicSettingsCustom"):t._type===e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP?t.ipAddress:this.getString("nicSettingsUnknown")},n.prototype.getIPv6NicSettingSummary=function(t){return t&&t.ip&&t.ip.length?t.ip[0]._type===e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP_V6?this.getString("nicSettingsUseDhcp"):t.ip[0]._type===e.GosCustomizationHelperService.ADAPTER_TYPE_UNKNOWUN_IP_V6?this.getString("nicSettingsPromptUser"):t.ip[0]._type===e.GosCustomizationHelperService.ADAPTER_TYPE_CUSTOM_IP_V6?this.getString("nicSettingsCustom"):t.ip[0]._type===e.GosCustomizationHelperService.ADAPTER_TYPE_FIXED_IP_V6?t.ip[0].ipAddress:this.getString("nicSettingsUnknown"):this.getString("nicSettingsNotUsed")},n.prototype.getInitialNetworkCards=function(){var e=this.createNewAdapterMappingWrapper(this.getString("nicNameFormat","1"));return[e]},n.prototype.isNetworkTypeStandard=function(e){return!!e&&(!(!this.isLinuxPrep(e)&&this.hasDnsSuffixList(e))&&(!!this.specificationHasDefaultNumberOfNics(e)&&!this.hasCustomizedAdapter(e)))},n.prototype.createAdapterMappingWrappersFromSpecification=function(e){var t=[],i=e.nicSettingMap;if(i&&i.length)for(var r=0;r<i.length;r++){var n=this.getString("nicNameFormat",r+1),o=this.createNewAdapterMappingWrapper(n,i[r]);t.push(o)}return t},n.prototype.createNewAdapterMappingWrapper=function(n,o){if(!o){o=new i;var a=new r;a.ip=new t,o.adapter=a}var s=new e.AdapterMappingWrapper;return s.adapterMapping=o,s.description=n,s.ipV4Address=this.getIPv4NicSettingSummary(o.adapter.ip),s.ipV6Address=this.getIPv6NicSettingSummary(o.adapter.ipV6Spec),s},n.prototype.updateAdapterMappingNames=function(e,t){for(var i=e;i<t.length;i++){var r=t[i];r.description=this.getString("nicNameFormat",i+1)}},n.prototype.getString=function(e,t){return this.i18nService.getString("VmUi","customizationManager.customizationSpecViewData."+e,t)},n.isAdapterCustomized=function(t){return!!(t.adapter.ip._type!==e.GosCustomizationHelperService.ADAPTER_TYPE_DHCP||t.adapter.ipV6Spec&&t.adapter.ipV6Spec._type===e.GosCustomizationHelperService.IPV6_ADDRESS_SPEC_TYPE||t.adapter.dnsServerList||t.adapter.gateway||t.adapter.primaryWINS||t.adapter.secondaryWINS||t.adapter.subnetMask)},n.prototype.isLinuxPrep=function(t){return t.identity._type===e.GosCustomizationHelperService.IDENTITY_TYPE_LINUX_PREP},n.prototype.hasDnsSuffixList=function(e){return e.globalIPSettings&&!_.isEmpty(e.globalIPSettings.dnsSuffixList)},n.prototype.specificationHasDefaultNumberOfNics=function(t){return t.nicSettingMap&&t.nicSettingMap.length===e.GosCustomizationHelperService.DEFAULT_NUMBER_OF_NICS},n.prototype.hasCustomizedAdapter=function(e){var t=_.find(e.nicSettingMap,function(e){return n.isAdapterCustomized(e)});return!!t},n.$inject=["i18nService"],n}();e.GosSpecNetworkService=n,angular.module("com.vmware.vsphere.client.vm").service("gosSpecNetworkService",n)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.ownerNameInvalid=!1,this.organizationNameInvalid=!1}return e.prototype.$onInit=function(){var e=this;this.ownerNameLabel=this.i18nService.getString("VmUi","guestOsCustomization.new.registrationInformationPage.ownerName"),this.organizationNameLabel=this.i18nService.getString("VmUi","guestOsCustomization.new.registrationInformationPage.organizationName"),this.emptyOwnerNameTooltip=this.i18nService.getString("VmUi","customizationSpec.registrationInfoPage.emptyOwnerNameError"),this.emptyOrganizationNameTooltip=this.i18nService.getString("VmUi","customizationSpec.registrationInfoPage.emptyOrgNameError"),this.model.onPageCommit=function(){return e.onCommit()}},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.validateOwnerName=function(){this.ownerNameInvalid=!this.model.ownerName.trim()},e.prototype.validateOrganizationName=function(){this.organizationNameInvalid=!this.model.organizationName.trim()},e.prototype.onCommit=function(){this.validateOwnerName(),this.validateOrganizationName();var e=[];return this.ownerNameInvalid&&e.push(this.emptyOwnerNameTooltip),this.organizationNameInvalid&&e.push(this.emptyOrganizationNameTooltip),this.$q.resolve(e)},e.$inject=["i18nService","$q"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/registration-information/gos-registration-information-page.component.html",this.bindings={model:"<"}}return e}();e.GosRegistrationInformationPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosRegistrationInformationPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosRegistrationInformationPageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(t,i,r,n,o,a){this.$scope=t,this.$q=i,this.i18nService=r,this.vuiConstants=n,this.dataService=o,this.$timeout=a,this.UTC_OPTION=e.LinuxHardwareClockOption.UTC,this.LOCAL_TIME_OPTION=e.LinuxHardwareClockOption.LOCAL_TIME}return t.prototype.$onInit=function(){var e=this;this.model.onPageCommit=this.onCommit.bind(this),this.i18n=this.i18nService.getString,this.selectedHardwareClock={value:this.model.hwClockUTC||null===this.model.hwClockUTC?this.UTC_OPTION:this.LOCAL_TIME_OPTION},this.model.timeZoneData?this.initialize():(this.setLoading(!0),this.dataService.getProperties(this.model.customizationSpecManagerUrn,["timeZones"]).then(function(t){e.model.timeZoneData=t.timeZones,e.setLoading(!1),e.initialize()}))},t.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},t.prototype.onCommit=function(){return this.$q.resolve(this.validateIsTimezoneSelected())},t.prototype.isLinux=function(){return this.model.type===e.GosType.LINUX},t.prototype.isWindows=function(){return this.model.type===e.GosType.WINDOWS},t.prototype.initialize=function(){if(!this.model.timeZoneData)throw new Error("Time zone data is not defined - cannot initialize page");this.isLinux()?this.initializeForLinux(this.model.timeZoneData.linuxTimeZoneAreas):this.initializeForWindows(this.model.timeZoneData.windowsTimeZones)},t.prototype.timeZoneAreaChanged=function(){this.model.timeZoneArea=this.selectedTimeZoneArea.name,this.selectedLinuxTimeZoneLocation=this.selectedTimeZoneArea.locations[0],this.model.timeZoneLocation=this.selectedLinuxTimeZoneLocation.name},t.prototype.timeZoneLocationChanged=function(){this.model.timeZoneLocation=this.selectedLinuxTimeZoneLocation.name},t.prototype.hardwareClockChanged=function(){this.model.hwClockUTC=this.selectedHardwareClock.value===e.LinuxHardwareClockOption.UTC},t.prototype.initializeForLinux=function(e){var t=this;this.linuxTimeZoneAreas=e,this.model.timeZoneArea?this.selectedTimeZoneArea=this.findLinuxTimeZoneArea(this.model.timeZoneArea):(this.selectedTimeZoneArea=e[0],this.model.timeZoneArea=this.selectedTimeZoneArea.name),this.model.timeZoneLocation||(this.model.timeZoneLocation=this.selectedTimeZoneArea.locations[0].name),this.selectedLinuxTimeZoneLocation=_.find(this.selectedTimeZoneArea.locations,function(e){return e.name===t.model.timeZoneLocation})},t.prototype.linuxAreaLabel=function(e){return this.i18n("CommonTimeZones","timeZoneLinux.Area."+e)},t.prototype.linuxLocationLabel=function(e){return this.i18n("CommonTimeZones","timeZoneLinux.Location."+e)},t.prototype.findLinuxTimeZoneArea=function(e){return _.find(this.linuxTimeZoneAreas,function(t){return t.name===e})},t.prototype.initializeForWindows=function(e){var t=this;this.windowsTimeZones=e,void 0===this.model.timeZoneWinCode&&(this.model.timeZoneWinCode=e[0].code),this.selectedWindowsTimeZone=_.find(e,function(e){return e.code===t.model.timeZoneWinCode})},t.prototype.windowsTimeZoneLabel=function(e){return this.i18n("CommonTimeZones","timeZoneWindows."+e)},t.prototype.windowsTimeZoneChanged=function(){this.model.timeZoneWinCode=this.selectedWindowsTimeZone.code},t.prototype.findWindowsTimeZone=function(e){return _.find(this.windowsTimeZones,function(t){return t.code===e})},t.prototype.setLoading=function(e){this.model.isLoading=e},t.prototype.validateIsTimezoneSelected=function(){var e=[];return this.model.isLoading&&e.push(this.i18n("VmUi","customizationSpec.timeZonePage.selectValidTimezone")),e},t.$inject=["$scope","$q","i18nService","vuiConstants","dataService","$timeout"],t}();e.GosTimeZonePageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/time-zone/gos-time-zone-page.component.html",
this.bindings={model:"<"}}return e}();e.GosTimeZonePageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosTimeZonePage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosTimeZonePageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.value=e}return e.UTC_VALUE="UTC",e.LOCAL_TIME_VALUE="LocalTime",e.UTC=new e(e.UTC_VALUE),e.LOCAL_TIME=new e(e.LOCAL_TIME_VALUE),e}();e.LinuxHardwareClockOption=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.$q=e,this.i18n=t,this.AUTO_USERS_MIN=5,this.AUTO_USERS_MAX=9999,this.MAX_CHARS_PRODUCT_KEY=29}return e.prototype.$onInit=function(){this.invalidProductKeyMessage="",this.model.onPageCommit=this.onCommit.bind(this);var e=angular.element("input[ng-model='$ctrl.model.maxConnections']");e.on("input",function(){e[0].value.length>4&&(e[0].value=e[0].value.slice(0,4))})},e.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},e.prototype.onCommit=function(){var e=[];return""!==this.invalidProductKeyMessage&&(e=e.concat([this.errorMessage("invalidProductKeyLength")])),this.model.isIncludeServerLicenseInfo&&this.model.isServerLicenseModePerServer&&(!this.model.maxConnections||this.AUTO_USERS_MIN>this.model.maxConnections||this.AUTO_USERS_MAX<this.model.maxConnections)&&(e=e.concat([this.errorMessage("maxConnectionsInputError")])),this.$q.resolve(e)},e.prototype.onProductKeyChanged=function(){this.invalidProductKeyMessage=this.validateProductKey(this.model.productKey)},e.prototype.validateProductKey=function(e){return e.length>this.MAX_CHARS_PRODUCT_KEY?this.errorMessage("invalidProductKeyLength"):""},e.prototype.errorMessage=function(e,t){return void 0===t&&(t=[]),(i=this.i18n).getString.apply(i,["VmUi","customizationSpec.windowsLicensePage."+e].concat(t));var i},e.$inject=["$q","i18nService"],e}();e.GosWindowsLicensePageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/windows-license/gos-windows-license-page.component.html",this.bindings={model:"<"}}return e}();e.GosWindowsLicensePageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosWindowsLicensePage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosWindowsLicensePageModel=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(t,i){this.i18n=t,this.$q=i,this.domainInvalid=!1,this.workgroupInvalid=!1,this.usernameInvalid=!1,this.passwordInvalid=!1,this.WORKGROUP_OPTION=e.WorkgroupDomainTypeOption.WORKGROUP,this.DOMAIN_OPTION=e.WorkgroupDomainTypeOption.DOMAIN}return t.prototype.$onInit=function(){this.model.onPageCommit=this.onCommit.bind(this)},t.prototype.$onDestroy=function(){this.model.onPageCommit=void 0},t.prototype.onPasswordChanged=function(){this.model.isDomainPasswordChanged=!0},t.prototype.onCommit=function(){var e=[];return this.validateWorkgroup()?this.$q.resolve([this.i18n.getString("VmUi","guestOsCustomization.workGroupOrDomainPage.invalidWorkgroup")]):(this.validateDomain()&&e.push(this.i18n.getString("VmUi","guestOsCustomization.workGroupOrDomainPage.invalidDomain")),this.validateUsername()&&e.push(this.i18n.getString("VmUi","guestOsCustomization.workGroupOrDomainPage.invalidUsername")),this.validatePassword()&&e.push(this.i18n.getString("VmUi","customizationSpec.workgroupDomainPage.errorMessage.passwordsMismatch")),this.$q.resolve(e))},t.prototype.validateWorkgroup=function(){return this.workgroupInvalid=!this.model.workgroup&&this.model.networkOption===e.WorkgroupDomainTypeOption.WORKGROUP,this.workgroupInvalid},t.prototype.validateDomain=function(){return this.domainInvalid=!this.model.domain&&this.model.networkOption===e.WorkgroupDomainTypeOption.DOMAIN,this.domainInvalid},t.prototype.validateUsername=function(){return this.usernameInvalid=!this.model.username&&this.model.networkOption===e.WorkgroupDomainTypeOption.DOMAIN,this.usernameInvalid},t.prototype.validatePassword=function(){return this.passwordInvalid=this.model.password!==this.model.confirmPassword&&this.model.networkOption===e.WorkgroupDomainTypeOption.DOMAIN,this.passwordInvalid},t.prototype.removeValidations=function(){return this.model.networkOption===e.WorkgroupDomainTypeOption.DOMAIN?void(this.workgroupInvalid=!1):(this.domainInvalid=!1,this.usernameInvalid=!1,void(this.passwordInvalid=!1))},t.$inject=["i18nService","$q"],t}();e.GosWorkgroupDomainPageController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/guest-os-customization/pages/workgroup-domain/gos-workgroup-domain-page.component.html",this.bindings={model:"<"}}return e}();e.GosWorkgroupDomainPageComponent=i,angular.module("com.vmware.vsphere.client.vm").component("gosWorkgroupDomainPage",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.GosBasePageModel,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.GosWorkgroupDomainPageModel=i}(h5_vm||(h5_vm={}));var vm_model;!function(e){var t=":",i=t.charCodeAt(0),r="urn:vmomi:",n="~",o=n.charCodeAt(0),a="_",s=a.charCodeAt(0),c=function(){function e(e,t,i){this.type=e,this.value=t,this.serverGuid=i,this._type="com.vmware.vim.binding.vmodl.ManagedObjectReference"}return e.prototype.getUri=function(){return e.check(this.type,this.value,this.serverGuid),r+[this.escape(this.type),this.escape(this.value),this.escape(this.serverGuid)].join(t)},e.prototype.equals=function(e){return!!e&&this.getUri()===e.getUri()},e.fromObject=function(t){return new e(t.type,t.value,t.serverGuid)},e.fromUri=function(t){if(t){var i=e.partsFromUri(t);return this.check(i[0],i[1],i[2]),new e(i[0],i[1],i[2])}},e.check=function(e,t,i){var r=_.filter([e,t,i],function(e){return!!e});if(3!==r.length)throw new Error("Type, value or serverGuid is empty")},e.prototype.escape=function(e){if(e.indexOf(n)<0&&e.indexOf(t)<0)return e;for(var r=e.length,a=[],c=0;c<r;c++){var l=e.charCodeAt(c);l===i?(a.push(o),a.push(s)):l===o?(a.push(o),a.push(o)):a.push(l)}return String.fromCharCode.apply(String,a)},e.partsFromUri=function(e){for(var i=e.split(t);3!==i.length;)i.shift();return i},e}();e.MoRef=c,angular.module("com.vmware.vsphere.client.vm").service("MoRef",function(){return c})}(vm_model||(vm_model={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualNVDIMM$BackingInfo,i=com.vmware.vim.binding.vim.vm.device.VirtualNVDIMMController,r=com.vmware.vim.binding.vim.vm.device.VirtualNVDIMM,n=function(){function n(e,t,i,r,n,o){this.deviceService=e,this.i18nService=t,this.VirtualNvdimmWrapper=i,this.virtualDeviceInflator=r,this.pmemUtilService=n,this.storageProfileService=o}return n.prototype.makeDefaultNvdimm=function(e,t,i,n){this.validateCanAddNvdimm(e,t,n,i);var o=new r;o.backing=this.getVirtualNvdimmBacking(),o.capacityInMB=t.recommendedPersistentMemoryMB,o.key=this.deviceService.newKey();var a=this.getNVDIMMController(i,e,n);null!==a&&(o.controllerKey=a.getKey(),a.isMarkedForRemoval()&&a.revertRemoval());var s=this.deviceService.setDeviceInfo(new this.VirtualNvdimmWrapper(o));return s.setFileOperation(this.getDefaultFileOperation()),s.setProfile([this.getPmemStoragePolicy(n.storageProfiles)]),{device:s,controller:a}},n.prototype.canAddNvdimm=function(e,t,i,r){try{this.validateCanAddNvdimm(e,t,r,i)}catch(n){return!1}return!0},n.prototype.validateCanAddNvdimm=function(t,i,r,n){var o=this.pmemUtilService.findOption(t,e.PmemUtilService.NVDIMM);if(!o)throw new Error(this.text("DeviceNotSupported"));if(!i.persistentMemorySupported)throw new Error(this.text("DeviceNotSupportedByGuest"));if(r.vmWorkflow===e.VmWorkflowMode.UpdateMode&&"suspended"===r.vm.powerState)throw new Error(this.text("NoVmSuspendedAdd"));if(r.vmWorkflow===e.VmWorkflowMode.UpdateMode&&"poweredOff"!==r.vm.powerState){if(!o.plugAndPlay)throw new Error(this.text("HotAddNotSupported"));if(!i.persistentMemoryHotAddSupported)throw new Error(this.text("PMEMColdGuest"))}if(!this.isPmemAvailable(t,r.storageProfiles))throw new Error(this.text("PMEMNewDenied"));var a=this.getControllerLimit(t),s=this.getCurrentNvdimmCount(n);if(!isNaN(a)&&s+1>a)throw new Error(this.text("DeviceLimitReached"))},n.prototype.getVirtualNvdimmBacking=function(){var e=new t;return e.fileName="",e},n.prototype.getDefaultFileOperation=function(){var e="create";return e},n.prototype.getPmemStoragePolicy=function(e){if(e){var t;if((1===e.$$state||e.$$state.value)&&(t=this.pmemUtilService.getPmemStorageProfile(e.$$state.value)))return this.storageProfileService.makeProfile(t.id)}},n.prototype.getControllerLimit=function(t){var i=this.pmemUtilService.findOption(t,e.PmemUtilService.NVDIMM_CONTROLLER);return i||i.devices||i.devices.max?i.devices.max:NaN},n.prototype.getCurrentNvdimmCount=function(t){var i=t.devicesOfType(e.PmemUtilService.NVDIMM);return i.length},n.prototype.getNVDIMMController=function(e,t,i){var r=this.pmemUtilService.getNvdimmController(e);return r?r:this.addNVDIMMController(t.configOption.hardwareOptions.virtualDeviceOption,i.vmWorkflow)},n.prototype.addNVDIMMController=function(e,t){var r=new i;r.key=this.deviceService.newKey();var n=_.indexBy(e,function(e){return e.type.name}),o=this.virtualDeviceInflator.inflate(r,{deviceOptionsByDeviceType:n});return o=this.deviceService.setDeviceInfo(o)},n.prototype.isPmemAvailable=function(e,t){var i=!_.isEmpty(this.getPmemStoragePolicy(t)),r=e&&e.configTarget&&!isNaN(e.configTarget.availablePersistentMemoryReservationMB)&&e.configTarget.availablePersistentMemoryReservationMB>0;return i||r},n.prototype.text=function(e){return this.i18nService.getString("VmUi","VmDeviceManager."+e)},n.$inject=["deviceService","i18nService","VirtualNvdimmWrapper","virtualDeviceInflator","pmemUtilService","storageProfileService"],n}();angular.module("com.vmware.vsphere.client.vm").service("nvdimmProvisioningService",n)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e){this.pmemUtilService=e}return t.prototype.getMaxCapacityForNvdimm=function(t,i,r,n){var o=this.getComputeResourceAvailablePmemCapacity(t,r,n),a=this.pmemUtilService.findOption(t.environment,e.PmemUtilService.NVDIMM),s=a.capacityInMB.max,c=this.getRemainingOsMemory(t,i,n,r),l=this.getRemainingPmemCapacitySupportedByGuestOs(i,n,r),d=Math.min(o,s,c,l);return d>0?d:0},t.prototype.getMaxCapacityForPmemDisk=function(e,t,i){return this.getComputeResourceAvailablePmemCapacity(e,t,i)},t.prototype.getIsNvmAndRamExceedingGuestOsLimits=function(e,t,i){return this.getRemainingOsMemory(e,t,i)<0},t.prototype.getTotalNvdimmMemory=function(t,i){for(var r=0,n=t.devicesOfType(e.PmemUtilService.NVDIMM),o=0,a=n;o<a.length;o++){var s=a[o];i&&i.getKey()===s.getKey()||s.isMarkedForRemoval()||(r+=s.getCapacityInMB())}return r},t.prototype.getComputeResourceAvailablePmemCapacity=function(e,t,i){var r=this.pmemUtilService.getAvailablePmemCapacity(e),n=this.getTotalNewPmemCapacity(i,t);r+=t.getOriginalCapacityInMB();var o=r-n;return o>0?o:0},t.prototype.getRemainingOsMemory=function(e,t,i,r){var n=this.getTotalNvdimmAndRamMemory(e,i,r);return t.supportedMaxMemMB-n},t.prototype.getRemainingPmemCapacitySupportedByGuestOs=function(e,t,i){return this.pmemUtilService.getSupportedPmemByGuestOs(e)-this.getTotalNvdimmMemory(t,i)},t.prototype.getTotalNewPmemCapacity=function(e,t){var i=0;return i+=this.getNvdimmContributionToPmemCapacity(e,t),i+=this.getPmemDiskContributionToPmemCapacity(e,t)},t.prototype.getPmemDiskContributionToPmemCapacity=function(e,t){for(var i=0,r=e.devicesOfType("VirtualDisk"),n=_.filter(r,function(e){return!(!e.isNew()&&!e.hasChanged())&&(!(!e.isPmemDisk()||e.isMarkedForRemoval())&&(!t||t.getKey()!==e.getKey()))}),o=0,a=n;o<a.length;o++){var s=a[o];i+=this.getDeviceContributionToPmemCapacity(s)}return i},t.prototype.getNvdimmContributionToPmemCapacity=function(t,i){for(var r=0,n=t.devicesOfType(e.PmemUtilService.NVDIMM),o=_.filter(n,function(e){return!(!e.isNew()&&!e.hasChanged())&&((!i||i.getKey()!==e.getKey())&&!e.isMarkedForRemoval())}),a=0,s=o;a<s.length;a++){var c=s[a];r+=this.getDeviceContributionToPmemCapacity(c)}return r},t.prototype.getTotalNvdimmAndRamMemory=function(e,t,i){return this.getTotalNvdimmMemory(t,i)+e.config.hardware.memoryMB},t.prototype.getDeviceContributionToPmemCapacity=function(e){return e.getCapacityDiff()},t.$inject=["pmemUtilService"],t}();e.PmemCapacityService=t,angular.module("com.vmware.vsphere.client.vm").service("pmemCapacityService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.featureFlagsService=e}return e.prototype.findOption=function(e,t){for(var i=e.configOption.hardwareOptions.virtualDeviceOption,r=0,n=i;r<n.length;r++){var o=n[r];if(o.type.wsdlName===t)return o}},e.prototype.getNvdimmController=function(t){var i=t.devicesOfType(e.NVDIMM_CONTROLLER);if(i.length)return i[0]},e.prototype.getPmemStorageProfile=function(e){for(var t=0,i=e;t<i.length;t++){var r=i[t];if(this.isPMemStoragePolicy(r))return r}},e.prototype.isPMemStoragePolicy=function(t){if(!t||!t.profileObj)return!1;var i=t.profileObj;if(null===i)return!1;var r=i.constraints;if(!r||!r.subProfiles)return!1;for(var n=0,o=r.subProfiles;n<o.length;n++){var a=o[n];if(a&&a.capability)for(var s=0,c=a.capability;s<c.length;s++){var l=c[s];if(l&&l.id&&l.id.namespace&&l.id.namespace.toLowerCase()===e.PMEM_NAMESPACE_LOWERCASE)return!0}}return!1},e.prototype.getAvailablePmemCapacity=function(e){return e.environment.configTarget.availablePersistentMemoryReservationMB},e.prototype.getSupportedPmemByGuestOs=function(e){return e.supportedMaxPersistentMemoryMB},e.prototype.isPmemDisk=function(e){if(!e||!e.backing)return!1;var t=e.backing;return"com.vmware.vim.binding.vim.vm.device.VirtualDisk$LocalPMemBackingInfo"===t._type},e.prototype.filterOutPmemProfileIfNeeded=function(e,t,i){return this.shouldFilterOutPmemStoragePolicy(t,i)?this.filterOutPmemStoragePolicy(e):e},e.prototype.filterOutPmemStoragePolicy=function(e){var t=this;return e&&0!==e.length?_.filter(e,function(e){return!t.isPMemStoragePolicy(e)}):e},e.prototype.shouldFilterOutPmemStoragePolicy=function(e,t){var i="poweredOn"===e.environment.powerState;return!(!t.isRDMDisk()&&!t.isCreatedFromExistingDisk())||(!(!i||!t.isNew())||!(i||t.isPmemDisk()||t.isNew()))},e.$inject=["featureFlagsService"],e.NVDIMM="VirtualNVDIMM",e.NVDIMM_CONTROLLER="VirtualNVDIMMController",e.PMEM_NAMESPACE_LOWERCASE="pmem",e}();e.PmemUtilService=t,angular.module("com.vmware.vsphere.client.vm").service("pmemUtilService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualDisk$LocalPMemBackingInfo,i=com.vmware.vim.binding.vim.vm.device.VirtualDisk$FlatVer2BackingInfo,r=function(){function e(e,t,i,r,n,o){this.pmemUtilService=e,this.pmemCapacityService=t,this.storageSelectorConstants=i,this.VirtualDisk=r,this.storageProfileService=n,this.diskProvisioningService=o}return e.prototype.getDefaultMinValueForNewPmemDisk=function(){return e.DEFAULT_MIN_VALUE_FOR_NEW_PMEM_DISK},e.prototype.handlePmemIfPmemProfile=function(e,t,i){var r=e.isPmemDisk(),n=this.pmemUtilService.isPMemStoragePolicy(t);if(r&&n)return!0;if(!r&&n)return this.setPmemBacking(e),!0;if(!r&&!n)return!1;if(r&&!n&&e.isNew())return e.restoreOriginalBacking(),!1;if(r&&!n&&!e.isNew()){var o=e.getCurrentDevice().backing.fileName;return this.setFlatDiskBacking(e),e.getCurrentDevice().backing.fileName=o,this.setDiskFormat(e,i),!1}return!1},e.prototype.shouldApplyPmemProfileToDisk=function(e,t){return!e.isStorageProfileManuallySet()&&(!(!e.isPmemDisk()||this.storageSelectorConstants.HYBRID_STORAGE_BASELINE.id!==t)||this.storageSelectorConstants.PMEM_STORAGE_BASELINE.id===t)},e.prototype.filterVirtualDisksToDiskLocatorsForPmem=function(e,t,i){return void 0===i&&(i=!1),t===this.storageSelectorConstants.STANDARD_STORAGE_BASELINE.id?i?this.filterOutPmemDisks(e):e:t===this.storageSelectorConstants.HYBRID_STORAGE_BASELINE.id?this.filterOutPmemDisks(e):t===this.storageSelectorConstants.PMEM_STORAGE_BASELINE.id?i?this.filterOutPmemDisks(e):[]:e},e.prototype.filterVirtualDisksToDiskLocatorsForPmemAdvanced=function(e,t){var i=this;return _.filter(e,function(e){var r=i.findAdvancedConfigurationForDisk(e.key,t);return!r||!i.pmemUtilService.isPMemStoragePolicy(r.storageProfile)})},e.prototype.applyPmemRulesOnVirtualDiskBacking=function(e,t,i){return t!==this.storageSelectorConstants.STANDARD_STORAGE_BASELINE.id&&t!==this.storageSelectorConstants.HYBRID_STORAGE_BASELINE.id||!this.pmemUtilService.isPmemDisk({backing:e})?e:this.diskProvisioningService.getBackingInfo(i.type)},e.prototype.applyPmemRulesOnVirtualDiskBackingAdvanced=function(e,t,i){var r=this.findAdvancedConfigurationForDisk(e,i);return r&&!this.pmemUtilService.isPMemStoragePolicy(r.storageProfile)&&this.pmemUtilService.isPmemDisk({backing:t})?this.diskProvisioningService.getBackingInfo(r.diskFormat.type):t},e.prototype.convertVirtualDiskToDeviceChangeForPmem=function(e,t,i){if(!(this.pmemUtilService.isPmemDisk(e)||!this.pmemUtilService.isPMemStoragePolicy(i)||t&&t!==this.storageSelectorConstants.PMEM_STORAGE_BASELINE.id))return this.convetVirtualDiskToDeviceChangeInternal(e,i)},e.prototype.convertVirtualDiskToDeviceChangeForPmemAdvanced=function(e,t){var i=this.findAdvancedConfigurationForDisk(e.key,t),r=i.storageProfile;if(!this.pmemUtilService.isPmemDisk(e)&&this.pmemUtilService.isPMemStoragePolicy(r))return this.convetVirtualDiskToDeviceChangeInternal(e,r)},e.prototype.getPmemDiskInfo=function(e){var t=e?e.storageBaselineId:"";switch(t){case this.storageSelectorConstants.PMEM_STORAGE_BASELINE.id:return{hasPmemDisk:!0,hasRegularDisk:!1,hasDowngradedPmemDisk:!1};case this.storageSelectorConstants.HYBRID_STORAGE_BASELINE.id:return{hasPmemDisk:!0,hasRegularDisk:!0,hasDowngradedPmemDisk:!1};case this.storageSelectorConstants.STANDARD_STORAGE_BASELINE.id:if(e.vmStorageConfigInAdvancedMode&&e.vmStorageConfigInAdvancedMode[0]&&e.vmStorageConfigInAdvancedMode[0].vmDisks){var i=!!this.advancedConfigurationForDiskHasPmemDisk(e.vmStorageConfigInAdvancedMode[0].vmDisks);return{hasPmemDisk:!1,hasRegularDisk:!0,hasDowngradedPmemDisk:i}}return{hasPmemDisk:!1,hasRegularDisk:!0,hasDowngradedPmemDisk:!1};default:return{hasPmemDisk:!1,hasRegularDisk:!1,hasDowngradedPmemDisk:!1}}},e.prototype.getMaxAllowedCapacity=function(e,t,i){return this.pmemCapacityService.getMaxCapacityForPmemDisk(e,t,i)},e.prototype.setPmemBacking=function(e){e.getCurrentDevice().backing=this.generateDefaultPmemBacking()},e.prototype.setFlatDiskBacking=function(e){e.getCurrentDevice().backing=this.generateDefaultFlatVer2Backing()},e.prototype.filterOutPmemDisks=function(e){var t=this;return _.filter(e,function(e){return!t.pmemUtilService.isPmemDisk(e)})},e.prototype.findAdvancedConfigurationForDisk=function(e,t){return _.find(t,function(t){return t.key===e})},e.prototype.advancedConfigurationForDiskHasPmemDisk=function(e){var t=this;return!!e.length&&_.find(e,function(e){return t.pmemUtilService.isPMemStoragePolicy(e.storageProfile)})},e.prototype.convetVirtualDiskToDeviceChangeInternal=function(e,t){var i=new this.VirtualDisk(e);this.setPmemBacking(i);var r=i.getCurrentDeviceSpec();return r.fileOperation="create",r.operation="add",r.profile=[this.storageProfileService.makeProfile(t.id)],r},e.prototype.generateDefaultPmemBacking=function(){var e=new t;return e.diskMode="persistent",e.fileName="",e},e.prototype.generateDefaultFlatVer2Backing=function(){var e=new i;return e.diskMode="persistent",e.fileName="",e},e.prototype.setDiskFormat=function(e,t){if(e.getCurrentDevice().backing&&t){var i=this.diskProvisioningService.backingInfoKeys(t.type);angular.extend(e.getCurrentDevice().backing,i)}},e.$inject=["pmemUtilService","pmemCapacityService","storageSelectorConstants","VirtualDisk","storageProfileService","diskProvisioningService"],e.DEFAULT_MIN_VALUE_FOR_NEW_PMEM_DISK=1,e}();e.VirtualDiskPmemService=r,angular.module("com.vmware.vsphere.client.vm").service("virtualDiskPmemService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){!function(e){e[e.MB=0]="MB",e[e.GB=1]="GB",e[e.TB=2]="TB"}(e.SizeUnits||(e.SizeUnits={}));var t=e.SizeUnits,i=function(){function e(){this.unit=t.MB}return e}();e.DiskSize=i;var r=function(){function e(e){this.i18nService=e,this.SIZE_DENOMINATOR=1024,this.SIZE_REQUIRES_CONVERSION=1024}return e.prototype.roundToPrecision=function(e,t){var i=Math.pow(10,t);return Math.round(e*i)/i},e.prototype.determineDisplayDiskSize=function(e){var r=new i;return e<=this.SIZE_REQUIRES_CONVERSION?r.size=e:(r.size=e/this.SIZE_DENOMINATOR,r.unit=t.GB,r.size>this.SIZE_REQUIRES_CONVERSION&&(r.size=r.size/this.SIZE_DENOMINATOR,r.unit=t.TB)),r.unitText=this.i18nService.getString("VmUi","Vm.Units."+t[r.unit]),r},e.$inject=["i18nService"],e}();e.BasicDiskUtilService=r,angular.module("com.vmware.vsphere.client.vm").service("basicDiskUtilService",r)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o){function a(t){var r=i.getPartsFromVsphereObjectId(t).serverGuid,n=i.createVmomiUri("Folder","group-d1",r);return e.getProperties(n,["libraryTemplates"])}function s(t){return e.getProperties(t,["com.vmware.content.library.ItemModel/name","com.vmware.content.library.ItemModel/libraryName","com.vmware.content.type.ovf.OvfTemplate/vmTemplate/osType","com.vmware.content.type.ovf.OvfTemplate/vmTemplate/osDescription"])}function c(t,r,n,o,a,s){var c=i.getManagedObjectReference(t),l=null;r&&(l=i.getManagedObjectReference(r)),"ResourcePool"===c.type||"VirtualApp"===c.type?e.getProperties(t,["computeResource"]).then(function(t){return e.getProperties(i.getVsphereObjectId(t.computeResource),["network"])}).then(function(){D(c,l,c,n,o,a,s)}):e.getProperties(t,["network"]).then(function(){return w(t)}).then(function(e){D(e.resourcePool,l,c,n,o,a,s)})}function l(e,t,r,n,o,a){var s=i.getManagedObjectReference(e),c=null;return t&&(c=i.getManagedObjectReference(t)),"ResourcePool"===s.type||"VirtualApp"===s.type?u(s,c,s,r,n,o,a):w(e).then(function(e){return u(e.resourcePool,c,s,r,n,o,a)})}function d(e){var i={name:null,inOvfMode:!1,inVmMode:!0,parameters:null,vmFolder:null,host:null,resourcePool:null};return t.validate(e,A,i)}function u(e,t,r,o,a,s,c){_.isEmpty(s)&&(s="CONTENT_LIBRARY_SOURCE");var l=s===n.SOURCE_TYPE_PUSH,d=h(r,o,a,e,t,s);"HostSystem"===r.type&&(d.host=_.extend({_type:R},r));var u=i.getVsphereObjectId(e);return l?p(c,d,e):v(u,d)}function p(e,r,a){var s=e?n.PUSH_TYPE_OVF:void 0,c=e?f(e):void 0;r.pushContentType=s,r.pushOvfOption=c;var l=encodeURIComponent(e.descriptor.name);r.template="file:///"+l;var d={deploymentSpec:r},u=i.getVsphereObjectId(a),p=e.sessionId;return t.validate(u,O,d).then(function(e){var t=e.result,i=o.get("vscOvfWorkflowProxyService");return g(i,t,p,r),i.uploadDescriptorWithAccessories$(p).then(function(){var e=i.getSession(p);return e&&!_.isEmpty(e.messages)?m(u,p,r):v(u,r)})})}function v(e,i){return t.validate(e,M,i)}function m(e,i,n){var a={commonContext:n.commonContext,sourceType:n.sourceType};return t.validate(e,$,a).then(function(t){if(t&&t.result){var a=t.result,s=o.get("vscOvfWorkflowProxyService");return g(s,a,i,n),s.uploadMessages$(i).then(function(){return v(e,n)})}return r.reject()})}function g(e,t,i,r){r.commonContext=t.newContext;var n=t.descriptorURI;e.mapDescriptorUrl(i,n);var o=_.find(t.newContext,function(e){return e._type===F});o=o&&o.sessionId?o.sessionId:"",e.mapDeployOvfSessionId(i,o);var a=t.manifestURI;a&&0!==a.length&&e.mapManifestUrl(i,a);var s=t.certificateURI;s&&0!==s.length&&e.mapCertificateUrl(i,s);var c=t.messagesURI;c&&!_.isEmpty(c)&&e.mapMessageUrls(i,c)}function h(e,t,i,r,n,o){return{commonContext:[{_type:"com.vmware.vsphere.client.provisioning.workflow.Workflow",id:"deployVmOnResourcePool",contextObject:e}],name:t,template:i,provisioningTarget:_.extend({_type:R},r),folder:n,sourceType:o}}function f(e){return e?e.certificate&&e.manifest?n.PUSH_OVF_OPTION_MFCERT:e.manifest?n.PUSH_OVF_OPTION_MF:n.PUSH_OVF_OPTION_NONE:n.PUSH_OVF_OPTION_NONE}function S(e,i,r){var n="com.vmware.vcenter.ovf.DatastoreMappingParams",o=P(r,[n]),a=b(i,o);return t.validate(e,k,a).then(function(e){return e.result&&e.result.commonContext&&(e.result.commonContext=C(r,e.result.commonContext,[n])),e})}function y(e,t){return _.find(t,function(t){return t===e._type})}function P(e,t){return _.filter(e,function(e){return y(e,t)})}function C(e,t,i){return _.map(e,function(e){return y(e,i)?_.find(t,function(t){return t._type===e._type}):e})}function D(e,i,r,n,a,s,c){var l={name:n,inOvfMode:_.isUndefined(s)?null:s,inVmMode:!0,parameters:a,vmFolder:i,host:"HostSystem"===r.type?r:null,resourcePool:e};t.add(A,l).then(function(e){if(c&&e&&e.result){var t=o.get("vscOvfWorkflowProxyService"),i=c.sessionId,r=[];_.each(e.result.fileByUri,function(e,t){r.push(e)}),r.length>0&&(t.mapOtherUrls(i,r),t.uploadOtherFiles$(i))}})}function w(t){var n=i.getEntityType(t),o=i.getManagedObjectReference(t);return"ResourcePool"===n||"VirtualApp"===n?r.when({resourcePool:o}):e.getProperties(t,["resourcePool"])}function b(e,t){return _.each(e,function(e){var t=I(e.targetProvisioningType);e.targetProvisioningType=t||"thick"}),{commonContext:t,diskGroups:e}}function I(e){return"flat"===e?"thick":"thick"===e?"eagerZeroedThick":e}function T(t){return e.getProperties(t.id,[N])}function E(t){return e.getProperties(L,[U],{propertyParams:[{propertyName:U,parameterType:"java.lang.String",parameter:t}]})}function V(e,i,r){return t.validate(e,x,{info:i,spec:r})}var M="com.vmware.vsphere.client.provisioning.spec.DeployOnResourcePoolValidationSpec",O="com.vmware.vsphere.client.provisioning.spec.FileInfoValidationSpec",A="com.vmware.vsphere.client.provisioning.spec.DeployOnResourcePoolSpec",k="com.vmware.vsphere.client.provisioning.ovf.spec.StorageValidationSpec",R="com.vmware.vim.binding.vmodl.ManagedObjectReference",N="contentLibraryItemByItemId",U="contentLibraryItemByDatastorePath",L="urn:vapi:com.vmware.content.library.Item:6a0aea7f-2222-2222-2222-b7cf1ad937f3:6a0aea7f-2222-2222-2222-b7cf1ad937f3",F="com.vmware.vsphere.client.provisioning.ovf.impl.ResourcePoolDeploySession",x="com.vmware.vsphere.client.vm.VmCustomizationSpecification",$="com.vmware.vsphere.client.provisioning.spec.MessagesValidationSpec";return{getAllTemplates:a,getTemplateData:s,deployVmFromLibraryTemplate:c,getAndValidateResourcePool:l,validateComputeResourceSelection:d,getResourcePoolForComputeResource:w,validateStorageSelection:S,getContentLibraryItemWithIso:T,getContentLibraryItemByDatastorePath:E,getXmlFormattedCustomizationSpec:V,SYSTEM_DISK_GROUP_ID:"ngcArtificialSystemDiskGroup",SYSTEM_DISK_GROUP_LABEL:"All other disks"}}angular.module("com.vmware.vsphere.client.vm").service("contentLibraryService",e),e.$inject=["dataService","mutationService","defaultUriSchemeUtil","$q","sourceTypeConstants","$injector"]}(),angular.module("com.vmware.vsphere.client.vm").service("deviceDiffService",[function(){function e(i,r){if(!_.isObject(i)||!_.isObject(r))throw new Error("isUnchanged only works with objects");var n=_.keys(r),o=_.keys(i),a=_.difference(n,o);if(a&&a.length>0)return!1;var s=!1;return _.each(n,function(n){var o=r[n],a=i[n];t(a,o)?e(a,o)||(s=!0):o!==a&&(s=!0)}),!s}function t(e,t){return _.isObject(t)&&_.isObject(e)}return{isUnchanged:e}}]);var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.ft.VmTurnOffFtSpec,i="com.vmware.vsphere.client.vm.model.VmFtCompatibilityData",r=function(){function e(e,t,i,r){this.i18nService=e,this.mutationService=t,this.actionConfirmationService=i,this.dataService=r}return e.prototype.turnOffFt=function(e){var r=this;this.dataService.getData(e,i).then(function(i){var n=r.getManagedByWarningText(i.managedByInfo),o=r.i18nService.getString("VmUi","ftTurnOffAction.warning");i.clusterData.isDrsEnabled&&!i.clusterData.isEvcEnabled&&(o=r.i18nService.getString("VmUi","ftTurnOffAction.drsWarning")),""!==n&&(o=n+"\n\n"+o),r.actionConfirmationService.showConfirmationDialog({title:r.i18nService.getString("VmUi","ftTurnOffAction.label"),message:o,yesHandler:function(){var i=new t;r.mutationService.apply(e,i._type,i)},useClarity:!0})})},e.prototype.getManagedByWarningText=function(e){if(null===e)return"";var t=_.map(e,function(e){return null===e||e.isUnset?null!==e?e:void 0:e.value});if(_.isEmpty(t))return"";var i=e.length>1?this.i18nService.getString("Common","multiVmManagedByWarning"):this.i18nService.getString("Common","singleVmManagedByWarning",t[0]);return i},e.$inject=["i18nService","mutationService","actionConfirmationService","dataService"],e}();e.VmFtService=r,angular.module("com.vmware.vsphere.client.vm").service("vmFtService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.$rootScope=e,this.i18nService=t,this.mutationService=i,this.defaultUriSchemeUtil=r,this.vuiConstants=n,this.vuiFtTurnOnWizard=o,this.vmFtConstants=a,this.VIRTUAL_DEVICE_TYPE="com.vmware.vim.binding.vim.vm.device.VirtualDisk"}return e.prototype.buildSelectDatastoresPage=function(e){var t=this;return{title:this.i18nService.getString("VmUi","turnOnFtWizard.selectDatastoresPage.title"),description:this.i18nService.getString("VmUi","turnOnFtWizard.selectDatastoresPage.description"),contentUrl:"vm-ui/resources/vm/views/ft/ftSelectDatastoresView.html",onCommit:function(){var i=!0;return e.manager.getIsAdvancedMode()?e.manager.validateSelectedDatastores()?e.manager.getNoHostsCompatible()?(t.vuiFtTurnOnWizard.markPageIncompleteWithError(t.i18nService.getString("VmUi","turnOnFtWizard.error.noHostsForDatastoreSelection")),i=!1):t.vuiFtTurnOnWizard.markPageComplete():(t.vuiFtTurnOnWizard.markPageIncompleteWithError(t.i18nService.getString("VmUi","turnOnFtWizard.error.incompleteDatastoreSelection")),i=!1):e.manager.getSelectedDatastore()?e.manager.getNoHostsCompatible()?(t.vuiFtTurnOnWizard.markPageIncompleteWithError(t.i18nService.getString("VmUi","turnOnFtWizard.error.noHostsForDatastoreSelection")),i=!1):t.vuiFtTurnOnWizard.markPageComplete():(t.vuiFtTurnOnWizard.markPageIncompleteWithError(t.i18nService.getString("VmUi","turnOnFtWizard.error.incompleteDatastoreSelection")),i=!1),i},disableNext:function(){return e.wizardConfig.loading}}},e.prototype.buildSelectHostPage=function(e){var t=this;return{title:this.i18nService.getString("VmUi","turnOnFtWizard.selectHostPage.title"),description:this.i18nService.getString("VmUi","turnOnFtWizard.selectHostPage.description"),contentUrl:"vm-ui/resources/vm/views/ft/ftSelectHostView.html",onCommit:function(){var i=e.manager.getSelectedHost(),r=t.hasHostAnyErrors(i);return i&&!r?(t.vuiFtTurnOnWizard.markPageComplete(),!0):(i?r&&t.vuiFtTurnOnWizard.markPageIncompleteWithError(t.i18nService.getString("VmUi","turnOnFtWizard.error.invalidHostSelected")):t.vuiFtTurnOnWizard.markPageIncompleteWithError(t.i18nService.getString("VmUi","turnOnFtWizard.error.noHostSelected")),!1)},disableNext:function(){return e.wizardConfig.loading}}},e.prototype.buildReadyToCompletePage=function(e){var t=this;return{title:this.i18nService.getString("VmUi","turnOnFtWizard.summaryPage.title"),description:this.i18nService.getString("VmUi","turnOnFtWizard.summaryPage.description"),contentUrl:"vm-ui/resources/vm/views/ft/ftReadyToCompleteView.html",onCommit:function(){var i=e.manager,r=i.getTargetUid();return t.mutationService.apply(r,"com.vmware.vsphere.client.vm.ft.VmCreateSecondarySpec",t.getVmCreateSecondarySpec(i)),
!0},finishReady:function(){return!e.wizardConfig.loading}}},e.prototype.getVmCreateSecondarySpec=function(e){var t=this,i=this.defaultUriSchemeUtil.getManagedObjectReference(e.getSelectedHost().id);return{host:i,configSpec:{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceConfigSpec",metaDataPath:{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceMetaSpec",metaDataDatastore:e.getSelectedDatastores()[this.vmFtConstants.fileTypes.TIE_BREAKER].provider},secondaryVmSpec:{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceVMConfigSpec",vmConfig:e.getSelectedDatastores()[this.vmFtConstants.fileTypes.CONFIGURATION].provider,disks:_.map(this.getAvailableDevices(e.getDevices()),function(i){return{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceVMConfigSpec$FaultToleranceDiskSpec",disk:i,datastore:e.getSelectedDatastores()[t.vmFtConstants.fileTypes.VIRTUAL_DISK+i.key].provider}})}}}},e.prototype.hasHostAnyErrors=function(e){return e&&e.errors&&e.errors.length>0},e.prototype.getAvailableDevices=function(e){var t=this;return _.filter(e,function(e){return e._type===t.VIRTUAL_DEVICE_TYPE})},e.$inject=["$rootScope","i18nService","mutationService","defaultUriSchemeUtil","vuiConstants","vuiFtTurnOnWizard","vmFtConstants"],e}();e.FtVmPageService=t,angular.module("com.vmware.vsphere.client.vm").service("ftVmPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.ft.VmEnableSecondarySpec,i=com.vmware.vsphere.client.vm.ft.VmDisableSecondarySpec,r=com.vmware.vsphere.client.vm.ft.VmRestartSecondarySpec,n=com.vmware.vsphere.client.vm.ft.VmTestFailoverSpec,o=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){this.$rootScope=e,this.$injector=t,this.dataService=i,this.clarityModalService=r,this.i18nService=n,this.ftVmWizardService=o,this.FtVmTurnOnManager=a,this.defaultUriSchemeUtil=s,this.vuiConstants=c,this.columnRenderersRegistry=l,this.mutationService=d,this.vmFtConstants=u,this.migrateVmWizardService=p,this.taskConstants=v,this.powerOpsService=m,this.ERROR_ICON="vx-icon-error",this.WARNING_ICON="vx-icon-warn",this.HOST_ICON="vsphere-icon-host",this.VM_ICON="vsphere-icon-vm",this.HOST_SYSTEM_TYPE="HostSystem",this.VM_TYPE="VirtualMachine",this.VIRTUAL_DEVICE_TYPE="com.vmware.vim.binding.vim.vm.device.VirtualDisk"}return e.prototype.getAvailableDevices=function(e){var t=this;return _.filter(e,function(e){return e._type===t.VIRTUAL_DEVICE_TYPE})},e.prototype.openVmFaultToleranceWizard=function(e){var t=this,i=new this.FtVmTurnOnManager;this.validateFaultToleranceTurnOn(e).then(function(r){if(r){var n=r.ftCompatibilityResult,o=r.ftCompatibleDatastores,a=r.devices;if(i.setCompatibleDatastores(o),i.setMetaCompatibleDatastores(r.ftMetaCompatibleDatastores),i.setConfigCompatibleDatastores(r.ftConfigCompatibleDatastores),i.setDevices(a),i.setDatacenter(r.datacenter),n.errors&&n.errors.length>0){var s=t.getAllIssues(n),c=t.getErrorsWarningModalOptions(e,!0,s,i);t.clarityModalService.openOkCancelModal(c)}else if(n.warnings&&n.warnings.length>0){var s=t.createErrorWarningArray(n.warnings,!1),c=t.getErrorsWarningModalOptions(e,!1,s,i);t.clarityModalService.openOkCancelModal(c)}else t.ftVmWizardService.invokeWizard(e,i)}})},e.prototype.convertCompatibleHostsIntoMap=function(e){var t=this,i={};return _.each(e,function(e){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e.ftHost);i[r]={errors:e.errors,warnings:e.warnings}}),i},e.prototype.generateValidationMessages=function(e,t){var i=t[e.id],r=_.map(i.errors,function(e){return{type:"Error",text:e.localizedMessage}}),n=_.map(i.warnings,function(e){return{type:"Warning",text:e.localizedMessage}}),o=r.concat(n);return o},e.prototype.createSecondaryVmSpecParameter=function(e,t){var i=this;return{propertyParams:[{propertyName:"ftCompatibleHosts",parameterType:"com.vmware.vim.binding.vim.vm.FaultToleranceConfigSpec",parameter:{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceConfigSpec",metaDataPath:{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceMetaSpec",metaDataDatastore:e.getSelectedDatastores()[this.vmFtConstants.fileTypes.TIE_BREAKER].provider},secondaryVmSpec:{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceVMConfigSpec",vmConfig:e.getSelectedDatastores()[this.vmFtConstants.fileTypes.CONFIGURATION].provider,disks:_.map(t,function(t){return{_type:"com.vmware.vim.binding.vim.vm.FaultToleranceVMConfigSpec$FaultToleranceDiskSpec",disk:t,datastore:e.getSelectedDatastores()[i.vmFtConstants.fileTypes.VIRTUAL_DISK+t.key].provider}})}}}]}},e.prototype.getSelectDatastoreGridOptions=function(e){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,resizable:!0,selectedItems:[],data:e,columnDefs:this.getSelectDatastoreColumnDefs(),height:"100%",pageConfig:{hidePager:!0}}},e.prototype.getAdvancedDatastoreGridOptions=function(){return{height:"100%",resizable:!0,columnDefs:this.getAdvancedColumnDefs(),data:[],pageConfig:{hidePager:!0},searchable:!1,selectedItems:[]}},e.prototype.getErrorPageGridOptions=function(e){return{selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,sortMode:this.vuiConstants.grid.sortMode.SINGLE,resizable:!0,selectedItems:[],data:e,columnDefs:this.getErrorPageColumnDefs(),height:"300px",pageConfig:{hidePager:!0}}},e.prototype.getFtHostsIds=function(e){var t=this;return _.map(e,function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.ftHost)})},e.prototype.getCompatibilityResultMessages=function(e){var t=this,i={};return _.each(e,function(e){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e.ftHost);e.errors&&e.errors.length>0&&_.each(e.errors,function(e){i.hasOwnProperty(r)?i[r].errorMessages.push(e.localizedMessage):i[r]={icon:"vx-icon-host",errorMessages:[e.localizedMessage]}})}),i},e.prototype.migrateSecondaryFtVm=function(e){var t=this,i="config/ftInfo";this.dataService.getProperties(e,[i]).then(function(e){if(e[i]&&e[i].secondaries&&e[i].secondaries[0]){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e[i].secondaries[0]);t.migrateVmWizardService.showWizard([r])}})},e.prototype.hasFtHostWithoutErrors=function(e){return _.some(e,function(e){return!e.errors||0===e.errors.length})},e.prototype.ftTestFailover=function(e){var t=new n;this.mutationService.apply(e,t._type,t)},e.prototype.ftRestartSecondary=function(e){var t=new r;this.mutationService.apply(e,t._type,t)},e.prototype.suspendFaultTolerance=function(e){var t=new i;this.mutationService.apply(e,t._type,t)},e.prototype.resumeFaultTolerance=function(e){var i=this,r=new t;this.mutationService.apply(e,r._type,r).then(function(e){i.processFaultToleranceOpResult(e)})},e.prototype.processFaultToleranceOpResult=function(e){var t=this;e&&e.taskUid&&this.dataService.getProperties(e.taskUid,["info"]).then(function(e){t.onTaskInfoRetrieved(e)})},e.prototype.onTaskInfoRetrieved=function(e){if(e&&e.info&&e.info.result&&e.info.result.vm&&e.info.result.powerOnAttempted&&e.info.result.powerOnResult){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.info.result.vm);this.powerOpsService.showPowerOnFailuresAndRecommendationsDialog([{result:e.info.result.powerOnResult}],[t])}},e.prototype.getSelectDatastoreColumnDefs=function(){var e=this,t=[{displayName:this.i18nService.getString("Common","StorageLocatorControl.NameColumnHeader"),width:200,template:this.iconNameRendererFactory("name","vsphere-icon-datastore")},{field:"compatibility",displayName:this.i18nService.getString("Common","StorageLocatorControl.CompatibilityColumnHeader"),width:110,visible:!1},{field:"capacity",displayName:this.i18nService.getString("Common","StorageLocatorControl.CapacityColumnHeader"),type:"number",width:110,template:"#:capacityFormatted#"},{field:"provisionedSpace",displayName:this.i18nService.getString("Common","StorageLocatorControl.ProvisionedSpaceColumnHeader"),width:110,type:"number",template:"#:provisionedSpaceFormatted#"},{field:"freeSpace",displayName:this.i18nService.getString("Common","StorageLocatorControl.FreeSpaceColumnHeader"),type:"number",width:110,template:"#:freeSpaceFormatted#"},{field:"type",displayName:this.i18nService.getString("Common","StorageLocatorControl.TypeColumnHeader"),width:110},{displayName:this.i18nService.getString("Common","StorageLocatorControl.StoragePodColumnHeader"),width:200,template:this.iconNameRendererFactory("parentPodName","vsphere-icon-datastore-cluster")},{field:"storageDRS",displayName:this.i18nService.getString("Common","StorageLocatorControl.StorageDrsColumnHeader"),width:110,template:function(t){var i="";return _.isUndefined(t.storagePodEnabled)||(i=t.storagePodEnabled?e.i18nService.getString("VmUi","enabled"):e.i18nService.getString("VmUi","disabled")),i}},{displayName:this.i18nService.getString("Common","StorageLocatorControl.ThinProvisioningColumnHeader"),width:110,template:function(t){return t.isThinProvisioningSupported?e.i18nService.getString("VmUi","VmDatastore.ThinSupported"):e.i18nService.getString("VmUi","VmDatastore.ThinUnsupported")}},{displayName:this.i18nService.getString("Common","StorageLocatorControl.AccessColumnHeader"),width:110,template:function(t){return t.multipleHostAccess?e.i18nService.getString("VmUi","datastore.access.multiple"):e.i18nService.getString("VmUi","datastore.access.single")}},{displayName:this.i18nService.getString("Common","StorageLocatorControl.HardwareAccelerationColumnHeader"),width:110,template:function(t){var i={vStorageSupported:e.i18nService.getString("VmUi","RawDisk.vStorageSupported"),vStorageUnknown:e.i18nService.getString("VmUi","RawDisk.vStorageUnknown"),vStorageUnsupported:e.i18nService.getString("VmUi","RawDisk.vStorageUnsupported")};return i[t.vStorageSupport]}}];return t},e.prototype.getAdvancedColumnDefs=function(){var e=this,t=this.i18nService.getString("Common","DiskLocatorControl.Browse");return[{displayName:this.i18nService.getString("Common","DiskLocatorControl.Vm"),width:180,field:"vmName",type:"string",template:this.i18nService.getString("Common","secondaryVmFormat","#:vmName#"),sortable:!0},{displayName:this.i18nService.getString("Common","DiskLocatorControl.File"),width:180,field:"fileName",type:"string",template:function(t){return t.itemType===e.vmFtConstants.fileTypes.TIE_BREAKER?e.i18nService.getString("Common","DiskLocatorControl.fileType.ftMetaInf"):t.itemType===e.vmFtConstants.fileTypes.CONFIGURATION?e.i18nService.getString("Common","DiskLocatorControl.fileType.configuration"):t.fileName},sortable:!0},{displayName:this.i18nService.getString("Common","DiskLocatorControl.Storage"),width:180,template:function(e){return'\n                  <div class="select">\n                    <select ng-model="dataItem.storageItemId"\n                          ng-click="dataItem.onDatastoreComboClick($event, dataItem)"\n                          ng-change="dataItem.onDatastoreChange(dataItem)"\n                          ng-options="option.id as option.label for option in dataItem.storageItems">\n                        <option value="" disabled style="display: none">'+t+"</option>\n                     </select>\n                  </div>"}}]},e.prototype.iconNameRendererFactory=function(e,t){var i=this;return function(r){var n=i.columnRenderersRegistry.getColumnRenderer("object-link");return n([void 0,e,t],r)}},e.prototype.getErrorsWarningModalOptions=function(e,t,i,r){var n=t?this.i18nService.getString("VmUi","FtFaultDetailsPopUp.okButtonText"):this.i18nService.getString("VmUi","FtFaultDetailsPopUp.noButtonText"),o=t?this.i18nService.getString("VmUi","turnOnFtWizard.error.hasWorkflowBreakingErrors"):this.i18nService.getString("VmUi","turnOnFtWizard.error.hasWorkflowWideWarnings");return{title:this.i18nService.getString("VmUi","FtFaultDetailsPopUp.title"),contentTemplate:"vm-ui/resources/vm/views/ft/ftErrorsWarningView.html",submitButtonTitle:this.i18nService.getString("VmUi","FtFaultDetailsPopUp.yesButtonText"),closeButtonTitle:n,hideSubmitButton:t,size:"lg",dialogData:{allIssuesArray:i,errorText:o,objectId:e,manager:r},defaultButton:"close"}},e.prototype.getAllIssues=function(e){var t=this.createErrorWarningArray(e.errors,!0),i=this.createErrorWarningArray(e.warnings,!1),r=t.concat(i);return r},e.prototype.createErrorWarningArray=function(e,t){var i=this;return _.map(e,function(e){var r,n="";t?(r=i.ERROR_ICON,n=i.i18nService.getString("VmUi","FtFaultDetailsList.faultTypeError")):(r=i.WARNING_ICON,n=i.i18nService.getString("VmUi","FtFaultDetailsList.faultTypeWarning"));var o="";return e.entity&&(e.entity.type===i.HOST_SYSTEM_TYPE?o=i.HOST_ICON:e.entity.type===i.VM_TYPE&&(o=i.VM_ICON)),_.extend({issueIconClass:r,entityIconClass:o,faultTypeLocalizedMessage:n},e)})},e.prototype.validateFaultToleranceTurnOn=function(e){return this.dataService.getData(e,"com.vmware.vsphere.client.vm.impl.FtDatastoresInfo")},e.prototype.getErrorPageColumnDefs=function(){var e=this.columnRenderersRegistry.getColumnRenderer("icon-text");return[{displayName:this.i18nService.getString("VmUi","FtFaultDetailsList.faultType"),template:function(t){return e(["issueIconClass","faultTypeLocalizedMessage"],t)}},{displayName:this.i18nService.getString("VmUi","FtFaultDetailsList.entity"),template:function(t){return e(["entityIconClass","entityName"],t)}},{field:"localizedMessage",displayName:this.i18nService.getString("VmUi","FtFaultDetailsList.description")}]},e.$inject=["$rootScope","$injector","dataService","clarityModalService","i18nService","ftVmWizardService","FtVmTurnOnManager","defaultUriSchemeUtil","vuiConstants","columnRenderersRegistry","mutationService","vmFtConstants","migrateVmWizardService","taskConstants","powerOpsService"],e}();e.FtVmService=o,angular.module("com.vmware.vsphere.client.vm").service("ftVmService",o)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.prototype.setTargetUid=function(e){this.targetUid=e},e.prototype.getTargetUid=function(){return this.targetUid},e.prototype.setVmName=function(e){this.vmName=e},e.prototype.getVmName=function(){return this.vmName},e.prototype.setMetaCompatibleDatastores=function(e){this.compatibleMetaDatastores=e||[]},e.prototype.getMetaCompatibleDatastores=function(){return this.compatibleMetaDatastores},e.prototype.setConfigCompatibleDatastores=function(e){this.compatibleConfigDatastores=e||[]},e.prototype.getConfigCompatibleDatastores=function(){return this.compatibleConfigDatastores},e.prototype.setCompatibleDatastores=function(e){this.compatibleDatastores=e||[]},e.prototype.getCompatibleDatastores=function(){return this.compatibleDatastores},e.prototype.setSelectedDatastore=function(e){this.selectedDatastore=e},e.prototype.getSelectedDatastore=function(){return this.selectedDatastore},e.prototype.setDevices=function(e){this.devices=e},e.prototype.getDevices=function(){return this.devices},e.prototype.setDatacenter=function(e){this.datacenter=e},e.prototype.getDatacenter=function(){return this.datacenter},e.prototype.setSelectedHost=function(e){this.selectedHost=e},e.prototype.getSelectedHost=function(){return this.selectedHost},e.prototype.setNoHostsCompatible=function(e){this.noHostsCompatible=e},e.prototype.getNoHostsCompatible=function(){return this.noHostsCompatible},e.prototype.setIsAdvancedMode=function(e){this.isAdvancedMode=e},e.prototype.getIsAdvancedMode=function(){return this.isAdvancedMode},e.prototype.setSelectedDatastores=function(e){this.selectedDatastores=e},e.prototype.getSelectedDatastores=function(){return this.selectedDatastores},e.prototype.validateSelectedDatastores=function(){return _.size(this.selectedDatastores)===this.numberOfVmFiles},e.prototype.setNumberOfVmFiles=function(e){this.numberOfVmFiles=e},e.$inject=[],e}();e.FtVmTurnOnManager=t,angular.module("com.vmware.vsphere.client.vm").factory("FtVmTurnOnManager",[function(){return Function.prototype.bind.apply(t,[void 0])}])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.$rootScope=e,this.dataService=t,this.vuiFtTurnOnWizard=i,this.ftVmPageService=r}return e.prototype.invokeWizard=function(e,t){var i=this;t.setTargetUid(e),this.wizardScope=this.$rootScope.$new();var r=this.createWizardPages(this.wizardScope,t);this.dataService.getProperties(e,["name"]).then(function(e){if(e&&e.name){var n=e.name;t.setVmName(n),i.vuiFtTurnOnWizard.show(r,i.wizardScope,t)}})},e.prototype.createWizardPages=function(e,t){var i=[];return i.push(this.ftVmPageService.buildSelectDatastoresPage(e)),i.push(this.ftVmPageService.buildSelectHostPage(e)),i.push(this.ftVmPageService.buildReadyToCompletePage(e)),i},e.$inject=["$rootScope","dataService","vuiFtTurnOnWizard","ftVmPageService"],e}();e.FtVmWizardService=t,angular.module("com.vmware.vsphere.client.vm").service("ftVmWizardService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.wizardPageService=e,this.vuiWizardService=t,this.$rootScope=i,this.i18nService=r,this.mutationService=n}return e.prototype.show=function(e,t,i){this.wizardConfig={title:this.i18nService.getString("VmUi","turnOnFtWizard.title2",i.getVmName()),pages:this.wizardPageService.initializePageStates(e),resizeMinHeight:500,onFinish:function(){return!0}},this.wizardScope=t,this.wizardScope.manager=i,this.wizardScope.wizardConfig=this.wizardConfig,this.vuiWizardService({scope:this.wizardScope,configObjectName:"wizardConfig"}).show()},e.prototype.markPageIncompleteWithError=function(e){this.wizardPageService.markPageIncompleteWithError(this.wizardConfig,e)},e.prototype.markPageComplete=function(e){this.wizardPageService.clearErrors(this.wizardConfig),this.wizardPageService.markPageComplete(this.wizardConfig,e)},e.$inject=["wizardPageService","vuiWizardService","$rootScope","i18nService","mutationService"],e}();angular.module("com.vmware.vsphere.client.vm").service("vuiFtTurnOnWizard",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.VENDOR_AMD="amd",e.VENDOR_OTHER="",e.CHAR_NX_SHOW="H",e.CHAR_NX_HIDE="0",e.CHAR_NOCHANGE="N",e.REG_USE_GOS="--------------------------------",e.NX_LEVEL=-2147483647,e.NX_CHAR_POS=11,e.CPUIDINFO_TYPE="com.vmware.vim.binding.vim.host.CpuIdInfo",e.OPERATION_ADD="add",e.OPERATION_EDIT="edit",e.OPERATION_REMOVE="remove",e.NXFLAG_NOTFOUND="notfound",e.NXFLAG_EXPOSED="exposed",e.NXFLAG_HIDDEN="hidden",e.NXFLAG_ADVANCED="advanced",e.NXFLAG_NOTAPPLICABLE="na",e}();e.CpuIdMaskConstants=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.host.CpuIdInfo,i=com.vmware.vim.binding.vim.vm.ConfigSpec$CpuIdInfoSpec,r=e.CpuIdMaskConstants,n=function(){function e(e,t){this.i18nService=e,this.$injector=t,this.NX_FLAG_NOTFOUND="notfound",this.EXPOSE_NX_FLAG_TO_GUEST=this.i18nService.getString("VmUi","CpuIdMask.exposed"),this.HIDE_NX_FLAG_FROM_GUEST=this.i18nService.getString("VmUi","CpuIdMask.hidden"),this.KEEP_NX_FLAG_ADVANCED=this.i18nService.getString("VmUi","CpuIdMask.advanced"),this.cpuIdMaskSettings=[this.HIDE_NX_FLAG_FROM_GUEST,this.EXPOSE_NX_FLAG_TO_GUEST],this.cpuIdMaskSettingsWithAdvanced=[this.HIDE_NX_FLAG_FROM_GUEST,this.EXPOSE_NX_FLAG_TO_GUEST,this.KEEP_NX_FLAG_ADVANCED],this.REG_EXP_ILLEGAL_CHARACTERS=/[^-01TFXHR]/g}return e.prototype.getCpuIdMaskSettingOptions=function(e){return void 0===e&&(e=!1),e?this.cpuIdMaskSettingsWithAdvanced:this.cpuIdMaskSettings},e.prototype.getCpuIdMaskSettingForVm=function(e){return this.isCpuIdMaskExposed(e)?this.EXPOSE_NX_FLAG_TO_GUEST:this.HIDE_NX_FLAG_FROM_GUEST},e.prototype.getCpuIdMaskFlagSelection=function(e){switch(e){case r.NXFLAG_EXPOSED:return this.EXPOSE_NX_FLAG_TO_GUEST;case r.NXFLAG_HIDDEN:return this.HIDE_NX_FLAG_FROM_GUEST;case r.NXFLAG_ADVANCED:}return this.KEEP_NX_FLAG_ADVANCED},e.prototype.determineCpuIdMaskFlag=function(e){var t=this.$injector.get("vscAdvancedCpuIdMaskService");return t.determineNxFlagStateFromConfigContext(e)},e.prototype.isCpuIdMaskExposed=function(e){var t,i;return t=this.hasCpuFeatureMaskInfo(e)?e.config.cpuFeatureMask[0]:e.environment.configOption.guestOSDescriptor[0].cpuFeatureMask[0],!!t.edx&&(i=this.stripIllegalCharacters(t.edx),i[r.NX_CHAR_POS]===r.CHAR_NX_SHOW)},e.prototype.updateCpuIdMaskSetting=function(e,t){var i;switch(e){case this.EXPOSE_NX_FLAG_TO_GUEST:i=r.CHAR_NX_SHOW;break;case this.HIDE_NX_FLAG_FROM_GUEST:i=r.CHAR_NX_HIDE;break;default:i="-"}this.updateMaskForVendor(t,i,r.VENDOR_AMD),this.updateMaskForVendor(t,i,r.VENDOR_OTHER)},e.prototype.updateMaskForVendor=function(e,t,i){var n;this.hasCpuFeatureMaskInfo(e)&&(n=this.getCpuIdInfoForVendor(i,e)),n=n||this.createCpuIdInfoForVendor(i,e),n.edx=n.edx||r.REG_USE_GOS,n.edx=this.updateRegisterWithFlag(n.edx,t)},e.prototype.getKeyForCpuIdInfo=function(e){var t=e.level.toString(),i=e.vendor||"";return t+i},e.prototype.isItemPresent=function(e,t){return!!e[t]},e.prototype.createCpuIdInfoDelta=function(e,t){var i,n=this,o=[],a={};_.each(e,function(e){a[n.getKeyForCpuIdInfo(e)]=e});var s=this.filterModifiedItems(t,a);_.each(s,function(e){i=n.isCpuIdInfoEmpty(e)?n.createCpuIdInfoSpecForOperation(e,r.OPERATION_REMOVE):n.createCpuIdInfoSpecForOperation(e,r.OPERATION_EDIT),o.push(i)});var c=_.difference(t,s);return _.each(c,function(e){n.isCpuIdInfoEmpty(e)||(i=n.createCpuIdInfoSpecForOperation(e,r.OPERATION_ADD),o.push(i))}),o},e.prototype.filterModifiedItems=function(e,t){var i=this;return _.isEmpty(e)?[]:e.filter(function(e){if(!i.isItemPresent(t,i.getKeyForCpuIdInfo(e)))return!1;var r=t[i.getKeyForCpuIdInfo(e)];return!_.isEqual(e,r)})},e.prototype.createCpuIdInfoSpecForOperation=function(e,r){var n=new i;return n.info=new t,n.info._type=e._type,n.info.vendor=e.vendor,n.info.eax=this.padForVmodl(e.eax),n.info.ebx=this.padForVmodl(e.ebx),n.info.ecx=this.padForVmodl(e.ecx),n.info.edx=this.padForVmodl(e.edx),n.info.level=e.level,n.operation=r,n},e.prototype.isCpuIdInfoEmpty=function(e){return!!(_.isEmpty(e.eax)&&_.isEmpty(e.ebx)&&_.isEmpty(e.ecx)&&_.isEmpty(e.edx))},e.prototype.updateRegisterWithFlag=function(e,t){var i=this.stripIllegalCharacters(e),n=i.substring(0,r.NX_CHAR_POS),o=i.substring(r.NX_CHAR_POS+1,i.length);return this.padForVmodl(n+t+o)},e.prototype.getCpuIdInfoForVendor=function(e,t){var i=_.find(t.config.cpuFeatureMask,function(t){return e===r.VENDOR_AMD?t.vendor===r.VENDOR_AMD:t.vendor!==r.VENDOR_AMD});return i},e.prototype.hasCpuFeatureMaskInfo=function(e){return!!(e.config.cpuFeatureMask&&e.config.cpuFeatureMask.length>0)},e.prototype.createCpuIdInfoForVendor=function(e,i){var n=new t;return n.eax=r.REG_USE_GOS,n.ebx=r.REG_USE_GOS,n.ecx=r.REG_USE_GOS,n.edx=r.REG_USE_GOS,n.level=r.NX_LEVEL,e===r.VENDOR_AMD&&(n.vendor=e),n._type=r.CPUIDINFO_TYPE,i.config.cpuFeatureMask.push(n),n},e.prototype.stripIllegalCharacters=function(e){if(_.isEmpty(e))return"";var t=e.toUpperCase();return t.replace(this.REG_EXP_ILLEGAL_CHARACTERS,"")},e.prototype.padForVmodl=function(e){if(_.isEmpty(e))return"";var t=this.stripIllegalCharacters(e);return t.substr(0,4)+" "+t.substr(4,4)+" "+t.substr(8,4)+" "+t.substr(12,4)+" "+t.substr(16,4)+" "+t.substr(20,4)+" "+t.substr(24,4)+" "+t.substr(28,4)},e.$inject=["i18nService","$injector"],e.NX_LEVEL="-2147483647",e}();e.CpuService=n,angular.module("com.vmware.vsphere.client.vm").service("cpuService",n)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.AUTOMATIC="automatic",e.SOFTWARE="software",e.HARDWARE_CPU="hardwareCpu",e.HARDWARE_CPU_MMU="hardwareCpuMmu",e.HV_AUTO="hvAuto",e.HV_OFF="hvOff",e.HV_ON="hvOn",e.OFF="off",e.ON="on",e}();e.CpuMmuConstants=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.CpuMmuConstants,i=function(){function e(e){this.i18nService=e,this.automatic=new r(t.AUTOMATIC,this.i18nService.getString("VmUi","CpuMmuVirt.Label.automatic")),this.software=new r(t.SOFTWARE,this.i18nService.getString("VmUi","CpuMmuVirt.Label.software")),this.hardwareCpu=new r(t.HARDWARE_CPU,this.i18nService.getString("VmUi","CpuMmuVirt.Label.hardwareCpu")),this.hardwareCpuMmu=new r(t.HARDWARE_CPU_MMU,this.i18nService.getString("VmUi","CpuMmuVirt.Label.hardwareCpuMmu"))}return e.$inject=["i18nService"],e}();e.CpuMmuOptionFactory=i,angular.module("com.vmware.vsphere.client.vm").service("cpuMmuOptionFactory",i);var r=function(){function e(e,i){switch(this._value=e,this._label=i,this._value){case t.AUTOMATIC:this._cpuUsage="hvAuto",this._mmuUsage="automatic";break;case t.SOFTWARE:this._cpuUsage="hvOff",this._mmuUsage="off";break;case t.HARDWARE_CPU:this._cpuUsage="hvOn",this._mmuUsage="off";break;case t.HARDWARE_CPU_MMU:this._cpuUsage="hvOn",this._mmuUsage="on";break;default:return}}return Object.defineProperty(e.prototype,"cpuUsage",{get:function(){return this._cpuUsage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mmuUsage",{get:function(){return this._mmuUsage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!0,configurable:!0}),e.prototype.equals=function(t){return t instanceof e?_.isEqual(this._cpuUsage,t.cpuUsage)&&_.isEqual(this._mmuUsage,t.mmuUsage):!!_.isEqual(typeof t,"string")&&_.isEqual(this._value,t)},e}();e.CpuMmuOption=r}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.CpuMmuOption,i=e.CpuMmuConstants,r=function(){function e(e,t,i){this.creationTypeConstants=e,this.cpuMmuOptionFactory=t,this.vmHardwareUtil=i}return e.prototype.getCpuMmuConfigOptionForCpuMmu=function(e,i){var r=new t("","");return _.isEmpty(e)?_.isEqual(i,"automatic")?r=this.cpuMmuOptionFactory.automatic:_.isEqual(i,"on")?r=this.cpuMmuOptionFactory.hardwareCpuMmu:_.isEqual(i,"off")&&(r=this.cpuMmuOptionFactory.software):_.isEqual(e,"hvAuto")&&_.isEqual(i,"automatic")?r=this.cpuMmuOptionFactory.automatic:_.isEqual(e,"hvOff")&&_.isEqual(i,"off")?r=this.cpuMmuOptionFactory.software:_.isEqual(e,"hvOn")&&_.isEqual(i,"on")?r=this.cpuMmuOptionFactory.hardwareCpuMmu:_.isEqual(e,"hvOn")&&_.isEqual(i,"off")&&(r=this.cpuMmuOptionFactory.hardwareCpu),r},e.prototype.getCpuMmuCurrentConfig=function(e){var t={};if(e.environment.configOption.capabilities.virtualMmuUsageSupported&&e.config.flags){t.privileges=_.isEmpty(e.privileges)?null:e.privileges,t.provisioningType=e.provisioningType,t.fullFeature=e.environment.hostCapability.virtualExecUsageSupported,t.virtualCpuMmuUsageSupported=e.environment.configOption.capabilities.virtualMmuUsageSupported;var r=e.config.flags;return r?(_.isEqual(t.provisioningType,this.creationTypeConstants.createVmFromScratch)&&_.isEmpty(r.virtualMmuUsage)&&(r.virtualMmuUsage=i.AUTOMATIC),t.fullFeature&&_.isEqual(t.provisioningType,this.creationTypeConstants.createVmFromScratch)&&_.isEmpty(r.virtualExecUsage)&&(r.virtualExecUsage=i.HV_AUTO),t.virtualMmuUsage=r.virtualMmuUsage,t.virtualExecUsage=r.virtualExecUsage,t):(t.virtualCpuMmuUsageSupported=!1,t)}},e.prototype.isCpuMmuDisabled=function(e,t){if(t)return!1;var i=!this.vmHardwareUtil.haveVmConfigSettingsPermission(e);return i},e.prototype.checkPrivilege=function(e,t){return!!_.isEqual(t.provisioningType,this.creationTypeConstants.createVmFromScratch)||t.privileges.indexOf(e)>-1},e.prototype.getCpuMmuOptions=function(){return[this.cpuMmuOptionFactory.automatic,this.cpuMmuOptionFactory.software,this.cpuMmuOptionFactory.hardwareCpu,this.cpuMmuOptionFactory.hardwareCpuMmu]},e.prototype.getCpuMmuCurrentSelection=function(e){return e&&e.virtualCpuMmuUsageSupported?e.fullFeature?this.getCpuMmuConfigOptionForCpuMmu(e.virtualExecUsage,e.virtualMmuUsage):this.getCpuMmuConfigOptionForCpuMmu(null,e.virtualMmuUsage):this.cpuMmuOptionFactory.automatic},e.$inject=["creationTypeConstants","cpuMmuOptionFactory","vmHardwareUtil"],e}();e.CpuMmuOptionService=r,angular.module("com.vmware.vsphere.client.vm").service("cpuMmuOptionService",r)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("datastoreService",["defaultUriSchemeUtil",function(e){function t(e,t){if(!e.files.vmPathName)return null;var i=r(e.files.vmPathName),n=_.find(t.datastore,function(e){return i===e.name});return n?n:null}function i(t,i){var r=_.find(i.datastore,function(i){return t===e.getVsphereObjectId(i.datastore.datastore)});return r||null}function r(e){if(!e)return"";var t=e.indexOf("["),i=e.indexOf("]");return t===-1||i===-1?"":e.substring(t+1,i)}return{findDatastoreFromVmxName:t,findDatastore:i}}]),function(){"use strict";function e(e){function r(i,r){return _.groupBy(i,function(i){var n=_.find(r,function(t){return e.isDeviceSubclassOf(i,t)});return n?n:t})}function n(e){var t=/[0-9]+$/,i=t.exec(e.deviceInfo.label);return i?parseInt(i,10):0}function o(t){return e.isDeviceSubclassOf(t,"VirtualDisk")?1e4+n(t):e.isDeviceSubclassOf(t,"VirtualSCSIController")?15e3+n(t):e.isDeviceSubclassOf(t,"VirtualEthernetCard")?2e4+n(t):e.isDeviceSubclassOf(t,"VirtualCdrom")?3e4+n(t):e.isDeviceSubclassOf(t,"VirtualFloppy")?4e4+n(t):e.isDeviceSubclassOf(t,"VirtualUSBController")||e.isDeviceSubclassOf(t,"VirtualUSBXHCIController")?55e3+n(t):e.isDeviceSubclassOf(t,"VirtualUSB")?6e4+n(t):e.isDeviceSubclassOf(t,"VirtualVideoCard")?7e4+n(t):e.isDeviceSubclassOf(t,"VirtualNVDIMM")?75e3+n(t):e.isDeviceSubclassOf(t,"VirtualSCSIPassthrough")?8e4+n(t):e.isDeviceSubclassOf(t,"VirtualPCIPassthrough")?9e4+n(t):1e5+t.key}return{groupAndSortDevices:function(e){var t=e.sort(function(e,t){return o(e)-o(t)});return r(t,i)}}}angular.module("com.vmware.vsphere.client.vm").service("deviceOrganizer",e),e.$inject=["vmDeviceInfoService"];var t="VirtualDevice",i=["VirtualDisk","VirtualEthernetCard","VirtualCdrom","VirtualFloppy","VirtualVideoCard","VirtualNVDIMM","VirtualSCSIController","VirtualController","InputDevice",t]}(),function(){"use strict";function e(e,t,i,r){function n(){return--d}function o(e){_.each(e,function(e){e.getKey()<d&&(d=e.getKey())})}function a(e,t,o){var a=i.createForType(e,t,n(),o),c=_.indexBy(e,function(e){return e.type.name}),l=r.inflate(a.toJson(),{deviceOptionsByDeviceType:c});return l=s(l)}function s(e){var i=e.getCurrentDevice(),r=l(i),n=t.getString("VmUi","VmDeviceManager."+r);return i.deviceInfo={_type:"com.vmware.vim.binding.vim.Description",label:n,summary:n},e}function c(e,t){u[e]=t}function l(t){var i=_.find(u,function(i,r){return e.isDeviceSubclassOf(t,r)});if(void 0===i)throw"no localization lookup for key for "+t._type;return i}var d=-100,u={};return c("VirtualUSB","NewVirtualUSB"),c("VirtualDisk","NewDisk"),c("VirtualEthernetCard","NewEthernet"),c("VirtualSCSIController","NewSCSIController"),c("VirtualSATAController","NewSATAController"),c("VirtualTPM","NewTPM"),c("ParaVirtualSCSIController","NewSCSIController"),c("VirtualUSBController","NewUSBController"),c("VirtualUSBXHCIController","NewUSBController"),c("VirtualNVMEController","NewVirtualNVMEController"),c("VirtualPCIPassthrough","NewPCIPassthrough"),c("VirtualNVDIMM","NewNVDIMM"),c("VirtualNVDIMMController","NewNVDIMMController"),c("VirtualSerialPort","NewSerialPort"),{setDeviceInfo:s,newKey:n,calculateKey:o,makeController:a,findLocalizationKey:l,addLocalizationKey:c}}angular.module("com.vmware.vsphere.client.vm").service("deviceService",["vmDeviceInfoService","i18nService","VmController","virtualDeviceInflator",e])}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(){return[k.sameAsSource,k.flat,k.thick,k.thin]}function u(e,t,i,r,n){return m(e,t,i,angular.extend(r||{},{diskFile:n}),c.EXISTINGHARDDISK)}function p(e,t,i,r,n){if(!n)throw new Error("LUN selection cannot be null");return m(e,t,i,angular.extend(r||{},{device:n}),c.RDMDISK)}function v(e,t,i,r){return m(e,t,i,r,c.VIRTUALDISK)}function m(i,r,o,a,s){var l,d,u,p,v=i.configOption.hardwareOptions.virtualDeviceOption,m=g(r,v,o);l=m.recommendedController,p=m.recommendedBusNo,d=m.recommendedUnitNo;var h=m.defaultDiskControllerType;if(!l){if("undefined"==typeof p||p<0)throw new Error(e.getString("VmUi","GenericDevicePage.ControllerMaxLimitReached"));var y=i.configOption.hardwareOptions.virtualDeviceOption;l=t.makeController(y,h,p)}var D=_.find(i.configOption.hardwareOptions.virtualDeviceOption,function(e){var t=e.controllerType&&e.controllerType.typeClass;return!(!t||!l.isOfType(t))&&C(e)}),w=f(s,a,1024*r.recommendedDiskSizeMB),b={
_type:D.type.name,key:t.newKey(),capacityInKB:w.valueInKB,capacityInBytes:w.valueInBytes,unitNumber:d,controllerKey:l.getKey(),backing:S(s,a),storageIOAllocation:P(),createdFromExistingDisk:s===c.EXISTINGHARDDISK};return u=t.setDeviceInfo(new n(b,null)),a&&a.selectedStorageProfile&&u.updateDiskProfile(a.selectedStorageProfile,a.selectedReplicationGroupInfo),{device:u,controller:u?l:null}}function g(e,t,r){var n=i.getAdviceOnReusableController(e.recommendedDiskController,t,r,"VirtualDisk");return n.defaultDiskControllerType=e.recommendedDiskController,!n.recommendedController&&n.recommendedBusNo<0?h(e,t,r):n}function h(e,t,r){for(var n=_.filter(e.supportedDiskControllerList,function(t){return t.name!==e.recommendedDiskController.name}),o=0,a={};n&&o<n.length;){a=i.getAdviceOnReusableController(n[o],t,r,"VirtualDisk");{if(a.recommendedController||!(a.recommendedBusNo<0)){a.defaultDiskControllerType=n[o];break}o++}}return a}function f(e,t,i){var r;switch(e){case c.EXISTINGHARDDISK:t.diskFile&&t.diskFile.fileInfo&&t.diskFile.fileInfo.capacityKb&&(r=t.diskFile.fileInfo.capacityKb);break;case c.RDMDISK:t.device&&t.device.capacity&&(r=t.device.capacity/1024)}return r=r||i,{valueInKB:r,valueInBytes:1024*r}}function S(e,t){switch(e){case c.EXISTINGHARDDISK:if(t.diskFile)return y(t.diskFile);throw new Error("Expected details of the file not present");case c.RDMDISK:return w(t.device);case c.VIRTUALDISK:return D();default:throw new Error("Unsupported device type")}}function y(e){var t={},i=e.fileInfo;return i.diskType&&i.diskType.typeClass?t._type=i.diskType.typeClass:t._type=s.SESPARSE,t.fileName=e.path,t.diskMode="persistent",_.isEmpty(i.thin)||(t.thinProvisioned=i.thin),i.encryption&&i.encryption.keyId&&(t.keyid=i.encryption.keyId),t}function P(){return{_type:"com.vmware.vim.binding.vim.StorageResourceManager$IOAllocationInfo",limit:-1,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",shares:1e3,level:"normal"}}}function C(e){return _.find(e.backingOption,function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualDiskOption$FlatVer2BackingOption"===e._type})}function D(){return{_type:s.FLATVER2,fileName:"",diskMode:"persistent"}}function w(e){return{_type:s.RAWDISKMAPPING,fileName:"",diskMode:"independent_persistent",compatibilityMode:"physicalMode",deviceName:e.deviceName}}function b(e){return R[e]}function I(e){return void 0!==e.thinProvisioned}function T(e){var t=_.findKey(R,function(t){return t.thinProvisioned===e.thinProvisioned&&t.eagerlyScrub===e.eagerlyScrub});return k[t]}function E(e){return _.extend({_type:s.FLATVER2,fileName:"",diskMode:""},b(e))}function V(e){return e?e._type&&"SeSparseBackingInfo"===e._type.split("$")[1]?k.sesparse.name:e.thinProvisioned?k.thin.name:e.eagerlyScrub?k.thick.name:k.flat.name:""}function M(e,t,i){var r=_.filter(e,function(e){return o.isDeviceSubclassOf(e.device,"VirtualDisk")&&e.device.key<0});angular.forEach(r,function(e){if(!e.device.createdFromExistingDisk){var r=t,n=i?i[e.device.key]:void 0;n&&(r=n.dsObject),O(r)||l.isPmemDisk(e.device)?(e.device.backing.fileName="",e.device.backing.datastore=void 0):e.device.backing.fileName="["+r.name+"]"}})}function O(e){return e.storageRef.type===a.STORAGE_POD}function A(e,t){return e===t||!(!e||!t)&&(e.thinProvisioned===t.thinProvisioned&&e.eagerlyScrub===t.eagerlyScrub)}var k=_.extend({sesparse:{name:e.getString("VmUi","DiskPage.SeSparse")}},r.diskFormats),R={thin:{thinProvisioned:!0,eagerlyScrub:null},thick:{thinProvisioned:!1,eagerlyScrub:!0},flat:{thinProvisioned:!1,eagerlyScrub:!1},asDefinedInProfile:{thinProvisioned:!0,eagerlyScrub:!1},nativeThick:{thinProvisioned:!1,eagerlyScrub:!1}};return{makeDefaultVirtualDisk:v,makeDefaultVirtualDiskFromExistingDisk:u,makeDefaultRDMDisk:p,backingInfoKeys:b,hasFormat:I,getFormat:T,getBackingInfo:E,getName:V,getDiskFormats:d,setBackingDatastore:M,areDiskFormatsEqual:A,SAME_AS_SOURCE:k.sameAsSource,FLAT:k.flat,THICK:k.thick,THIN:k.thin}}angular.module("com.vmware.vsphere.client.vm").service("diskProvisioningService",e),e.$inject=["i18nService","deviceService","diskControllerIndexAdviserService","diskFormatService","VirtualDisk","vmDeviceInfoService","managedEntityConstants","diskBackingInfoConstants","deviceTypeConstants","pmemUtilService"]}();var h5_vm;!function(e){var t=function(){function t(e,t,i,r,n,o){this.dataService=e,this.defaultUriSchemeUtil=t,this.managedEntityConstants=i,this.networkSelectorPrefetchingService=r,this.networkSelectorDialogService=n,this.vmHardwareUtil=o}return t.prototype.getVmNetworkInfo=function(e,i){var r=this,n=this.defaultUriSchemeUtil.getEntityType(e);return n===this.managedEntityConstants.RESOURCE_POOL||n===this.managedEntityConstants.V_APP?this.dataService.getPropertiesByRelation(e,t.RELATION_RESOURCE_POOL,this.managedEntityConstants.ANY_COMPUTE_RESOURCE,[t.HOST]).then(function(t){return e=r.getNetworkProviderForResourcePoolAndVirtualApp(t),r.fetchNetworksForProvider(e,i)}):this.fetchNetworksForProvider(e,i)},t.prototype.getSelectedNetwork=function(e,t){var i=_.find(t,function(t){return t.id===e});return i?i:t[0]},t.prototype.getSelectedNetworkTypeForDevice=function(e,t,i,r){var n=t||i[0];return e&&_.each(r,function(t){e._type===t.type.name&&(n=t)}),n},t.prototype.isNetworkSelectDisabled=function(t,i){if(void 0===i&&(i=!1),i)return!1;var r=this.vmHardwareUtil.checkPrivileges(t,[e.Privileges.VM_EDITDEVICE_PRIVILEGE]);return!r},t.prototype.isConnectedDisabled=function(e,t){if(void 0===t&&(t=!1),t)return!1;var i=this.vmHardwareUtil.checkPrivileges(e,["VirtualMachine.Interact.DeviceConnection"]);return!i},t.prototype.isConnectedAtPowerOnDisabled=function(e,t){if(void 0===t&&(t=!1),t)return!1;var i=this.vmHardwareUtil.checkPrivileges(e,["VirtualMachine.Interact.DeviceConnection"]);return!i},t.prototype.isMacAddressDisabled=function(e,t,i,r){void 0===r&&(r=!1);var n=function(){return"poweredOff"!==e&&!t};if(r)return n();var o=this.vmHardwareUtil.checkPrivileges(i,["VirtualMachine.Config.EditDevice"]);return!o||n()},t.prototype.isNetworkAdapterDisabled=function(e,t,i){void 0===i&&(i=!1);var r=function(){return!e};if(i)return r();var n=this.vmHardwareUtil.checkPrivileges(t,["VirtualMachine.Config.EditDevice"]);return!n||r()},t.prototype.getNetworkProviderForResourcePoolAndVirtualApp=function(e){var t,i,r=_.values(e)[0];return r.host&&1===r.host.length?(t=r.host[0],i=this.defaultUriSchemeUtil.getVsphereObjectId(t)):i=_.keys(e)[0],i},t.prototype.fetchNetworksForProvider=function(e,i){var r=this.getUniqueVmNetworks(i);return this.networkSelectorPrefetchingService.prefetchNetworks(e,this.getVmNetworkSelectorFilterSpec(),r,t.NETWORK_PREFETCH_COUNT).then(function(t){return{availableNetworks:t.recentNetworks,networkProviderId:e}})},t.prototype.getVmNetworkSelectorFilterSpec=function(){return this._filterSpec||(this._filterSpec=this.networkSelectorDialogService.createNetworkSelectorFilterSpec(!0,!0,!0,!1,!0)),this._filterSpec},t.prototype.getUniqueVmNetworks=function(e){var t=this,i=[],r=[];return _.forEach(e,function(e){var n=e.getNetworkId();n&&r.indexOf(n)<0&&(i.push(t.defaultUriSchemeUtil.getManagedObjectReference(n)),r.push(n))}),i},t.prototype.isUptCompatibilityVisible=function(e){if(!e)return!0;var t=!1;e.uptCompatibilityEnabled&&(t=e.uptCompatibilityEnabled.supported);var i=e.vmDirectPathGen2Supported,r=t&&i;return r},t.prototype.getUptCompatibility=function(e,t){if(!e)return!1;var i=e.uptCompatibilityEnabled;return angular.isDefined(i)?i:!!t&&t.uptCompatibilityEnabled.defaultValue},t.prototype.setUptCompatibility=function(e,t){e&&(e.uptCompatibilityEnabled=t)},t.prototype.isEditUptCompatibilityDisabled=function(t,i){if(i)return!1;var r=e.VmHardwareUtil.userHasModifyDevicePermission(t);return r===!1},t.prototype.isNotConnectable=function(e,t){var i=this.vmHardwareUtil.getDeviceOption(t,e._type);if(!i)return!0;var r=i.connectOption;return!r},t.$inject=["dataService","defaultUriSchemeUtil","managedEntityConstants","networkSelectorPrefetchingService","networkSelectorDialogService","vmHardwareUtil"],t.NETWORK_PREFETCH_COUNT=10,t.RELATION_RESOURCE_POOL="rp",t.HOST="host",t}();e.VmNetworkService=t,angular.module("com.vmware.vsphere.client.vm").service("vmNetworkService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("networkAdapterService",["deviceService","vmDeviceInfoService","VirtualNetworkDevice",function(e,t,i){function r(r,s){var c=s.recommendedEthernetCard.name,l=_.find(r.configOption.hardwareOptions.virtualDeviceOption,function(e){return e.type.name===c}),d=t.buildAvailableNetworkList(r.configTarget),u=_.find(d,function(e){return o(l)&&a(e)});!u&&d.length>0&&(u=d[0]);var p={_type:l.type.name,key:e.newKey(),connectable:{_type:"com.vmware.vim.binding.vim.vm.device.VirtualDevice$ConnectInfo",startConnected:n(l.connectOption.startConnected),allowGuestControl:n(l.connectOption.allowGuestControl),connected:!0}};l.wakeOnLanEnabled.supported&&s.supportsWakeOnLan&&(p.wakeOnLanEnabled=l.wakeOnLanEnabled.defaultValue);var v=e.setDeviceInfo(new i(p,u));return{device:v}}function n(e){return e.supported&&e.defaultValue}function o(e){return"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCardOption$NetworkBackingOption"===e.backingOption[e.defaultBackingOptionIndex]._type}function a(e){return!!e.network}return{makeDefaultNetworkAdapter:r}}]);var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.deviceService=e,this.deviceClassLineageService=t,this.i18nService=i,this.deviceTypeConstants=r}return e.prototype.makeDefaultNVMeController=function(e,t,i,r){var n=e.supportedDiskControllerList,o=this.getNVMeSupport(n);if(o<0)throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceNotSupported"));if("poweredOn"===r&&!this.getNVMeSupportOnPowerState(t))throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.HotAddNotSupported"));var a=n[o],s=this.findAvailableBusNumber(i);if(s>=0){var c=this.deviceService.makeController(t,a,s);return{device:c}}throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"))},e.prototype.getNVMeSupportOnPowerState=function(e){var t=e.find(function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualNVMEController"===e.type.name},this);return t.plugAndPlay},e.prototype.getNVMeSupport=function(e){var t=this,i=_.findIndex(e,function(e){return t.deviceClassLineageService.isClassNameSubclassOf(e.typeClass,t.deviceTypeConstants.NVME_CONTROLLER)});return i},e.prototype.findAvailableBusNumber=function(e){var t=e.existingDevicesOfType(this.deviceTypeConstants.NVME_CONTROLLER);t=t.concat(e.newDevicesOfType(this.deviceTypeConstants.NVME_CONTROLLER));for(var i=0;i<=3;i++)if(!this.findController(i,t))return i;return-1},e.prototype.findController=function(e,t){return _.find(t,function(t){return t.getCurrentDevice().busNumber===e})},e.$inject=["deviceService","deviceClassLineageService","i18nService","deviceTypeConstants"],e}();angular.module("com.vmware.vsphere.client.vm").service("nvmeControllerService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("opticalDriveService",["deviceService","diskControllerIndexAdviserService","i18nService","VirtualCdrom",function(e,t,i,r){function n(r,n,s){var c=r.configOption.hardwareOptions.virtualDeviceOption,l=_.select(c,function(e){return e._type===m});l=o(l,n);var d,u;if(!_.isEmpty(l)){var p=l[0],v=t.getAdviceOnReusableController(p.controllerType,c,s,"VirtualCdrom");u=v.recommendedController;var g=v.recommendedBusNo,h=v.recommendedUnitNo;if(!u){if(g<0)throw new Error(i.getString("VmUi","GenericDevicePage.ControllerMaxLimitReached"));u=e.makeController(c,p.controllerType)}if(h<0)return{device:null,controller:u.getCurrentDevice()};d=a(p,r,u,h)}if(!d)throw new Error("no device able to be created");return e.setDeviceInfo(d),{device:d,controller:u}}function o(e,t){function i(e,t){var i=e.controllerType?e.controllerType.typeClass:null,r=t.controllerType?t.controllerType.typeClass:null,o=n.findIndex(function(e){return e===i});if(o===-1)return 1;var a=n.findIndex(function(e){return e===r});return a===-1?-1:o-a}var r=t.recommendedCdromController&&t.recommendedCdromController.typeClass,n=[r,"com.vmware.vim.binding.vim.vm.device.VirtualSATAController","com.vmware.vim.binding.vim.vm.device.VirtualIDEController"];return e.sort(i)}function a(t,i,n,o){var a=t.backingOption,l=c(a,i.configTarget.cdRom);if(!l)return null;var d={_type:v,key:e.newKey(),connectable:s(t.connectOption),backing:l,controllerKey:n.getKey(),unitNumber:o};return new r(d)}function s(e){return{_type:"com.vmware.vim.binding.vim.vm.device.VirtualDevice$ConnectInfo",startConnected:!1,allowGuestControl:e.allowGuestControl.supported&&e.allowGuestControl.defaultValue,connected:!1}}function c(e,t){if(!e||0===e.length)return null;var i=l(e);return i?i._type===g?{_type:C[i._type],deviceName:"",exclusive:!1}:d(t,i):null}function l(e){var t=_.select(e,function(e){return _.contains(u(),e._type)});if(!t||0===t.length)return null;var i=t.sort(p)[0];return i?i:null}function d(e,t){if(!e||0===e.length)return null;var i={_type:C[t._type],deviceName:e[0].name};return t._type===h&&(i.exclusive=!1),i}function u(){return[g,h,f]}function p(e,t){var i=u();return i.indexOf(e._type)-i.indexOf(t._type)}var v="com.vmware.vim.binding.vim.vm.device.VirtualCdrom",m="com.vmware.vim.binding.vim.vm.device.VirtualCdromOption",g=m+"$RemotePassthroughBackingOption",h=m+"$PassthroughBackingOption",f=m+"$AtapiBackingOption",S=v+"$RemotePassthroughBackingInfo",y=v+"$PassthroughBackingInfo",P=v+"$AtapiBackingInfo",C={};return C[g]=S,C[h]=y,C[f]=P,e.addLocalizationKey("VirtualCdrom","NewCdrom"),{makeDefaultOpticalDrive:n,CDROM_DEVICE:v,CDROM_DEVICE_OPTION:m,CDROM_DEVICE_OPTION__REMOTE_PASSTHROUGH:g,CDROM_DEVICE_OPTION__PASSTHROUGH:h,CDROM_DEVICE_OPTION__ATAPI:f,CDROM_DEVICE__REMOTE_PASSTHROUGH:S,CDROM_DEVICE__PASSTHROUGH:y,CDROM_DEVICE__ATAPI:P}}]),function(){"use strict";function e(e,t,i,r){function n(e,t,i){var r={};l(e,i,t,r);var n=a(t,r);return n}function o(e,t,i,r,n,o){var s={};l(t,n,i,s),c(e,r,i,s,n,o);var d=a(i,s);return d}function a(t,i){var r,n=[];if(d(t,n),_.each(i,function(t,i){var r=e.getManagedObjectReference(i);n.push(p(t.diskLocator,r,t.disableSdrs))}),n.length>0){var o=h(t);r={_type:"com.vmware.vim.binding.vim.storageDrs.PodSelectionSpec",storagePod:o&&o.isSdrsEnabled?o:null,initialVmConfig:n}}return r}function s(t,i,r){var n=h(i);if(n&&(n.isSdrsEnabled||n.drsEnabled)){var o=e.getVsphereObjectId(n);u(r,o,g(i)),r[o].diskLocator.push(t)}}function c(e,t,r,n,o,a){_.each(e,function(e){var c=_.find(o,function(t){return t.diskKey===e.key}),l=c&&c.diskBacking;!c&&t&&t!==i.SAME_AS_SOURCE&&(l=i.getBackingInfo(t.type));var d=e.profile,u=_.find(a,function(t){return t.key===e.key});u&&(d=u.profile);var p=m(e.key,l,d),v=c?c.dsObject:r;s(p,v,n)})}function l(e,t,i,r){e=e?e:[],_.each(e,function(e){if(!e.createdFromExistingDisk){var n,o=t?t[e.key]:void 0;n=o?o.dsObject:i;var a=m(e.key,e.backing,e.profile);s(a,n,r)}})}function d(e,t){var i=h(e);return i&&i.isSdrsEnabled&&t.push(p([],i,g(e))),i}function u(e,t,i){e[t]||(e[t]={disableSdrs:i,diskLocator:[]})}function p(e,t,i){var r={_type:"com.vmware.vim.binding.vim.storageDrs.PodSelectionSpec$VmPodConfig",disk:e,storagePod:t};return i&&(v(r),r.vmConfig.enabled=!1),r}function v(e){e.vmConfig||(e.vmConfig={_type:"com.vmware.vim.binding.vim.storageDrs.VmConfigInfo"})}function m(e,t,i){var n;return i&&(n=i.profileId||i.id),{_type:"com.vmware.vim.binding.vim.storageDrs.PodSelectionSpec$DiskLocator",diskId:e,diskBackingInfo:t,profile:[r.makeProfile(n)]}}function g(e){return e.storageRef.type===t.DATASTORE&&e.parentStoragePod&&e.parentStoragePod.type===t.STORAGE_POD}function h(e){return e.storageRef.type===t.STORAGE_POD?e.storageRef:e.parentStoragePod}return{createSpec:n,createSpecForClone:o}}angular.module("com.vmware.vsphere.client.vm").service("podSelectionSpecService",e),e.$inject=["defaultUriSchemeUtil","managedEntityConstants","diskProvisioningService","storageProfileService"]}();var h5_vm;!function(e){var t=e.DeviceTypeConstants,i=function(){function e(e,t,i){this.deviceService=e,this.deviceClassLineageService=t,this.i18nService=i}return e.prototype.makeDefaultSataController=function(e,t){var i=this.getSATASupport(e);if(i<0)throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceNotSupported"));var r=e[i].type,n=this.findAvailableBusNumber(t);if(n>=0){var o=this.deviceService.makeController(e,r,n);return{device:o}}throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"))},e.prototype.getSATASupport=function(e){var i=this,r=_.findIndex(e,function(e){return i.deviceClassLineageService.isClassNameSubclassOf(e.type.wsdlName,t.VIRTUAL_SATA_CONTROLLER)});return r},e.prototype.findAvailableBusNumber=function(e){var i=e.existingDevicesOfType(t.VIRTUAL_SATA_CONTROLLER);i=i.concat(e.newDevicesOfType(t.VIRTUAL_SATA_CONTROLLER));for(var r=0;r<=3;r++)if(!this.findController(r,i))return r;return-1},e.prototype.findController=function(e,t){return _.find(t,function(t){return t.getCurrentDevice().busNumber===e})},e.$inject=["deviceService","deviceClassLineageService","i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").service("sataControllerService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.deviceService=e,this.i18nService=t}return e.prototype.makeDefaultSCSIController=function(e,t,i){var r=e.recommendedSCSIController,n=this.findSCSIControllerBusNumber(i);if(n>=0){var o=this.deviceService.makeController(t,r,this.findSCSIControllerBusNumber(i));return{device:o}}throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"))},e.prototype.findSCSIControllerBusNumber=function(e){var t=e.existingDevicesOfType("VirtualSCSIController");t=t.concat(e.newDevicesOfType("VirtualSCSIController"));for(var i=0;i<=3;i++)if(!this.findSCSIController(i,t))return i;return-1},e.prototype.findSCSIController=function(e,t){return _.find(t,function(t){return t.getCurrentDevice().busNumber===e})},e.$inject=["deviceService","i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").service("scsiControllerService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.DeviceTypeConstants,i=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$FileBackingInfo,r=com.vmware.vim.binding.vim.vm.device.VirtualDevice$ConnectInfo,n=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort,o=function(){function o(e,t,i,r){this.deviceService=e,this.deviceClassLineageService=t,this.i18nService=i,this.VmHwSerialPort=r}return o.prototype.makeDefaultSerialPort=function(o,a){var s=o.configOption.hardwareOptions.virtualDeviceOption,c=o.powerState,l=this.getDeviceSupport(s,t.VIRTUAL_SERIAL_PORT),d=this.getDeviceSupport(s,t.VIRTUAL_SIO_CONTROLLER),u=s[l],p=s[d];if(!u||!p)throw this.newErrorDeviceNotSupported();var v=p.numSerialPorts.max,m=this.getNumberOfSerialPorts(a);if(m===v)throw new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"));if(c===e.PowerState.POWERED_ON&&!u.plugAndPlay)throw this.newErrorHotAddNotSupported();var g=new n;g.key=this.deviceService.newKey();var h=new i;g.backing=h,h.fileName="",g.connectable=new r,g.connectable.startConnected=u.connectOption.startConnected.defaultValue,g.connectable.connected=!1,g.connectable.allowGuestControl=u.connectOption.allowGuestControl.defaultValue,g.yieldOnPoll=u.yieldOnPoll.defaultValue;var f=new this.VmHwSerialPort(g);return this.deviceService.setDeviceInfo(f),{device:f}},o.prototype.getDeviceSupport=function(e,t){var i=this;return _.findIndex(e,function(e){return i.deviceClassLineageService.isClassNameSubclassOf(e.type.wsdlName,t)})},o.prototype.getNumberOfSerialPorts=function(e){var i=e.existingDevicesOfType(t.VIRTUAL_SERIAL_PORT).length,r=e.newDevicesOfType(t.VIRTUAL_SERIAL_PORT).length;return i+r},o.prototype.newErrorHotAddNotSupported=function(){return this.newError(this.i18nService.getString,"HotAddNotSupported")},o.prototype.newErrorDeviceNotSupported=function(){return this.newError(this.i18nService.getString,"DeviceNotSupported")},o.prototype.newError=function(e,t){var i=e("VmUi","VmDeviceManager."+t),r=new Error(i);return r},o.$inject=["deviceService","deviceClassLineageService","i18nService","VmHwSerialPort"],o}();e.SerialPortService=o,angular.module("com.vmware.vsphere.client.vm").service("serialPortService",o)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.deviceService=e,this.i18nService=t,this.VirtualTPM=i,this.dataService=r,this.defaultUriSchemeUtil=n}return e.prototype.checkDefaultKmsServer=function(e){var t=this.defaultUriSchemeUtil.createVmomiUri("Folder","group-d1",e);return this.dataService.getProperties(t,["defaultKmsClusterExists"])},e.prototype.makeDefaultTpm=function(e,t){var i={};i._type="com.vmware.vim.binding.vim.vm.device.VirtualTPM",i.key=-1;var r=this.deviceService.setDeviceInfo(new this.VirtualTPM(i));return this.checkDefaultKmsServer(e).then(function(e){e&&e.defaultKmsClusterExists?r.state=r.CONNECTED:r.state=r.NOT_CONNECTED,t(r)}),{device:r}},e.$inject=["deviceService","i18nService","VirtualTPM","dataService","defaultUriSchemeUtil"],e}();angular.module("com.vmware.vsphere.client.vm").service("tpmProvisioningService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.deviceService=e,this.i18nService=t}return e.prototype.makeDefaultUSBController=function(e,t,i,r){if(!_.isEmpty(r)&&r.isCreateMode)return this.makeDefaultUSBControllerForCreate(e,t,i);var n="VirtualUSBController",o="VirtualUSBXHCIController",a=_.find(t,function(e){return e.type.wsdlName===n}),s=_.find(t,function(e){return e.type.wsdlName===o});if(!a&&!s)throw this.newErrorDeviceNotSupported();var c,l=i.findDevicesOfType(n).length,d=i.findDevicesOfType(o).length;if(0===l&&a?c=this.deviceService.makeController(t,a.type,0):0===d&&s&&(c=this.deviceService.makeController(t,s.type,0)),!c)throw this.newErrorDeviceLimitReached();return{device:c}},e.prototype.newErrorDeviceLimitReached=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"))},e.prototype.newErrorDeviceNotSupported=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceNotSupported"))},e.prototype.makeDefaultUSBControllerForCreate=function(e,t,i){var r,n={device:r};if(!e.usbRecommended)return n;if(_.isNull(e.recommendedUSBController)||_.isNull(e.recommendedUSBController.wsdlName))return n;var o=e.recommendedUSBController.wsdlName;if(i.findDevicesOfType(o).length>0)return n;var a=!1;if(_.isEmpty(e.supportedUSBControllerList)||(a=_.some(e.supportedUSBControllerList,function(e){return e.wsdlName===o})),!a)return n;var s=_.find(t,function(e){return e.type.wsdlName===o});return s?(n.device=this.deviceService.makeController(t,s.type,0),n):n},e.$inject=["deviceService","i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").service("usbControllerService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("virtualDeviceInflator",["VirtualVideoCard","VirtualDisk","VirtualCdrom","VirtualUSBClass","VirtualTPM","VirtualNvdimmWrapper","EditableVirtualDevice","VirtualController","virtualDiskInflator","vmDeviceInfoService","virtualControllerInflator","virtualNetworkDeviceInflator","virtualSCSIControllerInflator","VmHwSerialPort","VirtualPCITs",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){return{inflate:function(t,s){s=s||{};var g;return l.isDeviceSubclassOf(t,"VirtualDisk")?g=c.build(t,s.storageProfiles,s.storageProfileAssignments):l.isDeviceSubclassOf(t,"VirtualVideoCard")?g=new e(t,s.isScheduledTask):l.isDeviceSubclassOf(t,"VirtualSerialPort")?g=new v(t):l.isDeviceSubclassOf(t,"VirtualPCIPassthrough")?g=new m(t):l.isDeviceSubclassOf(t,"VirtualEthernetCard")?g=u.build(t,s.availableNetworks):l.isDeviceSubclassOf(t,"VirtualNVDIMMController")?g=new a(t):l.isDeviceSubclassOf(t,"VirtualSCSIController")?g=p.build(t,s.deviceOptionsByDeviceType):l.isDeviceSubclassOf(t,"VirtualController")?g=d.build(t,s.deviceOptionsByDeviceType):l.isDeviceSubclassOf(t,"VirtualCdrom")?g=new i(t):l.isDeviceSubclassOf(t,"VirtualUSB")?g=new r(t,null):l.isDeviceSubclassOf(t,"VirtualTPM")?(g=new n(t),g.state=g.CONNECTED):g=l.isDeviceSubclassOf(t,"VirtualNVDIMM")?new o(t):new a(t),g},inflateDevices:function(e,t){var i=this;return _.map(e,function(e){return i.inflate(e,t)})}}}]),angular.module("com.vmware.vsphere.client.vm").factory("EditableVirtualDevice",["deviceDiffService","vmDeviceInfoService","vmHardwareUtil",function(e,t,i){var r="add",n="remove",o="edit",a=function(a){var s=a;this.isNew=function(){return s.key<0};var c={_type:"com.vmware.vim.binding.vim.vm.device.VirtualDeviceSpec",operation:this.isNew()?r:o,device:angular.copy(a),fileOperation:void 0};this.getFinalDeviceSpec=function(){var e=angular.copy(c);return i.clearUnchangedConnectInfo(e,s),i.fixNewDiskBackingDatastore(e),e},this.getCurrentDeviceSpec=function(){return c},this.setCurrentDeviceSpec=function(e){c=e},this.getCurrentDevice=function(){return c.device},this.markForRemoval=function(){c.operation=n},this.revertRemoval=function(){c.operation=o},this.getKey=function(){return c.device.key},this.hasChanged=function(){return!(c.operation!==r&&!this.isMarkedForRemoval())||!e.isUnchanged(s,c.device)},this.isMarkedForRemoval=function(){return c.operation===n},this.isOfType=function(e){return t.isDeviceSubclassOf(c.device,e)}};return a}]);var h5_vm;!function(e){function t(e,t,i){var n=function(n){var o=new r(n,e,t,i);return o};return n}var i=com.vmware.vim.binding.vim.vm.device.VirtualDeviceSpec,r=function(){function e(e,t,r,n){this.deviceDiffService=t,this.vmDeviceInfoService=r,this.vmHardwareUtil=n,this.ADD_OPERATION="add",this.REMOVE_OPERATION="remove",this.EDIT_OPERATION="edit",this.currentDeviceSpec=new i,this.originalDevice=e;var o=this.isNew()?"add":"edit";this.currentDeviceSpec.operation=o,this.currentDeviceSpec.device=angular.copy(e),delete this.currentDeviceSpec.fileOperation}return e.prototype.isNew=function(){return this.originalDevice.key<0},e.prototype.getFinalDeviceSpec=function(){var e=angular.copy(this.currentDeviceSpec);return this.vmHardwareUtil.clearUnchangedConnectInfo(e,this.originalDevice),this.vmHardwareUtil.fixNewDiskBackingDatastore(e),e},e.prototype.getCurrentDeviceSpec=function(){return this.currentDeviceSpec},e.prototype.setCurrentDeviceSpec=function(e){this.currentDeviceSpec=e},e.prototype.getCurrentDevice=function(){return this.currentDeviceSpec.device},e.prototype.markForRemoval=function(){this.currentDeviceSpec.operation=this.REMOVE_OPERATION},e.prototype.revertRemoval=function(){this.currentDeviceSpec.operation=this.EDIT_OPERATION},e.prototype.getKey=function(){return this.currentDeviceSpec.device.key},e.prototype.hasChanged=function(){return!(this.currentDeviceSpec.operation!==this.ADD_OPERATION&&!this.isMarkedForRemoval())||!this.deviceDiffService.isUnchanged(this.originalDevice,this.currentDeviceSpec.device)},e.prototype.isMarkedForRemoval=function(){return this.currentDeviceSpec.operation===this.REMOVE_OPERATION},e.prototype.isOfType=function(e){return this.vmDeviceInfoService.isDeviceSubclassOf(this.currentDeviceSpec.device,e)},Object.defineProperty(e.prototype,"_type",{get:function(){return this.originalDevice._type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.originalDevice.key},enumerable:!0,configurable:!0}),e.prototype.setDeviceInfo=function(e){this.originalDevice.deviceInfo=e},e.prototype.deviceLabel=function(){var e=this.getCurrentDevice();if(!e)return"";var t=e.deviceInfo;if(!t)return"";var i=t.label;return i},e.prototype.removeDevice=function(){this.removeCallback?(this.removeCallback(this),this.isNew()&&(this.removeCallback=null)):this.vm&&this.vm.remove(this)},e.prototype.cleanup=function(){this.removeCallback=null,this.vm=null},e.prototype.attachVmConfig=function(e){!this.vm&&e&&(this.vm=e,this.onVmConfigAttached(),this.setDeviceInfo(this.getCurrentDevice().deviceInfo))},e.prototype.onVmConfigAttached=function(){},e.prototype.removeDeviceDisabled=function(e){return!!this.vm&&!1===this.vm.canRemoveDevice(e)},e.prototype.isEditDeviceDisabled=function(){return!this.vm||!this.isNew()&&this.vm.isEditDeviceDisabled(!0)},e.prototype.isConnectDeviceDisabled=function(){return!this.isNew()&&(!this.vm||this.vm.isConnectDeviceDisabled())},e.prototype.i18n=function(e){return this.vm&&this.vm.getI18nService()?this.vm.getI18nService().getString("VmUi",e):""},e.prototype.debugAsExistingDevice=function(){var e=this.originalDevice.key;e<0&&(this.getCurrentDevice().key=-e,this.originalDevice.key=-e)},e.prototype.debugAsNewDevice=function(){var e=this.originalDevice.key;e>0&&(this.getCurrentDevice().key=-e,this.originalDevice.key=-e)},e}();e.EditableVirtualDeviceClass=r,angular.module("com.vmware.vsphere.client.vm").factory("EditableVirtualDeviceTs",["deviceDiffService","vmDeviceInfoService","vmHardwareUtil",t])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualUSB$USBBackingInfo,i=com.vmware.vim.binding.vim.vm.device.VirtualUSB,r=e.DeviceTypeConstants,n=function(){function e(e,t,i,r){this.deviceService=e,this.i18nService=t,this.EditableVirtualDevice=i,this.VirtualUSBClass=r}return e.prototype.makeUSBDevice=function(r,n,o){if(!n||n.length<1)throw this.newErrorNoUSBDevices();var a=new i,s=_.find(r,function(t){return t.type.name===e.USB_TYPE});if(!s)throw this.newErrorDeviceNotSupported();a.key=this.deviceService.newKey();var c=this.getNextAvailableUsb(n,o);if(this.countUSBDevices(o)>=this.getMaxUSBDevices(r))throw this.newErrorDeviceLimitReached();if(!c)throw this.newErrorNoUSBDevices();var l=new t;l.deviceName=c.physicalPath,a.backing=l;var d=new this.VirtualUSBClass(a,c);return this.deviceService.setDeviceInfo(d),{device:d}},e.prototype.countUSBDevices=function(t){var i=0;return t.forEach(function(t){t.isOfType(e.USB_TYPE)&&i++}),i},e.prototype.getMaxUSBDevices=function(e){var t;return e.forEach(function(e){e.type&&e.type.wsdlName===r.VIRTUAL_USB_CONTROLLER&&(t=e)}),t&&t.devices?t.devices.max:20},e.prototype.getNextAvailableUsb=function(t,i){if(!t||0===t.length)return null;for(var r=i.filter(function(t){return t.isOfType(e.USB_TYPE)}).map(function(e){return e.getCurrentDevice().backing.deviceName}),n={},o=0,a=r;o<a.length;o++){var s=a[o];n[s]=!0}for(var c=0,l=t;c<l.length;c++){var d=l[c];if(!n[d.physicalPath])return d}return null},e.prototype.newErrorDeviceLimitReached=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"))},e.prototype.newErrorDeviceNotSupported=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceNotSupported"))},e.prototype.newErrorNoUSBDevices=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.NoUSBDevices"))},e.$inject=["deviceService","i18nService","EditableVirtualDevice","VirtualUSBClass"],e.USB_TYPE=(new i)._type,e}();e.UsbDeviceService=n,angular.module("com.vmware.vsphere.client.vm").service("usbDeviceService",n)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("VirtualNvdimmWrapper",["EditableVirtualDevice",function(e){var t=function(t){var i=t;e.call(this,t),this.setFileOperation=function(e){this.getCurrentDeviceSpec().fileOperation=e},this.setProfile=function(e){this.getCurrentDeviceSpec().profile=e},this.getCapacityDiff=function(){var e=this.getCurrentDevice().capacityInMB;return this.isNew()?e:e-i.capacityInMB},this.getCapacityInMB=function(){return this.getCurrentDevice().capacityInMB},this.getOriginalCapacityInMB=function(){return this.isNew()?0:i.capacityInMB}};return t}]),angular.module("com.vmware.vsphere.client.vm").factory("VirtualTPM",["EditableVirtualDevice",function(e){var t=function(i,r){e.call(this,i),this.state=r?r:t.prototype.CONNECTING};return t.prototype.CONNECTED="CONNECTED",t.prototype.CONNECTING="CONNECTING",t.prototype.NOT_CONNECTED="NOT_CONNECTED",t}]),angular.module("com.vmware.vsphere.client.vm").factory("VirtualCdrom",["EditableVirtualDevice",function(e){
var t=function(t){e.call(this,t)};return t}]),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").factory("VirtualController",["EditableVirtualDevice",function(e){return function(t,i){e.call(this,t),this.getMaxDisks=function(){return i.maxDisks},this.getDiskNodeIndices=function(){return _.range(0,this.getMaxDisks())},this.getMaxCdroms=function(){return i.maxCdroms},this.getCdromNodeIndices=function(){return _.range(0,this.getMaxCdroms())}}}])}(),angular.module("com.vmware.vsphere.client.vm").factory("VirtualDisk",["EditableVirtualDevice","deviceDiffService","storageProfileService","diskBackingInfoConstants","pmemUtilService","i18nService","vmCryptUtilService",function(e,t,i,r,n,o,a){var s,c,l=o.getString("VmUi","DiskConfig.Unlimited"),d="create",u=function(t,o,u){e.call(this,t);var p,v;u&&(p=u,v=u),s=t.capacityInBytes,c=t.capacityInKB;var m=t.backing,g=t.capacityInKB/1024,h=!1;this.storageProfile=o,this.isNew()&&!this.getCurrentDevice().createdFromExistingDisk&&(this.getCurrentDeviceSpec().fileOperation=d);var f=this.hasChanged;if(this.setDiskFileOperation=function(e){this.getCurrentDeviceSpec().fileOperation=e},this.getDiskFileOperation=function(){return this.getCurrentDeviceSpec().fileOperation},this.isCreatedFromExistingDisk=function(){return this.getCurrentDevice().createdFromExistingDisk},this.isRDMDisk=function(){return this.getCurrentDevice().backing._type===r.RAWDISKMAPPING},this.setProfile=function(e){this.getCurrentDeviceSpec().profile=e?[e]:void 0},this.setOriginalProfile=function(e,t){S||(S=e,this.setProfile(e)),!p&&t&&(p=t,v=t,this.setProfile(e))},o){var S;this.setOriginalProfile(o,u)}this.restoreOriginalBacking=function(){this.getCurrentDevice().backing=m},this.getProfile=function(){return this.getCurrentDeviceSpec().profile&&this.getCurrentDeviceSpec().profile[0]},this.updateCapacity=function(e){this.getCurrentDevice().capacityInKB=1024*e,this.getCurrentDevice().capacityInBytes=1024*this.getCurrentDevice().capacityInKB,this.getCurrentDevice().capacityInKB===c&&(this.getCurrentDevice().capacityInBytes=s)},this.updateDiskMode=function(e){this.getCurrentDevice().backing.diskMode=e},this.updateFileName=function(e){this.getCurrentDevice().backing.fileName=e},this.updateDiskProvisioningOption=function(e){this.getCurrentDevice().backing=angular.extend(this.getCurrentDevice().backing,e)},this.updateDiskProfile=function(e,t){this.storageProfile=e;var r;e&&(e.id||e.profileId)&&(r=i.makeProfile(e.id||e.profileId,t),r.label=e.label),v=t,this.setProfile(r)},this.getCurrentReplicationGroup=function(){return v},this.updateStorageIOAllocation=function(e){this.getCurrentDevice().storageIOAllocation.limit=e===l?-1:e},this.updateSharing=function(e){this.getCurrentDevice().backing.sharing=e||null},this.updateShares=function(e){const t=this.getCurrentDevice().storageIOAllocation,i=t.shares;i.level=e.level,i.shares=e.shares},this.updateCompatibilityMode=function(e){this.getCurrentDevice().backing.compatibilityMode=e},this.updateFlashCacheReservation=function(e){this.getCurrentDevice().vFlashCacheConfigInfo=this.getCurrentDevice().vFlashCacheConfigInfo||{_type:"com.vmware.vim.binding.vim.vm.device.VirtualDisk$VFlashCacheConfigInfo"},this.getCurrentDevice().vFlashCacheConfigInfo.reservationInMB=e},this.updateControllerAndNodeKeys=function(e,t){this.getCurrentDevice().controllerKey=e,this.getCurrentDevice().unitNumber=t?t:this.getCurrentDevice().unitNumber},this.updateDatastoreMor=function(e){this.getCurrentDevice().backing.datastore=e},this.updateParentStoragePodMor=function(e){this.getCurrentDevice().backing.parentStoragePod=e},this.hasChanged=function(){var e=f.apply(this);if(S&&this.getCurrentDeviceSpec().profile){var t=!_.isEqual(S.profileId,this.getCurrentDeviceSpec().profile[0].profileId);e=e||t}if(p&&v){var i=!_.isEqual(p.id,v.id);e=e||i}return e},this.deviceName=function(){return this.getCurrentDevice().deviceInfo.label},this.isPmemDisk=function(){return n.isPmemDisk(this.getCurrentDevice())},this.isDiskAlreadyEncrypted=function(){return a.isExistingDiskEncrytped(this.getCurrentDevice())},this.isEncryptionProfileApplied=function(){return i.isEncryptionStorageProfile(this.storageProfile)},this.isDiskEncrypted=function(){return this.isDiskAlreadyEncrypted()||this.isEncryptionProfileApplied()},this.getOriginalCapacityInMB=function(){return this.isNew()?0:g},this.getCapacityDiff=function(){var e=this.getCurrentDevice().capacityInKB/1024;return this.isNew()?e:e-g},this.isStorageProfileManuallySet=function(){return h},this.setStorageProfileManuallySet=function(e){h=e}};return u.UNLIMITED_DISK=l,u}]),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").factory("VirtualNetworkDevice",["EditableVirtualDevice","vmDeviceInfoService","defaultUriSchemeUtil",function(e,t,i){function r(i,r){var n=i.backing&&i.backing.port?i.backing.port.portKey:null;i.backing=t.buildNetworkDeviceBacking(r),i.backing&&i.backing.port&&null!==n&&(i.backing.port.portKey=n),e.call(this,i),this.network=r}return r.prototype.getNetworkId=function(){if(this.network){var e=this.network.portgroup;return e||(e=this.network.network.network),i.getVsphereObjectId(e)}},r.prototype.getNetworkName=function(){return this.network?this.network.displayName:void 0},r.prototype.getNetwork=function(){return this.network},r.prototype.setNetwork=function(e){e&&(this.network=e,this.getCurrentDevice().backing=t.buildNetworkDeviceBacking(e))},r}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").factory("VirtualSCSIController",["EditableVirtualDevice",function(e){return function(t,i){e.call(this,t),this.getMaxDisks=function(){return i.maxDisks},this.getReservedNode=function(){return i.reservedNode},this.getDiskNodeIndices=function(){return _.range(0,i.reservedNode).concat(_.range(i.reservedNode+1,this.getMaxDisks()+1))},this.getMaxCdroms=function(){return i.maxCdroms},this.getCdromNodeIndices=function(){return _.range(0,i.reservedNode).concat(_.range(i.reservedNode+1,this.getMaxCdroms()+1))}}}])}();var h5_vm;!function(e){function t(e,t){var i=function(i,r){var n=new o(i,r,t);return e.call(n,i),n};return i}var i=com.vmware.vim.binding.vim.vm.device.VirtualUSB$RemoteClientBackingInfo,r=com.vmware.vim.binding.vim.vm.device.VirtualUSB$RemoteHostBackingInfo,n=com.vmware.vim.binding.vim.vm.device.VirtualUSB$USBBackingInfo,o=function(){function t(e,t,o){this.i18nService=o,this.clientType=(new i)._type,this.remoteType=(new r)._type,this.localType=(new n)._type,this._vMotion=!1,this.usbInfo=t,t&&(t.taken=!0),this.rawDevice=e,this.i18n=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return o.getString("VmUi","USBDevicePage."+e,t)}}return t.prototype.onInit=function(t){this.ctx=t,this.rawDevice=this.getCurrentDevice(),null===this.usbInfo&&(this.usbInfo=e.VmHardwareUsbDeviceUtil.getTargetUsbInfo(this.rawDevice,t))},t.prototype.isNew=function(){return this.rawDevice.key<0},t.prototype.isRemovalEnabled=function(){return!!this.isNew()||(this.isClientTypeUSB()?e.VmHardwareUtil.userHasAddRemoveDevicePermission(this.ctx):e.VmHardwareUtil.userHasHostUsbPermission(this.ctx))},t.prototype.getDeviceLabel=function(){return this.rawDevice&&this.rawDevice.deviceInfo?this.rawDevice.deviceInfo.label:""},t.prototype.getUsbDeviceLabel=function(t){var i=e.VmHardwareUsbDeviceUtil.getUsbTargetDescription(this.rawDevice,t),r=this.rawDevice.backing._type===this.clientType?"USBDeviceConfig.ClientDevice":"USBDeviceConfig.HostDevice",n=this.i18nService.getString("VmUi",r,i);return n},Object.defineProperty(t.prototype,"hostUsb",{get:function(){return this.usbInfo},set:function(e){if(e){var t=this.rawDevice.backing;t.deviceName=e.physicalPath,this.usbInfo=e}},enumerable:!0,configurable:!0}),t.prototype.getUSBUniqueID=function(){return e.VmHardwareUsbDeviceUtil.getUSBUniqueID(this.rawDevice)},t.prototype.getUSBConnectionStatusText=function(){return this.rawDevice?this.rawDevice.connected?this.i18n("Connected"):this.i18n("Disconnected"):""},t.prototype.isClientTypeUSB=function(){return!(!this.rawDevice||!this.rawDevice.backing)&&this.rawDevice.backing._type===this.clientType},t.prototype.getVMotionSupportText=function(){return this.rawDevice?this.rawDevice.backing._type===this.clientType?this.i18n("VMotionCapable"):this.rawDevice.backing._type===this.remoteType?this.i18n("VMotionCapable"):this.i18n("VMotionNotCapable"):""},t.prototype.isDevicePresent=function(){return!!this.usbInfo},t.prototype.getDeviceAvailableText=function(){if(!this.usbInfo)return"";var e=this.usbInfo.summary;if(!e)return this.i18n("USBConnectionAvailable");if(e&&e.config){var t=e.config.name,i=this.i18nService.getString("VmUi","USBDeviceConfig.Connected",t);return i}return""},t.prototype.isDeviceAvailable=function(){return this.usbInfo&&!this.usbInfo.summary},Object.defineProperty(t.prototype,"vMotion",{get:function(){return this._vMotion},set:function(e){if(this._vMotion=e,e){this.rawDevice.backing._type=this.remoteType;var t=this.rawDevice.backing;t.hostname=""}else this.rawDevice.backing._type=this.localType},enumerable:!0,configurable:!0}),t}();e.VirtualUSBClass=o,angular.module("com.vmware.vsphere.client.vm").factory("VirtualUSBClass",["EditableVirtualDevice","i18nService",t])}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("VmController",["i18nService","deviceClassLineageService",function(e,t){function i(e){var t="com.vmware.vim.binding.vim.vm.device.VirtualIDEController";return!e||e===t}var r="Cannot create controller!",n=function(e,i){function n(e,i){if(t.isClassNameSubclassOf(e,"VirtualSCSIController"))return i.sharing[i.defaultSharedIndex]}this.parse=function(){var t={},r=this.controllerOption(e,i);return r.scsiCtlrUnitNumber&&(t.scsiCtlrUnitNumber=r.scsiCtlrUnitNumber),t.controllerOptionType=r.type.typeClass,t.sharedBus=n(t.controllerOptionType,r),t},this.controllerOption=function(){function n(e){return e.type.typeClass===i}function o(e){return t.isClassNameSubclassOf(e.type.typeClass,i)}var a=_.find(e,n)||_.find(e,o);if(!a)throw new Error(r);return a}},o=function(e,t){var i=new n(t,e._type);this.toJson=function(){return e},this.sharingOptions=function(){return i.controllerOption().sharing}};return o.createForType=function(e,t,a,s){if(i(t.typeClass))throw new Error(r);var c=new n(e,t.typeClass),l=c.parse(),d={_type:l.controllerOptionType,key:a,busNumber:s||0,sharedBus:l.sharedBus};return l.scsiCtlrUnitNumber&&(d.scsiCtlrUnitNumber=l.scsiCtlrUnitNumber),new o(d,e)},o}]),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").service("virtualDiskSettingsFormService",["i18nService","diskBackingInfoConstants","datastoreService","vmDeviceInfoService","defaultUriSchemeUtil","storageProfileService","diskProvisioningService","diskFormatService","pmemUtilService",function(e,t,i,r,n,o,a,s,c){function l(t,i,n,s,l,y,P,D){var w=s.getCurrentDeviceSpec(),b=w.device,I=f(n,b.backing.datastore,l,s.isNew()),T=S(s,i,I),E=h(I,b),V=g(b),M=m(b.storageIOAllocation.shares),O=v(b.storageIOAllocation),A=D.getAllDevicesNotMarkedForRemoval(),k=n.environment.hostCapability.vFlashSupported,R=p(b.vFlashCacheConfigInfo),N=u(n,s,A),U=r.availableControllersForDevice(s,A),L=d(s,A),F=_.find(U,function(e){return e.getKey()===b.controllerKey});if(!F)throw new Error("Could not find controller with key "+b.controllerKey+" for device "+s.getKey());var x=R.valueInMB<1024?R.validUnits.MB.label:R.validUnits.GB.label,$={capacity:{valueInMB:T.valueInMB,validUnits:T.validUnits,minInMB:T.minInMB,maxInMB:T.maxInMB,maxExceededErrorMessage:T.maxExceededErrorMessage,memoryUnitPreferred:T.memoryUnitPreferred,isMaxAvailable:T.isMaxAvailable},diskProvisioningName:E,sharing:{options:V.options,selection:V.selection},diskFile:b.backing.fileName,shares:M,ioLimit:O,isFlashCacheCompatible:k,flashCacheReservation:{valueInMB:R.valueInMB,validUnits:R.validUnits,customValidators:[{name:"valid-range",validate:function(e){return 0===e||e>=4&&e<=10240},message:e.getString("VmUi","vFlashCache.ValidRange","Reservation","4MB","10GB")+" "+e.getString("VmUi","vFlashCache.ZeroToDisableCahe")}],errorMessages:{},defaultUnit:x},diskMode:{options:N.options,selection:N.selection},controllers:{options:L.options,selection:L.selection},selectedControllerNode:null};(i||s.isNew())&&($.diskProvisioningOptions=C(I?I.datastore.type:"",I?I.vStorageSupport:""),a.hasFormat(b.backing)?$.selectedDiskProvisioningOption=a.getFormat(b.backing):$.selectedDiskProvisioningOption=$.diskProvisioningOptions[0]);var z;return P=c.filterOutPmemProfileIfNeeded(P,n,s),i?z=o.buildStorageProfileInCreateMode(y,P):t&&(z=o.buildStorageProfile(t,b,P,s.isNew())),z&&($.storageProfile={options:z.options,selection:z.selection},w&&w.profile&&($.storageProfile.selection=o.findProfile($.storageProfile.options,w.profile[0]))),$}function d(e,t){var i=r.availableControllersForDevice(e,t),n=_.find(i,function(t){return t.getKey()===e.getCurrentDeviceSpec().device.controllerKey});return{options:i,selection:n}}function u(i,n,o){var a=r.backingOptionForDevice(i,n,o);if(!a&&n.getCurrentDevice().backing._type===t.LOCALPMEM)return{options:[]};var s=_.map(a.diskMode.choiceInfo,function(t){return{name:e.getString("VmUi","DiskConfig."+t.key),value:t.key}}),c=_.find(s,function(e){return e.value===n.getCurrentDevice().backing.diskMode});return{options:s,selection:c}}function p(t){return{valueInMB:t?t.reservationInMB:0,validUnits:{MB:{label:e.getString("VmUi","Vm.Units.MB"),multiplier:1},GB:{label:e.getString("VmUi","Vm.Units.GB"),multiplier:Math.pow(2,10)}}}}function v(t){var i=t.limit;return i===-1?e.getString("VmUi","DiskConfig.Unlimited"):i}function m(e){return{min:200,max:4e3,presetOptions:{low:500,normal:1e3,high:2e3},value:e}}function g(t){var i=[{name:e.getString("VmUi","DiskPage.sharingNull"),value:void 0},{name:e.getString("VmUi","DiskPage.sharingNone"),value:"sharingNone"},{name:e.getString("VmUi","DiskPage.sharingMultiWriter"),value:"sharingMultiWriter"}],r=i[0],n=_.find(i,function(e){return e.value===t.backing.sharing})||r;return{options:i,selection:n}}function h(t,i){return t&&"vsan"===t.datastore.type?e.getString("VmUi","DiskPage.ProfileProvisioned"):a.getName(i.backing)}function f(e,t,r,o){var a=t?n.getVsphereObjectId(t):null;return o&&(a=a||r),i.findDatastore(a,e.environment.configTarget)}function S(i,r,n){var o,a,s,c,l,d=i.getCurrentDevice();if(n||(o=Math.pow(2,63),a=o/Math.pow(2,20),s=e.getString("VmUi","DiskConfig.ErrorMaxFileSize")),n){var u=1024;if(o=n.maxVirtualDiskCapacity,null===o||isNaN(o)||o<=0){o=n.maxFileSize;var p=256*u*u*u;o>=p&&(l=o/u/u)}else l=o/u/u;c=n.datastore.freeSpace/u/u,r||i.isNew()||(c+=d.capacityInKB/u),l&&l<c?(a=l,s=e.getString("VmUi","DiskConfig.ErrorMaxFileSize")):(a=c,s=e.getString("VmUi","DiskConfig.ErrorFreeSpace"))}var v=y(d),m={MB:{label:e.getString("VmUi","Vm.Units.MB"),multiplier:1},GB:{label:e.getString("VmUi","Vm.Units.GB"),multiplier:Math.pow(2,10)},TB:{label:e.getString("VmUi","Vm.Units.TB"),multiplier:Math.pow(2,20)}},g=v<1024?m.MB:m.GB,h=i.getCurrentDeviceSpec();return h&&h.memoryUnitPreferred&&h.memoryUnitPreferred.label&&(g=h.memoryUnitPreferred),d.backing._type===t.RAWDISKMAPPING&&(a=v),{valueInMB:v,validUnits:_.values(m),minInMB:i.isNew()?null:d.capacityInBytes/Math.pow(2,20),maxInMB:a,maxExceededErrorMessage:s,memoryUnitPreferred:g,isMaxAvailable:P(a)}}function y(e){return e.capacityInBytes?e.capacityInBytes/Math.pow(1024,2):e.capacityInKB/Math.pow(1024,1)}function P(e){return e<Math.pow(2,63)/Math.pow(2,20)}function C(e,t){var i;return i="vStorageSupported"===t,_.isEmpty(e,!0)?s.getAvailableDiskFormats("VMFS",i,!1,!0):s.getAvailableDiskFormats(e,i,!1,!0)}return{build:l,buildCapacity:S,buildControllersDropdown:d,buildDiskProvisioningTypes:C,getCapacityInMB:y}}])}(),angular.module("com.vmware.vsphere.client.vm").factory("VirtualMachineDevices",["vmDeviceInfoService","virtualDeviceInflator",function(e,t){var i=function(e,i,r,n,o,a){var s=this,c={storageProfiles:r,storageProfileAssignments:i,availableNetworks:n,deviceOptionsByDeviceType:o,isScheduledTask:a},l=t.inflateDevices(e,c),d=_.reduce(l,function(e,t){return e[t.getKey()]=t,e},{}),u={};this.addRgValidationCallback=function(e,t){u[e]=t},this.notifyRgValidationCallbacks=function(){var e=Object.keys(u);e.forEach(function(e){u[e]&&u[e]()})},this.getDeviceChanges=function(){var e=_.chain(this.getInflatedDevices()).filter(function(e){return e.hasChanged()}).map(function(e){return e.getCurrentDeviceSpec()}).value();return e},this.getFinalChanges=function(){var e=_.chain(this.getInflatedDevices()).filter(function(e){return e.hasChanged()}).map(function(e){return e.getFinalDeviceSpec()}).value();return e},this.findDeviceSpec=function(e){var t=_.find(d,function(t){return t.getKey()===e});return t&&t.getCurrentDeviceSpec()},this.getInflatedDevices=function(){return _.values(d)},this.getDeviceSpecForDevice=function(e){var i=d[e.key];return i||(i=t.inflate(e),d[e.key]=i),i.getCurrentDeviceSpec()},this.devicesOfType=function(e){return _.filter(d,function(t){return t.isOfType(e)})},this.devicesOfTypeNotMarkedForRemoval=function(e){return _.filter(d,function(t){return t.isOfType(e)&&!t.isMarkedForRemoval()})},this.existingDevicesOfType=function(e){return _.filter(this.devicesOfType(e),function(e){return!e.isNew()})},this.existingSortedDevicesOfType=function(e){var t=_.filter(this.devicesOfType(e),function(e){return!e.isNew()});return t.sort(function(e,t){var i=parseInt(e.deviceName().match(/\d+/g)[0],10),r=parseInt(t.deviceName().match(/\d+/g)[0],10);return i-r}),t},this.newDevicesOfType=function(e){return _.filter(this.devicesOfType(e),function(e){return e.isNew()})},this.findDevicesOfType=function(e){return this.devicesOfType(e)},this.changedDevicesOfType=function(e){return _.filter(this.devicesOfType(e),function(e){return e.hasChanged()})},this.removeDeviceByKey=function(e){var t=this.getVirtualDevice(e);t.isNew()?(delete d[e],delete u[e]):t.markForRemoval()},this.getAllDevicesNotMarkedForRemoval=function(){return _.filter(s.getInflatedDevices(),function(e){return!e.isMarkedForRemoval()})},this.getDevicesThatHaveBeenAssignedToNodes=function(){return _.chain(this.getAllDevicesNotMarkedForRemoval()).filter(function(e){return _.isNumber(e.getCurrentDevice().unitNumber)}).sortBy(function(e){return e.hasChanged()?1:-1}).map(function(e){return e.getCurrentDevice()}).value()},this.getDevicesAttachedToControllerKey=function(e){var t=s.getDevicesThatHaveBeenAssignedToNodes();return _.filter(t,function(t){return t.controllerKey===e})},this.getRdmDisksNotMarkedForRemoval=function(){return _.chain(this.getAllDevicesNotMarkedForRemoval()).filter(function(e){return _.isFunction(e.isRDMDisk)&&e.isRDMDisk()}).map(function(e){return e.getCurrentDevice()}).value()},this.isNodeInUse=function(e,t){var i=s.getAllDevicesNotMarkedForRemoval();return _.any(i,function(i){return i.getCurrentDevice().controllerKey===e&&i.getCurrentDevice().unitNumber===t})},this.getVirtualDevice=function(e){return d[e]},this.addVirtualDevice=function(e){var t=e.getKey();if(s.getVirtualDevice(t))throw new Error("VirtualDevice already exists for key "+t+":"+_.keys(d));d[t]=e},this.devicesMarkedForRemovalOfType=function(e){return _.filter(s.getInflatedDevices(),function(t){return t.isMarkedForRemoval()&&t.isOfType(e)})},this.devicesNotMarkedForRemovalOfType=function(e){return _.filter(s.getInflatedDevices(),function(t){return!t.isMarkedForRemoval()&&t.isOfType(e)})}};return i}]);var h5_vm;!function(e){var t=function(){function t(e,t){this.authorizationService=e,this.deviceClassLineageService=t,this.PCI_CONTROLLER_NAME="com.vmware.vim.binding.vim.vm.device.VirtualPCIController",this.DEVICE_TYPE_ETHERNET_SPEC="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard"}return t.prototype.fixNewDiskBackingDatastore=function(e){if(e&&e.device&&"add"===e.operation&&"com.vmware.vim.binding.vim.vm.device.VirtualDisk"===e.device._type){var t=e.device.backing;t&&t.datastore&&"StoragePod"===t.datastore.type&&(t.datastore=null)}},t.prototype.clearUnchangedConnectInfo=function(e,i){if(e&&e.device&&"add"!==e.operation&&i){var r=e.device.connectable,n=i.connectable;t.sameConnectInfo(n,r)&&(e.device.connectable=null)}},t.sameConnectInfo=function(e,t){return!t&&!e||!(!t||!e)&&(e.connected===t.connected&&(e.startConnected===t.startConnected&&e.allowGuestControl===t.allowGuestControl))},t.prototype.checkPermissions=function(e){return this.authorizationService.checkPrivilege(e,"VirtualMachine.Config.AddRemoveDevice")},t.prototype.checkPrivileges=function(e,t){return 0===_.difference(t,e).length},t.hasPrivileges=function(e,t){var i=_.difference(t,e);return 0===i.length},t.hasRecordReplay=function(e){var t=e.rtInfo;if(!t)return!1;var i=t.recordReplayState;return!!i&&"inactive"!==i},t.prototype.isPrimaryVm=function(e){return 1===e},t.prototype.isSecondaryVm=function(e){return e>1},t.prototype.isPrimaryFtVm=function(e,t){return!!t&&("notConfigured"!==e&&this.isPrimaryVm(t.role))},t.prototype.isSecondaryFtVm=function(e,t){return!!t&&("notConfigured"!==e&&this.isSecondaryVm(t.role))},t.prototype.isFtVm=function(e,t){return this.isPrimaryFtVm(e,t)||this.isSecondaryFtVm(e,t)},t.prototype.isVmPoweredOn=function(e){return"poweredOn"===e},t.prototype.isVmPoweredOff=function(e){return"poweredOff"===e},t.prototype.isVmSuspended=function(e){return"suspended"===e},t.prototype.bytesToMB=function(e){var t=1048576;return e/t},t.prototype.isFtVmConfigContext=function(e){var t=e.config.ftInfo,i=e.rtInfo,r=i?i.faultToleranceState:null,n=this.isFtVm(r,t);return n},t.prototype.haveVmConfigSettingsPermission=function(t){var i=t.privileges,r=this.checkPrivileges(i,[e.Privileges.VM_CONFIG_SETTINGS]);return r},t.userHasVmSettingsPermission=function(i){var r=i.privileges,n=t.hasPrivileges(r,[e.Privileges.VM_CONFIG_SETTINGS]);return n},t.userHasVmResourcePermission=function(i){var r=i.privileges,n=t.hasPrivileges(r,[e.Privileges.VM_RESOURCE_PRIVILEGE]);return n},t.noVmSettingsPermission=function(e){return t.userHasVmSettingsPermission(e)===!1},t.noVmResourcePermission=function(e){return t.userHasVmResourcePermission(e)===!1},t.userHasModifyDevicePermission=function(i){var r=[e.Privileges.VM_EDITDEVICE_PRIVILEGE],n=i.privileges,o=t.hasPrivileges(n,r);return o},t.userHasHostUsbPermission=function(i){var r=i.privileges,n=t.hasPrivileges(r,[e.Privileges.VM_HOST_USB_DEVICE]);return n},t.userHasAddRemoveDevicePermission=function(i){var r=i.privileges,n=t.hasPrivileges(r,[e.Privileges.VM_ADDREMOVEDEVICE]);return n},t.userHasStorageProfileViewPermission=function(i){var r=i.privileges,n=t.hasPrivileges(r,[e.Privileges.STORAGE_PROFILE_VIEW]);return n},t.userHasCryptographerManageKeyServersPermission=function(i){var r=i.privileges,n=t.hasPrivileges(r,[e.Privileges.CRYPTOGRAPHER_MANAGE_KEY_SERVERS]);return n},t.getPowerState=function(e){return e&&e.environment?e.environment.powerState:null},t.isPoweredOn=function(e){return"poweredOn"===t.getPowerState(e)},t.isPoweredOff=function(e){return"poweredOff"===t.getPowerState(e)},t.isSuspended=function(e){return"suspended"===t.getPowerState(e)},t.getVmCapabilities=function(e){return e.environment.configOption.capabilities},t.prototype.getDeviceOption=function(t,i){return e.VmHardwareUtil.getVirtualDeviceOption(t,i)},t.getVirtualDeviceOption=function(e,t){if(e.hasOwnProperty("environment")&&e.environment.hasOwnProperty("configOption")&&e.environment.configOption.hasOwnProperty("hardwareOptions")&&e.environment.configOption.hardwareOptions.hasOwnProperty("virtualDeviceOption"))return e.environment.configOption.hardwareOptions.virtualDeviceOption.find(function(e){return e.type.name===t},this)},t.prototype.isEthernetDevice=function(e){if(e.hasOwnProperty("device")&&e.device.hasOwnProperty("_type"))return this.deviceClassLineageService.isClassNameSubclassOf(e.device._type,this.DEVICE_TYPE_ETHERNET_SPEC)},t.$inject=["authorizationService","deviceClassLineageService"],t}();e.VmHardwareUtil=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareUtil",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.mutationService=e,this.CONVERT_TO_TEMPLATE_SPEC_NAME="com.vmware.vsphere.client.vm.VmTemplateSpec"}return e.prototype.markAsTemplate=function(e){this.mutationService.applyOnMultiEntity(e,this.CONVERT_TO_TEMPLATE_SPEC_NAME,{})},e.$inject=["mutationService"],e}();e.MarkAsTemplateService=t,angular.module("com.vmware.vsphere.client.vm").service("markAsTemplateService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.mixed.ManagedEntityMoveSpec,i=com.vmware.vsphere.client.h5.vm.data.ValidateMoveVmSpec,r=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){this.PROPERTY_TEMPLATE="template",this.PROPERTY_DATACENTER="dc",this.PROPERTY_MANAGED_BY_INFO="managedByInfo",this._mutationService=e,this._defaultUriSchemeUtil=t,this._vuiService=i,this._clarityModalService=r,this._i18nService=n,this._q=o,this._nameAndFolderValidatorService=a,this._managedEntityConstants=s,this._dataService=c,this._migrateVmWizardService=l,this._actionConfirmationService=d,this._managedByMessageBuilderService=u}return e.prototype.moveVms=function(e,t,i){var r=this;return t&&t.dropTarget?void this.applyMove(e,t.dropTarget):void(this.allVmsFromSameVc(e)?this.confirmIfRequired(e,i).then(function(t){r.showWizard(e,t)}):this.showMultipleVcsErrorDialog())},e.prototype.buildMoveSpec=function(e){var i=this._defaultUriSchemeUtil.getManagedObjectReferences(e),r=new t;return r.entities=i,r},e.prototype.applyMove=function(e,t){var i=this.buildMoveSpec(e);this._mutationService.apply(t,i._type,i)},e.prototype.validateMove=function(e,t){var i=this._defaultUriSchemeUtil.getEntityType(t),r=!1,n=!(i!==this._managedEntityConstants.DATACENTER);return i===this._managedEntityConstants.FOLDER&&(r=this._nameAndFolderValidatorService.isVmFolder(t)),r||n?this.retrieveValidationMessage(e,t):this._q.when(this._i18nService.getString("Common","moveTo.incorrectTargetTypeError"))},e.prototype.retrieveValidationMessage=function(e,t){var r=this._defaultUriSchemeUtil.getManagedObjectReferences(e),n=new i;return n.entities=r,this._mutationService.validate(t,n._type,n).then(function(e){return e.result})},e.prototype.showWizard=function(e,t){var i=this.buildSubtitle(e),r={title:this._i18nService.getString("VmUi","moveVmToFolderDialogTitle"),subTitle:i,defaultButton:"submit",dialogData:{objectIds:e,isTemplate:t[e[0]][this.PROPERTY_TEMPLATE],datacenter:this._defaultUriSchemeUtil.getVsphereObjectId(t[e[0]][this.PROPERTY_DATACENTER]),virtualCenter:this._defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(e[0])},contentTemplate:"vm-ui/resources/vm/services/wizards/moveVm/moveVmDialog.html"};this._clarityModalService.openOkCancelModal(r)},e.prototype.buildSubtitle=function(e){var t={};return 1===e.length?(t.objectId=e[0],t):(t.text=this._i18nService.getString("Common","contextMenu.title.nObjects",e.length),t)},e.prototype.allVmsFromSameVc=function(e){var t,i,r,n=this;return e&&e[0]&&(r=this._defaultUriSchemeUtil.getManagedObjectReference(e[0]).serverGuid),t=!0,_.each(e,function(e){i=n._defaultUriSchemeUtil.getManagedObjectReference(e),i.serverGuid!==r&&(t=!1)}),t},e.prototype.showMultipleVcsErrorDialog=function(){var e={title:this._i18nService.getString("VmUi","dialogMoveToVmLabel"),message:this._i18nService.getString("VmUi","MoveToDialog.MultipleVcErrors"),icon:"vui-icon32-error",submit:function(){return!0},hideCancelButton:!0};this._clarityModalService.openConfirmationModal(e)},e.prototype.confirmIfRequired=function(e,t){var i=this,r=this._q.defer();return this._dataService.getPropertiesForObjects(e,[this.PROPERTY_TEMPLATE,this.PROPERTY_DATACENTER,this.PROPERTY_MANAGED_BY_INFO]).then(function(n){if(!t)return void r.resolve(n);t.action.confirmationTextSome=i._i18nService.getString("Common","defaultConfirmation.someOK"),t.action.confirmationTextAll=i._i18nService.getString("Common","defaultConfirmation.allOK"),t.action.confirmationTitle=i._i18nService.getString("VmUi","moveVmToFolderDialogTitle");var o=1===Object.keys(t.evaluationStatuses).length;i._managedByMessageBuilderService.buildWarningMessage(e,o,n).then(function(e){e&&(t.action.confirmationText=e,t.action.confirmationTextSome=e+"\n\n"+t.action.confirmationTextSome,t.action.confirmationTextAll=e+"\n\n"+t.action.confirmationTextAll),i._actionConfirmationService.confirmIfRequired(t,function(){r.resolve(n)},!0)})}),r.promise},e.$inject=["mutationService","defaultUriSchemeUtil","vuiService","clarityModalService","i18nService","$q","nameAndFolderValidatorService","managedEntityConstants","dataService","migrateVmWizardService","actionConfirmationService","managedByMessageBuilderService"],e}();e.MoveVmService=r,angular.module("com.vmware.vsphere.client.vm").service("moveVmService",r)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e){return this.validate=function(e){var t={errors:{ipv4:{},ipv6:{}}},i=e.ipv4;i.required&&(this.isIpAddressInvalid(i)&&(t.errors.ipv4.address=!0),this.isSubnetMaskInvalid(i)&&(t.errors.ipv4.subnetMask=!0),this.isDefaultGatewayInvalid(i)&&(t.errors.ipv4.defaultGateway=!0),this.isAlternateGatewayInvalid(i)&&(t.errors.ipv4.alternateGateway=!0));var r=e.ipv6;return r.required&&(this.isIp6AddressInvalid(r)&&(t.errors.ipv6.address=!0),this.isIp6SubnetInvalid(r)&&(t.errors.ipv6.subnetPrefixLength=!0)),t},this.isIpAddressInvalid=function(t){return!e.isIpv4AddressValid(t.address)},this.isSubnetMaskInvalid=function(t){return!e.isSubnetMaskValid(t.subnetMask)},this.isDefaultGatewayInvalid=function(t){return!!t.defaultGateway&&!e.isIpv4AddressValid(t.defaultGateway)},this.isAlternateGatewayInvalid=function(t){return!!t.alternateGateway&&!e.isIpv4AddressValid(t.alternateGateway)},this.isIp6AddressInvalid=function(t){return!e.isIpv6AddressValid(t.address)},this.isIp6SubnetInvalid=function(t){return!e.isSubnetPrefixValid(t.subnetPrefixLength)},this}angular.module("com.vmware.vsphere.client.vm").service("nicValidatorService",e),e.$inject=["ipParserService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e){var t={powerState:"suspended",powerOpType:"hard"};return u(e,t)}function c(e){var t={powerOpType:"hard",powerState:"poweredOn",reset:!0};return u(e,t)}function l(e){var t={powerOpType:"soft",powerState:"poweredOn",reset:!0};return u(e,t)}function d(e,t,i,r,n,a){var s=function(){return a?u(e,t).then(a):u(e,t)},c={title:i,message:r,yesHandler:s,useClarity:!0,icon:null,clarityIcon:{shape:"warning","class":"is-warning",size:48},showXIcon:!1};n&&(c.icon=null),o.showConfirmationDialog(c)}function u(e,t){return i.applyOnMultiEntity(e,S,t)}function p(e,t){if(e&&e[0]&&e[0].result){var i=e[0].result.notAttempted;if(i&&0!==i.length){var r=_.map(i,function(e){return a.getVsphereObjectId(e.vm)});return void v(r,i)}e[0].result.recommendations&&m(e,t)}}function v(t,i){e.getPropertiesForObjects(t,["name","hostName","primaryIconId"]).then(function(e){var t={notAttempted:i,vmsProps:e},o={title:n.getString("VmUi","PowerOnVmResultFormMediator.failuresTitle"),contentTemplate:"vm-ui/resources/vm/views/powerops/vmPowerOnFailures.html",defaultButton:"close",hideSubmitButton:!0,closeButtonTitle:n.getString("Common","saveButtonLabel"),size:"lg",dialogData:t};r.openOkCancelModal(o)})}function m(e,i){t.fetchRecommendations(e).then(function(t){if(null!==t){var o=i.length>1?n.getString("VmUi","RecommendationsView.descriptionMultiVm"):n.getString("VmUi","RecommendationsView.descriptionSingleVm"),a={title:o,recommendations:t,rawRecommendations:e[0].result.recommendations},s={title:n.getString("VmUi","PowerOnVmResultFormMediator.powerOnRecommendations"),dialogData:a,contentTemplate:"vm-ui/resources/vm/views/powerops/vmPowerOnRecommendations.html",defaultButton:"submit",size:"lg"};r.openOkCancelModal(s)}})}function g(e){var t=[];return e.parentVApp&&t.push(n.getString("VmUi","PowerOnResolver.SingleVappWarning",e.name)),e.managedByInfo&&t.push(n.getString("Common","singleVmManagedByWarning",e.managedByInfo)),0===t.length?"":(t.push(n.getString("VmUi","PowerOnResolver.Continue")),t.join("\n\n"))}function h(e,t,i){var r=[],o=!1;_.each(e,function(e){
e.parentVApp&&r.push(e),e.managedByInfo&&(o=!0)});var a=[];1===r.length&&a.push(n.getString("VmUi","PowerOnResolver.SingleVappWarning",r[0].name)),r.length>1&&a.push(n.getString("VmUi","PowerOnResolver.MultiVappWarning",r.length)),o&&a.push(n.getString("Common","multiVmManagedByWarning"));var s=f(i.length,t);return s&&a.push(s),0===a.length?"":(a.push(n.getString("VmUi","PowerOnResolver.Continue")),a.join("\n\n"))}function f(e,t){var i=t.context.targetObjects.length-e;if(0===i)return"";var r,o=n.getString("VmUi","PowerOnResolver.SomeUnavailable",e,t.context.targetObjects.length);return r=1===i?n.getString("VmUi","PowerOnResolver.SingleDisabledOrNoPrivs"):n.getString("VmUi","PowerOnResolver.MultiDisabledOrNoPrivs",i),[o,r].join("\n\n")}var S="com.vmware.vsphere.client.vm.powerops.VmPowerStateSpec",y=function(t,i){var r,n={powerState:"poweredOn"},o=function(e){p(e,i)};e.getPropertiesForObjects(i,["parentVApp","name","managedByInfo"]).then(function(e){return 1===t.context.targetObjects.length?(r=g(e[i[0]]))?void d(i,n,t.action.label,r,!0,o):void u(i,n).then(o):(r=h(e,t,i))?void d(i,n,t.action.label,r,!0,o):void u(i,n).then(o)})},P=function(e){var t={powerOpType:"hard",powerState:"poweredOff"};return u(e,t)},C=function(e){var t={powerState:"poweredOff",powerOpType:"soft"};return u(e,t)};return{powerOnVm:y,powerOffVm:P,shutdownGuest:C,suspendVMs:s,resetVMs:c,rebootGuest:l,showPowerOnFailuresAndRecommendationsDialog:p}}angular.module("com.vmware.vsphere.client.vm").factory("powerOpsService",e),e.$inject=["dataService","vmRecommendationsService","mutationService","clarityModalService","i18nService","actionConfirmationService","defaultUriSchemeUtil"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.virtualDeviceInflator=e,this.deviceService=t,this.vmDeviceInfoService=i,this.defaultUriSchemeUtil=r,this.storageProfileService=n}return e.prototype.addDevices=function(e,t,i,r,n,o,a){var s=this,c={deviceOptionsByDeviceType:i,availableNetworks:n};_.each(t,function(t){var i=e.getVirtualDevice(t.device.key);if(_.isEmpty(i)){var n=s.virtualDeviceInflator.inflate(t.device,c);n.setCurrentDeviceSpec(t),e.addVirtualDevice(n)}else i.setCurrentDeviceSpec(t);s.updateVirtualDiskProperties(t,e,r,o,a)});var l=e.getInflatedDevices();this.deviceService.calculateKey(l)},e.prototype.setStorageForDisk=function(e,t,i){var r=e.backing.fileName.match(/\[(.*)\]/),n=r?r[1]:"",o=i[n],a=this.defaultUriSchemeUtil.getVsphereObjectId(o);if(a){var s={storageObject:{storageRef:o,name:n},name:n,id:a};return void t.setStorageForDisk(s,e)}if(e.backing.datastore){var s={storageObject:{storageRef:e.backing.datastore,name:n},name:n,id:this.defaultUriSchemeUtil.getVsphereObjectId(e.backing.datastore)};t.setStorageForDisk(s,e)}},e.prototype.updateVirtualDiskProperties=function(e,t,i,r,n){if(this.vmDeviceInfoService.isDeviceSubclassOf(e.device,"VirtualDisk")){var o=e.device.backing.fileName,a=o.lastIndexOf("]")!==o.length-1&&null===e.device.backing.datastore;e.device.createdFromExistingDisk=a,this.setStorageForDisk(e.device,i,r);var s=t.getVirtualDevice(e.device.key);if(s.setCurrentDeviceSpec(e),!a){var c=this.storageProfileService.areProfileSpecsEqual(e.device.profile&&e.device.profile[0],n[0],!1);s.setStorageProfileManuallySet(!c)}if(!_.isEmpty(e.profile)){var l=e.profile[0],d=void 0;l.replicationSpec&&(d={id:l.replicationSpec.replicationGroupId}),s.updateDiskProfile(l,d)}}},e.$inject=["virtualDeviceInflator","deviceService","vmDeviceInfoService","defaultUriSchemeUtil","storageProfileService"],e}();e.ScheduledTasksDeviceChangesService=t,angular.module("com.vmware.vsphere.client.vm").service("scheduledTasksDeviceChangesService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.data.VmCryptoUnlockSpec,i=function(){function e(e,t,i,r){this.mutationService=e,this.actionConfirmationService=t,this.i18nService=i,this.defaultUriSchemeUtil=r}return e.prototype.unlockVm=function(e,t,i){var r=this,n=i&&i.entityId?i.entityId:t[0];e&&e.action&&e.context&&(e.action.confirmationText=this.i18nService.getString("VmUi","cryptoUnlockVm.dialog.message"),e.context.targetObjects=[this.defaultUriSchemeUtil.getManagedObjectReference(n)]),this.actionConfirmationService.confirmIfRequired(e,function(){r.applyUnlockVM(n)})},e.prototype.applyUnlockVM=function(e){var i=new t;return this.mutationService.apply(e,i._type,i),!0},e.$inject=["mutationService","actionConfirmationService","i18nService","defaultUriSchemeUtil"],e}();e.UnlockVmService=i,angular.module("com.vmware.vsphere.client.vm").service("unlockVmService",i)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d){function u(e,t){v(t,e,!1)}function p(e,t){v(t,e,!0)}function v(e,t,i){var r=h(e);l.all(r).then(function(r){var n="";1===t.context.targetObjects.length&&(n=r.dataServiceProperties[e[0]].name),f(r,t,i,n)})}function m(e,i){t.applyOnMultiEntity(i,"com.vmware.vsphere.client.vm.VmConfigSpec",{config:{_type:"com.vmware.vim.binding.vim.vm.ConfigInfo",scheduledHardwareUpgradeInfo:{_type:"com.vmware.vim.binding.vim.vm.ScheduledHardwareUpgradeInfo",upgradePolicy:s.hardwareUpgradePolicy.never}}})}function g(e,t,i,r,n,o,a,s){var c={dialogData:{supportedVersions:e,description:t,allVms:i,hwVersion:r,scheduleMode:o},contentTemplate:"vm-ui/resources/vm/views/compatibility/upgradeVmHardwareView.html",title:n,defaultButton:"submit",alerts:[],onSubmit:a};return 1===i.length&&s&&(c.subTitle={text:s}),c}function h(t){var i=["config.version","optionDescriptors","managedByInfo","name"],r={dataServiceProperties:e.getPropertiesForObjects(t,i),is65VcOrLater:a.is65VcOrLater(t[0])};return r}function f(e,t,i,o){var a=e.dataServiceProperties,s=e.is65VcOrLater,l=c.buildSupportedVersionsForVms(a,s),d=i?1===t.context.targetObjects.length?r.getString("VmUi","UpgradeVmVirtualHardwareForm.singleVm.schedule.warning.nonUpgradable"):r.getString("VmUi","UpgradeVmVirtualHardwareForm.schedule.warning.nonUpgradable"):r.getString("VmUi","UpgradeVmVirtualHardwareForm.singleVm.warning.nonUpgradable"),u=i?r.getString("VmUi","UpgradeVmVirtualHardwareForm.schedule.title"):r.getString("VmUi","UpgradeVmVirtualHardwareForm.title");if(_.isEmpty(l))return void n.openConfirmationModal({title:u,message:d,submit:function(){},preserveNewlines:!0,saveButtonLabel:r.getString("Common","alert.ok"),cancelButtonLabel:null,hideCancelButton:!0,clarityIcon:{shape:"error","class":"is-error",size:48},showXIcon:!1});var p=i?r.getString("VmUi","UpgradeVmVirtualHardwareForm.schedule.description1"):r.getString("VmUi","UpgradeVmVirtualHardwareForm.description1"),v={selectedVersion:l[l.length-1]};i&&(v.isUpgradeAfterGuestOsShutdown=!1);var m=function(){return i?y(v.selectedVersion,v.isUpgradeAfterGuestOsShutdown):S(v.selectedVersion)},h=g(l,p,t.context.targetObjects,v,u,i,m,o);n.openOkCancelModal(h)}function S(e){var i={version:e.id};return t.applyOnMultiEntity(e.vms,"com.vmware.vsphere.client.vm.version.VmHwVersionSpec",i),!0}function y(e,i){var r={_type:"com.vmware.vsphere.client.vm.VmConfigSpec",config:{_type:"com.vmware.vim.binding.vim.vm.ConfigInfo",scheduledHardwareUpgradeInfo:{_type:"com.vmware.vim.binding.vim.vm.ScheduledHardwareUpgradeInfo",versionKey:e.id,upgradePolicy:i?s.hardwareUpgradePolicy.onSoftPowerOff:s.hardwareUpgradePolicy.always}}};return t.applyOnMultiEntity(e.vms,"com.vmware.vsphere.client.vm.VmConfigSpec",r),!0}return{upgradeVmHardware:u,scheduleUpgradeVmHardware:p,cancelScheduledVmHardwareUpgrade:m}}angular.module("com.vmware.vsphere.client.vm").service("upgradeVmHardwareService",e),e.$inject=["dataService","mutationService","actionConfirmationService","i18nService","clarityModalService","$timeout","vcService","upgradeVmHardwareConstants","vmHardwareCompatibilityService","$q","managedByMessageBuilderService"]}(),angular.module("com.vmware.vsphere.client.vm").service("virtualDiskInflator",["VirtualDisk","storageProfileService",function(e,t){return{build:function(i,r,n){var o;return n&&r&&(o=t.makeProfileFromDevice(i,r,n)),new e(i,o)}}}]);var h5_vm;!function(e){var t=function(){function t(e){this.VirtualNetworkDevice=e}return t.prototype.build=function(e,t){var i=this,r=e.backing,n=_.find(t,function(e){return i.compareBacking(e,r)});return new this.VirtualNetworkDevice(e,n)},t.prototype.compareBacking=function(t,i){if(i._type===e.NetBackingType.STD_NETWORK&&t._type===e.NetworkType.STD_NETWORK)return i.deviceName===t.name;if(i._type===e.NetBackingType.DVPORGGROUP&&t._type===e.NetworkType.DVPORGGROUP)return i.port.switchUuid===t.switchUuid&&i.port.portgroupKey===t.portgroupKey;if(i._type===e.NetBackingType.DVPORGGROUP&&t._type===e.NetworkType.DVSWITCH)return i.port.switchUuid===t.switchUuid&&_.isEmpty(i.port.portgroupKey);if(i._type===e.NetBackingType.NSX_NETWORK&&t._type===e.NetworkType.NSX_NETWORK){var r=t.network.opaqueNetworkId,n=t.network.opaqueNetworkType;return r===i.opaqueNetworkId&&n===i.opaqueNetworkType}return!1},t.$inject=["VirtualNetworkDevice"],t}();e.VirtualNetworkDeviceInflator=t,angular.module("com.vmware.vsphere.client.vm").service("virtualNetworkDeviceInflator",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("virtualControllerInflator",["VirtualController",function(e){function t(e){var t=new RegExp("^num\\w+Disks$"),i=_.find(_.keys(e),function(e){return e.match(t)});return i?e[i].max:0}function i(e){var t=new RegExp("^num\\w+Cdroms$"),i=_.find(_.keys(e),function(e){return e.match(t)});return i?e[i].max:0}return{build:function(r,n){var o=n[r._type];return new e(r,{maxDisks:t(o),maxCdroms:i(o)})}}}]),angular.module("com.vmware.vsphere.client.vm").service("virtualSCSIControllerInflator",["VirtualSCSIController",function(e){return{build:function(t,i){var r=i[t._type];return new e(t,{maxDisks:r.numSCSIDisks.max,maxCdroms:r.numSCSICdroms.max,reservedNode:r.scsiCtlrUnitNumber})}}}]);var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.data.MigrateOrMoveValidationSpec,i=function(){function e(e,t,i,r,n,o,a){this.MOVE_ACTION_ID="vsphere.core.vm.actions.moveVmOrTemplateFromDragAndDrop",this.MIGRATE_ACTION_ID="vsphere.core.vm.actions.migrate",this.MIGRATE_NETWORKING_BY_DRAG_ACTION_ID="vsphere.core.dvs.migrateVmNetworkingDragAndDropAction",this._actionsService=e,this._defaultUriSchemeUtil=t,this._managedEntityConstants=i,this._i18nService=r,this._actionConfirmationService=n,this._q=o,this._mutationService=a}return e.prototype.moveOrMigrateVm=function(e,t){var i=this,r=this._defaultUriSchemeUtil.getEntityType(t.dropTarget),n=!(!t||!t.dropTarget||r!==this._managedEntityConstants.FOLDER&&r!==this._managedEntityConstants.DATACENTER);return n?void this.invokeAction(e,t,this.MOVE_ACTION_ID):r===this._managedEntityConstants.NETWORK||r===this._managedEntityConstants.OPAQUE_NETWORK||r===this._managedEntityConstants.DISTRIBUTED_VIRTUAL_PORTGROUP?void this._actionsService.getAction(this.MIGRATE_NETWORKING_BY_DRAG_ACTION_ID,t.dropTarget).then(function(r){void 0===r&&(r={}),r.available&&i._actionsService.invokeAction(r,e,t)}):void this.invokeAction(e,t,this.MIGRATE_ACTION_ID)},e.prototype.invokeAction=function(e,t,i){var r=this;this._actionsService.getAction(i,e).then(function(e){void 0===e&&(e={}),e.action.label=r._i18nService.getString("VmUi","dialogMoveToVmLabel"),e.available===!0?(r.buildConfirmationMessages(e),r._actionsService.invokeAction(e,t)):r.displayWarning(e.action)})},e.prototype.buildConfirmationMessages=function(e){e.action.confirmationText="",e.action.confirmationTextSome=this._i18nService.getString("Common","defaultConfirmation.someOK"),e.action.confirmationTextAll=this._i18nService.getString("Common","defaultConfirmation.allOK")},e.prototype.displayWarning=function(e,t){void 0===e&&(e={}),void 0===t&&(t="");var i=e.confirmationTitle?e.confirmationTitle:e.label,r=t||e.confirmationTextNone||this._i18nService.getString("Common","defaultConfirmation.noneOK"),n={title:i,message:r};this._actionConfirmationService.showWarningDialog(n)},e.prototype.retrieveMoveOrMigrateData=function(e,i){var r=this,n=this._defaultUriSchemeUtil.getManagedObjectReference(e),o={moveVms:[],moveTarget:e,migrateVms:i,migrateTarget:e};switch(n.type){case this._managedEntityConstants.HOST:case this._managedEntityConstants.CLUSTER:case this._managedEntityConstants.RESOURCE_POOL:case this._managedEntityConstants.V_APP:var a=new t;a.target=n,a.entities=this._defaultUriSchemeUtil.getManagedObjectReferences(i);var s=this._i18nService.getString("VmUi","actionMoveVmLabel");return this._mutationService.validateSpec(a._type,a,s).then(function(e){if(!e.result||e.error)return{moveVms:[],moveTarget:"",migrateVms:[],migrateTarget:""};var t=e.result;return o.moveVms=r._defaultUriSchemeUtil.getVsphereObjectIds(t.moveVms),o.moveTarget=r._defaultUriSchemeUtil.getVsphereObjectId(t.moveTarget),o.migrateVms=r._defaultUriSchemeUtil.getVsphereObjectIds(t.migrateVms),o.migrateTarget=r._defaultUriSchemeUtil.getVsphereObjectId(t.migrateTarget),o});case this._managedEntityConstants.DATASTORE:case this._managedEntityConstants.STORAGE_POD:default:return this._q.when(o)}},e.$inject=["actionsService","defaultUriSchemeUtil","managedEntityConstants","i18nService","actionConfirmationService","$q","mutationService"],e}();e.VmDragAndDropService=i,angular.module("com.vmware.vsphere.client.vm").service("vmDragAndDropService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.VmRemovalSpec,i=function(){function e(e){this.mutationService=e}return e.prototype.unregisterVms=function(t){var i=e.buildRemovalSpec(!1);this.mutationService.removeOnMultiEntity(t,i._type,i)},e.prototype.deleteVms=function(t){var i=e.buildRemovalSpec(!0);this.mutationService.removeOnMultiEntity(t,i._type,i)},e.buildRemovalSpec=function(e){var i=new t;return i.deleteFromDisk=e,i},e.$inject=["mutationService"],e}();e.VmRemovalService=i,angular.module("com.vmware.vsphere.client.vm").service("vmRemovalService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.tools.VmToolsInstallerSpec,i=function(){function e(e,t,i){this.mutationService=e,this.i18nService=t,this.clarityModalService=i}return e.prototype.mount=function(e){return this.spec=new t,this.spec.operation="mountInstaller",this.mutationService.applyOnMultiEntity(e,this.spec._type,this.spec),!0},e.prototype.unmount=function(e){return this.spec=new t,this.spec.operation="unmountInstaller",this.mutationService.applyOnMultiEntity(e,this.spec._type,this.spec),!0},e.prototype.installUpgrade=function(e,t){var i={title:this.i18nService.getString("VmUi","VmToolsPopupForm.multiAction.title"),size:"lg",availableVmIds:t,totalVmsCount:e.context.targetObjects.length,defaultButton:"close"},r="vm-ui/resources/vm/views/tools/installUpgradeVmTools.html";this.clarityModalService.openModal(e,t,i,r)},e.$inject=["mutationService","i18nService","clarityModalService"],e}();e.VmToolsService=i,angular.module("com.vmware.vsphere.client.vm").service("vmToolsService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.vuiConstants=t,this.wizardPageService=i,this.vmVuiWizardPageBuilder=r,this.cloneVmBasicInformationPageModel=n}return e.prototype.build=function(e,t,i,r){var n=new this.cloneVmBasicInformationPageModel(e.wizardViewData,e.vmParams,null,e.config);return e.cloneVmBasicInformationPageModel=n,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","BasicInformationPage.title"),contentUrl:"vm-ui/resources/vm/views/clone/clone-vapp-basic-information.html",model:n,defaultState:this.vuiConstants.wizard.pageState.INCOMPLETE})},e.$inject=["i18nService","vuiConstants","wizardPageService","vmVuiWizardPageBuilder","cloneVmBasicInformationPageModel"],e}();e.CloneVappBasicInformationPageService=t,angular.module("com.vmware.vsphere.client.vm").service("cloneVappBasicInformationPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.TemplateType,i=function(){function e(e,t,i,n,o,a,s,c){return function(l,d,u,p){return new r(l,d,u,p,e,t,i,n,o,a,s,c)}}return e.$inject=["authorizationService","wizardPageService","nameAndFolderValidatorService","$q","i18nService","dataService","defaultUriSchemeUtil","featureFlagsService"],e}(),r=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){this.wizardViewData=e,this.virtualMachineSpecBuilder=t,this.basicInformation=i,this.wizardConfig=r,this.authorizationService=n,this.wizardPageService=o,this.nameAndFolderValidatorService=a,this.$q=s,this.i18nService=c,this.dataService=l,this.defaultUriSchemeUtil=d,this.featureFlagsService=u,this.VM_NAME_MAX_LENGTH=80,this.config=r,this.isVMTXPhase2Enabled=this.featureFlagsService.CL_Native_VMTX_Phase2Enabled()}return e.prototype.resetForm=function(){},e.prototype.changePages=function(e,t){e?(this.wizardPageService.markPageDisabled(this.config.pages,this.i18nService.getString("ProvisioningUiLib","LocationPage.title")),this.wizardPageService.markPageDisabled(this.config.pages,this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.Title")),this.wizardPageService.markPageSkipped(this.config.pages,this.i18nService.getString("ProvisioningUiLib","LibraryItemPage.title")),this.isVMTXPhase2Enabled?this.wizardPageService.markPageDisabled(this.config.pages,this.i18nService.getString("VmUi","SelectResourcePoolProvisioningPage.Title")):this.wizardPageService.markPageSkipped(this.config.pages,this.i18nService.getString("VmUi","SelectResourcePoolProvisioningPage.Title"))):(this.wizardPageService.markPageSkipped(this.config.pages,this.i18nService.getString("VmUi","SelectResourcePoolProvisioningPage.Title")),this.wizardPageService.markPageSkipped(this.config.pages,this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.Title")),t?(this.wizardPageService.markPageSkipped(this.config.pages,this.i18nService.getString("ProvisioningUiLib","LocationPage.title")),this.wizardPageService.markPageDisabled(this.config.pages,this.i18nService.getString("ProvisioningUiLib","LibraryItemPage.title"))):(this.wizardPageService.markPageDisabled(this.config.pages,this.i18nService.getString("ProvisioningUiLib","LocationPage.title")),this.wizardPageService.markPageSkipped(this.config.pages,this.i18nService.getString("ProvisioningUiLib","LibraryItemPage.title"))))},e.prototype.validatePage=function(){var e=this.$q.defer(),i=this.checkVmName();if(this.basicInformation.isPrivilegeError)e.resolve({error:this.i18nService.getString("ProvisioningUiLib","AddToLibrary.privilege.error")});else if(i)e.resolve({error:i});else if(this.featureFlagsService.CL_Native_VMTX_Phase2Enabled()&&this.basicInformation.templateType===t.VM_TEMPLATE){var r=["VirtualMachine.Inventory.CreateFromExisting"],n=this.basicInformation.folderObjectId,o=this;n&&0!==n.length?this.authorizationService.checkGrantedPrivileges(n,r).then(function(t){for(var i=!0,r=0;r<t.length;r++)t[r]||(i=!1,e.resolve({error:o.i18nService.getString("VmUi","SelectNameFolderProvisioningPage.NoCreateFromExistingPrivilegeOnFolder")}));i&&o.doFolderValidate(e)}):e.resolve({error:this.i18nService.getString("VmUi","SelectNameFolderProvisioningPage.specifyValidDestination.template")})}else e.resolve({error:null});return e.promise},e.prototype.doFolderValidate=function(e){var t=this,i={uid:this.basicInformation.folderObjectId,type:this.basicInformation.folder.nodeTypeId,item:this.basicInformation.folder};this.nameAndFolderValidatorService.validateNameAndGetLocationUids(this.basicInformation.name,i).then(function(i){i.validName?i.isVmFolder?e.resolve({error:null,folderUid:i.folderUid,datacenterUid:i.datacenterUid}):e.resolve({error:t.i18nService.getString("VmUi","SelectNameFolderProvisioningPage.specifyValidDestination.template")}):e.resolve({error:i.validationMessage})})},e.prototype.submitPage=function(e){var i=this;if(this.virtualMachineSpecBuilder.setName(this.basicInformation.name),!this.featureFlagsService.CL_Native_VMTX_Phase2Enabled()||this.basicInformation.templateType!==t.VM_TEMPLATE)return{};if(e.datacenterUid)this.virtualMachineSpecBuilder.setTargetInformation(this.basicInformation.folderObjectId,e.datacenterUid,e.folderUid,this.basicInformation.folder.text);else{var r=this;this.dataService.getProperties(this.basicInformation.folderObjectId,["dc"]).then(function(t){r.virtualMachineSpecBuilder.setTargetInformation(i.basicInformation.folderObjectId,r.defaultUriSchemeUtil.getVsphereObjectId(t.dc),e.folderUid,i.basicInformation.folder.text)})}return{}},e.prototype.checkVmNameLength=function(e){return this.convertVmName(e).length<=this.VM_NAME_MAX_LENGTH},e.prototype.convertVmName=function(e){return e.replace(/%/g,"%25").replace(/\//g,"%2f").replace(/\\/g,"%2c")},e.prototype.checkVmName=function(){return this.basicInformation.name?this.checkVmNameLength(this.basicInformation.name)?"":this.i18nService.getString("VmUi","NameValidator.nameTooLongSpecialChars"):this.i18nService.getString("VmUi","SelectNameFolderProvisioningPage.specifyValidName.template")},e.$inject=["authorizationService","wizardPageService","nameAndFolderValidatorService","$q","i18nService","dataService","defaultUriSchemeUtil","featureFlagsService"],e}();e.CloneVmBasicInformationPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("cloneVmBasicInformationPageModel",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.vuiConstants=t,this.wizardPageService=i,this.vmVuiWizardPageBuilder=r,this.cloneVmBasicInformationPageModel=n}return e.prototype.build=function(e,t,i,r){var n=new this.cloneVmBasicInformationPageModel(e.wizardViewData,e.vmParams,null,e.config);return e.cloneVmBasicInformationPageModel=n,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","BasicInformationPage.title"),contentUrl:"vm-ui/resources/vm/views/clone/clone-vm-basic-information.html",model:n,defaultState:this.vuiConstants.wizard.pageState.INCOMPLETE})},e.$inject=["i18nService","vuiConstants","wizardPageService","vmVuiWizardPageBuilder","cloneVmBasicInformationPageModel"],e}();e.CloneVmBasicInformationPageService=t,angular.module("com.vmware.vsphere.client.vm").service("cloneVmBasicInformationPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){return function(t,r){return new i(t,r,e)}}return e.$inject=["i18nService"],e}(),i=function(){function e(e,t,i){this.wizardScope=e,this.contentLibraryItem=t,this.i18nService=i}return e.prototype.resetForm=function(){},e.prototype.validatePage=function(){return this.wizardScope.cloneVmLibraryItemPageModel.contentLibraryItem?{}:{error:this.i18nService.getString("ProvisioningUiLib","LibraryItemPage.error.noLibraryItemSelected")}},e.prototype.submitPage=function(e){return{}},e.$inject=[],e}();e.CloneVmLibraryItemPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("cloneVmLibraryItemPageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.vmVuiWizardPageBuilder=i,this.cloneVmLibraryItemPageModel=r}return e.prototype.build=function(e,t,i,r){var n=new this.cloneVmLibraryItemPageModel(e);return e.cloneVmLibraryItemPageModel=n,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","LibraryItemPage.title"),description:this.i18nService.getString("ProvisioningUiLib","LibraryItemPage.description"),contentUrl:"vm-ui/resources/vm/views/clone/clone-vm-library-item.html",model:n})},e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","cloneVmLibraryItemPageModel"],e}();e.CloneVmLibraryItemPageService=t,angular.module("com.vmware.vsphere.client.vm").service("cloneVmLibraryItemPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){return function(r,n){return new i(r,n,e,t)}}return e.$inject=["i18nService","authorizationService"],e}(),i=function(){function t(e,t,i,r){this.wizardViewData=e,this.wizardScope=t,this.i18nService=i,this.authorizationService=r}return t.prototype.resetForm=function(){},t.prototype.validatePage=function(){var t=this;if(this.wizardScope.cloneVmLocationPageModel.contentLibrary){var i=this.wizardScope.cloneVmLocationPageModel.contentLibrary.id;return this.authorizationService.checkGrantedPrivileges(i,[e.Privileges.ADD_LIBRARY_ITEM]).then(function(e){var i={};return e[0]||(i.error=t.i18nService.getString("ProvisioningUiLib","LocationPage.error.noPrivilege")),i})}return{error:this.i18nService.getString("ProvisioningUiLib","LocationPage.error.noLibrarySelected")}},t.prototype.submitPage=function(e){return{}},t.$inject=[],t}();e.CloneVmLocationPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("cloneVmLocationPageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.vmVuiWizardPageBuilder=i,this.cloneVmLocationPageModel=r}return e.prototype.build=function(e,t,i,r){var n=new this.cloneVmLocationPageModel(e.wizardViewData,e);return e.cloneVmLocationPageModel=n,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","LocationPage.title"),description:this.i18nService.getString("ProvisioningUiLib","LocationPage.description"),contentUrl:"vm-ui/resources/vm/views/clone/clone-vm-location.html",model:n})},e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","cloneVmLocationPageModel"],e}();e.CloneVmLocationPageService=t,angular.module("com.vmware.vsphere.client.vm").service("cloneVmLocationPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.TemplateType,i=function(){function e(e,t,i,n,o,a){return function(s,c,l){return new r(e,t,i,n,s,c,l,o,a)}}return e.$inject=["mutationService","defaultUriSchemeUtil","wizardPageService","i18nService","pmemUtilService","storageSelectorConstants"],e}(),r=function(){function e(e,t,i,r,n,o,a,s,c){this.mutationService=e,this.defaultUriSchemeUtil=t,this.wizardPageService=i,this.i18nService=r,this.wizardViewData=n,this.virtualMachineSpecBuilder=o,this.wizardScope=a,this.pmemUtilService=s,this.storageSelectorConstants=c,this.ADD_VM_TO_LIB_SPEC="com.vmware.vsphere.client.provisioning.spec.AddToLibrarySpec",this.CREATE_VMTX_SPEC="com.vmware.vsphere.client.h5.vmtx.libraryItem.specs.CreateVmtxLibraryItemSpec",this.DEFAULT_STORAGE_ID="defaultId",this.USE_SPECIFIED_STORAGE_POLICY="USE_SPECIFIED_POLICY"}return e.prototype.resetForm=function(){},e.prototype.validatePage=function(){return{}},e.prototype.submitPage=function(e){return this.wizardScope.cloneVmBasicInformationPageModel.basicInformation.templateType===t.VM_TEMPLATE?this.cloneVmtxTemplate():this.cloneOvfTemplate()},e.prototype.cloneOvfTemplate=function(){var e=this,t=this.wizardViewData.getSourceObjectId(),i=this.getOvfSpec();return this.wizardPageService.showLoadingIndicator(this.wizardScope.config),this.mutationService.apply(t,this.ADD_VM_TO_LIB_SPEC,i).then(function(){return e.wizardPageService.hideLoadingIndicator(e.wizardScope.config),!0})},e.prototype.getOvfSpec=function(){var e,t,i=this.wizardScope.cloneVmBasicInformationPageModel.basicInformation;"new"===i.cloneOvfType?(t="",e=this.wizardScope.cloneVmLocationPageModel.contentLibrary.id):(t=this.wizardScope.cloneVmLibraryItemPageModel.contentLibraryItem.id,e=this.wizardScope.cloneVmLibraryItemPageModel.contentLibraryItem.libraryId);var r=(this.wizardScope.datastorePageModel.form.isAdvancedStorageMode,{contentLibrary:e,name:i.name,description:i.notes,libraryItem:t,exportFlags:this.buildOvfExportFlagsList(i.ovfExportFlags)});return r},e.prototype.buildOvfExportFlagsList=function(e){var t=[];return Array.isArray(e)&&e.forEach(function(e){e.selected&&t.push(e.option)}),t},e.prototype.cloneVmtxTemplate=function(){var e=this,t=this.wizardViewData.getSourceObjectId(),i=this.getVmtxSpec();return this.wizardPageService.showLoadingIndicator(this.wizardScope.config),this.mutationService.apply(t,this.CREATE_VMTX_SPEC,i).then(function(){return e.wizardPageService.hideLoadingIndicator(e.wizardScope.config),!0})},e.prototype.getVmtxSpec=function(){var e=this.wizardScope.cloneVmBasicInformationPageModel.basicInformation,t=this.wizardScope.cloneVmLocationPageModel.contentLibrary.id,i=this.wizardScope.datastorePageModel.form.isAdvancedStorageMode;if(!this.wizardScope.cloneVmBasicInformationPageModel.isVMTXPhase2Enabled)return _.extend({contentLibrary:t,name:e.name,description:e.notes},i?this.getAdvancedStorageSpec():this.getSimpleStorageSpec());var r=_.extend({contentLibrary:t,name:e.name,description:e.notes,folder:this.wizardScope.vmParams.getTargetInformation().folderUid},i?this.getAdvancedStorageSpec():this.getSimpleStorageSpec()),n=this.wizardScope.vmParams.getComputeResourceId(),o=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(n).type;switch(o){case"ClusterComputeResource":return _.extend(r,{cluster:n});case"HostSystem":return _.extend(r,{host:n});case"ResourcePool":return _.extend(r,{resourcePool:n});case"VirtualApp":return _.extend(r,{resourcePool:n});default:throw new Error("Unknown compute resouce id: "+n)}},e.prototype.getComputeResourceInfo=function(){var e=this.wizardScope.vmParams.getComputeResourceId(),t=this.wizardScope.vmParams.getComputeResourceName(),i=this.labelForType(e);return{name:t,label:i}},e.prototype.labelForType=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).type;switch(t){case"ClusterComputeResource":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Cluster");case"HostSystem":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Host");case"ResourcePool":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.RP");case"VirtualApp":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.RP");default:throw new Error("Unknown compute resouce id: "+e)}},e.prototype.getAdvancedStorageSpec=function(){for(var e=this.wizardScope.datastorePageModel.form.storageSelectorState.vmStorageConfigInAdvancedMode[0],t=this.getStorageSpecFromVmStorageComponent(e.vmHome),i={},r=0;r<e.vmDisks.length;r++){var n=e.vmDisks[r];i[n.key]=this.getStorageSpecFromVmStorageComponent(n)}return{vmHomeStorage:t,diskStorageOverrides:i}},e.prototype.fixStorageSpec=function(e){if(e&&e.storagePolicy){var t=e.storagePolicy.policy;t&&""!==t||(e.storagePolicy=null)}},e.prototype.getSimpleStorageSpec=function(){var e=this.wizardScope.datastorePageModel.form,t=e.selectedStorage.storageRef,i=this.defaultUriSchemeUtil.getVsphereObjectId(t),r=e.storageSelectorState?e.storageSelectorState.storageBaselineId:"",n=this.buildHomeStorageSpec(e,i);if(r===this.storageSelectorConstants.HYBRID_STORAGE_BASELINE.id){var o=this.buildVMDisksOverridesBasic();return{vmHomeStorage:n,diskStorageOverrides:o}}var a=e.storageProfilesData.selectedProfileForDisks,s=this.buildStorageSpec(this.getStorage(a,i),a);return{vmHomeStorage:n,diskStorage:s}},e.prototype.buildHomeStorageSpec=function(e,t){var i=e.storageProfilesData._currentVmProfileAssignment.vmHomeProfile,r=this.buildStorageSpec(t,i);return r},e.prototype.buildStorageSpec=function(e,t){var i={datastore:e,storagePolicy:this.hasDefaultStoragePolicy(t)?null:{type:this.USE_SPECIFIED_STORAGE_POLICY,policy:t?t.id:""}};return this.fixStorageSpec(i),i},e.prototype.buildVMDisksOverridesBasic=function(){var e=this.virtualMachineSpecBuilder.getVmId(),t=this.virtualMachineSpecBuilder.getVmDisksStorage(e);t=t?t[e]:[];for(var i={},r=0;r<t.length;r++){var n=t[r];"_configFile"!==n.key&&(i[n.key]=this.getStorageSpecFromVmStorageComponentBasic(n))}return i},e.prototype.hasDefaultStoragePolicy=function(e){return!e||e.id===this.DEFAULT_STORAGE_ID},e.prototype.getStorageSpecFromVmStorageComponent=function(e){var t=null;if(e.storageObj){var i=e.storageObj.storageRef;t=this.defaultUriSchemeUtil.getVsphereObjectId(i)}var r=this.buildStorageSpec(this.getStorage(e.storageProfile,t),e.storageProfile);return r},e.prototype.getStorageSpecFromVmStorageComponentBasic=function(e){var t=e.storage,i=this.buildStorageSpec(this.getStorage(e.profile,t),e.profile);
return i},e.prototype.getStorage=function(e,t){return this.pmemUtilService.isPMemStoragePolicy(e)?null:t},e.$inject=["mutationService","defaultUriSchemeUtil","wizardPageService","i18nService"],e}();e.CloneVmReviewPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("cloneVmReviewPageModel",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.vmVuiWizardPageBuilder=i,this.cloneVmReviewPageModel=r}return e.prototype.build=function(e,t,i,r){var n=new this.cloneVmReviewPageModel(e.wizardViewData,e.vmParams,e);return e.cloneVmReviewPageModel=n,this.vmVuiWizardPageBuilder.buildVuiWizardFinishPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","ReviewPage.title"),contentUrl:"vm-ui/resources/vm/views/clone/clone-vm-review.html",model:n})},e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","cloneVmReviewPageModel"],e}();e.CloneVmReviewPageService=t,angular.module("com.vmware.vsphere.client.vm").service("cloneVmReviewPageService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e){if(m(e)||!p(e))return u(e,e.getCreationType()).then(function(t){return i.add(d(e.getCreationType()),t)});var t=_.map(e.getVmRecommendationsSpec(),function(e){return e.key});return i.add("com.vmware.vsphere.client.vm.storageDrs.VmRecommendationsSpec",{recommendations:t,moRef:e.getStorageObject().storageRef})}function c(e,t){return u(e,e.getCreationType()).then(function(i){var r=v(i,d(e.getCreationType()),t.schedulingData);return o.createScheduledTask(r)})}function l(e){return!m(e)&&p(e)?u(e,e.getCreationType()).then(function(t){return r.getPlacementRecommendations(t,d(e.getCreationType()))}).then(function(e){if(!e.recommendations)return{faults:e.faults};var i={};e.recommendations.forEach(function(e){var r=t.getVsphereObjectId(e.target);i[r]||(i[r]={target:e.target},i[r].recommendations=[]),i[r].recommendations.push(e)});var n=null,o={};return angular.forEach(i,function(e){var t=r.findTopRecommendationInfo(e.recommendations);e.topRecommendation=t.topRecommendation,angular.extend(o,t.topRecommendedDatastorePerDisk),n||(n=t.topRecommendedDatastoreForVmx)}),{recommendationsPerPod:i,topRecommendedDatastoresPerDisk:o,topRecommendedDatastoreForVmx:n,faults:!1}}):a.when({topRecommendedDatastoreForVmx:t.getVsphereObjectId(e.getStorageObject().storageRef)})}function d(t){return t===e.CREATE_FROM_SCRATCH?"com.vmware.vsphere.client.vm.VmCreateSpec":t===e.DEPLOY_VM_FROM_VMTX?"com.vmware.vsphere.client.h5.vmtx.libraryItem.specs.DeployVmtxLibraryItemSpec":"com.vmware.vsphere.client.vm.VmCloneSpec"}function u(t,i){return i===e.CREATE_FROM_SCRATCH?a.when(t.getVmCreateSpec()):i===e.DEPLOY_VM_FROM_VMTX?a.when(t.getDeployVmtxSpec()):t.getVmCloneSpec()}function p(e){if(e.isXvc())return!1;if(r.areRecommendationsAvailableForStorageObject(e.getStorageObject()))return!0;var t=e.getStorageDiskList(),i=_.find(t,function(e){return r.areRecommendationsAvailableForStorageObject(e.dsObject)});return angular.isDefined(i)}function v(e,t,i){return i.spec=e,i.schedulingSpec.recurrence=n.formatRecurrenceData(i.schedulingSpec.recurrence),i.spec._type=t,i}function m(t){return e.isDeployVmFromVmtxTemplate(t.getCreationType())}return{createVm:s,validateSpec:l,createVmScheduledTask:c}}angular.module("com.vmware.vsphere.client.vm").factory("addVmService",e),e.$inject=["creationTypeConstants","defaultUriSchemeUtil","mutationService","datastoreRecommendationService","vscSchedulingHelper","vmCreateScheduledTaskMutationService","$q"]}(),angular.module("com.vmware.vsphere.client.vm").service("compatibilityCheckService",["mutationService","creationTypeConstants","defaultUriSchemeUtil","managedEntityConstants","storageProfileService",function(e,t,i,r,n){function o(t,n,o,a,s,d,u,p){var v=c(t,n,o,a,d,u),m=i.getManagedObjectReference(d);m.type===r.DATASTORE&&p&&p.length&&(v.disks=p);var g=l(o,t,s);return e.validate(g,"com.vmware.vsphere.client.vm.util.CompatibilityCheck",v)}function a(t,i,r,n,o,a){var s=c(t,i,r,n,a),d=l(r,t,o);return e.validate(d,"com.vmware.vsphere.client.vmui.provisioning.ComputeResourceCompatibilityCheckSpec",s)}function s(e,t){return d([{storageId:e,profile:{id:t}}])}function c(e,t,n,o,a,s){var c=null;t&&(c=i.getManagedObjectReference(t));var l={targetRef:i.getManagedObjectReference(e),folderRef:c,vmProvisioningType:n,vmName:o};if(s&&_.extend(l,{resPoolRef:i.getManagedObjectReference(s)}),a){var d=i.getManagedObjectReference(a);d.type===r.STORAGE_POD?l.podSelectionSpec={_type:"com.vmware.vim.binding.vim.storageDrs.PodSelectionSpec",storagePod:d}:d.type===r.DATASTORE&&(l.datastoreRef=d)}return l}function l(e,i,r){var n;return n=e===t.CREATE_FROM_SCRATCH||e===t.DEPLOY_VM_FROM_VAPP||e===t.DEPLOY_VM_FROM_TEMPLATE||e===t.DEPLOY_VM_FROM_OVF?i:r}function d(t){var r=[];_.each(t,function(e){var t=e.storageId?i.getPartsFromVsphereObjectId(e.storageId):void 0,o=null;e.profile.id&&e.profile.id!==n.DEFAULT_ID&&(o={_type:"com.vmware.vim.binding.pbm.profile.ProfileId",uniqueId:e.profile.id});var a={profileId:o,datastore:t?{type:t.type,value:t.value,serverGuid:t.serverGuid}:void 0};r.push(a)});var o="com.vmware.vsphere.client.spbm.spec.VmPlacementSpec";return e.validateMultiSpec(o,r).then(function(e){var t=[],i=[],r=[];return _.each(e,function(e){e.error&&!p(r,e.error)&&(r=r.concat(e.error)),_.each(e.result,function(e){e.error&&(t=t.concat(e.error)),e.warning&&(i=i.concat(e.warning))})}),t=r.concat(t),{errors:_.pluck(t,"localizedMessage"),warnings:i}})}function u(t){var r=_.map(t,function(e){var t=e.storageId?i.getManagedObjectReference(e.storageId):void 0,r=null;return e.profile.id&&e.profile.id!==n.DEFAULT_ID&&(r={_type:"com.vmware.vim.binding.pbm.profile.ProfileId",uniqueId:e.profile.id}),{profileId:r,datastore:t}}),o="com.vmware.vsphere.client.spbm.spec.VmPlacementSpec";return e.validateMultiSpec(o,r).then(function(e){var t=[],i=[];return _.each(e,function(e){var r=[],n=[];e.error&&!p(r,e.error)&&(r=r.concat(e.error)),_.each(e.result,function(e){e.error&&(r=r.concat(e.error)),e.warning&&(n=n.concat(e.warning))}),t.push(r),i.push(n)}),{errors:t,warnings:i}})}function p(e,t){return _.any(e,function(e){return e.localizedMessage===t.localizedMessage})}return{validate:o,validateComputeResource:a,validateVmPlacement:s,validateVmPlacementForMultipleVms:d,validateVmPlacementForMultipleVmsNoFilter:u}}]);var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.dataService=t,this.$q=i,this.defaultUriSchemeUtil=r,this.managedEntityConstants=n,this.NO_HOST_REF={value:"withoutHost",type:"HostSystem",serverGuid:"1-2-3-4-5"},this.NO_HOST_ID=this.defaultUriSchemeUtil.getVsphereObjectId(this.NO_HOST_REF),this.NO_HOST_NAME=this.i18nService.getString("VmUi","MigrationWizard.advancedCompatibilityDialog.noHostName"),this.NO_HOST_ICON="vsphere-icon-host",this.NO_VM_ID="withoutVm",this.NO_VM_NAME=this.i18nService.getString("VmUi","MigrationWizard.advancedCompatibilityDialog.noVmName"),this.NO_VM_ICON="vsphere-icon-vm"}return e.prototype.formatValidationResults=function(e,t){var i=this;void 0===t&&(t=!1);var r=this.getHostsWithErrorsAffectedObjects(e),n={},o=r.hostIds.indexOf(this.NO_HOST_ID);o>-1&&(n[this.NO_HOST_ID]={name:this.NO_HOST_NAME,primaryIconId:this.NO_HOST_ICON},r.hostIds.splice(o,1));var a=r.vmIds.indexOf(this.NO_VM_ID);if(a>-1&&(n[this.NO_VM_ID]={name:this.NO_VM_NAME,primaryIconId:this.NO_VM_ICON},r.vmIds.splice(a,1)),0===r.hostIds.length&&0===r.vmIds.length)return this.$q.when(this.formatValidationResultsInternal(e,_.extend({},n),t));var s=["primaryIconId","name"];return this.$q.all([this.dataService.getPropertiesForObjects(r.hostIds,s),this.dataService.getPropertiesForObjects(r.vmIds,s)]).then(function(r){return i.formatValidationResultsInternal(e,_.extend({},r[0],r[1],n),t)})},e.prototype.getHostsWithErrorsAffectedObjects=function(e){var t=this,i={},r={};return _.each(e,function(e){return e.error?void(e.entity&&e.entity.type===t.managedEntityConstants.VIRTUAL_MACHINE&&(r[t.defaultUriSchemeUtil.getVsphereObjectId(e.entity)]=null)):void _.each(e.result,function(n){if(n.error||n.warning||n.info){n.host&&(i[t.defaultUriSchemeUtil.getVsphereObjectId(n.host)]=null);var o=n.vm;!o&&e.entity&&e.entity.type===t.managedEntityConstants.VIRTUAL_MACHINE&&(o=e.entity),o&&t.defaultUriSchemeUtil.getVsphereObjectId(o)?r[t.defaultUriSchemeUtil.getVsphereObjectId(o)]=null:r[t.NO_VM_ID]=null}})}),{hostIds:Object.keys(i),vmIds:Object.keys(r)}},e.prototype.formatValidationResultsInternal=function(e,t,i){var r=this,n=[];if(_.each(e,function(e){var i=r.formatSingleValidationResult(e,t);null!==i&&n.push(i)}),_.isEmpty(n)&&i){var o={icon:"vsphere-icon-status-ok",message:this.i18nService.getString("VmUi","MigrationCompatibilityResultsView.Success"),contents:[],advancedCompatibilityContents:{hostMap:{},vmId:this.NO_VM_ID,vmProps:{icon:this.NO_VM_ICON,name:this.NO_VM_NAME}}};o.advancedCompatibilityContents.hostMap[this.NO_HOST_ID]={errors:[],warnings:[],infos:[],props:{icon:this.NO_HOST_ICON,name:this.NO_HOST_NAME}},n.push(o)}return n},e.prototype.formatSingleValidationResult=function(e,t){var i=e.result;if(e.error)return this.handleInitErrors(e,t);var r=_.filter(i,function(e){return e.error&&e.error.length>0||e.warning&&e.warning.length>0||e.info&&e.info.length>0});if(0===r.length)return null;var n=this.buildBasicCompatibilityContents(t,r),o=this.buildAdvancedCompatibilityContents(e,t,r),a=this.defaultUriSchemeUtil.getVsphereObjectId(e.entity)?this.defaultUriSchemeUtil.getVsphereObjectId(e.entity):this.NO_VM_ID,s=t[a];return{icon:s.primaryIconId,message:s.name,contents:n,advancedCompatibilityContents:o}},e.prototype.handleInitErrors=function(e,t){var i=this.defaultUriSchemeUtil.getVsphereObjectId(e.entity)?this.defaultUriSchemeUtil.getVsphereObjectId(e.entity):this.NO_VM_ID,r=t[i]&&t[i].name?t[i].name:this.NO_VM_NAME,n=t[i]&&t[i].primaryIconId?t[i].primaryIconId:this.NO_VM_ICON,o={icon:"vsphere-icon-status-error",message:this.extractErrorMessage(e.error),contents:[],advancedCompatibilityContents:{hostMap:{},vmId:i,vmProps:{name:r,icon:n}}};return o.advancedCompatibilityContents.hostMap[this.NO_HOST_ID]={errors:[e.error.message||e.error.localizedMessage],warnings:[],infos:[],props:{name:this.NO_HOST_NAME,icon:this.NO_HOST_ICON}},o},e.prototype.buildBasicCompatibilityContents=function(e,t){var i=this,r=[];return _.each(t,function(t){var n=t.host,o=_.map(t.error,function(e){return{icon:"vsphere-icon-status-error",message:e.message||e.localizedMessage,contents:[]}}),a=_.map(t.warning,function(e){return{icon:"vsphere-icon-status-warning",message:e.message||e.localizedMessage,contents:[]}}),s=_.map(t.info,function(e){return{icon:"vsphere-icon-help-info-hover",message:e.message||e.localizedMessage,contents:[]}});if(n&&i.defaultUriSchemeUtil.getVsphereObjectId(n)!==i.NO_HOST_ID){var c=e[i.defaultUriSchemeUtil.getVsphereObjectId(n)];r.push({icon:c.primaryIconId,message:c.name,contents:o.concat(a).concat(s)})}else r=r.concat(o).concat(a).concat(s)}),r},e.prototype.buildAdvancedCompatibilityContents=function(e,t,i){var r=this,n={};_.each(i,function(e){var i=e.host,o=_.map(e.error,function(e){return e.message||e.localizedMessage}),a=_.map(e.warning,function(e){return e.message||e.localizedMessage}),s=_.map(e.info,function(e){return e.message||e.localizedMessage}),c=r.NO_HOST_ID,l={name:r.NO_HOST_NAME,icon:r.NO_HOST_ICON};i&&(c=r.defaultUriSchemeUtil.getVsphereObjectId(i),l={name:t[c].name,icon:t[c].primaryIconId}),n[c]||(n[c]={errors:[],warnings:[],infos:[],props:l}),n[c].errors=n[c].errors.concat(o),n[c].warnings=n[c].warnings.concat(a),n[c].infos=n[c].infos.concat(s)});var o={},a=this.defaultUriSchemeUtil.getVsphereObjectId(e.entity);return o.hostMap=n,o.vmId=a,a?o.vmProps={name:t[a].name,icon:t[a].primaryIconId}:o.vmProps={name:this.NO_VM_NAME,primaryIconId:this.NO_VM_ICON},o},e.prototype.extractErrorMessage=function(e){var t=e.message||e.localizedMessage;return t||(t=e.reason?this.i18nService.getString("VmUi","compatibilityCheck.genericError.reason",e.reason):this.i18nService.getString("VmUi","compatibilityCheck.genericError")),t||""},e.$inject=["i18nService","dataService","$q","defaultUriSchemeUtil","managedEntityConstants"],e}();e.CompatibilityResultsPresenter=t,angular.module("com.vmware.vsphere.client.vm").service("compatibilityResultsPresenter",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.data.RegisterVmCompatibilityCheckSpec,i=function(){function e(e,t){this.defaultUriSchemeUtil=e,this.mutationService=t}return e.prototype.validate=function(e,i,r){return this.spec=new t,this.spec.targetRef=this.defaultUriSchemeUtil.getManagedObjectReference(e),this.spec.datastoreRef=this.defaultUriSchemeUtil.getManagedObjectReference(i),this.spec.isTemplate=r,this.mutationService.validate(e,this.spec._type,this.spec)},e.$inject=["defaultUriSchemeUtil","mutationService"],e}();e.RegisterVmCompatibilityCheckService=i,angular.module("com.vmware.vsphere.client.vm").service("registerVmCompatibilityCheckService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.vm.VmCloneSpec,i=com.vmware.vim.binding.vim.vm.CloneSpec,r=com.vmware.vim.binding.vim.vm.RelocateSpec,n=com.vmware.vim.binding.vim.vm.RelocateSpec$DiskLocator,o=com.vmware.vsphere.client.spbm.spec.CalculateProvisioningCostSpec,a=com.vmware.vim.binding.pbm.profile.ProfileId,s=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){this.authorizationService=e,this.compatibilityCheckService=t,this.i18nService=i,this.compatibilityResultsPresenter=r,this.$q=n,this.defaultUriSchemeUtil=o,this.mutationService=a,this.managedEntityConstants=s,this.dataService=c,this.bytesFilter=l,this.diskProvisioningService=d,this.storageProfileService=u,this.DATASTORE_ALLOCATESPACE="Datastore.AllocateSpace"}return e.prototype.validateSelection=function(e,t,i,r,n,o,a){var s=this;return this.$q.all({privilegesCheck:this.checkPrivileges(e),compatibilityResult:this.checkCompatibility(i,t,a),placementCheck:this.checkVmPlacement(e),provisioningCostCheck:this.requestProvisioningCost(r,n,!0,o)}).then(function(e){var i=s.getSuccessForCompatibility(e.compatibilityResult);return s.addToValidationResult(e.privilegesCheck,e.compatibilityResult),s.addToValidationResult(e.placementCheck,e.compatibilityResult),s.addToValidationResult(e.provisioningCostCheck,e.compatibilityResult),s.compatibilityResultsPresenter.formatValidationResults([e.compatibilityResult]).then(function(r){return r.length>0?(t.name&&(r[0].message=t.name,r[0].advancedCompatibilityContents.vmProps.name=t.name),{compatibilityMessages:r,hasSuccess:i&&e.privilegesCheck.hasSuccess&&e.placementCheck.hasSuccess&&e.provisioningCostCheck.hasSuccess}):{compatibilityMessages:[{icon:"vsphere-icon-status-ok",message:s.i18nService.getString("VmUi","ProvisioningWizard.CompatibilityChecksSucceeded"),contents:[],advancedCompatibilityContents:{}}],hasSuccess:!0}})})},e.prototype.getSuccessForCompatibility=function(e){return!e.error&&_.any(e.result,function(e){return!e.error})},e.prototype.addToValidationResult=function(e,t){var i={error:_.map(e.compatibilityData.errors,function(e){return{message:e,localizedMessage:e}}),warning:_.map(e.compatibilityData.warnings,function(e){return{message:e,localizedMessage:e}}),info:_.map(e.compatibilityData.infos,function(e){return{message:e,localizedMessage:e}}),host:this.compatibilityResultsPresenter.NO_HOST_REF,vm:t.entity};(i.error.length||i.warning.length||i.info.length)&&(t.result||(t.result=[]),t.result.push(i))},e.prototype.checkPrivileges=function(e){var t=this,i=[],r={};return _.each(e.virtualDisksByVm,function(e){_.each(e,function(e){var i=t.defaultUriSchemeUtil.getManagedObjectReference(e.storage);e.storage&&!r[e.storage]&&i.type===t.managedEntityConstants.DATASTORE&&(r[e.storage]=!0)})}),i=_.keys(r),this.authorizationService.checkPrivilegesForMultipleObjects(i,["Datastore.AllocateSpace"]).then(function(e){var r=!0;_.each(i,function(i){e[i][t.DATASTORE_ALLOCATESPACE]||(r=!1)});var n={compatibilityData:{errors:[],warnings:[],infos:[]},hasSuccess:!0};return r||(n.hasSuccess=!1,n.compatibilityData.errors=[t.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.NoPermissionOnDatastore")]),n})},e.prototype.checkCompatibility=function(e,t,i){return t.testsToRun&&t.testsToRun.length&&!i?this.mutationService.validate(e,t._type,t):this.$q.when({entity:this.defaultUriSchemeUtil.getManagedObjectReference(e),error:null,propertyName:null,parameter:null,result:[{vm:null,host:null,disk:null,warning:null,error:null}]})},e.prototype.buildVmCloneSpec=function(e,n,o,a,s,c){var l=[],d=new t;d.folder=e,d.vm=o,d.name=n;var u=new i;u.template=!1,u.powerOn=!1;var p=new r;return p.pool=a,s.type===this.managedEntityConstants.HOST&&(p.host=s),c.vmHome.storageObj&&c.vmHome.storageObj.storageRef.type!==this.managedEntityConstants.STORAGE_POD&&o&&this.defaultUriSchemeUtil.getVsphereObjectId(o)&&(p.datastore=c.vmHome.storageObj.storageRef,p.disk=this.buildDiskLocators(c),l.push("datastoreTests")),d.testsToRun=l,u.location=p,d.cloneSpec=u,d},e.prototype.buildDiskLocators=function(e){var t=this,i=e.vmDisks,r=_.filter(i,function(e){return!t.storageProfileService.isPmemStorageProfile(e.storageProfile)}),o=_.map(r,function(e){var i=new n;return i.diskId=e.key,e.storageObj&&e.storageObj.storageRef.type!==t.managedEntityConstants.STORAGE_POD&&(i.datastore=e.storageObj.storageRef,i.diskBackingInfo="sameAsSource"===e.diskFormat.type?null:t.diskProvisioningService.getBackingInfo(e.diskFormat.type)),i.profile=t.getProfileForDisk(e),i});return _.filter(o,function(e){return e.datastore})},e.prototype.getProfileForDisk=function(e){var t=e.storageProfile?e.storageProfile.id:void 0,i=this.storageProfileService.makeProfile(t);return[i]},e.prototype.checkVmPlacement=function(e){var t=this,i=[];return _.each(e.virtualDisksByVm,function(e){_.each(e,function(e){e.profile&&i.push({storageId:e.storage,profile:e.profile})})}),0===i.length?this.$q.resolve({compatibilityData:{errors:[],warnings:[],infos:[]},hasSuccess:!0}):this.compatibilityCheckService.validateVmPlacementForMultipleVms(i).then(function(e){var i=t.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpbmPolicyWarning"),r=!1,n=[];return _.each(e.warnings,function(e){if(!_.isEmpty(e)){var t=e.localizedMessage;if(null===t&&null!==e.faultMessage&&e.faultMessage.length>0&&(t=e.faultMessage[0].message),t)return void n.push(t)}r||(r=!0,n.push(i))}),{compatibilityData:{errors:e.errors,warnings:n,infos:[]},hasSuccess:!e.errors.length}})},e.prototype.validateDisksSdrsMap=function(e){var t=this,i={},r=e.vmDisks,n=_.any(r,function(e){if(t.isDiskPlacedOnSdrsCluster(e)){var r=t.isSdrsEnabledValue(e.storageObj),n=t.defaultUriSchemeUtil.getVsphereObjectId(e.storageObj.parentStoragePod||e.storageObj.storageRef);if(n in i&&i[n]!==r)return!0;i[n]=r}return!1});if(n)return!1;var o=this.isSdrsEnabledValue(e.vmHome.storageObj),a=this.defaultUriSchemeUtil.getVsphereObjectId(e.vmHome.storageObj.parentStoragePod||e.vmHome.storageObj.storageRef);return!(a in i&&i[a]!==o)},e.prototype.isDiskPlacedOnSdrsCluster=function(e){return e.storageObj&&(e.storageObj.storageRef.type===this.managedEntityConstants.STORAGE_POD||e.storageObj.parentStoragePod)},e.prototype.isSdrsEnabledValue=function(e){return e.storageRef.type===this.managedEntityConstants.STORAGE_POD||(!e.parentStoragePod||!e.parentStoragePod.isSdrsEnabled)},e.prototype.requestProvisioningCost=function(e,t,i,r){var n=this,o=[],a=!1;if(!t)return this.$q.when(this.formatDiskCostSpec([],[]));if(i){var s=t.vmDisks;_.each(s,function(e){var t=n.getDiskObject(r,e.key);if(e.storageObj){a=a||"vsan"===e.storageObj.type;var i=n.createCalculateProvisioningCostSpec(e.storageProfile&&e.storageProfile.id,e.storageObj,t&&t.capacityInBytes?t.capacityInBytes:0);o.push(i)}});var c=this.createCalculateProvisioningCostSpec(t.vmHome.storageProfile&&t.vmHome.storageProfile.id,t.vmHome.storageObj,1);o.push(c)}else _.each(r,function(e){if(t.vmHome.storageObj){a=a||"vsan"===t.vmHome.storageObj.type;var i=n.createCalculateProvisioningCostSpec(t.vmHome.storageProfile&&t.vmHome.storageProfile.id,t.vmHome.storageObj,e.capacityInBytes);o.push(i)}});return a?this.dataService.getProperties(e,["spbmCreateCostData"],{propertyParams:[{propertyName:"spbmCreateCostData",parameterType:"[Lcom.vmware.vsphere.client.spbm.spec.CalculateProvisioningCostSpec;",parameter:o}]}).then(function(e){return n.formatDiskCostSpec(e.spbmCreateCostData,r)}):this.$q.when(this.formatDiskCostSpec([],[]))},e.prototype.getDiskObject=function(e,t){return _.find(e,function(e){return e.key===t})},e.prototype.createCalculateProvisioningCostSpec=function(e,t,i){var r=new o;return r.sizeInBytes=i,e&&"defaultId"!==e&&(r.profileId=new a,r.profileId.uniqueId=e),r.storageContainer=t.storageRef,r},e.prototype.formatDiskCostSpec=function(e,t){if(!e||!e.length)return{compatibilityData:{errors:[],warnings:[],infos:[]},hasSuccess:!0};var i=0,r=0,n=!1;_.each(t,function(t,o){var a=e[o],s=a.cost;if(s&&s.isSatisfiable&&s.cost){var c=s.cost;c&&(n=!0,i+=t.capacityInBytes*c.diskSpaceToAddressSpaceRatio,r+=c.currentFlashReadCacheSize+c.changeFlashReadCacheSize)}});var o=[];return n&&o.push(this.i18nService.getString("VmUi","whatIf.vsanConsumption",this.bytesFilter(i),this.bytesFilter(r))),{compatibilityData:{errors:[],warnings:[],infos:o},hasSuccess:!0}},e.$inject=["authorizationService","compatibilityCheckService","i18nService","compatibilityResultsPresenter","$q","defaultUriSchemeUtil","mutationService","managedEntityConstants","dataService","bytesFilter","diskProvisioningService","storageProfileService"],e}();e.VmProvisioningStorageSelectionValidationService=s,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningStorageSelectionValidationService",s)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("createVmWizardService",["$q","$rootScope","$injector","vuiService","i18nService","dataService","wizardPageService","defaultUriSchemeUtil","creationTypeConstants","VirtualMachineSpecBuilder","ProvisioningWizardViewData","creationTypeServiceFactory","managedEntityConstants","vmCreateEditScheduledTaskService","vmCloneEditScheduledTaskService",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){function g(e,t,i){var r={cloneVmToTemplate:"ProvisioningTypes.CloneVmToTemplate.WizardTitle",cloneVappToLibrary:"ProvisioningTypes.CloneVappToTemplate.WizardTitle",createVmFromScratch:"ProvisioningTypes.CreateFromScratch.WizardTitle",cloneTemplateToVm:"ProvisioningTypes.DeployFromTemplate.WizardTitle",deployVmFromVmtx:"ProvisioningTypes.DeployFromVmtx.WizardTitle",cloneVmToVm:"ProvisioningTypes.CloneVmToVm.WizardTitle",convertTemplateToVm:"ProvisioningTypes.ConvertTemplateToVm.WizardTitle",cloneTemplateToTemplate:"ProvisioningTypes.CloneTemplateToTemplate.WizardTitle",deployVmFromOvf:"ProvisioningTypes.OvfDeployWizard.WizardTitle",registerVm:i?"regVm.template.title":"regVmWizard.tiwoDesc",deployVmFromTemplate:"ProvisioningTypes.DeployFromContentLibraryTemplate.WizardTitle",deployVmFromVapp:"ProvisioningTypes.DeployFromContentLibraryVapp.WizardTitle",cloneVmToLibrary:"ProvisioningTypes.CloneVmToTemplate.WizardTitle",ScheduledTaskcreateVmFromScratch:"ProvisioningTypes.ScheduledTask.CreateFromScratch.WizardTitle",ScheduledTaskEditcreateVmFromScratch:"ProvisioningTypes.ScheduledTask.EditCreateFromScratch.WizardTitle",ScheduledTaskcloneVmToVm:"ProvisioningTypes.ScheduledTask.CloneVmToVm.WizardTitle",ScheduledTaskEditcloneVmToVm:"ProvisioningTypes.ScheduledTask.EditCloneVmToVm.WizardTitle"};return n.getString("VmUi",r[e]+".2",t)}function h(t,i,r){var n,a,l={},d=!1,u=[M,O,A];if(r&&r.isScheduledTask){d=!0;var g=r.schedulingData.scheduleTaskOperationMode;g===H&&(i===c.CREATE_FROM_SCRATCH&&(a=v),i===c.CLONE_VM_TO_VM&&(a=m,u.push(k)),n=a.buildCreateVmData(r.schedulingData),t=n.contextObjId,l[B]=a.requestScheduledData(t,n))}switch(I=t,_=s.getPartsFromVsphereObjectId(I),T=void 0,E=void 0,_.type){case p.VIRTUAL_MACHINE:u.push(V,R)}C(i,u,d,r),l[G]=o.getProperties(I,u),e.all(l).then(function(e){r&&r.hasOwnProperty("libraryItemName")&&(e[G][M]=r.libraryItemName),f(i,e[G],r,d,n,a)})}function f(e,n,o,v,m,h){if(v&&_.type===p.FOLDER){var f=n[k];f.type===p.DATACENTER&&(I=s.getVsphereObjectId(f),_=s.getPartsFromVsphereObjectId(I))}var C=t.$new();C.vmParams=new l,C.wizardViewData=new d,C.vmParams.setCreationType(e),e===c.DEPLOY_VM_FROM_VMTX&&(C.vmParams.setLibraryItemId(o.libraryItemId),C.vmParams.setVmtxLibraryItemId(I)),C.attributes={creationType:e},_.type===p.VIRTUAL_MACHINE&&(C.vmParams.setVmId(I),C.wizardViewData.setSourceObjectName(n[M]),C.vmParams.setGuestOsId(n[V]),C.vmParams.setVappPropertyDescriptors(n[R]));var D=c.isDeployVmFromTemplate(e)||c.isDeployVmFromVapp(e);D&&C.wizardViewData.setTemplateId(I);var w=s.getRootFolder(n[A]);C.wizardViewData.setVCenterId(w);var T=S(n,e);C.wizardViewData.setDatacenterId(T);var E=!1,N=c.isRegisterVm(e);if(N){E=o.isTemplate,C.vmParams.setRegisterVmData(o),C.vmParams.setName(o.vmName),C.vmParams.setStorageObject(I);var U=n[O],L=s.getVsphereObjectId(U);C.wizardViewData.setDatacenterId(L)}var F=y(e,n,v,m);F&&(C.wizardViewData.setSourceObjectName(n[M]),C.wizardViewData.setSourceObjectId(I)),e===c.CREATE_FROM_SCRATCH&&b(n,C.wizardViewData),c.isCloningVmToLibrary(e)&&(C.wizardViewData.setSourceObjectId(I),C.vmParams.setName(n[M]),o&&C.vmParams.setTargetInformation(null,null,o.folderUid,null));var x=P(),$=e;if(v){C.scheduleTaskData={isScheduledTask:o.isScheduledTask,schedulingData:o.schedulingData};var z=o.schedulingData.scheduleTaskOperationMode;z===H?($="ScheduledTaskEdit"+e,m&&h.setVmParams(m,C.vmParams,C.wizardViewData)):$="ScheduledTask"+e}C.config={title:g($,n[M],E),cssClass:"provisioning-vm-wizards"};var B=u.serviceForCreationType(e),G=B.buildPages(C,T,F,x);C.config.pages=a.initializePageStates(G.pages),C.config.flows=G.flows;var j=!1;C.config.onFinish=function(){return j=!0,!0},C.config.onClose=function(){if(!j){var e=i.get("vscOvfWorkflowProxyService"),t=C.wizardViewData.getDeployOvfSession(),r=t&&t.deployOvfSessionId?t.deployOvfSessionId:"";r&&e.cancelSession$(r),C.config.show=!1}},C.wizardViewData.defaultTarget=T,r.createWizard({scope:C,configObjectName:"config"}).show()}function S(e,t){var i=e[T];if(t!==c.CREATE_FROM_SCRATCH&&i)return s.getVsphereObjectId(i);var r=[p.DATACENTER,p.FOLDER],n=_.type;if(r.indexOf(n)>-1)return I;if(t!==c.CREATE_FROM_SCRATCH){var o=e[O];return s.getVsphereObjectId(o)}}function y(e,t,i,r){var n=[p.CLUSTER,p.HOST],o=c.isCloningToATemplate(e);o||(n.push(p.RESOURCE_POOL),n.push(p.V_APP));var a=_.type;if(n.indexOf(a)>-1)return I;if(i&&r&&r.computeResourceId){var l=s.getEntityType(r.computeResourceId);if(n.indexOf(l)>-1)return r.computeResourceId}var d=t[E];return d?s.getVsphereObjectId(d):void 0}function P(){var e=_.type===p.STORAGE_POD||_.type===p.DATASTORE;return e?I:void 0}function C(e,t,i,r){switch(e){case c.CREATE_FROM_SCRATCH:_.type===p.FOLDER&&i&&t.push(k),_.type!==p.FOLDER&&_.type!==p.DATACENTER&&(T=N,t.push(T),t.push(U),t.push(L)),_.type!==p.CLUSTER&&_.type!==p.HOST&&_.type!==p.RESOURCE_POOL&&_.type!==p.V_APP&&(E=$,t.push(E));break;case c.DEPLOY_VM_FROM_OVF:_.type!==p.FOLDER&&(T=N,t.push(T)),_.type!==p.CLUSTER&&_.type!==p.HOST&&_.type!==p.RESOURCE_POOL&&_.type!==p.V_APP&&(E=z,t.push(E))}var n=w(e,r);D(_.type,t,n)}function D(e,t,i){i&&e!==p.FOLDER&&e!==p.DATACENTER&&(T=i,t.push(T))}function w(e,t){switch(e){case c.CLONE_VM_TO_VM:case c.CLONE_TEMPLATE_TO_VM:return U;case c.CLONE_VM_TO_TEMPLATE:case c.CLONE_TEMPLATE_TO_TEMPLATE:return L;case c.DEPLOY_VM_FROM_OVF:return N;case c.REGISTER_VM:return t.isTemplate?x:F}}function b(e,t){var i={createWorkflow:{},cloneWorkflow:{},templateWorkflow:{},defaultFolderId:""},r=e[O],n=s.getVsphereObjectId(r);e[N]?i.createWorkflow.folderId=s.getVsphereObjectId(e[N]):i.createWorkflow.folderId=n,e[U]?i.cloneWorkflow.folderId=s.getVsphereObjectId(e[U]):i.cloneWorkflow.folderId=n,e[L]?i.templateWorkflow.folderId=s.getVsphereObjectId(e[L]):i.templateWorkflow.folderId=n,i.defaultFolderId=n,t.setRecommendedFolderAndComputeResource(i)}var I,_,T,E,V="config.guestId",M="name",O="dc",A="serverGuid",k="parent",R="config.vAppConfig.property",N="firstFolderWithCreateVmPrivilege",U="firstFolderWithCreateFromExistingPrivilege",L="firstTemplateFolderWithCreateFromExistingPrivilege",F="firstFolderWithRegisterVmPrivilege",x="firstTemplateFolderWithRegisterVmPrivilege",$="firstComputeWithCreateVmPrivilege",z="firstComputeWithVAppImportPrivilege",H=1,B="scheduledTaskDataRequest",G="contextObjectPropertiesRequest";return{showWizard:h}}]),angular.module("com.vmware.vsphere.client.vm").service("creationTypeConstants",function(){var e={CREATE_FROM_SCRATCH:"createVmFromScratch",CLONE_VM_TO_TEMPLATE:"cloneVmToTemplate",CLONE_VM_TO_VM:"cloneVmToVm",CLONE_TEMPLATE_TO_VM:"cloneTemplateToVm",CLONE_TEMPLATE_TO_TEMPLATE:"cloneTemplateToTemplate",CONVERT_TEMPLATE_TO_VM:"convertTemplateToVm",DEPLOY_VM_FROM_TEMPLATE:"deployVmFromTemplate",DEPLOY_VM_FROM_VAPP:"deployVmFromVapp",DEPLOY_VM_FROM_ANY_TEMPLATE:"deployVmFromAnyTemplate",DEPLOY_VM_FROM_VMTX:"deployVmFromVmtx",DEPLOY_VM_FROM_OVF:"deployVmFromOvf",REGISTER_VM:"registerVm",CLONE_AS_VMTEMPLATE_TO_LIBRARY:"cloneVmToLibrary",CLONE_VAPP_AS_VMTEMPLATE_TO_LIBRARY:"cloneVappToLibrary",CLONE_AS_OVFTEMPLATE_TO_LIBRARY:"cloneAsOvfToLibrary"};return _.extend(e,{isCloning:function(t){return _.include([e.CLONE_VM_TO_TEMPLATE,e.CLONE_VM_TO_VM,e.CLONE_TEMPLATE_TO_VM,e.CLONE_TEMPLATE_TO_TEMPLATE],t)},isCloningFromATemplate:function(t){return _.include([e.CLONE_TEMPLATE_TO_VM,e.CLONE_TEMPLATE_TO_TEMPLATE],t)},isCloningToATemplate:function(t){return _.include([e.CLONE_VM_TO_TEMPLATE,e.CLONE_TEMPLATE_TO_TEMPLATE],t)},isRegisterVm:function(t){return t===e.REGISTER_VM},isDeployVmFromTemplate:function(t){return t===e.DEPLOY_VM_FROM_TEMPLATE},isDeployVmFromVapp:function(t){return t===e.DEPLOY_VM_FROM_VAPP},isDeployVmFromVmtxTemplate:function(t){return t===e.DEPLOY_VM_FROM_VMTX},isCloningVmToLibrary:function(t){return t===e.CLONE_AS_VMTEMPLATE_TO_LIBRARY}})});var h5_vm;!function(e){var t=function(){function e(e,t,r,n,o,a){return function(){return new i(e,t,r,n,o,a)}}return e.$inject=["cloneVappBasicInformationPageService","cloneVmLocationPageService","cloneVmLibraryItemPageService","VmProvisioningComputeResourcePageService","vmProvisioningDatastorePageService","cloneVmReviewPageService"],e}(),i=function(){function e(e,t,i,r,n,o){this.cloneVappBasicInformationController=e,this.cloneVmLocationPageService=t,this.cloneVmLibraryItemPageService=i,this.VmProvisioningComputeResourcePageService=r,this.vmProvisioningDatastorePageService=n,this.cloneVmReviewPageService=o}return e.prototype.buildPages=function(e,t,i,r){var n=this.cloneVappBasicInformationController.build(e,t),o=this.cloneVmLocationPageService.build(e,t),a=this.cloneVmLibraryItemPageService.build(e,t),s=this.VmProvisioningComputeResourcePageService.build(e,i),c=this.vmProvisioningDatastorePageService.build(e,r),l=this.cloneVmReviewPageService.build(e,t);return{pages:[n,o,a,s,c,l]}},e.$inject=["cloneVappBasicInformationController","cloneVmLocationPageService","cloneVmLibraryItemPageService","VmProvisioningComputeResourcePageService","vmProvisioningDatastorePageService","cloneVmReviewPageService"],e}();e.CloneVappToLibraryService=i,angular.module("com.vmware.vsphere.client.vm").service("cloneVappToLibraryService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,r,n,o,a){return function(){return new i(e,t,r,n,o,a)}}return e.$inject=["cloneVmBasicInformationPageService","cloneVmLocationPageService","cloneVmLibraryItemPageService","VmProvisioningComputeResourcePageService","vmProvisioningDatastorePageService","cloneVmReviewPageService"],e}(),i=function(){function e(e,t,i,r,n,o){this.cloneVmBasicInformationPageService=e,this.cloneVmLocationPageService=t,this.cloneVmLibraryItemPageService=i,this.VmProvisioningComputeResourcePageService=r,this.vmProvisioningDatastorePageService=n,this.cloneVmReviewPageService=o}return e.prototype.buildPages=function(e,t,i,r){
var n=this.cloneVmBasicInformationPageService.build(e,t),o=this.cloneVmLocationPageService.build(e,t),a=this.cloneVmLibraryItemPageService.build(e,t),s=this.VmProvisioningComputeResourcePageService.build(e,i),c=this.vmProvisioningDatastorePageService.build(e,r),l=this.cloneVmReviewPageService.build(e,t);return{pages:[n,o,a,s,c,l]}},e.$inject=["cloneVmBasicInformationPageService","cloneVmLocationPageService","cloneVmLibraryItemPageService","VmProvisioningComputeResourcePageService","vmProvisioningDatastorePageService","cloneVmReviewPageService"],e}();e.CloneVmToLibraryService=i,angular.module("com.vmware.vsphere.client.vm").service("cloneVmToLibraryService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o){return function(){function a(a,s,c){var l=i.build(a,s),d=n.build(a,c),u=t.build(a),p=o.build(a);p.defaultState=e.wizard.pageState.SKIPPED;var v=r.build(a);return a.vmParams.hasConfigurableVappProperties()&&(p.defaultState=e.wizard.pageState.DISABLED),{pages:[l,d,u,p,v]}}this.buildPages=a}}angular.module("com.vmware.vsphere.client.vm").service("CloneVmToTemplateService",e),e.$inject=["vuiConstants","vmProvisioningDatastorePageService","vmProvisioningNameAndFolderPageService","vmProvisioningFinishCloneVmPageService","VmProvisioningComputeResourcePageService","vmProvisioningVappPropertiesPageService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d){return function(){function u(u,p,v){var m=o.build(u,p),g=a.build(u,v),h=t.build(u),f=i.build(u),S=s.build(u),y=r.build(u),P=c.build(u);P.defaultState=e.wizard.pageState.SKIPPED;var C=n.build(u),D=d.build(u);D.defaultState=e.wizard.pageState.SKIPPED;var w=[m,g,h,f,S,y,P,D,C];if(u.vmParams.hasConfigurableVappProperties()&&(D.defaultState=e.wizard.pageState.DISABLED),u.scheduleTaskData&&u.scheduleTaskData.isScheduledTask){var b=l.build(u);w.splice(0,0,b),f.defaultState=e.wizard.pageState.SKIPPED}return{pages:w}}this.buildPages=u}}angular.module("com.vmware.vsphere.client.vm").service("CloneVmToVmService",e),e.$inject=["vuiConstants","vmProvisioningDatastorePageService","vmProvisioningCloneOptionsPageService","vmProvisioningUserSettingsPageService","vmProvisioningFinishCloneVmPageService","vmProvisioningNameAndFolderPageService","VmProvisioningComputeResourcePageService","vmProvisioningCloneCustomizeGuestOsPageService","vmProvisioningCustomizeHardwarePageService","vmCreateScheduleTaskPageService","vmProvisioningVappPropertiesPageService"]}(),function(){"use strict";function e(e,t){return function(){function i(i,r,n){var o=i.wizardViewData.getDatacenterId();i.vmParams.setTargetInformation(null,o,null,null);var a=e.build(i,n),s=t.build(i);return{pages:[a,s]}}this.buildPages=i}}angular.module("com.vmware.vsphere.client.vm").service("convertTemplateToVmService",e),e.$inject=["VmProvisioningComputeResourcePageService","vmProvisioningFinishConvertToVmPageService"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.wizardPageService=i,this.creationTypeConstants=r}return e.prototype.changeCreationType=function(e,t,i){var r=i?i.creationType:e.vmParams.getCreationType();e.config.currentPage.decisionOptions&&(e.config.currentPage.decisionOptions.selectedFlowId=t.creationType),this.setSkippedPages(e,t.creationType),t.creationType!==r&&(e.attributes.creationType=t.creationType,e.vmParams.setCreationType(t.creationType),e.config.title=t.wizardTitle,e.vmParams.setRecreateVm(!0),e.vmParams.setCustomizeCloneHardware(!1),this.wizardPageService.initializeFlowStates(e.config.flows))},e.prototype.setSkippedPages=function(e,t){var i=this,r=e.config.flows,n=t===this.creationTypeConstants.CLONE_VM_TO_VM||t===this.creationTypeConstants.DEPLOY_VM_FROM_VAPP||t===this.creationTypeConstants.DEPLOY_VM_FROM_TEMPLATE||t===this.creationTypeConstants.CLONE_TEMPLATE_TO_VM,o=_.find(r,function(e){return e.id===t});if(o){var a=e.vmParams.getCloneOptions()||{},s=_.find(o.pages,function(e){return e.title===i.i18nService.getString("VmUi","CustomizeHardwareProvisioningPage.Title")});s&&(s.defaultState=this.vuiConstants.wizard.pageState.DISABLED,n&&!e.vmParams.getCustomizeCloneHardware()&&(s.defaultState=this.vuiConstants.wizard.pageState.SKIPPED));var c=_.find(o.pages,function(e){return e.title===i.i18nService.getString("VmUi","CustomizeGuestOsProvisioningPage.Title")});c&&(c.defaultState=this.vuiConstants.wizard.pageState.DISABLED,n&&!a.customizeOs&&(c.defaultState=this.vuiConstants.wizard.pageState.SKIPPED))}},e.$inject=["i18nService","vuiConstants","wizardPageService","creationTypeConstants"],e}();e.CreateVmChangeCreationTypeService=t,angular.module("com.vmware.vsphere.client.vm").service("createVmChangeCreationTypeService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D,w,b,I,T,E,V,M){return function(){function O(O,A,k,R){var N=a.build(O,A),U=d.build(O,k),L=u.build(O,k),F=n.build(O,R),x=o.build(O),$=l.build(O),z=p.build(O),H=r.build(O),B=f.build(O),G=c.build(O),j=s.build(O),W=v.build(O),Y=m.build(O),q=g.build(O),K=h.build(O),X=y.build(O,k),Q=P.build(O),Z=C.build(O),J=D.build(O),ee=w.build(O),te=b.build(O),ie=T.build(O,A,k),re=E.build(O),ne=V.build(O,A,k),oe=M.build(O);oe.defaultState=e.wizard.pageState.SKIPPED;var ae=[{id:i.CREATE_FROM_SCRATCH,pages:[N,U,F,z,H,B,G]},{id:i.DEPLOY_VM_FROM_ANY_TEMPLATE,pages:[$]},{id:i.DEPLOY_VM_FROM_TEMPLATE,pages:[N,Z,J,U,L,ee,te,ie,F,x,re,ne,X],parentWorkflow:i.DEPLOY_VM_FROM_ANY_TEMPLATE},{id:i.CLONE_TEMPLATE_TO_VM,pages:[N,U,F,Q,Z,J,B,oe,j],parentWorkflow:i.DEPLOY_VM_FROM_ANY_TEMPLATE},{id:i.CLONE_VM_TO_VM,pages:[W,N,U,F,Q,Z,J,B,oe,j]},{id:i.CLONE_VM_TO_TEMPLATE,pages:[W,N,U,F,oe,j]},{id:i.CLONE_TEMPLATE_TO_TEMPLATE,pages:[Y,N,U,F,oe,j]},{id:i.CONVERT_TEMPLATE_TO_VM,pages:[q,U,K]}];O.scheduleTaskData&&O.scheduleTaskData.isScheduledTask&&(ae=ae.splice(0,1)),ae=t.initializeFlowStates(ae);var se=[S.build(O,_.map(ae,function(e){return e.id}))];if(O.scheduleTaskData&&O.scheduleTaskData.isScheduledTask){var ce=I.build(O);se.splice(0,0,ce)}return{pages:se,flows:ae}}this.buildPages=O}}angular.module("com.vmware.vsphere.client.vm").service("CreateVmFromScratchService",e),e.$inject=["vuiConstants","wizardPageService","creationTypeConstants","vmProvisioningGuestOsPageService","vmProvisioningDatastorePageService","vmProvisioningNetworkPageService","vmProvisioningNameAndFolderPageService","vmProvisioningFinishCloneVmPageService","vmProvisioningFinishCreateVmPageService","vmProvisioningSelectAnyTemplatePageService","VmProvisioningComputeResourcePageService","vmProvisioningProductDetailsPageService","vmProvisioningSelectVmVersionPageService","vmProvisioningSelectVmToClonePageService","vmProvisioningSelectTemplatePageService","vmProvisioningSelectTemplateToConvertPageService","vmProvisioningFinishConvertToVmPageService","vmProvisioningCustomizeHardwarePageService","vmProvisioningSelectCreationTypePageService","vmProvisioningFinishDeployTemplatePageService","vmProvisioningCloneOptionsPageService","vmProvisioningCloneCustomizeGuestOsPageService","vmProvisioningUserSettingsPageService","VmProvisioningEulaPageService","VmProvisioningDeploymentOptionsPageService","vmCreateScheduleTaskPageService","vmProvisioningScaleoutConfigurationPageService","vmProvisioningCustomizeTemplatePageService","vmProvisioningVservicePageService","vmProvisioningVappPropertiesPageService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(d){switch(d){case t.CREATE_FROM_SCRATCH:return new r;case t.DEPLOY_VM_FROM_OVF:return new o;case t.DEPLOY_VM_FROM_VAPP:case t.DEPLOY_VM_FROM_TEMPLATE:return s;case t.CLONE_VM_TO_TEMPLATE:case t.CLONE_TEMPLATE_TO_TEMPLATE:return new i;case t.CLONE_TEMPLATE_TO_VM:case t.CLONE_VM_TO_VM:case t.DEPLOY_VM_FROM_VMTX:return new e;case t.CONVERT_TEMPLATE_TO_VM:return new n;case t.REGISTER_VM:return new a;case t.CLONE_AS_VMTEMPLATE_TO_LIBRARY:return new c;case t.CLONE_VAPP_AS_VMTEMPLATE_TO_LIBRARY:return new l;default:var u="Unknown creation type '"+d+"'";throw new Error(u)}}var u={};return u.serviceForCreationType=d,u}angular.module("com.vmware.vsphere.client.vm").service("creationTypeServiceFactory",e),e.$inject=["CloneVmToVmService","creationTypeConstants","CloneVmToTemplateService","CreateVmFromScratchService","convertTemplateToVmService","DeployVmFromOvfService","registerVmService","deployVmFromTemplateService","cloneVmToLibraryService","cloneVappToLibraryService"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.contentLibraryService=e,this.vmProvisioningNameAndFolderPageService=t,this.vmProvisioningCloneCustomizeGuestOsPageService=i,this.VmProvisioningComputeResourcePageService=r,this.vmProvisioningProductDetailsPageService=n,this.VmProvisioningEulaPageService=o,this.VmProvisioningDeploymentOptionsPageService=a,this.vmProvisioningDatastorePageService=s,this.vmProvisioningNetworkPageService=c,this.vmProvisioningFinishDeployTemplatePageService=l,this.vmProvisioningCustomizeTemplatePageService=d,this.vmProvisioningScaleoutConfigurationPageService=u,this.vmProvisioningVservicePageService=p,this.vmProvisioningUserSettingsPageService=v,this.TEMPLATE_NAME_PROPERTY="com.vmware.content.library.ItemModel/name",this.LIBRARY_NAME_PROPERTY="com.vmware.content.library.ItemModel/libraryName",this.GOS_TYPE_PROPERTY="com.vmware.content.type.ovf.OvfTemplate/vmTemplate/osType",this.GOS_DESCRIPTION_PROPERTY="com.vmware.content.type.ovf.OvfTemplate/vmTemplate/osDescription"}return e.prototype.buildPages=function(e,t,i,r){this.appendTemplateDetailsToWizardScope(e);var n=this.vmProvisioningNameAndFolderPageService.build(e,t),o=this.vmProvisioningCloneCustomizeGuestOsPageService.build(e),a=this.vmProvisioningUserSettingsPageService.build(e),s=this.VmProvisioningComputeResourcePageService.build(e,i),c=this.vmProvisioningProductDetailsPageService.build(e,i),l=this.VmProvisioningEulaPageService.build(e),d=this.VmProvisioningDeploymentOptionsPageService.build(e),u=this.vmProvisioningDatastorePageService.build(e,r),p=this.vmProvisioningNetworkPageService.build(e),v=this.vmProvisioningFinishDeployTemplatePageService.build(e,i),m=this.vmProvisioningScaleoutConfigurationPageService.build(e,t,i),g=this.vmProvisioningCustomizeTemplatePageService.build(e),h=this.vmProvisioningVservicePageService.build(e,t,i);return{pages:[n,o,a,s,c,l,d,m,u,p,g,h,v]}},e.prototype.appendTemplateDetailsToWizardScope=function(e){var t=this,i=e.wizardViewData.getTemplateId();this.contentLibraryService.getTemplateData(i).then(function(r){var n={templateName:r[t.TEMPLATE_NAME_PROPERTY],libraryName:r[t.LIBRARY_NAME_PROPERTY],templateId:i,gosType:r[t.GOS_TYPE_PROPERTY],gosDescription:r[t.GOS_DESCRIPTION_PROPERTY]};e.wizardViewData.setSelectedTemplate(n)})},e.$inject=["contentLibraryService","vmProvisioningNameAndFolderPageService","vmProvisioningCloneCustomizeGuestOsPageService","VmProvisioningComputeResourcePageService","vmProvisioningProductDetailsPageService","VmProvisioningEulaPageService","VmProvisioningDeploymentOptionsPageService","vmProvisioningDatastorePageService","vmProvisioningNetworkPageService","vmProvisioningFinishDeployTemplatePageService","vmProvisioningCustomizeTemplatePageService","vmProvisioningScaleoutConfigurationPageService","vmProvisioningVservicePageService","vmProvisioningUserSettingsPageService"],e}();e.DeployVmFromTemplateService=t,angular.module("com.vmware.vsphere.client.vm").service("deployVmFromTemplateService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u){return function(){function p(p,v,m,g){var h=e.build(p,v,m),f=t.build(p,v),S=i.build(p,m),y=l.build(p),P=r.build(p,m),C=c.build(p),D=n.build(p,v,m),w=o.build(p,g),b=a.build(p),I=d.build(p),_=u.build(p,v,m),T=s.build(p,m);return{pages:[h,f,S,P,C,y,D,w,b,I,_,T]}}this.buildPages=p}}angular.module("com.vmware.vsphere.client.vm").service("DeployVmFromOvfService",e),e.$inject=["vmProvisioningSelectOvfPageService","vmProvisioningNameAndFolderPageService","VmProvisioningComputeResourcePageService","vmProvisioningProductDetailsPageService","vmProvisioningScaleoutConfigurationPageService","vmProvisioningDatastorePageService","vmProvisioningNetworkPageService","vmProvisioningFinishDeployTemplatePageService","VmProvisioningEulaPageService","VmProvisioningDeploymentOptionsPageService","vmProvisioningCustomizeTemplatePageService","vmProvisioningVservicePageService"]}();var h5_vm;!function(e){var t=function(){function e(e,t,r){return function(){return new i(e,t,r)}}return e.$inject=["vmProvisioningNameAndFolderPageService","VmProvisioningComputeResourcePageService","vmProvisioningFinishRegisterPageService"],e}(),i=function(){function e(e,t,i){this.vmProvisioningNameAndFolderPageService=e,this.VmProvisioningComputeResourcePageService=t,this.vmProvisioningFinishRegisterPageService=i}return e.prototype.buildPages=function(e,t,i){var r=e.wizardViewData.getDatacenterId();e.vmParams.setTargetInformation(null,r,null,null);var n=this.vmProvisioningNameAndFolderPageService.build(e,t),o=this.VmProvisioningComputeResourcePageService.build(e,i),a=this.vmProvisioningFinishRegisterPageService.build(e);return{pages:[n,o,a]}},e.$inject=["vmProvisioningNameAndFolderPageService","VmProvisioningComputeResourcePageService","vmProvisioningFinishRegisterPageService"],e}();e.RegisterVmService=i,angular.module("com.vmware.vsphere.client.vm").service("registerVmService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.getModeName=function(t){switch(t){case e.PERSISTENT:case e.NONPERSISTENT:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeDependent");case e.UNDOABLE:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeUndoable");case e.INDEPENDANT_PERSISTENT:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeIndependentPersistent");case e.INDEPENDENT_NONPERSISTENT:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeIndependentNonpersistent");case e.APPEND:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeAppend")}return""},e.$inject=["i18nService"],e.PERSISTENT="persistent",e.NONPERSISTENT="nonpersistent",e.UNDOABLE="undoable",e.INDEPENDANT_PERSISTENT="independent_persistent",e.INDEPENDENT_NONPERSISTENT="independent_nonpersistent",e.APPEND="append",e}();e.DiskModeService=t,angular.module("com.vmware.vsphere.client.vm").service("diskModeService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i){function r(e){var t=e.ip,i={required:!!t&&t._type===s,address:"",subnetMask:e.subnetMask?e.subnetMask:"",defaultGateway:e.gateway&&e.gateway.length>0?e.gateway[0]:"",alternateGateway:e.gateway&&e.gateway.length>1?e.gateway[1]:""};return i}function n(e){var t=e.ipV6Spec,i={required:!!t&&!!t.ip&&t.ip.length>0&&t.ip[0]._type===c,address:"",subnetPrefixLength:"64",gateway:t&&t.gateway?t.gateway:[]};return i}function o(e){return e.areTypicalNetworkingSettingsUsed||e.isNetworkCardsCountTheSame}function a(e,i,r){if(e.error)return e.error.localizedMessage;var n=e.result;return n&&!o(n)?t.getString("VmUi","CustomizeGuestOsProvisioningPage.content.incorrectNicCountError",i,r):n&&!n.isPublicKeyTheSame?t.getString("VmUi","CustomizeGuestOsProvisioningPage.content.invalidPublicKeyError"):""}var s="com.vmware.vim.binding.vim.vm.customization.UnknownIpGenerator",c="com.vmware.vim.binding.vim.vm.customization.UnknownIpV6Generator";return{validate:function(t,o,s){function c(t){var i=a(t,s,o);if(i)return e.reject({error:i});var c=t.result;if(!c)return{};c.spec&&c.spec.options&&c.spec.options.deleteAccounts&&(c.spec.options.deleteAccounts=!1);var l=_.map(c.spec.nicSettingMap,function(e){return{ipv4:r(e.adapter),ipv6:n(e.adapter)}});return{spec:c.spec,info:c.info,specName:c.specInfoName,nicsToCustomize:l,needsComputerName:c.hasUnknownNameTypeGen,needsAnyNICSettings:_.any(l,function(e){return e.ipv4.required||e.ipv6.required})}}return i.validate(t,"java.lang.String",angular.toJson(s)).then(c)}}}angular.module("com.vmware.vsphere.client.vm").service("guestOsCustomizationSpecValidator",e),e.$inject=["$q","i18nService","mutationService"]}();var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.ValidateNameSpec,i=function(){function e(e,t,i){this.defaultUriSchemeUtil=e,this.managedEntityConstants=t,this.mutationService=i,this.VM_FOLDER_VALUE="group-v",this.HOST_FOLDER_VALUE="group-h"}return e.prototype.validateNameAndGetLocationUids=function(e,t){var i=this,r=this.buildValidateNameSpec(e,t);return this.mutationService.validateSpec(r._type,r).then(function(e){var r=e.result;return{folderUid:i.defaultUriSchemeUtil.getVsphereObjectId(r.vmFolderRef),datacenterUid:i.getDatacenter(t),validName:null===r.error,validationMessage:r.error,isVmFolder:i.checkVmFolder(t)}})},e.prototype.isVmFolder=function(e){var t=this.defaultUriSchemeUtil.getManagedObjectReference(e),i=t.type,r=t.value;return i===this.managedEntityConstants.FOLDER&&r.indexOf(this.VM_FOLDER_VALUE)!==-1},e.prototype.isHostFolder=function(e){var t=this.defaultUriSchemeUtil.getManagedObjectReference(e),i=t.type,r=t.value;return i===this.managedEntityConstants.FOLDER&&r.indexOf(this.HOST_FOLDER_VALUE)!==-1},e.prototype.buildValidateNameSpec=function(e,i){var r=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(i.uid),n=this.defaultUriSchemeUtil.getManagedObjectReference(i.uid),o=new t;o.name=e;var a=r?r.type:i.type;return a===this.managedEntityConstants.DATACENTER?o.datacenterRef=n:o.folderRef=n,o},e.prototype.getDatacenter=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e.uid),i=t?t.type:e.type;if(i===this.managedEntityConstants.DATACENTER)return e.uid;for(var r=e.item;!_.isEmpty(r)&&this.defaultUriSchemeUtil.getEntityType(r.objRef)===this.managedEntityConstants.FOLDER;){if(r=r.parentNode(),!r)return"";if(this.defaultUriSchemeUtil.getEntityType(r.objRef)===this.managedEntityConstants.DATACENTER)break}return r.objRef},e.prototype.checkVmFolder=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e.uid),i=t?t.type:e.type;return i===this.managedEntityConstants.DATACENTER||this.isVmFolder(e.uid)},e.$inject=["defaultUriSchemeUtil","managedEntityConstants","mutationService"],e}();e.NameAndFolderValidatorService=i,angular.module("com.vmware.vsphere.client.vm").service("nameAndFolderValidatorService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this._viewData={},this.SCALEOUT_CONFIGURATION_TYPE="com.vmware.vcenter.ovf.ScaleOutParams",this.NETWORK_MAPPING_PARAMS_TYPE="com.vmware.vcenter.ovf.NetworkMappingParams",this.IP_ALLOCATION_PARAMS_TYPE="com.vmware.vcenter.ovf.IpAllocationParams",this.USER_PROPERTY_PARAM_TYPE="com.vmware.vcenter.ovf.PropertyParams",this.VSERVICE_PROPERTY_PARAM_TYPE="com.vmware.vcenter.ovf.VServiceParams"}return e.prototype.setSourceObjectName=function(e){this._viewData.sourceObjectName=e},e.prototype.getSourceObjectName=function(){return this._viewData.sourceObjectName},e.prototype.setSourceObjectId=function(e){this._viewData.sourceObjectId=e},e.prototype.getSourceObjectId=function(){return this._viewData.sourceObjectId},e.prototype.setVmConnectedState=function(e){this._viewData.vmConnectedState=e},e.prototype.getVmConnectedState=function(){return this._viewData.vmConnectedState},e.prototype.setStorageProfiles=function(e){this._viewData.storageProfiles=e},e.prototype.getStorageProfiles=function(){return this._viewData.storageProfiles},e.prototype.setStorageNameMap=function(e){this._viewData.storageIdToNameMap=e},e.prototype.getStorageNameMap=function(){return this._viewData.storageIdToNameMap},e.prototype.setDiskFormatLabel=function(e){this._viewData.diskFormatLabel=e},e.prototype.getDiskFormatLabel=function(){return this._viewData.diskFormatLabel},e.prototype.setCustomizationSpecName=function(e){this._viewData.cuztomizationSpecName=e},e.prototype.getCustomizationSpecName=function(){return this._viewData.cuztomizationSpecName},e.prototype.setDatastoreObjectName=function(e){this._viewData.datastoreObjectName=e},e.prototype.getDatastoreObjectName=function(){return this._viewData.datastoreObjectName},e.prototype.setGuestOsType=function(e){this._viewData.guestOsType=e},e.prototype.getGuestOsType=function(){return this._viewData.guestOsType},e.prototype.setStorageLocatorItemsData=function(e){this._viewData.storageLocatorItemsData=e},e.prototype.getStorageLocatorItemsData=function(){return this._viewData.storageLocatorItemsData},e.prototype.setNeedToInputComputerName=function(e){this._viewData.needInputComputerName=e},e.prototype.getNeedToInputComputerName=function(){return!!this._viewData.needInputComputerName},e.prototype.setNICsToCustomize=function(e){this._viewData.nicsToCustomize=e},e.prototype.getNICsToCustomize=function(){return this._viewData.nicsToCustomize},e.prototype.setDatacenterId=function(e){this._viewData.datacenterId=e},e.prototype.getDatacenterId=function(){return this._viewData.datacenterId},e.prototype.setVCenterId=function(e){this._viewData.vCenterId=e},e.prototype.getVCenterId=function(){return this._viewData.vCenterId},e.prototype.setSelectedTemplate=function(e){this._viewData.selectedTemplate=e},e.prototype.getSelectedTemplate=function(){return this._viewData.selectedTemplate},e.prototype.setUrlTemplate=function(e){this._viewData.urlTemplate=e},e.prototype.getUrlTemplate=function(){return this._viewData.urlTemplate},e.prototype.setTemplateSourceType=function(e){this._viewData.sourceType=e},e.prototype.getTemplateSourceType=function(){return this._viewData.sourceType},e.prototype.setResourcePoolDeploymentResponse=function(e){this._viewData.resourcePoolDeploymentResponse=e},e.prototype.getResourcePoolDeploymentResponse=function(){return this._viewData.resourcePoolDeploymentResponse},e.prototype.setDeployFromLibraryCommonContext=function(e){this._viewData.commonContext=e},e.prototype.getDeployFromLibraryCommonContext=function(){return this._viewData.commonContext},e.prototype.getSclaeoutConfigurationFromLibraryCommonContext=function(){var e=this;return _.find(this._viewData.commonContext,function(t){return _.isEqual(t._type,e.SCALEOUT_CONFIGURATION_TYPE)})},e.prototype.getVserviceContextFromLibraryCommonContext=function(){var e=this;return _.find(this._viewData.commonContext,function(t){return _.isEqual(t._type,e.VSERVICE_PROPERTY_PARAM_TYPE)})},e.prototype.getDatastoreMappingParamsFromLibraryCommonContext=function(){var e=_.find(this._viewData.commonContext,function(e){return"com.vmware.vcenter.ovf.DatastoreMappingParams"===e._type});return e},e.prototype.getNetworkMappingParamsFromLibraryCommonContext=function(){var e=this,t=_.find(this._viewData.commonContext,function(t){return t._type===e.NETWORK_MAPPING_PARAMS_TYPE});return t},e.prototype.getIpAllocationParamsFromLibraryCommonContext=function(){var e=this,t=_.find(this._viewData.commonContext,function(t){return t._type===e.IP_ALLOCATION_PARAMS_TYPE});return t},e.prototype.getCustomizeTemplateFromLibraryCommonContext=function(){var e=this,t=_.find(this._viewData.commonContext,function(t){return t._type===e.USER_PROPERTY_PARAM_TYPE});return t},e.prototype.setCustomizeTemplateCommonContext=function(e){var t=this,i=_.find(this._viewData.commonContext,function(e){return e._type===t.USER_PROPERTY_PARAM_TYPE}),r=this._viewData.commonContext.indexOf(i);r>1&&(this._viewData.commonContext.splice(r,1),this._viewData.commonContext.push(e))},e.prototype.setCustomizeGosSpecData=function(e){this._viewData.customizeGosSpecData=e},e.prototype.getCustomizeGosSpecData=function(){return this._viewData.customizeGosSpecData},e.prototype.setDeployOvfSession=function(e){this._viewData.ovfSession=e},e.prototype.getDeployOvfSession=function(){return this._viewData.ovfSession},e.prototype.setTemplateId=function(e){this._viewData.templateId=e},e.prototype.getTemplateId=function(){return this._viewData.templateId},e.prototype.getSslThumbprint=function(){return this._viewData.sslThumbprint},e.prototype.setSslThumbprint=function(e){this._viewData.sslThumbprint=e},e.prototype.setRecommendedFolderAndComputeResource=function(e){this._viewData.recommendedPreselections=e},e.prototype.getRecommendedFolderAndComputeResource=function(){return this._viewData.recommendedPreselections},e}();e.ProvisioningWizardViewData=t,angular.module("com.vmware.vsphere.client.vm").factory("ProvisioningWizardViewData",function(){return t})}(h5_vm||(h5_vm={})),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").constant("sourceTypeConstants",{SOURCE_TYPE_CONTENTLIB:"CONTENT_LIBRARY_SOURCE",SOURCE_TYPE_PULL:"PULL_SOURCE",SOURCE_TYPE_PUSH:"PUSH_SOURCE",PUSH_TYPE_OVF:"OVF_SOURCE",PUSH_TYPE_OVA:"OVA_SOURCE",PUSH_OVF_OPTION_MF:"MANIFEST",PUSH_OVF_OPTION_MFCERT:"MANIFEST_CERTIFICATE",PUSH_OVF_OPTION_NONE:"NONE"})}(),angular.module("com.vmware.vsphere.client.vm").service("resourcePoolLookupService",["dataService","managedEntityConstants","defaultUriSchemeUtil",function(e,t,i){function r(e){var r=i.getPartsFromVsphereObjectId(e).type,n=r===t.RESOURCE_POOL||r===t.V_APP;return n}function n(e){var r=i.getPartsFromVsphereObjectId(e).type;return r===t.HOST}function o(e){var r=i.getPartsFromVsphereObjectId(e).type;return r===t.CLUSTER}function a(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t.id=i);return e[t.id]&&e[t.id].runtime&&(t.runtime=e[t.id].runtime),t}function s(e){if(!e&&!e.rpId&&!e.rpRuntime)return{id:null,runtime:null};var t=i.getVsphereObjectId(e.rpId);return{id:t,runtime:e.rpRuntime}}return{lookupResourcePoolForComputeResource:function(i){return r(i)?e.getProperties(i,["runtime"]):o(i)?e.getPropertiesByRelation(i,"parent",t.RESOURCE_POOL,["runtime"]).then(function(e){return a(e)}):n(i)?e.getData(i,"com.vmware.vsphere.client.h5.vm.model.HostResourcePoolData").then(function(e){return s(e)}):void 0}}}]);var h5_vm;!function(e){var t=function(){function e(){}return e}(),i=(function(){function e(){}return e}(),function(){function e(){}return e}(),function(){function e(e,t,i,r,n,o,a,s,c,l){this.compatibilityCheckService=e,this.i18nService=t,this.creationTypeConstants=i,this.defaultUriSchemeUtil=r,this.dataService=n,this.managedEntityConstants=o,this.vmProvisioningStorageSelectionValidationService=a,this.$q=s,this.compatibilityResultsPresenter=c,this.featureFlagsService=l}return e.prototype.validateSelection=function(e,t,i,r){var n=this;if(e.storageRef.type===this.managedEntityConstants.DATASTORE&&!e.hasAllocateSpacePrivilege)return this.$q.when(this.getNoPrivilegesCompatibilityResult());var o=this.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef),a=this.getCheckCompatibilityPromise(o,i),s=this.checkVmPlacement(t,i,r),c=this.checkCosts(i);return this.$q.all({compatibilityCheck:a,vmPlacementCheck:s,costCheck:c}).then(function(e){return n.onValidationCompleted(e,i)})},e.prototype.getNoPrivilegesCompatibilityResult=function(){var e=this.createAdvancedCompatibilityContentsObj([this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.NoPermissionOnDatastore")],[],[],this.compatibilityResultsPresenter.NO_HOST_ID),t={type:"error",icon:"vsphere-icon-status-error",message:this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.NoPermissionOnDatastore"),contents:[],advancedCompatibilityContents:e};return{isValid:!1,messages:[t]}},e.prototype.getCheckCompatibilityPromise=function(e,i){var r=i.creationType;if(this.creationTypeConstants.isCloning(r)||this.creationTypeConstants.isCloningVmToLibrary(r)&&this.featureFlagsService.CL_Native_VMTX_Phase2Enabled())return this.checkCompatibilityOnClone(e,i);var n=new t;return n.isValid=!0,this.$q.when(n)},e.prototype.checkCompatibilityOnClone=function(e,i){var r=this;return this.compatibilityCheckService.validate(i.computeResourceId,i.targetFolderUid,i.creationType,i.name,i.vmId,e,i.resPoolId,i.disks).then(function(e){var n=new t,o=e.result;if(!r.hasCompatibilityErrors(o))return n.isValid=!0,n;var a=r.createAdvancedDataFromCompatibilityCheck(e,i),s=!1,c=_.filter(o,function(e){return null!==e.messages&&e.messages.length>0});return s=c.length!==o.length,c=_.map(c,function(e){var t=!1,i={hostId:r.defaultUriSchemeUtil.getVsphereObjectId(e.host),type:"",message:e.hostName,icon:null,contents:_.map(e.messages,function(e){return t=t||"error"===e.type,{type:e.type,icon:"error"===e.type?"vsphere-icon-status-error":"vsphere-icon-status-warning",message:e.message,contents:[]}})};return t?i.type="error":(s=!0,i.type="warning"),i}),n.isValid=s,n.issues=c,c.length>0&&(c[0].advancedCompatibilityContents=a),1===c.length&&1===c[0].contents.length?r.dataService.getProperties(c[0].hostId,["primaryIconId"]).then(function(e){return c[0].icon=e.primaryIconId,n}):(n.isValid&&c.push({type:"success"}),n)})},e.prototype.createAdvancedDataFromCompatibilityCheck=function(e,t){var i=this;if(e.error){var r=this.createAdvancedCompatibilityContentsObj([e.error.message],[],[],this.compatibilityResultsPresenter.NO_HOST_ID);return r.vmProps.name=t.name,r}var n={hostMap:{},vmId:this.compatibilityResultsPresenter.NO_VM_ID,vmProps:{icon:this.compatibilityResultsPresenter.NO_VM_ICON,name:t.name}};return _.each(e.result,function(e){var t=i.defaultUriSchemeUtil.getVsphereObjectId(e.host);n.hostMap[t]||(n.hostMap[t]={errors:[],warnings:[],infos:[],props:{icon:i.compatibilityResultsPresenter.NO_HOST_ICON,name:i.compatibilityResultsPresenter.NO_HOST_NAME}}),_.each(e.messages,function(e){"error"===e.type?n.hostMap[t].errors.push(e.message):n.hostMap[t].warnings.push(e.message)})}),n},e.prototype.checkVmPlacement=function(e,i,r){var n=this,o=new t;if(!e)return o.isValid=!0,this.$q.when(o);var a=this.defaultUriSchemeUtil.getVsphereObjectId(i.vmStorageConf.vmHome.storageObj.storageRef),s=i.vmStorageConf.vmHome.storageProfile.id,c=[{storageId:a,profile:{id:s}}];return _.each(i.disks,function(e){var t=n.defaultUriSchemeUtil.getVsphereObjectId(e.datastore);_.each(e.profile,function(e){c.push({storageId:t,profile:{id:e.profileId}})})}),this.compatibilityCheckService.validateVmPlacementForMultipleVms(c).then(function(e){var t=_.map(e.errors,function(e){return{type:r?"error":"warning",icon:r?"vsphere-icon-status-error":"vsphere-icon-status-warning",message:e,contents:[]}}),i=n.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpbmPolicyWarning"),a=[];_.each(e.warnings,function(e){var t=e.localizedMessage;t||_.isEmpty(e.faultMessage)||(t=e.faultMessage[0].message);var n=t&&t!==i?[{message:'"'+t+'"',contents:[]}]:[],o=_.any(a,function(e){return angular.equals(e.contents,n)});o||a.push({type:r?"error":"warning",icon:r?"vsphere-icon-status-error":"vsphere-icon-status-warning",message:i,contents:n})});var s=n.createAdvancedDataFromPlacementCheck(e),c=t.concat(a);return c.length>0&&(c[0].advancedCompatibilityContents=s),o.isValid=!(r&&c.length>0),o.issues=c,o})},e.prototype.createAdvancedDataFromPlacementCheck=function(e){var t=this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpbmPolicyWarning"),i=[];return _.each(e.warnings,function(e){var r=e.localizedMessage;null!==r||_.isEmpty(e.faultMessage)||(r=e.faultMessage[0].message),r?i.push(r):i.indexOf(t)===-1&&i.push(t)}),this.createAdvancedCompatibilityContentsObj(e.errors,i,[],this.compatibilityResultsPresenter.NO_HOST_ID)},e.prototype.hasCompatibilityErrors=function(e){return _.any(e,function(e){return _.any(e.messages,function(e){return"error"===e.type})})},e.prototype.checkCosts=function(e){var i=this;return this.vmProvisioningStorageSelectionValidationService.requestProvisioningCost(e.targetFolderUid,e.vmStorageConf,!1,e.vmDisks).then(function(e){var r=new t;if(r.isValid=!0,_.isEmpty(e.compatibilityData.infos))return r;var n=i.createAdvancedCompatibilityContentsObj([],[],e.compatibilityData.infos,i.compatibilityResultsPresenter.NO_HOST_ID),o={icon:"vsphere-icon-help-info-hover",message:e.compatibilityData.infos[0],contents:[],advancedCompatibilityContents:n};return r.issues=[o],r})},e.prototype.createAdvancedCompatibilityContentsObj=function(e,t,i,r){var n={hostMap:{},vmId:this.compatibilityResultsPresenter.NO_VM_ID,
vmProps:{name:this.compatibilityResultsPresenter.NO_VM_NAME,icon:this.compatibilityResultsPresenter.NO_VM_ICON}};return n.hostMap[r]={errors:e,warnings:t,infos:i,props:{icon:this.compatibilityResultsPresenter.NO_HOST_ICON,name:this.compatibilityResultsPresenter.NO_HOST_NAME}},n},e.prototype.onValidationCompleted=function(e,t){var i=[],r=!0;return e.compatibilityCheck&&!_.isEmpty(e.compatibilityCheck.issues)&&(r=e.compatibilityCheck.isValid,i=r?i.concat(e.compatibilityCheck.issues):e.compatibilityCheck.issues),r&&e.vmPlacementCheck&&!_.isEmpty(e.vmPlacementCheck.issues)&&(r=e.vmPlacementCheck.isValid,i=r?i.concat(e.vmPlacementCheck.issues):e.vmPlacementCheck.issues),r&&e.costCheck&&!_.isEmpty(e.costCheck.issues)&&(r=e.costCheck.isValid,i=r?i.concat(e.costCheck.issues):e.costCheck.issues),i.length>0?this.createValidationErrorResultObject(r,i,t):{isValid:!0,messages:[{type:"success",icon:"vsphere-icon-status-ok",message:this.i18nService.getString("VmUi","ProvisioningWizard.CompatibilityChecksSucceeded"),contents:[],advancedCompatibilityContents:{}}]}},e.prototype.createValidationErrorResultObject=function(e,t,i){var r=this,n=_.filter(t,function(e){return"success"!==e.type});if(!n[0]||!n[0].advancedCompatibilityContents)return{isValid:e,messages:n};var o=n[0].advancedCompatibilityContents;o&&i&&i.name&&(o.vmProps.name=i.name),o&&i&&i.vmId&&(o.vmId=i.vmId);var a=[];return _.each(o.hostMap,function(e,t){t!==r.compatibilityResultsPresenter.NO_HOST_ID&&a.push(t)}),0===a.length?{isValid:e,messages:n}:this.dataService.getPropertiesForObjects(a,["primaryIconId","name"]).then(function(t){return _.each(t,function(e,t){o.hostMap[t].props.icon=e.primaryIconId,o.hostMap[t].props.name=e.name}),{isValid:e,messages:n}})},e.$inject=["compatibilityCheckService","i18nService","creationTypeConstants","defaultUriSchemeUtil","dataService","managedEntityConstants","vmProvisioningStorageSelectionValidationService","$q","compatibilityResultsPresenter","featureFlagsService"],e}());e.StorageResourceSelectionValidationService=i,angular.module("com.vmware.vsphere.client.vm").service("storageResourceSelectionValidationService",i)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("VirtualMachineSpecBuilder",["$q","dataService","vmDeviceInfoService","defaultUriSchemeUtil","creationTypeConstants","cpuService","storageProfileService","managedEntityConstants","diskProvisioningService","podSelectionSpecService","authorizationService","virtualDiskPmemService","pmemUtilService","storageSelectorConstants","deviceOperationConstants","deviceClassLineageService","deviceTypeConstants",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h){var f=function(){function e(){return q||(q=t.getProperties(re(),"virtualDisks")),q}function v(){return K.storageDiskList}function f(e,i){if(i&&B&&B.vmVersion===e)return B.promise;B={vmVersion:e};var n=null,o=r.getManagedObjectReference(K.computeResourceId);o.type===s.HOST&&(n=o);var a=[{propertyName:"vmConfigOptionByPool",parameterType:"com.vmware.vsphere.client.h5.vm.model.provisioning.GuestOsVersionParams",parameter:{_type:"com.vmware.vsphere.client.h5.vm.model.provisioning.GuestOsVersionParams",key:e,host:n}}];return B.promise=t.getProperties(K.resourcePool.id,["vmConfigOptionByPool"],{propertyParams:a}).then(function(e){return e}),B.promise}function S(e){K.isAdvancedStorageMode=e}function y(){return K.isAdvancedStorageMode}function P(){return K.vmDisksStorage}function C(e){K.vmDisksStorage=e}function D(){return K.storageSelectorState}function w(e){K.storageSelectorState=e}function b(){K.storageSelectorState=void 0}function I(e){var t=D().vmStorageConfigInAdvancedMode[0].vmDisks;return _.find(t,function(t){return t.key===e})}function T(e){var t;if(y()){var i=I(e);t=i.diskFormat}else t=wt();return t?t.name:void 0}function E(e){K.containsSpbmIssues=e}function V(){return K.libraryItemId}function M(e){K.libraryItemId=e}function O(){return K.vmtxLibraryItemId}function A(e){K.vmtxLibraryItemId=e}function k(e){K.vmtxStorageSpecSettings=e}function R(){return K.vmtxStorageSpecSettings}function N(){return K.customizationSpecName}function U(e){K.customizationSpecName=e}function L(){if(j)return j;var e=te().folderUid,t=X;return J()!==n.CREATE_FROM_SCRATCH?t=Q:be()&&(e=ge()),j=d.checkGrantedPrivileges(e,t).then(function(e){var i=[];return _.each(e,function(e,r){e&&i.push(t[r])}),i})}function F(){if(W)return W;var e=re();return e&&(W=t.getProperties(e,["advancedStoragePageData"],{skipLoadingNotification:!0})),W}function x(){if(Y)return Y;var e=te(),i=r.getRootFolderFromVsphereObjectId(e.datacenterUid);return i&&(Y=t.getProperties(i,["vmStoragePageData","h5DefaultKmipClusterStatus","grantedPrivileges"]).then(function(e){return{vmStoragePageData:e.vmStoragePageData?_.extend(e.vmStoragePageData,{h5DefaultKmipClusterStatus:e.h5DefaultKmipClusterStatus,hasProfileViewPrivilege:e.grantedPrivileges?_.contains(e.grantedPrivileges,"StorageProfile.View"):void 0}):void 0}})),Y}function $(e){K.vappPropertyDescriptors=e}function z(){return K.vappPropertyDescriptors}var H,B,G,j,W,Y,q,K={},X=[h5_vm.Privileges.VM_ADDREMOVEDEVICE_PRIVILEGE,h5_vm.Privileges.VM_ADDNEWDISK_PRIVILEGE,h5_vm.Privileges.VM_ADDEXISTINGDISK_PRIVILEGE,h5_vm.Privileges.VM_RAWDEVICE_PRIVILEGE,h5_vm.Privileges.VM_CONFIG_SWAPFILEPLACEMENT,h5_vm.Privileges.VM_RESOURCE_PRIVILEGE,h5_vm.Privileges.VM_CONFIG_SETTINGS,h5_vm.Privileges.VM_HOST_USB_DEVICE,h5_vm.Privileges.STORAGE_PROFILE_VIEW,h5_vm.Privileges.VM_CONFIG_ADVANCEDCONFIG,h5_vm.Privileges.CRYPTOGRAPHER_ENCRYPT,h5_vm.Privileges.CRYPTOGRAPHER_ENCRYPT_NEW_VM],Q=[h5_vm.Privileges.VM_ADDREMOVEDEVICE_PRIVILEGE,h5_vm.Privileges.VM_ADDNEWDISK_PRIVILEGE,h5_vm.Privileges.VM_ADDEXISTINGDISK_PRIVILEGE,h5_vm.Privileges.VM_RAWDEVICE_PRIVILEGE,h5_vm.Privileges.VM_CONFIG_SWAPFILEPLACEMENT,h5_vm.Privileges.VM_RESOURCE_PRIVILEGE,h5_vm.Privileges.VM_CONFIG_SETTINGS,h5_vm.Privileges.VM_HOST_USB_DEVICE,h5_vm.Privileges.VM_CONFIG_CPU_COUNT,h5_vm.Privileges.VM_CONFIG_MEMORY,h5_vm.Privileges.VM_DISKEXTEND_PRIVILEGE,h5_vm.Privileges.DATASTORE_ALLOCATESPACE_PRIVILEGE,h5_vm.Privileges.VM_REMOVEDISK_PRIVILEGE,h5_vm.Privileges.VM_EDITDEVICE_PRIVILEGE,h5_vm.Privileges.NETWORK_ASSIGN,h5_vm.Privileges.VM_INTERACT_DEVICE_CONNECTION,h5_vm.Privileges.VM_INTERACT_SET_CD_MEDIA,h5_vm.Privileges.VM_INTERACT_POWER_ON,h5_vm.Privileges.VM_CONFIG_MKSCONTROL,h5_vm.Privileges.VM_CONFIG_ADVANCEDCONFIG],Z=function(e){K.creationType!==e&&(j=void 0),K.creationType!==e&&(K.creationType=e,e!==n.DEPLOY_VM_FROM_TEMPLATE&&e!==n.DEPLOY_VM_FROM_VAPP||b())},J=function(){return K.creationType},ee=function(e,t,i,n){K.targetInformation&&K.targetInformation.folderUid!==i&&(j=void 0);var o=K.targetInformation?r.getRootFolderFromVsphereObjectId(K.targetInformation.datacenterUid):void 0,a=r.getRootFolderFromVsphereObjectId(t),s=o!==a;K.targetInformation={targetUid:e,datacenterUid:t,folderUid:i,name:n},s&&(Y=void 0,x())},te=function(){return K.targetInformation},ie=function(e){var t=e!==K.vmId;K.vmId=e,t&&(W=void 0,F())},re=function(){return K.vmId},ne=function(e){K.name=e},oe=function(){return K.name},ae=function(e){K.hasEncryptNewVmPrivilege=e},se=function(){return K.hasEncryptNewVmPrivilege},ce=function(e){K.hasManageEncryptionPolicyPrivilege=e},le=function(){return K.hasManageEncryptionPolicyPrivilege},de=function(e){K.templateName=e},ue=function(){return K.templateName},pe=function(e){K.recreateVm=e},ve=function(){return K.recreateVm},me=function(e){e!==K.computeResourceId&&(K.computeResourceId&&(K.recreateVm=!0),H=void 0,B=void 0,j=void 0),K.computeResourceId=e},ge=function(){return K.computeResourceId},he=function(){return K.computeResourceOwnerId},fe=function(e){K.computeResourceOwnerId=e},Se=function(e){K.computeResourceName=e},ye=function(){return K.computeResourceName},Pe=function(e){K.resourcePool=e},Ce=function(){return K.resourcePool},De=function(e){K.originalConfigSpec=e},we=function(e){K.isRpInVapp=e},be=function(){return K.isRpInVapp},Ie=function(){return K.originalConfigSpec},_e=function(e){K.configSpec=e},Te=function(){return K.sourceVmStorageConfig?K.sourceVmStorageConfig[0]:null},Ee=function(e){K.sourceVmStorageConfig=e},Ve=function(){return K.configSpec},Me=function(){return K.storageObject},Oe=function(){return K.disableSdrs},Ae=function(e){K.disableSdrs=e},ke=function(){return K.vmVersion},Re=function(e){K.vmVersion!==e&&(pe(!0),H=null),K.vmVersion=e},Ne=function(){return K.scheduledVmVersion},Ue=function(e){K.scheduledVmVersion=e},Le=function(){return K.scheduledData},Fe=function(e){K.scheduledData=e},xe=function(){return K.gosFamily},$e=function(){return K.gosVersion},ze=function(){return K.gosName},He=function(e){K.guestOsId=e},Be=function(){return K.guestOsId},Ge=function(e){K.scheduledGuestOsId=e},je=function(){return K.scheduledGuestOsId},We=function(e){K.scheduledGuestName=e},Ye=function(){return K.scheduledGuestName},qe=function(e){K.gosName=e},Ke=function(e){var t=e.family,i=e.version;K.gosFamily=t;var r=i?i.id:void 0,n=K.gosVersion?K.gosVersion.id:void 0;r!==n&&pe(!0),K.gosVersion=i},Xe=function(){return K.vbsEnabled},Qe=function(e){K.vbsEnabled=e},Ze=function(){return K.vbsSupported},Je=function(e){K.vbsSupported=e},et=function(e){K.virtualMachineDevices=e},tt=function(){return K.virtualMachineDevices},it=function(e){K.cloneOptions=e},rt=function(){return K.gosVersion.id!==G},nt=function(){var e=null,i=r.getManagedObjectReference(K.computeResourceId);i.type===s.HOST&&(e=i);var n=r.getVsphereObjectId(K.envBrowserRef),o=[{propertyName:"vmConfigGuestOsDescriptor",parameterType:"com.vmware.vsphere.client.h5.vm.model.provisioning.VmConfigEnvironmentPerPoolParams",parameter:{_type:"com.vmware.vsphere.client.h5.vm.model.provisioning.VmConfigEnvironmentPerPoolParams",key:ke(),hostRef:e,gosId:$e()?$e().id:Be()}}];return t.getProperties(n,["vmConfigGuestOsDescriptor"],{propertyParams:o}).then(function(e){return G=e.vmConfigGuestOsDescriptor.id,e})},ot=function(e){var t="com.vmware.vim.binding.vim.vm.customization.LinuxPrep",i="com.vmware.vim.binding.vim.vm.customization.Sysprep",r=lt(),n={_type:"com.vmware.vim.binding.vim.vm.customization.FixedName",name:e};r.identity._type===t?r.identity.hostName=n:r.identity._type===i&&(r.identity.userData.computerName=n),ct(r)},at=function(e,t){var i=lt();i.nicSettingMap[e].adapter.gateway=[],t.ipv4.defaultGateway&&i.nicSettingMap[e].adapter.gateway.push(t.ipv4.defaultGateway),t.ipv4.alternateGateway&&i.nicSettingMap[e].adapter.gateway.push(t.ipv4.alternateGateway),i.nicSettingMap[e].adapter.subnetMask=t.ipv4.subnetMask,i.nicSettingMap[e].adapter.ip={_type:"com.vmware.vim.binding.vim.vm.customization.FixedIp",ipAddress:t.ipv4.address},ct(i)},st=function(e,t){var i=lt();i.nicSettingMap[e].adapter.ipV6Spec.ip=[{_type:"com.vmware.vim.binding.vim.vm.customization.FixedIpV6",ipAddress:t.ipv6.address,subnetMask:t.ipv6.subnetPrefixLength}],i.nicSettingMap[e].adapter.ipV6Spec.gateway=t.ipv6.gateway,ct(i)},ct=function(e){K.customizationSpec=e},lt=function(){return K.customizationSpec},dt=function(e){K.CustomizationSpecInfo=e},ut=function(){return K.CustomizationSpecInfo},pt=function(){return K.cloneOptions},vt=function(e){e&&e.id&&(e.profileId=e.id),K.selectedStorageProfile=e},mt=function(){return K.selectedStorageProfile},gt=function(e){K.selectedReplicationGroupInfo=e},ht=function(){return K.selectedReplicationGroupInfo},ft=function(e){e&&e.id&&(e.profileId=e.id),K.selectedStorageProfileForDisks=e},St=function(){return K.selectedStorageProfileForDisks?K.selectedStorageProfileForDisks:mt()},yt=function(e){return e=e||Me(),!!e&&(e.storageRef&&e.storageRef.type===s.STORAGE_POD)},Pt=function(e){return e=e||Me(),!!e&&(!yt(e)||e.parentStoragePod&&K.disableSdrs)},Ct=function(e){e&&Me()&&Me().storageRef.value!==e.storageRef.value&&pe(!0),K.storageObject=e},Dt=function(e,t){Ct(e),K.diskFormat=t},wt=function(){return K.diskFormat},bt=function(e){var t=mt();return tt()&&tt().getVirtualDevice(e.key)&&(t=tt().getVirtualDevice(e.key).getProfile()),e.profile=t,e},It=function(e){if(K.containsSpbmIssues)return[];var t,i=e.profile&&e.profile.profileId,r=P()[re()],n=_.find(r,function(t){return t.key===e.key});return n&&(i=n.profile&&n.profile.id,t=n.replicationGroup),[a.makeProfile(i,t)]},_t=function(e){_.each(e,function(e){var t=mt()&&mt().id,i=ht(),r=P()[re()],n=_.find(r,function(t){return t.key===e.getKey()});n&&(t=n.profile&&n.profile.id,i=n.replicationGroup),e.setProfile(a.makeProfile(t,i))})},Tt=function(){return D()?D().storageBaselineId:void 0},Et=function(e,t){if(y()){var i=D().vmStorageConfigInAdvancedMode[0].vmDisks;return u.filterVirtualDisksToDiskLocatorsForPmemAdvanced(e,i)}var r=Tt();return u.filterVirtualDisksToDiskLocatorsForPmem(e,r,t)},Vt=function(e,t,i){if(y()){var r=D().vmStorageConfigInAdvancedMode[0].vmDisks;return u.applyPmemRulesOnVirtualDiskBackingAdvanced(t,e,r)}var n=Tt();return u.applyPmemRulesOnVirtualDiskBacking(e,n,i)},Mt=function(e,t){if(e&&e.initialVmConfig){var i=_.find(e.initialVmConfig,function(e){return e.disk&&e.disk.length});if(i)if(y()){var r=D().vmStorageConfigInAdvancedMode[0].vmDisks;_.forEach(i.disk,function(e){e.diskBackingInfo=u.applyPmemRulesOnVirtualDiskBackingAdvanced(e.diskId,e.diskBackingInfo,r)})}else{var n=Tt();_.forEach(i.disk,function(e){e.diskBackingInfo=u.applyPmemRulesOnVirtualDiskBacking(e.diskBackingInfo,n,t)})}}},Ot=function(e){var t,i=[];if(y()){var r=D().vmStorageConfigInAdvancedMode[0].vmDisks;return _.forEach(e,function(e){t=u.convertVirtualDiskToDeviceChangeForPmemAdvanced(e,r),t&&i.push(t)}),i}var n=Tt(),o=St();return _.forEach(e,function(e){t=u.convertVirtualDiskToDeviceChangeForPmem(e,n,o),t&&i.push(t)}),i},At=function(e,t){if(t&&t.type&&e)return p.isPmemDisk(e)?e.backing:"sameAsSource"===t.type?null:c.getBackingInfo(t.type)},kt=function(t){return e().then(function(e){var i=e.virtualDisks,r=Et(i),n=!y()&&D()&&D().basicModeState&&D().basicModeState.profilesData&&D().basicModeState.profilesData.selectedProfile&&D().basicModeState.profilesData.selectedProfile.keepExistingProfileAssignments,o=_.filter(r,function(e){if(!y())return Pt();var t=D().vmStorageConfigInAdvancedMode[0].vmDisks,i=_.find(t,function(t){return t.key===e.key});return Pt(i.storageObj)}),s=_.map(o,function(e){return Rt(e,t)});s=_.filter(s,function(e){return null!==e.datastore});var c={deviceChange:Ot(i),disk:s},l=n?Te().vmHome.storageProfile.id:mt().profileId,d=[a.makeProfile(l,ht())];return c.profile=K.containsSpbmIssues?[]:d,c})},Rt=function(e,t){t=t||K.diskFormat;var i=Pt()?Me().storageRef:null;if(y()){var r=D().vmStorageConfigInAdvancedMode[0].vmDisks,n=_.find(r,function(t){return t.key===e.key});i=Pt(n.storageObj)?n.storageObj.storageRef:null,t=n.diskFormat}var o=At(e,t);o=Vt(o,e.key,t);var a={_type:"com.vmware.vim.binding.vim.vm.RelocateSpec$DiskLocator",datastore:i,diskBackingInfo:o,diskId:e.key};return a.profile=It(e),a},Nt=function(e,t){return K.storageDiskList=K.storageDiskList||{},e?void(K.storageDiskList[t.key]={diskKey:t.key,diskBacking:t.backing,dsId:e.id,dsName:e.name,dsObject:e.storageObject||e}):void delete K.storageDiskList[t.key]},Ut=function(e){return K.storageDiskList&&K.storageDiskList[e]?K.storageDiskList[e]:null},Lt=function(e){return K.storageDiskList&&K.storageDiskList[e]?K.storageDiskList[e].dsName:null},Ft=function(e){return K.storageDiskList&&K.storageDiskList[e]?{name:K.storageDiskList[e].dsName,id:K.storageDiskList[e].dsId}:null},xt=function(){var e,t=r.getManagedObjectReference(Ce().id),i="folder";t.type===s.V_APP||be()?(i="vapp",e=null):e=r.getManagedObjectReference(te().folderUid);var n=r.getManagedObjectReference(ge()),d=null;n.type===s.HOST&&(d=n);var u=tt().getDeviceChanges(),p={parentType:i,folder:e,pool:t,host:d,spec:{config:angular.merge({_type:"com.vmware.vim.binding.vim.vm.ConfigInfo",name:oe(),guestId:$e().id,alternateGuestName:ze()?ze():null},Ve().config),deviceChange:u,npivWwnOp:Ve().config.npivWwnOp,cpuFeatureMask:o.createCpuIdInfoDelta([],Ve().config.cpuFeatureMask)}},v=mt();return v&&!K.containsSpbmIssues?p.spec.profile=[a.makeProfile(v.id,ht())]:p.spec.profile=[],c.setBackingDatastore(u,Me(),K.storageDiskList),p.podSelectionSpec=l.createSpec(Qt(u),Me(),K.storageDiskList),p},$t=function(){var e=null,t=null,i=null,n=null,o=null,a=null,c=r.getManagedObjectReference(ge());switch(c.type){case s.CLUSTER:e=c.value;break;case s.HOST:i=c.value;break;case s.RESOURCE_POOL:t=c.value;break;case s.V_APP:t=c.value}var l=te();return l&&l.folderUid&&(o=l.folderUid),o&&(n=r.getManagedObjectReference(o).value),N()&&(a=N()),_.extend({name:oe(),libraryItemUri:V(),powerOn:pt().powerOn,guestCustomizationSpec:{name:a},placementSpec:{folder:n,cluster:e,resourcePool:t,host:i},hardwareCustomization:zt()},R())},zt=function(){var e;if(Wt()===!0){var t=tt().getDeviceChanges(),n={numCpus:Ve().hardware.numCPU,numCoresPerSocket:Ve().hardware.numCoresPerSocket},o={memory:Ve().hardware.memoryMB},a=Ie(),s=_.filter(a.hardware.device,function(e){return i.isDeviceSubclassOf(e,"VirtualDisk")}),c=_.filter(t,function(e){if(g.isClassNameSubclassOf(e.device._type,h.VIRTUALDISK)&&e.operation===m.EDIT){var t=_.find(s,function(t){return t.key===e.device.key});if(t.capacityInBytes!==e.device.capacityInBytes)return!0}return!1}),l=_.filter(t,function(e){return!(!g.isClassNameSubclassOf(e.device._type,h.VIRTUALDISK)||e.operation!==m.REMOVE)}),d={};_.each(c,function(e){d[e.device.key]={capacity:e.device.capacityInBytes}});var u=[];_.each(l,function(e){u.push(e.device.key)});var p={},v=tt();_.each(Ht(),function(e){var t=v.getVirtualDevice(e.device.key).network;p[e.device.key]={network:r.getVsphereObjectId(t.network?t.network.network:t.portgroup)}}),e={cpuUpdate:n,memoryUpdate:o,disksToUpdate:d,disksToRemove:u,nics:p}}return e},Ht=function(){var e=tt().getDeviceChanges();return _.filter(e,function(e){return!g.isClassNameSubclassOf(e.device._type,h.VIRTUALDISK)&&e.operation===m.EDIT})},Bt=function(){return K.recommendationSpec},Gt=function(e){K.recommendationSpec=e},jt=function(e){K.customizeHardware=e},Wt=function(){return K.customizeHardware},Yt=function(e,t){e&&!_.isEmpty(e.deviceChange)&&(t.deviceChange=_.isEmpty(t.deviceChange)?[]:t.deviceChange,e.deviceChange=_.filter(e.deviceChange,function(e){return!g.isClassNameSubclassOf(e.device._type,h.ETHERNET)||("edit"!==e.operation||(t.deviceChange.push(e),!1))}))},qt=function(){return kt(K.diskFormat).then(function(t){return e().then(function(e){var i=null,n=r.getManagedObjectReference(K.computeResourceId);n.type===s.HOST&&(i=n);var d=null;K.resourcePool.id&&(d=r.getManagedObjectReference(K.resourcePool.id));var u=yt()?null:Me().storageRef,p=tt(),v={vm:r.getManagedObjectReference(re()),name:oe(),folder:r.getManagedObjectReference(te().folderUid),cloneSpec:{_type:"com.vmware.vim.binding.vim.vm.CloneSpec",location:{_type:"com.vmware.vim.binding.vim.vm.RelocateSpec",host:i,pool:d,datastore:u,profile:t.profile,deviceChange:t.deviceChange},template:Zt()}},m=[];if(p&&(_t(p.existingDevicesOfType(h.VIRTUALDISK)),m=p.getDeviceChanges()),Wt()===!0){var g=Ie(),f=null!==g.cpuFeatureMask?g.cpuFeatureMask:[],S=Ve();v.vmSpec={_type:"com.vmware.vsphere.client.vm.VmConfigSpec",originalConfig:g,config:S,deviceChange:m,npivWwnOp:S.npivWwnOp,cpuFeatureMask:o.createCpuIdInfoDelta(f,S.cpuFeatureMask),profile:[]};var y=mt();y&&!K.containsSpbmIssues&&v.vmSpec.profile.push(a.makeProfile(y.id,ht())),m&&c.setBackingDatastore(m,Me(),K.storageDiskList)}Yt(v.vmSpec,t),v.cloneSpec.location.deviceChange=t.deviceChange;var C=pt();if(C){v.cloneSpec.powerOn=C.powerOn;var D=lt();C.customizeOs&&D&&(v.cloneSpec.customization=D)}t&&t.disk&&_.extend(v.cloneSpec.location,t);var w=e.virtualDisks,b=Et(w),I=Qt(m),T=Et(I,!0),E=P()[re()];return v.podSelectionSpec=l.createSpecForClone(b,T,Me(),K.diskFormat,K.storageDiskList,E),Mt(v.podSelectionSpec,K.diskFormat),Kt(v.cloneSpec),v})})},Kt=function(e){var t=z();if(!_.isEmpty(t)){var i=[];_.each(t,function(e){var t={_type:"com.vmware.vim.binding.vim.vApp.PropertySpec",operation:"edit",info:e};i.push(t)}.bind(this)),e.config||(e.config={_type:"com.vmware.vim.binding.vim.vm.ConfigSpec"}),e.config.vAppConfig={_type:"com.vmware.vim.binding.vim.vApp.VmConfigSpec",property:i}}},Xt=function(){var e=z();if(_.isEmpty(e))return!1;var t=_.some(e,function(e){return e.userConfigurable&&"expression"!==e.type});return t},Qt=function(e){if(e){var t=_.filter(e,function(e){return i.isDeviceSubclassOf(e.device,"VirtualDisk")&&e.device.key<0});return _.map(t,function(e){return bt(e.device)})}return[]},Zt=function(){return _.include([n.CLONE_TEMPLATE_TO_TEMPLATE,n.CLONE_VM_TO_TEMPLATE],J())},Jt=function(e){return f(e,!1)},ei=function(){return f(ke(),!0)},ti=function(e){ii(ke(),e.id)},ii=function(e,i){if(H)return H;var o=null,a=r.getManagedObjectReference(K.computeResourceId);a.type===s.HOST&&(o=a);var c=J()===n.CREATE_FROM_SCRATCH?$e()?$e().id:null:Be();c=c||i,G=c;var l=[{propertyName:"vmConfigEnvironmentPerPool",parameterType:"com.vmware.vsphere.client.h5.vm.model.provisioning.VmConfigEnvironmentPerPoolParams",parameter:{_type:"com.vmware.vsphere.client.h5.vm.model.provisioning.VmConfigEnvironmentPerPoolParams",key:e,hostRef:o,gosId:c}}];return H=t.getProperties(K.resourcePool.id,["vmConfigEnvironmentPerPool"],{propertyParams:l}).then(function(e){return K.envBrowserRef=e.vmConfigEnvironmentPerPool.envBrowserRef,e})},ri=function(){return ii(ke())},ni=function(){return si("VirtualDisk")},oi=function(){return si("VirtualTPM")},ai=function(){return si("VirtualSCSIController")},si=function(e){return _.filter(tt().getDeviceChanges(),function(t){return i.isDeviceSubclassOf(t.device,e)})},ci=function(){return K.filterNetworksObjectId},li=function(e){K.filterNetworksObjectId=e},di=function(){return K.registerVmData},ui=function(e){K.registerVmData=e},pi=function(){var e=re(),t=te();if(!e||!t||!t.targetUid)return!1;var i=r.getPartsFromVsphereObjectId(e).serverGuid,n=r.getPartsFromVsphereObjectId(t.targetUid).serverGuid;return i!==n};return{setCreationType:Z,getCreationType:J,setVmId:ie,getVmId:re,setName:ne,getName:oe,setHasEncryptNewVmPrivilege:ae,getHasEncryptNewVmPrivilege:se,setHasManageEncryptionPolicyPrivilege:ce,getHasManageEncryptionPolicyPrivilege:le,getTemplateName:ue,setTemplateName:de,setTargetInformation:ee,getTargetInformation:te,setRecreateVm:pe,getRecreateVm:ve,setComputeResourceId:me,getComputeResourceId:ge,getComputeResourceOwnerId:he,setComputeResourceOwnerId:fe,setComputeResourceName:Se,getComputeResourceName:ye,getResourcePool:Ce,setResourcePool:Pe,isResourcePoolInVapp:be,setIsResourcePoolInVapp:we,getVmOriginalConfigSpec:Ie,setVmOriginalConfigSpec:De,getSourceVmStorageConfig:Te,setSourceVmStorageConfig:Ee,getVmConfigSpec:Ve,setVmConfigSpec:_e,getStorageObject:Me,getDisableSdrs:Oe,setDisableSdrs:Ae,getVmVersion:ke,setVmVersion:Re,getScheduledVmVersion:Ne,setScheduledVmVersion:Ue,getScheduledData:Le,setScheduledData:Fe,getGosFamily:xe,getGosVersion:$e,getGosName:ze,setGosName:qe,setGuestOsId:He,getGuestOsId:Be,setScheduledGuestOsId:Ge,getScheduledGuestOsId:je,setScheduledGuestName:We,getScheduledGuestName:Ye,setGosFamilyAndVersion:Ke,setCustomPcName:ot,setCustomIpv4ForNIC:at,setCustomIpv6ForNIC:st,setCustomizationSpec:ct,getCustomizationSpec:lt,setCustomizationSpecInfo:dt,getCustomizationSpecInfo:ut,getVirtualMachineDevices:tt,setVirtualMachineDevices:et,setCloneOptions:it,getCloneOptions:pt,setSelectedStorageProfile:vt,getSelectedStorageProfile:mt,getSelectedReplicationGroupInfo:ht,setSelectedReplicationGroupInfo:gt,setSelectedStorageProfileForDisks:ft,getSelectedStorageProfileForDisks:St,storageObjectIsPod:yt,storageObjectIsStandaloneDs:Pt,setStorageObjectAndDiskFormat:Dt,setStorageObject:Ct,getDiskFormat:wt,getVmCreateSpec:xt,getVmRecommendationsSpec:Bt,setVmRecommendationsSpec:Gt,getCustomizeCloneHardware:Wt,setCustomizeCloneHardware:jt,getVmCloneSpec:qt,getVmConfigEnvironmentForVmVersion:ii,getVmConfigEnvironment:ri,getConfigOptionByPool:ei,queryConfigOptionByPool:Jt,setStorageForDisk:Nt,getStorageDiskList:v,getStorageForDisk:Ut,getStorageNameForDisk:Lt,getDiskChanges:ni,getScsiControllerChanges:ai,getTpmChanges:oi,getStorageNameAndIdForDisk:Ft,getFilterNetworksObjectId:ci,setFilterNetworksObjectId:li,getRegisterVmData:di,setRegisterVmData:ui,isXvc:pi,setIsAdvancedStorageMode:S,getIsAdvancedStorageMode:y,getVmDisksStorage:P,setVmDisksStorage:C,getStorageSelectorState:D,setStorageSelectorState:w,resetStorage:b,getStorageSelectorStatePerDisk:I,getProvisioningTypePerDisk:T,containsSpbmIssues:E,shouldRetrieveGosDescriptor:rt,retrieveGosDescriptor:nt,getVmConfigEnvironmentForGos:ti,getPrivileges:L,getAdvancedStoragePageData:F,getStoragePageData:x,setVbsEnabled:Qe,getVbsEnabled:Xe,setVbsSupported:Je,getVbsSupported:Ze,getDeployVmtxSpec:$t,getLibraryItemId:V,setLibraryItemId:M,getVmtxLibraryItemId:O,setVmtxLibraryItemId:A,setVmtxStorageSpecSettings:k,getVmtxStorageSpecSettings:R,setCustomizationSpecName:U,getCustomizationSpecName:N,getUpdatedNetwork:Ht,setVappPropertyDescriptors:$,getVappPropertyDescriptors:z,hasConfigurableVappProperties:Xt}};return f}]);var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.model.provisioning.VmCreateScheduledTaskEditDefaultsValidationSpec,i=function(){function e(e,t,i,r,n){this.managedEntityConstants=e,this.defaultUriSchemeUtil=t,this.mutationService=i,this.vmDeviceInfoService=r,this.initialStorageConfigurationService=n}return e.prototype.buildCreateVmData=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.entity),i=e.spec.argument,r=this.defaultUriSchemeUtil.getVsphereObjectId(i[0].value),n=i[2].value;return{vmId:t,contextObjId:r,pool:n.location.pool,host:n.location.host,spec:n,name:i[1].value,useScheduledTaskData:!0}},e.prototype.setVmParams=function(e,t,i){t.setVmId(e.vmId),t.setName(e.name),i.setSourceObjectName(e.originalVmName),t.setScheduledData(e),t.setGuestOsId(e.guestOsId)},e.prototype.requestScheduledData=function(e,i){var r=this,n=new t;return n.host=i.host,n.pool=i.pool,n.deviceChange=i.spec.location.deviceChange,n.locators=i.spec.location.disk,n.vmProfile=i.spec.location.profile,n.vm=this.defaultUriSchemeUtil.getManagedObjectReference(i.vmId),this.mutationService.validate(e,n._type,n).then(function(e){var t=e.result;i.computeResourceId=r.defaultUriSchemeUtil.getVsphereObjectId(t.computeResource),i.storageData=r.prepareStorageState(i.vmId,i.spec.location,t.replicationGroupsData),i.guestOsId=t.guestOsId,i.originalVmName=t.name})},e.prototype.prepareStorageState=function(e,t,i){var r={initialVmStorageConfig:this.initialStorageConfigurationService.computeInitialVmStorageConfig(e,t,i),initialViewMode:this.initialStorageConfigurationService.computeStoragePageViewMode(t)};return r},e.$inject=["managedEntityConstants","defaultUriSchemeUtil","mutationService","vmDeviceInfoService","initialStorageConfigurationService"],e}();e.VmCloneEditScheduledTaskService=i,angular.module("com.vmware.vsphere.client.vm").service("vmCloneEditScheduledTaskService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.model.provisioning.VmCreateScheduledTaskEditDefaultsValidationSpec,i=function(){function e(e,t,i,r,n){this.managedEntityConstants=e,this.defaultUriSchemeUtil=t,this.mutationService=i,this.vmDeviceInfoService=r,this.initialStorageConfigurationService=n}return e.prototype.buildCreateVmData=function(e){var t,i,r=e.entity,n=this.defaultUriSchemeUtil.getVsphereObjectId(r),o=e.spec.argument,a=o[0].value;return this.isCreateOnFolder(r)?(t=o[1].value,i=o[2].value):(t=r,i=o[1].value),{contextObjId:n,pool:t,host:i,spec:a,useScheduledTaskData:!0}},e.prototype.setVmParams=function(e,t){t.setName(e.spec.name),t.setScheduledVmVersion(e.spec.version),t.setScheduledGuestOsId(e.spec.guestId),e.spec.alternateGuestName&&t.setScheduledGuestName(e.spec.alternateGuestName),t.setScheduledData(e)},e.prototype.requestScheduledData=function(e,i){var r=this,n=new t;return n.host=i.host,n.pool=i.pool,n.datastoreNames=this.retrieveDatastoreNames(i.spec),n.vmProfile=i.spec.vmProfile,this.mutationService.validate(e,n._type,n).then(function(e){var t=e.result;i.datastoreRefs=t.datastoreRefs;var n=r.retrieveVmxDatastore(i.spec.files.vmPathName,t);i.storageData=r.prepareStorageState(i,n,i.datastoreRefs,t.replicationGroupsData),i.computeResourceId=r.defaultUriSchemeUtil.getVsphereObjectId(t.computeResource)})},e.prototype.retrieveVmxDatastore=function(e,t){var i=e.match(/\[(.*)\]/),r=i?i[1]:"",n=t.datastoreRefs[r];return n},e.prototype.retrieveDatastoreNames=function(e){var t=this,i=[];return i.push(e.files.vmPathName),_.each(e.deviceChange,function(e){t.vmDeviceInfoService.isDeviceSubclassOf(e.device,"VirtualDisk")&&i.push(e.device.backing.fileName)}),i=_.uniq(i)},e.prototype.isCreateOnFolder=function(e){var t=e.type===this.managedEntityConstants.FOLDER;return t},e.prototype.prepareStorageState=function(e,t,i,r){var n={initialVmStorageConfig:this.initialStorageConfigurationService.computeInitialVmStorageConfigForCreateVm(t,e.spec.deviceChange,i,e.spec.vmProfile,r),initialViewMode:this.initialStorageConfigurationService.BASIC_MODE};return n},e.$inject=["managedEntityConstants","defaultUriSchemeUtil","mutationService","vmDeviceInfoService","initialStorageConfigurationService"],e}();e.VmCreateEditScheduledTaskService=i,angular.module("com.vmware.vsphere.client.vm").service("vmCreateEditScheduledTaskService",i)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(e,t,i,n){var o=t.getGosVersion()?t.getGosVersion().id:t.getGuestOsId(),a=_.find(e.configOption.guestOSDescriptor,function(e){return e.id===o});if(void 0===a)throw new Error("Could not find Gues OS with ID '"+o+"' among "+e.configOption.guestOSDescriptor.length+" descriptors.");t.getGosVersion()||t.setGosFamilyAndVersion({family:a.family,version:a});var l=angular.copy(e.configOption.defaultDevice),d=t.getScheduledData(),u=!_.isEmpty(d)&&d.useScheduledTaskData,p=!_.isEmpty(d)&&d.spec;if(u&&p){if(p.deviceChange){var h=d.datastoreRefs,f=v(e),S=c.buildAvailableNetworkList(e.configTarget);s.addDevices(i,p.deviceChange,f,t,S,h,p.vmProfile)}return g(a,i,t,l,p)}_.contains(n,h5_vm.Privileges.VM_ADDNEWDISK_PRIVILEGE)&&r.createNewDevice("VirtualDisk",e,a,i,{selectedStorageProfile:t.getSelectedStorageProfileForDisks(),selectedReplicationGroupInfo:t.getSelectedReplicationGroupInfo()}),r.createNewDevice("VirtualEthernetCard",e,a,i),r.createNewDevice("VirtualCdrom",e,a,i);var y={isCreateMode:!0};return r.createNewDevice("VirtualUSBController",e,a,i,y),m(a,i,t,l)}function d(e,i,r,a,l){var d=t.getAppropriateGuestOs(i,{id:a.guestId});e.setGosFamilyAndVersion({family:{id:d.family,name:n.getString("VmUi","GeneralOptions.gos_family."+d.family)},version:{id:d.id,name:d.fullName}}),e.setVmOriginalConfigSpec(a),i.config.changeVersion=null;var p=e.getScheduledData(),m=!_.isEmpty(p)&&p.useScheduledTaskData,g=!_.isEmpty(p)&&p.spec;if(m&&g){var f=v(i.environment),S=c.buildAvailableNetworkList(i.environment.configTarget);g.location&&g.location.deviceChange&&s.addDevices(r,g.location.deviceChange,f,e,S,{}),g.config&&g.config.deviceChange&&s.addDevices(r,g.config.deviceChange,f,e,S,{}),e.setVmConfigSpec(h(g,i.config))}else e.setVmConfigSpec(i.config);e.setVirtualMachineDevices(r),u(r.existingDevicesOfType(o.VIRTUALDISK),l,e)}function u(e,t,i){var r=i.getSelectedReplicationGroupInfo(),n=a.getDefaultProfile();angular.forEach(e,function(e){var o,s=i.getStorageForDisk(e.getKey());s&&s.dsObject&&s.dsObject.storageRef&&i.storageObjectIsStandaloneDs(s.dsObject)&&(o=e.getCurrentDevice()&&e.getCurrentDevice().backing&&e.getCurrentDevice().backing.datastore?e.getCurrentDevice().backing.datastore:{},o.value=s.dsObject.storageRef.value,o.serverGuid=s.dsObject.storageRef.serverGuid,o.type=s.dsObject.storageRef.type);var c=n,l=a.findDiskAssignment(t,e.getCurrentDevice());l&&(c={id:l.profile.profileId.uniqueId,label:l.profile.name}),e.updateDatastoreMor(o),e.updateDiskProfile(c,r)})}function p(e){var t=angular.copy(e.configOption.defaultDevice),r=_.indexBy(e.configOption.hardwareOptions.virtualDeviceOption,function(e){return e.type.name}),n=new i(t,null,null,null,r);
return n}function v(e){var t=_.indexBy(e.configOption.hardwareOptions.virtualDeviceOption,function(e){return e.type.name});return t}function m(e,t,i,r){var n={_type:"com.vmware.vim.binding.vim.vm.BootOptions"};"efi"===e.recommendedFirmware&&e.defaultSecureBoot&&(n.efiSecureBootEnabled=!0);var o=e.numRecommendedCoresPerSocket?e.numRecommendedCoresPerSocket:1;return{vmConfigSpec:{config:{bootOptions:n,version:i.getVmVersion(),guestId:e.id,options:{},firmware:e.recommendedFirmware,hardware:{_type:"com.vmware.vim.binding.vim.vm.VirtualHardware",numCPU:e.numRecommendedPhysicalSockets?e.numRecommendedPhysicalSockets*o:o,memoryMB:e.recommendedMemMB,device:r,numCoresPerSocket:o,virtualICH7MPresent:!!e.ich7mRecommended,virtualSMCPresent:!!e.smcRecommended},cpuFeatureMask:[],cpuAllocation:{_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",reservation:0,limit:-1,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",shares:1e3,level:"normal"}},memoryAllocation:{_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",reservation:0,limit:-1,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",shares:10*e.recommendedMemMB,level:"normal"}},memoryReservationLockedToMax:!1,cpuAffinity:{_type:"com.vmware.vim.binding.vim.vm.AffinityInfo",affinitySet:[]},files:{_type:"com.vmware.vim.binding.vim.vm.FileInfo",vmPathName:i.storageObjectIsPod()?null:"["+i.getStorageObject().name+"]"},tools:{_type:"com.vmware.vim.binding.vim.vm.ToolsConfigInfo",afterPowerOn:!0,afterResume:!0,beforeGuestShutdown:!0,beforeGuestStandby:!0,toolsUpgradePolicy:"manual"},defaultPowerOps:{_type:"com.vmware.vim.binding.vim.vm.DefaultPowerOpInfo",powerOffType:"preset",suspendType:"preset",resetType:"preset",standbyAction:"checkpoint"},flags:{_type:"com.vmware.vim.binding.vim.vm.FlagInfo",virtualMmuUsage:"automatic",monitorType:"release"}}},virtualMachineDevices:t}}function g(e,t,i,r,n){var o={_type:"com.vmware.vim.binding.vim.vm.BootOptions"};"efi"===e.recommendedFirmware&&e.defaultSecureBoot&&(o.efiSecureBootEnabled=!0);var a=e.recommendedMemMB,s=!!e.ich7mRecommended,c=!!e.smcRecommended,l=e.recommendedFirmware,d={_type:"com.vmware.vim.binding.vim.ResourceAllocationInfo",reservation:0,limit:-1,shares:{_type:"com.vmware.vim.binding.vim.SharesInfo",shares:10*e.recommendedMemMB,level:"normal"}},u=n.cpuAffinity;_.isEmpty(u)||(u.affinitySet=u.affinitySet?u.affinitySet:[]);var p=n.files;return p.vmPathName=i.storageObjectIsPod()?null:"["+i.getStorageObject().name+"]",e.id===n.guestId&&(o=n.bootOptions,a=n.memoryMB,s=n.virtualICH7MPresent,c=n.virtualSMCPresent,d=n.memoryAllocation,l=n.firmware),{vmConfigSpec:{config:{bootOptions:o,version:i.getVmVersion(),guestId:e.id,options:{},firmware:l,hardware:{_type:"com.vmware.vim.binding.vim.vm.VirtualHardware",numCPU:n.numCPUs,memoryMB:a,device:r,numCoresPerSocket:n.numCoresPerSocket,virtualICH7MPresent:s,virtualSMCPresent:c},cpuFeatureMask:_.isEmpty(n.cpuFeatureMask)?[]:f(n.cpuFeatureMask),cpuHotAddEnabled:n.cpuHotAddEnabled,nestedHVEnabled:n.nestedHVEnabled,vPMCEnabled:n.vPMCEnabled,cpuAllocation:n.cpuAllocation,memoryAllocation:d,memoryReservationLockedToMax:n.memoryReservationLockedToMax,memoryHotAddEnabled:n.memoryHotAddEnabled,cpuAffinity:n.cpuAffinity,files:p,tools:n.tools,defaultPowerOps:n.powerOpInfo,flags:n.flags,guestAutoLockEnabled:n.guestAutoLockEnabled,maxMksConnections:n.maxMksConnections,migrateEncryption:n.migrateEncryption,swapPlacement:n.swapPlacement,latencySensitivity:n.latencySensitivity,extraConfig:n.extraConfig,npivTemporaryDisabled:n.npivTemporaryDisabled,npivWwnOp:n.npivWorldWideNameOp,npivDesiredNodeWwns:n.npivDesiredNodeWwns,npivDesiredPortWwns:n.npivDesiredPortWwns}},virtualMachineDevices:t}}function h(e,t){var i=angular.copy(t);if(_.isEmpty(e.config))return i;var r=_.keys(e.config),n=e.config.cpuAffinity;_.isEmpty(n)||(n.affinitySet=n.affinitySet?n.affinitySet:[]),S(i,e.config,"cpuAllocation"),S(i,e.config,"memoryAllocation"),S(i,e.config,"flags"),S(i,e.config,"bootOptions"),S(i,e.config,"tools"),_.each(r,function(t){"_type"!==t&&null!==e.config[t]&&i.hasOwnProperty(t)&&(i[t]=e.config[t])}),i.cpuFeatureMask=[],_.isEmpty(e.config.cpuFeatureMask)||(i.cpuFeatureMask=f(e.config.cpuFeatureMask));var o=_.keys(i.hardware);_.each(o,function(t){"_type"!==t&&null!==e.config[t]&&e.config.hasOwnProperty(t)&&(i.hardware[t]=e.config[t])});var a=_.keys(i.defaultPowerOps);return _.each(a,function(t){"_type"!==t&&null!==e.config.powerOpInfo&&null!==e.config.powerOpInfo[t]&&e.config.powerOpInfo.hasOwnProperty(t)&&(i.defaultPowerOps[t]=e.config.powerOpInfo[t])}),null!==e.config.numCPUs&&(i.hardware.numCPU=e.config.numCPUs),null!==e.config.npivWorldWideNameOp&&(i.npivWwnOp=e.config.npivWorldWideNameOp),i}function f(e){var t=[];return _.each(e,function(e){_.isEmpty(e.info)||t.push(e.info)}),t}function S(e,t,i){var r=_.keys(e[i]);_.each(r,function(r){var n=null!==t[i]&&null===t[i][r]&&t[i].hasOwnProperty(r);"_type"!==r&&n&&e[i]&&null!==e[i][r]&&(t[i][r]=e[i][r])})}return e.addLocalizationKey("VirtualEthernetCard","NewEthernet"),e.addLocalizationKey("VirtualDisk","NewDisk"),e.addLocalizationKey("VirtualSCSIController","NewSCSIController"),e.addLocalizationKey("VirtualSATAController","NewSATAController"),{buildNewVM:l,buildCloneVM:d,applyStorageToVirtualDisks:u,buildVirtualDevicesForCreate:p}}angular.module("com.vmware.vsphere.client.vm").service("vmFactoryService",e),e.$inject=["deviceService","guestOsService","VirtualMachineDevices","vmDeviceManagementService","i18nService","deviceTypeConstants","storageProfileService","scheduledTasksDeviceChangesService","vmDeviceInfoService"]}();var h5_vm;!function(e){var t=function(){function t(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.$q=e,this.i18nService=t,this.addVmService=i,this.vmDeviceInfoService=r,this.defaultUriSchemeUtil=n,this.storageProfileService=o,this.diskModeService=a,this.managedEntityConstants=s,this.datastoreRecommendationService=c,this.spbmReplicationGroupInfoService=l,this.creationTypeConstants=d,this.COMPATIBILITY_MODE_VIRTUAL="virtualMode",this.COMPATIBILITY_MODE_PHYSICAL="physicalMode",this._form={vmStorageRecommendation:{}},this.noDrsFaults=!1,this.finishedLoading=!1,this._virtualMachineSpecBuilder=u,this._wizardViewData=p,this._scheduledTaskData=v}return Object.defineProperty(t.prototype,"virtualMachineSpecBuilder",{get:function(){return this._virtualMachineSpecBuilder},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wizardViewData",{get:function(){return this._wizardViewData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scheduledTaskData",{get:function(){return this._scheduledTaskData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"form",{get:function(){return this._form},set:function(e){this._form=e},enumerable:!0,configurable:!0}),t.prototype.resetForm=function(){this.form.vmStorageRecommendation={}},t.prototype.pageFinishedLoading=function(){return this.finishedLoading},t.prototype.validatePage=function(){return this.noDrsFaults?{}:{error:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.drsFaultsOnPage")}},t.prototype.setSelectedRecommendation=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.target);this.form.vmStorageRecommendation[t]=e},t.prototype.getSelectedRecommendation=function(e){return this.form.vmStorageRecommendation&&!_.isEmpty(this.form.vmStorageRecommendation[e])?this.form.vmStorageRecommendation[e]:null},t.prototype.submitPage=function(){return this.virtualMachineSpecBuilder.setVmRecommendationsSpec(this.form.vmStorageRecommendation),this.scheduledTaskData&&this.scheduledTaskData.isScheduledTask?this.addVmService.createVmScheduledTask(this.virtualMachineSpecBuilder,this.scheduledTaskData):this.addVmService.createVm(this.virtualMachineSpecBuilder),this.$q.resolve(!0)},t.prototype.getVmName=function(){return this.virtualMachineSpecBuilder.getName()},t.prototype.getTargetFolderName=function(){return this.virtualMachineSpecBuilder.getTargetInformation().name},t.prototype.presentTargetStorageName=function(){return this.getDatastore()},t.prototype.getComputeResourceInfo=function(){var e=this.virtualMachineSpecBuilder.getComputeResourceId(),t=this.virtualMachineSpecBuilder.getComputeResourceName(),i=this.labelForType(e);return{name:t,label:i}},t.prototype.isStorageProfileSpecified=function(){var e=this.virtualMachineSpecBuilder.getSelectedStorageProfile();return!!e&&!!e.id&&e.id!==this.storageProfileService.DEFAULT_ID},t.prototype.isVmHomeEncrypted=function(){if(!this.isStorageProfileSpecified())return!1;var e=this.virtualMachineSpecBuilder.getSelectedStorageProfile();return this.storageProfileService.isEncryptionStorageProfile(e)},t.prototype.areAllDisksEncrypted=function(){if(!this.isVmHomeEncrypted())return!1;if(!this.virtualMachineSpecBuilder.getVirtualMachineDevices())return!0;var t=this.virtualMachineSpecBuilder.getVirtualMachineDevices().changedDevicesOfType(e.DeviceTypeConstants.VIRTUALDISK);return!_.find(t,function(e){return!e.isDiskEncrypted()})},t.prototype.getStorageProfile=function(){return this.virtualMachineSpecBuilder.getSelectedStorageProfile()&&this.virtualMachineSpecBuilder.getSelectedStorageProfile().label},t.prototype.isReplicationGroupSpecified=function(){var e=this.virtualMachineSpecBuilder.getSelectedReplicationGroupInfo();return!!e},t.prototype.getReplicationGroup=function(){return this.virtualMachineSpecBuilder.getSelectedReplicationGroupInfo()&&this.spbmReplicationGroupInfoService.getReplicationGroupName(this.virtualMachineSpecBuilder.getSelectedReplicationGroupInfo())},t.prototype.fetchStoragePlacementRecommendations=function(){var e=this;return this.addVmService.validateSpec(this.virtualMachineSpecBuilder).then(function(t){return t.faults?(e.finishedLoading=!0,e.noDrsFaults=!1,e.$q.reject(t.faults)):(t.recommendationsPerPod&&(e.form.recommendationsPerPod=t.recommendationsPerPod,angular.forEach(t.recommendationsPerPod,function(t){e.setSelectedRecommendation(t.topRecommendation)}),e.form.diskDatastoresMap=t.topRecommendedDatastoresPerDisk),e.finishedLoading=!0,e.noDrsFaults=!0,e.$q.resolve())})},t.prototype.labelForType=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).type;switch(t){case"ClusterComputeResource":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Cluster");case"HostSystem":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Host");case"ResourcePool":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.RP");case"VirtualApp":return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.RP");default:throw new Error("Unknown compute resouce id: "+e)}},t.prototype.getNvdimmDevicesInfo=function(){var e=this;if(!this.virtualMachineSpecBuilder.getVirtualMachineDevices())return[];var t=this.virtualMachineSpecBuilder.getVirtualMachineDevices().devicesOfTypeNotMarkedForRemoval("VirtualNVDIMM"),i=_.chain(t).sortBy(function(e){return Math.abs(e.getKey())}).map(function(t,i){return{label:e.getNvdimmLabel(t,i),capacityInMb:t.getCapacityInMB()}}).value();return i},t.prototype.getNvdimmLabel=function(e,t){return e.isNew()?this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.createNvdimm",t+1):e.getCurrentDevice().deviceInfo.label},t.prototype.getStorageObject=function(e){var t=this.virtualMachineSpecBuilder.getStorageObject();return e&&(t=e.dsObject),t},t.prototype.getDiskMode=function(e){return e&&e.backing&&e.backing.diskMode?this.diskModeService.getModeName(e.backing.diskMode):""},t.prototype.getStorageProfileForDisk=function(e){var t=this.virtualMachineSpecBuilder.getVirtualMachineDevices().getVirtualDevice(e.key);return!t.isNew()&&this.virtualMachineSpecBuilder.getIsAdvancedStorageMode()?this.virtualMachineSpecBuilder.getStorageSelectorStatePerDisk(e.key).storageProfile:t.getProfile()},t.prototype.getReplicationGroupLabelForDisk=function(e){var t=this.getReplicationGroupForDisk(e);return t?this.spbmReplicationGroupInfoService.getReplicationGroupName(t):null},t.prototype.getReplicationGroupForDisk=function(e){var t=this.virtualMachineSpecBuilder.getVirtualMachineDevices().getVirtualDevice(e.key);return!t.isNew()&&this.virtualMachineSpecBuilder.getIsAdvancedStorageMode()?this.virtualMachineSpecBuilder.getStorageSelectorStatePerDisk(e.key).replicationGroup:t.getCurrentReplicationGroup()},t.prototype.diskHasDefaultStoragePolicy=function(e){var i=this.getStorageProfileForDisk(e);return!!i&&(i.profileId===this.storageProfileService.DEFAULT_ID||i.id===this.storageProfileService.DEFAULT_ID||i._type===t.DEFAULT_PROFILE_CLASS)},t.prototype.setDisksDatastoreInfo=function(e){var t=this;_.each(e,function(e){var i=t.virtualMachineSpecBuilder.getStorageForDisk(e.diskKey);e.datastoreInfo=t.getDatastore(i,e)})},t.prototype.getDatastore=function(e,t){var i=this.virtualMachineSpecBuilder.getStorageObject();e&&(i=e.dsObject);var r=i.storageRef;r.type!==this.managedEntityConstants.STORAGE_POD&&i.parentStoragePod&&!this.isDeployVmFromVmtxTemplateMode()&&(r=i.parentStoragePod);var n=this.getDatastoreNameForPod(r,t);return this.getDatastoreLabel(i,n)},t.prototype.getRDMTargetLUNName=function(e,t){var i=t.configTarget.scsiDisk,r=_.find(i,function(t){return t.disk.deviceName===e.backing.deviceName});return r?r.disk.displayName:""},t.prototype.getRDMCompatibility=function(e){var t="";switch(e.backing.compatibilityMode){case this.COMPATIBILITY_MODE_VIRTUAL:t=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskCompatibilityModeVirtual");break;case this.COMPATIBILITY_MODE_PHYSICAL:t=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskCompatibilityModePhysical");break;default:t=""}return t},t.prototype.getRDMDatastoreName=function(){return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskMappedDatastoreSame")},t.prototype.isDiskEncrypted=function(e){var t=this.virtualMachineSpecBuilder.getVirtualMachineDevices().getVirtualDevice(e);return t.isDiskEncrypted()},t.prototype.getDatastoreLabel=function(e,t){var i=!this.datastoreRecommendationService.areRecommendationsAvailableForStorageObject(e),r=this.virtualMachineSpecBuilder.isXvc();return i=this.isDeployVmFromVmtxTemplateMode()||r||i,this.vmDeviceInfoService.getStorageObjectLabel(e,t,i,this.wizardViewData.getStorageNameMap())},t.prototype.getDatastoreNameForPod=function(e,t){var i="",r=this.defaultUriSchemeUtil.getVsphereObjectId(e),n=this.getSelectedRecommendation(r);if(n){var o=null;t&&(o=_.find(n.action,function(e){return e.relocateSpec.disk&&e.relocateSpec.disk.length&&e.relocateSpec.disk[0].diskId===t.diskKey})),o=o||n.action[0];var a=o.destination,s=this.defaultUriSchemeUtil.getVsphereObjectId(a);i=this.wizardViewData.getStorageNameMap()[s]}return i},t.prototype.isDeployVmFromVmtxTemplateMode=function(){return this.creationTypeConstants.isDeployVmFromVmtxTemplate(this._virtualMachineSpecBuilder.getCreationType())},t.DEFAULT_PROFILE_CLASS="com.vmware.vim.binding.vim.vm.DefaultProfileSpec",t}();e.VmProvisioningFinishPageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,r,n,o){return function(a,s,c){return new i(e,t,r,n,o,a,s,c)}}return e.$inject=["dataService","i18nService","customizeGosPreCheckSpecsService","$q","defaultUriSchemeUtil"],e}(),i=function(){function t(e,t,i,r,n,o,a,s){this.dataService=e,this.i18nService=t,this.customizeGosPreCheckSpecsService=i,this.$q=r,this.defaultUriSchemeUtil=n,this.form={},this.CUSTOMIZE_OS_RESPONSE="customizeOsResponse",this.POWER_ON_RESPONSE="powerOnResponse",this._virtualMachineSpecBuilder=o,this._wizardViewData=a,this._wizardConfig=s}return Object.defineProperty(t.prototype,"virtualMachineSpecBuilder",{get:function(){return this._virtualMachineSpecBuilder},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wizardViewData",{get:function(){return this._wizardViewData},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"wizardConfig",{get:function(){return this._wizardConfig},enumerable:!0,configurable:!0}),t.prototype.resetForm=function(){this.wizardConfig.loadingMessage=this.i18nService.getString("CommonUi","wizard.validating");var e=!_.isNull(this.form.customizeOs)&&!_.isUndefined(this.form.customizeOs)&&this.form.customizeOs,t=!_.isNull(this.form.powerOn)&&!_.isUndefined(this.form.powerOn)&&this.form.powerOn,i=this.virtualMachineSpecBuilder.getCustomizeCloneHardware()||!1,r=this.form.customizeHw?this.form.customizeHw:i;this.form.powerOn=t,this.form.customizeOs=e,this.form.customizeHw=r,this.originalCustomizeOs=this.form.customizeOs,this.originalCustomizeHw=this.form.customizeHw},t.prototype.validatePage=function(){var t=this,i={},r=this.virtualMachineSpecBuilder.getVmId();if(this.form.customizeOs){this.wizardConfig.loading=!0;var n=this.defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(this.virtualMachineSpecBuilder.getTargetInformation().datacenterUid);i[this.CUSTOMIZE_OS_RESPONSE]=this.customizeGosPreCheckSpecsService.cloneCustomizeGosLoadData(r,!0,n)}if(this.form.powerOn&&(this.wizardConfig.loading=!0,i[this.POWER_ON_RESPONSE]=this.virtualMachineSpecBuilder.getPrivileges()),!_.isEmpty(i))return this.$q.all(i).then(function(i){t.wizardConfig.loading=!1;var r="";if(t.form.powerOn&&_.indexOf(i.powerOnResponse,e.Privileges.VM_INTERACT_POWER_ON)===-1&&(r=t.i18nService.getString("VmUi","CustomizeGuestOsProvisioningPage.content.no_permissions_power_on")))return{error:r};if(t.form.customizeOs){var n=i.customizeOsResponse.data;if(r=i.customizeOsResponse.error)return{error:r};t.wizardViewData.setCustomizeGosSpecData(n)}return{}})},t.prototype.submitPage=function(){this.virtualMachineSpecBuilder.setCustomizeCloneHardware(this.form.customizeHw),this.virtualMachineSpecBuilder.setCloneOptions({powerOn:this.form.powerOn,customizeOs:this.form.customizeOs});var e=!this.originalCustomizeOs&&this.form.customizeOs,t=!this.originalCustomizeHw&&this.form.customizeHw,i=e||t;return{wizardFlow:this.virtualMachineSpecBuilder.getCreationType(),invalidateNextPages:i}},t.$inject=["dataService","i18nService","customizeGosPreCheckSpecsService","$q","defaultUriSchemeUtil"],t}();e.VmProvisioningCloneOptionsPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningCloneOptionsPageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vmVuiWizardPageBuilder=t,this.creationTypeConstants=i,this.vmProvisioningSelectAnyTemplatePageModel=r}return e.prototype.build=function(e){var t=new this.vmProvisioningSelectAnyTemplatePageModel(e);e.selectAnyTemplateModel=t;var i=this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Title"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningSelectAnyTemplate.html",model:t});return i.decisionOptions={flowIds:[this.creationTypeConstants.DEPLOY_VM_FROM_TEMPLATE,this.creationTypeConstants.CLONE_TEMPLATE_TO_VM],selectedFlowId:this.creationTypeConstants.DEPLOY_VM_FROM_TEMPLATE},i},e.$inject=["i18nService","vmVuiWizardPageBuilder","creationTypeConstants","vmProvisioningSelectAnyTemplatePageModel"],e}();e.VmProvisioningSelectAnyTemplatePageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectAnyTemplatePageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,r,n,o,a,s,c){return function(l,d,u){return new i(e,t,r,n,o,a,s,c,l,d,u)}}return e.$inject=["$q","i18nService","dataService","authorizationService","defaultUriSchemeUtil","managedEntityConstants","creationTypeConstants","wizardPageService"],e}(),i=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.$q=e,this.i18nService=t,this.dataService=i,this.authorizationService=r,this.defaultUriSchemeUtil=n,this.managedEntityConstants=o,this.creationTypeConstants=a,this.wizardPageService=s,this.RUNTIME_CONNECTION_STATE="runtime/connectionState",this.GUEST_OS_ID="config/guestId",this.VAPP_PROPERTY_DESCRIPTORS_PROPERTY="config.vAppConfig.property",this.INVALID_STATE=this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.Provisioning.InvalidState"),this.INVALID_ENTITY_ERROR=this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.SelectValidEntity"),this.MARK_AS_VM_PRIVILEGE="VirtualMachine.Provisioning.MarkAsVM",this.CLONE_TEMPLATE_PRIVILEGE="VirtualMachine.Provisioning.CloneTemplate",this.CONNECTED="connected",this.showLoadingIndicator=!0,this.virtualMachineSpecBuilder=c,this.wizardViewData=l,this.config=d}return e.prototype.updateSelection=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e.id).type;return this._selectionId=e.id,this._selectionIsTemplate=t===this.managedEntityConstants.VIRTUAL_MACHINE,this.selectedTemplateChanged=this.lastSelectedTemplateId!==this._selectionId,!!this._selectionIsTemplate&&(this.virtualMachineSpecBuilder.setVmId(e.id),this.wizardViewData.setSourceObjectName(e.text),!0)},e.prototype.clearSelection=function(){this._selectionId=void 0,this._selectionIsTemplate=!1},e.prototype.getSelectionId=function(){return this._selectionId},e.prototype.getSelectionIsTemplate=function(){return!!this._selectionIsTemplate},e.prototype.getLastSelectedCreationType=function(){return this.lastSelectedCreationType},e.prototype.validateSelection=function(){var e=this;return this.wizardPageService.clearErrors(this.config),this.lastSelectedCreationType=this.virtualMachineSpecBuilder.getCreationType(),this.lastSelectedTemplateId&&this.lastSelectedTemplateId===this._selectionId&&!_.isUndefined(this.compatibilityResultsCache)?this.setPrivilegesAndConnectionState():this._selectionIsTemplate?this.$q.all({vmProperties:this.dataService.getProperties(this._selectionId,[this.RUNTIME_CONNECTION_STATE,this.GUEST_OS_ID,this.VAPP_PROPERTY_DESCRIPTORS_PROPERTY]),privileges:this.authorizationService.checkGrantedPrivileges(this._selectionId,[this.getRequiredPermission(this.virtualMachineSpecBuilder.getCreationType())])}).then(function(t){return e.compatibilityResultsCache=t,e.lastSelectedTemplateId=e._selectionId,e.setPrivilegesAndConnectionState()}):this.$q.when("")},e.prototype.setPrivilegesAndConnectionState=function(){if(!this.compatibilityResultsCache)return this.$q.when("");var e=this.compatibilityResultsCache.vmProperties[this.RUNTIME_CONNECTION_STATE];this.wizardViewData.setVmConnectedState(e),this.virtualMachineSpecBuilder.setGuestOsId(this.compatibilityResultsCache.vmProperties[this.GUEST_OS_ID]),this.virtualMachineSpecBuilder.setVappPropertyDescriptors(this.compatibilityResultsCache.vmProperties[this.VAPP_PROPERTY_DESCRIPTORS_PROPERTY]);var t=this.makeCompatibilityMessage(this.compatibilityResultsCache.privileges,e);return this.$q.resolve(t)},e.prototype.reset=function(){this.compatibilityResultsCache=void 0},e.prototype.resetForm=function(){},e.prototype.validatePage=function(){return this._selectionIsTemplate?this.wizardViewData.getVmConnectedState()!==this.CONNECTED?this.$q.resolve({error:this.INVALID_STATE}):this.hasActionPrivileges?this.$q.resolve({}):this.$q.resolve({error:this.createNoPrivilegesErrorString(this.virtualMachineSpecBuilder.getCreationType())}):this.$q.resolve({error:this.INVALID_ENTITY_ERROR})},e.prototype.submitPage=function(){var e=this;this._originalWizardTitle&&this.config.title.indexOf(this._originalWizardTitle)!==-1||(this._originalWizardTitle=this.config.title),this.config.title=this.wizardViewData.getSourceObjectName()+" - "+this._originalWizardTitle;var t=this.config.pages,i=this.config.flows;if(i&&i.length>0){var r=_.find(i,function(t){return e.virtualMachineSpecBuilder.getCreationType()===t.id});r&&(t=r.pages)}return this.creationTypeConstants.isCloning(this.virtualMachineSpecBuilder.getCreationType())&&(this.virtualMachineSpecBuilder.hasConfigurableVappProperties()?this.wizardPageService.markPageDisabled(t,this.i18nService.getString("VmUi","VAppPropertiesProvisioningPage.title")):this.wizardPageService.markPageSkipped(t,this.i18nService.getString("VmUi","VAppPropertiesProvisioningPage.title"))),{wizardFlow:this.virtualMachineSpecBuilder.getCreationType(),invalidateNextPages:this.selectedTemplateChanged}},e.prototype.makeCompatibilityMessage=function(e,t){if(this.hasActionPrivileges=!0,t!==this.CONNECTED)return this.INVALID_STATE;for(var i=0;i<e.length;i++)if(!e[i]){this.hasActionPrivileges=!1;break}return this.hasActionPrivileges?"":this.createNoPrivilegesErrorString(this.virtualMachineSpecBuilder.getCreationType())},e.prototype.createNoPrivilegesErrorString=function(e){var t="SelectTemplateProvisioningPage.Template.NoPermission."+this.getRequiredPermission(e);return this.i18nService.getString("VmUi",t)},e.prototype.getRequiredPermission=function(e){return e===this.creationTypeConstants.CONVERT_TEMPLATE_TO_VM?this.MARK_AS_VM_PRIVILEGE:e===this.creationTypeConstants.CLONE_TEMPLATE_TO_TEMPLATE||e===this.creationTypeConstants.CLONE_TEMPLATE_TO_VM?this.CLONE_TEMPLATE_PRIVILEGE:""},e.$inject=["$q","i18nService","dataService","authorizationService","defaultUriSchemeUtil","managedEntityConstants","creationTypeConstants","wizardPageService"],e}();e.VmProvisioningSelectTemplatePageModel=i,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectTemplatePageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.defaultUriSchemeUtil=t,this.wizardPageService=i,this.vmVuiWizardPageBuilder=r,this.vmProvisioningSelectTemplatePageModel=n}return e.prototype.build=function(e){var t=new this.vmProvisioningSelectTemplatePageModel(e.vmParams,e.wizardViewData,e.config);return e.selectTemplateModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.Title"),description:this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vm-provisioning-select-template-page.html",model:t})},e.$inject=["i18nService","defaultUriSchemeUtil","wizardPageService","vmVuiWizardPageBuilder","vmProvisioningSelectTemplatePageModel"],e}();e.VmProvisioningSelectTemplatePageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectTemplatePageService",t)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.VmProvisioningSelectTemplatePageModel,i=function(){function e(e,t,i,n,o,a,s,c){return function(l,d,u){return new r(e,t,i,n,o,a,s,c,l,d,u)}}return e.$inject=["$q","i18nService","dataService","authorizationService","defaultUriSchemeUtil","managedEntityConstants","creationTypeConstants","wizardPageService"],e}(),r=function(e){function t(t,i,r,n,o,a,s,c,l,d,u){e.call(this,t,i,r,n,o,a,s,c,l,d,u)}return __extends(t,e),t.prototype.updateSelection=function(t){var i=e.prototype.updateSelection.call(this,t);if(!i)return!1;var r=this.getDatacenter(t);return this.virtualMachineSpecBuilder.setTargetInformation(r.id,r.id,null,r.text),!0},t.prototype.getDatacenter=function(e){for(;this.defaultUriSchemeUtil.getEntityType(e.objRef)!==this.managedEntityConstants.DATACENTER;)e=e.parentNode();return e},t.$inject=["$q","i18nService","dataService","authorizationService","defaultUriSchemeUtil","managedEntityConstants","creationTypeConstants","wizardPageService"],t}(t);e.VmProvisioningSelectTemplateToConvertPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectTemplateToConvertPageModel",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.defaultUriSchemeUtil=t,this.wizardPageService=i,this.vmVuiWizardPageBuilder=r,this.vmProvisioningSelectTemplateToConvertPageModel=n}return e.prototype.build=function(e){var t=new this.vmProvisioningSelectTemplateToConvertPageModel(e.vmParams,e.wizardViewData,e.config);return e.selectTemplateToConvertModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.Title"),description:this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vm-provisioning-select-template-to-convert-page.html",model:t})},e.$inject=["i18nService","defaultUriSchemeUtil","wizardPageService","vmVuiWizardPageBuilder","vmProvisioningSelectTemplateToConvertPageModel"],e}();e.VmProvisioningSelectTemplateToConvertPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectTemplateToConvertPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){return function(r){return new i(e,t,r)}}return e.$inject=["i18nService","dataService"],e}(),i=function(){function e(e,t,i){this.i18nService=e,this.dataService=t,this.virtualMachineSpecBuilder=i,this.NETWORK_PROPERTY="network",this.IP_POOL_DATA_PROPERTY="ipPoolData",this.IP_ALLOCATION_PROTOCOL_PROPERTY="config.vAppConfig.ipAssignment.ipProtocol"}return e.prototype.resetForm=function(){},e.prototype.getVappPropertyDescriptors=function(){return this._vappPropertyDescriptors=this.virtualMachineSpecBuilder.getVappPropertyDescriptors(),this._vappPropertyDescriptors=_.filter(this._vappPropertyDescriptors,function(e){return e.userConfigurable&&"expression"!==e.type}),this._vappPropertyDescriptors},e.prototype.retrieveIpPoolsData=function(){var e=this,t=this.virtualMachineSpecBuilder.getVmId();return this.dataService.getProperties(t,[this.NETWORK_PROPERTY,this.IP_POOL_DATA_PROPERTY,this.IP_ALLOCATION_PROTOCOL_PROPERTY]).then(function(t){return{networks:t[e.NETWORK_PROPERTY],ipPoolData:t[e.IP_POOL_DATA_PROPERTY],ipProtocol:t[e.IP_ALLOCATION_PROTOCOL_PROPERTY]}})},e.prototype.validatePage=function(){var e=!0;return this._vappPropertyDescriptors.forEach(function(t){if(!t.isValid)return void(e=!1)}),e?{}:{error:this.i18nService.getString("VmUi","VAppPropertiesProvisioningPage.errorMessage")}},e.prototype.submitPage=function(){return{wizardFlow:this.virtualMachineSpecBuilder.getCreationType(),invalidateNextPages:!1}},e.$inject=["i18nService","dataService"],e}();e.VmProvisioningVappPropertiesPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningVappPropertiesPageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.vmVuiWizardPageBuilder=t,this.vmProvisioningVappPropertiesPageModel=i}return e.prototype.build=function(e){var t=new this.vmProvisioningVappPropertiesPageModel(e.vmParams);return e.vappPropertiesPageModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("VmUi","VAppPropertiesProvisioningPage.title"),description:this.i18nService.getString("VmUi","VAppPropertiesProvisioningPage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vm-provisioning-vapp-properties-page.html",model:t})},e.$inject=["i18nService","vmVuiWizardPageBuilder","vmProvisioningVappPropertiesPageModel"],e}();e.VmProvisioningVappPropertiesPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningVappPropertiesPageService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d){return function(u,p){function v(){V.readyToView=!1,V.guestOsIsCustomizable=!0,V.datagridOptions={columnDefs:[{field:"name",displayName:i.getString("VmUi","CustomizeGuestOsProvisioningPage.content.name")},{field:"guestOs",displayName:i.getString("VmUi","CustomizeGuestOsProvisioningPage.content.type"),width:110},{field:"lastModified",searchable:!1,displayName:i.getString("VmUi","customizationManager.customizationSpecList.lastModifiedColumnHeader"),template:function(e){return s.timestampToText(parseInt(e.lastModified),E)}}],sortOrder:[{field:"name",dir:"asc"}],selectionMode:r.grid.selectionMode.SINGLE,searchable:!1,resizable:!0,height:"100%",selectedItems:[],data:[]
},s.getUserTimeFormatPreference().then(function(e){E=e}),u.getCreationType()===n.DEPLOY_VM_FROM_TEMPLATE||u.getCreationType()===n.DEPLOY_VM_FROM_VAPP?m():g()}function m(){var i,r;c.getAllServersInfo().then(function(n){var o=p.getSelectedTemplate(),s=b(o.gosType);p.setGuestOsType(s),V.guestOsName=o.gosDescription;var c=n.serversInfo;return c&&c.length>0&&(i=c[0],r=i?a.getVsphereObjectId(i.content.customizationSpecManager):null),r?t.getProperties(r,["customizationSpecListData"],{propertyParams:[{_type:"com.vmware.vise.mvc.model.data.ParamSpec",propertyName:"customizationSpecListData",parameterType:"java.lang.String",parameter:o.gosType}]}):e.reject({})}).then(function(t){if(!f(t.customizationSpecListData.compatibility))return e.resolve({});var i=h(t.customizationSpecListData.customizationSpecs);return e.all(_.map(i,function(e){return{name:e.name,guestOs:e.type,lastModified:e.lastUpdateTime}}))}).then(function(e){D(e),V.datagridOptions.data=e,V.readyToView=!0})}function g(){var t,i=p.getCustomizeGosSpecData();if(p.setCustomizeGosSpecData(),i){var r={error:d.validateData(i),data:i};t=e.when(r)}if(!t){var n=u.getVmId(),o=a.getRootFolderFromVsphereObjectId(u.getTargetInformation().datacenterUid);t=d.cloneCustomizeGosLoadData(n,!1,o)}t.then(function(e){V.readyToView=!0;var t=e.error;if(p.setGuestOsType(e.data.guestType),V.guestOsName=e.data.guestFullName,t)return V.guestOsIsCustomizable=!1,void(V.uncustomizableMessage=t);var i=_.map(e.data.relevantSpecs,function(e){return{name:e.name,guestOs:e.type,lastModified:e.lastUpdateTime}});return D(i),V.datagridOptions.data=i,V.readyToView=!0,{}})}function h(e){var t=p.getGuestOsType(),i=_.filter(e,function(e){return t===e.type});return i}function f(e){return e===o.MISSING_WINDOWS?(V.guestOsIsCustomizable=!1,V.uncustomizableMessage=i.getString("VmUi","CustomizationDataProvider.missing_windows"),!1):e===o.MISSING_LINUX?(V.guestOsIsCustomizable=!1,V.uncustomizableMessage=i.getString("VmUi","CustomizationDataProvider.missing_linux"),!1):e!==o.UNCUSTOMIZABLE||(V.guestOsIsCustomizable=!1,V.uncustomizableMessage=i.getString("VmUi","CustomizationDataProvider.cannot_customize"),!1)}function S(){if(!V.guestOsIsCustomizable)return w(),null;if(0===V.datagridOptions.data.length)return w(),null;if(!V.selectedSpec)return e.resolve({error:i.getString("VmUi","CustomizeGuestOsProvisioningPage.content.noSelection")});var t=u.getVmId();return I()&&(t="urn:vmomi:VirtualMachine:template:"+a.getPartsFromVsphereObjectId(p.getVCenterId()).serverGuid),V.setPageLoading(!0),l.validate(t,u.getName(),V.selectedSpec.name).then(function(e){p.setCustomizationSpecName(e.specName),p.setNICsToCustomize(e.nicsToCustomize),p.setNeedToInputComputerName(e.needsComputerName),u.setCustomizationSpec(e.spec),u.setCustomizationSpecInfo(e.info),u.setCustomizationSpecName(e.specName);var t=!T()&&(e.needsComputerName||e.needsAnyNICSettings);return V.showUserSettingsPage(t),!0},function(t){return e.resolve({error:t.error})}).then(function(e){return V.setPageLoading(!1),e})}function y(){return{wizardFlow:u.getCreationType(),invalidateNextPages:!1}}function P(){return V}function C(){return V.readyToView}function D(e){if(V.selectedSpec){var t=_.some(e,function(e){return V.selectedSpec.name===e.name});t||(V.selectedSpec=void 0)}}function w(){p.setCustomizationSpecName(),p.setNICsToCustomize(),p.setNeedToInputComputerName(),u.setCustomizationSpec(),u.setCustomizationSpecInfo(),V.showUserSettingsPage(!1)}function b(e){return e?0===e.indexOf("win")?o.TYPE_WINDOWS:o.TYPE_LINUX:o.TYPE_OTHER}function I(){return u.getCreationType()===n.DEPLOY_VM_FROM_TEMPLATE}function T(){return u.getCreationType()===n.DEPLOY_VM_FROM_VMTX}var E,V={};return{form:V,resetForm:v,validatePage:S,submitPage:y,getForm:P,pageFinishedLoading:C}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningCloneCustomizeGuestOsPageModel",e),e.$inject=["$q","dataService","i18nService","vuiConstants","creationTypeConstants","guestosCustomizationConstants","defaultUriSchemeUtil","timeFormatterService","userSessionService","guestOsCustomizationSpecValidator","customizeGosPreCheckSpecsService"]}(),function(){"use strict";function e(e,t,i,r){return{build:function(n){var o=n.vmParams,a=new r(o,n.wizardViewData);return n.vmProvisioningCloneCustomizeGuestOsPageModel=a,i.buildVuiWizardPage(n.config,{title:e.getString("VmUi","CustomizeGuestOsProvisioningPage.Title"),description:e.getString("VmUi","CustomizeGuestOsProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningCloneGuestOs.html",defaultState:t.wizard.pageState.SKIPPED,model:a})}}}angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningCloneCustomizeGuestOsPageService",e),e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","VmProvisioningCloneCustomizeGuestOsPageModel"]}(),function(){"use strict";function e(e,t,i,r){return{build:function(n){var o=new i(n.vmParams,n.wizardViewData,n.config),a=e.getString("VmUi","SelectCloneOptionsProvisioningPage.Title"),s=e.getString("VmUi","SelectCloneOptionsProvisioningPage.Description");return r.isDeployVmFromVmtxTemplate(n.vmParams.getCreationType())&&(a=e.getString("VmUi","SelectCloneOptionsProvisioningPage.DeployTitle"),s=e.getString("VmUi","SelectCloneOptionsProvisioningPage.DeployDescription")),n.cloneOptionsPageModel=o,t.buildVuiWizardPage(n.config,{title:a,description:s,contentUrl:"vm-ui/resources/vm/views/createVmWizard/vm-provisioning-clone-options-page.html",model:o})}}}angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningCloneOptionsPageService",e),e.$inject=["i18nService","vmVuiWizardPageBuilder","VmProvisioningCloneOptionsPageModel","creationTypeConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g){return function(h,f,S,y,P){function C(e){if(e&&e.result&&e.result.newContext){var i=e.result.newContext,r=h.getCustomizationSpec();return _.isEmpty(r)||(i=D(i)),S.setDeployFromLibraryCommonContext(i),S.setResourcePoolDeploymentResponse(e),e}p.hideLoadingIndicator(y);var n=B(e);return{error:n?n:t.getString("VmUi","SelectResourcePoolProvisioningPage.fatalError")}}function D(e){var t=[];return _.each(e,function(e){e._type!==Q&&e._type!==X&&t.push(e)}),t}function w(i){var r,o,a,s,c=W.selectedComputeResourceId;return"Datacenter"===n.getEntityType(c)?(j=!1,s=t.getString("VmUi","SelectResourcePoolProvisioningPage.SelectRPOnly"),e.when($([s]))):l.validateComputeResourceSelection(c).then(function(e){if(!O(i))return o=null;if(a=M(e),e.result){var t=N(e.result);j=R(t),o=U(t)}else j=!1,o=$([e.error.localizedMessage]);return j?l.getResourcePoolForComputeResource(c):o}).then(function(e){if(!j||!O(i))return o;if(e.resourcePool||T([t.getString("ProvisioningUiLib","SelectResourcePage.errorNoResourcePool")],[],[],a,m.NO_HOST_ID),e.resourcePool)return r=n.getVsphereObjectId(e.resourcePool),h.setResourcePool({id:r,resourcePoolMor:e.resourcePool}),z(r);var s=t.getString("ProvisioningUiLib","SelectResourcePage.errorNoResourcePool");return j=!1,o=$([s])}).then(function(e){if(!j||!O(i))return o;if(e[0]||T([t.getString("ProvisioningUiLib","SelectResourcePage.errorNoPrivilegeForH5")],[],[],a,m.NO_HOST_ID),e[0])return H(r);var n=t.getString("ProvisioningUiLib","SelectResourcePage.errorNoPrivilegeForH5");return j=!1,o=$([n])}).then(function(e){if(!j||!O(i))return o;if(e||T([t.getString("ProvisioningUiLib","SelectResourcePage.errorImportVAppDisabled")],[],[],a,m.NO_HOST_ID),e)return o;var r=t.getString("ProvisioningUiLib","SelectResourcePage.errorImportVAppDisabled");return j=!1,o=$([r])}).then(function(e){return V(e,a)})}function b(e){j=!1;var i=T();return a.validate(W.selectedComputeResourceId,h.getStorageObject(),h.getRegisterVmData().isTemplate).then(function(r){if(!O(e))return null;var n,o;if(r.error){var a=B(r);return n=a||t.getString("VmUi","SelectResourcePoolProvisioningPage.fatalError"),i=T([n],[],[]),o=$([n])}var s=r.result;if(s&&s.localizationKey){j=!1;var c=["VmUi",s.localizationKey].concat(s.localizationArgs);return n=t.getString.apply(null,c),i=T([n],[],[]),o=$([n])}return j=!0,L()}).then(function(e){return V(e,i)})}function I(e){var i,a;return a=h.getCreationType()===r.DEPLOY_VM_FROM_VMTX?h.getVmtxLibraryItemId():h.getVmId(),o.validateComputeResource(W.selectedComputeResourceId,h.getTargetInformation().folderUid,h.getCreationType(),h.getName(),a).then(function(o){if(!O(e))return null;if(i=M(o),_.isEmpty(o.result)&&!o.error){var a=t.getString("VmUi","SelectResourcePoolProvisioningPage.NoHostsFound"),s={};return s.topLevelMessages=[{type:"error",message:a}],i.hostMap[m.NO_HOST_ID].errors.push(a),U(s)}var c=N(o.result);j=R(c);var l=U(c);if(!j)return l;Z=G(o.result);var d=o.result[0].owner,p=d&&n.getVsphereObjectId(o.result[0].owner);h.setComputeResourceOwnerId(p);var v=n.getVsphereObjectId(o.result[0].resourcePool),g=o.result[0].rpRuntime,f=n.getVsphereObjectId(o.result[0].networkFilterObject);h.setResourcePool({id:v,runtime:g}),h.setFilterNetworksObjectId(f);var S=h.getCreationType();if(S===r.CREATE_FROM_SCRATCH){var y=n.getEntityType(W.selectedComputeResourceId);if(y===u.V_APP&&h.setIsResourcePoolInVapp(!0),y===u.RESOURCE_POOL){var P=o.result[0].isInVapp;h.setIsResourcePoolInVapp(P)}}return l}).then(function(e){return V(e,i)})}function T(e,t,i,r,n){return r||(r={hostMap:{},vmId:m.NO_VM_ID,vmProps:{name:m.NO_VM_NAME,icon:m.NO_VM_ICON}}),n||(n=m.NO_HOST_ID),e||(e=[]),t||(t=[]),i||(i=[]),r.hostMap[n]||(r.hostMap[n]={errors:[],warnings:[],infos:[],props:{icon:m.NO_HOST_ICON,name:m.NO_HOST_NAME}}),r.hostMap[n].errors=r.hostMap[n].errors.concat(e),r.hostMap[n].warnings=r.hostMap[n].warnings.concat(t),r.hostMap[n].infos=r.hostMap[n].infos.concat(i),r}function E(e){var t=Object.keys(e.hostMap);t=_.filter(t,function(e){return e!==m.NO_HOST_ID});var i=[];return e.vmId!==m.NO_VM_ID&&i.push(e.vmId),{hostIds:t,vmIds:i}}function V(e,t){if(!e||!t)return e;t.vmProps.name=h.getName();var i=E(t);return _.isEmpty(i.vmIds)&&_.isEmpty(i.hostIds)?(e[0].advancedCompatibilityContents=t,e):c.getPropertiesForObjects(i.hostIds,["primaryIconId","name"]).then(function(i){return _.each(i,function(e,i){t.hostMap[i].props.name=e.name,t.hostMap[i].props.icon=e.primaryIconId}),e[0].advancedCompatibilityContents=t,e})}function M(e){var t=T();if(e.error){var i=m.NO_HOST_ID;return e.entity&&e.entity.type===u.HOST&&(i=n.getVsphereObjectId(e.entity)),T([e.error.localizedMessage],[],[],t,i),t}return e.result?(_.each(e.result,function(e){var i=[],r=[],o=[],a=m.NO_HOST_ID;_.each(e.messages,function(e){"error"===e.type?i.push(e.message):"warning"===e.type?r.push(e.message):o.push(e.message)}),e.host&&e.host.type===u.HOST&&(a=n.getVsphereObjectId(e.host)),T(i,r,o,t,a)}),t):t}function O(e){return e===K}function A(){return h.getComputeResourceId()!==W.selectedComputeResourceId}function k(e){return!!_.isEmpty(e.hostSpecificMessagesByHostName)||(e.hostsWithNoMessagesCount>0||_.any(e.hostSpecificMessagesByHostName,function(e){return _.all(e,function(e){return"error"!==e.type})}))}function R(e){if(!e)return!0;var t=_.all(e.topLevelMessages,function(e){return"error"!==e.type});return t&&k(e)}function N(e){if(!e||0===e.length)return null;var t=_.filter(e,function(e){return e.host}),i=_.filter(e,function(e){return e.messages&&e.messages.length>0});if(i.length<1)return null;var r=_.partition(i,function(e){return e.host}),n=_.chain(r[0]).groupBy("hostName").mapObject(function(e){return _.flatten(_.pluck(e,"messages"))}).value(),o=_.flatten(_.pluck(r[1],"messages"));return{topLevelMessages:o,hostSpecificMessagesByHostName:n,hostsWithNoMessagesCount:t.length-r[0].length}}function U(e){if(e){var t=_.map(e.hostSpecificMessagesByHostName,function(e,t){return{icon:"vsphere-icon-host",message:t,contents:_.map(e,F)}}),i=_.map(e.topLevelMessages,F);return i.concat(t)}return L()}function L(){return[{icon:"vsphere-icon-status-ok",message:t.getString("VmUi","ProvisioningWizard.CompatibilityChecksSucceeded"),contents:[]}]}function F(e){return{icon:"error"===e.type?"vsphere-icon-status-error":"vsphere-icon-status-warning",message:e.message,contents:[]}}function x(t){var i=n.getPartsFromVsphereObjectId(t);if(i.type===u.CLUSTER)return e.resolve(t);var r;switch(i.type){case u.HOST:r="host";break;case u.RESOURCE_POOL:case u.V_APP:r="rp"}var o=c.getPropertiesByRelation(t,r,u.ANY_COMPUTE_RESOURCE,["host","@type"]);return o.then(function(e){if(!e||0===_.values(e).length)return null;var t=_.values(e)[0]["@type"];if(t===u.CLUSTER){var i;return _.each(e,function(e,t){i=t}),i}var r=_.values(e)[0].host[0],o=n.getVsphereObjectId(r);return o})}function $(e){return _.map(e,function(e){return{icon:"vsphere-icon-status-error",message:e,contents:[]}})}function z(e){var t=["VApp.Import"];return d.checkPrivileges(e,t).then(function(e){return e})}function H(e){return c.getProperties(e,["disabledMethod"]).then(function(e){return _.indexOf(e,"ImportVApp")===-1})}function B(e){if(e&&e.error&&!_.isEmpty(e.error.localizedMessage))return e.error.localizedMessage}function G(e){if(!e||0===e.length)return!1;var t=_.some(e,function(e){return e.hasDeviceFaults});return t}var j,W={compatibilityResultsCache:void 0,lastSelectedComputeResourceId:void 0,lastSelectedCreationType:void 0},Y=null,q=0,K=0,X="com.vmware.vcenter.ovf.IpAllocationParams",Q="com.vmware.vcenter.ovf.PropertyParams",Z=!1;return{form:W,resetForm:function(){var e=h.getComputeResourceId(),t=W.selectedComputeResourceId||e||f;W.selectedComputeResourceId=t;var i=this.getTreeRootReference();Y!==i&&(j=!1,Y=i)},validateSelection:function(){if(W.lastSelectedComputeResourceId&&W.lastSelectedComputeResourceId===W.selectedComputeResourceId&&W.compatibilityResultsCache&&W.lastSelectedCreationType&&W.lastSelectedCreationType===h.getCreationType())return e.resolve(W.compatibilityResultsCache);var t=h.getCreationType();W.lastSelectedCreationType=t,q++;var i,n=++K;return i=t===r.DEPLOY_VM_FROM_TEMPLATE||t===r.DEPLOY_VM_FROM_VAPP||t===r.DEPLOY_VM_FROM_OVF?w(n):r.isRegisterVm(t)?b(n):I(n),i.then(function(e){return q--,W.lastSelectedComputeResourceId=W.selectedComputeResourceId,W.compatibilityResultsCache=e,W.compatibilityResultsCache})},validatePage:function(){if(p.clearErrors(y),!j)return{error:t.getString("VmUi","SelectResourcePoolProvisioningPage.specifyValidDestination")};if(p.showLoadingIndicator(y),h.getCreationType()===r.DEPLOY_VM_FROM_TEMPLATE||h.getCreationType()===r.DEPLOY_VM_FROM_VAPP||h.getCreationType()===r.DEPLOY_VM_FROM_OVF){var e,n,o=W.selectedComputeResourceId,a=h.getTargetInformation().folderUid,s=h.getName(),c=i.SOURCE_TYPE_CONTENTLIB;h.getCreationType()===r.DEPLOY_VM_FROM_OVF?(c=S.getTemplateSourceType(),c===i.SOURCE_TYPE_PUSH?(n=S.getDeployOvfSession(),s=n.templateName):e=S.getUrlTemplate(),y.validationBanner.isCloseable=!1,y.currentPage.disableNext=function(){return _.some(y.validationBanner.messages,function(e){return e.type===g.validationBanner.type.ERROR})}):e=S.getSelectedTemplate().templateId;var d=l.getAndValidateResourcePool(o,a,s,e,c,n);return d.then(function(e){return C(e)})}return null},setIsValid:function(e){j=e},submitPage:function(){var i=h.getCreationType();const n=h.getScheduledData();if(r.isCloningToATemplate(i)||h.setCustomizeCloneHardware(Z),i===r.CLONE_VM_TO_VM&&P&&P.isScheduledTask){var o=y.pages;Z?p.markPageDisabled(o,t.getString("VmUi","CustomizeHardwareProvisioningPage.Title")):p.markPageSkipped(o,t.getString("VmUi","CustomizeHardwareProvisioningPage.Title"))}var a=A(),c=W.selectedComputeResourceId,l=W.selectedComputeResourceName;if(h.setComputeResourceId(c),h.setComputeResourceName(l),_.isEmpty(n)||n.computeResourceId!==c&&(n.useScheduledTaskData=!1),i!==r.DEPLOY_VM_FROM_TEMPLATE&&i!==r.DEPLOY_VM_FROM_VAPP&&i!==r.DEPLOY_VM_FROM_OVF&&!r.isRegisterVm(i))return e.resolve({wizardFlow:i,invalidateNextPages:a});var d={resPool:s.lookupResourcePoolForComputeResource(c),filterNetworks:x(c)};return e.all(d).then(function(e){return h.setResourcePool(e.resPool),h.setFilterNetworksObjectId(e.filterNetworks),{wizardFlow:i,invalidateNextPages:a}}).then(function(e){return p.hideLoadingIndicator(y),e})},getTreeRootReference:function(){return h.getTargetInformation().datacenterUid},getTreeType:function(){switch(h.getCreationType()){case r.CREATE_FROM_SCRATCH:case r.CLONE_TEMPLATE_TO_VM:case r.CLONE_AS_VMTEMPLATE_TO_LIBRARY:case r.CLONE_VM_TO_VM:case r.CONVERT_TEMPLATE_TO_VM:case r.DEPLOY_VM_FROM_VPP:case r.DEPLOY_VM_FROM_TEMPLATE:case r.CLONE_VM_TO_TEMPLATE:case r.CLONE_TEMPLATE_TO_TEMPLATE:case r.DEPLOY_VM_FROM_OVF:case r.DEPLOY_VM_FROM_VMTX:return e.resolve("DcHostsAndClustersTree");case r.REGISTER_VM:if(!h.getRegisterVmData().isTemplate)return e.resolve("DcHostsAndClustersTree");var t=h.getTargetInformation().datacenterUid;return v.is66VcOrLater(t).then(function(e){return e?"DcClusterHostAndRpTree":"DcClusterAndHostOnlyTree"});default:return e.resolve("DcClusterAndHostOnlyTree")}},validationFinishedLoading:function(){return 0===q}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningComputeResourcePageModel",e),e.$inject=["$q","i18nService","sourceTypeConstants","creationTypeConstants","defaultUriSchemeUtil","compatibilityCheckService","registerVmCompatibilityCheckService","resourcePoolLookupService","dataService","contentLibraryService","authorizationService","managedEntityConstants","wizardPageService","vcService","compatibilityResultsPresenter","vuiConstants"]}(),angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningComputeResourcePageService",["i18nService","VmProvisioningComputeResourcePageModel","vmVuiWizardPageBuilder",function(e,t,i){return{build:function(r,n){var o=new t(r.vmParams,n,r.wizardViewData,r.config,r.scheduleTaskData);return r.computeResourcePageModel=o,i.buildVuiWizardPage(r.config,{title:e.getString("VmUi","SelectResourcePoolProvisioningPage.Title"),description:e.getString("VmUi","SelectResourcePoolProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningComputeResource.html",model:o})}}}]),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningCustomizeHardwarePageModel",["i18nService","deviceTypeConstants",function(e,t){return function(i,r){var n,o={};return{getStackBlocksExpandedState:function(){return n!==i.getComputeResourceId()&&(n=i.getComputeResourceId(),o.stackBlocksExpandedState={cpu:!1,memory:!1,virtualDevices:[],other:!1,generalOptions:!1,vmrcOptions:!1,standbyOptions:!1,vmwareToolsOptions:!1,bootOptions:!1,vmAdvancedOptions:!1,vmHwNpiv:!1,encryptionOptions:!1}),o.stackBlocksExpandedState},validatePage:function(){if(!o.isHardwareValid)return{error:e.getString("VmUi","CustomizeHardwareProvisioningPage.PageValidationError")};if(r.getNICsToCustomize()){const n=i.getVirtualMachineDevices().devicesNotMarkedForRemovalOfType(t.ETHERNET);if(n.length<r.getNICsToCustomize().length)return{error:e.getString("VmUi","CustomizeHardwareProvisioningPage.PageValidationError.vmNicsLessThanGosSpecNics",r.getCustomizationSpecName())}}return{}},submitPage:function(){return{wizardFlow:i.getCreationType(),invalidateNextPages:!1}},setFormValidity:function(e){o.isHardwareValid=e}}}}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningCustomizeHardwarePageService",["i18nService","wizardPageService","vmVuiWizardPageBuilder","VmProvisioningCustomizeHardwarePageModel",function(e,t,i,r){return{build:function(t){var n=t.vmParams,o=new r(n,t.wizardViewData);return t.customizeHardwarePageModel=o,i.buildVuiWizardPage(t.config,{title:e.getString("VmUi","CustomizeHardwareProvisioningPage.Title"),description:e.getString("VmUi","CustomizeHardwareProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/settings/vmHardwareEdit.html",model:o})}}}])}();var h5_vm;!function(e){var t="com.vmware.vcenter.ovf.PropertyParams",i="com.vmware.vcenter.ovf.IpAllocationParams",r=function(){function e(e,t){return function(i,r){return new n(e,t,i,r)}}return e.$inject=["$q","i18nService"],e}(),n=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.virtualMachineSpecBuilderObj=i,this.wizardViewDataObj=r,this.formObj={customizeTemplateParams:void 0,ipAllocationPolicyParams:void 0,valid:!1}}return Object.defineProperty(e.prototype,"form",{get:function(){return this.formObj},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"customizeTemplateParams",{get:function(){return this.formObj.customizeTemplateParams=this.retrieveUserDefinedPropertyParams(),this.formObj.customizeTemplateParams},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ipAllocationPolicyParams",{get:function(){return this.formObj.ipAllocationPolicyParams=this.retrieveIpAllocationPolicyParams(),this.formObj.ipAllocationPolicyParams},enumerable:!0,configurable:!0}),e.prototype.validatePage=function(){return this.formObj.valid?{}:{error:this.i18nService.getString("ProvisioningUiLib","UserDefinedPropertiesPage.errorMessage2")}},e.prototype.submitPage=function(){return this.wizardViewDataObj.setCustomizeTemplateCommonContext(this.formObj.customizeTemplateParams),{wizardFlow:this.virtualMachineSpecBuilderObj.getCreationType(),invalidateNextPages:!1}},e.prototype.retrieveUserDefinedPropertyParams=function(){return _.find(this.wizardViewDataObj.getDeployFromLibraryCommonContext(),function(e){return _.isEqual(e._type,t)})},e.prototype.retrieveIpAllocationPolicyParams=function(){return _.find(this.wizardViewDataObj.getDeployFromLibraryCommonContext(),function(e){return _.isEqual(e._type,i)})},e.prototype.resetForm=function(){this.formObj.customizeTemplateParams=void 0,this.formObj.valid=!1},e.$inject=["$q","i18nService"],e}();e.VmProvisioningCustomizeTemplatePageModel=n,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningCustomizeTemplatePageModel",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.vmVuiWizardPageBuilder=i,this.vmProvisioningCustomizeTemplatePageModel=r}return e.prototype.build=function(e){var t=new this.vmProvisioningCustomizeTemplatePageModel(e.vmParams,e.wizardViewData);return e.vmProvisioningCustomizeTemplatePageModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("Common","UserDefinedPropertiesPage.title"),description:this.i18nService.getString("Common","UserDefinedPropertiesPage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningCustomizeTemplate/vm-provisioning-customize-template.html",model:t,defaultState:this.vuiConstants.wizard.pageState.SKIPPED})},e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","vmProvisioningCustomizeTemplatePageModel"],e}();e.VmProvisioningCustomizeTemplatePageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningCustomizeTemplatePageService",t)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.RelocateSpec$DiskLocator,i=com.vmware.vim.binding.vmodl.ManagedObjectReference,r=function(){function e(e,t,i,r,o,a,s,c,l,d,u,p,v,m,g,h,f,S){return function(y,P,C,D){return new n(e,t,i,r,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D)}}return e.$inject=["defaultUriSchemeUtil","dataService","i18nService","$q","creationTypeConstants","storageResourceSelectionValidationService","storageLocatorService","storageProfileService","managedEntityConstants","contentLibraryService","wizardPageService","VirtualMachineDevices","diskFormatService","vmProvisioningStorageSelectionValidationService","diskProvisioningService","spbmReplicationGroupInfoService","pmemUtilService","virtualDiskPmemService"],e}();e.VmProvisioningDatastorePageModelFactory=r;var n=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C){this.defaultUriSchemeUtil=e,this.dataService=t,this.i18nService=i,this.$q=r,this.creationTypeConstants=n,this.storageResourceSelectionValidationService=o,this.storageLocatorService=a,this.storageProfileService=s,this.managedEntityConstants=c,this.contentLibraryService=l,this.wizardPageService=d,this.VirtualMachineDevices=u,this.diskFormatService=p,this.storageValidationService=v,this.diskProvisioningService=m,this.spbmReplicationGroupInfoService=g,this.pmemUtilService=h,this.virtualDiskPmemService=f,this._selectionIsValid=!1,this._pendingValidationRequests=0,this._DATASTORE_MAPPING_PARAMS_TYPE="com.vmware.vcenter.ovf.DatastoreMappingParams",this.DEFAULT_STORAGE_ID="defaultId",this.USE_SPECIFIED_STORAGE_POLICY="USE_SPECIFIED_POLICY",this.form={drsDisabled:!1,storageLocatorItemsData:{},vmDisksData:{},vmsHomeDatastore:{},diskFormatSettings:{diskFormatSupported:!1,selectedDiskFormat:null},selectedStorage:null,storageProfilesData:{storageProfiles:[],selectedProfile:null,selectedProfileForDisks:null},selectedReplicationGroupInfo:null,storageProfileHasBeenSelected:!1,isAdvancedStorageMode:!1,storageSelectorState:null,vmDisksStorage:null,basicModeLastSelectionIsValid:!1,basicModeLastSelectedStorageId:void 0,basicModeLastSelectedProfileId:void 0,basicModeLastVmValidationConfig:void 0,basicModeCompatibilityResultsCache:void 0,advModeLastSelectionIsValid:!1,advModeLastFolderId:void 0,advModeLastValidationModel:void 0,advModeCompatibilityResultsCache:void 0,_vmStorageConfig:void 0,set vmStorageConfig(e){this._vmStorageConfig=e;var t=this._vmStorageConfig[0];this.storageProfilesData.selectedProfile=t.vmHome.storageProfile,this.storageProfilesData.selectedProfileForDisks=_.isEmpty(t.vmDisks)?null:t.vmDisks[0].storageProfile,this.selectedStorage=t.vmHome.storageObj,this.selectedReplicationGroupInfo=t.vmHome.replicationGroup},get vmStorageConfig(){throw Error("You should not access vmStorageConfig directly")}},this._virtualMachineSpecBuilder=S,this._wizardViewData=y,this._preselectedStorage=P,this._wizardConfig=C}return Object.defineProperty(e.prototype,"virtualMachineSpecBuilder",{get:function(){return this._virtualMachineSpecBuilder},enumerable:!0,configurable:!0}),e.prototype.podDisplayDisabled=function(){return!(!this.isCloningVmtxTemplate()&&!this.isDeployVmFromVmtxTemplate())||this._virtualMachineSpecBuilder.isXvc()},e.prototype.setSelectionIsValid=function(e){this._selectionIsValid=e},e.prototype.getStorageLocatorData=function(e){var t=this;return this.storageLocatorService.getProvisioningStorageLocatorData(e).then(function(e){function i(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:1}if(!e)return!1;var r=t.createStorageIdToNameMap(e.datastoreItems,e.storagePodItems);return t._wizardViewData.setStorageNameMap(r),e.datastoreItems.sort(i),e.storagePodItems.sort(i),t._wizardViewData.setStorageLocatorItemsData(e),t.form.storageLocatorItemsData=e,!0})},e.prototype.getStorageSelectorData=function(e){var t=this;return this._virtualMachineSpecBuilder.getAdvancedStoragePageData().then(function(i){var r={};if(i.advancedStoragePageData){var n=i.advancedStoragePageData;r={vmReplicationGroupAssignments:n.vmReplicationGroupAssignments,storagePoliciesAssignments:n.storagePoliciesAssignments},t.setVmDisks(e,n.virtualDisks),t.setVmHomeDatastore(e,n.vmHomeDatastore)}return r.virtualDisks=t.form.vmDisksData,r.vmHomeDatastore=t.form.vmsHomeDatastore,r})},e.prototype.getVmIds=function(){return[this._virtualMachineSpecBuilder.getVmId()]},e.prototype.getVmNames=function(){var e={};return e[this._virtualMachineSpecBuilder.getVmId()]=this._wizardViewData.getSourceObjectName(),e},e.prototype.getProfilesData=function(e){var t=this;if(this._profilesDataPromise&&this._profilesDataPromise.cacheId===e)return this._profilesDataPromise.promise;var i={};return this._virtualMachineSpecBuilder.getVmId()&&(i={vmId:this._virtualMachineSpecBuilder.getVmId()}),this.isInCloningMode()&&!this._virtualMachineSpecBuilder.isXvc()&&(i.includeKeepExisting=!0),this._profilesDataPromise={promise:this.virtualMachineSpecBuilder.getStoragePageData().then(function(e){return e.vmStoragePageData?e.vmStoragePageData.profileError?t.storageProfileService.buildErrorStorageProfilesData(e.vmStoragePageData.profileError):e.vmStoragePageData.hasProfileViewPrivilege===!1?t.storageProfileService.buildErrorStorageProfilesData(t.i18nService.getString("Common","storage.policy.dropdown.no.permissions")):t.storageProfileService.buildStorageProfilesData(e.vmStoragePageData.profileStoragePageData,i):t.storageProfileService.buildErrorStorageProfilesData(t.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.profilesDataError"))}).then(function(e){var i=null;return t.form.storageProfilesData&&t.form.storageProfilesData.selectedProfile&&(i=t.form.storageProfilesData.selectedProfile),t.form.storageProfilesData=e,i&&(t.form.storageProfilesData.selectedProfile=i),e})["catch"](function(){}),cacheId:e},this._profilesDataPromise.promise},e.prototype.setVmDisks=function(e,t){this.form.vmDisksData=this.form.vmDisksData||{},this.form.vmDisksData[e]=t},e.prototype.setVmHomeDatastore=function(e,t){this.form.vmsHomeDatastore=this.form.vmsHomeDatastore||{},this.form.vmsHomeDatastore[e]=t?this.defaultUriSchemeUtil.getVsphereObjectId(t):null},e.prototype.validateSelection=function(e,t,i,r,n){var o=this;if(this.isInDeployTemplateMode()&&this.canDeployOvfViaDrs(e,t))return this._selectionIsValid=!0,this.$q.resolve([this.newSuccessfulStorageCheck()]);var a=e?this.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef):void 0;if(!a||r){this._selectionIsValid=!1;var s=a?r:this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpecifyValidLocation");return this.$q.resolve([{contents:[],icon:"vsphere-icon-status-error",message:s,advancedCompatibilityContents:{}}])}this.form.selectedStorage=e;var c=this.getVirtualDisksByVmSelections([n]),l=this.getVmStorageValidationConfig();if(i&&i.selectedDiskFormat&&this.form.vmDisksData&&this.form.vmDisksData[l.vmId]){var d=this.form.vmDisksData[l.vmId],u=this.virtualDiskPmemService.filterVirtualDisksToDiskLocatorsForPmem(d,this.form.storageSelectorState.storageBaselineId);l.disks=this.buildDiskLocators(u,c,l.vmStorageConf.vmHome.storageObj.storageRef,i,t,this.form.selectedReplicationGroupInfo)}return this.form.basicModeLastSelectedStorageId===a&&this.form.basicModeLastSelectedProfileId===t&&angular.equals(this.form.basicModeLastVmValidationConfig,l)&&this.form.basicModeCompatibilityResultsCache?(this._selectionIsValid=this.form.basicModeLastSelectionIsValid,this.$q.resolve(this.form.basicModeCompatibilityResultsCache)):(this._pendingValidationRequests++,this.storageResourceSelectionValidationService.validateSelection(e,t,l,this.isInDeployTemplateMode()).then(function(e){return o._selectionIsValid=e.isValid,o._selectionIsValid&&o._virtualMachineSpecBuilder.setVmDisksStorage(c),o._pendingValidationRequests--,o.form.basicModeLastSelectionIsValid=o._selectionIsValid,o.form.basicModeLastSelectedStorageId=a,o.form.basicModeLastSelectedProfileId=t,o.form.basicModeLastVmValidationConfig=l,o.form.basicModeCompatibilityResultsCache=e.messages,o.form.basicModeCompatibilityResultsCache}))},e.prototype.validateAdvancedSelection=function(e,t){var i=this;if(!this.isAdvModeDiskSelectionCompleted())return this._selectionIsValid=!1,this.form.vmDisksStorage={},this.$q.resolve([{contents:[],icon:"vsphere-icon-status-error",message:this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpecifyValidLocation"),advancedCompatibilityContents:{}}]);this.form.selectedStorage=e;var r=this.form.storageSelectorState.vmStorageConfigInAdvancedMode[0];if(!this.storageValidationService.validateDisksSdrsMap(r))return this._selectionIsValid=!1,this.form.vmDisksStorage={},this.$q.resolve([{contents:[],icon:"vsphere-icon-status-error",message:this.i18nService.getString("VmUi","sdrsInconsistentSelectionErrorMsg"),advancedCompatibilityContents:{}}]);var n=this.spbmReplicationGroupInfoService.validateVmReplicationGroupAssignments(r.getReplicationGroupAssignments());if(n)return this._selectionIsValid=!1,this.form.vmDisksStorage={},
this.$q.resolve([{contents:[],icon:"vsphere-icon-status-error",message:n,advancedCompatibilityContents:{}}]);var o=this.virtualMachineSpecBuilder.getVmId(),a=this.virtualMachineSpecBuilder.getResourcePool()&&this.virtualMachineSpecBuilder.getResourcePool().id,s=this.virtualMachineSpecBuilder.getTargetInformation()&&this.virtualMachineSpecBuilder.getTargetInformation().folderUid,c=this.virtualMachineSpecBuilder.getComputeResourceId(),l=this.getVirtualDisksByVmSelections([t]),d={vms:[o]};if(d.virtualDisksByVm=l,d.computeResource=c,d.pool=a,this.form.advModeLastFolderId===s&&angular.equals(this.form.advModeLastValidationModel,d))return this._selectionIsValid=this.form.advModeLastSelectionIsValid,this.$q.resolve(this.form.advModeCompatibilityResultsCache);var u=this.storageValidationService.buildVmCloneSpec(this.defaultUriSchemeUtil.getManagedObjectReference(s),this.virtualMachineSpecBuilder.getName(),this.defaultUriSchemeUtil.getManagedObjectReference(o),this.defaultUriSchemeUtil.getManagedObjectReference(a),this.defaultUriSchemeUtil.getManagedObjectReference(c),t),p=this.form.vmDisksData[o];return this.storageValidationService.validateSelection(d,u,o,s,t,p,this.isCloningVmtxTemplate()||this.isDeployVmFromVmtxTemplate()).then(function(e){return i._selectionIsValid=e.hasSuccess,i.form.vmDisksStorage=i._selectionIsValid?l:{},i.form.advModeLastSelectionIsValid=i._selectionIsValid,i.form.advModeLastFolderId=s,i.form.advModeLastValidationModel=d,i.form.advModeCompatibilityResultsCache=e.compatibilityMessages,i.form.advModeCompatibilityResultsCache})},e.prototype.getVirtualDisksByVmSelections=function(e){var t=this,i={};return _.each(e,function(e){var r=e.vmId;i[r]||(i[r]=[]);var n=e.vmHome;n.storageObj&&(i[r].push({key:"_configFile",label:n.name,storage:t.defaultUriSchemeUtil.getVsphereObjectId(n.storageObj.storageRef),parentStoragePod:t.defaultUriSchemeUtil.getVsphereObjectId(n.storageObj.parentStoragePod),profile:n.storageProfile,diskFormat:n.diskFormat?{label:n.diskFormat.name,value:n.diskFormat.type}:void 0,replicationGroup:n.replicationGroup}),_.each(e.vmDisks,function(e){i[r].push({key:e.key,label:e.name,storage:e.storageObj?t.defaultUriSchemeUtil.getVsphereObjectId(e.storageObj.storageRef):void 0,parentStoragePod:e.storageObj?t.defaultUriSchemeUtil.getVsphereObjectId(e.storageObj.parentStoragePod):void 0,profile:e.storageProfile,diskFormat:e.diskFormat?{label:e.diskFormat.name,value:e.diskFormat.type}:void 0,replicationGroup:e.replicationGroup})}))}),i},e.prototype.validatePage=function(){if(this.wizardPageService.showLoadingIndicator(this._wizardConfig),!this._selectionIsValid){var e=this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpecifyValidLocation");return this.wizardPageService.hideLoadingIndicator(this._wizardConfig),{error:e,invalidateNextPages:!this._selectionIsValid,wizardFlow:this.virtualMachineSpecBuilder.getCreationType()}}return this.isInDeployFromTemplateMode()?this.validatePageInDeployFromTemplateMode():null},e.prototype.getServerGuid=function(){return this.defaultUriSchemeUtil.getManagedObjectReference(this._virtualMachineSpecBuilder.getComputeResourceId()).serverGuid},e.prototype.getComputeResourceId=function(){return this._virtualMachineSpecBuilder.getComputeResourceId()},e.prototype.setComputeResourceId=function(e){return this._virtualMachineSpecBuilder.setComputeResourceId(e)},e.prototype.getComputeResourceOwnerId=function(){return this._virtualMachineSpecBuilder.getComputeResourceOwnerId()},e.prototype.isCloningVmtxTemplate=function(){return this.creationTypeConstants.isCloningVmToLibrary(this._virtualMachineSpecBuilder.getCreationType())},e.prototype.isDeployVmFromVmtxTemplate=function(){return this.creationTypeConstants.isDeployVmFromVmtxTemplate(this._virtualMachineSpecBuilder.getCreationType())},e.prototype.pageFinishedLoading=function(){return this.form.storageProfilesData.selectedProfile},e.prototype.isInCloningMode=function(){return this.creationTypeConstants.isCloning(this._virtualMachineSpecBuilder.getCreationType())},e.prototype.isInDeployFromTemplateMode=function(){return this.isInDeployTemplateMode()},e.prototype.isInDeployVmFromOvf=function(){return this._virtualMachineSpecBuilder.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_OVF},e.prototype.submitPage=function(){if(this.isCloningVmtxTemplate())return this.wizardPageService.hideLoadingIndicator(this._wizardConfig),{};this.isDeployVmFromVmtxTemplate()&&(this.form.isAdvancedStorageMode?this._virtualMachineSpecBuilder.setVmtxStorageSpecSettings(this.getAdvancedStorageSpec()):this._virtualMachineSpecBuilder.setVmtxStorageSpecSettings(this.getSimpleStorageSpec()));var e=this._virtualMachineSpecBuilder.getIsAdvancedStorageMode();return this._wizardViewData.setStorageProfiles(this.form.storageProfilesData.storageProfiles),this.form.isAdvancedStorageMode?this.submitInAdvancedStorageMode(e):this.submitInBasicStorageMode(e)},e.prototype.validationFinishedLoading=function(){return 0===this._pendingValidationRequests},e.prototype.isInDeployTemplateMode=function(){return this._virtualMachineSpecBuilder.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_TEMPLATE||this._virtualMachineSpecBuilder.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_VAPP||this._virtualMachineSpecBuilder.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_OVF},e.prototype.createStorageIdToNameMap=function(e,t){var i=this,r={};return _.forEach(e,function(e){var t=i.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef);r[t]=e.name}),_.forEach(t,function(e){var t=i.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef);r[t]=e.name}),r},e.prototype.getItemToSelect=function(e,t){var i=this;if(this._preselectedStorage){var r=this.defaultUriSchemeUtil.getEntityType(this._preselectedStorage),n=r===this.managedEntityConstants.STORAGE_POD?t:e;return _.find(n,function(e){var t=i.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef);return t===i._preselectedStorage})}return null},e.prototype.getProfileToSelect=function(){return this.isInCloningMode()?null:this.form.storageProfilesData.selectedProfile},e.prototype.updateDiskFormatIfVSAN=function(){var e=this;if(this.isInDeployTemplateMode()){var t=this._wizardViewData.getDeployFromLibraryCommonContext(),i=_.find(t,function(t){return t._type===e._DATASTORE_MAPPING_PARAMS_TYPE});if(i){var r=i.targetProvisioningType;r&&r.name===this.diskFormatService.diskFormats.asDefinedInProfile.type&&(i.targetProvisioningType=null),_.each(i.diskGroups,function(t){var i=t.targetProvisioningType;i&&i.name===e.diskFormatService.diskFormats.asDefinedInProfile.type&&(t.targetProvisioningType=null)})}}},e.prototype.validatePageInDeployFromTemplateMode=function(){var e=this,t=this.contentLibraryService.validateStorageSelection(this._virtualMachineSpecBuilder.getComputeResourceId(),this.buildDiskGroups(),this._wizardViewData.getDeployFromLibraryCommonContext());return t.then(function(t){return t.result&&t.result.commonContext?(e._wizardViewData.setDeployFromLibraryCommonContext(t.result.commonContext),null):(e.wizardPageService.hideLoadingIndicator(e._wizardConfig),{error:t.error?t.error.localizedMessage:e.i18nService.getString("VmUi","SelectResourcePoolProvisioningPage.fatalError"),invalidateNextPages:!e._selectionIsValid,wizardFlow:e._virtualMachineSpecBuilder.getCreationType()})})},e.prototype.buildDiskGroups=function(){var e=this,t=this.form.selectedStorage?this.form.selectedStorage.storageRef:void 0,i=_.map(this.form._vmStorageConfig[0].vmDisks,function(i,r){var n={id:i.key,name:i.name,targetProfile:e.storageProfileService.isDefaultStorageProfile(i.storageProfile)?"":i.storageProfile.id,targetDatastore:i.storageObj?e.defaultUriSchemeUtil.getVsphereObjectId(i.storageObj.storageRef):void 0,targetProvisioningType:i.diskFormat?i.diskFormat.type:void 0};return n.targetDatastore||i.key!==e.contentLibraryService.SYSTEM_DISK_GROUP_ID||(n.targetDatastore=e.defaultUriSchemeUtil.getVsphereObjectId(t),e.pmemUtilService.isPMemStoragePolicy(i.storageProfile)&&(n.targetProfile="")),n});return i},e.prototype.submitInBasicStorageMode=function(e){var t=this,i=this._virtualMachineSpecBuilder.getVmId(),r=this._virtualMachineSpecBuilder.getStorageObject(),n=this._virtualMachineSpecBuilder.getSelectedStorageProfile(),o=!this._selectionIsValid||e||r&&r.storageRef.value!==this.form.selectedStorage.storageRef.value||n&&n.id!==this.form.storageProfilesData.selectedProfile.id;this._virtualMachineSpecBuilder.setSelectedStorageProfile(this.form.storageProfilesData.selectedProfile),this._virtualMachineSpecBuilder.setSelectedStorageProfileForDisks(this.form.storageProfilesData.selectedProfileForDisks),this._virtualMachineSpecBuilder.setSelectedReplicationGroupInfo(this.form.selectedReplicationGroupInfo),this._virtualMachineSpecBuilder.setIsAdvancedStorageMode(!1);var a=void 0;return this.form.diskFormatSettings.diskFormatSupported?(a=this.form.diskFormatSettings.selectedDiskFormat,this._wizardViewData.setDiskFormatLabel(a?a.name:""),this._virtualMachineSpecBuilder.setStorageObjectAndDiskFormat(this.form.selectedStorage,a),this.updateDiskFormatIfVSAN()):this._virtualMachineSpecBuilder.setStorageObject(this.form.selectedStorage),this._virtualMachineSpecBuilder.setDisableSdrs(this.form.drsDisabled),!this._virtualMachineSpecBuilder.storageObjectIsPod()&&this.form.selectedStorage&&this._wizardViewData.setDatastoreObjectName(this.form.selectedStorage.name),this.wizardPageService.hideLoadingIndicator(this._wizardConfig),_.each(this.form.vmDisksData[i],function(e){var i=angular.copy(e);a&&a.type!==t.diskProvisioningService.SAME_AS_SOURCE.type?i.backing=t.diskProvisioningService.getBackingInfo(a.type):i.backing=null,t._virtualMachineSpecBuilder.setStorageForDisk(t.form.selectedStorage,i)}),e&&(this._virtualMachineSpecBuilder.setVirtualMachineDevices(null),this._virtualMachineSpecBuilder.setRecreateVm(!0)),{invalidateNextPages:o,wizardFlow:this._virtualMachineSpecBuilder.getCreationType()}},e.prototype.submitInAdvancedStorageMode=function(e){var t=this,i=this._virtualMachineSpecBuilder.getVmId(),r=this._virtualMachineSpecBuilder.getVmDisksStorage(),n=!this._selectionIsValid||!e||!_.isEqual(this.form.vmDisksStorage,r);this._virtualMachineSpecBuilder.setIsAdvancedStorageMode(!0),this._virtualMachineSpecBuilder.setSelectedStorageProfile(this.form.storageProfilesData.selectedProfile),this._virtualMachineSpecBuilder.setSelectedStorageProfileForDisks(this.form.storageProfilesData.selectedProfileForDisks),this._virtualMachineSpecBuilder.setSelectedReplicationGroupInfo(this.form.selectedReplicationGroupInfo);var o=this.form.diskFormatSettings;if(o.diskFormatSupported&&o.selectedDiskFormat?(this._wizardViewData.setDiskFormatLabel(this.form.diskFormatSettings.selectedDiskFormat.name),this._virtualMachineSpecBuilder.setStorageObjectAndDiskFormat(this.form.selectedStorage,this.form.diskFormatSettings.selectedDiskFormat),this.updateDiskFormatIfVSAN()):this._virtualMachineSpecBuilder.setStorageObject(this.form.selectedStorage),this._virtualMachineSpecBuilder.setVmDisksStorage(this.form.vmDisksStorage),!n&&this._storageSelectorStateAdvancedModeBackup){var a=this._storageSelectorStateAdvancedModeBackup.vmStorageConfigInAdvancedMode[0].vmHome.storageProfile,s=this._virtualMachineSpecBuilder.getStorageSelectorState().vmStorageConfigInAdvancedMode[0].vmHome.storageProfile;n=a.id!==s.id}if(!this._virtualMachineSpecBuilder.getVirtualMachineDevices()){var c=new this.VirtualMachineDevices(this.form.vmDisksData[i],null,null,null,null);this._virtualMachineSpecBuilder.setVirtualMachineDevices(c)}return _.each(this.form.vmDisksData[i],function(e,i){var r=t.form.storageSelectorState.vmStorageConfigInAdvancedMode[0].vmDisks[i],o=angular.copy(e);if(r.diskFormat&&r.diskFormat.type!==t.diskProvisioningService.SAME_AS_SOURCE.type?o.backing=t.diskProvisioningService.getBackingInfo(r.diskFormat.type):o.backing=null,t._virtualMachineSpecBuilder.setStorageForDisk(t.form.storageSelectorState.vmStorageConfigInAdvancedMode[0].vmDisks[i].storageObj,o),!n&&t._storageSelectorStateAdvancedModeBackup){var a=t._storageSelectorStateAdvancedModeBackup.vmStorageConfigInAdvancedMode[0].vmDisks[i].storageProfile,s=t._virtualMachineSpecBuilder.getStorageSelectorState().vmStorageConfigInAdvancedMode[0].vmDisks[i].storageProfile;n=a.id!==s.id}}),this._storageSelectorStateAdvancedModeBackup=this.form.storageSelectorState,this.wizardPageService.hideLoadingIndicator(this._wizardConfig),{invalidateNextPages:n,wizardFlow:this._virtualMachineSpecBuilder.getCreationType()}},e.prototype.getVmStorageValidationConfig=function(){return{computeResourceId:this._virtualMachineSpecBuilder.getComputeResourceId(),targetFolderUid:this._virtualMachineSpecBuilder.getTargetInformation()&&this._virtualMachineSpecBuilder.getTargetInformation().folderUid,creationType:this._virtualMachineSpecBuilder.getCreationType(),name:this._virtualMachineSpecBuilder.getName(),vmId:this._virtualMachineSpecBuilder.getVmId(),resPoolId:this._virtualMachineSpecBuilder.getResourcePool()&&this._virtualMachineSpecBuilder.getResourcePool().id,vmDisks:this.form.vmDisksData[this._virtualMachineSpecBuilder.getVmId()],vmStorageConf:{vmHome:{storageObj:this.form.selectedStorage,storageProfile:this.form.storageProfilesData.selectedProfile}}}},e.prototype.isAdvModeDiskSelectionCompleted=function(){var e=this,t=this.form.storageSelectorState.vmStorageConfigInAdvancedMode[0];return t.vmHome.storageObj&&!_.any(t.vmDisks,function(t){return!t.storageObj&&!e.pmemUtilService.isPMemStoragePolicy(t.storageProfile)})},e.prototype.requestVmDisksInDeployFromTemplateMode=function(){var e=this,t=this.getDatastoreMappingParams();if(t){var i=_.map(t.diskGroups,function(t){return{key:t.id,backing:{datastore:e.getVsphereDatastoreId(t.targetDatastore)},deviceInfo:{label:t.name},capacityInBytes:0,capacityInKB:0,$profileId:_.isEmpty(t.targetProfile)?void 0:t.targetProfile}});return i.unshift({key:this.contentLibraryService.SYSTEM_DISK_GROUP_ID,backing:{datastore:this.getVsphereDatastoreId(t.targetDatastore)},deviceInfo:{label:this.contentLibraryService.SYSTEM_DISK_GROUP_LABEL},capacityInBytes:0,capacityInKB:0,$profileId:_.isEmpty(t.targetProfile)?void 0:t.targetProfile}),{undefined:i}}},e.prototype.requestVmHomeDatastoresInDeployFromTemplateMode=function(){var e=this.getDatastoreMappingParams();if(e)return{undefined:this.getVsphereDatastoreId(e.targetDatastore)}},e.prototype.isDiskGroupsAvailable=function(){return this.getDatastoreMappingParams()&&this.getDatastoreMappingParams().diskGroups&&this.getDatastoreMappingParams().diskGroups.length>0},e.prototype.getRecommendedDatastoresForTemplateDeployment=function(){var t=this.getDatastoreMappingParams();if(!t||!t.availableDatastores)return this.form.storageLocatorItemsData.datastoreItems;var i=t.availableDatastores,r=this.form.storageLocatorItemsData.datastoreItems,n=e.filterDatastores(r,i);return n},e.prototype.getRecommendedProfilesForTemplateDeployment=function(e){var t=this.getDatastoreMappingParams();return t&&t.availableStorageProfiles&&e?(t&&t.availableStorageProfiles&&!this.isDefaultStorageProfilePresentInList(t.availableStorageProfiles)&&t.availableStorageProfiles.splice(0,0,this.storageProfileService.getDefaultProfile()),e.filter(function(e){return t.availableStorageProfiles.some(function(t){return e.id===t.id})})):e},e.prototype.isDefaultStorageProfilePresentInList=function(e){var t=this;return e&&e.indexOf(function(e){return e.id===t.storageProfileService.getDefaultProfile().id})>-1},e.prototype.getVsphereDatastoreId=function(e){if(e){var t=e.split(":");if(!(t.length<2))return this.defaultUriSchemeUtil.getVsphereObjectId({type:"Datastore",value:t[0],serverGuid:t[1]})}},e.prototype.getDatastoreMappingParams=function(){var e=this,t=this._wizardViewData.getDeployFromLibraryCommonContext();return _.find(t,function(t){return t._type===e._DATASTORE_MAPPING_PARAMS_TYPE})},e.prototype.getAdvancedStorageSpec=function(){for(var e=this.form.storageSelectorState.vmStorageConfigInAdvancedMode[0],t=this.getStorageSpecFromVmStorageComponent(e.vmHome),i={},r=0;r<e.vmDisks.length;r++){var n=e.vmDisks[r];i[n.key]=this.getStorageSpecFromVmStorageComponent(n)}return{vmHomeStorage:t,diskStorageOverrides:i}},e.prototype.getSimpleStorageSpec=function(){var e=this.form.selectedStorage.storageRef,t=this.defaultUriSchemeUtil.createVmomiUri(e.type,e.value,e.serverGuid),i="";this.form.storageProfilesData.selectedProfileForDisks&&(i=this.form.storageProfilesData.selectedProfileForDisks.id);var r=""===i||!i||i===this.DEFAULT_STORAGE_ID,n={datastore:t,storagePolicy:r?null:{type:this.USE_SPECIFIED_STORAGE_POLICY,policy:i}};return{vmHomeStorage:n,diskStorage:n}},e.prototype.getStorageSpecFromVmStorageComponent=function(e){var t=e.storageObj.storageRef,i=this.defaultUriSchemeUtil.createVmomiUri(t.type,t.value,t.serverGuid),r=e.storageProfile,n=r&&r.id,o=n===this.DEFAULT_STORAGE_ID;return n&&""!==n||(o=!0),{datastore:i,storagePolicy:o?null:{type:this.USE_SPECIFIED_STORAGE_POLICY,policy:n}}},e.prototype.buildDiskLocators=function(e,i,r,n,o,a){var s=this,c=this.virtualMachineSpecBuilder.getVmId(),l=i[c],d=_.map(e,function(e){var i=_.find(l,function(t){return t.key===e.key}),c=new t;if(c.diskId=e.key,i){c.datastore=s.defaultUriSchemeUtil.getManagedObjectReference(i.storage),c.diskBackingInfo=i.diskFormat.value===s.diskProvisioningService.SAME_AS_SOURCE.type?null:s.diskProvisioningService.getBackingInfo(n.selectedDiskFormat.value);var d=i.profile;return c.profile=[s.storageProfileService.makeProfile(d&&d.id,i.replicationGroup)],c}return c.datastore=r,c.diskBackingInfo=n.selectedDiskFormat.type===s.diskProvisioningService.SAME_AS_SOURCE.type?null:s.diskProvisioningService.getBackingInfo(n.selectedDiskFormat.type),c.profile=[s.storageProfileService.makeProfile(o,a)],c});return d},e.filterDatastores=function(e,t){var r=(function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(i),t),n=function(e,t){var i=e.id,r=":",n=t.value+r+t.serverGuid;return i===n},o=function(e){var t="pmem";if(!e)return!1;var i=e.type;return!!i&&i.toLowerCase()===t},a=function(e,t){if(!e)return!1;var i=e.storageRef,r=t.some(function(e){return n(e,i)});return!!r},s=function(e,t){if(!e)return!1;var i=e.parentStoragePod;if(!i)return!1;var r=i,o=t.some(function(e){return n(e,r)});return!!o},c=function(e){return!!o(e)||(!!a(e,r)||!!s(e,r))},l=e.filter(c);return l},e.prototype.load=function(){return this.isInDeployTemplateMode()?this.fetchDrsConfig():(this._drsConfig=null,this.$q.resolve({}))},e.prototype.fetchDrsConfig=function(){var e=this,t=this.getDrsConfigPromise(),i=function(t){return e._drsConfig=t,e.$q.resolve(t)},r=t.then(i);return r},e.prototype.getDrsConfigPromise=function(){var e=this.virtualMachineSpecBuilder.getComputeResourceId(),t="configurationEx.drsConfig",i=this.getProperty(e,t);return i},e.prototype.getProperty=function(e,t){var i=this,r=this.dataService.getProperties(e,[t]),n=function(e){var r=void 0;return e&&t&&(r=e[t]),i.$q.resolve(r)},o=r.then(n);return o},e.prototype.newSuccessfulStorageCheck=function(){var e=this.newStorageCheck(!0);return e},e.prototype.newStorageCheck=function(e,t){var i=new o;if(e){i.icon="vsphere-icon-status-ok";var r="ProvisioningWizard.CompatibilityChecksSucceeded",n=this.i18nService.getString("VmUi",r);i.message=n}else{i.icon="vsphere-icon-status-error";var a="SelectDatastoreProvisioningPage.",r=a+t||"SpecifyValidLocation",s=this.i18nService.getString("VmUi",r);i.message=s}return i.advancedCompatibilityContents={},i},e.prototype.needsDatastoreSelection=function(){return!1===this.isInDeployTemplateMode()||!this.isAutomatedDrsCluster()},e.prototype.canDeployOvfViaDrs=function(e,t){if(e)return!1;if(!t)return!1;var i=this.storageProfileService.isDefaultStorageProfile({id:t});return!i&&!!this.isAutomatedDrsCluster()},e.prototype.isAutomatedDrsCluster=function(){var e=this._drsConfig?this._drsConfig.defaultVmBehavior:void 0;if(!e)return!1;var t="fullyAutomated",i="partiallyAutomated";return e===t||e===i},e}();e.VmProvisioningDatastorePageModel=n;var o=function(){function e(){}return e}();angular.module("com.vmware.vsphere.client.vm").factory("VmProvisioningDatastorePageModel",r)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningDatastorePageService",["i18nService","VmProvisioningDatastorePageModel","vmVuiWizardPageBuilder",function(e,t,i){return{build:function(r,n,o){r.datastorePageForm={};var a=new t(r.vmParams,r.wizardViewData,n,r.config);return r.datastorePageModel=a,i.buildVuiWizardPage(r.config,{title:e.getString("VmUi","SelectDatastoreProvisioningPage.Title"),description:e.getString("VmUi","SelectDatastoreProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningDatastorePage.html",model:a})}}}]);var h5_vm;!function(e){var t=(function(){function e(){}return e}(),function(){function e(e){return function(t,r,n){return e.instantiate(i,{virtualMachineSpecBuilder:t,wizardViewData:r,wizardConfig:n})}}return e.$inject=["$injector"],e}()),i=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.mutationService=t,this.wizardPageService=i,this.virtualMachineSpecBuilder=r,this.wizardViewData=n,this.wizardConfig=o,this.DEPLOYMENT_OPTION_PARAMS_TYPE="com.vmware.vcenter.ovf.DeploymentOptionParams",this.PROPERTY_PARAMS_TYPE="com.vmware.vcenter.ovf.PropertyParams",this.NETWORK_MAPPING_PARAMS_TYPE="com.vmware.vcenter.ovf.NetworkMappingParams",this.DATASTORE_MAPPING_PARAMS_TYPE="com.vmware.vcenter.ovf.DatastoreMappingParams",this.DEPLOYMENT_OPTIONS_VALIDATION_SPEC="com.vmware.vsphere.client.provisioning.spec.DeploymentOptionValidationSpec",this.formObj={deploymentOptionParams:void 0,selectedKey:void 0}}return Object.defineProperty(e.prototype,"form",{get:function(){var e=this.retrieveContextParam(this.wizardViewData.getDeployFromLibraryCommonContext(),this.DEPLOYMENT_OPTION_PARAMS_TYPE);return this.formObj.deploymentOptionParams===e?this.formObj:(this.formObj.deploymentOptionParams=e,this.formObj.selectedKey=e.selectedKey,this.formObj)},enumerable:!0,configurable:!0}),e.prototype.validatePage=function(){var e=this;this.wizardPageService.clearErrors(this.wizardConfig),this.wizardPageService.showLoadingIndicator(this.wizardConfig);var t=this.buildDeploymentOptionsValidationSpec(this.wizardViewData.getDeployFromLibraryCommonContext());return this.mutationService.validateSpec(t._type,t).then(function(t){return e.wizardPageService.hideLoadingIndicator(e.wizardConfig),e.processValidatePageResponse(t)})},e.prototype.processValidatePageResponse=function(e){var t=this;if(e.error)return{error:e.error.message};if(!e.result)return!0;var i=this.retrieveContextParam(e.result.newContext,this.PROPERTY_PARAMS_TYPE),r=this.retrieveContextParam(e.result.newContext,this.DEPLOYMENT_OPTION_PARAMS_TYPE),n=!1;return _.each(this.wizardViewData.getDeployFromLibraryCommonContext(),function(e,o,a){_.isEqual(e._type,t.PROPERTY_PARAMS_TYPE)&&i&&(a[o]=i,n=!0),_.isEqual(e._type,t.DEPLOYMENT_OPTION_PARAMS_TYPE)&&(a[o]=r)}),!n&&i&&this.wizardViewData.getDeployFromLibraryCommonContext().push(i),!0},e.prototype.submitPage=function(){return{wizardFlow:this.virtualMachineSpecBuilder.getCreationType(),invalidateNextPages:!1}},e.prototype.retrieveContextParam=function(e,t){return _.find(e,function(e){return _.isEqual(e._type,t)})},e.prototype.resetForm=function(){},e.prototype.buildDeploymentOptionsValidationSpec=function(e){return{_type:this.DEPLOYMENT_OPTIONS_VALIDATION_SPEC,commonContext:this.trimAndCloneCommonContext(e),selectedOptionKey:this.formObj.selectedKey}},e.prototype.trimAndCloneCommonContext=function(e){var t=this;return _.map(e,function(e){if(e._type===t.NETWORK_MAPPING_PARAMS_TYPE){var i=_.clone(e);return i.targetNetworks=[],i}if(e._type===t.DATASTORE_MAPPING_PARAMS_TYPE){var i=_.clone(e);return i.availableDatastores=[],i}return e})},e.$inject=["i18nService","mutationService","wizardPageService","virtualMachineSpecBuilder","wizardViewData","wizardConfig"],e}();e.VmProvisioningDeploymentOptionsPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningDeploymentOptionsPageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.vmVuiWizardPageBuilder=i,this.vmProvisioningDeploymentOptionsPageModel=r}return e.prototype.build=function(e){var t=new this.vmProvisioningDeploymentOptionsPageModel(e.vmParams,e.wizardViewData,e.config);return e.vmProvisioningDeploymentConfigPageModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("Common","DeploymentOptions.title"),description:this.i18nService.getString("Common","DeploymentOptions.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningDeploymentOptions/vm-provisioning-deployment-options.html",model:t,defaultState:this.vuiConstants.wizard.pageState.SKIPPED})},e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","vmProvisioningDeploymentOptionsPageModel"],e}();e.VmProvisioningDeploymentOptionsPageService=t,angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningDeploymentOptionsPageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t="com.vmware.vcenter.ovf.EulaParams",i=function(){function e(e,t){return function(i,n){return new r(e,t,i,n)}}return e.$inject=["$q","i18nService"],e}(),r=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.formObj={eulaInfo:void 0},this.virtualMachineSpecBuilderObj=i,this.wizardViewDataObj=r}return Object.defineProperty(e.prototype,"form",{get:function(){return this.formObj.eulaInfo=this.retrieveCommonContext(),this.formObj},enumerable:!0,configurable:!0}),e.prototype.resetForm=function(){this.formObj.eulaInfo.allEULAAccepted=!1},e.prototype.validatePage=function(){return this.formObj.eulaInfo&&this.formObj.eulaInfo.allEULAAccepted?{}:{error:this.i18nService.getString("ProvisioningUiLib","AcceptEulaPage.errorEulaNotAccepted")}},e.prototype.submitPage=function(){return{wizardFlow:this.virtualMachineSpecBuilderObj.getCreationType(),invalidateNextPages:!1}},e.prototype.retrieveCommonContext=function(){return _.find(this.wizardViewDataObj.getDeployFromLibraryCommonContext(),function(e){return _.isEqual(e._type,t)})},e.$inject=["$q","i18nService"],e}();e.VmProvisioningEulaPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningEulaPageModel",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.vuiConstants=t,this.vmVuiWizardPageBuilder=i,this.vmProvisioningEulaPageModel=r}return e.prototype.build=function(e){var t=new this.vmProvisioningEulaPageModel(e.vmParams,e.wizardViewData);return e.vmProvisioningEulaPageModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("Common","EulaControl.title"),description:this.i18nService.getString("ProvisioningUiLib","AcceptEulaPage.errorEulaNotAccepted"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningEula/vm-provisioning-eula.html",model:t,defaultState:this.vuiConstants.wizard.pageState.SKIPPED})},e.$inject=["i18nService","vuiConstants","vmVuiWizardPageBuilder","vmProvisioningEulaPageModel"],e}();e.VmProvisioningEulaPageService=t,angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningEulaPageService",t)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.VmProvisioningFinishPageModel,i=e.DeviceOperationConstants,r=function(){function e(e,t,i,r,o,a,s,c,l,d,u,p,v,m,g,h){return function(h,f,S){return new n(e,t,i,r,o,a,s,c,l,d,u,p,v,m,g,h,f,S)}}return e.$inject=["$q","dataService","i18nService","addVmService","vmDeviceInfoService","defaultUriSchemeUtil","creationTypeConstants","bytesFilter","storageProfileService","diskModeService","managedEntityConstants","datastoreRecommendationService","spbmReplicationGroupInfoService","pmemUtilService","virtualDiskPmemService"],e}(),n=function(e){function t(t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S){e.call(this,t,r,n,o,a,l,d,u,p,v,s,h,f,S),this.dataService=i,this.creationTypeConstants=s,this.bytesFilter=c,this.pmemUtilService=m,this.virtualDiskPmemService=g}return __extends(t,e),t.prototype.getSchedulingData=function(){return this.scheduledTaskData},t.prototype.resetForm=function(){e.prototype.resetForm.call(this),this.form.selectedDiskFormat=this.wizardViewData.getDiskFormatLabel()},t.prototype.getSourceObjectInfo=function(){var e;return e=this.creationTypeConstants.isCloningFromATemplate(this.virtualMachineSpecBuilder.getCreationType())?this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.SourceTemplate"):this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.SourceVm"),{name:this.wizardViewData.getSourceObjectName(),label:e}},t.prototype.getTargetObjectInfo=function(){var e;return e=this.creationTypeConstants.isCloningToATemplate(this.virtualMachineSpecBuilder.getCreationType())?this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.TemplateName"):this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.VmName"),{label:e,name:this.virtualMachineSpecBuilder.getName()}},t.prototype.getGosCustomizationSpecName=function(){return this.wizardViewData.getCustomizationSpecName()},t.prototype.presentDiskFormat=function(){return this.wizardViewData.getDiskFormatLabel()},t.prototype.presentProvisioningType=function(){switch(this.virtualMachineSpecBuilder.getCreationType()){case this.creationTypeConstants.CLONE_TEMPLATE_TO_TEMPLATE:return this.i18nService.getString("VmUi","ProvisioningTypes.CloneTemplateToTemplate.Title");case this.creationTypeConstants.CLONE_TEMPLATE_TO_VM:return this.i18nService.getString("VmUi","ProvisioningTypes.DeployFromTemplate.Title");case this.creationTypeConstants.CLONE_VM_TO_TEMPLATE:return this.i18nService.getString("VmUi","ProvisioningTypes.CloneVmToTemplate.Title");case this.creationTypeConstants.CLONE_VM_TO_VM:return this.i18nService.getString("VmUi","ProvisioningTypes.CloneVmToVm.Title");case this.creationTypeConstants.CONVERT_TEMPLATE_TO_VM:return this.i18nService.getString("VmUi","ProvisioningTypes.ConvertTemplateToVm.Title");case this.creationTypeConstants.DEPLOY_VM_FROM_VMTX:return this.i18nService.getString("VmUi","ProvisioningTypes.DeployFromVmtx.Title")}return""},t.prototype.isGosCustomized=function(){return this.virtualMachineSpecBuilder.getCloneOptions()&&this.virtualMachineSpecBuilder.getCloneOptions().customizeOs},t.prototype.getNewDisks=function(){var e=this,i=this.getNewDevicesOfType(t.VIRTUAL_DISK_TYPE);return _.map(i,function(t,i){var r=e.virtualMachineSpecBuilder.getStorageForDisk(t.key),n=e.getDevices().findDeviceSpec(t.key),o=e.getDevices().getVirtualDevice(t.key),a=o.isRDMDisk(),s=o.isCreatedFromExistingDisk(),c=e.buildCommonDiskInfo(t,i+1,e.getInflatedDevices(),a,s);return s?c=_.extend(c,e.buildExistingDiskInfo(n.device.backing.fileName)):a?(e.virtualMachineSpecBuilder.getVmConfigEnvironment().then(function(t){c=_.extend(c,e.buildRdmDiskInfo(t,n))}),c):c=_.extend(c,e.buildNewDiskInfo(t,r))})},t.prototype.buildCommonDiskInfo=function(e,t,i,r,n){var o={diskKey:e.key,label:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.CreateDisk",t),storageProfile:this.getStorageProfileForDisk(e),replicationGroupLabel:this.getReplicationGroupLabelForDisk(e),isPmemDisk:this.isDiskGoingToPmem(e),nodeLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.VdNodeLabel"),node:this.getDiskNode(e,i),modeLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeLabel"),mode:this.getDiskMode(e),isRDM:r,isCreatedFromExistingDisk:n};return o},t.prototype.buildExistingDiskInfo=function(e){var t={};return t.name=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.ExistingDisk"),t.filePathLabel=this.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskFilePath"),
t.filePath=e,t},t.prototype.buildNewDiskInfo=function(e,t){var i=this,r={};return r.name=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NewDisk"),r.capacityLabel=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskCapacity"),r.capacity=this.bytesFilter(e.capacityInKB,"KB"),r.datastoreLabel=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Datastore"),r.datastoreInfo=this.getDatastore(t),r.getStorageObject=function(){return i.getStorageObject(t)},r},t.prototype.buildRdmDiskInfo=function(e,t){var i={};return i.name=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NewRdmDisk"),i.targetLunLabel=this.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskTargetLun"),i.targetLun=this.getRDMTargetLUNName(t.device,e.vmConfigEnvironmentPerPool),i.compatibilityLabel=this.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskCompatibilityMode"),i.compatibility=this.getRDMCompatibility(t.device),i.datastoreLabel=this.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskMappedDatastore"),i.showStorageRecommendations=function(){return!1},i.datastoreName=this.getRDMDatastoreName(),i},t.prototype.getExistingDisks=function(){var e=this,i=this.getExistingDevicesOfType(t.VIRTUAL_DISK_TYPE);return _.map(i,function(t){return{diskKey:t.key,name:t.deviceInfo.label,capacity:e.bytesFilter(t.capacityInKB,"KB"),datastoreInfo:e.getDatastore(),getStorageObject:function(){var i=e.virtualMachineSpecBuilder.getStorageForDisk(t.key);return e.getStorageObject(i)},provisioningType:e.virtualMachineSpecBuilder.getProvisioningTypePerDisk(t.key),storageProfile:e.getStorageProfileForDisk(t),replicationGroupLabel:e.getReplicationGroupLabelForDisk(t),isPmemDisk:e.isDiskGoingToPmem(t)}})},t.prototype.getNumberOfCpus=function(){return this.virtualMachineSpecBuilder.getVmConfigSpec().hardware.numCPU},t.prototype.getAllocatedMemory=function(){var e=this.virtualMachineSpecBuilder.getVmConfigSpec().hardware.memoryMB,t=this.virtualMachineSpecBuilder.getVmConfigSpec().hardware.memoryUnitPreferred;return t?e/t.multiplier+" "+t.label:this.bytesFilter(e,"MB")},t.prototype.shouldDsiplayHwCustomizedProperties=function(){return this.virtualMachineSpecBuilder.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_VMTX&&this.virtualMachineSpecBuilder.getCustomizeCloneHardware()},t.prototype.getNetworkInterfaces=function(){var e=this.virtualMachineSpecBuilder.getUpdatedNetwork();return _.map(e,this.buildNetworkInfo.bind(this))},t.prototype.buildNetworkInfo=function(e,t){var i=this.virtualMachineSpecBuilder.getVirtualMachineDevices().getVirtualDevice(e.device.key).network;return{networkNameLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NicNetwork",t+1),networkName:i.displayName||this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.None"),networkTypeLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NicType",t+1),networkType:this.vmDeviceInfoService.getEthernetCardLabel(e.device._type)}},t.prototype.shouldShowDisks=function(){return this.virtualMachineSpecBuilder.getCustomizeCloneHardware()||this.virtualMachineSpecBuilder.getIsAdvancedStorageMode()},t.prototype.isAdvancedStorageMode=function(){return this.virtualMachineSpecBuilder.getIsAdvancedStorageMode()},t.prototype.getPmemDiskInfo=function(){return this.virtualDiskPmemService.getPmemDiskInfo(this.virtualMachineSpecBuilder.getStorageSelectorState())},t.prototype.isDiskGoingToPmem=function(e){return this.virtualMachineSpecBuilder.getCustomizeCloneHardware()?this.pmemUtilService.isPmemDisk(e):this.pmemUtilService.isPMemStoragePolicy(this.getStorageProfileForDisk(e))},t.prototype.getExistingDevicesOfType=function(e){var t=this.virtualMachineSpecBuilder.getCustomizeCloneHardware()?[i.EDIT]:[i.EDIT,i.REMOVE];return this.getDevicesOfType(e,t)},t.prototype.getNewDevicesOfType=function(e){return this.virtualMachineSpecBuilder.getCustomizeCloneHardware()?this.getDevicesOfType(e,[i.ADD]):[]},t.prototype.getDevicesOfType=function(e,t){var i=[];return _.forEach(this.getInflatedDevices(),function(r){var n=r.getCurrentDeviceSpec().operation,o=r.getCurrentDevice();o._type===e&&_.contains(t,n)&&i.push(r.getCurrentDevice())}),i},t.prototype.getDiskNode=function(e,t){var i=_.find(t,function(t){return t.getCurrentDevice().key===e.controllerKey}),r=i.getCurrentDevice();return this.vmDeviceInfoService.getControllerAndNodeLabelText(r._type,r.busNumber,e.unitNumber)},t.prototype.getInflatedDevices=function(){return this.getDevices()?this.getDevices().getInflatedDevices():[]},t.prototype.getDevices=function(){return this.virtualMachineSpecBuilder.getVirtualMachineDevices()},t.VIRTUAL_DISK_TYPE="com.vmware.vim.binding.vim.vm.device.VirtualDisk",t.$inject=["$q","dataService","i18nService","addVmService","vmDeviceInfoService","defaultUriSchemeUtil","creationTypeConstants","bytesFilter","storageProfileService","diskModeService","managedEntityConstants","datastoreRecommendationService","spbmReplicationGroupInfoService","pmemUtilService","virtualDiskPmemService"],t}(t);e.VmProvisioningFinishCloneVmPageModel=n,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishCloneVmPageModel",r)}(h5_vm||(h5_vm={})),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishCloneVmPageService",["i18nService","addVmService","vmProvisioningFinishCloneVmPageModel","vmVuiWizardPageBuilder",function(e,t,i,r){return{build:function(t){var n=t.scheduleTaskData&&t.scheduleTaskData.isScheduledTask?t.scheduleTaskData:null,o=new i(t.vmParams,t.wizardViewData,n);return t.vmProvisioningFinishCloneVmPageModel=o,r.buildVuiWizardFinishPage(t.config,{title:e.getString("VmUi","ProvisioningWizardSummaryPage.Title"),description:e.getString("VmUi","ProvisioningWizardSummaryPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningFinishClone.html",model:o})}}}])}();var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.VmProvisioningFinishPageModel,i=function(){function e(e,t,i,n,o,a,s,c,l,d,u,p,v){return function(m,g,h){return new r(e,t,i,n,o,a,s,c,l,d,u,p,v,m,g,h)}}return e.$inject=["$q","dataService","i18nService","addVmService","vmDeviceInfoService","defaultUriSchemeUtil","managedEntityConstants","mutationService","storageProfileService","diskModeService","datastoreRecommendationService","spbmReplicationGroupInfoService","creationTypeConstants"],e}(),r=function(e){function t(t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h){e.call(this,t,r,n,o,a,l,d,s,u,p,v,m,g,h),this.dataService=i,this.mutationService=c,this.datastoreRecommendationService=u,this.spbmReplicationGroupInfoService=p,this.creationTypeConstants=v}return __extends(t,e),t.prototype.getProvisioningType=function(){return this.i18nService.getString("VmUi","ProvisioningTypes.ConvertTemplateToVm.Title")},t.prototype.validatePage=function(){return{}},t.prototype.getTemplateName=function(){return this.wizardViewData.getSourceObjectName()},t.prototype.submitPage=function(){var e,i=this,r=this.virtualMachineSpecBuilder.getVmId(),n=this.virtualMachineSpecBuilder.getComputeResourceId(),o=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(n);switch(o.type){case this.managedEntityConstants.CLUSTER:e=this.dataService.getProperties(n,["resourcePool"]).then(function(e){return{resourcePoolRef:e.resourcePool,hostRef:null}});break;case this.managedEntityConstants.HOST:e=this.dataService.getPropertiesByRelation(n,"host",this.managedEntityConstants.ANY_COMPUTE_RESOURCE,["resourcePool"]).then(function(e){return{resourcePoolRef:_.values(e)[0].resourcePool,hostRef:o}});break;case this.managedEntityConstants.RESOURCE_POOL:case this.managedEntityConstants.V_APP:e=this.$q.when({resourcePoolRef:o,hostRef:null});break;default:throw new Error("Invalid compute resource selected")}return e?(e.then(function(e){var n={pool:e.resourcePoolRef,host:e.hostRef};i.mutationService.apply(r,t.VM_CONVERT_SPEC_TYPE,n)}),this.$q.when(!0)):this.$q.when(!1)},t.VM_CONVERT_SPEC_TYPE="com.vmware.vsphere.client.vm.VmConvertSpec",t.$inject=["$q","dataService","i18nService","addVmService","vmDeviceInfoService","defaultUriSchemeUtil","managedEntityConstants","mutationService","storageProfileService","diskModeService","datastoreRecommendationService","spbmReplicationGroupInfoService","creationTypeConstants"],t}(t);e.VmProvisioningFinishConvertToVmPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishConvertToVmPageModel",i)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i){return{build:function(r){var n=new i(r.vmParams,r.wizardViewData);return r.vmProvisioningFinishConvertToVmPageModel=n,t.buildVuiWizardFinishPage(r.config,{title:e.getString("VmUi","ProvisioningWizardSummaryPage.Title"),description:e.getString("VmUi","ProvisioningWizardSummaryPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningFinishConvertToVm.html",model:n})}}}angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishConvertToVmPageService",e),e.$inject=["i18nService","vmVuiWizardPageBuilder","vmProvisioningFinishConvertToVmPageModel"]}();var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.VmProvisioningFinishPageModel,i=function(){function e(e,t,i,n,o,a,s,c,l,d,u,p,v,m){return function(g,h,f){return new r(e,t,i,n,o,a,s,c,l,d,u,p,v,m,g,h,f)}}return e.$inject=["$q","dataService","i18nService","addVmService","vmDeviceInfoService","defaultUriSchemeUtil","bytesFilter","storageProfileService","vmHardwareVersionService","managedEntityConstants","diskModeService","datastoreRecommendationService","spbmReplicationGroupInfoService","creationTypeConstants"],e}(),r=function(e){function t(t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f){e.call(this,t,r,n,o,a,c,u,d,p,v,m,g,h,f),this.dataService=i,this.bytesFilter=s,this.vmHardwareVersionService=l,this.datastoreRecommendationService=p,this.spbmReplicationGroupInfoService=v,this.creationTypeConstants=m}return __extends(t,e),t.prototype.getSchedulingData=function(){return this.scheduledTaskData},t.prototype.submitPage=function(){return this.wizardViewData.setDatastoreObjectName(this.form.highestRecommendedDatastoreName),e.prototype.submitPage.call(this)},t.prototype.getDisks=function(){var e=_.pluck(this.virtualMachineSpecBuilder.getDiskChanges(),"device");return _.map(e,this.buildDiskInfo.bind(this))},t.prototype.getGuestOsName=function(){return this.virtualMachineSpecBuilder.getGosVersion().name},t.prototype.getVbsEnabled=function(){return this.virtualMachineSpecBuilder.getVbsEnabled()?this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.enabled"):this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.disabled")},t.prototype.getTpmDevice=function(){var e=_.pluck(this.virtualMachineSpecBuilder.getTpmChanges(),"device");return e.length?e[0]:null},t.prototype.getNumberOfCpus=function(){return this.virtualMachineSpecBuilder.getVmConfigSpec().config.hardware.numCPU},t.prototype.getAllocatedMemory=function(){var e=this.virtualMachineSpecBuilder.getVmConfigSpec().config.hardware.memoryMB,t=this.virtualMachineSpecBuilder.getVmConfigSpec().config.hardware.memoryUnitPreferred;return t?e/t.multiplier+" "+t.label:this.bytesFilter(e,"MB")},t.prototype.getScsiControllers=function(){var e=_.pluck(this.virtualMachineSpecBuilder.getScsiControllerChanges(),"device");return _.map(e,this.buildScsiInfo.bind(this))},t.prototype.getNetworkInterfaces=function(){var e=this.virtualMachineSpecBuilder.getVirtualMachineDevices().changedDevicesOfType("VirtualEthernetCard");return _.map(e,this.buildNetworkInfo.bind(this))},t.prototype.getVmVersionCompatibility=function(){return this.i18nService.getString("VmUi","VmHardware.HWVersion.vmVersionLabel",this.vmHardwareVersionService.getLongText(this.virtualMachineSpecBuilder.getVmConfigSpec().config.version))},t.prototype.buildNetworkInfo=function(e,t){return{networkNameLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NicNetwork",t+1),networkName:e.getNetworkName()||this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.None"),networkTypeLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NicType",t+1),networkType:this.vmDeviceInfoService.getEthernetCardLabel(e.getCurrentDevice()._type)}},t.prototype.buildScsiInfo=function(e,t){return{label:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.ScsiController",t+1),name:this.vmDeviceInfoService.getScsiControllerLabel(e)}},t.prototype.buildDiskInfo=function(e,t){var i=this,r=this.virtualMachineSpecBuilder.getStorageForDisk(e.key),n=this.virtualMachineSpecBuilder.getVirtualMachineDevices().findDeviceSpec(e.key),o=this.virtualMachineSpecBuilder.getVirtualMachineDevices().getVirtualDevice(e.key),a=o.isRDMDisk(),s=o.isCreatedFromExistingDisk(),c={diskKey:e.key,label:this.isDiskEncrypted(e.key)?this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.CreateEncryptedDisk",t+1):this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.CreateDisk",t+1),storageProfile:this.getStorageProfileForDisk(e),replicationGroupLabel:this.getReplicationGroupLabelForDisk(e),nodeLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.VdNodeLabel"),node:this.getDiskNode(e,this.virtualMachineSpecBuilder.getVirtualMachineDevices().getDeviceChanges()),modeLabel:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskModeLabel"),mode:this.getDiskMode(e),isPmemDisk:o.isPmemDisk(),isRDM:a,isCreatedFromExistingDisk:s};return s?(c.name=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.ExistingDisk"),c.filePathLabel=this.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskFilePath"),c.filePath=n.device.backing.fileName,c):a?(this.virtualMachineSpecBuilder.getVmConfigEnvironment().then(function(e){c.name=i.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NewRdmDisk"),c.targetLunLabel=i.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskTargetLun"),c.targetLun=i.getRDMTargetLUNName(n.device,e.vmConfigEnvironmentPerPool),c.compatibilityLabel=i.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskCompatibilityMode"),c.compatibility=i.getRDMCompatibility(n.device),c.datastoreLabel=i.i18nService.getString("VmUi","vmProvisioningFinishPage.DiskMappedDatastore"),c.showStorageRecommendations=function(){return!1},c.datastoreName=i.getRDMDatastoreName()}),c):(c.name=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.NewDisk"),c.capacityLabel=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.DiskCapacity"),c.capacity=this.buildDiskCapacity(e,n),c.datastoreLabel=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Datastore"),c.datastoreInfo=this.getDatastore(r),c.getStorageObject=function(){return i.getStorageObject(r)},c.showStorageRecommendations=function(){return i.showStorageRecommendations(r)},c)},t.prototype.showStorageRecommendations=function(e){var t=this.virtualMachineSpecBuilder.getStorageObject();return e&&(t=e.dsObject),t.storageRef.type===this.managedEntityConstants.STORAGE_POD||t.parentStoragePod&&t.parentStoragePod.isSdrsEnabled},t.prototype.buildDiskCapacity=function(e,t){return this.bytesFilter(e.capacityInKB,"KB")},t.prototype.getDiskNode=function(e,t){var i=this.virtualMachineSpecBuilder.getVmConfigSpec().config.hardware.device.concat(_.pluck(t,"device")),r=_.find(i,function(t){return t.key===e.controllerKey});return this.vmDeviceInfoService.getControllerAndNodeLabelText(r._type,r.busNumber,e.unitNumber)},t.$inject=["$q","dataService","i18nService","addVmService","vmDeviceInfoService","defaultUriSchemeUtil","bytesFilter","storageProfileService","vmHardwareVersionService","managedEntityConstants","diskModeService","datastoreRecommendationService","spbmReplicationGroupInfoService","creationTypeConstants"],t}(t);e.VmProvisioningFinishCreateVmPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishCreateVmPageModel",i)}(h5_vm||(h5_vm={})),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishCreateVmPageService",["$q","i18nService","addVmService","mutationService","wizardPageService","defaultUriSchemeUtil","vmVuiWizardPageBuilder","vmProvisioningFinishCreateVmPageModel",function(e,t,i,r,n,o,a,s){return{build:function(e){var i=new s(e.vmParams,e.wizardViewData,e.scheduleTaskData);return e.vmProvisioningFinishCreateVmPageModel=i,a.buildVuiWizardFinishPage(e.config,{title:t.getString("VmUi","ProvisioningWizardSummaryPage.Title"),description:t.getString("VmUi","ProvisioningWizardSummaryPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningFinish.html",model:i})}}}])}(),function(){"use strict";function e(e,t){var i=e.vmProvisioningFinishDeployFromTemplatePageModel,r=this;r.provisioningTypeName=i.presentProvisioningType(),e.vmParams.getCreationType()===t.DEPLOY_VM_FROM_TEMPLATE||e.vmParams.getCreationType()===t.DEPLOY_VM_FROM_VAPP?r.templateName=e.wizardViewData.getSelectedTemplate().templateName:e.vmParams.getCreationType()===t.DEPLOY_VM_FROM_OVF&&(r.templateName=e.vmParams.getTemplateName()),r.templateVMName=i.getVmName(),r.downloadSize=e.productDetailsPageModel.dataModel.getDownloadSize();var n=e.datastorePageModel.form.diskFormatSettings.selectedDiskFormat,o=n&&"thin"===n.type;r.scaleoutConfiguration=e.wizardViewData.getSclaeoutConfigurationFromLibraryCommonContext(),r.sizeOnDisk=e.productDetailsPageModel.dataModel.getSizeOnDisk(o),r.computeResource=e.vmParams.getComputeResourceName(),r.vmFolder=e.vmParams.getTargetInformation().name,r.storageMappings=i.getStorageDetails(),r.networkDevices=i.getNetworkDetails(e.networkPageModel.getNetworkMappingParams()),r.ipDetails=i.getIpAllocationDetails(e.networkPageModel.getIpAllocationParams());var a=i.getCustomizationSpec();r.gosCustomizationSpecName=a?a.name:void 0,r.isGosCustomizationEnabled=!_.isEmpty(r.gosCustomizationSpecName)}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningFinishDeployFromTemplateController",e),e.$inject=["$scope","creationTypeConstants"]}(),function(){"use strict";function e(e,t,i,r,n){return function(o,a){function s(e,i){return t.getXmlFormattedCustomizationSpec(a.getVCenterId(),e,i).then(function(e){var t=e.result;return{_type:"com.vmware.vcenter.ovf.VcenterGuestCustomizationParams",type:"VcenterGuestCustomizationParams",customizations:{systemId:{type:"XML",xml:t}}}})}function c(){var e=a.getTemplateSourceType()===i.SOURCE_TYPE_PUSH,r=e?a.getDeployOvfSession():void 0;return p(),p(),v(),v(),t.deployVmFromLibraryTemplate(o.getComputeResourceId(),o.getTargetInformation().folderUid,o.getName(),a.getDeployFromLibraryCommonContext(),e,r),!0}function l(t,i){var n,o=t||i,a=u(void 0!==o.targetProfile?o.targetProfile:i.targetProfile),s=r.isPmemStorageProfile(a),c=o.targetDatastore?d(o.targetDatastore):!s&&i?d(i.targetDatastore):"",l=o.targetProvisioningType?e.getString("ProvisioningUiLib","DiskProvisioningType."+o.targetProvisioningType.name+".label"):e.getString("ProvisioningUiLib","DiskProvisioningType.asDefinedInProfile.label");return n=s?e.getString("ProvisioningUiLib","SelectStoragePage.summary.policyPMemdsFormat",a.label,l):a?e.getString("ProvisioningUiLib","SelectStoragePage.summary.policyDsFormat",a.label,c,l):e.getString("ProvisioningUiLib","SelectStoragePage.summary.dsFormat",c,l),n?n:"N/A"}function d(e){var t=a.getStorageNameMap();return _.find(t,function(t,i){return i.indexOf(e)>=0})}function u(e){var t=a.getStorageProfiles();return _.findWhere(t,{id:e})}function p(){var e=a.getNetworkMappingParamsFromLibraryCommonContext();e&&e.targetNetworks&&(e.targetNetworks=null)}function v(){var e=a.getDatastoreMappingParamsFromLibraryCommonContext();if(e){_.each(e.diskGroups,function(t){var i=g(t.targetDatastore);i&&i.type===h&&i.thinProvisioningSupported&&(t.targetProvisioningType=_.find(e.availableDiskProvisioningTypes,function(e){return e.name===f}))});var t=g(e.targetDatastore);t&&t.type===h&&t.thinProvisioningSupported&&(e.targetProvisioningType=_.find(e.availableDiskProvisioningTypes,function(e){return e.name===f}))}}function m(e){if(e){var t=e.split(":");if(!(t.length<2))return n.getVsphereObjectId({type:"Datastore",value:t[0],serverGuid:t[1]})}}function g(e){if(e){var t=a.getStorageLocatorItemsData().datastoreItems;return _.find(t,function(t){if(t){var i=m(e),r=t.storageRef;return n.compareIds(i,r)}return!1})}}var h="vsan",f="thin";return{presentProvisioningType:function(){return a.getTemplateSourceType()===i.SOURCE_TYPE_PULL?e.getString("VmUi","ProvisioningTypes.DeployFromOvfRemote.Title"):e.getString("VmUi","ProvisioningTypes.DeployFromTemplate.Title")},validatePage:function(){return{}},getVmName:function(){return o.getName()},getCustomizationSpec:function(){return o.getCustomizationSpec()},getStorageDetails:function(){var t=a.getDatastoreMappingParamsFromLibraryCommonContext(),i=_.map(t.diskGroups,function(e){return{name:e.name,diskInfo:l(e,t)}});if(i.push({name:_.size(i)>0?e.getString("ProvisioningUiLib","SelectStoragePage.summary.allOtherDisks"):e.getString("ProvisioningUiLib","SelectStoragePage.summary.allDisks"),diskInfo:l(void 0,t)}),1===_.size(i))return i;var r=_.some(i,function(e){return e.diskInfo!==i[0].diskInfo});return r?i:[{name:e.getString("ProvisioningUiLib","SelectStoragePage.summary.allDisks"),diskInfo:i[0].diskInfo}]},getNetworkDetails:function(e){return e?_.map(e.sourceNetworks,function(t){var i=_.find(e.targetNetworks,function(e){return e.id===t.target});return t.targetName=i.name,t}):null},getIpAllocationDetails:function(e){return e?(e.ipAllocationPolicy=_.find(e.supportedIpAllocationPolicy,function(t){return _.isEqual(t.name,e.ipAllocationPolicy.name)}),e):null},submitPage:function(){var e=o.getCustomizationSpecInfo(),t=o.getCustomizationSpec();return e&&t?s(e,t).then(function(e){var t=a.getDeployFromLibraryCommonContext();t.push(e),a.setDeployFromLibraryCommonContext(t),c()}):c(),!0},fetchSelectedStorage:function(){return o.getStorageObject()}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningFinishDeployFromTemplatePageModel",e),e.$inject=["i18nService","contentLibraryService","sourceTypeConstants","storageProfileService","defaultUriSchemeUtil"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishDeployTemplatePageService",["$q","i18nService","addVmService","mutationService","wizardPageService","defaultUriSchemeUtil","vmVuiWizardPageBuilder","VmProvisioningFinishDeployFromTemplatePageModel",function(e,t,i,r,n,o,a,s){return{build:function(e){var i=new s(e.vmParams,e.wizardViewData);return e.vmProvisioningFinishDeployFromTemplatePageModel=i,a.buildVuiWizardFinishPage(e.config,{title:t.getString("VmUi","ProvisioningWizardSummaryPage.Title"),description:t.getString("VmUi","ProvisioningWizardSummaryPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningFinishDeployFromTemplate.html",model:i})}}}])}();var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.data.RegisterVmSpec,i=function(){function e(e,t,i,n,o,a){return function(s,c){return new r(e,t,i,n,o,a,s,c)}}return e.$inject=["defaultUriSchemeUtil","i18nService","dataService","managedEntityConstants","$q","mutationService"],e}(),r=function(){function e(e,t,i,r,n,o,a,s){this.defaultUriSchemeUtil=e,this.i18nService=t,this.dataService=i,this.managedEntityConstants=r,this.$q=n,this.mutationService=o,this.virtualMachineSpecBuilder=a,this.wizardViewData=s}return e.prototype.getVmName=function(){return this.virtualMachineSpecBuilder.getName()},e.prototype.getTargetFolderName=function(){return this.virtualMachineSpecBuilder.getTargetInformation().name},e.prototype.getIsTemplate=function(){return this.virtualMachineSpecBuilder.getRegisterVmData().isTemplate},e.prototype.getComputeResourceInfo=function(){var e=this.virtualMachineSpecBuilder.getComputeResourceId(),t=this.virtualMachineSpecBuilder.getComputeResourceName(),i=this.labelForType(e);return{name:t,label:i}},e.prototype.validatePage=function(){return{}},e.prototype.submitPage=function(){var e=new t;return e.folderRef=this.defaultUriSchemeUtil.getManagedObjectReference(this.virtualMachineSpecBuilder.getTargetInformation().folderUid),e.targetRef=this.defaultUriSchemeUtil.getManagedObjectReference(this.virtualMachineSpecBuilder.getComputeResourceId()),e.vmName=this.virtualMachineSpecBuilder.getName(),e.vmPath=this.virtualMachineSpecBuilder.getRegisterVmData().vmFilePath,e.isVmTemplate=this.virtualMachineSpecBuilder.getRegisterVmData().isTemplate,this.mutationService.add(e._type,e),this.$q.resolve(!0)},e.prototype.labelForType=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).type;switch(t){case this.managedEntityConstants.CLUSTER:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Cluster");case this.managedEntityConstants.HOST:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Host");case this.managedEntityConstants.RESOURCE_POOL:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.RP");case this.managedEntityConstants.V_APP:return this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.RP");default:throw new Error("Unknown compute resouce id: "+e)}},e.$inject=["defaultUriSchemeUtil","i18nService","dataService","managedEntityConstants","$q","mutationService"],e}();e.VmProvisioningFinishRegisterPageModel=r,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishRegisterPageModel",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.vmVuiWizardPageBuilder=t,this.vmProvisioningFinishRegisterPageModel=i}return e.prototype.build=function(e){var t=new this.vmProvisioningFinishRegisterPageModel(e.vmParams,e.wizardViewData);return e.finishRegisterPageModel=t,this.vmVuiWizardPageBuilder.buildVuiWizardFinishPage(e.config,{title:this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Title"),description:this.i18nService.getString("VmUi","regVm.Summary.pageDesc"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningFinishRegister.html",model:t})},e.$inject=["i18nService","vmVuiWizardPageBuilder","vmProvisioningFinishRegisterPageModel"],e}();e.VmProvisioningFinishRegisterPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningFinishRegisterPageService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o){return function(a){function s(){return o.hardwareV14_vbsEnabled&&o.hardwareV14_vbsEnabled()}function c(e){var r=[];_.each(v,function(n){d(n,e)&&r.push({id:n.id,name:n.fullName,supportLevelMessage:t.trustAsHtml(i.getString("VmUi","GOSConfigBase.support_level."+n.supportLevel)),vbsSupported:n.vbsSupported})});var n;if(a.getRecreateVm()||(n=a.getGosVersion()),n){var o=_.some(r,function(e){return e.id===n.id});o||(n=null)}var s=g.gosVersion;if(s){var c=_.find(r,function(e){return e.id===s.id});s=c?c:null}var l=s||n,u=m?_.find(r,function(e){return e.id===m.id&&(!e.vbsSupported&&!m.vbsSupported||e.vbsSupported&&m.vbsSupported&&e.vbsSupported.supported===m.vbsSupported.supported)}):null;g.gosVersionOptions=r,g.gosVersion=l||u||g.gosVersionOptions[0]}function l(e){var t=a.getScheduledGuestOsId(),i=null;return t&&(_.each(e,function(e,r){if(e.id===t)return void(i=r)}),a.setScheduledGuestOsId(null),null!==i&&(e[i].family===r.WINDOWS?g.gosFamily=g.gosFamilyOptions[0]:e[i].family===r.LINUX?g.gosFamily=g.gosFamilyOptions[1]:g.gosFamily=g.gosFamilyOptions[2],a.getScheduledGuestName()&&(g.gosName=a.getScheduledGuestName()))),i}function d(e,t){return(e.family===r.WINDOWS?t.id===r.WINDOWS:e.family===r.LINUX?t.id===r.LINUX:t.id===r.OTHER)||t.id===e.family}function u(){var e=a.getVmVersion(),t=n.getLongText(e);return i.getString("VmUi","VmHardware.HWVersion.vmVersionLabel",t)}function p(e){return{id:e,name:i.getString("VmUi","GeneralOptions.gos_family."+e)}}var v,m,g={familyChanged:function(){this.gosVersion=null,c(this.gosFamily)},gosFamilyOptions:[p(r.WINDOWS),p(r.LINUX),p(r.OTHER)],gosVersionOptions:{},isSelectedOtherOs:function(){return this.gosVersion&&("otherGuest"===this.gosVersion.id||"otherGuest64"===this.gosVersion.id)},vbsEnabled:!1,isVbsSupported:function(e){return s()&&!!e.vbsSupported&&e.vbsSupported.supported}};return{form:g,resetForm:function(){var t,i,r=e.defer();a.getRecreateVm()||(t=a.getGosFamily(),i=a.getGosName());var n=g.gosFamily||t;return g.gosFamily=n||g.gosFamilyOptions[0],a.getConfigOptionByPool().then(function(e){v=e.vmConfigOptionByPool.guestOSDescriptor;var t=e.vmConfigOptionByPool.guestOSDefaultIndex,i=l(v);null!==i&&(t=i),t&&t>-1&&t<v.length&&(m=v[t]),c(g.gosFamily),g.vmVersionDescription=u(),a.getVmConfigEnvironmentForGos(g.gosVersion),r.resolve()}),g.gosName=g.gosName||i||null,r.promise},pageFinishedLoading:function(){return!!g.gosFamily&&!!g.gosVersion},validatePage:function(){return{}},submitPage:function(){a.setGosFamilyAndVersion({family:g.gosFamily,version:g.gosVersion});const e=a.getScheduledData();return _.isEmpty(e)||e.spec.guestId!==g.gosVersion.id&&(e.useScheduledTaskData=!1),a.setVbsSupported(g.gosVersion.vbsSupported&&g.gosVersion.vbsSupported.supported),a.setVbsEnabled(g.vbsEnabled),g.isSelectedOtherOs()?a.setGosName(g.gosName):a.setGosName(null),{wizardFlow:a.getCreationType(),invalidateNextPages:!1}}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningGuestOsPageModel",e),e.$inject=["$q","$sce","i18nService","gosFamilyConstants","vmHardwareVersionService","featureFlagsService"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningGuestOsPageService",["i18nService","vuiConstants","wizardPageService","vmVuiWizardPageBuilder","VmProvisioningGuestOsPageModel",function(e,t,i,r,n){return{build:function(t){var i=n(t.vmParams);return t.guestOsPageModel=i,r.buildVuiWizardPage(t.config,{title:e.getString("VmUi","SelectGuestOsProvisioningPage.Title"),description:e.getString("VmUi","SelectGuestOsProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningGuestOs.html",model:i})}}}]),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u){return function(p,v,m){function g(e){return E.newVmName?P(E.newVmName)?"":i.getString("VmUi","NameValidator.nameTooLongSpecialChars"):i.getString("VmUi","SelectNameFolderProvisioningPage.specifyValidName"+(e?"."+h():""))}function h(){var e,t=v.getCreationType();return e=n.isRegisterVm(t)?v.getRegisterVmData().isTemplate:n.isCloningToATemplate(t),e?c.TEMPLATE:c.VIRTUAL_MACHINE}function f(e){var i=t.getPartsFromVsphereObjectId(e);return"Folder"===i.type&&"group-d1"===i.value}function S(e,i,r){if(I=e,e)return null;var n=t.getEntityType(i.uid),o=y(n,r);return o}function y(e,t){var r=["SelectNameFolderProvisioningPage.No"];switch(t){case h5_vm.Privileges.VM_INVENTORY_CREATE_FROM_EXISTING:r.push("CreateFromExistingPrivilege");break;case h5_vm.Privileges.VM_INVENTORY_REGISTER:r.push("RegisterVmPrivilege");break;case h5_vm.Privileges.VAPP_IMPORT:r.push("CreateNewVappPrivilege");break;default:r.push("CreateNewPrivilege")}return e===o.DATACENTER?r.push("OnDatacenter"):e===o.FOLDER&&r.push("OnFolder"),i.getString("VmUi",r.join(""))}function P(e){return C(e).length<=V}function C(e){return e.replace(/%/g,"%25").replace(/\//g,"%2f").replace(/\\/g,"%2c")}function D(e,i){if(!e||!i)return!1;var r=t.getPartsFromVsphereObjectId(e).serverGuid,n=t.getPartsFromVsphereObjectId(i).serverGuid;return r!==n}function w(e,t){var i=t.getRecommendedFolderAndComputeResource();if(i)return e!==n.CREATE_FROM_SCRATCH&&e!==n.DEPLOY_VM_FROM_TEMPLATE||!i.createWorkflow?e!==n.CLONE_VM_TO_TEMPLATE&&e!==n.CLONE_TEMPLATE_TO_TEMPLATE||!i.templateWorkflow?n.isCloning(e)&&i.cloneWorkflow?i.cloneWorkflow.folderId:i.defaultFolderId:i.templateWorkflow.folderId:i.createWorkflow.folderId;
}function b(e,i){if(_=!0,e!==n.DEPLOY_VM_FROM_VMTX||!i)return r.when(!0);var o=t.getPartsFromVsphereObjectId(i).serverGuid;return u.is671VcOrLaterByGuid(o)}var I,_,T,E={selectedTarget:{},hasEncryptNewVmPrivilege:!1,hasManageEncryptionPolicyPrivilege:!1},V=80,M="";return{form:E,resetForm:function(){var e=v.getName(),t=e||E.newVmName;t?E.newVmName=t:v.getCreationType()===n.CREATE_FROM_SCRATCH?E.newVmName=i.getString("VmUi","SelectNameFolderProvisioningPage.defaultNewVmName"):E.newVmName=""},getTreeType:function(){var e=v.getCreationType(),t=n.isRegisterVm(e),i=t?"VmFoldersTreeFromDatacenter":"VmFoldersTree";return i},getTreeRoot:function(){var e=v.getCreationType(),t=n.isRegisterVm(e),i=n.isDeployVmFromTemplate(e);return t?p.wizardViewData.getDatacenterId():i?p.wizardViewData.getVCenterId():null},targetIdToPreselect:function(){var e=v.getTargetInformation(),t=e?e.targetUid:null,i=E.selectedTarget,r=i?i.uid:null,n=r||t,o=v.getCreationType();o!==M&&(M=o,n=void 0);var a=w(o,p.wizardViewData);return n=n||m||a},pageInstructions:function(){switch(v.getCreationType()){case n.CREATE_FROM_SCRATCH:case n.CLONE_VM_TO_VM:case n.CLONE_TEMPLATE_TO_VM:case n.DEPLOY_VM_FROM_VAPP:case n.DEPLOY_VM_FROM_TEMPLATE:case n.DEPLOY_VM_FROM_OVF:return{nameCallToAction:i.getString("VmUi","SelectNameFolderProvisioningPage.vmName"),locationCallToAction:i.getString("VmUi","SelectNameFolderProvisioningPage.instructionLocation.vm")};case n.REGISTER_VM:var e=v.getRegisterVmData().isTemplate;return{nameCallToAction:e?i.getString("VmUi","SelectNameFolderProvisioningPage.templateName"):i.getString("VmUi","SelectNameFolderProvisioningPage.vmName"),locationCallToAction:e?i.getString("VmUi","SelectNameFolderProvisioningPage.instructionLocation.template"):i.getString("VmUi","SelectNameFolderProvisioningPage.instructionLocation.vm")};case n.CLONE_TEMPLATE_TO_TEMPLATE:case n.CLONE_VM_TO_TEMPLATE:return{nameCallToAction:i.getString("VmUi","SelectNameFolderProvisioningPage.templateName"),locationCallToAction:i.getString("VmUi","SelectNameFolderProvisioningPage.instructionLocation.template")}}},pageFinishedLoading:function(){return!(!E.selectedTarget||!E.selectedTarget.type)},validateSelection:function(){s.clearErrors(p.config);var e=E.selectedTarget,t=null,r=v.getCreationType(),o=D(v.getVmId(),e.uid);return T=n.isCloning(r)?o?[h5_vm.Privileges.VM_INVENTORY_REGISTER]:[h5_vm.Privileges.VM_INVENTORY_CREATE_FROM_EXISTING]:n.isRegisterVm(r)?[h5_vm.Privileges.VM_INVENTORY_REGISTER]:[h5_vm.Privileges.VM_INVENTORY_CREATE],T.push(h5_vm.Privileges.CRYPTOGRAPHER_ENCRYPT_NEW_VM),T.push(h5_vm.Privileges.CRYPTOGRAPHER_MANAGE_ENCRYPTION_POLICY),r===n.DEPLOY_VM_FROM_VAPP&&T.push(h5_vm.Privileges.VAPP_IMPORT),a.checkGrantedPrivileges(e.uid,T).then(function(i){if(E.hasEncryptNewVmPrivilege=i[1],E.hasManageEncryptionPolicyPrivilege=i[2],t=S(i[0],e,T[0]),r===n.DEPLOY_VM_FROM_VAPP){var o=i[3];o===!1&&(t=S(!1,e,h5_vm.Privileges.VAPP_IMPORT))}return t?t:b(v.getCreationType(),e.uid)}).then(function(e){return t?t:e?null:(_=!1,i.getString("LibraryUi","error.vmtx.unsupported.datacenterfolder"))})},validatePage:function(){var t=g(!0);if(t)return r.resolve({error:t});var n=h();if(!E.selectedTarget.uid||f(E.selectedTarget.uid)||!I||!_)return r.resolve({error:i.getString("VmUi","SelectNameFolderProvisioningPage.specifyValidDestination."+n)});var o=e.validateNameAndGetLocationUids(E.newVmName,E.selectedTarget).then(function(e){return e.validName?e.isVmFolder?{folderUid:e.folderUid,datacenterUid:e.datacenterUid}:{error:i.getString("VmUi","SelectNameFolderProvisioningPage.specifyValidDestination."+n)}:{error:e.validationMessage}});return l.get("vm-ui/resources/vm/views/createVmWizard/vmProvisioningComputeResource.html",{cache:d}),l.get("common-module-ui/resources/common-module/views/compatibility/vxCompatibilityView.html",{cache:d}),o},submitPage:function(e){v.setName(E.newVmName),v.setHasEncryptNewVmPrivilege(E.hasEncryptNewVmPrivilege),v.setHasManageEncryptionPolicyPrivilege(E.hasManageEncryptionPolicyPrivilege);var t=!1,i=v.getTargetInformation();return i&&i.datacenterUid&&i.datacenterUid!==e.datacenterUid&&(t=!0),v.setTargetInformation(E.selectedTarget.uid,e.datacenterUid,e.folderUid,E.selectedTarget.name),{wizardFlow:v.getCreationType(),invalidateNextPages:t}},checkVmName:g}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningNameAndFolderPageModel",e),e.$inject=["nameAndFolderValidatorService","defaultUriSchemeUtil","i18nService","$q","creationTypeConstants","managedEntityConstants","authorizationService","wizardPageService","vmTypeConstants","$http","$templateCache","vcService"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningNameAndFolderPageService",["i18nService","dataService","$q","defaultUriSchemeUtil","wizardPageService","VmProvisioningNameAndFolderPageModel","vmVuiWizardPageBuilder",function(e,t,i,r,n,o,a){return{build:function(t,i){var r=new o(t,t.vmParams,i);return t.nameAndFolderPageModel=r,a.buildVuiWizardPage(t.config,{title:e.getString("VmUi","SelectNameFolderProvisioningPage.Title"),description:e.getString("VmUi","SelectNameFolderProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningNameAndFolder.html",model:r})}}}]),function(){"use strict";function e(e,t,i,r,n){var o,a="com.vmware.vsphere.client.provisioning.spec.NetworkConfigValidationSpec",s="com.vmware.vsphere.client.provisioning.spec.NetworkMappingsValidationSpec",c="com.vmware.vsphere.client.provisioning.spec.NetworkMappingsSpec",l="com.vmware.vsphere.client.provisioning.spec.NetworkMapping",d="com.vmware.vsphere.client.provisioning.spec.IpAllocationValidationSpec";return function(u,p,v){function m(e){if(e){var t=_.find(e,function(e){return"com.vmware.vcenter.ovf.NetworkMappingParams"===e._type});return t?t:{}}}function g(e){if(e){var t=_.find(e,function(e){return"com.vmware.vcenter.ovf.IpAllocationParams"===e._type});return t?t:{}}}function h(e){return{_type:a,networkMappingsValidationSpec:f(e),ipAllocationValidationSpec:y(e)}}function f(e){return{_type:s,commonContext:e,mappingSpec:{_type:c,networkMappings:S(e)}}}function S(e){var t=m(e).sourceNetworks;return _.map(t,function(e){var t,i=C(e.target);return i&&(t=i.targetNetworkRef),{_type:l,sourceNetworkName:e.name,sourceNetworkDescription:e.description,targetNetworkUri:e.target,targetNetworkRef:t}})}function y(e){var t=g(e);return{_type:d,commonContext:e,ovfIpAllocationParams:_.isEmpty(t)?null:t}}function P(e){var r=i.createUri("com.vmware.vsphere.client.provisioning.Context","root");return t.getProperties(r,["networkMappingsForNetworkParams"],{propertyParams:[{propertyName:"networkMappingsForNetworkParams",parameterType:"com.vmware.vcenter.ovf.NetworkMappingParams",parameter:m(e)}]})}function C(e){return _.find(o,function(t){return t.targetNetworkUri===e})}function D(e){var t=g(e);if(!_.isEmpty(t))return"IPV4"===t.ipProtocol.name?r.getString("ProvisioningUiLib","IpAllocationControl.noIpv4RangeWarning"):r.getString("ProvisioningUiLib","IpAllocationControl.noIpv6RangeWarning")}return{getNetworkMappingParams:function(){var e=u.getDeployFromLibraryCommonContext();return P(e).then(function(e){e.networkMappingsForNetworkParams&&(o=e.networkMappingsForNetworkParams.networkMappings)}),m(e)},getIpAllocationParams:function(){var e=u.getDeployFromLibraryCommonContext();return g(e)},validatePage:function(){n.clearErrors(v),n.showLoadingIndicator(v);var t=u.getDeployFromLibraryCommonContext(),i=h(t);return e.validate(p.getComputeResourceId(),a,i).then(function(e){if(n.hideLoadingIndicator(v),e.error){var i=D(t);return i&&(e.error=i),e}})},submitPage:function(){return{invalidateNextPages:!1,wizardFlow:p.getCreationType()}}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningNetworkPageModel",e),e.$inject=["mutationService","dataService","defaultUriSchemeUtil","i18nService","wizardPageService"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningNetworkPageService",["i18nService","vuiConstants","VmProvisioningNetworkPageModel","vmVuiWizardPageBuilder",function(e,t,i,r){return{build:function(n){var o=new i(n.wizardViewData,n.vmParams,n.config);return n.networkPageModel=o,r.buildVuiWizardPage(n.config,{title:e.getString("ProvisioningUiLib","SelectNetworksPage.title"),description:e.getString("ProvisioningUiLib","SelectNetworksPage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningNetworkPage.html",model:o,defaultState:t.wizard.pageState.SKIPPED})}}}]),function(){"use strict";function e(e,t,i){function r(){!M.isCertPresent||_.isEmpty(M.x509)||_.isEmpty(M.subject)||t.save(M.x509,M.issuer+".cer")}function n(){return M.isCertPresent}function o(){return M.issuer}function a(){return M.isCertPresent?M.isCertValid?M.isSelfSigned?e.getString("ProvisioningUiLib","ProductDetailsPage.publisher.untrusted"):e.getString("ProvisioningUiLib","ProductDetailsPage.publisher.trusted"):e.getString("ProvisioningUiLib","ProductDetailsPage.publisher.invalid"):e.getString("ProvisioningUiLib","ProductDetailsPage.publisher.nocert")}function s(){return!_.isEmpty(M.vendorUri)}function c(){return!_.isEmpty(M.productUri)}function l(){return!_.isEmpty(M.version)||!_.isEmpty(M.fullVersion)}function d(){return!_.isEmpty(m())}function u(){return!_.isEmpty(v())}function p(){return!_.isEmpty(S())}function v(){return M.productName}function m(){return M.vendor}function g(){return M.version||M.fullVersion}function h(){return M.vendorUri}function f(){return M.productUri}function S(){return M.description}function y(){return P(M.downloadSize)}function P(t){return t&&t!==-1?t<O?e.getString("ProvisioningUiLib","ProductDetailsPage.lessThan1Mb"):t>k?(t/k).toLocaleString(i.get(),{minimumFractionDigits:1,maximumFractionDigits:1})+" TB":t>A?(t/A).toLocaleString(i.get(),{minimumFractionDigits:1,maximumFractionDigits:1})+" GB":(t/O).toLocaleString(i.get(),{minimumFractionDigits:1,maximumFractionDigits:1})+" MB":e.getString("ProvisioningUiLib","ProductDetailsPage.unknown")}function C(){var t=M.flatDeploymentSize,i=P(t)+" "+e.getString("ProvisioningUiLib","ProductDetailsPage.thickProvisionedString");return i}function D(){var t=M.sparseDeploymentSize,i=P(t)+" "+e.getString("ProvisioningUiLib","ProductDetailsPage.thinProvisionedString");return i}function w(e){var t=e?M.sparseDeploymentSize:M.flatDeploymentSize;return P(t)}function b(){return M.extraConfigs}function I(e){E(),_.each(e,function(e){e&&("com.vmware.vcenter.ovf.NameAndProductParams"===e._type?(M.productName=e.productName,M.version=e.version,M.fullVersion=e.fullVersion,M.vendor=e.vendor,M.vApp=e.virtualApp,M.productUri=e.productUrl,M.vendorUri=e.vendorUrl,M.description=e.annotation):"com.vmware.vcenter.ovf.SizeParams"===e._type?(M.downloadSize=e.approximateDownloadSize,M.flatDeploymentSize=e.approximateFlatDeploymentSize,M.sparseDeploymentSize=e.approximateSparseDeploymentSize):"com.vmware.vcenter.ovf.CertificateParams"===e._type?(M.isCertPresent=!0,M.isCertValid=e.isValid,M.issuer=V(e.issuer),M.isSelfSigned=e.isSelfSigned,M.subject=e.subject,M.x509=e.x509):"com.vmware.vcenter.ovf.ExtraConfigParams"===e._type&&(M.extraConfigs=e.extraConfigs))})}function T(e,t){var i=_.find(t,function(e){return e&&"com.vmware.vcenter.ovf.NameAndProductParams"===e._type});i&&(i.name=e)}function E(){M.productName=null,M.version=null,M.fullVersion=null,M.vendor=null,M.vApp=null,M.vendorUri=null,M.productUrl=null,M.description=null,M.downloadSize=-1,M.flatDeploymentSize=-1,M.sparseDeploymentSize=-1,M.isCertPresent=!1,M.isCertValid=!1,M.isSelfSigned=!1,M.issuer=null,M.subject=null,M.x509=null}function V(e){if(_.isEmpty(e))return"";var t=null,i=null,r=e.split("/");return _.each(r,function(e){if(!_.isEmpty(e)){var r=e;0===r.toUpperCase().indexOf("CN=")?t=e.substr(3):0===r.toUpperCase().indexOf("O=")&&(i=e.substr(2))}}),t||i}var M=this,O=1048576,A=1024*O,k=1024*A;return{initProductDetails:I,onCertClicked:r,getPublisher:o,getCertTrust:a,hasCert:n,getDownloadSize:y,getSizeOnDiskThick:C,getSizeOnDiskThin:D,getSizeOnDisk:w,getProductName:v,getVersion:g,hasProduct:u,getProductUri:f,getVendor:m,getVendorUri:h,getDescription:S,hasVendor:d,hasVersion:l,hasVendorUri:s,hasProductUri:c,hasDescription:p,updateVmNameToDeploy:T,getExtraConfigs:b}}angular.module("com.vmware.vsphere.client.vm").factory("vmProvisioningProductDetailsDataModel",e),e.$inject=["i18nService","fileSaverService","browserLanguage"]}(),function(){"use strict";function e(e){return function(e){var t={isReady:!1},i={};return{form:t,dataModel:i,validatePage:function(){},submitPage:function(){return{invalidateNextPages:!1,wizardFlow:e.getCreationType()}},pageFinishedLoading:function(){return t.isReady}}}}angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningProductDetailsPageModel",e),e.$inject=["$q"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningProductDetailsPageService",["i18nService","wizardPageService","vmVuiWizardPageBuilder","vmProvisioningProductDetailsPageModel",function(e,t,i,r){return{build:function(t,n,o){var a=new r(t.vmParams,t.wizardViewData,t.config,n,o);return t.productDetailsPageModel=a,i.buildVuiWizardPage(t.config,{title:e.getString("ProvisioningUiLib","ProductDetailsPage.title"),description:e.getString("ProvisioningUiLib","ProductDetailsPage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningProductDetails/vm-provisioning-product-details.html",model:a})}}}]);var h5_vm;!function(e){var t=function(){function e(e){return function(t,r){return new i(e,t,r)}}return e.$inject=["i18nService"],e}(),i=function(){function e(e,t,i){this.i18nService=e,this.virtualMachineSpecBuilderObj=i,this.wizardViewDataObj=t}return Object.defineProperty(e.prototype,"wizardViewData",{get:function(){return this.wizardViewDataObj},enumerable:!0,configurable:!0}),e.prototype.resetForm=function(){},e.prototype.validatePage=function(){for(var e=this.wizardViewDataObj.getSclaeoutConfigurationFromLibraryCommonContext(),t="",i=0,r=e.groups;i<r.length;i++){var n=r[i];if(_.isUndefined(n.instanceCount)||_.isNull(n.instanceCount)?t=this.i18nService.getString("ProvisioningUiLib","ScaleoutPage.validator.required"):!_.isUndefined(n.minimumInstanceCount)&&!_.isNull(n.minimumInstanceCount)&&n.instanceCount<n.minimumInstanceCount?t=this.i18nService.getString("ProvisioningUiLib","ScaleoutPage.validator.lessThanMinError"):!_.isUndefined(n.maximumInstanceCount)&&!_.isNull(n.maximumInstanceCount)&&n.instanceCount>n.maximumInstanceCount&&(t=this.i18nService.getString("ProvisioningUiLib","ScaleoutPage.validator.greaterThanMaxError")),t.length>0)break}return t.length>0?{error:t}:{}},e.prototype.submitPage=function(e){return{wizardFlow:this.virtualMachineSpecBuilderObj.getCreationType(),invalidateNextPages:!1}},e.$inject=["i18nService"],e}();e.VmProvisioningScaleoutConfigurationPageModel=i,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningScaleoutConfigurationPageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.vuiConstants=t,this.wizardPageService=i,this.vmVuiWizardPageBuilder=r,this.vmProvisioningScaleoutConfigurationPageModel=n}return e.prototype.build=function(e,t,i,r){var n=new this.vmProvisioningScaleoutConfigurationPageModel(e.wizardViewData,e.vmParams);return e.vmProvisioningScaleoutConfigurationPageModel=n,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","ScaleoutPage.title"),description:this.i18nService.getString("ProvisioningUiLib","ScaleoutPage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningScaleoutConfiguration/vm-provisioning-scaleout-configuration-page.html",model:n,defaultState:this.vuiConstants.wizard.pageState.SKIPPED})},e.$inject=["i18nService","vuiConstants","wizardPageService","vmVuiWizardPageBuilder","vmProvisioningScaleoutConfigurationPageModel"],e}();e.VmProvisioningScaleoutConfigurationPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningScaleoutConfigurationPageService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectCreationTypePageService",["i18nService","wizardPageService",function(e,t){return{build:function(i,r){return{title:e.getString("VmUi","SelectCreationTypeProvisioningPage.Title"),description:e.getString("VmUi","SelectCreationTypeProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningSelectCreationType.html",decisionOptions:{flowIds:r},onCommit:function(){return t.markPageComplete(i.config,i.attributes.creationType),!0}}}}}]),function(){"use strict";function e(e,t,i,r,n){return function(e,t,o,a,s){function c(e){if(_.isEmpty(e))return null;var t=e;return t.toLowerCase().endsWith(".ovf")||t.toLowerCase().endsWith(".ova")?t.split("/").pop():null}function l(e){if(!_.isEmpty(e)){var t=e.split(".").pop();if(t&&t.length>0)return e.substr(0,e.length-t.length-1)}return null}var d={isValid:!1,isLocalDeployment:!1,userSelectedFiles:[],ovfUrl:null,vmName:null,hasAcceptedUntrustedSource:!1};return{form:d,getContextObjId:function(){return t.getSourceObjectId()},validatePage:function(){return!_.isEmpty(d.ovfUrl)},submitPage:function(){if(d.isLocalDeployment){var o=n.get("vscOvfWorkflowProxyService"),a=o.getNewSession(d.userSelectedFiles);e.setName(a.templateName),e.setTemplateName(a.templateName),t.setDeployOvfSession(a),t.setTemplateSourceType(r.SOURCE_TYPE_PUSH)}else{var s=c(d.ovfUrl),u=l(s);e.setName(u),e.setTemplateName(u),t.setUrlTemplate(d.ovfUrl),t.setTemplateSourceType(r.SOURCE_TYPE_PULL),t.setSslThumbprint(d.sslThumbprint)}return e.setCreationType(i.DEPLOY_VM_FROM_OVF),{invalidateNextPages:!1,wizardFlow:e.getCreationType()}},pageFinishedLoading:function(){return d.isValid}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningSelectOvfPageModel",e),e.$inject=["$q","i18nService","creationTypeConstants","sourceTypeConstants","$injector"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectOvfPageService",["i18nService","wizardPageService","vmVuiWizardPageBuilder","VmProvisioningSelectOvfPageModel",function(e,t,i,r){return{build:function(t,n,o){var a=new r(t.vmParams,t.wizardViewData,t.config,n,o);return t.deployOvfSelectPageModel=a,i.buildVuiWizardPage(t.config,{title:e.getString("VmUi","SelectOvfProvisioningPage.Title"),description:e.getString("VmUi","SelectOvfProvisioningPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningSelectOvf/vm-provisioning-select-ovf-page.html",model:a})}}}]),function(){"use strict";function e(e,t,i,r,n,o,a,s){return function(c,l,d){function u(e){m=!0;for(var t=0;t<e.length;t++)if(!e[t]){m=!1;break}if(m)return null;var i=p(c.getCreationType());return i}function p(e){var i="SelectTemplateProvisioningPage.Vm.NoPermission."+v(e);return t.getString("VmUi",i)}function v(e){var t;return e===o.CLONE_VM_TO_TEMPLATE?t="CreateTemplateFromVM":e===o.CLONE_VM_TO_VM&&(t="Clone"),"VirtualMachine.Provisioning."+t}var m,g,h="config/guestId",f="config.vAppConfig.property",S="runtime/connectionState",y={};return{form:y,validateSelection:function(){var o=c.getVmId(),s=i.getPartsFromVsphereObjectId(o).type,d=v(c.getCreationType());return s===a.VIRTUAL_MACHINE?e.all({properties:r.getProperties(o,[S,h,f]),privileges:n.checkPrivileges(o,[d])}).then(function(e){return l.setVmConnectedState(e.properties[S]),c.setGuestOsId(e.properties[h]),c.setVappPropertyDescriptors(e.properties[f]),"connected"!==e.properties[S]?t.getString("VmUi","SelectTemplateProvisioningPage.Vm.InvalidState"):u(e.privileges)}):e.resolve(null)},validatePage:function(){return"VirtualMachine"!==i.getPartsFromVsphereObjectId(c.getVmId()).type?e.resolve({error:t.getString("VmUi","SelectTemplateProvisioningPage.Vm.SelectValidEntity")}):"connected"!==l.getVmConnectedState()?e.resolve({error:t.getString("VmUi","SelectTemplateProvisioningPage.Vm.InvalidState")}):m?void 0:e.resolve({error:p(c.getCreationType())})},submitPage:function(){g&&d.title.indexOf(g)!==-1||(g=d.title),d.title=l.getSourceObjectName()+" - "+g;var e=d.pages,i=d.flows;if(i&&i.length>0){var r=_.find(i,function(e){return c.getCreationType()===e.id}.bind(this));r&&(e=r.pages)}return c.hasConfigurableVappProperties()?s.markPageDisabled(e,t.getString("VmUi","VAppPropertiesProvisioningPage.title")):s.markPageSkipped(e,t.getString("VmUi","VAppPropertiesProvisioningPage.title")),{wizardFlow:c.getCreationType(),invalidateNextPages:!1}}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningSelectVmToClonePageModel",e),e.$inject=["$q","i18nService","defaultUriSchemeUtil","dataService","authorizationService","creationTypeConstants","managedEntityConstants","wizardPageService"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectVmToClonePageService",["i18nService","defaultUriSchemeUtil","wizardPageService","vmVuiWizardPageBuilder","VmProvisioningSelectVmToClonePageModel",function(e,t,i,r,n){return{build:function(t){var i=new n(t.vmParams,t.wizardViewData,t.config);return t.selectVmToClonePageModel=i,r.buildVuiWizardPage(t.config,{title:e.getString("VmUi","SelectTemplateProvisioningPage.Vm.Title"),description:e.getString("VmUi","SelectTemplateProvisioningPage.Vm.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningSelectVmToClone.html",model:i})}}}]),function(){"use strict";function e(e,t,i,r,n){return function(o){function a(e,t,i){var r=c.vmVersion?c.vmVersion.id:null,n=r||e;c.vmVersion=null,n&&(c.vmVersion=_.find(t,function(e){return e.id===n})),c.vmVersion||_.each(i,function(e){e.defaultConfigOption&&(c.vmVersion=_.find(t,function(t){return t.id===e.key}))}),c.vmVersion||(c.vmVersion=t[t.length-1])}var s=null,c={invalidateNextPages:!1,compatibility:function(e){var t=this.vmParams.getGosVersion();e&&(c.vmVersion=e),t&&(this.setLoading(!0),o.queryConfigOptionByPool(c.vmVersion.id).then(function(e){var i=e.vmConfigOptionByPool,r=i.guestOSDescriptor,n=_.find(r,function(e){return e.id===t.id});this.invalidateNextPages=!1,n||(this.invalidateNextPages=!0),this.setLoading(!1)}.bind(this)))}};return{form:c,resetForm:function(){var n=o.getComputeResourceId(),l=o.getVmVersion(),d=o.getScheduledVmVersion();if(d&&o.setScheduledVmVersion(null),s!==n)l=c.vmVersion=null,o.setVmVersion(null);else if(!_.isEmpty(c.supportedVersions))return a(l,c.supportedVersions),t.when();var u="optionDescriptorsWithCreateSupported",p=o.getTargetInformation(),v={optionDescriptorsData:e.getProperties(n,u),is65VcOrLater:i.is65VcOrLater(p.datacenterUid)};return t.all(v).then(function(e){var t=e.optionDescriptorsData;c.is65VcOrLater=e.is65VcOrLater,s=n,c.supportedVersions=r.buildVmVersions(t.optionDescriptorsWithCreateSupported,c.is65VcOrLater),a(l||d,c.supportedVersions,t.optionDescriptorsWithCreateSupported),c.compatibility(c.vmVersion)})},validatePage:function(){return c.vmVersion?null:{error:n.getString("VmUi","SelectVmVersionPage.pageValidationError"),invalidateNextPages:!1,wizardFlow:o.getCreationType()}},submitPage:function(){o.setVmVersion(c.vmVersion.id);const e=o.getScheduledData();return _.isEmpty(e)||e.spec.version!==c.vmVersion.id&&(e.useScheduledTaskData=!1),{wizardFlow:o.getCreationType(),invalidateNextPages:c.invalidateNextPages}}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningSelectVmVersionPageModel",e),e.$inject=["dataService","$q","vcService","vmHardwareCompatibilityService","i18nService"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningSelectVmVersionPageService",["i18nService","wizardPageService","vmVuiWizardPageBuilder","VmProvisioningSelectVmVersionPageModel",function(e,t,i,r){return{build:function(t){var n=new r(t.vmParams,t.wizardViewData);return t.selectVmVersionPageModel=n,i.buildVuiWizardPage(t.config,{title:e.getString("VmUi","SelectVmVersionPage.Title"),description:e.getString("VmUi","SelectVmVersionPage.Description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningVmVersion.html",model:n})}}}]),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e){return e.alerts=0,e.expanded||(_.each(e.ipv4.errors,function(t){t&&(e.alerts+=1)}),_.each(e.ipv6.errors,function(t){t&&(e.alerts+=1)})),e.alerts}function c(e){var i={};i.columnDefinitions=[{displayName:t.getString("VmUi","CustomizationParametersPageBase.nic.ipv6.gateway"),type:"string"}],i.data=e.gateway,i.deleteLabel=t.getString("VmUi","CustomizationParametersPageBase.nic.delete.label"),i.deleteTooltip=t.getString("VmUi","CustomizationParametersPageBase.nic.delete.tooltip"),i.onDelete=function(t){l(t,e)},i.placeholder=t.getString("VmUi","CustomizationParametersPageBase.noGateways"),i.gridLabel=t.getString("VmUi","CustomizationParametersPageBase.ipv6GatewaysDescription"),e.gridGatewaysOptions=i}function l(e,t){if(e){var i=_.findIndex(t.gateway,function(t){return t===e});i<0||t.gateway.splice(i,1)}}return function(l,d){var u,p={nics:[]},v=[];return{form:p,resetForm:function(){var e=function(){u=d.getCustomizationSpecName(),p.hasNicsToCustomize=!1,v=angular.extend([],d.getNICsToCustomize()),p.nics=v,_.each(p.nics,function(e){e.expanded=!1,e.ipv4.errors={},e.ipv6.errors={},e.ipv6.required&&(c(e.ipv6),p.hasNicsToCustomize=!0),e.ipv4.required&&(p.hasNicsToCustomize=!0)}.bind(this)),d.getNeedToInputComputerName()?p.computerName={name:""}:p.computerName=void 0;var e=15,t=63,i=d.getGuestOsType();"Windows"===i?p.pcNameMaxLength=e:p.pcNameMaxLength=t},t=d.getCustomizationSpecName()!==u;if(t)return void e();var i=l.getVmId();l.getCreationType()===o.DEPLOY_VM_FROM_TEMPLATE&&(i="urn:vmomi:VirtualMachine:template:"+a.getPartsFromVsphereObjectId(d.getVCenterId()).serverGuid),n.validate(i,l.getName(),d.getCustomizationSpecName()).then(function(t){d.setCustomizationSpecName(t.specName),d.setNICsToCustomize(t.nicsToCustomize),d.setNeedToInputComputerName(t.needsComputerName);var i=!!p.computerName,r=d.getNeedToInputComputerName()!==i,n=_.any(d.getNICsToCustomize(),function(e,t){return e.ipv4.required!==v[t].ipv4.required||e.ipv6.required!==v[t].ipv6.required});r=r||n,r&&e()})},validateComputerName:function(){var e=i.validateComputerName(p.pcNameMaxLength,p.computerName.name);p.computerName.invalid=!1,_.isEmpty(e)||(p.computerName.invalid=!0,p.computerName.error=e[0])},hasAlerts:s,validatePage:function(){var i=d.getNeedToInputComputerName(),n=!1;return i&&(this.validateComputerName(),n=p.computerName.invalid),_.each(p.nics,function(e){var t=r.validate(e);e.ipv4.errors.addressInvalid=t.errors.ipv4.address,e.ipv4.errors.subnetMaskInvalid=t.errors.ipv4.subnetMask,e.ipv4.errors.defaultGatewayInvalid=t.errors.ipv4.defaultGateway,e.ipv4.errors.alternateGatewayInvalid=t.errors.ipv4.alternateGateway,e.ipv6.errors.addressInvalid=t.errors.ipv6.address,e.ipv6.errors.subnetPrefixLengthInvalid=t.errors.ipv6.subnetPrefixLength,s(e),n=n||_.any(t.errors,_.negate(_.isEmpty))}),n?e.resolve({error:t.getString("VmUi","UserSettingsPage.validation_error")}):e.resolve(null)},submitPage:function(){var e=d.getNeedToInputComputerName();return e&&l.setCustomPcName(p.computerName.name),_.each(p.nics,function(e,t){e.ipv4.required&&l.setCustomIpv4ForNIC(t,e),e.ipv6.required&&l.setCustomIpv6ForNIC(t,e)}),{wizardFlow:l.getCreationType(),invalidateNextPages:!1}}}}}angular.module("com.vmware.vsphere.client.vm").service("VmProvisioningUserSettingsPageModel",e),e.$inject=["$q","i18nService","gosComputerNameValidationService","nicValidatorService","guestOsCustomizationSpecValidator","creationTypeConstants","defaultUriSchemeUtil"]}(),angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningUserSettingsPageService",["i18nService","vuiConstants","ipParserService","wizardPageService","vmVuiWizardPageBuilder","VmProvisioningUserSettingsPageModel",function(e,t,i,r,n,o){return{build:function(i){var r=o(i.vmParams,i.wizardViewData);return i.userSettingsPageModel=r,n.buildVuiWizardPage(i.config,{title:e.getString("VmUi","UserSettingsPage.Title"),description:e.getString("VmUi","customizeGuestOs.parametersPage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/vmProvisioningUserSettings.html",defaultState:t.wizard.pageState.SKIPPED,model:r})}}}]);var h5_vm;!function(e){var t=function(){function e(e){return function(t,r){return new i(e,t,r)}}return e.$inject=["i18nService"],e}(),i=function(){function e(e,t,i){this.i18nService=e,this.wizardViewData=t,this.virtualMachineSpecBuilderObj=i,this.formObj={}}return Object.defineProperty(e.prototype,"form",{get:function(){return this.formObj},enumerable:!0,configurable:!0}),e.prototype.validatePage=function(){return this.validateProviderStatus()?{}:{error:this.i18nService.getString("ProvisioningUiLib","VServicePage.errorInvalidBindings")}},e.prototype.submitPage=function(){return{wizardFlow:this.virtualMachineSpecBuilderObj.getCreationType(),invalidateNextPages:!1}},e.prototype.resetForm=function(){},e.prototype.validateProviderStatus=function(){var e=!0,t=this.wizardViewData.getVserviceContextFromLibraryCommonContext();return t&&t.dependencies&&t.dependencies.forEach(function(t){if(!(t.availableProviders&&t.availableProviders.length>0))return void(e=!1);var i=t.selectedProviderKey;if(!i)return void(e=!1);var r=t.availableProviders.find(function(e){return e.key===i});return"red"===r.status.name?void(e=!1):void 0}),e},e.$inject=["i18nService"],e}();e.VmProvisioningVservicePageModel=i,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningVservicePageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.vuiConstants=t,this.wizardPageService=i,this.vmVuiWizardPageBuilder=r,this.vmProvisioningVservicePageModel=n}return e.prototype.build=function(e,t,i){var r=new this.vmProvisioningVservicePageModel(e.wizardViewData,e.vmParams);return e.vmProvisioningScaleoutConfigurationPageModel=r,this.vmVuiWizardPageBuilder.buildVuiWizardPage(e.config,{title:this.i18nService.getString("ProvisioningUiLib","VServicePage.title"),description:this.i18nService.getString("ProvisioningUiLib","VServicePage.description"),contentUrl:"vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningVservice/vm-provisioning-vservice-page.html",model:r,defaultState:this.vuiConstants.wizard.pageState.SKIPPED})},e.$inject=["i18nService","vuiConstants","wizardPageService","vmVuiWizardPageBuilder","vmProvisioningVservicePageModel"],e}();e.VmProvisioningVservicePageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningVservicePageService",t)}(h5_vm||(h5_vm={})),function(){angular.module("com.vmware.vsphere.client.vm").constant("vmTypeConstants",{VIRTUAL_MACHINE:"vm",TEMPLATE:"template"})}(),angular.module("com.vmware.vsphere.client.vm").service("vmWizardService",[function(){function e(e){e.validationBanner.messages=[]}return{hideErrors:e}}]),angular.module("com.vmware.vsphere.client.vm").service("datastoreFaultsDialogService",["clarityModalService","i18nService","$rootScope",function(e,t,i){function r(i,r){var n={contentTemplate:"vm-ui/resources/vm/views/createVmWizard/datastoreRecommendations/vmProvisioningDatastoreFaults.html",title:t.getString("VmUi","dsRecommendation.FaultsTitle"),size:"lg",hideSubmitButton:!0,closeButtonTitle:t.getString("Common","saveButtonLabel"),defaultButton:"close",dialogData:{faults:r}};e.openOkCancelModal(n)}return{openDialog:r}}]),function(){"use strict";function e(e,t,i,r){function n(e,i){return{dataBound:i?s(i):a,columnDefs:[{displayName:l("RecommendationsList.recommendationColumnHeaderText"),template:kendo.template("#:reasonText#<ul class='datastore-recommendation-column'>   # for (var i = 0; i < actions.length; i++) { #     <li ng-non-bindable>         <span class=#:actions[i].icon#></span>         <span>#:actions[i].text#</span>     </li>   # } # </ul>"),field:"reasonText",width:"80%"},{displayName:l("dsRecommendation.spaceUtilDstBeforeColumnHeaderLabel"),field:"spaceUtilBefore",
width:125,template:"<ul class='datastore-recommendation-usage-column'>   # for (var i = 0; i < actions.length; i++) { #     <li>#:actions[i].spaceUtilBefore#</li>   # } # </ul>"},{displayName:l("dsRecommendation.spaceUtilDstAfterColumnHeaderLabel"),field:"spaceUtilAfter",width:125,template:"<ul class='datastore-recommendation-usage-column'>   # for (var i = 0; i < actions.length; i++) { #     <li>#:actions[i].spaceUtilAfter#</li>   # } # </ul>"},{displayName:l("dsRecommendation.ioLatencyDstBeforeColumnHeaderLabel"),field:"ioLatencyBefore",width:125,template:"<ul class='datastore-recommendation-usage-column'>   # for (var i = 0; i < actions.length; i++) { #     <li>#:actions[i].ioLatencyBefore#</li>   # } # </ul>"}],sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.SINGLE,selectedItems:[],data:c(e),resizable:!0,searchable:!1,height:350}}function o(e,t){var n=t.newVmName,o=t.possibleDatastores,a=_.sortBy(e,function(e){return e.relocateSpec.disk?e.relocateSpec.disk.diskId:0});return _.map(a,function(e,t){var a,s,c=e.destination,d=o[i.getVsphereObjectId(c)];if(e.relocateSpec.disk){var u='"'+l("VmDeviceManager.NewHardDisk")+" "+t+'"';a=l("dsRecommendation.storagePlacementActionHD",'"'+n+'"',u,'"'+d+'"'),s="vx-icon-vmDisk"}else a=l("dsRecommendation.storagePlacementActionCF",'"'+n+'"','"'+d+'"'),s="vx-icon-vmSecondaryFT";var p={fractionSize:1,trimTrailingZeros:!0};return{icon:s,text:a,spaceUtilBefore:r.format(e.spaceUtilBefore,p),spaceUtilAfter:r.format(e.spaceUtilAfter,p),ioLatencyBefore:r.format(e.ioLatencyBefore,p),destination:e.destination}})}function a(){var e=$("#recommendations > div").data("kendoGrid");e&&e.select("tr:first")}function s(e){return function(){var t="tr:contains('"+e.reasonText+"')",i=$("#recommendations > div").data("kendoGrid");i&&i.select(t)}}function c(e){var t=e.recommendations;return _.map(t,function(t,i){var r=o(t.action,e);return{reasonText:l("dsRecommendation.recommendationText",i+1,t.reasonText),actions:r,spec:t,spaceUtilBefore:2,spaceUtilAfter:2,ioLatencyBefore:2,key:t.key}})}var l=e.getString.bind(e,"VmUi");return{getDatagridOptions:n}}angular.module("com.vmware.vsphere.client.vm").factory("datastoreRecommendationsDatagridOptionsService",e),e.$inject=["i18nService","vuiConstants","defaultUriSchemeUtil","numberFormatterService"]}(),function(){"use strict";function e(e,t,i){function r(r,n,o,a){var s=t.defer(),c={contentTemplate:"vm-ui/resources/vm/views/createVmWizard/datastoreRecommendations/vmProvisioningDatastoreRecommendations.html",title:i.getString("VmUi","dsRecommendation.title"),size:"lg",dialogData:{selection:o,recommendations:r,newVmName:a,possibleDatastores:n,descriptionText:i.getString("VmUi","dsRecommendation.header")},onSubmit:function(){return this.dialogData.selection?(s.resolve({recommendationSpec:this.dialogData.selection.recommendationSpec}),!0):void s.reject()},onCancel:function(){s.reject()},defaultButton:"submit",submitButtonTitle:i.getString("VmUi","dsRecommendation.apply")};return e.openOkCancelModal(c),s.promise}return{openDialog:r}}angular.module("com.vmware.vsphere.client.vm").service("datastoreRecommendationsDialogService",e),e.$inject=["clarityModalService","$q","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(r,n){if(!r||!n||!r.podSelectionSpec)return null;var o,a=!1;switch(n){case"com.vmware.vsphere.client.vm.VmCloneSpec":case"com.vmware.vsphere.client.vm.VmConfigSpec":a=!!r.vm,o=i.getVsphereObjectId(r.vm);break;case"com.vmware.vsphere.client.vm.VmCreateSpec":a=!!r.pool,o=i.getVsphereObjectId(r.pool)}return a?e.validate(o,n,r).then(function(e){if(e.result)return{recommendations:e.result.recommendations,faults:f(e.result.drsFault)};var i=t.getString("VmUi","SdrsRecommendations.faults.generic"),r="",n=e.error;return n&&("vim.fault.NoCompatibleDatastore"===n.message?r=t.getString("VmUi","SdrsRecommendations.faults.noCompatibleDatastore"):(r=n.localizedMessage||n.message,!r&&n.cause&&(r=n.cause.localizedMessage||n.cause.message))),{faults:[{message:r||i}]}}):null}function s(e){if(!e||0===e.length)return null;var t=p(e);return t?t:null}function c(e){var t=s(e);if(!t)return null;var i=S([t]);return{topRecommendation:t,topRecommendedDatastorePerDisk:i,topRecommendedDatastoreForVmx:m(t)}}function l(e,t,n){var o=null,a=y(e,n);if(a.length>0){var s=i.getVsphereObjectId(a[0].target);o=n.getSelectedRecommendation(s)}return r.openDialog(a,t.wizardViewData.getStorageNameMap(),o,n.getVmName()).then(function(e){n.setSelectedRecommendation(e.recommendationSpec.spec)})}function d(e,t){return r.openDialog(t,e.storageNameMap,null,e.vmName)}function u(e,t){n.openDialog(e,t)}function p(e){var t=_.max(e,function(e){var t=g(e);return t?e.rating:-1});return t}function v(e){var t={};return angular.forEach(e.action,function(e){h(e)&&e.relocateSpec.disk&&angular.forEach(e.relocateSpec.disk,function(i){t[i.diskId]=e.destination})}),t}function m(e){var t=_.find(e.action,function(e){return h(e)&&!e.relocateSpec.disk})||{};return t.destination}function g(e){var t=_.find(e.action,function(e){return h(e)});return angular.isDefined(t)}function h(e){return e._type.indexOf("StoragePlacementAction")>-1}function f(e){return e?_.map(e.faultsByVm[0].fault,function(e){return{message:e.localizedMessage}}):null}function S(e){if(!e||0===e.length)return null;var t=p(e);return t?v(t):null}function y(e,t){var i=[];return angular.forEach(t.form.recommendationsPerPod,function(t){angular.forEach(t.recommendations,function(t){P(e,t.action)&&i.push(t)})}),i}function P(e,t){var i=_.find(t,function(t){var i=!1;return angular.isDefined(e)||t.relocateSpec.disk?t.relocateSpec.disk&&(i=angular.isDefined(_.find(t.relocateSpec.disk,function(t){return e===t.diskId}))):i=!0,i});return angular.isDefined(i)}function C(e){var t;return e&&(t=e.storageRef.type===o.STORAGE_POD||e.parentStoragePod&&e.parentStoragePod.isSdrsEnabled),!!t}return{getPlacementRecommendations:a,findTopRecommendation:s,findTopRecommendationInfo:c,openRecommendationsDialog:l,openRecommendationsDialogDirect:d,openFaultsDialog:u,areRecommendationsAvailableForStorageObject:C}}angular.module("com.vmware.vsphere.client.vm").service("datastoreRecommendationService",e),e.$inject=["mutationService","i18nService","defaultUriSchemeUtil","datastoreRecommendationsDialogService","datastoreFaultsDialogService","managedEntityConstants"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.$q=e,this.dataServiceUtil=t,this.defaultUriSchemeUtil=i,this.podSelectionSpecService=r,this.datastoreRecommendationService=n,this.managedEntityConstants=o,this.pmemUtilService=a,this.storageInfoMapForDisksWithBacking={},this.newDisksWithEmptyStorage=[]}return e.prototype.shouldCheckRecommendations=function(e,t){var i=this;this.buildStorageInfoMap(t);var r=_.find(this.newDisks,function(e){if(i.storageInfoMapForDisksWithBacking&&i.storageInfoMapForDisksWithBacking[e.key]){var t=i.storageInfoMapForDisksWithBacking[e.key].dsObject;return i.datastoreRecommendationService.areRecommendationsAvailableForStorageObject(t)}});return!_.isUndefined(r)||!!(this.newDisksWithEmptyStorage.length>0&&this.datastoreRecommendationService.areRecommendationsAvailableForStorageObject(e))},e.prototype.getRecommendations=function(e,t,i,r,n,o,a,s){var c=this;_.isEmpty(this.storageInfoMapForDisksWithBacking)&&this.buildStorageInfoMap(i);var l=this.podSelectionSpecService.createSpec(this.newDisks,t,this.storageInfoMapForDisksWithBacking);l.storagePod=null;var d={originalConfig:r,config:n,cpuFeatureMask:o,deviceChange:i.getFinalChanges(),podSelectionSpec:l,vm:this.defaultUriSchemeUtil.getManagedObjectReference(e)},u={vmName:n.name,datastoreName:null,selectedRecommendation:null,storageNameMap:{}};this.datastoreRecommendationService.getPlacementRecommendations(d,"com.vmware.vsphere.client.vm.VmConfigSpec").then(function(e){return _.isEmpty(e.faults)?e.recommendations&&e.recommendations.length>0?c.buildStorageNameMap(e.recommendations):{storageNameMap:null,recommendations:null}:c.$q.reject(e.faults)}).then(function(e){return e.recommendations?(u.storageNameMap=e.storageNameMap,c.datastoreRecommendationService.openRecommendationsDialogDirect(u,e.recommendations)):void 0}).then(function(e){a(e)},function(e){s(e)})},e.prototype.buildStorageNameMap=function(e){var t=this,i={};_.forEach(e,function(e){i[t.defaultUriSchemeUtil.getVsphereObjectId(e.target)]="",_.forEach(e.action,function(e){i[t.defaultUriSchemeUtil.getVsphereObjectId(e.destination)]=""})});var r=Object.keys(i);return this.dataServiceUtil.getPropertiesForObjects(r,["name"],{}).then(function(t){return _.forEach(r,function(e){i[e]=t[e].name}),{storageNameMap:i,recommendations:e}})},e.prototype.buildStorageInfoMap=function(e){var t=this;this.newDisks=_.map(e.newDevicesOfType("VirtualDisk"),function(e){return e.getCurrentDevice()}),this.newDisks=_.filter(this.newDisks,function(e){return!t.pmemUtilService.isPmemDisk(e)&&!e.createdFromExistingDisk}),this.storageInfoMapForDisksWithBacking={},this.newDisksWithEmptyStorage=[],_.each(this.newDisks,function(e){e.backing.datastore?t.storageInfoMapForDisksWithBacking[e.key]={diskKey:e.key,diskBacking:e.backing,dsId:e.backing.datastore.id,dsName:e.backing.datastore.name,dsObject:{parentStoragePod:e.backing.parentStoragePod,storageRef:e.backing.datastore,name:e.deviceInfo.label,capacity:e.capacityInBytes,drsEnabled:e.backing.datastore.isSdrsEnabled}}:e.key<0&&t.newDisksWithEmptyStorage.push(e)})},e.$inject=["$q","dataServiceUtil","defaultUriSchemeUtil","podSelectionSpecService","datastoreRecommendationService","managedEntityConstants","pmemUtilService"],e}();e.VmEditSettingsDatastoreRecommendationService=t,angular.module("com.vmware.vsphere.client.vm").service("vmEditSettingsDatastoreRecommendationService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualDisk$LocalPMemBackingInfo,i=com.vmware.vsphere.client.vm.migration.LocationSpec,r=com.vmware.vim.binding.vim.vm.RelocateSpec,n=com.vmware.vsphere.client.vm.migration.LocationSpecPair,o=com.vmware.vsphere.client.h5.vm.model.migration.ComputeResourceTreePageSpec,a=com.vmware.vim.binding.vim.vm.RelocateSpec$DiskLocator,s=com.vmware.vim.binding.vim.vm.device.VirtualDeviceSpec,c=com.vmware.vim.binding.vim.vm.device.VirtualDisk,l=function(){function l(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g){this.mutationService=e,this.dataService=t,this.defaultUriSchemeUtil=i,this.$q=r,this.managedEntityConstants=n,this.logService=o,this.storageProfileService=a,this.diskFormatService=s,this.diskProvisioningService=c,this.i18nService=l,this.migrationTypeConstants=d,this.migrationHelperService=u,this.authorizationService=p,this.vmMigrateValidateComputeResourceStateBuilderFactory=v,this.pmemUtilService=m,this.vscSchedulingHelper=g,this._log=o("migrationService")}return l.prototype.fetchResourcePool=function(e){var t=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e);switch(t.type){case this.managedEntityConstants.CLUSTER:case this.managedEntityConstants.HOST:return this.dataService.getProperties(e,["resourcePool"]).then(function(e){return e.resourcePool});case this.managedEntityConstants.RESOURCE_POOL:case this.managedEntityConstants.V_APP:return this.$q.resolve(t);default:return this._log.warn("Unexpected resource type: "+t.type),this.$q.resolve(null)}},l.prototype.buildLocationSpec=function(e,t){var i=this,n=this,o={relocateSpec:new r};if(t.pool&&(o.relocateSpec.pool=n.toRef(t.pool)),t.computeResource){var a=n.toRef(t.computeResource);a.type===n.managedEntityConstants.HOST&&(o.relocateSpec.host=a)}t.destinationFolder&&(o.relocateSpec.folder=this.defaultUriSchemeUtil.getManagedObjectReference(t.destinationFolder)),t.networkMatches&&n.populateNetworkChanges(o.relocateSpec,_.filter(t.networkMatches,function(t){return e===n.toId(t.sourceVm)})),t.priority&&(o.priority=t.priority);var s=t.stretchedStorage?t.stretchedStorage[e]:t.virtualDisksByVm[e];return o.relocateSpec.disk=o.relocateSpec.disk||[],o.relocateSpec.deviceChange=o.relocateSpec.deviceChange||[],_.each(s,function(e){if("_configFile"===e.key)return e.storage&&(o.relocateSpec.datastore=n.toRef(e.storage)),void(e.profile&&(o.relocateSpec.profile=[n.storageProfileService.makeProfile(e.profile.id,e.replicationGroup)]));if(i.storageProfileService.isPmemStorageProfile(e.profile)){if(i.pmemUtilService.isPmemDisk(e.origin))return;var r=i.buildDeviceChange(e);return void o.relocateSpec.deviceChange.push(r)}var a=i.buildDiskLocator(t,e);o.relocateSpec.disk.push(a)}),n.trimEmptyProperties(o)},l.prototype.buildDeviceChange=function(e){var i=new s,r=new t;return r.diskMode="persistent",r.fileName="",i.operation="edit",i.device=new c,i.device.key=e.key,i.device.backing=r,i.profile=[this.storageProfileService.makeProfile(e.profile.id,e.replicationGroup)],i},l.prototype.buildDiskLocator=function(e,t){var i=new a;i.diskId=t.key,i.datastore=this.toRef(t.storage),t.profile&&(i.profile=[this.storageProfileService.makeProfile(t.profile.id,t.replicationGroup)]);var r=this.buildDiskFormatValue(t.diskFormat,e.diskFormat);return r&&(i.diskBackingInfo=this.diskProvisioningService.getBackingInfo(r)),i},l.prototype.buildDiskFormatValue=function(e,t){return e?"sameAsSource"!==e.value?e.value:null:t&&"sameAsSource"!==t.type?t.type:null},l.prototype.trimEmptyProperties=function(e){return 0===e.relocateSpec.disk.length&&delete e.relocateSpec.disk,0===e.relocateSpec.deviceChange.length&&delete e.relocateSpec.deviceChange,e},l.prototype.populateNetworkChanges=function(e,t){var i=this,r=[];_.forEach(t,function(e){var t=i.defaultUriSchemeUtil.getVsphereObjectId(e.sourceNetwork),n=i.defaultUriSchemeUtil.getVsphereObjectId(e.destinationNetwork);if(e.destinationNetwork&&t!==n){var o={_type:"com.vmware.vim.binding.vim.vm.device.VirtualDeviceSpec",operation:"edit",device:e.sourceAdapter};if(e.destinationNetwork.type===i.managedEntityConstants.NETWORK)o.device.backing={_type:"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$NetworkBackingInfo",deviceName:e.destinationNetworkName};else if(e.destinationNetwork.type===i.managedEntityConstants.DISTRIBUTED_VIRTUAL_PORTGROUP)o.device.backing={_type:"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$DistributedVirtualPortBackingInfo",port:{_type:"com.vmware.vim.binding.vim.dvs.PortConnection",portgroupKey:e.destinationPortgroupKey,switchUuid:e.destinationSwitchUuid}};else if(e.destinationNetwork.type===i.managedEntityConstants.OPAQUE_NETWORK){var a=e.sourceAdapter.backing;if(a&&"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$OpaqueNetworkBackingInfo"===a._type&&a.opaqueNetworkId===e.destinationOpaqueId&&a.opaqueNetworkType===e.destinationOpaqueType)return;o.device.backing={_type:"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$OpaqueNetworkBackingInfo",opaqueNetworkId:e.destinationOpaqueId,opaqueNetworkType:e.destinationOpaqueType}}r.push(o)}}),e.deviceChange?e.deviceChange=e.deviceChange.concat(r):e.deviceChange=r},l.prototype.getLocationSpecsForTesting=function(e){var t=this,i=["sourceTests","resourcePoolTests","datastoreTests","hostTests"];return t.createLocationSpecs(e,i)},l.prototype.getLocationSpecsForRecommendations=function(e){var t=this,i=["storagePodTests"];return t.createLocationSpecs(e,i)},l.prototype.createLocationSpecs=function(e,t){var i=this,r=[];return _.each(e.vms,function(o){var a=i.buildLocationSpec(o,e);a.testsToRun=t;var s=new n;s.entity=i.toRef(o),s.spec=a,r.push(s)}),r},l.prototype.getNetworkSpecsForTesting=function(e,t,i,r,n){var o=this,a=["sourceTests","resourcePoolTests","hostTests","networkTests"];return n===o.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE&&a.push("datastoreTests"),o.createNetworkSpecs(e,t,i,r,a)},l.prototype.createNetworkSpecs=function(t,i,r,n,o){var a=this,s=[],c=new e.MigrationWizardDataModel(t,r);return c.networkMatches=i,c.computeResource=n,_.forEach(t,function(e){var t=a.buildLocationSpec(e,c);t.testsToRun=o;var i={entity:a.defaultUriSchemeUtil.getManagedObjectReference(e),spec:t};s.push(i)}),s},l.prototype.validateComputeResource=function(t){var i=this,r=this.defaultUriSchemeUtil.getManagedObjectReference(t.computeResourceId),n=this.validateComputeResourceType(r);if(n)return n;var a=new o;return a.isXvcMigration=this.migrationHelperService.isXvcOperation(t.vmIds,t.computeResourceId),a.isHotMigration=t.isHotMigration,a.isBatchMigration=_.size(t.vmIds)>1,a.migrationType=t.selectedMode,a.vms=_.map(t.vmIds,function(e){return i.toRef(e)}),a.computeResource=r,a.fetchClusterName=_.isEmpty(t.clusterName),n=this.mutationService.validateSpec("com.vmware.vsphere.client.h5.vm.model.migration.ComputeResourceTreePageSpec",a).then(function(n){if(n.error)return{resourceRef:r,isValid:!1,validationResults:[n]};var o=["sourceTests","resourcePoolTests","hostTests"];t.isNetworkSelectionRequired||o.push("networkTests"),t.selectedMode===i.migrationTypeConstants.MIGRATE_RESOURCE_ONLY&&o.push("datastoreTests");var a=new e.MigrationWizardDataModel(t.vmIds,i.toId(n.result.resourcePoolRef));a.computeResource=t.computeResourceId;var s=i.createLocationSpecs(a,o);return i.mutationService.validateMultiSpec("com.vmware.vsphere.client.vm.migration.LocationSpecPair",s).then(function(e){var r=i.isValidationSuccessful(e);return i.vmMigrateValidateComputeResourceStateBuilderFactory.create().setComputeResource(t.computeResourceId).setData(n).setParams(t).setIsValid(r).setValidationResult(e).build()})})},l.prototype.validateComputeResourceType=function(e){switch(e.type){case this.managedEntityConstants.CLUSTER:case this.managedEntityConstants.HOST:case this.managedEntityConstants.RESOURCE_POOL:case this.managedEntityConstants.V_APP:return;default:return this.$q.resolve({resourceRef:e,isValid:!1,validationResults:[{entity:e,error:new Error(this.i18nService.getString("VmUi","MigrationWizard.resourceTreePage.error.no_selection"))}]})}},l.prototype.isValidationSuccessful=function(e){for(var t=0;t<e.length;t++){var i=e[t].error,r=_.any(e[t].result,function(e){return!e.error});if(i||!r)return!1}return!0},l.prototype.validateStorage=function(e){var t=this.getLocationSpecsForTesting(e),i=(new n)._type;return this.mutationService.validateMultiSpec(i,t)},l.prototype.validateNetwork=function(e,t,i,r,o){var a=this.getNetworkSpecsForTesting(e,t,i,r,o),s=(new n)._type;return this.mutationService.validateMultiSpec(s,a)},l.prototype.validateNetworkPrivilege=function(e){var t=this;if(_.isEmpty(e))return this.$q.when([]);var i=_.reduce(e,function(e,i){if(!i||!i.destinationNetwork)return e;if(i.sourceNetwork&&t.defaultUriSchemeUtil.compareIds(i.sourceNetwork,i.destinationNetwork))return e;var r=t.defaultUriSchemeUtil.getVsphereObjectId(i.destinationNetwork);return e[r]=i,e},{});if(_.isEmpty(i))return this.$q.when([]);var r=_.keys(i);return this.authorizationService.checkPrivilegesForMultipleObjects(r,["Network.Assign"]).then(function(e){return _.map(r,function(r){var n=e[r];return n&&!n["Network.Assign"]?{entity:r,error:{message:t.i18nService.getString("NetworkUi","AddNetworkingWizard.conTargetPage.noDvpgPrivilegeMessage",i[r].destinationNetworkName)}}:{entity:r}})})},l.prototype.migrate=function(e,t,r,n,o){var a=this,s=this;_.each(e,function(e){var c=s.buildLocationSpec(e,r);n&&a.applyXdrsRecommendation(n,c),o&&o.isScheduledTaskFlow?(o=a.createDataModelForScheduleTask(c,o),s.mutationService.apply(e,"com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec",o.mutationSpec)):s.mutationService.apply(e,(new i)._type,c,t)})},l.prototype.applyStorageRecommendations=function(e,t){return this.mutationService.add("com.vmware.vsphere.client.vm.storageDrs.VmRecommendationsSpec",{recommendations:_.pluck(e,"key"),moRef:t})},l.prototype.applyXdrsRecommendation=function(e,t){var i=this,r=e.action[0];t.relocateSpec.host=r.relocateSpec.host,t.relocateSpec.datastore=r.relocateSpec.datastore,r.relocateSpec.folder&&(t.relocateSpec.folder=r.relocateSpec.folder),r.relocateSpec.profile&&(t.relocateSpec.profile=r.relocateSpec.profile),_.isEmpty(r.relocateSpec.deviceChange)||(t.relocateSpec.deviceChange=r.relocateSpec.deviceChange),_.isEmpty(r.relocateSpec.disk)||_.each(r.relocateSpec.disk,function(e){var r=_.find(t.relocateSpec.disk,function(t){return t.diskId===e.diskId});i.updateDiskLocator(r,e)})},l.prototype.updateDiskLocator=function(e,t){e&&(t.datastore&&(e.datastore=t.datastore),t.profile&&(e.profile=t.profile),t.diskMoveType&&(e.diskMoveType=t.diskMoveType))},l.prototype.toRef=function(e){return e=e||"",vm_model.MoRef.fromUri(e)},l.prototype.toId=function(e){return this.defaultUriSchemeUtil.getVsphereObjectId(e)},l.prototype.createDataModelForScheduleTask=function(e,t){return t.mutationSpec.schedulingSpec.recurrence=this.vscSchedulingHelper.formatRecurrenceData(t.mutationSpec.schedulingSpec.recurrence),e._type="com.vmware.vsphere.client.vm.migration.LocationSpec",t.mutationSpec.spec=e,t},l.$inject=["mutationService","dataService","defaultUriSchemeUtil","$q","managedEntityConstants","logService","storageProfileService","diskFormatService","diskProvisioningService","i18nService","migrationTypeConstants","migrationHelperService","authorizationService","vmMigrateValidateComputeResourceStateBuilderFactory","pmemUtilService","vscSchedulingHelper"],l}();e.MigrationService=l,angular.module("com.vmware.vsphere.client.vm").service("migrationService",l)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.vms=[],this.vmNames={},this.virtualDisksByVm={},this.vms=e,this.pool=t}return e}();e.MigrationWizardDataModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D){var w=this;this.migrationService=t,this.i18nService=i,this.defaultUriSchemeUtil=r,this.dataService=n,this.$q=o,this.managedEntityConstants=a,this.datastoreService=s,this.vmMigrateStorageLocatorService=c,this.migrationTypeConstants=l,this.datastoreRecommendationService=d,this.storageProfileService=u,this.vmMigrateStorageAdvancedSummaryBuilder=p,this.NetworkPageViewModes=m,this.vmStorageRecommendationsService=g,this.vmXdrsRecommendationService=h,this.storageSelectorService=S,this.featureFlagsService=y,this.migrationHelperService=P,this.relatedItemsService=C,this.pmemUtilService=D,this._isFinished=!1,this.state={destinationComputeResource:null,networkMatches:null,selectedPriority:null,selectedMode:void 0,selectedRecommendation:null,isHotMigration:!1};var b=_.keys(f),I=_.reduce(f,function(e,t,i){return e[i]=t.name,e},{});this.vmId=b[0],this.vmName=f[this.vmId].name,this.state.isHotMigration="poweredOn"===f[b[0]].powerState,this.state.isComputeResourceChanged=!1,this.state.selectedRecommendation={},this._theModel=new e.MigrationWizardDataModel(b),this.vmOrigin=[],1===b.length&&this.relatedItemsService.getRelatedItems(this.vmId).then(function(e){w.vmOrigin=e}),this.advancedStorageDataPromise=this.requestAdvancedStorageData(b),this._theModel.vmNames=I,this._migrationTypePageModel=new e.SelectMigrationTypePageModel,this._computeResourcePageModel=new e.SelectComputeResourcePageModel,this._computeResourceTreePageModel=new e.SelectComputeResourceTreePageModel,this._folderPageModel=new e.MigrateSelectFolderPageModel,this._storagePageModel=new e.MigrateSelectStoragePageModel,this._finishPageModel=new e.MigrateFinishPageModel,this._priorityPageModel=new e.SelectPriorityPageModel,this._storageRecommendationServiceInstance=new this.vmStorageRecommendationsService,this._xdrsRecommendationServiceInstance=new this.vmXdrsRecommendationService,this._vmWizardScheduleTaskPageModel=new e.VmWizardScheduleTaskPageModel(i),this._networkPageModel=new e.MigrateSelectNetworkPageModel,v.$on("$destroy",function(){w._storageRecommendationServiceInstance.cancelRecommendations(w._isFinished)}),this.declareModelDependencies(v)}return t.prototype.declareModelDependencies=function(e){this.declareMigrationTypeModelDependencies(e),this.declareComputeResourceModelDependencies(e),this.declareComputeResourceTreeModelDependencies(e),this.declareFolderModelDependencies(e),this.declareStorageModelDependencies(e),this.declareFinishModelDependencies(e),this.declarePriorityModelDependencies(e)},t.prototype.declareMigrationTypeModelDependencies=function(e){var t=this;e.$watch(function(){return t._theModel.vms},function(e){t._migrationTypePageModel.vms=e}),e.$watch(function(){return t._migrationTypePageModel.isXvcMigrationPossible},function(e){t._theModel.isXvcMigrationPossible=e})},t.prototype.declareComputeResourceModelDependencies=function(e){var t=this;e.$watch(function(){return t._theModel.vms},function(e){t._computeResourcePageModel.vms=e}),e.$watch(function(){return t._computeResourcePageModel.stretchedStorage},function(e){t._theModel.stretchedStorage=e}),e.$watch(function(){return t._computeResourcePageModel.datacenter},function(e){t._theModel.datacenter=e})},t.prototype.declareComputeResourceTreeModelDependencies=function(e){var t=this;e.$watch(function(){return t._theModel.vms},function(e){t._computeResourceTreePageModel.vms=e}),e.$watch(function(){return t._theModel.isXvcMigrationPossible},function(e){t._computeResourceTreePageModel.isXvcMigrationPossible=e}),e.$watch(function(){return t._computeResourceTreePageModel.datacenter},function(e){t._theModel.datacenter=e})},t.prototype.declareFolderModelDependencies=function(e){var t=this;e.$watch(function(){return t._theModel.vms},function(e){t._folderPageModel.vms=e}),e.$watch(function(){return t._theModel.datacenter},function(e){t._folderPageModel.datacenter=e}),e.$watch(function(){return t._folderPageModel.destinationFolder},function(e){t._theModel.destinationFolder=e})},t.prototype.declareStorageModelDependencies=function(e){var t=this;e.$watch(function(){return t._theModel.vms},function(e){t._storagePageModel.vms=e}),e.$watch(function(){return t.isXvcMigration()},function(e){t._storagePageModel.isXvcMigration=e}),e.$watch(function(){return t.state.destinationComputeResource},function(e,i){if(e){var r=e.resourceRef?e.resourceRef.type:void 0,n=t.defaultUriSchemeUtil.getVsphereObjectId(e.resourceRef),o=i?t.defaultUriSchemeUtil.getVsphereObjectId(i.resourceRef):"__DEADBEEF__";switch(r){case"ResourcePool":case"VirtualApp":t._storagePageModel.computeResource=e.clusterRef?t.defaultUriSchemeUtil.getVsphereObjectId(e.clusterRef):t.defaultUriSchemeUtil.getVsphereObjectId(e.hostRef),t._storagePageModel.pool=n;break;case"HostSystem":case"ClusterComputeResorce":default:t._storagePageModel.computeResource=n,t._storagePageModel.pool=t.defaultUriSchemeUtil.getVsphereObjectId(e.targetResourcePoolRef)}t._storagePageModel.isComputeResourceChanged=n!==o}}),e.$watch(function(){return t._storagePageModel.isAdvancedStorageMode},function(e){t._theModel.isAdvancedStorageMode=e}),e.$watch(function(){return t._storagePageModel.virtualDisksByVm},function(e){if(t._theModel.virtualDisksByVm=e,_.isEmpty(e))return t._selectedStorage=void 0,t._selectedStorageProfile=void 0,t._theModel.stretchedStorage=void 0,void(t._selectedReplicationGroup=void 0);var i=e[t._theModel.vms[0]];t._selectedStorage={name:t.findStorageNameInMap(i[0].storage,t._storageNameMap),storageRef:t.defaultUriSchemeUtil.getManagedObjectReference(i[0].storage),parentStoragePod:t.defaultUriSchemeUtil.getManagedObjectReference(i[0].parentStoragePod)},t._selectedStorageProfile=i[0].profile,t._selectedReplicationGroup=i[0].replicationGroup;var r=t.findFirstDiskFormat(e);t._selectedDiskFormat=r?{name:r.label,type:r.value}:void 0}),e.$watch(function(){return t._storagePageModel.storageNameMap},function(e){if(t._storageNameMap=e,t._selectedStorage){var i=t.defaultUriSchemeUtil.getVsphereObjectId(t._selectedStorage.storageRef);t._selectedStorage.name=t.findStorageNameInMap(i,t._storageNameMap)}})},t.prototype.declareFinishModelDependencies=function(e){var t=this;e.$watch(function(){return t.state.destinationComputeResource},function(e,i){if(e){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e.resourceRef),n=i?t.defaultUriSchemeUtil.getVsphereObjectId(i.resourceRef):"__DEADBEEF__";t._finishPageModel.isComputeResourceChanged=r!==n}}),e.$watch(function(){return t._folderPageModel.destinationFolder},function(e,i){if(e){var r=i?i:"__DEADBEEF__";t._finishPageModel.isFolderChanged=e!==r}})},t.prototype.declarePriorityModelDependencies=function(e){var t=this;e.$watch(function(){return t._priorityPageModel.priority},function(e){t._theModel.priority=e})},t.prototype.submit=function(){var t=this;this._isFinished=!0;var i=this._storageRecommendationServiceInstance.getSelectedRecommendationsByVm(),r=[];if(_.each(this._theModel.vms,function(e){var n=i[e];if(!t._storageRecommendationServiceInstance.hasFaultsForVm(e)&&!t._xdrsRecommendationServiceInstance.hasFaults())return _.isEmpty(n)||t.getSelectedMode()===t.migrationTypeConstants.MIGRATE_RESOURCE_ONLY?void r.push(e):t.migrationService.applyStorageRecommendations(n,t.assertDefined(t._selectedStorage).storageRef)}),r.length>0){var n=this.i18nService.getString("VmUi","MigrationWizard.title.single",this.vmName),o=void 0,a=void 0,s=this.state.destinationComputeResource;s&&(o=s.targetResourcePoolRef,a=s.resourceRef);var c=new e.MigrationWizardDataModel(r);c.pool=this.defaultUriSchemeUtil.getVsphereObjectId(o),c.computeResource=this._finishPageModel.hostForSilentSelection?this._finishPageModel.hostForSilentSelection:this.defaultUriSchemeUtil.getVsphereObjectId(a),c.priority=this._theModel.priority,c.networkMatches=this.getNetworkMatches(),this.getSelectedMode()!==this.migrationTypeConstants.MIGRATE_STORAGE_ONLY&&this.migrationHelperService.isXvcOperation(this.model.vms,this.defaultUriSchemeUtil.getVsphereObjectId(a))&&(c.destinationFolder=this.model.destinationFolder),this.getSelectedMode()===this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY?c.stretchedStorage=this._theModel.stretchedStorage:c.virtualDisksByVm=this._theModel.virtualDisksByVm,this.migrationService.migrate(r,n,c,this._xdrsRecommendationServiceInstance.getSelectedRecommendation(),this._vmWizardScheduleTaskPageModel)}},Object.defineProperty(t.prototype,"migrationTypePageModel",{get:function(){return this._migrationTypePageModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeResourcePageModel",{get:function(){return this._computeResourcePageModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"computeResourceTreePageModel",{get:function(){return this._computeResourceTreePageModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"folderPageModel",{get:function(){return this._folderPageModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isNetworkSelectionRequired",{set:function(e){this._theModel.isNetworkSelectionRequired=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._theModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"priorityPageModel",{get:function(){return this._priorityPageModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vmWizardScheduleTaskPageModel",{get:function(){return this._vmWizardScheduleTaskPageModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"networkPageModel",{get:function(){return this._networkPageModel},enumerable:!0,configurable:!0}),t.prototype.getFinishPageState=function(){var e=this,t={};return e.getSelectedMode()===e.migrationTypeConstants.MIGRATE_RESOURCE_ONLY?t={migrationType:"MigrationWizard.readyPage.migrationWorkflowChangeResourceKeepStorage",vmIds:e.getVmIds(),vmNames:e.getVmNames(),clusterName:e.state.destinationComputeResource.clusterName,hostName:e.state.destinationComputeResource.hostName,resourcePoolName:e.state.destinationComputeResource.resPoolName,networksMessage:this._theModel.isNetworkSelectionRequired?this.createNetworksMessage():void 0,recommendationService:this._storageRecommendationServiceInstance,xdrsRecommendationService:this.isXdrsRecommendationsNeeded()?this._xdrsRecommendationServiceInstance:void 0,folderName:e._finishPageModel.folderName,vcName:e._finishPageModel.vcName}:e.getSelectedMode()===e.migrationTypeConstants.MIGRATE_STORAGE_ONLY?t={
migrationType:"MigrationWizard.readyPage.migrationWorkflowChangeStorageKeepResource",vmIds:e.getVmIds(),vmNames:e.getVmNames(),storage:this._selectedStorage,pmemDiskInfo:this.getPmemDiskInfo(),diskFormat:this._selectedDiskFormat?this._selectedDiskFormat.name:"",profile:this._selectedStorageProfile,replicationGroup:this._selectedReplicationGroup,storageRecommendations:e.state.allStorageRecommendations,vmName:e.vmName,vmId:e.vmId,storageNameMap:this._storageNameMap,recommendationService:this._storageRecommendationServiceInstance,advancedStorageSummary:this._theModel.isAdvancedStorageMode?e.vmMigrateStorageAdvancedSummaryBuilder.build(e._theModel,angular.extend({},e.getVmNames(),this._storageNameMap),this._storageRecommendationServiceInstance):null}:e.getSelectedMode()===e.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE&&(t={migrationType:"MigrationWizard.readyPage.migrationWorkflowChangeResourceThenStorage",vmIds:e.getVmIds(),vmNames:e.getVmNames(),clusterName:e.state.destinationComputeResource.clusterName,hostName:e.state.destinationComputeResource.hostName,resourcePoolName:e.state.destinationComputeResource.resPoolName,storage:this._selectedStorage,pmemDiskInfo:this.getPmemDiskInfo(),diskFormat:this._selectedDiskFormat?this._selectedDiskFormat.name:"",profile:this._selectedStorageProfile,replicationGroup:this._selectedReplicationGroup,storageRecommendations:e.state.allStorageRecommendations,vmName:e.vmName,vmId:e.vmId,storageNameMap:this._storageNameMap,networksMessage:this._theModel.isNetworkSelectionRequired?this.createNetworksMessage():void 0,recommendationService:this._storageRecommendationServiceInstance,xdrsRecommendationService:this.isXdrsRecommendationsNeeded()?this._xdrsRecommendationServiceInstance:void 0,advancedStorageSummary:this._theModel.isAdvancedStorageMode?e.vmMigrateStorageAdvancedSummaryBuilder.build(e._theModel,angular.extend({},e.getVmNames(),this._storageNameMap),this._storageRecommendationServiceInstance):null,folderName:e._finishPageModel.folderName,vcName:e._finishPageModel.vcName}),this.state.isHotMigration&&this.getSelectedMode()!==this.migrationTypeConstants.MIGRATE_STORAGE_ONLY&&("highPriority"===this._theModel.priority?t.priority=e.i18nService.getString("VmUi","MigrationWizard.readyPage.highPriority"):"lowPriority"===this._theModel.priority&&(t.priority=e.i18nService.getString("VmUi","MigrationWizard.readyPage.lowPriority"))),t},t.prototype.setNetworkMatches=function(e){this.state.networkMatches=e},t.prototype.getNetworkMatches=function(){return this.state.networkMatches},t.prototype.hasValidComputeResourceSelected=function(){return this.state.destinationComputeResource&&this.state.destinationComputeResource.isValid},t.prototype.hasValidStorage=function(){return!_.isEmpty(this._storagePageModel.virtualDisksByVm)},t.prototype.hasValidFolderSelected=function(){return!!this._theModel.destinationFolder},t.prototype.setSelectedMode=function(e){this.state.selectedMode=e},t.prototype.getSelectedMode=function(){return this.state.selectedMode},Object.defineProperty(t.prototype,"storagePageModel",{get:function(){return this._storagePageModel},enumerable:!0,configurable:!0}),t.prototype.fetchRecommendationsInternal=function(){return this.isXdrsRecommendationsNeeded()?this.fetchXdrsRecommendations():this.fetchStorageRecommendations()},t.prototype.fetchRecommendations=function(){var e=this;if(this._finishPageModel.hostForSilentSelection=void 0,!this.isHostSelectionRequired())return this.fetchRecommendationsInternal();var t=this.buildDataModel(),i=this.migrationService.getLocationSpecsForTesting(t);return this.requestValidDestinationHosts(this.state.destinationComputeResource.resourceRef,i).then(function(t){return t&&(e._finishPageModel.hostForSilentSelection=e.defaultUriSchemeUtil.getVsphereObjectId(t)),e.fetchRecommendationsInternal()})},t.prototype.fetchStorageRecommendations=function(){var t=new e.MigrationWizardDataModel(this._theModel.vms),i=this.getSelectedMode();if(i===this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY||i===this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE){var r=this.state.destinationComputeResource;t.computeResource=r?this.defaultUriSchemeUtil.getVsphereObjectId(r.resourceRef):void 0,t.pool=r?this.defaultUriSchemeUtil.getVsphereObjectId(r.targetResourcePoolRef):void 0}if(i!==this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY&&i!==this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE||(t.networkMatches=this.getNetworkMatches()),i!==this.migrationTypeConstants.MIGRATE_STORAGE_ONLY&&i!==this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE||(t.virtualDisksByVm=this._theModel.virtualDisksByVm),!this.isFetchStorageRecommendationsNeeded(t))return this._storageRecommendationServiceInstance.load([]);var n=this.migrationService.getLocationSpecsForRecommendations(t);return this._storageRecommendationServiceInstance.load(n)},t.prototype.isFetchStorageRecommendationsNeeded=function(e){if(this.isXvcMigration())return!1;var t=/StoragePod/,i=_.some(e.virtualDisksByVm,function(e){return _.some(e,function(e){return!!e.parentStoragePod||t.test(e.storage||"")})});return i},t.prototype.isXvcMigration=function(){return(this.getSelectedMode()===this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY||this.getSelectedMode()===this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE)&&this.migrationHelperService.isXvcOperationByRef([this.getVmId()],this.getDestinationComputeResourceRef())},t.prototype.requestFolderData=function(){var e=this;if(!this.isXvcMigration())return this._finishPageModel.vcName=void 0,this._finishPageModel.folderName=void 0,this.$q.when(void 0);if(!this._finishPageModel.isComputeResourceChanged&&!this._finishPageModel.isFolderChanged&&this._finishPageModel.vcName&&this._finishPageModel.folderName)return this.$q.when(void 0);var t=this._theModel.destinationFolder;return this.dataService.getProperties(t,["name","vCenterName"]).then(function(t){return e._finishPageModel.isComputeResourceChanged=!1,e._finishPageModel.isFolderChanged=!1,e._finishPageModel.vcName=t.vCenterName,e._finishPageModel.folderName=t.name,e.$q.when(void 0)})},t.prototype.fetchXdrsRecommendations=function(){var e=this.defaultUriSchemeUtil.getVsphereObjectId(this.getDestinationClusterRef()),t=this.buildDataModel(),i=this.migrationService.getLocationSpecsForRecommendations(t);return this._xdrsRecommendationServiceInstance.load(e,i[0])},t.prototype.buildDataModel=function(){var t=new e.MigrationWizardDataModel(this._theModel.vms);t.pool=this.defaultUriSchemeUtil.getVsphereObjectId(this.state.destinationComputeResource.targetResourcePoolRef),t.computeResource=this.defaultUriSchemeUtil.getVsphereObjectId(this.state.destinationComputeResource.resourceRef),this.getSelectedMode()!==this.migrationTypeConstants.MIGRATE_STORAGE_ONLY&&this.migrationHelperService.isXvcOperation(this.model.vms,t.computeResource)&&(t.destinationFolder=this.model.destinationFolder);var i=this.getSelectedMode();return i!==this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY&&i!==this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE||(t.networkMatches=this.getNetworkMatches(),this.state.isHotMigration&&(t.priority=this._theModel.priority)),this.getSelectedMode()===this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY&&(t.stretchedStorage=this._theModel.stretchedStorage),i!==this.migrationTypeConstants.MIGRATE_STORAGE_ONLY&&i!==this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE||(t.virtualDisksByVm=this._theModel.virtualDisksByVm),t},t.prototype.isHostSelectionRequired=function(){return!!this.state.isHotMigration&&(!(!this.getTargetResourcePoolRef()||this.getTargetResourcePoolRef().type!==this.managedEntityConstants.V_APP)&&!!this.getDestinationClusterRef())},t.prototype.requestValidDestinationHosts=function(e,t){var i="validDestinationHosts",r=this.defaultUriSchemeUtil.getVsphereObjectId(e),n={propertyParams:[{propertyName:"validDestinationHosts",parameterType:t[0]._type,parameter:t[0]}]};return this.dataService.getProperties(r,[i],n).then(function(e){if(e.validDestinationHosts&&e.validDestinationHosts[0])return e.validDestinationHosts[0]})},t.prototype.isXdrsRecommendationsNeeded=function(){if(1!==this._theModel.vms.length)return!1;if(!this.state.isHotMigration)return!1;if(this.getDestinationHostRef())return!1;if(this._finishPageModel.hostForSilentSelection)return!1;var e=this.getSelectedMode();return e===this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE||e===this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY&&!!this._theModel.stretchedStorage},t.prototype.getVmId=function(){return this.vmId},t.prototype.getVmIds=function(){return this._theModel.vms},t.prototype.getVmName=function(){return this.vmName},t.prototype.getVmOrigin=function(){return this.vmOrigin},t.prototype.getAdvancedStoragePageData=function(){return this.advancedStorageDataPromise},t.prototype.getVmNames=function(){return this._theModel.vmNames},t.prototype.getTargetResourcePoolRef=function(){return this.state.destinationComputeResource.targetResourcePoolRef},t.prototype.getDestinationComputeResourceRef=function(){return this.state.destinationComputeResource?this.state.destinationComputeResource.resourceRef:null},t.prototype.getDestinationComputeResourceUid=function(){return this.state.destinationComputeResource?this.defaultUriSchemeUtil.getVsphereObjectId(this.state.destinationComputeResource.resourceRef):null},t.prototype.getDestinationHostRef=function(){if(!this.state.destinationComputeResource||!this.state.destinationComputeResource.resourceRef)return null;var e=this.state.destinationComputeResource.resourceRef;return e.type!==this.managedEntityConstants.HOST&&(e=this.state.destinationComputeResource.hostRef),e},t.prototype.getDestinationClusterRef=function(){if(!this.state.destinationComputeResource||!this.state.destinationComputeResource.resourceRef)return null;var e=this.state.destinationComputeResource.resourceRef;return e.type!==this.managedEntityConstants.CLUSTER&&(e=this.state.destinationComputeResource.clusterRef),e},t.prototype.getPreselectedHostName=function(e){var t=this;return t.state.isHotMigration?t.$q.when(null):t.dataService.getPropertiesByRelation(e,"cluster",t.managedEntityConstants.HOST,["name"]).then(function(e){return e&&1===Object.keys(e).length?e[Object.keys(e)[0]].name:null})},t.prototype.requestAdvancedStorageData=function(e){return this.dataService.getPropertiesForObjects(e,["migrateAdvancedStoragePageData"],{skipLoadingNotification:!0})},t.prototype.getNetworkPageViewModeInternal=function(){return this._networkPageModel.getSelectNetworkPageViewMode()},t.prototype.changeComputeResource=function(e){var t,i=this;null!==this.state.destinationComputeResource&&(t=this.defaultUriSchemeUtil.getVsphereObjectId(this.state.destinationComputeResource.resourceRef));var r="",n="",o="",a=this.defaultUriSchemeUtil.getEntityType(e.id);return a===this.managedEntityConstants.HOST?(r=e.rawData&&e.rawData.hostClusterName?e.rawData.hostClusterName:"",n=e.name?e.name:e.rawData&&e.rawData.name?e.rawData.name:""):a===this.managedEntityConstants.CLUSTER?r=e.rawData?e.rawData.name:e.name:a!==this.managedEntityConstants.RESOURCE_POOL&&a!==this.managedEntityConstants.V_APP||(o=e.rawData?e.rawData.name:e.name),this.migrationService.validateComputeResource({vmIds:this.getVmIds(),computeResourceId:e.id,isHotMigration:this.state.isHotMigration,selectedMode:this.getSelectedMode(),isNetworkSelectionRequired:this._theModel.isNetworkSelectionRequired,clusterName:r,resPoolName:o,hostName:n}).then(function(e){i.state.destinationComputeResource=e;var r=i.defaultUriSchemeUtil.getVsphereObjectId(i.state.destinationComputeResource.resourceRef);return i.state.isComputeResourceChanged=t&&r!==t,e})},t.prototype.clearSelectedComputeResource=function(){this.state.destinationComputeResource={resourceRef:null,targetResourcePoolRef:null,hostName:null,clusterName:null,isValid:!1}},t.prototype.createNetworksMessage=function(){var e=this,t="",i={};_.each(this.getNetworkMatches(),function(t){var r=e.defaultUriSchemeUtil.getVsphereObjectId(t.sourceNetwork),n=e.defaultUriSchemeUtil.getVsphereObjectId(t.destinationNetwork);if(r!==n){var o;o=e.getNetworkPageViewModeInternal()===e.NetworkPageViewModes.ADVANCED?e.createUniqueAdapterKey(t.sourceVm,t.sourceAdapter.key):r,i[o]={sourceNetworkName:t.sourceNetworkName,destinationNetworkName:t.destinationNetworkName}}});var r=Object.keys(i);if(r.length<=0)t=this.i18nService.getString("VmUi","MigrationWizard.readyPage.noNetworkChanges");else if(1===r.length&&this.getNetworkPageViewModeInternal()===this.NetworkPageViewModes.BASIC){var n=i[r[0]].sourceNetworkName;n||(n=this.i18nService.getString("VmUi","MigrationWizard.readyPage.invalidNetworkName"));var o=i[r[0]].destinationNetworkName;o||(o=this.i18nService.getString("VmUi","MigrationWizard.readyPage.invalidNetworkName")),t=this.i18nService.getString("VmUi","MigrationWizard.readyPage.singleNetworkChangeBasic",n,o)}else 1===r.length&&this.getNetworkPageViewModeInternal()===this.NetworkPageViewModes.ADVANCED?t=this.i18nService.getString("VmUi","MigrationWizard.readyPage.networkChangesAdvancedSingle",r.length):this.getNetworkPageViewModeInternal()===this.NetworkPageViewModes.BASIC?t=this.i18nService.getString("VmUi","MigrationWizard.readyPage.networkChangesBasic",r.length):this.getNetworkPageViewModeInternal()===this.NetworkPageViewModes.ADVANCED&&(t=this.i18nService.getString("VmUi","MigrationWizard.readyPage.networkChangesAdvanced",r.length));return t},t.prototype.assertDefined=function(e){if(void 0===e)throw new Error("Unexpected object: "+e);return e},t.prototype.createUniqueAdapterKey=function(e,t){var i=this.defaultUriSchemeUtil.getVsphereObjectId(e);return i+"$"+t},t.prototype.getIsComputeResourceChanged=function(){return this.state.isComputeResourceChanged},t.prototype.getStorageRecommendationsServiceInstance=function(){return this._storageRecommendationServiceInstance},t.prototype.findStorageNameInMap=function(e,t){return!e||_.isEmpty(t)?"__missing__":t[e]},t.prototype.getPmemDiskInfo=function(){var e=this,t=!1,i=!1,r=!1;return _.any(this._theModel.virtualDisksByVm,function(n){for(var o=0,a=n;o<a.length;o++){var s=a[o];"_configFile"!==s.key&&(e.storageProfileService.isPmemStorageProfile(s.profile)?t=!0:i=!0,s.origin&&e.pmemUtilService.isPmemDisk(s.origin)&&!e.storageProfileService.isPmemStorageProfile(s.profile)&&(r=!0))}return!1}),{hasPmemDisk:t,hasRegularDisk:i,hasDowngradedPmemDisk:r}},t.prototype.findFirstDiskFormat=function(e){var t;_.find(e,function(e){var i=_.find(e,function(e){return!!e.diskFormat});return!!i&&(t=i.diskFormat,!0)});return t},t.prototype.isXvMotion=function(){return this.state.isHotMigration&&this.getSelectedMode()===this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE},t}();e.MigrationWizardManager=t,angular.module("com.vmware.vsphere.client.vm").factory("MigrationWizardManager",["migrationService","i18nService","defaultUriSchemeUtil","dataService","$q","managedEntityConstants","datastoreService","vmMigrateStorageLocatorService","migrationTypeConstants","datastoreRecommendationService","storageProfileService","NetworkPageViewModes","vmMigrateStorageAdvancedSummaryBuilder","VmStorageRecommendationsService","vmXdrsRecommendationService","storageSelectorService","featureFlagsService","migrationHelperService","relatedItemsService","pmemUtilService",function(e,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P){return function(C,D){var w=new t(e,i,r,n,o,a,s,c,l,d,u,v,C,p,m,g,D,h,f,S,y,P);return w}}])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n){this.i18nService=e,this.diskFormatService=t,this.storageProfileService=i,this.defaultUriSchemeUtil=r,this.spbmReplicationGroupInfoService=n}return e.prototype.build=function(e,t,i){var r=this,n=[];return this._entityNameMap=t,this._vmStorageRecommendationsService=i,this._selectedRecommendationDiskNames=this.buildStorageNameByDiskMap(),this._topRecommendations=this._vmStorageRecommendationsService.getTopRecommendations(),_.forEach(_.keys(e.virtualDisksByVm),function(i){var o={vmId:i,vmName:t[i],diskStorage:[]};_.forEach(e.virtualDisksByVm[i],function(e){o.diskStorage.push({diskLabel:e.label,diskStorage:r.getStorageLabel(i,e),diskProfile:e.profile&&e.profile.id!==r.storageProfileService.DEFAULT_ID?e.profile.label:void 0,diskReplicationGroup:e.replicationGroup?r.spbmReplicationGroupInfoService.getReplicationGroupName(e.replicationGroup):"",storageUrn:e.storage,parentStoragePodUrn:e.parentStoragePod})}),n.push(o)}),n},e.prototype.getStorageLabel=function(e,t){var i;if(!this._selectedRecommendationDiskNames[e]||!this._selectedRecommendationDiskNames[e][t.key])return i=this.getString("MigrationWizard.readyPage.locationNonSdrs",t.storage?this._entityNameMap[t.storage]:"",this.buildDiskFormatName(t));var r=this.isTopRecommendation(e,t)?"MigrationWizard.readyPage.locationSdrsAuto":"MigrationWizard.readyPage.locationSdrsManual",n=t.parentStoragePod||t.storage;return i=this.getString(r,this._entityNameMap[n],this.getString("MigrationWizard.readyPage.datastoreFormatValue",this._selectedRecommendationDiskNames[e][t.key]),this.buildDiskFormatName(t))},e.prototype.isTopRecommendation=function(e,t){var i=t.parentStoragePod||t.storage,r=this._topRecommendations[i][e].key,n=this._vmStorageRecommendationsService.getSelectedRecommendationsByVm(),o=_.some(n[e],function(e){return e.key===r});return o},e.prototype.buildStorageNameByDiskMap=function(){var e=this,t={};return _.each(this._vmStorageRecommendationsService.getSelectedRecommendationsByVm(),function(i,r){t[r]||(t[r]={}),_.each(i,function(i){_.each(i.action,function(i){if(!i.relocateSpec.disk){var n=e.defaultUriSchemeUtil.getVsphereObjectId(i.relocateSpec.datastore);return void(t[r]._configFile=e._entityNameMap[n])}_.each(i.relocateSpec.disk,function(i){var n=e.defaultUriSchemeUtil.getVsphereObjectId(i.datastore);t[r][i.diskId]=e._entityNameMap[n]})})})}),t},e.prototype.buildDiskFormatName=function(e){return e.diskFormat?this.getString("MigrationWizard.readyPage.diskFormatValue",e.diskFormat.label):"_configFile"!==e.key?this.getString("MigrationWizard.readyPage.diskFormatValue",this.diskFormatService.diskFormats.sameAsSource.name):""},e.prototype.getString=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return(r=this.i18nService).getString.apply(r,["VmUi",e].concat(t));var r},e.$inject=["i18nService","diskFormatService","storageProfileService","defaultUriSchemeUtil","spbmReplicationGroupInfoService"],e}();e.VmMigrateStorageAdvancedSummaryBuilder=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrateStorageAdvancedSummaryBuilder",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.dataService=e,this.storageLocatorService=t,this.defaultUriSchemeUtil=i}return e.prototype.getStorageLocatorData=function(t){return this.dataService.getProperties(t.vms[0],e.PROPERTY_STORAGE_LOCATOR_ITEMS_DATA,{propertyParams:[{propertyName:e.PROPERTY_STORAGE_LOCATOR_ITEMS_DATA,parameterType:"com.vmware.vsphere.client.h5.vm.model.migration.VmMigrationStorageLocatorSpec",parameter:{vms:this.defaultUriSchemeUtil.getManagedObjectReferences(t.vms),resource:t.resource?this.defaultUriSchemeUtil.getManagedObjectReference(t.resource):void 0}}]}).then(function(t){return t?t[e.PROPERTY_STORAGE_LOCATOR_ITEMS_DATA]:null})},e.prototype.getStorageObjectNameMap=function(e){return this.storageLocatorService.getStorageObjectNameMap(e)},e.$inject=["dataService","storageLocatorService","defaultUriSchemeUtil"],e.PROPERTY_STORAGE_LOCATOR_ITEMS_DATA="storageLocator:migrationStorageLocatorItemsData",e}();e.VmMigrateStorageLocatorService=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrateStorageLocatorService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vsphere.client.spbm.spec.CalculateProvisioningCostSpec,i=com.vmware.vim.binding.pbm.profile.ProfileId,r=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){this.authorizationService=e,this.compatibilityCheckService=t,this.i18nService=i,this.migrationService=r,this.compatibilityResultsPresenter=n,this.$q=o,this.defaultUriSchemeUtil=a,this.managedEntityConstants=s,this.dataService=c,this.bytesFilter=l,this.storageProfileService=d,this.spbmReplicationGroupInfoService=u}return e.prototype.validateSelection=function(e){var t=this;return this.$q.all({compatibilityArray:this.checkCompatibility(e),privilegesMap:this.checkPrivileges(e),placementMap:this.checkVmPlacement(e),provisioningCostMap:this.requestProvisioningCost(e)}).then(function(i){var r=t.getSuccessByVm(i.compatibilityArray),n=t.checkReplicationGroupAssignments(e);return _.each(i.compatibilityArray,function(e){e.result&&(t.addToValidationResult(i.privilegesMap,e),t.addToValidationResult(i.placementMap,e),t.addToValidationResult(i.provisioningCostMap,e),t.addToValidationResult(n,e))}),t.compatibilityResultsPresenter.formatValidationResults(i.compatibilityArray).then(function(e){return e.length>0?{compatibilityMessages:e,hasSuccess:t.hasSuccess(r,i.privilegesMap.successMap,i.placementMap.successMap,i.provisioningCostMap.successMap,n.successMap)}:{compatibilityMessages:[{icon:"vsphere-icon-status-ok",message:t.i18nService.getString("VmUi","ProvisioningWizard.CompatibilityChecksSucceeded"),contents:[]}],hasSuccess:!0}})})},e.prototype.addToValidationResult=function(e,t){var i=this.defaultUriSchemeUtil.getVsphereObjectId(t.entity),r={error:_.map(e.compatibilityData[i].errors,function(e){return{message:e.message,localizedMessage:e.message}}),warning:_.map(e.compatibilityData[i].warnings,function(e){return{message:e.message,localizedMessage:e.message}}),info:_.map(e.compatibilityData[i].infos,function(e){return{message:e.message,localizedMessage:e.message}}),host:this.compatibilityResultsPresenter.NO_HOST_REF,vm:t.entity};(r.error.length||r.warning.length||r.info.length)&&t.result.push(r)},e.prototype.hasSuccess=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];var i=arguments[0];_.each(arguments,function(e){e!==i&&_.each(i,function(t,r){i[r]=i[r]&&e[r]})});var r=!0;return _.each(i,function(e){r=r&&e}),r},e.prototype.checkPrivileges=function(e){var t=this,i=[];return _.each(e.virtualDisksByVm,function(e){_.each(e,function(e){e.storage&&i.indexOf(e.storage)===-1&&i.push(e.storage)})}),this.authorizationService.checkPrivilegesForMultipleObjects(i,["Datastore.AllocateSpace"]).then(function(i){var r={},n={};return _.each(e.virtualDisksByVm,function(e,o){r[o]={errors:[],warnings:[],infos:[]},_.each(e,function(e){e.storage&&(i[e.storage]["Datastore.AllocateSpace"]?n[o]=!0:(r[o].errors=[{icon:"vsphere-icon-status-error",message:t.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.NoPermissionOnDatastore"),contents:[]}],n[o]=!1))})}),{compatibilityData:r,successMap:n}})},e.prototype.checkCompatibility=function(e){return this.migrationService.validateStorage(e).then(function(e){return e})},e.prototype.checkVmPlacement=function(e){var t=this,i=[],r={},n={},o={};return _.each(e.virtualDisksByVm,function(e,t){r[t]={},o[t]=!0,n[t]={errors:[],warnings:[],infos:[]},_.each(e,function(e){e.profile&&(r[t][e.key]=i.length,i.push({storageId:e.storage,profile:e.profile}))})}),0===i.length?this.$q.resolve({compatibilityData:n,successMap:o}):this.compatibilityCheckService.validateVmPlacementForMultipleVmsNoFilter(i).then(function(i){return t.formatVmPlacementResults(i,e,r)})},e.prototype.checkReplicationGroupAssignments=function(e){var t=this,i={},r={};return _.each(e.virtualDisksByVm,function(e,n){i[n]={errors:[],warnings:[],infos:[]};var o=[];e.forEach(function(e){e.replicationGroup&&o.push(e.replicationGroup)});var a=t.spbmReplicationGroupInfoService.validateVmReplicationGroupAssignments(o);a?(i[n].errors=[{icon:"vsphere-icon-status-error",message:a,contents:[]}],r[n]=!1):r[n]=!0}),{compatibilityData:i,successMap:r}},e.prototype.formatVmPlacementResults=function(e,t,i){var r=this,n={},o={};return _.each(t.virtualDisksByVm,function(t,a){n[a]={errors:[],warnings:[],infos:[]};var s=r.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.SpbmPolicyWarning"),c=!1;_.each(t,function(t){var r=i[a][t.key];void 0!==r&&(_.each(e.errors[r],function(e){if(e){var t=e.localizedMessage||e.message;if(!t&&e.faultMessage&&e.faultMessage.length>0&&(t=e.faultMessage[0].message),t){var i=_.any(n[a].errors,function(e){return e.message===t});return void(i||n[a].errors.push({icon:"vsphere-icon-status-error",message:t,contents:[]}))}}}),_.each(e.warnings[r],function(e){if(e){var t={icon:"vsphere-icon-status-warning",message:s,contents:[]},i=e.localizedMessage;if(!i&&e.faultMessage&&e.faultMessage.length>0&&(i=e.faultMessage[0].message),i){var r=_.any(n[a].warnings,function(e){return e.message===i});return void(r||(t.message=i,n[a].warnings.push(t)))}c||(c=!0,n[a].warnings.push(t))}}))}),o[a]=!n[a].errors.length}),{compatibilityData:n,successMap:o}},e.prototype.requestProvisioningCost=function(e){var t=this,i="vsan",r=e.virtualDisksByVm,n=r[e.vms[0]],o=this.defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(n[0].storage),a=[],s=!1;return _.each(r,function(e){_.each(e,function(e){s=s||e.storageType===i;var r=t.createCalculateCostSpec(e);a.push(r)})}),s?this.dataService.getProperties(o,["spbmCreateCostData"],{propertyParams:[{propertyName:"spbmCreateCostData",parameterType:"[Lcom.vmware.vsphere.client.spbm.spec.CalculateProvisioningCostSpec;",parameter:a}]}).then(function(e){return t.formatDiskCostSpec(e.spbmCreateCostData,r)}):this.$q.when(this.formatDiskCostSpec([],r))},e.prototype.createCalculateCostSpec=function(e){var r=new t;return r.sizeInBytes=e.capacityInBytes?e.capacityInBytes:1,e.profile&&e.profile.id!==this.storageProfileService.DEFAULT_ID&&(r.profileId=new i,r.profileId.uniqueId=e.profile.id),r.storageContainer=this.defaultUriSchemeUtil.getManagedObjectReference(e.storage),r},e.prototype.formatDiskCostSpec=function(e,t){var i=this;if(!e||!e.length){var r={},n={};return _.each(t,function(e,t){r[t]={errors:[],warnings:[],infos:[]},n[t]=!0}),{compatibilityData:r,successMap:n}}var o=0,a={},s={},c={};return _.each(t,function(t,r){var n=0,l=0;a[r]={errors:[],warnings:[],infos:[]},s[r]=!0,_.each(t,function(t){var s=e[o];o++;var d=s.cost,u=s.size;if(d&&d.reason&&d.reason.message&&(d.isSatisfiable?(i.containsMessage(a[r].infos,d.reason.message)||a[r].infos.push({icon:"vsphere-icon-help-info-hover",message:d.reason.message,contents:[]}),void 0===c[r]&&(c[r]=!0)):(i.containsMessage(a[r].warnings,d.reason.message)||a[r].warnings.push({icon:"vsphere-icon-status-warning",message:d.reason.message,contents:[]}),c[r]=!1)),d&&d.isSatisfiable&&d.cost){var p=d.cost;n+=u*p.diskSpaceToAddressSpaceRatio,l+=p.currentFlashReadCacheSize+p.changeFlashReadCacheSize,void 0===c[r]&&(c[r]=!0)}}),c[r]&&a[r].infos.push({icon:"vsphere-icon-help-info-hover",message:i.i18nService.getString("VmUi","whatIf.vsanConsumption",i.bytesFilter(n),i.bytesFilter(l)),contents:[]})}),{compatibilityData:a,successMap:s}},e.prototype.containsMessage=function(e,t){return _.any(e,function(e){return e.message===t})},e.prototype.getSuccessByVm=function(e){var t=this,i={};_.each(e,function(e){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e.entity);_.each(e.result,function(e){i[r]||(i[r]=0),e.error||i[r]++}),!e.result&&e.error&&(i[r]||(i[r]=0))});var r={};return _.each(i,function(e,t){r[t]=e>=1}),r},e.$inject=["authorizationService","compatibilityCheckService","i18nService","migrationService","compatibilityResultsPresenter","$q","defaultUriSchemeUtil","managedEntityConstants","dataService","bytesFilter","storageProfileService","spbmReplicationGroupInfoService"],e}();e.VmMigrateStorageSelectionValidationService=r,angular.module("com.vmware.vsphere.client.vm").service("vmMigrateStorageSelectionValidationService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.$q=e,this.dataServiceUtil=t,this.defaultUriSchemeUtil=i,this.managedEntityConstants=r,this.PROP_DC="dc",this.PROP_VM_DS_INFO="vmDatastoresInfo",this.PROP_VM_VIRTUAL_DISKS="virtualDisks",this.PROP_VM_HOME_DATASTORE="vmHomeDatastore",this._objectProperties={}}return e.prototype.processStretchedStorage=function(e,t){var i=this;return this.fetchVmsUsingStretchedStorage(e,t).then(function(t){if(t.length){var r=[i.fetchVmProperties(t),i.fetchAccessibleDatastores(e)];return i.$q.all(r).then(function(){var r=i.buildVmDisksRecords(e,t);return r})}})},e.prototype.fetchVmsUsingStretchedStorage=function(e,t){var i=this;return this.requestMissingProperties(t.concat(e),[this.PROP_DC]).then(function(){var r=i._objectProperties[e][i.PROP_DC];return _.filter(t,function(e){return!i.equalReferences(i._objectProperties[e][i.PROP_DC],r)})})},e.prototype.fetchVmProperties=function(e){return this.requestMissingProperties(e,[this.PROP_VM_DS_INFO,this.PROP_VM_HOME_DATASTORE,this.PROP_VM_VIRTUAL_DISKS])},e.prototype.fetchAccessibleDatastores=function(e){return this.requestMissingProperties([e],[this.getDatastorePropertyName(e)])},e.prototype.getDatastorePropertyName=function(e){var t=this.defaultUriSchemeUtil.getEntityType(e),i=t===this.managedEntityConstants.V_APP||t===this.managedEntityConstants.RESOURCE_POOL?"computeResourceDatastore":"datastore";return i},e.prototype.requestMissingProperties=function(e,t){var i=this,r=_.filter(e,function(e){return!i._objectProperties[e]||_.some(t,function(t){return!i._objectProperties[e][t]})});return e.length?this.dataServiceUtil.getPropertiesForObjects(r,t).then(function(e){i.addPropertiesToCache(e)}):this.$q.resolve()},e.prototype.addPropertiesToCache=function(e){var t=this;_.each(e,function(e,i){t._objectProperties[i]?angular.extend(t._objectProperties[i],e):t._objectProperties[i]=e})},e.prototype.buildVmDisksRecords=function(e,t){var i=this,r={},n=this._objectProperties[e][this.getDatastorePropertyName(e)];return _.each(t,function(e){var t=i._objectProperties[e];r[e]=[{key:"_configFile",storage:i.findMirroredDatastore(_.find(t[i.PROP_VM_DS_INFO],function(e){return i.equalReferences(e.ref,t[i.PROP_VM_HOME_DATASTORE])}),n)}],_.each(t[i.PROP_VM_VIRTUAL_DISKS],function(o){r[e].push({key:o.key,storage:i.findMirroredDatastore(_.find(t[i.PROP_VM_DS_INFO],function(e){return i.equalReferences(e.ref,o.backing.datastore)}),n)})})}),r},e.prototype.findMirroredDatastore=function(e,t){var i=this,r=_.find(e.mirrors,function(e){return _.find(t,function(t){return i.equalReferences(t,e)})});return this.defaultUriSchemeUtil.getVsphereObjectId(r)},e.prototype.equalReferences=function(e,t){return e.value===t.value&&e.type===t.type&&e.serverGuid===t.serverGuid},e.$inject=["$q","dataServiceUtil","defaultUriSchemeUtil","managedEntityConstants"],e}();e.VmMigrateStretchedStorageService=t,angular.module("com.vmware.vsphere.client.vm").factory("vmMigrateStretchedStorageService",["$injector",function(e){return{newInstance:function(){return e.instantiate(t)}}}])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.managedEntityConstants=e,this.defaultUriSchemeUtil=t,this._isValid=!1}return e.prototype.setComputeResource=function(e){return this._computeResourceId=e,this._computeResourceType=this.defaultUriSchemeUtil.getEntityType(e),this},e.prototype.setData=function(e){return this._data=e,this},e.prototype.setIsValid=function(e){return this._isValid=e,this},e.prototype.setValidationResult=function(e){return this._validationResult=e,this},e.prototype.setParams=function(e){return this._params=e,this},e.prototype.build=function(){var e=this._data,t={resourceRef:this.defaultUriSchemeUtil.getManagedObjectReference(this._computeResourceId),targetResourcePoolRef:e.result.resourcePoolRef,hostName:e.result.hostName?e.result.hostName:this._params.hostName,clusterName:e.result.clusterName?e.result.clusterName:this._params.clusterName,isValid:this._isValid,validationResults:this.transformErrorsIntoWarningsIfNeeded(this._validationResult)};return this._computeResourceType!==this.managedEntityConstants.V_APP&&this._computeResourceType!==this.managedEntityConstants.RESOURCE_POOL||_.extend(t,{hostRef:e.result.hostRef,resPoolName:e.result.resourcePoolName?e.result.resourcePoolName:this._params.resPoolName,
clusterRef:e.result.clusterRef}),this.cleanup(),t},e.prototype.cleanup=function(){this._computeResourceId=null,this._computeResourceType="",this._data=null},e.prototype.transformErrorsIntoWarningsIfNeeded=function(e){return this._computeResourceType!==this.managedEntityConstants.CLUSTER&&this._computeResourceType!==this.managedEntityConstants.RESOURCE_POOL&&this._computeResourceType!==this.managedEntityConstants.V_APP||!this._isValid?e:_.map(e,function(e){var t=_.extend({},e);return _.each(t.result,function(e){return e.error&&(e.warning=e.warning?e.warning.concat(e.error):e.error,e.error=null),e}),t})},e}();e.ValidateComputeResourceStateBuilder=t,angular.module("com.vmware.vsphere.client.vm").factory("vmMigrateValidateComputeResourceStateBuilderFactory",["managedEntityConstants","defaultUriSchemeUtil",function(e,i){return{create:function(){return new t(e,i)}}}])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={objectIds:"<",isTemplate:"<",datacenter:"<",virtualCenter:"<",onSubmit:"=",submitDisabled:"=",alerts:"=",closeModal:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/services/wizards/moveVm/moveVmViewComponent.html"}return e}();e.MoveVmViewComponent=t;var i=function(){function e(e,t,i,r,n){this.vuiConstants=i,this.$element=r,this.$timeout=n,this.submitDisabled=!0,this.loading=!1,this._moveVmService=e,this._i18nService=t,this.loadingLabel=this._i18nService.getString("CommonUi","wizard.loading"),this.treeAriaDescription=this._i18nService.getString("VmUi","MoveToFolderDialog.treeDescription"),this.tabName=this._i18nService.getString("VmUi","actionMoveVmInventoryFolder")}return e.prototype.$onInit=function(){var e=this;this.submitDisabled=!0,this.treeHtml="vm_folders_tree.html",1===this.objectIds.length&&(this.treeHtml="vm_folders_in_datacenter_tree.html"),this.onSubmit=function(){e.submitDisabled=!0,e.loading=!0,e._moveVmService.validateMove(e.objectIds,e._targetId).then(function(t){if(t){var i={type:e.vuiConstants.validationBanner.type.ERROR,text:t};e.alerts=[i]}else e._moveVmService.applyMove(e.objectIds,e._targetId),e.closeModal();e.loading=!1,e.submitDisabled=!1})},this.$timeout(function(){var t=e.$element[0].querySelector("button");t&&t.focus()},0)},e.prototype.onLocationSelected=function(e){this.submitDisabled=!1,this._targetId=e},e.$inject=["moveVmService","i18nService","vuiConstants","$element","$timeout"],e}();e.MoveVmController=i,angular.module("com.vmware.vsphere.client.vm").component("moveVmView",new t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").constant("upgradeVmHardwareConstants",{hardwareUpgradePolicy:{never:"never",onSoftPowerOff:"onSoftPowerOff",always:"always"}}),function(){"use strict";function e(e,t){function i(i,r){return t.when(i.validatePage()).then(function(i){return i&&i.error?(e.markPageIncompleteWithError(r,i.error),t.reject(i)):i})}function r(r,n){return i(n.model,r).then(function(i){return t.when(n.model.submitPage(i)).then(function(i){return r.currentPage&&r.currentPage.title!==n.title?t.reject():(i.invalidateNextPages&&e.invalidateNextPages(r,i.wizardFlow,n.title),e.markPageComplete(r,i.wizardFlow),!0)})},function(t){return t&&t.invalidateNextPages&&e.invalidateNextPages(r,t.wizardFlow,n.title),!1})}function n(e,t){return i(t.model,e).then(function(){return t.model.submitPage()})}return{buildVuiWizardPage:function(e,t){return{title:t.title,description:t.description,contentUrl:t.contentUrl,defaultState:t.defaultState,onCommit:function(){return r(e,t)},disableNext:function(){return t.model.hasOwnProperty("pageFinishedLoading")&&!t.model.pageFinishedLoading()||t.model.hasOwnProperty("validationFinishedLoading")&&!t.model.validationFinishedLoading()}}},buildVuiWizardFinishPage:function(e,t){return{title:t.title,description:t.description,contentUrl:t.contentUrl,onCommit:function(){return n(e,t)},finishReady:function(){return!t.model.hasOwnProperty("pageFinishedLoading")||t.model.pageFinishedLoading()}}}}}angular.module("com.vmware.vsphere.client.vm").service("vmVuiWizardPageBuilder",e),e.$inject=["wizardPageService","$q"]}(),angular.module("com.vmware.vsphere.client.vm").service("vuiService",["vuiWizardService",function(e){return{createWizard:e}}]);var h5_vm;!function(e){var t=function(){function t(e){this.$scope=e,this.basicInformationData=this.getBasicInformationData(),this.$scope.cloneVmBasicInformationPageModel.basicInformation?this.basicInformationData.params=this.$scope.cloneVmBasicInformationPageModel.basicInformation:this.$scope.cloneVmBasicInformationPageModel.basicInformation=this.basicInformationData.params}return t.prototype.getBasicInformationData=function(){var t=this.$scope.wizardViewData.getSourceObjectName(),i=this.$scope.wizardViewData.getSourceObjectId();return{params:{templateType:e.TemplateType.OVF_TEMPLATE,name:t,notes:"",vmId:i,cloneOvfType:e.CloneType.NEW_TEMPLATE,valid:!0,isPrivilegeError:!1},isVMTXPhase2:!1}},t.prototype.clonePagesChange=function(t){this.$scope.vuiWizard.validationBanner.messages=[];var i=this.basicInformationData.params.templateType===e.TemplateType.VM_TEMPLATE,r=this.basicInformationData.params.cloneOvfType!==e.CloneType.NEW_TEMPLATE;this.$scope.cloneVmBasicInformationPageModel.changePages(i,r)},t.$inject=["$scope"],t}();angular.module("com.vmware.vsphere.client.vm").controller("cloneVappBasicInformationController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e){this.$scope=e,this.basicInformationData=this.getBasicInformationData(),this.$scope.cloneVmBasicInformationPageModel.basicInformation?this.basicInformationData.params=this.$scope.cloneVmBasicInformationPageModel.basicInformation:this.$scope.cloneVmBasicInformationPageModel.basicInformation=this.basicInformationData.params}return t.prototype.getBasicInformationData=function(){var t=this.$scope.wizardViewData.getSourceObjectName(),i=this.$scope.wizardViewData.getSourceObjectId();return this.$scope.cloneVmBasicInformationPageModel.isVMTXPhase2Enabled?{params:{templateType:e.TemplateType.VM_TEMPLATE,name:t,notes:"",folderObjectId:this.$scope.wizardViewData.defaultTarget,vcObjectId:this.$scope.wizardViewData._viewData.vCenterId,folder:null,vmId:i,cloneOvfType:e.CloneType.NEW_TEMPLATE,valid:!0,isPrivilegeError:!1},isVMTXPhase2:!0}:{params:{templateType:e.TemplateType.VM_TEMPLATE,name:t,notes:"",vmId:i,cloneOvfType:e.CloneType.NEW_TEMPLATE,valid:!0,isPrivilegeError:!1},isVMTXPhase2:!1}},t.prototype.clonePagesChange=function(t){this.$scope.vuiWizard.validationBanner.messages=[];var i=this.basicInformationData.params.templateType===e.TemplateType.VM_TEMPLATE,r=this.basicInformationData.params.cloneOvfType!==e.CloneType.NEW_TEMPLATE;this.$scope.cloneVmBasicInformationPageModel.changePages(i,r)},t.$inject=["$scope"],t}();angular.module("com.vmware.vsphere.client.vm").controller("cloneVmBasicInformationController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t,this.i18n=t.getString,this.libraryItemData={vmId:e.wizardViewData.getSourceObjectId(),selectedLibraryItemId:this.$scope.cloneVmLibraryItemPageModel.contentLibraryItem&&this.$scope.cloneVmLibraryItemPageModel.contentLibraryItem.id}}return e.prototype.onSelectedLibraryItemChange=function(e){this.$scope.vuiWizard.validationBanner.messages=[],this.$scope.cloneVmLibraryItemPageModel.contentLibraryItem=e},e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").controller("cloneVmLibraryItemController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(t){this.$scope=t,this.isOvfWorkflow=!0,this.locationData={vmId:t.wizardViewData.getSourceObjectId(),selectedLibraryId:this.$scope.cloneVmLocationPageModel.contentLibrary&&this.$scope.cloneVmLocationPageModel.contentLibrary.id},this.isOvfWorkflow=t.cloneVmBasicInformationPageModel.basicInformation.templateType===e.TemplateType.OVF_TEMPLATE}return t.prototype.onSelectedLibraryChange=function(e){this.$scope.vuiWizard.validationBanner.messages=[],this.$scope.cloneVmLocationPageModel.contentLibrary=e},t.$inject=["$scope"],t}();angular.module("com.vmware.vsphere.client.vm").controller("cloneVmLocationController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.TemplateType,i=e.CloneType,r=function(){function e(e,r){if(this.$scope=e,this.i18nService=r,this.i18n=function(e,t){void 0===t&&(t="ProvisioningUiLib");for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return r.getString.apply(r,[t,e].concat(i))},this.basicInformationData=e.cloneVmBasicInformationPageModel.basicInformation,this.vmtxPhase2Enabled=e.cloneVmBasicInformationPageModel.isVMTXPhase2Enabled,this.cloneAsVMTX=this.basicInformationData.templateType===t.VM_TEMPLATE,this.cloneOvfType=this.basicInformationData.cloneOvfType!==i.NEW_TEMPLATE,this.vmtxPhase2Enabled&&this.cloneAsVMTX){var n=e.cloneVmReviewPageModel.getComputeResourceInfo();this.computeResourceName=n.name,this.computeResourceType=n.label}if(this.cloneOvfType&&!this.cloneAsVMTX||(this.locationData=e.cloneVmLocationPageModel.contentLibrary),this.cloneOvfType&&!this.cloneAsVMTX&&(this.libraryItemData=e.cloneVmLibraryItemPageModel.contentLibraryItem),this.cloneAsVMTX){var o=e.datastorePageModel.form.isAdvancedStorageMode;this.storageData=o?this.getAdvancedStorageDetails():this.getSimpleStorageDetails()}}return e.prototype.getSimpleStorageDetails=function(){var e=new n,t=this.$scope.datastorePageModel.form;return e.vmHomeDatastore=t.selectedStorage.name,e.vmHomeStoragePolicy=t.storageProfilesData._currentVmProfileAssignment.vmHomeProfile.label,e},e.prototype.getAdvancedStorageDetails=function(){var e=new n,t=this.$scope.datastorePageModel.form.storageSelectorState.vmStorageConfigInAdvancedMode[0];e.vmHomeDatastore=t.vmHome.storageObj.name,e.vmHomeStoragePolicy=t.vmHome.storageProfile?t.vmHome.storageProfile.label:"",e.vmDiskInfo=[];for(var i=0;i<t.vmDisks.length;i++){var r=t.vmDisks[i],o=r.storageProfile?r.storageProfile.label:"-",a={name:r.name,datastore:this.i18n("sharesAndType","VmUi",r.storageObj?r.storageObj.name:"",o)};e.vmDiskInfo.push(a)}return e},e.$inject=["$scope","i18nService"],e}(),n=function(){function e(){}return e}();angular.module("com.vmware.vsphere.client.vm").controller("cloneVmReviewController",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){var r=this;this.i18nService=e,this.helpService=t,this.idGeneratorService=i,this.HW_VERSION_INFO_ID="com.vmware.vsphere.vm_admin.doc.vc_312",this.compatibilityLabel=this.i18nService.getString("VmUi","hwVersion.selector.label"),this.popupParams={title:this.i18nService.getString("Common","help"),message:this.i18nService.getString("Common","signpost.hardwareVersionSelector"),linkLabel:this.i18nService.getString("VmUi","hwVersion.info.helperlink.label"),linkFunction:function(){t.showHelpPage(r.HW_VERSION_INFO_ID)}},this.scheduleUpgradeOnPowerOfLabel=this.i18nService.getString("VmUi","VmUpgradePage.onSoftPowerOff"),this.showMultipleVmsWarning=!1}return e.prototype.$onInit=function(){this.changeUpgradabelWarning(),this.descriptionId=this.idGeneratorService.nextId()},e.prototype.selectionChange=function(){this.changeUpgradabelWarning(),this.onChangeMethod&&"function"==typeof this.onChangeMethod&&this.onChangeMethod(this.selectedVersion)},e.prototype.changeUpgradabelWarning=function(){if(this.allVmsLength>1){var e=0;this.selectedVersion.vms&&(e=this.selectedVersion.vms.length),this.showMultipleVmsWarning=!0,this.multipleVmsWarning=this.i18nService.getString("VmUi","SelectVmVersionPage.UpgradableWarning",e,this.allVmsLength)}},e.$inject=["i18nService","helpService","idGeneratorService"],e}();e.VmHardwareCompatibility=t,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareCompatibility",{templateUrl:"vm-ui/resources/vm/views/compatibility/vmHardwareCompatibility.html",controller:t,bindings:{description:"<",supportedVersions:"=",selectedVersion:"=",onChangeMethod:"<",scheduleMode:"<",isUpgradeAfterGuestOsShutdown:"=",allVmsLength:"<"}})}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.buildVmVersions=function(e,t){var i=this,r=_.map(e,function(e){return i.buildVmVersion(e,t)});return r},e.prototype.buildSupportedVersionsForVms=function(e,t){var i=this,r=new Array;return angular.forEach(e,function(e,n){var o=e.optionDescriptors,a=e["config.version"];i.buildVmSupportedOptions(n,o,a,t,r)}),_.sortBy(r,"id")},e.prototype.buildVmSupportedOptions=function(e,t,i,r,n){for(var o=0;o<t.length;o++)if(i<t[o].key&&t[o].upgradeSupported){var a=_.find(n,function(e){return e.id===t[o].key});if(a){var s=a.vms;s||(s=[]),s.push(e)}else a=this.buildVmVersion(t[o],r),a.vms=[e],n.push(a)}},e.prototype.buildVmVersion=function(e,t){return{id:e.key,name:this.i18nService.getString("VmUi","VmHardware.HWVersion.short."+e.key),compatibilityInfo:t?this.i18nService.getString("VmUi","SelectVmVersionPage."+e.key):this.i18nService.getString("VmUi","SelectVmVersionPageLessThan65Vc."+e.key)}},e.$inject=["i18nService"],e}();e.VmHardwareCompatibilityService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareCompatibilityService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){!function(e){e[e.CreateMode=0]="CreateMode",e[e.ReadMode=1]="ReadMode",e[e.ReadAdvancedMode=2]="ReadAdvancedMode",e[e.UpdateMode=3]="UpdateMode"}(e.VmDisplayMode||(e.VmDisplayMode={}));e.VmDisplayMode}(h5_vm||(h5_vm={}));var h5_vm;!function(e){!function(e){e[e.CreateMode=0]="CreateMode",e[e.UpdateMode=1]="UpdateMode",e[e.CloneMode=2]="CloneMode",e[e.DeployVmtxMode=3]="DeployVmtxMode"}(e.VmWorkflowMode||(e.VmWorkflowMode={}));e.VmWorkflowMode}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){var i=this;this.i18nService=e,this.vmHardwareCpuIoMmuService=t,this.onChange=function(){i.onIoMmuChange({configFlags:i.configFlags})},this.disabled=function(){return i.vmHardwareCpuIoMmuService.isDisabled(i.vmWorkflowMode,i.vbsEnabled,i.powerState,i.privileges)},this.i18n=e.getString,this.vmHardwareCpuIoMmuService.getSignPostParams().then(function(e){i.signPostParams=e})}return e.$inject=["i18nService","vmHardwareCpuIoMmuService"],e}();e.VmHardwareCpuIoMmuController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/components/vmHardwareCpuIoMmu/vm-hardware-cpu-io-mmu.html",this.bindings={configFlags:"<",privileges:"<",vmWorkflowMode:"<",powerState:"<",onIoMmuChange:"&",vbsEnabled:"<"}}return e}();e.VmHardwareCpuIoMmuComponent=i,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareCpuIoMmu",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t,i){this.i18nService=e,this.templateHelperService=t,this.vmHardwareUtil=i}return t.prototype.getSignPostParams=function(){var e=this,t="vm-ui/resources/vm/views/components/vmHardwareCpuIoMmu/iommuHelpText.html";return this.templateHelperService.renderTemplateWithScope(t,{i18n:this.i18nService.getString}).then(function(t){return{message:t,title:e.i18nService.getString("Common","help"),"class":"io-mmu-help-text"}})},t.prototype.haveConfigSettingsPermission=function(t){var i=this.vmHardwareUtil.checkPrivileges(t,[e.Privileges.VM_CONFIG_SETTINGS]);return i},t.prototype.isVmPoweredOn=function(e){return"poweredOn"===e},t.prototype.isVmSuspended=function(e){return"suspended"===e},t.prototype.isDisabled=function(t,i,r,n){if(i)return!0;var o=this.haveConfigSettingsPermission(n),a=this.isVmPoweredOn(r)||this.isVmSuspended(r);switch(t){default:return!1;case e.VmWorkflowMode.CreateMode:return!1;case e.VmWorkflowMode.CloneMode:return!o;case e.VmWorkflowMode.UpdateMode:return!o||a}},t.$inject=["i18nService","templateHelperService","vmHardwareUtil"],t}();e.VmHardwareCpuIoMmuService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareCpuIoMmuService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.$q=e,this.$rootScope=t,this.i18nService=i,this.vmDatastoreLocationBrowserService=r,this.defaultUriSchemeUtil=n,this.managedEntityConstants=o,this.authorizationService=a,this.STYLE_HAS_ERROR="has-error",this.PRIVILEGE_DATASTORE_ALLOCATE_SPACE="Datastore.AllocateSpace"}return e.prototype.onLocationChange=function(e,t,i,r,n){var o=this;return this.isBrowseOption(e)?this.getStorageSelectorItems(r,t).then(function(e){return t.storageData.storageLocatorItemsData=e,o.vmDatastoreLocationBrowserService.choose(o.$rootScope,{storageData:t.storageData,storageProfilesData:i,disableSdrs:!n})}):this.$q.when({selectedStorageItem:e,selectedStorageProfile:i.selectedProfile})},e.prototype.getErrorStyle=function(e){return e.isVisible?this.STYLE_HAS_ERROR:""},e.prototype.getErrorMessage=function(e,t,i){var r=this,n="",o=!1;this.isValid(e.selectedStorageItem)||(n=this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.NoPermissionOnDatastore"));var a=this.getRdmSupportedDatastore(t,i);if(n||a.forEach(function(t){r.defaultUriSchemeUtil.compareIds(e.selectedStorageItem.storageObject.storageRef,t.storageRef)&&(o=!0)}),!o){var s=this.defaultUriSchemeUtil.getEntityType(e.selectedStorageItem.id);n="StoragePod"===s?this.i18nService.getString("VmUi","DiskConfig.RDMUnsupportedCluster"):this.i18nService.getString("VmUi","DiskConfig.RDMUnsupported")}return n},e.prototype.getRdmSupportedDatastore=function(e,t){var i=_.filter(e,function(e){return e.capability.rawDiskMappingsSupported}),r=_.filter(t.storageLocatorItemsData,function(e){return e.isRDMSupported}),n=_.filter(t.datastoreItems,function(e){return null===e.parentStoragePod}),o=_.filter(n,function(e){return _.some(i,function(t){return JSON.stringify(t.datastore.datastore)===JSON.stringify(e.storageRef)})});return _.union(o,r)},e.prototype.buildLocationOptions=function(e){var t={name:this.i18nService.getString("VmUi","DiskPage.StoreWithVM")},i={name:this.i18nService.getString("VmUi","DiskPage.Browse")};if(e){var r={name:e.name,id:e.id,storageObject:e.storageObject},n={options:[t,r,i],selection:r};return n}return{options:[t,i],selection:t}},e.prototype.isDifferent=function(e,t){return e.id!==t.id},e.prototype.isValid=function(e){var t=this,i=e.id,r=e.name,n=this.i18nService.getString("VmUi","DiskPage.StoreWithVM"),o=this.i18nService.getString("VmUi","DiskPage.Browse");if(r===o)return this.$q.when(!0);if(r===n)return this.$q.when(!0);var a=this.defaultUriSchemeUtil.getEntityType(i);return a===this.managedEntityConstants.STORAGE_POD?this.$q.when(!0):this.authorizationService.checkPrivileges(i,[this.PRIVILEGE_DATASTORE_ALLOCATE_SPACE]).then(function(e){var i=e[0];return t.$q.when(i)})},e.prototype.isBrowseOption=function(e){var t=this.i18nService.getString("VmUi","DiskPage.Browse");return e.name===t},e.prototype.getStorageSelectorItems=function(e,t){return t.storageData.storageLocatorItemsData?this.$q.when(t.storageData.storageLocatorItemsData):this.vmDatastoreLocationBrowserService.getStorageLocatorItems(e)},e.$inject=["$q","$rootScope","i18nService","vmDatastoreLocationBrowserService","defaultUriSchemeUtil","managedEntityConstants","authorizationService"],e}();e.VmHardwareVirtualDiskLocationService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskLocationService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.VmDisplayMode,i=function(){function e(e,t){var i=this;this.vmHardwareVirtualDiskLocationService=e,this.i18nService=t,this.onLocationChange=function(e,t){i.prevSelection=t,i.vmHardwareVirtualDiskLocationService.onLocationChange(i.selected,i.vmStorageBrowserMetadata,i.vmStorageProfileMetadata,i.vmId,i.showStoragePods).then(function(e){if(i.vmHardwareVirtualDiskLocationService.isDifferent(i.selected,e.selectedStorageItem)){i.setErrorMessage(e);var t=i.vmHardwareVirtualDiskLocationService.buildLocationOptions(e.selectedStorageItem);i.locationOptions=t.options,i.selected=e.selectedStorageItem,i.onChange({selectedStorageProfile:e.selectedStorageProfile,selectedStorageItem:e.selectedStorageItem})}},function(){i.selected=i.prevSelection})},this.setErrorMessage=function(e){var t=i.vmHardwareVirtualDiskLocationService.getErrorMessage(e,i.datastore,i.vmStorageBrowserMetadata.storageData.storageLocatorItemsData);i.diskLocationError=!!t,i.diskLocationErrorConfig={message:t,isVisible:i.diskLocationError}}}return e.prototype.$onInit=function(){this.setLocationContext(this.selectedStorage)},e.prototype.$onChanges=function(e){},e.prototype.getErrorStyle=function(){return this.vmHardwareVirtualDiskLocationService.getErrorStyle(this.diskLocationErrorConfig)},e.prototype.setLocationContext=function(e){var i=this.vmHardwareVirtualDiskLocationService.buildLocationOptions(e);this.locationOptions=i.options,this.selected=i.selection,this.prevSelection=this.selected,this.isCreateMode=this.displayMode===t.CreateMode,this.diskLocationErrorConfig={message:this.i18nService.getString("VmUi","DiskConfig.RDMUnsupported"),isVisible:this.diskLocationError}},e.$inject=["vmHardwareVirtualDiskLocationService","i18nService"],e}();e.VmHardwareVirtualDiskLocationController=i;var r=function(){function e(){this.bindings={onChange:"&",displayMode:"<",ariaLabel:"<",vmStorageBrowserMetadata:"<",vmStorageProfileMetadata:"<",vmId:"<",showStoragePods:"<",diskLocationError:"=",datastore:"<",selectedStorage:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/components/vmHardwareVirtualDiskLocation/vm-hardware-virtual-disk-location.html"}return e}();e.VmHardwareVirtualDiskLocation=r,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskLocation",new r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.storageData=e}return e}();e.VmStorageBrowserMetadata=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.VmDisplayMode,i=function(){function e(e){var t=this;this.i18nService=e,this.onSharesChange=function(e){t.selected.shares=e,t.onChangeCallback()},this.onSharesLevelChange=function(){var e=t.selected.level.data;t.isCustomShareLevel="custom"===e,t.isCustomShareLevel||(t.selected.shares=t.recalculateSharesValue(e)),t.onChangeCallback()},this.i18n=e.getString}return e.prototype.$onInit=function(){this.sharesContext&&this.setSharesContext()},e.prototype.$onChanges=function(e){e.sharesContext.currentValue&&this.setSharesContext()},e.prototype.setFormNames=function(){this.sharesId?(this.formInputName=this.sharesId+"-shares-value",this.formSelectName=this.sharesId+"-shares-levels"):(this.formInputName="shares-value",this.formSelectName="shares-levels")},e.prototype.setSharesContext=function(){var e=this;this.sharesId=this.sharesContext.sharesId,this.sharesInfo=this.sharesContext.sharesInfo,this.showRecommendations=this.sharesContext.showRecommendations,this.shareMin=this.sharesContext.shareMin,this.shareMax=this.sharesContext.shareMax,this.sharesLevelPresetOptions=this.sharesContext.sharesLevelPresetOptions,this.setFormNames(),this.shareLevels=[{label:this.i18n("VmUi","sharesInfoLevel.low"),data:"low"},{label:this.i18n("VmUi","sharesInfoLevel.normal"),data:"normal"},{label:this.i18n("VmUi","sharesInfoLevel.high"),data:"high"},{label:this.i18n("VmUi","sharesInfoLevel.custom"),data:"custom"}],this.shareValidationErrorMessages={max:function(){return e.i18n("Common","SharesControl.RangeError",e.shareMin,e.shareMax)},min:function(){return e.i18n("Common","SharesControl.RangeError",e.shareMin,e.shareMax)}},this.showRecommendations&&(this.shareRecommendationValues=[{value:this.shareMin,name:"Minimum"},{value:this.shareMax,name:"Maximum"}]),this.selected={level:_.find(this.shareLevels,function(t){return t.data===e.sharesInfo.level}),shares:this.sharesInfo.shares},this.isCustomShareLevel="custom"===this.sharesInfo.level,this.readMode=this.displayMode===t.ReadMode||this.displayMode===t.ReadAdvancedMode},e.prototype.selectedShareValues=function(){var e=this.selected.shares,t=this.selected.level.label;return e+" "+t},e.prototype.isValidShare=function(){return this.selected.shares>=this.shareMin&&this.selected.shares<=this.shareMax},e.prototype.onChangeCallback=function(){this.isValidShare()&&this.onChange({shares:{level:this.selected.level.data,shares:this.selected.shares}})},e.prototype.recalculateSharesValue=function(e){if(!this.isCustomShareLevel){var t=this.sharesLevelPresetOptions[e];if(void 0===t||null===t)throw new Error("Unknown level: "+e);return t}},e.$inject=["i18nService","vmHardwareVirtualDiskSharesService"],e}(),r=function(){function e(){this.bindings={onChange:"&",displayMode:"<",ariaLabel:"<",sharesContext:"<",isDisabled:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/components/vmHardwareVirtualDiskShares/vm-hardware-virtual-disk-shares.html"}return e}();e.VmHardwareVirtualDiskShares=r,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskShares",new r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=function(){function e(e){this.vmHardwareUtil=e}return e.prototype.isEditSharesDisabled=function(e,t,i){return!this.hasPrivilegesToEditShares(e,t)||!i},e.prototype.hasPrivilegesToEditShares=function(e,i){return void 0===i&&(i=!1),!!i||this.vmHardwareUtil.checkPrivileges(e,[t.VM_RESOURCE_PRIVILEGE,t.VM_EDITDEVICE_PRIVILEGE])},e.$inject=["vmHardwareUtil"],e}();e.VmHardwareVirtualDiskSharesService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskSharesService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.VmDisplayMode,i=function(){function e(e){var t=this;this.i18nService=e,this.onSharingChange=function(){t.onChange({sharing:t.selected})},this.i18n=e.getString}return e.prototype.$onInit=function(){this.sharingInfo&&this.setSharingContext()},e.prototype.$onChanges=function(e){e.sharingInfo.currentValue&&this.setSharingContext()},e.prototype.setSharingContext=function(){this.selected=this.sharingInfo.selectedSharing,this.sharingOptions=this.sharingInfo.sharingOptions,this.isSelectable=this.sharingInfo.enableSharing&&this.sharingOptions&&this.sharingOptions.length>0,this.isReadOnly=this.displayMode===t.ReadMode||this.displayMode===t.ReadAdvancedMode},e.$inject=["i18nService"],e}(),r=function(){function e(){this.bindings={onChange:"&",displayMode:"<",ariaLabel:"<",sharingInfo:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/components/vmHardwareVirtualDiskSharing/vm-hardware-virtual-disk-sharing.html"}return e}();e.VmHardwareVirtualDiskSharing=r,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskSharing",new r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.VmDisplayMode,i=function(){function e(e){var t=this;this.i18nService=e,this.onStorageProfileChange=function(e){t.onChange({selectedProfile:e})},this.i18n=e.getString}return e.prototype.$onInit=function(){this.vmStorageProfileMetadata&&this.setStorageProfileContext()},e.prototype.$onChanges=function(e){e.vmStorageProfileMetadata.currentValue&&this.setStorageProfileContext()},e.prototype.setStorageProfileContext=function(){this.selected=this.vmStorageProfileMetadata.selectedProfile,this.storageProfiles=this.vmStorageProfileMetadata.storageProfiles,this.isSelectable=this.storageProfiles&&this.storageProfiles.length>0,this.isReadOnly=this.displayMode===t.ReadMode||this.displayMode===t.ReadAdvancedMode},e.$inject=["i18nService"],e}(),r=function(){function e(){this.bindings={onChange:"&",displayMode:"<",ariaLabel:"<",vmStorageProfileMetadata:"<",errorConfig:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/components/vmHardwareVirtualDiskStorageProfile/vm-hardware-virtual-disk-storage-profile.html"}return e}();e.VmHardwareVirtualDiskStorageProfile=r,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskStorageProfile",new r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.storageProfiles=e,this.selectedProfile=t}return e}();e.VmStorageProfileMetadata=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e}();angular.module("com.vmware.vsphere.client.vm").component("gosUserMappingWrapper",{bindings:{vmId:"<"},controller:t,template:'\n          <vsc-guestos-user-mapping-container [vm-id]="$ctrl.vmId"></vsc-guestos-user-mapping-container>'})}(h5_vm||(h5_vm={}));var vm_ui;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.timeFormatterService=t,this.vxPropertyViewService=i,this.$q=r,this.NA_STRING=e.getString("VmUi","VmTpm.info.na")}return e.prototype.$onChanges=function(){this.refresh()},e.prototype.refresh=function(){var e=this;if(this.certificateInfo){var t={validFrom:this.timeFormatterService.formatDate(this.certificateInfo.validFrom),validTo:this.timeFormatterService.formatDate(this.certificateInfo.validTo)};this.$q.all(t).then(function(t){var i=e.vxPropertyViewService.createPropertyViewBuilder(),r=i.category("general"),n=r.section("generalSection");n.property(e.i18nService.getString("VmUi","certificateInfo.issuer"),e.certificateInfo.issuerName||e.NA_STRING),n.property(e.i18nService.getString("VmUi","certificateInfo.version"),e.certificateInfo.version||e.NA_STRING),n.property(e.i18nService.getString("VmUi","certificateInfo.kind"),e.certificateInfo.kind||e.NA_STRING),n.property(e.i18nService.getString("VmUi","certificateInfo.validFrom"),t.validFrom||e.NA_STRING),n.property(e.i18nService.getString("VmUi","certificateInfo.validTo"),t.validTo||e.NA_STRING),n.property(e.i18nService.getString("VmUi","certificateInfo.algorithm"),e.certificateInfo.algorithmName||e.NA_STRING),n.property(e.i18nService.getString("VmUi","certificateInfo.publicKey"),e.certificateInfo.publicKeyAlgorithmName||e.NA_STRING),e.propertyViewData=i.build()})}},e.$inject=["i18nService","timeFormatterService","vxPropertyViewService","$q"],e}();e.TpmCertDetailInfoController=t,angular.module("com.vmware.vsphere.client.vm").component("tpmCertDetailInfo",{template:'<vx-property-view data="$ctrl.propertyViewData"></vx-property-view>',bindings:{certificateInfo:"<"},controller:t})}(vm_ui||(vm_ui={}));var h5_vm;!function(e){var t="vsphere.core.vm.tpm.export",i=function(){function e(e,t,i,r,n,o,a,s,c,l){var d=this;this.i18nService=e,this.vuiConstants=t,this.commonActionBarService=i,this.columnRenderersRegistry=r,this.navigation=n,this.vmTpmService=o,this.$scope=a,this.visibilityAwareDataUpdateNotificationService=s,this.$element=c,this.vcH5ConstantsService=l,this.refresh=function(){d.loading=!0,d.vmTpmService.getCertificates(d.vmId).then(function(e){d.datagridOptions.data=e})["finally"](function(){d.loading=!1})},this.i18n=e.getString,this.vmId=this.navigation.getRoute().objectId}return e.prototype.getColumnDefinitions=function(){var e=this.columnRenderersRegistry.getColumnRenderer("text");return[{displayName:this.i18nService.getString("VmUi","certificate.type"),field:"algorithmName",template:function(t){return e(["algorithmName"],t)}},{displayName:this.i18nService.getString("VmUi","certificate.publicKeyAlgorithmName"),field:"publicKeyAlgorithmName",template:function(t){return e(["publicKeyAlgorithmName"],t)}},{displayName:this.i18nService.getString("VmUi","certificate.issuer"),field:"issuerNameCN",template:function(t){return e(["issuerNameCN"],t)}}]},e.prototype.$onInit=function(){var e=this;this.datagridOptions={data:[],height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,resizable:!0,selectedItems:[],actionBarOptions:{actions:[]}},this.$scope.comparator=function(){return!0},this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t!==i&&e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=t,e.updateActionBar())}),this.refresh(),this.updateActionBar(),this.subscribeForUpdates()},e.prototype.updateActionBar=function(){var e=this;this.commonActionBarService.updateActionBar(this.datagridOptions.actionBarOptions,"actions",[this.vmId],[{actionId:t,isActionAvailable:function(){return 1===e.datagridOptions.selectedItems.length},getActionInvocationContext:function(){return e.datagridOptions.selectedItems[0]}}])},
e.prototype.subscribeForUpdates=function(){var e=this,t={};t[e.vcH5ConstantsService.DATA_REFRESH_INVOCATION_EVENT]={handler:e.refresh},t[e.vcH5ConstantsService.MODEL_CHANGED_EVENT]={handler:e.refresh,checker:function(t,i){var r=null;return"CHANGE"===i.operationType&&(r=i.objectId),e.vmId===r}},this.visibilityAwareDataUpdateNotificationService.subscribeForDataUpdate(this.$element,this.refresh,t)},e.$inject=["i18nService","vuiConstants","commonActionBarService","columnRenderersRegistry","navigation","vmTpmService","$scope","visibilityAwareDataUpdateNotificationService","$element","vcH5ConstantsService"],e}();angular.module("com.vmware.vsphere.client.vm").component("tpmCertListComponent",{templateUrl:"vm-ui/resources/vm/views/configure/tpm/tpm-cert-list.component.html",bindings:{masterDetailsViewContext:"<"},controller:i})}(h5_vm||(h5_vm={}));var h5_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.$q=t,this.masterDetailsViewContext={},this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("VmUi","VmTpm.certificateInfo"),templateUrl:"vm-ui/resources/vm/views/configure/tpm/tpm-cert-detail-info.html",uid:"certDetailInfo"}])}}return e.$inject=["i18nService","$q"],e}();e.TpmConfigCertController=t,angular.module("com.vmware.vsphere.client.vm").component("vmTpmCertificates",{templateUrl:"vm-ui/resources/vm/views/configure/tpm/tpm-config-cert.component.html",controller:t})}(h5_ui||(h5_ui={}));var h5_ui;!function(e){var t=function(){function e(){this.masterDetailsViewContext={},this.detailsViewData={tabsPromise:[]}}return e}();e.TpmConfigCsrController=t,angular.module("com.vmware.vsphere.client.vm").component("vmTpmCertSigningRequests",{templateUrl:"vm-ui/resources/vm/views/configure/tpm/tpm-config-csr.component.html",controller:t})}(h5_ui||(h5_ui={}));var h5_vm;!function(e){var t="vsphere.core.vm.tpm.export",i=function(){function e(e,t,i,r,n,o,a){var s=this;this.i18nService=e,this.vuiConstants=t,this.commonActionBarService=i,this.columnRenderersRegistry=r,this.navigation=n,this.vmTpmService=o,this.$scope=a,this.refresh=function(){s.loading=!0,s.vmTpmService.getCertSigningRequests(s.vmId).then(function(e){s.datagridOptions.data=e})["finally"](function(){s.loading=!1})},this.i18n=e.getString,this.vmId=this.navigation.getRoute().objectId}return e.prototype.getColumnDefinitions=function(){var e=this.columnRenderersRegistry.getColumnRenderer("text");return[{displayName:this.i18nService.getString("VmUi","certificate.type"),field:"algorithmName",template:function(t){return e(["algorithmName"],t)}}]},e.prototype.$onInit=function(){var e=this;this.datagridOptions={data:[],height:"100%",columnDefs:this.getColumnDefinitions(),selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,resizable:!0,selectedItems:[],actionBarOptions:{actions:[]}},this.$scope.$watch(function(){return e.datagridOptions.selectedItems},function(t,i){t!==i&&e.masterDetailsViewContext&&(e.masterDetailsViewContext.selectedItems=t,e.updateActionBar())}),this.refresh(),this.updateActionBar()},e.prototype.updateActionBar=function(){var e=this;this.commonActionBarService.updateActionBar(this.datagridOptions.actionBarOptions,"actions",[this.vmId],[{actionId:t,isActionAvailable:function(){return 1===e.datagridOptions.selectedItems.length},getActionInvocationContext:function(){return e.datagridOptions.selectedItems[0]}}])},e.$inject=["i18nService","vuiConstants","commonActionBarService","columnRenderersRegistry","navigation","vmTpmService","$scope"],e}();angular.module("com.vmware.vsphere.client.vm").component("tpmCsrListComponent",{templateUrl:"vm-ui/resources/vm/views/configure/tpm/tpm-csr-list.component.html",bindings:{vmId:"<",masterDetailsViewContext:"<"},controller:i})}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){var r=this;this.i18nService=e,this.clarityModalService=t,this.bytesFilter=i,this.currentSelection=null,this.openLunSelectorDialog=function(e,t,i){var n={lunData:r.processVmConfig(e,t)};r.okHandler=i,r.modalOptions={title:r.i18nService.getString("VmUi","FormSelectLUN.SelectLUN"),contentTemplate:"vm-ui/resources/vm/views/controls/LUNSelector/lunSelectorDialog.html",defaultButton:"submit",dialogData:n,size:"lg",modalClass:"",hideSubmitButton:!1,submitDisabled:!0,selectedItems:[],alerts:[],onSubmit:r.onOkClicked},angular.extend(r.modalOptions,{selectionChanged:r.selectionChanged}),r.clarityModalService.openOkCancelModal(r.modalOptions)},this.selectionChanged=function(e){r.currentSelection=e,0===r.currentSelection.length?r.modalOptions.submitDisabled=!0:r.modalOptions.submitDisabled=!1},this.onOkClicked=function(){return 1===r.currentSelection.length&&(r.okHandler&&"function"==typeof r.okHandler&&r.okHandler(r.currentSelection),!0)},this.processVmConfig=function(e,t){var i=[];return!t||_.isEmpty(t)||_.isEmpty(t.configTarget)||_.isEmpty(t.configTarget.scsiDisk)?i:(_.each(t.configTarget.scsiDisk,function(t){if(!_.isEmpty(t.disk)&&!r.isDiskInUse(e,t.disk)){var n=t.disk,o={deviceName:n.deviceName,lunName:n.displayName,capacity:t.capacity,displayCapacity:r.bytesFilter(t.capacity,"B","Auto",2),lunNum:t.lunNumber,driveType:t.ssd?r.i18nService.getString("VmUi","FormSelectLUN.DriveType.SSD"):r.i18nService.getString("VmUi","FormSelectLUN.DriveType.NonSSD"),hardwareAcceleration:r.i18nService.getString("VmUi","RawDisk."+n.vStorageSupport),lunID:n.canonicalName,pathId:n.canonicalName};i.push(o)}}),i)},this.isDiskInUse=function(e,t){for(var i=!1,r=0;r<e.length&&!(i=e[r].backing.deviceName===t.deviceName);r++);return i}}return e.$inject=["i18nService","clarityModalService","bytesFilter"],e}();e.LunSelectorDialogService=t,angular.module("com.vmware.vsphere.client.vm").service("lunSelectorDialogService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={lunData:"<",selectionChanged:"&"},this.controller=i,this.template="<div id='lunSelectorGrid' class='lun-selector-list'><div vui-datagrid='$ctrl.gridOptions' vx-stretch-grid></div></div>"}return e}();e.LunSelectorList=t;var i=function(){function e(e,t){var i=this;this.i18nService=e,this.vuiConstants=t,this.i18n=function(e){return i.i18nService.getString("VmUi",e)},this.getGridOptions=function(){var e={sortMode:i.vuiConstants.grid.sortMode.SINGLE,selectionMode:i.vuiConstants.grid.selectionMode.SINGLE,selectedItems:i.selectedItems,searchable:!1,resizable:!0,data:i.lunData,columnDefs:i.getColumnDefs(),onChange:i.onSelectionChanged,height:"200px"};return e},this.getColumnDefs=function(){return[{displayName:i.i18n("FormSelectLUN.Name"),field:"lunName",type:"string"},{displayName:i.i18n("FormSelectLUN.PathID"),field:"pathId",type:"string"},{displayName:i.i18n("FormSelectLUN.LUN"),field:"lunNum",type:"string"},{displayName:i.i18n("FormSelectLUN.Capacity"),field:"displayCapacity",type:"string"},{displayName:i.i18n("FormSelectLUN.DriveType"),field:"driveType",type:"string"},{displayName:i.i18n("FormSelectLUN.HardwareAcceleration"),field:"hardwareAcceleration",type:"string"}]},this.onSelectionChanged=function(e){i.selectionChanged({selectedItems:e})}}return e.prototype.$onInit=function(){this.gridOptions=this.getGridOptions()},e.$inject=["i18nService","vuiConstants"],e}();e.LunSelectorListController=i,angular.module("com.vmware.vsphere.client.vm").component("lunSelectorList",new t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i){function r(e){if(!e.localizedMessage){if(!e.message)return"";e.localizedMessage=e.message}return'<div class="sdrs-fault-item">'+_.escape(e.localizedMessage)+"</div>"}var n=this;n.gridDescription=t.getString("VmUi","dsRecommendation.FaultsTitle");var o=e.modalOptions.dialogData.faults;n.dataGridOptions={columnDefs:[{displayName:t.getString("VmUi","FtFaultDetailsList.description"),field:"message",width:"100%",template:r}],sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,selectedItems:[],data:o,resizable:!0,searchable:!1,height:350}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningDatastoreFaultsController",e),e.$inject=["$scope","i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i){function r(e,i){var r=e.actions[0].destination,n=t.getVsphereObjectId(r);return i[n]}var n=this;n.descriptionText=e.modalOptions.dialogData.descriptionText,n.dataGridOptions=i.getDatagridOptions(e.modalOptions.dialogData,e.modalOptions.dialogData.selection),e.preselectRecommendationComparator=function(t){return!_.isEmpty(e.modalOptions.dialogData.selection)&&t.key===e.modalOptions.dialogData.selection.key},e.$watch(function(){return n.dataGridOptions.selectedItems},function(t){if(!t.length)return null;var i=t[0],n=e.modalOptions.dialogData.possibleDatastores;e.modalOptions.dialogData.selection={recommendationSpec:i,datastoreName:r(i,n)}})}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningDatastoreRecommendationsController",e),e.$inject=["$scope","defaultUriSchemeUtil","datastoreRecommendationsDatagridOptionsService"]}();var h5_vm;!function(e){var t=function(){function e(e,t){var i=this;this.$scope=e,this.vmProvisioningCustomizeTemplatePageModel=t,this.pageModel=this.$scope.vmProvisioningCustomizeTemplatePageModel,this.pageModel.wizardViewData=this.$scope.wizardViewData,this.pageModel.vmParams=this.$scope.vmParams,this.$scope.vuiWizard.currentPage.disableNext=function(){return!i.form.valid}}return e.prototype.$onInit=function(){this.customizeTemplateParams=this.pageModel.customizeTemplateParams,this.ipAllocationPolicy=this.pageModel.ipAllocationPolicyParams,this.form=this.pageModel.form},e.prototype.onStatusChange=function(e){this.form.valid=e.valid,this.form.customizeTemplateParams=e.result},e.$inject=["$scope","vmProvisioningCustomizeTemplatePageModel"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmProvisioningCustomizeTemplateController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.$scope=e,this.vmProvisioningDeploymentOptionsService=t}return Object.defineProperty(e.prototype,"pageModel",{get:function(){return this.$scope.vmProvisioningDeploymentConfigPageModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deploymentOptionParams",{get:function(){return this.pageModel.form.deploymentOptionParams},enumerable:!0,configurable:!0}),e.prototype.$onInit=function(){this.vmProvisioningDeploymentOptionsService.figureOutTheItemSelectedInDeploymentOptions(this.deploymentOptionParams)},e.prototype.onSelectionChange=function(e){this.pageModel.form.selectedKey=e.key},e.$inject=["$scope","vmProvisioningDeploymentOptionsService"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmProvisioningDeploymentOptionsController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.prototype.figureOutTheItemSelectedInDeploymentOptions=function(e){e&&e.deploymentOptions&&e.deploymentOptions.length>0&&this.createIsSelectedFieldInEachOption(e)},e.prototype.createIsSelectedFieldInEachOption=function(e){var t=e.selectedKey;_.each(e.deploymentOptions,function(e){e.defaultChoice=e.key===t,e.isSelected=e.defaultChoice})},e}();angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningDeploymentOptionsService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.$location=t,this.$anchorScroll=i,this.eulaDisplayService=r,this.linkDescriptions=[]}return e.prototype.$onInit=function(){_.isEmpty(this.form.eulaInfo)||_.isEmpty(this.form.eulaInfo.eulas)||(this.numberOfEulasFound=this.form.eulaInfo.eulas.length,this.headerDescription=this.eulaDisplayService.getEulaDescription(this.numberOfEulasFound),this.linkDescriptions=this.eulaDisplayService.getInfoDescriptions(this.numberOfEulasFound))},e.prototype.scrollTo=function(e){this.$location.hash(e),this.$anchorScroll()},e.$inject=["i18nService","$location","$anchorScroll","vmProvisioningEulaDisplayService"],e}(),i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningEula/vm-provisioning-eula-display.html",this.bindings={form:"="}}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmProvisioningEulaDisplay",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.getEulaDescription=function(e){var t="";return e>0&&(t=1===e?this.i18nService.getString("ProvisioningUiLib","AcceptEulaPage.acceptSingle"):this.i18nService.getString("ProvisioningUiLib","AcceptEulaPage.acceptAllAtOnce",[e])),t},e.prototype.getInfoDescriptions=function(e){for(var t=[],i=0;i<e;i++)t.push("Agreement "+(i+1));return t},e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").service("vmProvisioningEulaDisplayService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){var t=this;this.$scope=e,this.form=this.$scope.vmProvisioningEulaPageModel.form,this.$scope.vuiWizard.currentPage.disableNext=function(){return!t.form.eulaInfo.allEULAAccepted}}return e.$inject=["$scope"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmProvisioningEulaController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.vmProvisioningProductDetailsDataModel=r,this.EULA_OBJ_TYPE="com.vmware.vcenter.ovf.EulaParams",this.DEPLOYMENT_OPTIONS_OBJ_TYPE="com.vmware.vcenter.ovf.DeploymentOptionParams",this.viewData=this.$scope.wizardViewData,this.vmSpec=this.$scope.vmParams;var n=this.viewData.getDeployFromLibraryCommonContext();this.model=this.$scope.productDetailsPageModel,this.model.dataModel=r,this.model.dataModel.initProductDetails(n),this.model.dataModel.updateVmNameToDeploy(this.vmSpec.getName(),n),this.model.form.isReady=!0,this.controlFutureWizardPagesBehavior(n)}return e.prototype.controlFutureWizardPagesBehavior=function(e){var t=this.getEulaWizardPageObject(this.$scope.vuiWizardPages),i=this.getDeploymentOptionsWizardPageObject(this.$scope.vuiWizardPages),r=this.getScaleoutConfigurationPageObject(this.$scope.vuiWizardPages),n=this.getNetworkPageObject(this.$scope.vuiWizardPages),o=this.getVservicePageObject(this.$scope.vuiWizardPages),a=this.getCustomizeTemplatePageObject(this.$scope.vuiWizardPages);t&&(t.state=this.unskipEulaPage(e)?this.vuiConstants.wizard.pageState.DISABLED:this.vuiConstants.wizard.pageState.SKIPPED),i&&(i.state=this.unskipDeploymentConfigPage(e)?this.vuiConstants.wizard.pageState.DISABLED:this.vuiConstants.wizard.pageState.SKIPPED),r&&(r.state=this.unskipScaleoutConfiguration()?this.vuiConstants.wizard.pageState.DISABLED:this.vuiConstants.wizard.pageState.SKIPPED),n&&(n.state=this.unskipNetworksPage()?this.vuiConstants.wizard.pageState.DISABLED:this.vuiConstants.wizard.pageState.SKIPPED),a&&(a.state=this.unskipCustomizeTemplatePage()?this.vuiConstants.wizard.pageState.DISABLED:this.vuiConstants.wizard.pageState.SKIPPED),o&&(o.state=this.unskipVserviceProviderPage()?this.vuiConstants.wizard.pageState.DISABLED:this.vuiConstants.wizard.pageState.SKIPPED)},e.prototype.getEulaWizardPageObject=function(e){var t=this;return _.find(e,function(e){return e.title===t.i18nService.getString("Common","EulaControl.title")})},e.prototype.getDeploymentOptionsWizardPageObject=function(e){var t=this;return _.find(e,function(e){return e.title===t.i18nService.getString("Common","DeploymentOptions.title")})},e.prototype.getScaleoutConfigurationPageObject=function(e){var t=this;return _.find(e,function(e){return e.title===t.i18nService.getString("ProvisioningUiLib","ScaleoutPage.title")})},e.prototype.getNetworkPageObject=function(e){var t=this;return _.find(e,function(e){return e.title===t.i18nService.getString("ProvisioningUiLib","SelectNetworksPage.title")})},e.prototype.getCustomizeTemplatePageObject=function(e){var t=this;return _.find(e,function(e){return e.title===t.i18nService.getString("Common","UserDefinedPropertiesPage.title")})},e.prototype.getVservicePageObject=function(e){var t=this;return _.find(e,function(e){return e.title===t.i18nService.getString("ProvisioningUiLib","VServicePage.title")})},e.prototype.unskipEulaPage=function(e){var t=this,i=_.find(e,function(e){return _.isEqual(e._type,t.EULA_OBJ_TYPE)});return i&&!_.isEmpty(i.eulas)},e.prototype.unskipDeploymentConfigPage=function(e){var t=this,i=_.find(e,function(e){return _.isEqual(e._type,t.DEPLOYMENT_OPTIONS_OBJ_TYPE)});return!_.isUndefined(i)},e.prototype.unskipScaleoutConfiguration=function(){var e=this.viewData.getSclaeoutConfigurationFromLibraryCommonContext();return!_.isUndefined(e)&&Array.isArray(e.groups)&&e.groups.length>0},e.prototype.unskipNetworksPage=function(){var e=this.viewData.getNetworkMappingParamsFromLibraryCommonContext(),t=this.viewData.getIpAllocationParamsFromLibraryCommonContext();return!_.isUndefined(e)||!_.isUndefined(t)},e.prototype.unskipCustomizeTemplatePage=function(){var e=this.viewData.getCustomizeTemplateFromLibraryCommonContext();return!_.isUndefined(e)},e.prototype.unskipVserviceProviderPage=function(){var e=this.viewData.getVserviceContextFromLibraryCommonContext();return!_.isUndefined(e)},e.$inject=["$scope","i18nService","vuiConstants","vmProvisioningProductDetailsDataModel"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmProvisioningProductDetailsController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){var t=this;this.$scope=e,this.scaleoutConfiguration={params:this.getScaleoutConfigurationParams(),valid:!0},this.$scope.vuiWizard.currentPage.disableNext=function(){return!t.scaleoutConfiguration.valid}}return e.prototype.getScaleoutConfigurationParams=function(){var e=this.$scope.vmProvisioningScaleoutConfigurationPageModel.virtualMachineSpecBuilderObj.getSclaeoutConfigurationFromLibraryCommonContext();return e.groups},e.$inject=["$scope"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmProvisioningScaleoutConfigurationController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.OvfDeployConstants,i=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/createVmWizard/deployOvfPages/vmProvisioningSelectOvf/vm-provisioning-select-ovf.component.html",this.controller=r,this.controllerAs="ctrl",this.bindings={pageModel:"<",wizard:"<",wizardManager:"<",config:"<"}}return e}(),r=function(){function e(e,i,r,n,o,a,s){var c=this;this.$scope=e,this.AngularInjector=i,this.clarityModalService=r,this.i18nService=n,this.vuiConstants=o,this.featureFlagsService=a,this.ovfSelectionValidator=s,this.ovfSelectionErrorMsg="",this.mode="deploy",this.DUMMY_LIBRARY_ID="urn:vapi:com.vmware.content.Library:Dummy-Library-Id",this.onSelectorComponentStatusChanged=function(e){if(!e.isValid)return c.form.ovfUrl=null,c.form.selectedFiles=null,c.form.isValid=!1,void(c.ovfSelectionErrorMsg="");if(e.sourceType===t.DEPLOYMENT_URL)c.form.isValid=!0,c.form.isLocalDeployment=!1,c.form.ovfUrl=e.url,c.ovfSelectionErrorMsg="";else{if(c.form.isLocalDeployment=!0,e.workflowType===t.TEMPLATE_TYPE_OVF)c.ovfSelectionValidator.validate(c.contextObjId,e.selectedFiles).then(function(t){c.form.isValid=!t.hasError,c.form.userSelectedFiles=e.selectedFiles,c.ovfSelectionErrorMsg=t.hasError?t.errorMsg:""});else if(e.workflowType===t.TEMPLATE_TYPE_OVA){var i=c.AngularInjector.get("vscOvaMapperProxyService");i&&i.getFilesFromOva(e.selectedFiles[0]).then(function(e){c.ovfSelectionValidator.validate(c.contextObjId,e).then(function(t){c.form.isValid=!t.hasError,c.form.userSelectedFiles=e,c.ovfSelectionErrorMsg=t.hasError?c.i18n("ProvisioningUiLib","DeployOvfPage.invalidOva"):""})})}c.form.selectedFiles=e.selectedFiles}},this.i18n=n.getString}return e.prototype.$onInit=function(){var e=this;this.form=this.pageModel.form,this.fileBrowserOptions={enabled:!0,showValidationErrors:!0,selectMultiple:!0,fileFilter:[]},this.contextObjId=this.pageModel.getContextObjId(),this.wizard.currentPage.onCommit=function(){var t=e.AngularInjector.get("vscUriProbeService");return e.form.hasAcceptedUntrustedSource||e.form.isLocalDeployment?(e.wizard.currentPage.state=e.vuiConstants.wizard.pageState.COMPLETED,e.pageModel.submitPage(),!0):(e.config.loading=!0,e.config.loadingMessage=e.i18n("CommonUi","wizard.validating"),t.validate({url:e.form.ovfUrl,libraryId:e.DUMMY_LIBRARY_ID}).then(function(t){return e.config.loading=!1,t&&t.unknownSource?(e.openSslThumbprintAlert(t.sslThumbprint),!1):(e.wizard.currentPage.state=e.vuiConstants.wizard.pageState.COMPLETED,e.pageModel.submitPage(),!0)},function(t){return e.form.isValid=!1,e.ovfSelectionErrorMsg=t&&t.displayErrors?t.displayErrors[0]:"",!1}))}},e.prototype.openSslThumbprintAlert=function(e){var t=this;this.clarityModalService.openConfirmationModal({title:this.i18n("LibraryUi","ProbeUtil.probeFailureDialog.title"),message:_.isEmpty(e)?this.i18nService.getString("LibraryUi","ProbeUtil.probeFailureDialog.message.certificateError"):this.i18nService.getString("LibraryUi","ProbeUtil.probeFailureDialog.message.certificateErrorWithThumbprint",e),preserveNewlines:!_.isEmpty(e),saveButtonLabel:this.i18n("LibraryUi","yes"),clarityIcon:{shape:"warning","class":"is-warning",size:_.isEmpty(e)?32:64},submit:function(){return t.form.sslThumbprint=e,t.form.hasAcceptedUntrustedSource=!0,t.wizardManager.onNextClick(),!0},onCancel:function(){t.form.sslThumbprint=""}})},e.$inject=["$scope","AngularInjector","clarityModalService","i18nService","vuiConstants","featureFlagsService","vscOvfSelectionValidatorProxyService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmProvisioningSelectOvfComponent",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.$scope=e,this.vserviceContext=e.wizardViewData.getVserviceContextFromLibraryCommonContext(),this.vserviceContext&&this.vserviceContext.dependencies&&this.vserviceContext.dependencies.forEach(function(e){if(e.availableProviders){var t=0;e.selectedProviderKey&&(t=e.availableProviders.findIndex(function(t){return t.key===e.selectedProviderKey})),e.selectedProviderKey=e.availableProviders[t].key}})}return e.$inject=["$scope"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmProvisioningVserviceController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.controller=i,this.templateUrl="vm-ui/resources/vm/views/createVmWizard/vm-provisioning-clone-options-page.component.html",this.bindings={pageModel:"<",creationType:"<",wizardConfig:"<"}}return e}();e.VmProvisioningCloneOptionsComponent=t;var i=function(){function e(e,t,i){this.wizardPageService=e,this.i18nService=t,this.configurationService=i,this.i18n=t.getString}return e.prototype.$onInit=function(){var e=this;this.pageModel.resetForm(),this.pages=this.wizardConfig.pages;var t=this.wizardConfig.flows;if(t&&t.length>0){var i=_.find(t,function(t){return e.creationType===t.id});i&&(this.pages=i.pages)}this.changeGosPageState(),this.changeCustomizeHwPageState()},e.prototype.changeGosPageState=function(){this.pageModel.form.customizeOs?this.wizardPageService.markPageDisabled(this.pages,this.i18nService.getString("VmUi","CustomizeGuestOsProvisioningPage.Title")):(this.wizardPageService.markPageSkipped(this.pages,this.i18nService.getString("VmUi","CustomizeGuestOsProvisioningPage.Title")),this.wizardPageService.markPageSkipped(this.pages,this.i18nService.getString("VmUi","UserSettingsPage.Title")))},e.prototype.changeCustomizeHwPageState=function(){this.pageModel.form.customizeHw?this.wizardPageService.markPageDisabled(this.pages,this.i18nService.getString("VmUi","CustomizeHardwareProvisioningPage.Title")):this.wizardPageService.markPageSkipped(this.pages,this.i18nService.getString("VmUi","CustomizeHardwareProvisioningPage.Title"))},e.$inject=["wizardPageService","i18nService","configurationService"],e}();e.VmProvisioningCloneOptionsController=i,angular.module("com.vmware.vsphere.client.vm").component("vmProvisioningCloneOptions",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,r){return function(n){return new i(e,t,r,n)}}return e.$inject=["$q","i18nService","vmProvisioningSelectTemplatePageModel"],e}(),i=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.vcTemplatePageModelService=i,this.initFromWizardScope(r)}return e.prototype.initFromWizardScope=function(e){this.vcTemplatePageModel=new this.vcTemplatePageModelService(e.vmParams,e.wizardViewData,e.config),this._virtualSpecBuilder=e.vmParams,this._wizardViewData=e.wizardViewData,this._wizardConfig=e.config},e.prototype.getVcTemplatePageModel=function(){return this.vcTemplatePageModel},e.prototype.getVcTemplateSelection=function(){return this.vcTemplatePageModel.getSelectionId()},e.prototype.getIsVcTemplateSelected=function(){return this.vcTemplatePageModel.getSelectionIsTemplate()},e.prototype.getClTemplateSelection=function(){var e=this._wizardViewData.getSelectedTemplate();return e},e.prototype.setClTemplateSelection=function(e){this._wizardViewData.setSelectedTemplate(e)},e.prototype.resetStorage=function(){this._virtualSpecBuilder&&this._virtualSpecBuilder.resetStorage()},e.prototype.resetForm=function(){},e.prototype.isSameTemplate=function(e,t){return!(!e||!t)&&e.templateId===t.templateId},e.prototype.isTemplateChanged=function(){var e=this._wizardViewData.getSelectedTemplate(),t=this.submittedClTemplate;return!this.isSameTemplate(e,t)},e.prototype.validatePage=function(){return this._wizardViewData.getSelectedTemplate()?{}:this.vcTemplatePageModel.validatePage()},e.prototype.submitPage=function(){var e=this._wizardViewData.getSelectedTemplate();if(e){this._wizardConfig.title=this.i18nService.getString("VmUi","ProvisioningTypes.DeployFromTemplate.WizardTitle.2",e.templateName);var t=this.isTemplateChanged(),i={wizardFlow:"deployVmFromAnyTemplate",invalidateNextPages:t};return this._virtualSpecBuilder.setVmId(void 0),t&&(this.resetStorage(),this.submittedClTemplate=e),i}this.submittedClTemplate&&(this.submittedClTemplate=null,this.resetStorage());var r=this.vcTemplatePageModel.submitPage();return r.wizardFlow="deployVmFromAnyTemplate",r},e.$inject=["$q","i18nService","vmProvisioningSelectTemplatePageModel"],e}();e.VmProvisioningSelectAnyTemplatePageModel=i,angular.module("com.vmware.vsphere.client.vm").factory("vmProvisioningSelectAnyTemplatePageModel",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={pageModel:"<",wizardViewData:"<",onSelectionChanged:"&"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/createVmWizard/vm-provisioning-select-template-page.component.html"}return e}();e.VmProvisioningSelectTemplateComponent=t;var i=function(){function e(e,t){this.defaultUriSchemeUtil=e,this.i18nService=t,this.treeViewConfig={preselectRoot:!1,expandPreselectedNode:!0},this.selectTemplateDescription=this.i18nService.getString("VmUi","SelectTemplateProvisioningPage.Template.Description")}return e.prototype.$onInit=function(){var e=this.pageModel.virtualMachineSpecBuilder.getCreationType();e===this.pageModel.getLastSelectedCreationType()?this.preselectionId=this.pageModel.getSelectionId():this.pageModel.clearSelection()},e.prototype.onChange=function(e){var t=this;this.setLoadingIndicator(!0),this.pageModel.updateSelection(e),this.triggerOnSelectionChange(),this.pageModel.validateSelection().then(function(e){t.compatibilityMessage=e,t.setLoadingIndicator(!1)})},e.prototype.setLoadingIndicator=function(e){this.pageModel.showLoadingIndicator&&(this.pageModel.config.loading=e)},e.prototype.triggerOnSelectionChange=function(){this.onSelectionChanged&&this.onSelectionChanged()},e.$inject=["defaultUriSchemeUtil","i18nService"],e}();e.VmProvisioningSelectTemplateToConvertPageController=i,angular.module("com.vmware.vsphere.client.vm").component("vmProvisioningSelectTemplate",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){var t=this;this.$scope=e,this.pageModel=e.vappPropertiesPageModel,this.vAppPropertyDescriptors=this.pageModel.getVappPropertyDescriptors(),this.pageModel.retrieveIpPoolsData().then(function(e){t.networks=e.networks,t.ipPoolData=e.ipPoolData,t.ipProtocol=e.ipProtocol})}return e.$inject=["$scope"],e}();e.VmProvisioningVappPropertiesController=t,angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningVappPropertiesController",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i){var r=this,n=e.vmProvisioningCloneCustomizeGuestOsPageModel;r.form=n.getForm(),r.readyToView=!1,r.uncustomizableMessage="",n.resetForm(),r.form.setPageLoading=function(t){e.config.loading=t},r.form.showUserSettingsPage=function(r){var n=e.config.pages;if(e.config.flows&&e.config.flows.length>0){var o=_.find(e.config.flows,function(t){return e.attributes.creationType===t.id});o&&(n=o.pages)}r?i.markPageDisabled(n,t.getString("VmUi","UserSettingsPage.Title")):i.markPageSkipped(n,t.getString("VmUi","UserSettingsPage.Title"))},e.preselectGuestOsComparator=function(e){return!!r.form.selectedSpec&&e.name===r.form.selectedSpec.name},e.$watch(function(){return r.form.datagridOptions.selectedItems},function(t,n){t!==n&&(i.clearErrors(e.config),r.form.selectedSpec=t&&0!==t.length?t[0]:null)},!0)}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningCloneGuestOsController",e),e.$inject=["$scope","i18nService","wizardPageService"]}(),function(){"use strict";function e(e,t,i,r){function n(t){e.config.loading=t}function o(e){a.isValidating=!!e}var a=this;e.$on("$destroy",function(){n(!1)}),e.computeResourcePageModel.resetForm(),a.title=t.getString("VmUi","SelectResourcePoolProvisioningPage.Compatibility"),a.description=t.getString("VmUi","SelectResourcePoolProvisioningPage.Description"),a.pageReady=!1,n(!0),e.computeResourcePageModel.getTreeType().then(function(e){a.treeType=e,a.pageReady=!0,a.preselectedNode||n(!1)}),a.rootObjReference=e.computeResourcePageModel.getTreeRootReference(),a.preselectedNode=e.computeResourcePageModel.form.selectedComputeResourceId,a.config={preselectRoot:!1};var s=0;a.onChange=function(r,c){e.wizardManager.clearValidationBanner(),e.computeResourcePageModel.form.selectedComputeResourceId=r,e.computeResourcePageModel.form.selectedComputeResourceName=c,e.config.loadingMessage=t.getString("CommonUi","wizard.validating"),a.validatingSelectedCrAriaLabel=t.getString("VmUi","ProvisioningWizard.selectCrPage.validatingAriaLabelFormat",e.computeResourcePageModel.form.selectedComputeResourceName);var l=++s;n(!1),o(!0),e.computeResourcePageModel.validateSelection().then(function(e){l===s&&(a.contents=e)}).then(function(){l===s&&o(!1),i.digest()})},a.onError=function(e){e.name===r.SELECTION.name&&n(!1)}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningComputeResourceController",e),e.$inject=["$scope","i18nService","zoneDigestPatchService","treeViewErrorConstants"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){function g(e){return e===l.CLONE_VM_TO_TEMPLATE||e===l.CLONE_VM_TO_VM||e===l.CLONE_TEMPLATE_TO_VM||e===l.CLONE_TEMPLATE_TO_TEMPLATE||e===l.CLONE_AS_VMTEMPLATE_TO_LIBRARY||e===l.DEPLOY_VM_FROM_VMTX||E.isDiskGroupsAvailable()}function h(e,t,i){S(!0);var r=++x,n=I.storageSelectorApi.validateReplicationGroupSelection(),o=I.storageSelectorData.vmStorageConfig[0];E.validateSelection(e,t,i,n,o).then(function(e){r===x&&(I.contents=e,O=!0)}).then(function(){r===x&&S(!1)})}function f(e){S(!0);var t=++x,i=I.storageSelectorData.vmStorageConfig[0];E.validateAdvancedSelection(e,i).then(function(e){t===x&&(I.contents=e)}).then(function(){t===x&&S(!1)})}function S(t){I.isValidating=!!t,e.config.loading=t}function y(){I.form.diskFormatSettings.diskFormatSupported=P(),I.form.diskFormatSettings.sameAsSourceSupported=C(),I.form.diskFormatSettings.drsPlacement=E.isInDeployTemplateMode()}function P(){return E.isInCloningMode()||E.isInDeployFromTemplateMode()}function C(){return E.isInCloningMode()}function D(e){return e?{label:e.name,id:e.profileId.uniqueId,profileObj:e
}:null}function w(){var e=_.some(I.storageSelectorData.vmStorageConfig,function(e){return!e.vmHome.storageObj||I.storageSelectorState.storageBaselineId!==c.PMEM_STORAGE_BASELINE.id&&_.some(e.vmDisks,function(e){return!e.storageObj&&!v.isPMemStoragePolicy(e.storageProfile)})});return!e}function b(){r(function(){var e=i[0].querySelector("input:not([disabled]),select,button");e&&e.focus()},0)}var I=this,T=!1;I.i18n=n;var E=e.datastorePageModel;I.form=E.form;var V=!!e.scheduleTaskData&&e.scheduleTaskData.isScheduledTask;I.podDisplayDisabled=E.podDisplayDisabled()||V,I.isVmtxWorkflow=E.isCloningVmtxTemplate()||E.isDeployVmFromVmtxTemplate(),I.isDiskGroupsAvailable=!1,I.disableDefaultPreselectionInBasicMode=E.virtualMachineSpecBuilder.isXvc(),I.showReplicationGroups=!E.isInDeployVmFromOvf(),I.storageSelectorApi=s.getStorageSelectorApiObj(),I.showStorageBaselineSignpostHints=!E.isInCloningMode(),I.isEncryptionOptionsVisible=!E.isInCloningMode()&&E.virtualMachineSpecBuilder.getHasEncryptNewVmPrivilege(),I.isEncryptionOptionsDisabled=!0,I.encryptionOptionsDisabledReason=void 0,E.virtualMachineSpecBuilder.getStoragePageData().then(function(e){if(e=e.vmStoragePageData,!I.encryptionOptionsDisabledReason){if(e&&e.h5DefaultKmipClusterStatus&&e.h5DefaultKmipClusterStatus.noPermission)return void(I.isEncryptionOptionsDisabled=!1);var t=e&&e.h5DefaultKmipClusterStatus&&e.h5DefaultKmipClusterStatus.connectionStatus===h5_vm.ConnectionStatus.CONNECTED,i=e&&e.h5DefaultKmipClusterStatus&&e.h5DefaultKmipClusterStatus.certificateStatus===h5_vm.CertStatus.EXPIRED;I.isEncryptionOptionsDisabled=!t||i,t?i&&(I.encryptionOptionsDisabledReason=n.getString("VmUi","VmCryptConfig.reason.kmsCertificateRequiresUpdate")):I.encryptionOptionsDisabledReason=n.getString("VmUi","VmCryptConfig.reason.noKms")}},function(){I.isEncryptionOptionsDisabled=!0,I.encryptionOptionsDisabledReason=n.getString("VmUi","VmCryptConfig.reason.noKms")});var M=angular.copy(E.virtualMachineSpecBuilder.getStorageSelectorState());M?(this.form.storageSelectorState=M,this.storageSelectorState=M):(this.form.storageSelectorState=s.getStorageSelectorState(),T=!0),this.storageSelectorState=this.form.storageSelectorState,I.title=n.getString("VmUi","SelectDatastoreProvisioningPage.Compatibility"),I.description=n.getString("VmUi","SelectDatastoreProvisioningPage.Description"),I.pageLoadError=void 0,e.config.loading=!0;var O=!0;if(this.onShowDetailsClick=function(e){var i=_.chain(e).pluck("hostId").without(void 0).uniq().value();return i.length&&O?d.getPropertiesForObjects(i,["primaryIconId"]).then(function(t){_.each(e,function(e){e.hostId&&(e.icon=t[e.hostId].primaryIconId)})}):t.resolve()},E.isCloningVmtxTemplate()&&!m.CL_Native_VMTX_Phase2Enabled()){var A=e.wizardViewData.getSourceObjectId();E.setComputeResourceId(A)}var k=E.getComputeResourceOwnerId()||E.getComputeResourceId(),R=E.getStorageLocatorData(k),N=E.getProfilesData(E.getServerGuid()),U=E.virtualMachineSpecBuilder.getVmId()||e.wizardViewData&&e.wizardViewData.getSelectedTemplate()&&e.wizardViewData.getSelectedTemplate().templateId,L={model:E.load(),grid:R,profiles:N};if(g(E.virtualMachineSpecBuilder.getCreationType()))if(E.isInDeployFromTemplateMode())L.getStorageSelectorData={},L.getStorageSelectorData.virtualDisks=E.requestVmDisksInDeployFromTemplateMode(),L.getStorageSelectorData.vmHomeDatastore=E.requestVmHomeDatastoresInDeployFromTemplateMode(),I.isDiskGroupsAvailable=!0;else{var F=E.getStorageSelectorData(U);L.getStorageSelectorData=F}else E.isInDeployFromTemplateMode()?(L.getStorageSelectorData={},L.getStorageSelectorData.virtualDisks=E.requestVmDisksInDeployFromTemplateMode(),L.getStorageSelectorData.vmHomeDatastore=E.requestVmHomeDatastoresInDeployFromTemplateMode()):(L.getStorageSelectorData={},L.getStorageSelectorData.virtualDisks=E.form.vmDisksData,L.getStorageSelectorData.vmHomeDatastore=E.form.vmsHomeDatastore);t.all(L).then(function(t){if(!t.grid)return I.pageLoadError=new Error(n.getString("VmUi","SelectDatastoreProvisioningPage.noStorageAvailable")),I.pageReady=!1,void(e.config.loading=!1);y();var i=E.virtualMachineSpecBuilder.getVmId(),r=t.profiles;if(I.isEncryptionOptionsVisible){var a=_.find(r.storageProfiles,function(e){return u.isEncryptionStorageProfile(e)});a||(E.virtualMachineSpecBuilder.getHasManageEncryptionPolicyPrivilege()||(I.isEncryptionOptionsVisible=!1),I.encryptionOptionsDisabledReason||(I.isEncryptionOptionsDisabled=!0,I.encryptionOptionsDisabledReason=n.getString("VmUi","VmCryptConfig.reason.noEncryptionPolicies")))}t.getStorageSelectorData&&(r.vmProfileAssignments={},r.vmProfileAssignments[U]=t.getStorageSelectorData.storagePoliciesAssignments,r.vmReplicationGroupAssignments={},r.vmReplicationGroupAssignments[U]=t.getStorageSelectorData.vmReplicationGroupAssignments),E.isInDeployFromTemplateMode()&&(I.unsupportedStorageBaselineIds=[c.PMEM_STORAGE_BASELINE.id],r._storageProfiles=E.getRecommendedProfilesForTemplateDeployment(r.storageProfiles),I.form.storageLocatorItemsData.datastoreItems=E.getRecommendedDatastoresForTemplateDeployment()),I.modeSettings=s.getStorageSelectorModeSettings(g(E.virtualMachineSpecBuilder.getCreationType()));var d=E.getVmNames();d[i]=E.virtualMachineSpecBuilder.getName();var v="HostSystem"===o.getEntityType(E.getComputeResourceId())?E.getComputeResourceId():null,m=t.getStorageSelectorData.virtualDisks,h=t.getStorageSelectorData.vmHomeDatastore,f=[];(i||m)&&f.push({id:i,name:d[i],homeDatastore:h?h[i]:null,destinationHost:v,disksData:m?m[i]:null}),s.getStorageSelectorData(i||E.getComputeResourceId(),I.form.storageLocatorItemsData,!0,f,r).then(function(t){!i&&t.sourceVmStorageConfig&&t.sourceVmStorageConfig.length&&!t.sourceVmStorageConfig[0].destinationHostId&&(t.sourceVmStorageConfig[0].destinationHostId=v),I.storageSelectorData=t;var n=E.virtualMachineSpecBuilder.getScheduledData();if(n&&n.storageData){var o=E.virtualMachineSpecBuilder.getCreationType()===l.CREATE_FROM_SCRATCH;p.computeSourceVmStorageConfig(n.storageData.initialVmStorageConfig,r._storageProfiles,I.storageSelectorData,o)}E.virtualMachineSpecBuilder.setSourceVmStorageConfig(t.sourceVmStorageConfig);var a;if(t.sourceVmStorageConfig&&t.sourceVmStorageConfig.length&&(a=I.storageSelectorData.sourceVmStorageConfig[0].vmHome.replicationGroup),t.storageProfilesData.error?E.virtualMachineSpecBuilder.containsSpbmIssues(!0):E.virtualMachineSpecBuilder.containsSpbmIssues(!1),!M&&(I.form.storageLocatorItemsData.datastoreItems.length>0||I.form.storageLocatorItemsData.storagePodItems.length>0)){var c=E.getItemToSelect(I.form.storageLocatorItemsData.datastoreItems,I.form.storageLocatorItemsData.storagePodItems),d=E.getProfileToSelect();I.storageSelectorData.initialConfig=s.getStorageSelectorInitialConfig(c,d,a),n&&n.storageData&&p.initSelectedStorageItems(I.storageSelectorState,I.storageSelectorData,n.storageData)}I.pageReady=!0,e.config.loading=!1,b()}),!I.form.storageProfileHasBeenSelected&&r.vmProfileAssignments&&r.vmProfileAssignments[i]&&r.vmProfileAssignments[i].homeStorageProfile&&(I.form.storageProfilesData.selectedProfile=D(r.vmProfileAssignments[i].homeStorageProfile))});var x=0;I.onSelectionChanged=function(){e.wizardManager.clearValidationBanner();var t=I.storageSelectorData.vmStorageConfig[0].vmHome.storageProfile;I.form.vmStorageConfig=I.storageSelectorData.vmStorageConfig,I.form.diskFormatSettings=I.storageSelectorState.basicModeState.diskFormatSettings,E.setSelectionIsValid(!1);var i;switch(I.storageSelectorState.mode){case"basicMode":i=I.storageSelectorState.basicModeState.selectedItem,(E.isInDeployTemplateMode()||w()||I.storageSelectorData.storageProfilesData.error)&&h(i,t&&t.id,I.form.diskFormatSettings),I.form.isAdvancedStorageMode=!1,E.virtualMachineSpecBuilder.setStorageSelectorState(I.form.storageSelectorState);break;case"advancedMode":i=I.storageSelectorState.vmStorageConfigInAdvancedMode[0].vmHome.storageObj,I.form.isAdvancedStorageMode=!0,f(i),(T||I.form.storageSelectorState.recentlySelectedStorageItemsInAdvancedMode&&I.form.storageSelectorState.recentlySelectedStorageItemsInAdvancedMode.length)&&(E.virtualMachineSpecBuilder.setStorageSelectorState(I.form.storageSelectorState),T=!1)}}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningDatastorePageController",e),e.$inject=["$scope","$q","$element","$timeout","i18nService","defaultUriSchemeUtil","diskFormatService","storageSelectorService","storageSelectorConstants","creationTypeConstants","dataService","storageProfileService","initialStorageConfigurationService","pmemUtilService","featureFlagsService"]}(),function(){"use strict";function e(e,t,i,r){var n=this,o=e.vmProvisioningFinishCloneVmPageModel;o.resetForm(),n.form=o.form;var a=o.getSourceObjectInfo(),s=o.getTargetObjectInfo(),c=o.getComputeResourceInfo();e.computeResourceName=c.name,e.computeResourceType=c.label,e.provisioningTypeName=o.presentProvisioningType(),e.sourceObjectName=a.name,e.sourceObjectLabel=a.label,e.targetObjectName=s.name,e.targetObjectLabel=s.label,n.datastoreLabel=o.presentTargetStorageName(),n.isStorageProfileAvailable=function(){return o.isStorageProfileSpecified()},n.isReplicationGroupAvailable=function(){return o.isReplicationGroupSpecified()},e.targetFolderName=o.getTargetFolderName(),e.diskFormat=o.presentDiskFormat(),e.vmStorageProfile=o.getStorageProfile(),e.vmReplicationGroup=o.getReplicationGroup(),e.gosCustomizationSpecName=o.getGosCustomizationSpecName(),e.gosWasCustomized=o.isGosCustomized(),e.newDisks=o.shouldShowDisks()?o.getNewDisks():[],e.existingDisks=o.shouldShowDisks()?o.getExistingDisks():[],e.nvdimmDevices=o.getNvdimmDevicesInfo(),e.shouldDsiplayHwCustomizedProperties=o.shouldDsiplayHwCustomizedProperties(),e.shouldDsiplayHwCustomizedProperties&&(e.numberOfCpus=o.getNumberOfCpus(),e.allocatedMemory=o.getAllocatedMemory(),e.networkDevices=o.getNetworkInterfaces()),e.config.loadingMessage=i.getString("CommonUi","wizard.loading"),e.config.loading=!0,o.fetchStoragePlacementRecommendations().then(function(){n.recommendationFaults=[]},function(e){n.recommendationFaults=e}).then(function(){e.config.loading=!1,n.datastoreLabel=o.presentTargetStorageName(),o.setDisksDatastoreInfo(e.newDisks),o.setDisksDatastoreInfo(e.existingDisks)}),n.openFaultsDialog=function(){t.openFaultsDialog(e,n.recommendationFaults)},n.openRecommendationsDialog=function(i){t.openRecommendationsDialog(i?i.diskKey:void 0,e,o).then(function(){n.datastoreLabel=o.presentTargetStorageName(),o.setDisksDatastoreInfo(e.newDisks),o.setDisksDatastoreInfo(e.existingDisks)})},n.shouldDisplayRecommendations=function(e){if(o.virtualMachineSpecBuilder.isXvc())return!1;if(r.DEPLOY_VM_FROM_VMTX===o.virtualMachineSpecBuilder.getCreationType())return!1;var i;if(e){if(i=e.getStorageObject(),e.isPmemDisk)return!1}else i=o.virtualMachineSpecBuilder.getStorageObject();return t.areRecommendationsAvailableForStorageObject(i)},n.isNewDisk=function(e){return e.diskKey<0},n.shouldShowStorageProfile=function(e){var t={key:e.diskKey};return!o.diskHasDefaultStoragePolicy(t)},this.shouldShowDiskFormat=function(){return e.diskFormat&&!o.isAdvancedStorageMode()},n.getStorageHint=function(){var e="";if(o.shouldShowDisks())return e;var t=o.getPmemDiskInfo();return t.hasPmemDisk&&(e=t.hasRegularDisk?i.getString("VmUi","ProvisioningWizardSummaryPage.pmem.hint.hybridBaseline"):i.getString("VmUi","ProvisioningWizardSummaryPage.pmem.hint.pmemBaseline")),t.hasDowngradedPmemDisk&&(e=i.getString("VmUi","ProvisioningWizardSummaryPage.pmem.hint.standardBaseline")),e},n.vappPropertyDescriptors=function(){var e=o.virtualMachineSpecBuilder.getVappPropertyDescriptors();return _.isEmpty(e)?[]:_.filter(e,function(e){return e.userConfigurable&&"expression"!==e.type&&0!==e.type.indexOf("password")})}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningFinishCloneController",e),e.$inject=["$scope","datastoreRecommendationService","i18nService","creationTypeConstants"]}(),function(){"use strict";function e(e,t,i){var r=this,n=e.vmProvisioningFinishCreateVmPageModel,o=n.getComputeResourceInfo();e.computeResourceName=o.name,e.computeResourceLabel=o.label,r.datastoreLabel=n.presentTargetStorageName(),r.isStorageProfileAvailable=function(){return n.isStorageProfileSpecified()},r.isVmHomeEncrypted=function(){return n.isVmHomeEncrypted()},r.areAllDisksEncrypted=function(){return n.areAllDisksEncrypted()},e.numberOfCpus=n.getNumberOfCpus(),e.allocatedMemory=n.getAllocatedMemory(),e.vmVersion=n.getVmVersionCompatibility(),e.vmName=n.getVmName(),e.targetFolderName=n.getTargetFolderName(),e.vmStorageProfile=n.getStorageProfile(),e.vmReplicationGroupLabel=n.getReplicationGroup(),e.guestOsName=n.getGuestOsName(),e.vbsEnabled=n.getVbsEnabled(),e.networkDevices=n.getNetworkInterfaces(),e.disks=n.getDisks(),e.scsiControllers=n.getScsiControllers(),e.tpmDeviceExists=!!n.getTpmDevice(),e.nvdimmDevices=n.getNvdimmDevicesInfo(),e.config.loadingMessage=i.getString("CommonUi","wizard.loading"),e.config.loading=!0,n.fetchStoragePlacementRecommendations().then(function(){r.recommendationFaults=[]},function(e){r.recommendationFaults=e}).then(function(){e.config.loading=!1,r.datastoreLabel=n.presentTargetStorageName(),n.setDisksDatastoreInfo(e.disks)}),r.openFaultsDialog=function(){t.openFaultsDialog(e,r.recommendationFaults)},r.openRecommendationsDialog=function(i){t.openRecommendationsDialog(i?i.diskKey:void 0,e,n).then(function(){r.datastoreLabel=n.presentTargetStorageName(),n.setDisksDatastoreInfo(e.disks)})},r.shouldDisplayRecommendations=function(e){var i;return i=e?e.getStorageObject():n.virtualMachineSpecBuilder.getStorageObject(),t.areRecommendationsAvailableForStorageObject(i)},r.isNewDisk=function(e){return e.diskKey<0},r.shouldShowStorageProfile=function(e){var t={key:e.diskKey};return!n.diskHasDefaultStoragePolicy(t)}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningFinishController",e),e.$inject=["$scope","datastoreRecommendationService","i18nService"]}(),function(){"use strict";function e(e){var t=e.vmProvisioningFinishConvertToVmPageModel,i=t.getComputeResourceInfo();this.provisioningTypeName=t.getProvisioningType(),this.templateName=t.getTemplateName(),this.targetResourceTypeLabel=i.label,this.targetResourceName=i.name}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningFinishConvertToVmController",e),e.$inject=["$scope"]}();var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.$onInit=function(){var e=this.pageModel.getIsTemplate();this.vmNameLabel=e?this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.TemplateName"):this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.VmName"),this.vmName=this.pageModel.getVmName(),this.targetFolderLabel=this.i18nService.getString("VmUi","ProvisioningWizardSummaryPage.Folder"),this.targetFolderName=this.pageModel.getTargetFolderName();var t=this.pageModel.getComputeResourceInfo();this.computeResourceType=t.label,this.computeResourceName=t.name},e.$inject=["i18nService"],e}();e.VmProvisioningFinishRegisterController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/createVmWizard/vmProvisioningFinishRegisterComponent.html",this.bindings={pageModel:"<"}}return e}();e.VmProvisioningFinishRegisterComponent=i,angular.module("com.vmware.vsphere.client.vm").component("vmProvisioningFinishRegister",new i)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i){var r=this;e.config.loadingMessage=t.getString("CommonUi","wizard.loading"),e.config.loading=!0,e.guestOsPageModel.resetForm().then(function(){e.config.loading=!1}),r.form=e.guestOsPageModel.form,e.$on("$destroy",function(){e.config.loading=!1});var n="vm-ui/resources/vm/views/createVmWizard/enableVBSHelpText.html";i.renderTemplateWithScope(n,e).then(function(i){e.enableVBSSignPostParams={message:i,title:t.getString("Common","help"),"class":"cpu-mmu-help-text"}})}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningGuestOsController",e),e.$inject=["$scope","i18nService","templateHelperService"]}(),function(){"use strict";function e(e,t,i,r){function n(t){e.config.loading=t}var o=this;e.nameAndFolderPageModel.resetForm(),o.form=e.nameAndFolderPageModel.form,o.treeType=e.nameAndFolderPageModel.getTreeType(),o.treeRoot=e.nameAndFolderPageModel.getTreeRoot(),o.preselectedLocation=e.nameAndFolderPageModel.targetIdToPreselect(),o.pageInstructions=e.nameAndFolderPageModel.pageInstructions(),o.wizardType=e.vmParams.getCreationType(),o.invalidNameMessage="",o.onNameChanged=function(){o.invalidNameMessage=e.nameAndFolderPageModel.checkVmName(!1),o.wideTooltip=o.invalidNameMessage.length>80},o.onTargetChange=function(i,r,a,s){_.assign(o.form.selectedTarget,{uid:i,name:r,type:a,item:s}),n(!0),e.config.loadingMessage=t.getString("CommonUi","wizard.validating"),e.nameAndFolderPageModel.validateSelection().then(function(e){o.compatibilityMessage=e,n(!1)})};var a=e.vuiWizardPages;o.changeGosPageState=function(){o.form.customizeOs?r.markPageDisabled(a,t.getString("VmUi","CustomizeGuestOsProvisioningPage.Title")):(r.markPageSkipped(a,t.getString("VmUi","CustomizeGuestOsProvisioningPage.Title")),r.markPageSkipped(a,t.getString("VmUi","UserSettingsPage.Title")))},o.isInDeployFromTemplateMode=function(){return o.wizardType===i.DEPLOY_VM_FROM_TEMPLATE},e.$on("$destroy",function(){n(!1)})}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningNameAndFolderController",e),e.$inject=["$scope","i18nService","creationTypeConstants","wizardPageService"]}();var h5_vm;!function(e){var t=function(){function e(){}return e.DHCP="DHCP",e.STATIC_MANUAL="STATIC_MANUAL",e.STATIC_IPPOOL="STATIC_IPPOOL",e.TRANSIENT_IPPOOL="TRANSIENT_IPPOOL",e}();e.IpAllocationPolicy=t;var i=function(){function e(){}return e.IPV4="IPV4",e.IPV6="IPV6",e}();e.IpProtocol=i;var r=function(){function e(e,t,i){this.$scope=e,this.i18nService=t,this.vuiConstants=i,this.i18n=this.i18nService.getString}return e.prototype.$onInit=function(){var e=this;this.networkMappings&&(this.dataGridOptions={columnDefs:[{displayName:this.i18nService.getString("ProvisioningUiLib","NetworkMappingsControl.templateNetworkColumnHeader"),field:"name"},{displayName:this.i18nService.getString("ProvisioningUiLib","NetworkMappingsControl.selectedNetworkColumnHeader"),field:"target",template:function(){return e.buildDestinationNetworkDropdown()}}],selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.networkMappings.sourceNetworks},this.cancelOnTargetNetworkChanged=this.$scope.$on("onTargetNetworkChanged",function(t,i){var r=e.findNetworkByName(i.name);r.target=i.target})),_.isEmpty(this.ipAllocationParams)||(this.populateLocalizedNamesForIpAllocation(),this.populateLocalizedNamesForIpProtocol())},e.prototype.shouldDisplayIpAllocation=function(){return!_.isEmpty(this.ipAllocationParams)},e.prototype.findNetworkByName=function(e){var t=_.find(this.networkMappings.sourceNetworks,function(t){return t.name===e});return t},e.prototype.buildDestinationNetworkDropdown=function(){var e=this,t=['<div class="select" >','<select class="location-select"',"ng-change=\"$emit('onTargetNetworkChanged',dataItem)\"",'name="destination-networks"','ng-model="dataItem.target">'];_.each(this.networkMappings.targetNetworks,function(i){i.accessible&&t.push(e.buildDestinationNetworkOption(i.id,i.name))}),t.push(["</select></div>"]);var i=t.join("");return i},e.prototype.buildDestinationNetworkOption=function(e,t){return'<option value="'+e+'">'+t+"</option>"},e.prototype.getLocalizedIpAllocationPolicy=function(e){switch(e){case t.STATIC_MANUAL:return this.i18nService.getString("ProvisioningUiLib","IpAllocationControl.staticManual");case t.DHCP:return this.i18nService.getString("ProvisioningUiLib","IpAllocationControl.dhcp");case t.STATIC_IPPOOL:return this.i18nService.getString("ProvisioningUiLib","IpAllocationControl.staticIpPool");case t.TRANSIENT_IPPOOL:return this.i18nService.getString("ProvisioningUiLib","IpAllocationControl.transientIpPool")}},e.prototype.getLocalizedIpProtocol=function(e){switch(e){case i.IPV4:return this.i18nService.getString("ProvisioningUiLib","IpAllocationControl.ipv4");case i.IPV6:return this.i18nService.getString("ProvisioningUiLib","IpAllocationControl.ipv6")}},e.prototype.populateLocalizedNamesForIpAllocation=function(){var e=this;this.ipAllocationParams.supportedIpAllocationPolicy=this.ipAllocationParams.supportedIpAllocationPolicy.map(function(t){return t.localizedName=e.getLocalizedIpAllocationPolicy(t.name),t})},e.prototype.populateLocalizedNamesForIpProtocol=function(){var e=this;this.ipAllocationParams.supportedIpProtocol=this.ipAllocationParams.supportedIpProtocol.map(function(t){return t.localizedName=e.getLocalizedIpProtocol(t.name),t})},e.$inject=["$scope","i18nService","vuiConstants"],e}();e.VmProvisioningNetworkMappingController=r;var n=function(){function e(){this.controller=r,this.templateUrl="vm-ui/resources/vm/views/createVmWizard/vmProvisioningNetworkMapping/vm-provisioning-network-mapping.html",this.bindings={networkMappings:"=",ipAllocationParams:"=",isValidated:"="}}return e}();e.VmProvisioningNetworkMappingComponent=n,angular.module("com.vmware.vsphere.client.vm").component("vmProvisioningNetworkMapping",new n)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e){var t=this,i=e.networkPageModel;t.networkMappingParams=i.getNetworkMappingParams(),t.ipAllocationParams=i.getIpAllocationParams()}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningNetworkPageController",e),e.$inject=["$scope","$q","i18nService","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r){function n(e){return e.parentWorkflow&&e.parentWorkflow!==i.CREATE_FROM_SCRATCH}var o=this,a={};if(a[i.CREATE_FROM_SCRATCH]="CreateFromScratch",a[i.CLONE_VM_TO_VM]="CloneVmToVm",a[i.CLONE_VM_TO_TEMPLATE]="CloneVmToTemplate",a[i.DEPLOY_VM_FROM_ANY_TEMPLATE]="DeployFromTemplate",a[i.DEPLOY_VM_FROM_TEMPLATE]="DeployFromTemplate",a[i.CONVERT_TEMPLATE_TO_VM]="ConvertTemplateToVm",a[i.CLONE_TEMPLATE_TO_TEMPLATE]="CloneTemplateToTemplate",o.creationTypes=[],_.each(e.config.flows,function(e){if(!n(e)){var i=e.id;o.creationTypes.push({name:t.getString("VmUi","ProvisioningTypes."+a[i]+".Title"),wizardTitle:t.getString("VmUi","ProvisioningTypes."+a[i]+".WizardTitle.1"),description:t.getString("VmUi","ProvisioningTypes."+a[i]+".Description"),creationType:e.id})}}),e.attributes.creationType){var s=_.find(e.config.flows,function(t){return t.id===e.attributes.creationType}),c=n(s)?s.parentWorkflow:s.id;o.selectedCreationType=_.find(o.creationTypes,function(e){return e.creationType===c})}else o.selectedCreationType=o.creationTypes[0],r.changeCreationType(e,o.selectedCreationType);e.$watch("ctrl.selectedCreationType",function(t,i){r.changeCreationType(e,t,i)})}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningSelectCreationTypeController",["$scope","i18nService","creationTypeConstants","createVmChangeCreationTypeService",e])}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(t){e.config.loadingMessage=v,e.config.loading=t}function l(){var e=t.find(".library-template-selector [kendo-grid]");e&&e.data("kendoGrid")&&e.data("kendoGrid").clearSelection()}function d(){var e=t.find("[vx-tree-view]");e.data("kendoTreeView").select($()),p.pageModel.getVcTemplatePageModel().clearSelection()}function u(t){o.changeCreationType(e,{creationType:t,wizardTitle:r.getString("VmUi","ProvisioningTypes.DeployFromTemplate.WizardTitle.1")})}var p=this,v=r.getString("CommonUi","wizard.loading");p.pageModel=e.selectAnyTemplateModel,p.pageModel.vcTemplatePageModel.showLoadingIndicator=!1,p.clTemplateTabLabel=r.getString("VmUi","SelectTemplateProvisioningPage.clTemplateTab.label"),p.vcTemplateTabLabel=r.getString("VmUi","SelectTemplateProvisioningPage.vcTemplateTab.label"),p.isVcTabSelected=p.pageModel.getIsVcTemplateSelected(),p.datagridOptions={columnDefs:[{displayName:r.getString("VmUi","SelectTemplateProvisioningPage.clTemplateTab.templateName.label"),field:"templateName"},{displayName:r.getString("VmUi","SelectTemplateProvisioningPage.clTemplateTab.libraryName.label"),field:"libraryName"}],selectionMode:s.grid.selectionMode.SINGLE,selectedItems:[]},i(function(){var e=t[0].querySelector("clr-tab-link");e.querySelector("button").focus()},0),p.watchSelectedItems=function(){e.$watch(function(){return p.datagridOptions.selectedItems},function(e){var t=e&&e.length?e[0]:void 0;p.pageModel.setClTemplateSelection(t),t&&(d(),u(a.DEPLOY_VM_FROM_TEMPLATE))})},e.clPreselectComparator=function(e){var t=p.pageModel.getClTemplateSelection();return!!t&&t.templateId===e.templateId},p.onVcTemplateSelectionChanged=function(){p.pageModel.getVcTemplateSelection()&&l(),p.pageModel.getIsVcTemplateSelected()&&u(a.CLONE_TEMPLATE_TO_VM)};var m=e.wizardViewData.getSourceObjectId();e.wizardViewData.defaultTarget&&(m=e.wizardViewData.defaultTarget),c(!0),n.getAllTemplates(m).then(function(e){var t,i,r,n,o=_.map(e.libraryTemplates.resultSet[0].items,function(e){return t=_.find(e.properties,function(e){return"com.vmware.content.library.ItemModel/name"===e.propertyName}),i=_.find(e.properties,function(e){return"com.vmware.content.library.ItemModel/libraryName"===e.propertyName}),r=_.find(e.properties,function(e){return"com.vmware.content.type.ovf.OvfTemplate/vmTemplate/osType"===e.propertyName}),n=_.find(e.properties,function(e){return"com.vmware.content.type.ovf.OvfTemplate/vmTemplate/osDescription"===e.propertyName}),{templateName:t.value,libraryName:i.value,templateId:e.resourceObject,gosType:r.value,gosDescription:n.value}});p.datagridOptions.data=o;var a=p.pageModel.getClTemplateSelection(),s=a&&_.find(p.datagridOptions.data,function(e){return e.templateId===a.templateId});s&&(p.datagridOptions.selectedItems=[s])}).then(function(){c(!1),p.watchSelectedItems()})}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningSelectTemplateController",e),e.$inject=["$scope","$element","$timeout","i18nService","contentLibraryService","createVmChangeCreationTypeService","creationTypeConstants","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(t){e.config.loading=t}function o(t){return i.getEntityType(t)!==r.VIRTUAL_MACHINE?void e.vmParams.setVmId(void 0):void e.vmParams.setVmId(t)}var a=this;this.treeDescription=t.getString("VmUi","SelectTemplateProvisioningPage.Vm.Description"),this.onChange=function(i,r,s){e.wizardManager.clearValidationBanner(),o(i),e.wizardViewData.setSourceObjectName(r),n(!0),e.config.loadingMessage=t.getString("CommonUi","wizard.validating"),e.selectVmToClonePageModel.validateSelection().then(function(e){a.compatibilityMessage=e,n(!1)})},this.selectedItem=e.vmParams.getVmId(),this.treeConfig={preselectRoot:!1,expandPreselectedNode:!0}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningSelectVmToCloneController",e),e.$inject=["$scope","i18nService","defaultUriSchemeUtil","managedEntityConstants"]}();var h5_vm;!function(e){var t=function(){function e(e,t){this.$timeout=e,this.$element=t,e(function(){var e=t[0].querySelector("[vx-tree-view]");e&&e.focus()},0)}return e.$inject=["$timeout","$element"],e}();e.VmProvisioningSelectVMTXTemplateController=t,angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningSelectVMTXTemplateController",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o){e.userSettingsPageModel.resetForm(),i(function(){var e=t[0].querySelector("input");e&&e.focus()},0),this.form=e.userSettingsPageModel.form,this.validateComputerName=e.userSettingsPageModel.validateComputerName,this.validateIpAddress=function(e){e.errors.addressInvalid=o.isIpAddressInvalid(e)},this.validateSubnet=function(e){e.errors.subnetMaskInvalid=o.isSubnetMaskInvalid(e)},this.validateDefaultGateway=function(e){e.errors.defaultGatewayInvalid=o.isDefaultGatewayInvalid(e)},this.validateAlternateGateway=function(e){e.errors.alternateGatewayInvalid=o.isAlternateGatewayInvalid(e)},this.validateIp6Address=function(e){e.errors.addressInvalid=o.isIp6AddressInvalid(e)},this.validateIp6Subnet=function(e){e.errors.subnetPrefixLengthInvalid=o.isIp6SubnetInvalid(e)},this.addGateway=function(e){this.validateGateway(e.lastGateway,e),e.lastGateway&&!e.gatewayInvalid&&(e.gateway.push(e.lastGateway),e.gridGatewaysOptions.data=e.gateway,e.lastGateway="")},this.validateGateway=function(e,t){if(!e)return void(t.gatewayInvalid=null);var i=r.isIpv6AddressValid(e),o=_.any(t.gateway,function(t){return t===e});i||(t.gatewayInvalid=n.getString("VmUi","CustomizationParametersPageBase.nic.error.ipv6.address")),o&&(t.gatewayInvalid=n.getString("VmUi","CustomizationParametersPageBase.nic.error.ipv6.duplicate",e)),i&&!o&&(t.gatewayInvalid=null)},this.expandedChanged=function(t,i){i.expanded=t,t&&this.form.nics.forEach(function(t){t!==i&&(t.expanded=!1,e.userSettingsPageModel.hasAlerts(t))}),e.userSettingsPageModel.hasAlerts(i)},this.shouldExpand=function(e){return!(0!==e||!this.form.nics||1!==this.form.nics.length)||!(!this.form.nics[e]||!this.form.nics[e].expanded)},this.tooltipRole=function(e){return e?"tooltip":""}}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningUserSettingsController",e),e.$inject=["$scope","$element","$timeout","ipParserService","i18nService","nicValidatorService"]}(),function(){"use strict";function e(e,t,i,r,n){this.i18n=t.getString,this.model=e.selectVmVersionPageModel,this.form=this.model.form,this.form.vmParams=e.vmParams;var o;this.form.setLoading=function(t){!e.config.loading&&t?(o=!0,e.config.loading=!0):o&&!t&&(e.config.loading=!1,o=!1)},this.checkCompatibility=function(e){this.form.compatibility(e)}.bind(this),e.config.loadingMessage=t.getString("CommonUi","wizard.loading"),e.config.loading=!0,this.model.resetForm()["catch"](function(t){i.markPageIncompleteWithError(e.config,r("errorFormat")(t))}).then(function(){e.config.loading=!1})}angular.module("com.vmware.vsphere.client.vm").controller("VmProvisioningVmVersionController",e),e.$inject=["$scope","i18nService","wizardPageService","$filter","helpService"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o){var a=this;this.$scope=e,this.vuiConstants=t,this.i18nService=i,this.columnRenderersRegistry=r,this.ftVmWizardService=n,this.ftVmService=o;var s=e.modalOptions.dialogData;this.objectId=s.objectId,this.faultDefaultDescriptionText=s.errorText,this.iconTextRenderer=this.columnRenderersRegistry.getColumnRenderer("icon-text"),this.gridOptions=this.ftVmService.getErrorPageGridOptions(s.allIssuesArray),e.modalOptions.onSubmit=function(){return a.ftVmWizardService.invokeWizard(a.objectId,s.manager),!0}}return e.$inject=["$scope","vuiConstants","i18nService","columnRenderersRegistry","ftVmWizardService","ftVmService"],e}();angular.module("com.vmware.vsphere.client.vm").controller("FtErrorsWarningController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.$rootScope=e,this.$scope=t,this.i18nService=i,this.ftVmService=r,this.mutationService=n,this.defaultUriSchemeUtil=o,this.vxPropertyViewService=a,this.vmFtConstants=s,this.selectedDatastore=t.manager.getSelectedDatastore(),this.selectedHost=t.manager.getSelectedHost();var c=this.$scope.manager.getDevices();this.availableDevices=this.ftVmService.getAvailableDevices(c),this.selectedDatastores=t.manager.getSelectedDatastores(),this.readyToCompletePageInfo=this.getPropertyViewData()}return e.prototype.getPropertyViewData=function(){var e=this,t=this.vxPropertyViewService.createPropertyViewBuilder(),i=t.category("").section("");return i.propertyBuilder().keyBuilder().text(this.i18nService.getString("VmUi","turnOnFtWizard.summary.hostLabel")).exit().valueBuilder().text(this.selectedHost.name),i.propertyBuilder().keyBuilder().text(this.i18nService.getString("VmUi","turnOnFtWizard.summary.vmxFileDatastoreLabel")).exit().valueBuilder().text(this.selectedDatastores[this.vmFtConstants.fileTypes.CONFIGURATION].name),
i.propertyBuilder().keyBuilder().text(this.i18nService.getString("VmUi","turnOnFtWizard.summary.metainfDatastoreLabel")).exit().valueBuilder().text(this.selectedDatastores[this.vmFtConstants.fileTypes.TIE_BREAKER].name),_.each(this.availableDevices,function(t){i.propertyBuilder().keyBuilder().text(e.i18nService.getString("VmUi","turnOnFtWizard.summary.virtualDisksFormat",t.deviceInfo.label)).exit().valueBuilder().text(e.selectedDatastores[e.vmFtConstants.fileTypes.VIRTUAL_DISK+t.key].name)}),t.build()},e.$inject=["$rootScope","$scope","i18nService","ftVmService","mutationService","defaultUriSchemeUtil","vxPropertyViewService","vmFtConstants"],e}();angular.module("com.vmware.vsphere.client.vm").controller("FtReadyToCompleteController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){var p=this;this.$scope=e,this.vuiConstants=t,this.i18nService=i,this.columnRenderersRegistry=r,this.ftVmService=n,this.dataService=o,this.defaultUriSchemeUtil=a,this.storageSelectorService=s,this.diskFormatService=c,this.clarityModalService=l,this.clarityConstants=d,this.vmFtConstants=u,this.selectedStorageItems={},this.managerSelectedStorageItems={},this.managerBasicSelectedStorageItems={},this.selectedStorageItemsNames={},this.allStorageItems={},this.manager=e.manager,this.selectedVm=this.manager.getTargetUid(),this.storageSelectorState=this.vmFtConstants.storageSelectionModes.BASIC_MODE;var v=this.$scope.manager.getDevices();this.availableDevices=this.ftVmService.getAvailableDevices(v),this.gridOptions=this.ftVmService.getSelectDatastoreGridOptions(this.manager.getConfigCompatibleDatastores()),this.hasAvailableHosts=!1,this.hasSelectedDatastore=!1,this.advancedGridOptions=this.ftVmService.getAdvancedDatastoreGridOptions(),_.each(this.manager.getCompatibleDatastores(),function(e){p.selectedStorageItemsNames[e.provider.value]=e.name}),this.dataService.getData(this.selectedVm,"com.vmware.vsphere.client.vm.model.VmFtAdvancedStorageData").then(function(e){p.initialData=e.vmDisks,p.advancedGridOptions.data=p.buildRowsData(p.initialData),p.manager.setNumberOfVmFiles(p.initialData.length)}),e.$watch(function(){return p.gridOptions.selectedItems[0]},function(e){e?(p.hasSelectedDatastore=!0,p.compatibilityResultMessagesMap={},p.manager.setNoHostsCompatible(!1),p.hasAvailableHosts=!0,p.validateDatastoreSelection(e)):p.hasSelectedDatastore=!1}),e.basicModeComparator=this.basicModeComparator.bind(this),this.manager.setIsAdvancedMode(!1)}return e.prototype.basicModeComparator=function(e){return this.manager.getSelectedDatastore()&&e.provider.value===this.manager.getSelectedDatastore().provider.value},e.prototype.buildRowsData=function(e){var t=this,i=[],r={onDatastoreComboClick:function(e,t){""===e.target.value&&(e&&e.target&&e.target.blur&&e.target.blur(),t.onDatastoreChange(t))},onDatastoreChange:function(e){e.storageItemId?(t.selectedStorageItems[e.id]=e.storageItemId,_.each(t.selectedStorageItems,function(e,i){t.managerSelectedStorageItems[i]={provider:e,name:t.selectedStorageItemsNames[e.value]}}),t.manager.setSelectedDatastores(t.managerSelectedStorageItems),t.manager.validateSelectedDatastores()&&(t.hasSelectedDatastore=!0,t.validateDatastoreSelection(null,!0))):t.showDatastoreSelector(e)}};return _.each(e,function(e){angular.extend(e,r),t.selectedStorageItems[e.id]&&angular.extend(e,{storageItems:t.updateStorageItems(e.id),storageItemId:t.selectedStorageItems[e.id]}),i.push(e)}),i},e.prototype.showDatastoreSelector=function(e){var t,i=this;t=e.itemType===this.vmFtConstants.fileTypes.TIE_BREAKER?this.manager.getMetaCompatibleDatastores():e.itemType===this.vmFtConstants.fileTypes.CONFIGURATION?this.manager.getConfigCompatibleDatastores():this.manager.getCompatibleDatastores();var r={contentTemplate:"vm-ui/resources/vm/views/ft/ftStorageSelectorDialog.html",title:this.i18nService.getString("Common","StorageLocatorDialog.Title"),defaultButton:"submit",size:"lg",dialogData:{datastores:t,isDatastoreSelected:!1,selectedDatastore:{}},modalClass:"ft-advanced-datastore-selection-wizard",alerts:[],onSubmit:function(){return r.dialogData.isDatastoreSelected?(i.updateSelectedDatastore(e,r.dialogData.selectedDatastore),!0):(r.alerts=[{text:i.i18nService.getString("Common","storageSelector.incompleteSelection"),type:i.clarityConstants.notifications.type.ERROR}],!1)},onCancel:function(){return e.storageItemId=i.selectedStorageItems[e.id],!0}};this.clarityModalService.openOkCancelModal(r)},e.prototype.updateStorageItems=function(e){var t=this,i=[];return _.forEach(this.allStorageItems[e],function(e){return t.addStorageItemOptionToList(i,t.buildStorageItemOption(e))}),i=_.sortBy(i,"label"),i.push({id:"",label:this.i18nService.getString("Common","DiskLocatorControl.Browse")}),i},e.prototype.addStorageItemOptionToList=function(e,t){_.find(e,function(e){return e.id===t.id})||e.push(t)},e.prototype.buildStorageItemOption=function(e){return{id:e.provider,label:e.name}},e.prototype.updateSelectedDatastore=function(e,t){var i=this;this.selectedStorageItems[e.id]=t.provider,_.each(this.selectedStorageItems,function(e,t){i.managerSelectedStorageItems[t]={provider:e,name:i.selectedStorageItemsNames[e.value]}}),this.manager.setSelectedDatastores(this.managerSelectedStorageItems),this.manager.validateSelectedDatastores()&&(this.hasSelectedDatastore=!0,this.validateDatastoreSelection(null,!0)),this.allStorageItems[e.id]||(this.allStorageItems[e.id]=[]),_.find(this.allStorageItems[e.id],function(e){return e.provider===t.provider})||this.allStorageItems[e.id].push(t),this.advancedGridOptions.data=this.buildRowsData(this.initialData)},e.prototype.validateDatastoreSelection=function(e,t){var i=this;void 0===t&&(t=!1),t?this.validateSelection():e&&null!==e&&(this.initialData&&this.initialData.length>0&&(_.each(this.initialData,function(t){i.managerBasicSelectedStorageItems[t.id]=e}),this.manager.setSelectedDatastores(this.managerBasicSelectedStorageItems)),this.manager.setSelectedDatastore(e),this.validateSelection())},e.prototype.validateSelection=function(){var e=this;this.getCompatibleHosts().then(function(t){e.compatibleHosts=t.ftCompatibleHosts;var i=e.ftVmService.getFtHostsIds(e.compatibleHosts);e.getHostNames(i).then(function(t){e.compatibilityResultMessagesMap=e.ftVmService.getCompatibilityResultMessages(e.compatibleHosts),_.each(t,function(t,i){var r=e.compatibilityResultMessagesMap[i];_.extend(r,{name:t.name})}),e.hasAvailableHosts=e.ftVmService.hasFtHostWithoutErrors(e.compatibleHosts),e.manager.setNoHostsCompatible(!e.hasAvailableHosts)})})},e.prototype.getHostNames=function(e){return this.dataService.getPropertiesForObjects(e,["name"])},e.prototype.getCompatibleHosts=function(){return this.dataService.getProperties(this.selectedVm,["ftCompatibleHosts"],this.ftVmService.createSecondaryVmSpecParameter(this.manager,this.availableDevices))},e.prototype.toggleSelectionMode=function(){switch(this.storageSelectorState){case this.vmFtConstants.storageSelectionModes.BASIC_MODE:this.storageSelectorState=this.vmFtConstants.storageSelectionModes.ADVANCED_MODE;break;case this.vmFtConstants.storageSelectionModes.ADVANCED_MODE:this.storageSelectorState=this.vmFtConstants.storageSelectionModes.BASIC_MODE}this.onSelectionModeChanged()},e.prototype.onSelectionModeChanged=function(){switch(this.hasSelectedDatastore=!1,this.storageSelectorState){case this.vmFtConstants.storageSelectionModes.BASIC_MODE:this.manager.setIsAdvancedMode(!1),this.manager.getSelectedDatastore()&&(this.hasSelectedDatastore=!0);break;case this.vmFtConstants.storageSelectionModes.ADVANCED_MODE:this.manager.setIsAdvancedMode(!0),this.manager.setSelectedDatastores(this.managerSelectedStorageItems),this.manager.validateSelectedDatastores()&&(this.hasSelectedDatastore=!0,this.validateDatastoreSelection(null,!0))}this.hasAvailableHosts=!0,this.compatibilityResultMessagesMap=null},e.$inject=["$scope","vuiConstants","i18nService","columnRenderersRegistry","ftVmService","dataService","defaultUriSchemeUtil","storageSelectorService","diskFormatService","clarityModalService","clarityConstants","vmFtConstants"],e}();angular.module("com.vmware.vsphere.client.vm").controller("FtSelectDatastoresController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a){this.$scope=e,this.storageSelectorService=t,this.dataService=i,this.defaultUriSchemeUtil=r,this.$rootScope=n,this.ftVmService=o,this.i18nService=a,this.loading=!0,this.showAllHosts=!1}return e.prototype.$onInit=function(){var e=this;this.selectedVm=this.$scope.manager.getTargetUid(),this.selectedDatastore=this.$scope.manager.getSelectedDatastore();var t=this.$scope.manager.getDevices();this.availableDevices=this.ftVmService.getAvailableDevices(t),this.showAllHosts=!1,this.getCompatibleHosts().then(function(t){e.compatibleHosts=t.ftCompatibleHosts,e.compatbileHostsMap=e.ftVmService.convertCompatibleHostsIntoMap(e.compatibleHosts),e.messages=[],e.loading=!1,e.objectSelectorConfigCompatibleHosts=e.generateObjectLocator(!0),e.objectSelectorConfigAllHosts=e.generateObjectLocator(!1),e.$scope.manager.setSelectedHost(null)})},e.prototype.getCompatibleHosts=function(){return this.dataService.getProperties(this.selectedVm,["ftCompatibleHosts"],this.ftVmService.createSecondaryVmSpecParameter(this.$scope.manager,this.availableDevices))},e.prototype.showAllHostsAction=function(){this.messages=[],this.showAllHosts=!this.showAllHosts},e.prototype.generateObjectLocator=function(e){var t=this,i=this.compatibleHosts;e&&(i=_.filter(i,function(e){return null===e.errors}));var r=_.map(i,function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.ftHost)}),n=this.$scope.manager.getDatacenter(),o=this.defaultUriSchemeUtil.getVsphereObjectId(n);return this.loading=!1,{contextObject:o,multipleSelect:!1,listTabConfig:{listConfig:[{label:"",listViewId:"vsphere.core.host.list",dataModels:["HostSystem"],filterId:"hostsInDatacenterByMorObjectsFilter",filterParams:r}]},onSelectionChanged:function(e){var i=e[0],r=t.compatbileHostsMap[i.id];t.$scope.manager.setSelectedHost(_.extend(i,r)),t.messages=t.ftVmService.generateValidationMessages(i,t.compatbileHostsMap),0===t.messages.length&&(t.messages=[{type:"Success",text:t.i18nService.getString("VmUi","turnOnFtWizard.compatibilityChecksSucceeded")}])}}},e.$inject=["$scope","storageSelectorService","dataService","defaultUriSchemeUtil","$rootScope","ftVmService","i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").controller("FtSelectHostController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){var i=this;this.$scope=e,this.ftVmService=t,this.gridOptions=this.ftVmService.getSelectDatastoreGridOptions(e.modalOptions.dialogData.datastores),e.$watch("ctrl.gridOptions.selectedItems",function(e){e[0]&&null!==e[0]?(i.$scope.modalOptions.dialogData.isDatastoreSelected=!0,i.$scope.modalOptions.dialogData.selectedDatastore=e[0]):i.$scope.modalOptions.dialogData.isDatastoreSelected=!1})}return e.$inject=["$scope","ftVmService"],e}();angular.module("com.vmware.vsphere.client.vm").controller("FtStorageSelectorDialogController",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o){function a(){return{sortMode:i.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:u.data,columnDefs:s(),encoded:!1,selectedItems:[],pageConfig:{hidePager:!0}}}function s(){return[{displayName:e.getString("Common","vns.vm"),field:"vmName",type:"string",sortable:!0},{displayName:e.getString("Common","vns.networkAdapter"),field:"sourceAdapterLabel",type:"string",sortable:!0},{displayName:e.getString("Common","vns.basic.source"),field:"sourceNetworkName",type:"string",sortable:!0},{displayName:e.getString("Common","vns.basic.destination"),field:"destinationNetworkName",sortable:!1,template:c}]}function c(e){return'<div network-selector object-ref="$parent.$parent.ctrl.networkProviderId" mode="$parent.$parent.ctrl.networkSelectorMode" filter-spec="$parent.$parent.ctrl.networkSelectorFilterSpec" dialog-spec="$parent.$parent.ctrl.networkSelectorDialogSpec" preselected-network="$parent.$parent.ctrl.destinationNetworks['+e.index+']" prefetched-networks="$parent.$parent.ctrl.prefetchedNetworks" on-selected-networks="$parent.$parent.ctrl.onSelectNetworks(selectedNetworks,'+e.index+')" sort-params="$parent.$parent.ctrl.sortParams"></div>'}function l(){u.destinationNetworks=_.map(u.migrateSelectNetworkService.getAdvancedNetworkMatches(),function(e){return{id:t.getVsphereObjectId(e.destinationNetwork),name:e.destinationNetworkName,opaqueNetworkType:e.opaqueNetworkType}})}function d(){u.networkProviderId=u.migrateSelectNetworkService.getNetworkProviderId(),u.networkSelectorMode=r.SINGLE_SELECTION_DROPDOWN,u.networkSelectorFilterSpec=n.createNetworkSelectorFilterSpec(!0,!0,!0,!1,!0),u.sortParams=[{field:"name",dir:"asc"}],l(),u.networkSelectorDialogSpec=n.createNetworkSelectorDialogSpec(["Network.Assign"],e.getString("NetworkUi","AddNetworkingWizard.conTargetPage.noDvpgPrivilegeMessage")),u.onSelectNetworks=function(e,t){u.migrateSelectNetworkService.onSelectNetwork(e[0],u.data[t],o.ADVANCED),l()}}var u=this;u.$onInit=function(){u.gridOptions=a(),d()}}angular.module("com.vmware.vsphere.client.vm").component("migrateSelectNetworkAdvancedView",{templateUrl:"vm-ui/resources/vm/views/migrationWizard/components/migrateSelectNetworkAdvancedView.html",controller:e,controllerAs:"ctrl",bindings:{data:"<",migrateSelectNetworkService:"<",prefetchedNetworks:"<"}}),e.$inject=["i18nService","defaultUriSchemeUtil","vuiConstants","NetworkSelectorMode","networkSelectorDialogService","NetworkPageViewModes"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){return{sortMode:i.grid.sortMode.SINGLE,selectionMode:i.grid.selectionMode.SINGLE,searchable:!1,resizable:!0,data:m.data,columnDefs:c(),encoded:!1,selectedItems:[],pageConfig:{hidePager:!0}}}function c(){return[{displayName:m.i18n("Common","vns.basic.source"),field:"networkName",type:"string",sortable:!0},{displayName:m.i18n("Common","vns.usedBy"),field:"_usedBy",type:"string",sortable:!0,template:function(e){return _.escape(e.usedBy())},width:"40%"},{displayName:m.i18n("Common","vns.basic.destination"),field:"destinationNetworkName",encoded:!1,template:l}]}function l(e){return'<div network-selector object-ref="$parent.$parent.ctrl.networkProviderId" mode="$parent.$parent.ctrl.networkSelectorMode" filter-spec="$parent.$parent.ctrl.networkSelectorFilterSpec" dialog-spec="$parent.$parent.ctrl.networkSelectorDialogSpec" preselected-network="$parent.$parent.ctrl.destinationNetworks['+e.index+']" prefetched-networks="$parent.$parent.ctrl.prefetchedNetworks" on-selected-networks="$parent.$parent.ctrl.onSelectNetworks(selectedNetworks,'+e.index+')" sort-params="$parent.$parent.ctrl.sortParams"></div>'}function d(){return{sortMode:i.grid.sortMode.SINGLE,searchable:!1,resizable:!0,data:[],columnDefs:u(),pageConfig:{hidePager:!0}}}function u(){return[{displayName:m.i18n("Common","vns.vm"),field:"vm",type:"string",sortable:!0,width:"40%"},{displayName:m.i18n("Common","vns.networkAdapter"),field:"sourceAdapter",type:"string"},{displayName:m.i18n("Common","vns.network"),field:"networkName",type:"string",sortable:!0}]}function p(){m.destinationNetworks=_.map(m.data,function(e){return{id:t.getVsphereObjectId(e.destinationNetworkRef),name:e.destinationNetworkName,opaqueNetworkType:e.opaqueNetworkType}})}function v(){m.networkProviderId=m.migrateSelectNetworkService.getNetworkProviderId(),m.networkSelectorMode=r.SINGLE_SELECTION_DROPDOWN,m.networkSelectorFilterSpec=n.createNetworkSelectorFilterSpec(!0,!0,!0,!1,!0),m.sortParams=[{field:"name",dir:"asc"}],p(),m.networkSelectorDialogSpec=n.createNetworkSelectorDialogSpec(["Network.Assign"],e.getString("NetworkUi","AddNetworkingWizard.conTargetPage.noDvpgPrivilegeMessage")),m.onSelectNetworks=function(e,t){m.migrateSelectNetworkService.onSelectNetwork(e[0],m.data[t],a.BASIC).then(function(){p()})}}var m=this;m.$onInit=function(){m.i18n=e.getString,m.gridOptions=s(),m.detailsGridOptions=d(),v(),o.$watch(function(){if(m.gridOptions)return m.gridOptions.selectedItems},function(e,i){if(e&&e.length){if(!i||!i.length||e[0]!==i[0]){var r=e[0],n=_.map(r.adapterMatches,function(e){var i=t.getVsphereObjectId(e.sourceVm);return{vm:r._attachedVmNamesById[i],sourceAdapter:e.sourceAdapter.deviceInfo.label,networkName:r.networkName}}),o=r.networkName;o||(o=m.i18n("VmUi","MigrationWizard.readyPage.invalidNetworkName")),m.selectNetworkDetailsGridDescription=m.i18n("Common","vns.networkDetails.header",o),m.detailsGridOptions.data=n}}else m.detailsGridOptions.data=[]})}}angular.module("com.vmware.vsphere.client.vm").component("migrateSelectNetworkBasicView",{templateUrl:"vm-ui/resources/vm/views/migrationWizard/components/migrateSelectNetworkBasicView.html",controller:e,controllerAs:"ctrl",bindings:{data:"<",migrateSelectNetworkService:"<",prefetchedNetworks:"<"}}),e.$inject=["i18nService","defaultUriSchemeUtil","vuiConstants","NetworkSelectorMode","networkSelectorDialogService","$scope","NetworkPageViewModes"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.dataService=r}return e.prototype.formatFaults=function(t){var i=this;if(_.isEmpty(t))return this.$q.when([]);var r=[];_.each(t,function(e){i.pushIfNotPresent(r,e.vm)});var n=this.dataService.getPropertiesForObjects(r,[e.PROPERTY_NAME,e.PROPERTY_HOSTNAME]);return this.$q.when(n).then(function(e){var r=[];return _.each(t,function(t){_.each(t.fault,function(n){r.push(i.newFormattedFault(n.message,t.vm,e))})}),_.sortBy(r,function(e){return e.vmName})})},e.prototype.newFormattedFault=function(t,i,r){var n="",o="",a=this.toId(i);return a&&r[a]&&(n=r[a][e.PROPERTY_NAME],o=r[a][e.PROPERTY_HOSTNAME]),{vmId:a,message:t,vmName:n,hostName:o}},e.prototype.pushIfNotPresent=function(e,t){t&&e&&e.indexOf(this.toId(t))<0&&e.push(this.toId(t))},e.prototype.toId=function(e){return e?this.defaultUriSchemeUtil.getVsphereObjectId(e):void 0},e.$inject=["$q","i18nService","defaultUriSchemeUtil","dataService"],e.PROPERTY_NAME="name",e.PROPERTY_HOSTNAME="hostName",e}();e.VmPlacementFaultFormatter=t,angular.module("com.vmware.vsphere.client.vm").service("vmPlacementFaultFormatter",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.$q=e,this.$scope=t,this.vuiConstants=i,this.i18nService=r}return e.prototype.$onInit=function(){this.init()},e.prototype.init=function(){var e=this.i18nService.getString("VmUi","drs.faults.missingObjectName");this.gridOptions={columnDefs:[{displayName:this.i18nService.getString("Common","drs.faultView.vmColumn"),field:"vmName",width:"25%",template:kendo.template("#if(vmName){#   <span class='vsphere-icon-vm'></span>#:vmName##}else{#"+e+"#}#")},{displayName:this.i18nService.getString("Common","drs.faultView.hostColumn"),field:"hostName",width:"25%",template:kendo.template("#if(hostName){#   <span class='vsphere-icon-host'></span>#:hostName##}else{#"+e+"#}#")},{displayName:this.i18nService.getString("Common","drs.faultView.descriptionColumn"),field:"message",width:"50%",template:"#:message#"}],sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.faults,resizable:!0,searchable:!1,height:350}},e.$inject=["$q","$scope","vuiConstants","i18nService"],e}();e.VmPlacementFaultViewController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/migrationWizard/components/vmPlacementRecommendation/vmPlacementFaultView.html",this.bindings={faults:"<"}}return e}();e.VmPlacementFaultView=i,angular.module("com.vmware.vsphere.client.vm").component("vmPlacementFaultView",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.$q=e,this.clarityModalService=t,this.i18nService=i}return e.prototype.showRecommendations=function(e,t){var i=this.$q.defer(),r={recommendations:e,selectedRecommendationKey:t},n={contentTemplate:"vm-ui/resources/vm/views/migrationWizard/components/vmPlacementRecommendation/vmPlacementRecommendationDialog.html",title:this.i18nService.getString("VmUi","PlacementRecommendationDialog.title"),size:"lg",dialogData:r,onSubmit:function(){return i.resolve({selectedRecommendationKey:r.selectedRecommendationKey}),!0},onCancel:function(){return i.reject(),!1},defaultButton:"submit",submitButtonTitle:this.i18nService.getString("VmUi","PlacementRecommendationDialog.ok")};return this.clarityModalService.openOkCancelModal(n),i.promise},e.prototype.showFaults=function(e){var t={contentTemplate:"vm-ui/resources/vm/views/migrationWizard/components/vmPlacementRecommendation/vmPlacementRecommendationDialog.html",title:this.i18nService.getString("VmUi","PlacementRecommendationDialog.faults.title"),size:"lg",hideSubmitButton:!0,closeButtonTitle:this.i18nService.getString("Common","saveButtonLabel"),defaultButton:"close",dialogData:{faults:e}};this.clarityModalService.openOkCancelModal(t)},e.$inject=["$q","clarityModalService","i18nService"],e}();e.VmXdrsRecommendationDialogService=t,angular.module("com.vmware.vsphere.client.vm").service("vmPlacementRecommendationDialogService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.$q=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.dataServiceUtil=r}return e.prototype.formatRecommendations=function(e){var t=this;return e&&e.length?this.requestData(e).then(function(i){var r=[];return _.each(e,function(e,n){var o={key:e.key,priority:t.ratingToPriority(e.rating),reasonText:t.text("PlacementRecommendationView.recommendationItemText",(n+1).toString(),e.reasonText),warningText:e.warningDetails&&e.warningDetails.message?e.warningDetails.message:e.warningText||"",actions:t.formatActions(e.action,i)};r.push(o)}),r}):this.$q.resolve([])},e.prototype.requestData=function(t){var i=this.extractRelatedEntities(t),r={vmData:this.dataServiceUtil.getPropertiesForObjects(i.vms,[e.PROPERTY_NAME,e.PROPERTY_VMDEVICES]),otherData:this.dataServiceUtil.getPropertiesForObjects(i.other,[e.PROPERTY_NAME])};return this.$q.all(r).then(function(e){var t=angular.extend({},e.vmData,e.otherData);return t})},e.prototype.extractRelatedEntities=function(e){var t=this,i={vms:[],other:[]};return _.each(e,function(e){_.each(e.action,function(e){t.pushIfNotPresent(i.other,e.targetHost),t.pushIfNotPresent(i.vms,e.vm),e.relocateSpec&&(t.pushIfNotPresent(i.other,e.relocateSpec.datastore),_.each(e.relocateSpec.disk,function(e){t.pushIfNotPresent(i.other,e.datastore)}))})}),i},e.prototype.formatActions=function(e,t){var i=this;if(!e||!e.length)return[];var r=[];return _.each(e,function(e){if("com.vmware.vim.binding.vim.cluster.PlacementAction"===e._type){var n=e;n.targetHost&&r.push({icon:"vsphere-icon-host",text:i.text("PlacementRecommendationView.vmHostPlacementItemText",i.getEntityName(n.vm,t),i.getEntityName(n.targetHost,t))});var o=!n.relocateSpec.disk||!n.relocateSpec.disk.length;o?r.push({icon:"vsphere-icon-vm",text:i.text("PlacementRecommendationView.vmStoragePlacementItemText",i.getEntityName(n.vm,t),i.getEntityName(n.relocateSpec.datastore,t))}):(r.push({icon:"vsphere-icon-vm",text:i.text("PlacementRecommendationView.vmxPlacementItemText",i.getEntityName(n.vm,t),i.getEntityName(n.relocateSpec.datastore,t))}),_.each(n.relocateSpec.disk,function(e,o){r.push({icon:"vx-icon-vmDisk",text:i.text("PlacementRecommendationView.vmdkPlacementItemText",i.getEntityName(n.vm,t),i.getDiskLabel(n.vm,e.diskId,t),i.getEntityName(e.datastore,t))})}))}}),r},e.prototype.ratingToPriority=function(t){void 0===t&&(t=0);var i=e.MAX_STAR_RATING-t;return e.MAX_PRIORITY_RATING+i},e.prototype.getEntityName=function(t,i){var r=i[this.toId(t)],n="";return r&&(n=r[e.PROPERTY_NAME]),n},e.prototype.getDiskLabel=function(t,i,r){var n=r[this.toId(t)],o="";if(n){var a=n[e.PROPERTY_VMDEVICES],s=_.find(a,function(e){return e.key===i});s&&(o=s.deviceInfo.label)}return o},e.prototype.pushIfNotPresent=function(e,t){t&&e&&e.indexOf(this.toId(t))<0&&e.push(this.toId(t))},e.prototype.toId=function(e){return this.defaultUriSchemeUtil.getVsphereObjectId(e)},e.prototype.text=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return(r=this.i18nService).getString.apply(r,["VmUi",e].concat(t));var r},e.$inject=["$q","i18nService","defaultUriSchemeUtil","dataServiceUtil"],e.PROPERTY_NAME="name",e.PROPERTY_VMDEVICES="config/hardware/device",e.MAX_STAR_RATING=5,e.MAX_PRIORITY_RATING=1,e}();e.VmPlacementRecommendationFormatter=t,angular.module("com.vmware.vsphere.client.vm").service("vmPlacementRecommendationFormatter",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$q=e,this.$scope=t,this.vuiConstants=i,this.i18nService=r,this.preselectRecommendation=_.bind(function(e){return e.key===n.selectedRecommendationKey},this)}return e.prototype.$onInit=function(){this.init()},e.prototype.init=function(){var e=this;this.descriptionText=this.text("PlacementRecommendationView.header"),this.gridOptions={columnDefs:[{displayName:this.text("PlacementRecommendationView.recommendation"),template:kendo.template("#:reasonText# #:warningText#<ul class='placement-recommendation-column'>   # for (var i = 0; i < actions.length; i++) { #     <li>         <span class=#:actions[i].icon#></span>         <span>#:actions[i].text#</span>     </li>   # } # </ul>"),field:"reasonText",width:"80%"},{displayName:this.text("PlacementRecommendationView.priority"),field:"priority",template:'<div style="text-align: center;">#:priority#</div>'}],sortMode:this.vuiConstants.grid.sortMode.SINGLE,selectionMode:this.vuiConstants.grid.selectionMode.SINGLE,selectedItems:[],data:this.recommendations,resizable:!0,searchable:!1,height:350},this.$scope.$watch(function(){return e.gridOptions.selectedItems},function(t,i){var r=t&&t.length?t[0]:void 0,n=i&&i.length?i[0]:void 0;r!==n&&e.onSelectionRecommendationChanged(r)})},e.prototype.onSelectionRecommendationChanged=function(e){var t=e?e.key:void 0;t!==this.selectedRecommendationKey&&(this.selectedRecommendationKey=t)},e.prototype.text=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return(r=this.i18nService).getString.apply(r,["VmUi",e].concat(t));var r},e.$inject=["$q","$scope","vuiConstants","i18nService"],e}();e.VmPlacementRecommendationViewController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/migrationWizard/components/vmPlacementRecommendation/vmPlacementRecommendationView.html",this.bindings={recommendations:"<",selectedRecommendationKey:"="}}return e}();e.VmPlacementRecommendationView=i,angular.module("com.vmware.vsphere.client.vm").component("vmPlacementRecommendationView",new i)}(h5_vm||(h5_vm={})),function(){"use strict";angular.module("com.vmware.vsphere.client.vm").constant("NetworkPageViewModes",{BASIC:"basic",ADVANCED:"advanced"})}();var h5_vm;!function(e){var t=com.vmware.vsphere.client.h5.vm.model.migration.VmMigrationScheduledTaskEditDefaultsValidationSpec,i=function(){function e(e,t,i,r,n,o){this.$q=e,this.defaultUriSchemeUtil=t,this.mutationService=i,this.diskProvisioningService=r,this.storageProfileService=n,this.initialStorageConfigurationService=o}return e.prototype.applyDataToModels=function(e,i){var r=this;if(!i||!i.spec)return this.$q.when({});var n=i.entity,o=i.spec.argument,a=o[0].value,s=o[1].value?o[1].value[1]:void 0,c=this.defaultUriSchemeUtil.getVsphereObjectId(n),l=new t;return l.spec=a,l.movePriority=s,this.mutationService.validate(c,l._type,l).then(function(t){r.onDefaultsCollected(e,t),r.applyDataToStorageModel(e,c,a,t)})},e.prototype.onDefaultsCollected=function(e,t){var i=t.result;e.setSelectedMode(i.migrationType);var r=this.defaultUriSchemeUtil.getVsphereObjectId(i.computeResource);e.computeResourceTreePageModel.initialResource=r,e.computeResourcePageModel.initialComputeResource=r,e.networkPageModel.initialViewMode="advanced",e.networkPageModel.setSelectNetworkPageIsViewChanged(!0),e.networkPageModel.initialMatches=i.networkMatches,e.priorityPageModel.initialPriority=i.movePriority},e.prototype.applyDataToStorageModel=function(e,t,i,r){var n=r.result,o=e.storagePageModel;o.initialViewMode=this.initialStorageConfigurationService.computeStoragePageViewMode(i),o.initialVmStorageConfig=this.initialStorageConfigurationService.computeInitialVmStorageConfig(t,i,n.replicationGroupsData)},e.$inject=["$q","defaultUriSchemeUtil","mutationService","diskProvisioningService","storageProfileService","initialStorageConfigurationService"],e}();e.MigrateVmScheduledDataToModelMapper=i,angular.module("com.vmware.vsphere.client.vm").service("migrateVmScheduledDataToModelMapper",i)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("migrateVmWizardService",["vuiService","mutationService","clarityModalService","defaultUriSchemeUtil","i18nService","$rootScope","$timeout","vmMigrationSelectMigrationTypePageService","vmMigrationSelectComputeResourcePageService","vmMigrationSelectStoragePageService","vmMigrationSelectPriorityPageService","vmMigrationFinishPageService","vuiConstants","migrationTypeConstants","vmFtConstants","configurationService","wizardPageService","$q","MigrationWizardManager","vmMigrationSelectNetworkPageService","vmMigrationSelectComputeResourceTreePageService","vmMigrationSelectFolderPageService","actionConfirmationService","managedByMessageBuilderService","vmMigrationScheduleTaskPageService","migrateVmScheduledDataToModelMapper",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D,w,b,I){function T(e,i,r){return t.validateSpec("com.vmware.vsphere.client.h5.vm.model.migration.VmMigrationFlowValidationSpec",{vms:e}).then(function(e){return E(e,i,r)})}function E(e,t,r){var o=f.defer(),a=e.error?[n.getString("VmUi","ValidateVmsView.ErrorGeneric")]:e.result.errors;if(_.isEmpty(a))if(_.isEmpty(e.result.warnings))V(t,e.result.availableVms,r,e.result.vmProperties).then(function(){o.resolve({"continue":!0,vmProperties:e.result.vmProperties,availableVms:e.result.availableVms,hasNetworkAdapter:e.result.hasNetworkAdapter})});else{_.each(t.evaluationStatuses,function(t,i){t.available=_.contains(e.result.availableVms,i)});var s={title:n.getString("VmUi","ValidateVmsView.Title"),message:e.result.warnings[0],icon:"icon-warning-32",saveButtonLabel:n.getString("VmUi","ValidateVmsView.Continue"),submit:function(){return V(t,e.result.availableVms,r,e.result.vmProperties).then(function(){o.resolve({"continue":!0,vmProperties:e.result.vmProperties,availableVms:e.result.availableVms,hasNetworkAdapter:e.result.hasNetworkAdapter})}),!0},onCancel:function(){return o.resolve({"continue":!1,vmProperties:{},availableVms:[]}),!0}};i.openConfirmationModal(s)}else{var c={title:n.getString("VmUi","ValidateVmsView.Title"),message:e.result.errors[0],icon:"vui-icon32-error",submit:function(){o.resolve({"continue":!1,vmProperties:{},availableVms:[]})},hideCancelButton:!0};i.openConfirmationModal(c)}return o.promise}function V(e,t,i,r){if(!e||i&&i.dropTarget)return f.when();var o=f.defer();e.action.confirmationTextSome=null,e.action.confirmationTextAll=null;var a=1===Object.keys(e.evaluationStatuses).length;return w.buildWarningMessage(t,a,r).then(function(t){t&&(e.action.confirmationText=t,t+="\n\n",e.action.confirmationTextSome=t+n.getString("Common","defaultConfirmation.someOK"),e.action.confirmationTextAll=t+n.getString("Common","defaultConfirmation.allOK")),D.confirmIfRequired(e,function(){o.resolve()},!0)}),o.promise}return{showWizard:function(t,i,a){var g=null;i&&i.dropTarget&&(g=i.dropTarget);var f=null;return i&&i.migrationType&&(f=i.migrationType),T(t,a,i).then(function(i){function D(e,t,i){if(i){var r=_.find(e,function(e){return e.id===t}),o=r.pages;E(i)?h.markPageDisabled(o,n.getString("VmUi","MigrationWizard.selectFolderPage.Title")):h.markPageSkipped(o,n.getString("VmUi","MigrationWizard.selectFolderPage.Title"))}}function w(e,t){return!(!t||T(e))}function T(e){var t="runtime/faultToleranceState",i="config/ftInfo";
return _.some(e,function(e){return e[t]!==m.NOT_CONFIGURED&&e[i]&&e[i].role>1})}function E(e){var i=r.getPartsFromVsphereObjectId(t[0]).serverGuid,n=r.getPartsFromVsphereObjectId(e).serverGuid;return i!==n}function V(){var e=[$];return H.defaultState=p.wizard.pageState.SKIPPED,e.push(H),R&&e.push(W),k&&e.push(B),e.push(j),e}function M(){return[G,j]}function O(){var e=[];return e.push(z),e.push(G),H.defaultState=p.wizard.pageState.SKIPPED,e.push(H),R&&e.push(W),k&&e.push(B),e.push(j),e}if(i["continue"]){t=i.availableVms;var A=i.vmProperties,k="poweredOn"===A[t[0]].powerState,R=w(A,i.hasNetworkAdapter),N=o.$new();N.locationSpec={},N.migrationWizardManager=new S(N,A),N.migrationWizardManager.isNetworkSelectionRequired=R,N.vmId=t[0],N.vmName=A[t[0]].name;var U=A[t[0]].host;N.attributes={creationType:v.MIGRATE_RESOURCE_ONLY,hostData:U},N.destinationTarget=g,f&&N.migrationWizardManager.setSelectedMode(f);var L,F=[v.MIGRATE_RESOURCE_ONLY,v.MIGRATE_STORAGE_ONLY,v.MIGRATE_RESOURCE_AND_STORAGE],x=s.build(N,F),$=c.build(N),z=P.build(N),H=C.build(N),B=d.build(N),G=l.build(N),j=u.build(N),W=y.build(N),Y=[{id:v.MIGRATE_RESOURCE_ONLY,pages:V()},{id:v.MIGRATE_STORAGE_ONLY,pages:M()},{id:v.MIGRATE_RESOURCE_AND_STORAGE,pages:O()}],q="MigrationWizard.title.single";if(a&&a.additionalData&&a.additionalData.isScheduledTask===!0){var K=b.build(N,a.additionalData.schedulingData.schedulingSpec);N.migrationWizardManager.vmWizardScheduleTaskPageModel.mutationSpec=a.additionalData.schedulingData,N.migrationWizardManager.vmWizardScheduleTaskPageModel.isScheduledTaskFlow=a.additionalData.isScheduledTask,L=[K,x],q=1===a.additionalData.schedulingData.scheduleTaskOperationMode?"ScheduledTask.Edit."+q:"ScheduledTask."+q}else L=[x];var X=1===t.length?n.getString("VmUi",q,A[t[0]].name):n.getString("VmUi","MigrationWizard.Title.Multi",t.length);N.wizardConfig={title:X,pages:h.initializePageStates(L),cssClass:"migrate-vm-wizard",flows:h.initializeFlowStates(Y)};var Q=a&&a.additionalData&&a.additionalData.schedulingData;return I.applyDataToModels(N.migrationWizardManager,Q).then(function(){e.createWizard({scope:N,configObjectName:"wizardConfig"}).show()}),N.$watch(function(){return N.migrationWizardManager.computeResourcePageModel.computeResource},function(e){D(N.wizardConfig.flows,v.MIGRATE_RESOURCE_ONLY,e)}),N.$watch(function(){return N.migrationWizardManager.computeResourceTreePageModel.resource},function(e){D(N.wizardConfig.flows,v.MIGRATE_RESOURCE_AND_STORAGE,e)}),N}})}}}]),angular.module("com.vmware.vsphere.client.vm").constant("migrationTypeConstants",{MIGRATE_RESOURCE_ONLY:"changeResourceOnly",MIGRATE_STORAGE_ONLY:"changeStorageOnly",MIGRATE_RESOURCE_AND_STORAGE:"changeComputeResourceAndStorage"});var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/migrateFinishPageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={migrationWizardManager:"<",wizardConfig:"<",pageModel:"<",destinationTarget:"<"}}return e}();e.MigrateFinishPageComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){this.$scope=e,this.$q=i,this.datastoreRecommendationsDialogService=r,this.datastoreFaultsDialogService=n,this.defaultUriSchemeUtil=o,this.storageProfileService=a,this.vmPlacementRecommendationDialogService=s,this.vmPlacementRecommendationFormatter=c,this.vmPlacementFaultFormatter=l,this.wizardPageService=d,this.spbmReplicationGroupInfoService=u,this.i18nService=t.getString}return e.prototype.$onInit=function(){var e=this;this.setIsLoading(!0),this.$q.all({recommendationsCompleted:this.migrationWizardManager.fetchRecommendations(),namesData:this.migrationWizardManager.requestFolderData()}).then(function(){e.initialize()}).then(function(){e.setIsLoading(!1)})},e.prototype.initialize=function(){var e=this;this.pageModel=this.migrationWizardManager.getFinishPageState(),this.migrationTypeTitle=this.i18nService("VmUi",this.pageModel.migrationType),this.pageModel.xdrsRecommendationService&&this.pageModel.xdrsRecommendationService.hasInitErrors()&&this.wizardPageService.markPageIncompleteWithError(this.wizardConfig,this.i18nService("VmUi","MigrationWizard.readyPage.error.xdrs.retrievalFailed")),this.vmText=1===this.pageModel.vmIds.length?this.pageModel.vmNames[this.pageModel.vmIds[0]]:this.i18nService("VmUi","MigrationWizard.readyPage.migratingVms",this.pageModel.vmIds.length),this.showSdrsSummary=this.pageModel.recommendationService&&(this.pageModel.recommendationService.hasRecommendations()||this.pageModel.recommendationService.hasFaults());var t=this.pageModel.profile;t&&t.id!==this.storageProfileService.DEFAULT_ID?this.profileLabel=t.keepExistingProfileAssignments?t.profileObj?t.profileObj.name:void 0:t.label:this.profileLabel=void 0,this.pageModel.replicationGroup?this.replicationGroupLabel=this.spbmReplicationGroupInfoService.getReplicationGroupName(this.pageModel.replicationGroup):this.replicationGroupLabel="",this.openXdrsRecommendations=function(){e.setIsLoading(!1);var t=e.pageModel.xdrsRecommendationService.getRecommendations();e.xdrsFormattedRecommendations||(e.xdrsFormattedRecommendations=e.vmPlacementRecommendationFormatter.formatRecommendations(t)),e.xdrsFormattedRecommendations.then(function(i){e.vmPlacementRecommendationDialogService.showRecommendations(i,e.pageModel.xdrsRecommendationService.getSelectedRecommendation().key).then(function(i){var r=_.find(t,function(e){return e.key===i.selectedRecommendationKey});r&&e.pageModel.xdrsRecommendationService.setSelectedRecommendation(r)})}).then(function(){e.setIsLoading(!1)})},this.openXdrsFaults=function(){e.setIsLoading(!1);var t=e.pageModel.xdrsRecommendationService.getFaults();e.xdrsFormattedFaults||(e.xdrsFormattedFaults=e.vmPlacementFaultFormatter.formatFaults(t)),e.xdrsFormattedFaults.then(function(t){e.vmPlacementRecommendationDialogService.showFaults(t)}).then(function(){e.setIsLoading(!1)})},this.$scope.openRecommendationsDialog=function(t,i){i||e.migrationWizardManager.model.isAdvancedStorageMode||(i={storageUrn:e.defaultUriSchemeUtil.getVsphereObjectId(e.pageModel.storage.storageRef),parentStoragePodUrn:e.pageModel.storage.parentStoragePod?e.defaultUriSchemeUtil.getVsphereObjectId(e.pageModel.storage.parentStoragePod):void 0});var r=e.migrationWizardManager.getStorageRecommendationsServiceInstance(),n=r.getDiskRecommendations(t.vmId,i);e.datastoreRecommendationsDialogService.openDialog(n,e.pageModel.storageNameMap,r.getSelectedRecommendation(t.vmId,i),t.vmName).then(function(n){r.setSelectedRecommendation(t.vmId,i,n.recommendationSpec),e.pageModel=e.migrationWizardManager.getFinishPageState()})},this.$scope.openFaultsDialog=function(t){var i=e.migrationWizardManager.getStorageRecommendationsServiceInstance().getFaultsForVm(t.vmId);e.datastoreFaultsDialogService.openDialog(e.$scope,i)}},e.prototype.getStorageHint=function(){var e="";return this.pageModel.pmemDiskInfo.hasPmemDisk&&(e=this.pageModel.pmemDiskInfo.hasRegularDisk?this.i18nService("VmUi","MigrationWizard.readyPage.pmem.hint.hybridBaseline"):this.i18nService("VmUi","MigrationWizard.readyPage.pmem.hint.pmemBaseline")),this.pageModel.pmemDiskInfo.hasDowngradedPmemDisk&&(e=this.i18nService("VmUi","MigrationWizard.readyPage.pmem.hint.standardBaseline")),e},e.prototype.setIsLoading=function(e){this.wizardConfig.loading=e},e.$inject=["$scope","i18nService","$q","datastoreRecommendationsDialogService","datastoreFaultsDialogService","defaultUriSchemeUtil","storageProfileService","vmPlacementRecommendationDialogService","vmPlacementRecommendationFormatter","vmPlacementFaultFormatter","wizardPageService","spbmReplicationGroupInfoService"],e}();e.MigrateFinishPageController=i,angular.module("com.vmware.vsphere.client.vm").component("migrateFinishPageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e}();e.MigrateFinishPageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/migrateSelectFolderPageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={wizardConfig:"<",migrationWizardManager:"<",pageModel:"<",destinationTarget:"<"}}return e}();e.MigrateSelectFolderPageComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c,l){this.$scope=e,this.defaultUriSchemeUtil=t,this.managedEntityConstants=i,this.migrationService=r,this.compatibilityResultsPresenter=n,this.i18nService=o,this.wizardPageService=a,this.dataService=s,this.authorizationService=c,this.$q=l}return e.prototype.$onInit=function(){var e=this;this.pageInstructions=this.i18nService.getString("VmUi","MigrationWizard.selectFolderPage.Instructions"),this.treeType="VmFoldersTreeFromDatacenter",this.treeRoot=this.pageModel.datacenter,this.pageModel.selectedTarget&&(this.preselectedLocation=this.pageModel.selectedTarget.uid,this.pageModel.isLoading=!0),this.dcFolderIdsCache={},this.$scope.$on("$destroy",function(){e.setLoadingIndicator(!1)})},e.prototype.onTargetChange=function(e,t,i){var r=this;e&&t&&i&&(this.preselectedLocation===e&&(this.pageModel.isLoading=!1),this.pageModel.selectedTarget={uid:e,name:t,type:i},this.setLoadingIndicator(!0),this.validateSelection(this.pageModel.selectedTarget).then(function(){r.setLoadingIndicator(!1)}))},e.prototype.validateSelection=function(e){var t=this;this.compatibilityContents=[],this.wizardConfig.loadingMessage=this.i18nService.getString("CommonUi","wizard.validating");var i=this.defaultUriSchemeUtil.getEntityType(e.uid);return i===this.managedEntityConstants.DATACENTER?this.dcFolderIdsCache[e.uid]?this.ckeckPrivilegesOnFolder(this.dcFolderIdsCache[e.uid]):this.dataService.getProperties(e.uid,["vmFolder"]).then(function(i){var r=t.defaultUriSchemeUtil.getVsphereObjectId(i.vmFolder);t.dcFolderIdsCache[e.uid]=r,t.ckeckPrivilegesOnFolder(r)}):i===this.managedEntityConstants.FOLDER?this.ckeckPrivilegesOnFolder(e.uid):this.$q.when({})},e.prototype.ckeckPrivilegesOnFolder=function(e){var t=this,i=["VirtualMachine.Inventory.Create","VirtualMachine.Inventory.Register"];return this.authorizationService.checkPrivileges(e,i).then(function(i){if(t.hasPrivileges(i))t.pageModel.destinationFolder=e,t.compatibilityContents=t.makeCompatibilityMessage(!0);else{t.pageModel.destinationFolder=void 0;var r=void 0;t.pageModel.selectedTarget&&(r=t.defaultUriSchemeUtil.getEntityType(t.pageModel.selectedTarget.uid)),t.compatibilityContents=t.makeCompatibilityMessage(!1,r)}})},e.prototype.hasPrivileges=function(e){for(var t=!0,i=0;i<e.length;i++)if(!e[i]){t=!1;break}return t},e.prototype.makeCompatibilityMessage=function(e,t){if(e)return[{icon:"vsphere-icon-status-ok",message:this.i18nService.getString("VmUi","MigrationCompatibilityResultsView.Success"),contents:[]}];var i=this.i18nService.getString("VmUi","MigrationWizard.selectFolderPage.error.NoRegisterVmPrivilegeOnFolder");return t===this.managedEntityConstants.DATACENTER&&(i=this.i18nService.getString("VmUi","MigrationWizard.selectFolderPage.error.NoRegisterVmPrivilegeOnDatacenter")),[{icon:"vsphere-icon-status-error",message:i,contents:[]}]},e.prototype.setLoadingIndicator=function(e){this.wizardConfig.loading=e},e.$inject=["$scope","defaultUriSchemeUtil","managedEntityConstants","migrationService","compatibilityResultsPresenter","i18nService","wizardPageService","dataService","authorizationService","$q"],e}();angular.module("com.vmware.vsphere.client.vm").component("migrateSelectFolderPageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.vms=[]}return e}();e.MigrateSelectFolderPageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/migrateSelectNetworkPageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={migrationWizardManager:"<",wizardConfig:"<",pageModel:"<",destinationTarget:"<"}}return e}();e.MigrateSelectNetworkPageComponent=t;var i=function(){function e(e,t,i,r,n,o){this.$scope=e,this.i18nService=t,this.vmMigrateSelectNetworkServiceClass=i,this.networkPageViewModes=r,this.defaultUriSchemeUtil=n,this.zoneDigestPatchService=o,this.isValidating=!1,this.pageReady=!1,this.compatibilityTitle=this.i18nService.getString("VmUi","MigrationWizard.networkPage.compatibility"),this.networkPageAriaLabel=this.i18nService.getString("VmUi","MigrationWizard.networkPage.description"),this.selectNetworkGridDescription=this.i18nService.getString("Common","vns.basic.description")}return e.prototype.requestData=function(e){var t=this;this.setIsLoading(!0),this.vmMigrateSelectNetworkService.requestData(e).then(function(e){e.prefetchedNetworksPromise&&e.prefetchedNetworksPromise.then(function(){t.$scope.$broadcast("onPrefetchNetworksCompleted")}),t.setIsLoading(!1),t.onDataRequested(),t.pageModel.setSelectNetworkPageIsInitialized(!0)},function(){t.setIsLoading(!1)})},e.prototype.getViewMode=function(){return this.pageModel.getSelectNetworkPageViewMode()},e.prototype.setIsLoading=function(e){this.wizardConfig.loading=e},e.prototype.setIsValidating=function(e){this.isValidating=e,this.pageModel.setSelectNetworkPageIsValidating(this.isValidating),this.zoneDigestPatchService.digest()},e.prototype.$onInit=function(){var e=this,t=this.defaultUriSchemeUtil.getVsphereObjectId(this.migrationWizardManager.getDestinationComputeResourceRef());this.pageModel.checkResourceAndReset(t),this.vmMigrateSelectNetworkService=new this.vmMigrateSelectNetworkServiceClass(this.migrationWizardManager,this.pageModel,function(t){return e.setIsValidating(t)}),this.pageReady=!1,this.compatibilityMessages=[],this.pageModel.getSelectNetworkPageViewMode()===this.networkPageViewModes.BASIC?this.advancedButtonText=this.i18nService.getString("Common","vns.switchToAdvanced"):this.advancedButtonText=this.i18nService.getString("Common","vns.switchToBasic"),this.vmName=this.migrationWizardManager.getVmName(),this.compatibilityMessages=this.vmMigrateSelectNetworkService.getCompatibilityMessages(),this.pageModel.getSelectNetworkPageIsInitialized()?(this.onDataRequested(),this.vmMigrateSelectNetworkService.buildBasicData(),this.vmMigrateSelectNetworkService.buildAdvancedData(),this.vmMigrateSelectNetworkService.checkCompatibility()):(this.pageModel.setBasicCompatibilityResultsCache(null),this.pageModel.setAdvancedCompatibilityResultsCache(null),this.pageModel.isBasicPageValid=!1,this.pageModel.isAdvancedPageValid=!1,this.requestData(this.migrationWizardManager.getVmIds()))},e.prototype.onDataRequested=function(){this.pageReady=!0,this.basicViewData=this.vmMigrateSelectNetworkService.getBasicViewData(),this.advancedViewData=this.vmMigrateSelectNetworkService.getAdvancedViewData(),this.prefetchedNetworksBasic=this.vmMigrateSelectNetworkService.getPrefetchedNetworks().basic,this.prefetchedNetworksAdvanced=this.vmMigrateSelectNetworkService.getPrefetchedNetworks().advanced},e.prototype.onAndvancedButtonClick=function(){this.pageModel.getSelectNetworkPageViewMode()===this.networkPageViewModes.ADVANCED?(this.pageModel.setSelectNetworkPageViewMode(this.networkPageViewModes.BASIC),this.selectNetworkGridDescription=this.i18nService.getString("Common","vns.basic.description"),this.advancedButtonText=this.i18nService.getString("Common","vns.switchToAdvanced")):(this.pageModel.setSelectNetworkPageViewMode(this.networkPageViewModes.ADVANCED),this.selectNetworkGridDescription=this.i18nService.getString("Common","vns.advanced.description"),this.advancedButtonText=this.i18nService.getString("Common","vns.switchToBasic")),this.vmMigrateSelectNetworkService.syncNetworkMatches(),this.vmMigrateSelectNetworkService.checkCompatibility()},e.$inject=["$scope","i18nService","vmMigrateSelectNetworkService","NetworkPageViewModes","defaultUriSchemeUtil","zoneDigestPatchService"],e}();e.MigrateSelectNetworkPageComponentController=i,angular.module("com.vmware.vsphere.client.vm").component("migrateSelectNetworkPageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.isBasicPageValid=!1,this.isAdvancedPageValid=!1,this.state={selectNetworkPage:{computeResourceUrn:"",viewModeState:void 0,isViewChanged:!1,basicViewMatches:[],advancedViewMatches:[],isInitialized:!1,isValidating:!1,basicCompatibilityResultsCache:null,advancedCompatibilityResultsCache:null,viewData:{},prefetchedNetworks:{basic:[],advanced:[],totalMatchesCount:0}}}}return e.prototype.getSelectNetworkPageViewMode=function(){return this.state.selectNetworkPage.viewModeState||this.initialViewMode||"basic"},e.prototype.setSelectNetworkPageViewMode=function(e){this.state.selectNetworkPage.viewModeState=e},e.prototype.getSelectNetworkPageIsViewChanged=function(){return this.state.selectNetworkPage.isViewChanged},e.prototype.setSelectNetworkPageIsViewChanged=function(e){this.state.selectNetworkPage.isViewChanged=e},e.prototype.getBasicNetworkMatches=function(){return this.state.selectNetworkPage.basicViewMatches},e.prototype.setBasicNetworkMatches=function(e){this.state.selectNetworkPage.basicViewMatches=e},e.prototype.getAdvancedNetworkMatches=function(){return this.state.selectNetworkPage.advancedViewMatches},e.prototype.setAdvancedNetworkMatches=function(e){this.state.selectNetworkPage.advancedViewMatches=e},e.prototype.getSelectNetworkPageIsInitialized=function(){return this.state.selectNetworkPage.isInitialized},e.prototype.setSelectNetworkPageIsInitialized=function(e){this.state.selectNetworkPage.isInitialized=!!e},e.prototype.getSelectNetworkPageIsValidating=function(){return this.state.selectNetworkPage.isValidating},e.prototype.setSelectNetworkPageIsValidating=function(e){this.state.selectNetworkPage.isValidating=!!e},e.prototype.getSelectNetworkPageViewData=function(){return this.state.selectNetworkPage.viewData},e.prototype.getSelectNetworkPagePrefechedNetworks=function(){return this.state.selectNetworkPage.prefetchedNetworks},e.prototype.getBasicCompatibilityResultsCache=function(){return this.state.selectNetworkPage.basicCompatibilityResultsCache},e.prototype.setBasicCompatibilityResultsCache=function(e){this.state.selectNetworkPage.basicCompatibilityResultsCache=e},e.prototype.getAdvancedCompatibilityResultsCache=function(){return this.state.selectNetworkPage.advancedCompatibilityResultsCache},e.prototype.setAdvancedCompatibilityResultsCache=function(e){this.state.selectNetworkPage.advancedCompatibilityResultsCache=e},e.prototype.getComputeResourceUrn=function(){return this.state.selectNetworkPage.computeResourceUrn},e.prototype.setComputeResourceUrn=function(e){this.state.selectNetworkPage.computeResourceUrn=e},e.prototype.checkResourceAndReset=function(e){e!==this.getComputeResourceUrn()&&(this.reset(),this.setComputeResourceUrn(e))},e.prototype.reset=function(){this.state.selectNetworkPage.isInitialized=!1},e}();e.MigrateSelectNetworkPageModel=t;var i=function(){return t};angular.module("com.vmware.vsphere.client.vm").service("MigrateSelectNetworkPageModel",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/migrateSelectStoragePageComponent.html",this.controller=i,this.bindings={migrationWizardManager:"<",wizardConfig:"<",pageModel:"<",destinationTarget:"<"}}return e}();e.MigrateSelectStoragePageComponent=t;var i=function(){function t(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){this.i18nService=e,this.defaultUriSchemeUtil=t,this.vmMigrateStorageSelectionValidationService=i,this.managedEntityConstants=r,this.storageSelectorService=n,this.storageSelectorConstants=o,this.dataService=a,this.$q=s,this.$element=c,this.$timeout=l,this.vmMigrateStorageLocatorService=d,this.wizardPageService=u,this.initialStorageConfigurationService=p,this.storageProfileService=v,this.pmemUtilService=m,this.VM_HOME_DATASTORE_PROP="vmHomeDatastore",this.VM_HOST_PROP="host",this.VM_DEVICE_PROP="devices",this.ADVANCED_PAGE_DATA_PROPERTY="migrateAdvancedStoragePageData",this.compatibilityTitle=this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.Compatibility")}return t.prototype.$onInit=function(){var e=this;this.disableStoragePods=this.migrationWizardManager.isXvcMigration()||this.migrationWizardManager.isXvMotion();var t=this.initStorageSelectorState();this.modeSettings=this.storageSelectorService.getStorageSelectorModeSettings(!0),this.storageSelectorApi=this.storageSelectorService.getStorageSelectorApiObj(),this.diskFormatSettings={diskFormatSupported:!0,sameAsSourceSupported:!0,thickDiskFormatSupported:!0},this.setLoading(!0),this.requestData().then(function(i){var r=!t&&e.initialStorageConfigurationService.initSelectedStorageItems(e.storageSelectorState,i,e.pageModel);r||e.initSelectedStorageItem(t?e.storageSelectorState:void 0,i),e.pageModel.initialVmStorageConfig&&e.initialStorageConfigurationService.computeSourceVmStorageConfig(e.pageModel.initialVmStorageConfig,i.storageProfilesData._storageProfiles,i,!1),e.storageSelectorData=i})["finally"](function(){e.setLoading(!1),e.$timeout(function(){var t=e.$element[0].querySelector(".migrate-storage-selector input[type=checkbox]");t&&t.focus()},0)})},t.prototype.setLoading=function(e){this.wizardConfig.loading=e},t.prototype.clearMessages=function(){this.wizardPageService.clearErrors(this.wizardConfig)},t.prototype.setWarningMessages=function(e){this.wizardPageService.showWarningMessages(this.wizardConfig,e)},t.prototype.onSelectionChanged=function(){if(this.isSelectionIncomplete()||this.storageSelectorApi.validateReplicationGroupSelection()){this.pageModel.virtualDisksByVm={},this.compatibilityMessages=[];var e=this.storageSelectorApi.validateReplicationGroupSelection();return void(e&&(this.compatibilityMessages=[{contents:[],icon:"vsphere-icon-status-error",message:e,advancedCompatibilityContents:{}}]))}this.isSelectorChanged()?this.validateSelection():this.onSkipValidation()},t.prototype.validateSelection=function(){var t=this;this.pageModel.isValidating=!0,this.clearMessages();var i=this.getVirtualDisksByVmSelections(),r=new e.MigrationWizardDataModel(this.pageModel.vms);r.virtualDisksByVm=i,r.computeResource=this.pageModel.computeResource,r.pool=this.pageModel.pool,this.vmMigrateStorageSelectionValidationService.validateSelection(r).then(function(e){t.compatibilityMessages=e.compatibilityMessages,t.pageModel.isAdvancedStorageMode="advancedMode"===t.storageSelectorState.mode,t.pageModel.virtualDisksByVm=e.hasSuccess?i:{},t.pageModel.isAdvancedStorageMode?(t.pageModel.lastCompatibilityMessagesAdvancedMode=e.compatibilityMessages,t.pageModel.lastSelectedStorageAdvancedMode=r.virtualDisksByVm):(t.pageModel.lastCompatibilityMessagesBasicMode=e.compatibilityMessages,t.pageModel.lastSelectedStorageBasicMode=r.virtualDisksByVm,t.pageModel.lastCompatibilityMessagesAdvancedMode||(t.pageModel.lastCompatibilityMessagesAdvancedMode=e.compatibilityMessages))}).then(function(){t.pageModel.isValidating=!1})},t.prototype.initStorageSelectorState=function(){return!this.pageModel.isComputeResourceChanged&&this.pageModel.storageSelectorState?(this.storageSelectorState=this.pageModel.storageSelectorState,!0):(this.pageModel.storageSelectorState=this.storageSelectorService.getStorageSelectorState(),this.storageSelectorState=this.pageModel.storageSelectorState,!1)},t.prototype.requestData=function(){var e=this;if(!this.pageModel.isComputeResourceChanged&&this.pageModel.storageSelectorData)return this.$q.when(this.pageModel.storageSelectorData);this.pageModel.isComputeResourceChanged=!1,this.pageModel.lastSelectedStorageAdvancedMode=[],this.pageModel.lastSelectedStorageBasicMode=[];var t=this.pageModel.computeResource?this.pageModel.computeResource:this.pageModel.vms[0];return this.requestVmData(t).then(function(i){return e.storageSelectorService.getStorageSelectorData(t,e.requestStorageGridData(),!e.pageModel.isXvcMigration,i.vmData,i.storageProfilesData).then(function(t){return e.pageModel.storageSelectorData=t,e.pageModel.storageNameMap=e.vmMigrateStorageLocatorService.getStorageObjectNameMap(t.storageLocatorItemsData),t})})},t.prototype.requestVmData=function(e){var t=this,i=[this.VM_DEVICE_PROP,this.VM_HOME_DATASTORE_PROP],r="changeStorageOnly"===this.migrationWizardManager.getSelectedMode();r&&i.push(this.VM_HOST_PROP);var n=this.defaultUriSchemeUtil.getManagedObjectReference(e).serverGuid,o={advancedStorageData:this.migrationWizardManager.getAdvancedStoragePageData(),profiles:this.storageProfileService.fetchStorageProfilesData(n,{includeKeepExisting:!this.pageModel.isXvcMigration})};return this.$q.all(o).then(function(e){var i=e.advancedStorageData,n=[],o=e.profiles;return o.vmProfileAssignments={},o.vmReplicationGroupAssignments={},t.pageModel.vmHomeDatastores={},t.pageModel.vmDisks={},t.pageModel.vmHosts={},_.forEach(t.pageModel.vms,function(e){if(i&&i[e]&&i[e][t.ADVANCED_PAGE_DATA_PROPERTY]){var a=i[e][t.ADVANCED_PAGE_DATA_PROPERTY],s=null;t.pageModel.vmHosts[e]=t.defaultUriSchemeUtil.getVsphereObjectId(a.host),r?a.host&&(s=t.pageModel.vmHosts[e]):s=t.pageModel.computeResource&&"HostSystem"===t.defaultUriSchemeUtil.getEntityType(t.pageModel.computeResource)?t.pageModel.computeResource:null;var c=a.virtualDisks||[];t.pageModel.vmDisks[e]=c;var l=a.vmHomeDatastore?t.defaultUriSchemeUtil.getVsphereObjectId(a.vmHomeDatastore):null;t.pageModel.vmHomeDatastores[e]=l,o.vmProfileAssignments[e]=a.storagePoliciesAssignments,o.vmReplicationGroupAssignments[e]=a.vmReplicationGroupAssignments,n.push({id:e,name:t.migrationWizardManager.getVmNames()[e],homeDatastore:l,destinationHost:s,disksData:c})}}),{vmData:n,storageProfilesData:o}})},t.prototype.requestStorageGridData=function(){return"changeStorageOnly"===this.migrationWizardManager.getSelectedMode()?this.vmMigrateStorageLocatorService.getStorageLocatorData({vms:this.pageModel.vms}):this.vmMigrateStorageLocatorService.getStorageLocatorData({vms:this.pageModel.vms,resource:this.pageModel.computeResource})},t.prototype.initSelectedStorageItem=function(e,t){if(!e){t.initialConfig||(t.initialConfig={});var i=this.calculateSelectedStorageItem(t.storageLocatorItemsData,t.sourceVmStorageConfig);i.reason&&this.setWarningMessages([i.reason]),t.initialConfig.selectedItemInBasicMode=i.item}},t.prototype.calculateSelectedStorageItem=function(e,t){var i;if(i=this.destinationTarget?this.defaultUriSchemeUtil.getEntityType(this.destinationTarget):void 0,i===this.managedEntityConstants.DATASTORE||i===this.managedEntityConstants.STORAGE_POD){var r=void 0;switch(i){case this.managedEntityConstants.DATASTORE:r=this.findStorageItem(e.datastoreItems,this.destinationTarget);break;case this.managedEntityConstants.STORAGE_POD:r=this.findStorageItem(e.storagePodItems,this.destinationTarget),r=r.drsEnabled?r:void 0;break;default:r=void 0}var n=void 0;return n=r?void 0:this.i18nService.getString("VmUi","MigrationWizard.storageListPage.warning.storageNotPrelected"),{item:r,reason:n}}var o=this.collectCurrentVmsStorage(t);if(1===_.size(o)){var a=this.findStorageItem(e.datastoreItems,o[0]);if(a){var s=this.findStorageItem(e.storagePodItems,this.defaultUriSchemeUtil.getVsphereObjectId(a.parentStoragePod));return s&&s.drsEnabled?{item:void 0}:{item:a}}}return{item:this.getSingleDatastoreOrPod(e)}},t.prototype.getSingleDatastoreOrPod=function(e){var t=this,i=_.reduce(e.storagePodItems,function(e,i){return i.drsEnabled&&(e[t.defaultUriSchemeUtil.getVsphereObjectId(i.storageRef)]=i),e},{});if(!(_.size(i)>1)){var r=_.filter(e.datastoreItems,function(e){return!e.parentStoragePod||!i[t.defaultUriSchemeUtil.getVsphereObjectId(e.parentStoragePod)]});if(!_.isEmpty(i))return _.isEmpty(r)?_.find(i,function(){return!0}):void 0;if(1===_.size(r))return r[0]}},t.prototype.getVirtualDisksByVmSelections=function(){var e=this,t={};return _.each(this.storageSelectorData.vmStorageConfig,function(i){var r=i.vmId;t[r]||(t[r]=[]);var n=i.vmHome;n.storageObj&&(t[r].push({key:"_configFile",label:n.name,storage:e.defaultUriSchemeUtil.getVsphereObjectId(n.storageObj.storageRef),parentStoragePod:e.defaultUriSchemeUtil.getVsphereObjectId(n.storageObj.parentStoragePod),profile:n.storageProfile,diskFormat:n.diskFormat?{label:n.diskFormat.name,value:n.diskFormat.type}:void 0,storageType:n.storageObj.type,replicationGroup:n.replicationGroup}),_.each(i.vmDisks,function(i){t[r].push({key:i.key,label:i.name,storage:i.storageObj?e.defaultUriSchemeUtil.getVsphereObjectId(i.storageObj.storageRef):void 0,parentStoragePod:i.storageObj?e.defaultUriSchemeUtil.getVsphereObjectId(i.storageObj.parentStoragePod):void 0,profile:i.storageProfile,diskFormat:i.diskFormat?{label:i.diskFormat.name,value:i.diskFormat.type}:void 0,storageType:i.storageObj?i.storageObj.type:void 0,capacityInBytes:i.capacityInBytes,replicationGroup:i.replicationGroup,origin:_.findWhere(e.pageModel.vmDisks[r],{key:i.key})})}))}),t},t.prototype.isSelectionIncomplete=function(){var e=this,t=_.some(this.storageSelectorData.vmStorageConfig,function(t){return!t.vmHome.storageObj||e.storageSelectorState.storageBaselineId!==e.storageSelectorConstants.PMEM_STORAGE_BASELINE.id&&_.some(t.vmDisks,function(t){return!t.storageObj&&!e.pmemUtilService.isPMemStoragePolicy(t.storageProfile)})});return t},t.prototype.collectCurrentVmsStorage=function(e){var t=this,i={};return _.each(e,function(e){if(e.vmHome.storageObj){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e.vmHome.storageObj.storageRef);i[r]=!0}_.each(e.vmDisks,function(e){if(e.storageObj){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e.storageObj.storageRef);i[r]=!0}})}),_.keys(i)},t.prototype.findStorageItem=function(e,t){var i=this;return _.find(e,function(e){return i.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef)===t})},t.prototype.isSelectorChanged=function(){if(this.pageModel.isComputeResourceChanged)return!0;var e=this.getVirtualDisksByVmSelections();this.pageModel.isAdvancedStorageMode="advancedMode"===this.storageSelectorState.mode;var t=this.pageModel.isAdvancedStorageMode?"lastSelectedStorageAdvancedMode":"lastSelectedStorageBasicMode",i=this.pageModel;return!angular.equals(e,i[t])&&(i[t]=e,!0)},t.prototype.onSkipValidation=function(){this.pageModel.isAdvancedStorageMode?this.compatibilityMessages=this.pageModel.lastCompatibilityMessagesAdvancedMode:this.compatibilityMessages=this.pageModel.lastCompatibilityMessagesBasicMode,this.pageModel.virtualDisksByVm=this.getVirtualDisksByVmSelections()},t.$inject=["i18nService","defaultUriSchemeUtil","vmMigrateStorageSelectionValidationService","managedEntityConstants","storageSelectorService","storageSelectorConstants","dataService","$q","$element","$timeout","vmMigrateStorageLocatorService","wizardPageService","initialStorageConfigurationService","storageProfileService","pmemUtilService"],t}();e.MigrateSelectStoragePageComponentController=i,angular.module("com.vmware.vsphere.client.vm").component("migrateSelectStoragePageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.isComputeResourceChanged=!1,this.vms=[],this.isAdvancedStorageMode=!1,this.virtualDisksByVm={},this.isValidating=!1}return e}();e.MigrateSelectStoragePageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/selectComputeResourcePageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={migrationWizardManager:"<",wizardConfig:"<",pageModel:"<",destinationTarget:"<"}}return e}();e.SelectComputeResourcePageComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u){this.$q=e,this.$element=t,this.$timeout=i,this.$scope=r,this.dataService=n,this.i18nService=o,this.defaultUriSchemeUtil=a,this.compatibilityResultsPresenter=s,this.managedEntityConstants=c,this.vuiConstants=l,this.wizardPageService=d,this.vmMigrateStretchedStorageService=u}return e.prototype.$onInit=function(){this.compatibilityTitle=this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.compatibility"),this.pageModel=this.migrationWizardManager.computeResourcePageModel,this.initializeObjectSelector(),this.pageModel.stretchedStorageService||(this.pageModel.stretchedStorageService=this.vmMigrateStretchedStorageService.newInstance());
},e.prototype.initializeObjectSelector=function(){var e=this,t={label:this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.hosts"),listViewId:"vsphere.core.host.list",dataModels:["HostSystem"],filterId:"vmMigrationHostFilter",filterParams:this.pageModel.vms,useLazyInstantiation:!0},i={label:this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.clusters"),listViewId:"vsphere.core.cluster.list",dataModels:["ClusterComputeResource"],filterId:"vmMigrationClusterFilter",filterParams:this.pageModel.vms,useLazyInstantiation:!0},r={label:this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.resourcePools"),listViewId:"vsphere.core.resourcePool.list",dataModels:["ResourcePool"],filterId:"vmMigrationResourcePoolFilter",filterParams:this.pageModel.vms,useLazyInstantiation:!0},n={label:this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.vapps"),listViewId:"vsphere.core.vApp.list",dataModels:["VirtualApp"],filterId:"vmMigrationVirtualAppFilter",filterParams:this.pageModel.vms,useLazyInstantiation:!0},o=this.migrationWizardManager.getDestinationComputeResourceUid();o=o||this.pageModel.initialComputeResource||this.destinationTarget,this.objSelectorConf={contextObject:this.pageModel.vms[0],multipleSelect:!1,listTabConfig:{selectedTabIndex:this.calculateInitialTab(o),listConfig:[t,i,r,n]},tabStyle:this.vuiConstants.tabs.style.PILLS,selectedObjects:this.calculateSelectedObjects(o),onSelectionChanged:function(t){e.onSelectionChanged(t)}},this.$timeout(function(){var t=e.$element[0].querySelector(".vm-migrate-compute-resource button.active");t&&t.focus()},0)},e.prototype.onSelectionChanged=function(e){var t=this;if(e&&0!==e.length){var i=e[0];if(i){if(i.id===this.pageModel.computeResource&&this.pageModel.compatibilityResultsCache)return void(this.compatibilityContents=this.pageModel.compatibilityResultsCache);this.pageModel.isValidating=!0;var r=this.$q.all({selectedObject:this.processSelectedObject(i),stretchedStorage:this.pageModel.stretchedStorageService.processStretchedStorage(i.id,this.pageModel.vms),targetDatacenter:this.dataService.getProperties(i.id,["dc"])});r.then(function(e){t.pageModel.stretchedStorage=e.stretchedStorage,t.pageModel.datacenter=t.defaultUriSchemeUtil.getVsphereObjectId(e.targetDatacenter.dc),t.pageModel.isValidating=!1})}}},e.prototype.processSelectedObject=function(e){var t=this;return this.migrationWizardManager.changeComputeResource(e).then(function(i){return i.isValid?t.pageModel.computeResource=e.id:t.pageModel.computeResource=void 0,t.compatibilityResultsPresenter.formatValidationResults(i.validationResults,!0)}).then(function(e){if(t.compatibilityContents=e,t.pageModel.compatibilityResultsCache=e,t.migrationWizardManager.getIsComputeResourceChanged()){var i=t.i18nService.getString("VmUi","MigrationWizard.resourceListPage.title");t.wizardPageService.invalidateNextPages(t.wizardConfig,t.migrationWizardManager.getSelectedMode(),i)}})},e.prototype.calculateSelectedObjects=function(e){return e?[e]:[]},e.prototype.calculateInitialTab=function(e){if(!e)return 0;var t=this.defaultUriSchemeUtil.getEntityType(e);switch(t){case this.managedEntityConstants.CLUSTER:return 1;case this.managedEntityConstants.RESOURCE_POOL:return 2;case this.managedEntityConstants.V_APP:return 3;case this.managedEntityConstants.HOST:return 0;default:return 0}},e.prototype.equalReferences=function(e,t){return e.value===t.value&&e.type===t.type&&e.serverGuid===t.serverGuid},e.$inject=["$q","$element","$timeout","$scope","dataService","i18nService","defaultUriSchemeUtil","compatibilityResultsPresenter","managedEntityConstants","vuiConstants","wizardPageService","vmMigrateStretchedStorageService"],e}();e.SelectComputeResourcePageController=i,angular.module("com.vmware.vsphere.client.vm").component("selectComputeResourcePageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.vms=[]}return e}();e.SelectComputeResourcePageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/selectComputeResourceTreePageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={wizardConfig:"<",migrationWizardManager:"<",pageModel:"<",destinationTarget:"<"}}return e}();e.SelectComputeResourceTreePageComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s){this.$scope=e,this.defaultUriSchemeUtil=t,this.managedEntityConstants=i,this.migrationService=r,this.compatibilityResultsPresenter=n,this.i18nService=o,this.dataService=a,this.wizardPageService=s,this.config={preselectRoot:!1},this.compatibilityTitle=this.i18nService.getString("VmUi","SelectDatastoreProvisioningPage.Compatibility"),this.treeLabel=this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.description")}return e.prototype.$onInit=function(){this.rootObjectId=this.calculateRootObject(),this.selectedObjectId=this.calculateSelectedObject(),this.selectedObjectId&&(this.wizardConfig.loading=!0)},e.prototype.onChange=function(e,t){this.processSelectedObject(e,t)},e.prototype.onError=function(){this.wizardConfig.loading=!1},e.prototype.processSelectedObject=function(e,t){var i=this;this.wizardPageService.clearErrors(this.wizardConfig),this.pageModel.isValidating=!0,this.migrationWizardManager.changeComputeResource({id:e,name:t}).then(function(t){i.compatibilityResultsPresenter.formatValidationResults(t.validationResults,!0).then(function(r){if(i.compatibilityContents=r,i.migrationWizardManager.getIsComputeResourceChanged()){var n=i.i18nService.getString("VmUi","MigrationWizard.resourceListPage.title");i.wizardPageService.invalidateNextPages(i.wizardConfig,i.migrationWizardManager.getSelectedMode(),n)}t.isValid?(i.pageModel.resource=e,i.getDatastore(e).then(function(e){i.pageModel.datacenter=e})):(i.pageModel.resource=void 0,i.pageModel.datacenter=void 0)}).then(function(){i.pageModel.isValidating=!1})}).then(function(){i.wizardConfig.loading=!1})},e.prototype.getDatastore=function(e){var t=this;return this.dataService.getProperties(e,["dc"]).then(function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.dc)})},e.prototype.calculateRootObject=function(){if(!this.pageModel.isXvcMigrationPossible){var e=this.pageModel.vms[0];return this.defaultUriSchemeUtil.getRootFolderFromVsphereObjectId(e)}},e.prototype.calculateSelectedObject=function(){var e=this.pageModel.resource||this.pageModel.initialResource;if(e)return e;var t=this.destinationTarget;if(t){var i=this.defaultUriSchemeUtil.getEntityType(t);switch(i){case this.managedEntityConstants.CLUSTER:case this.managedEntityConstants.RESOURCE_POOL:case this.managedEntityConstants.V_APP:case this.managedEntityConstants.HOST:e=t}}return e},e.$inject=["$scope","defaultUriSchemeUtil","managedEntityConstants","migrationService","compatibilityResultsPresenter","i18nService","dataService","wizardPageService"],e}();angular.module("com.vmware.vsphere.client.vm").component("selectComputeResourceTreePageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.vms=[]}return e}();e.SelectComputeResourceTreePageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/selectMigrationTypePageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={hostRef:"<",attributes:"<",wizardConfig:"<",migrationWizardManager:"<",pageModel:"<",migrationType:"<",destinationTarget:"<"}}return e}();e.SelectMigrationTypePageComponent=t;var i=function(){function e(e,t,i,r,n,o,a,s,c){this.migrationTypeConstants=e,this.wizardPageService=t,this.dataService=i,this.dataServiceUtil=r,this.defaultUriSchemeUtil=n,this.managedEntityConstants=o,this.i18nService=a,this.$element=s,this.$timeout=c,this.flowAvailability={},this.issues={changeResource:[],changeStorage:[],changeResourceAndStorage:[]},this.i18n=a.getString}return e.prototype.$onInit=function(){var e=this;return this.pageModel.cachedProperties?(this.onPropertiesReceived(this.pageModel.cachedProperties),void this.checkXvcAvailability(this.pageModel.cachedProperties)):void this.dataService.getPropertiesForObjects(this.pageModel.vms,["vmMigrationOptions","runtime.host"]).then(function(t){e.pageModel.cachedProperties=t,e.onPropertiesReceived(t),e.checkXvcAvailability(t)})},e.prototype.onPropertiesReceived=function(e){var t=this;this.processMigrationOptions(e),this.selectedMigrationType=this.calculateMigrationType(),this.onSelectionChanged(),this.$timeout(function(){var e=t.$element[0].querySelector("#selectMigrationTypePage input[value="+t.selectedMigrationType+"]");e&&e.focus()},0)},e.prototype.onSelectionChanged=function(){this.wizardConfig.currentPage.decisionOptions.selectedFlowId=this.selectedMigrationType,this.attributes.creationType=this.selectedMigrationType,this.migrationWizardManager.setSelectedMode(this.selectedMigrationType),this.wizardPageService.initializeFlowStates(this.wizardConfig.flows)},e.prototype.areAllHostsCompatible=function(e){var t=this,i=[];return _.each(e,function(e){if(!_.isEmpty(e["runtime.host"])){var r=t.defaultUriSchemeUtil.getVsphereObjectId(e["runtime.host"]);i.indexOf(r)===-1&&i.push(r)}}),this.dataService.getPropertiesForObjects(i,["config.product.version"],{skipLoadingNotification:!0}).then(function(e){return _.every(e,function(e){return t.isEsx6OrLater(e["config.product.version"])})})},e.prototype.haveSameVcOrigin=function(e){var t=this,i=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e[0]).serverGuid;return _.every(e,function(e){var r=t.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).serverGuid;return r===i})},e.prototype.isEsx6OrLater=function(e){if(null===e)return!1;if("e.x.p"===e)return!0;var t=e.split(".");return t.length>0&&Number(t[0])>5},e.prototype.checkXvcAvailability=function(e){var t=this;this.pageModel.isXvcMigrationPossible=!0;var i=this.haveSameVcOrigin(this.pageModel.vms);return i?void this.areAllHostsCompatible(e).then(function(e){e||(t.pageModel.isXvcMigrationPossible=!1)}):void(this.pageModel.isXvcMigrationPossible=!1)},e.prototype.processMigrationOptions=function(e){var t=this;this.flowAvailability.changeResourceOnly=!0,this.flowAvailability.changeStorageOnly=!0,this.flowAvailability.changeComputeResourceAndStorage=!0;var i={changeResource:[],changeStorage:[],changeResourceAndStorage:[]};_.each(e,function(e){e.vmMigrationOptions&&_.each(e.vmMigrationOptions.migrationAvailabilityOptions,function(e){t.flowAvailability.changeResourceOnly=t.processOption("host",e,i.changeResource)&&t.flowAvailability.changeResourceOnly,t.flowAvailability.changeStorageOnly=t.processOption("datastore",e,i.changeStorage)&&t.flowAvailability.changeStorageOnly,t.flowAvailability.changeComputeResourceAndStorage=t.processOption("hostAndDatastore",e,i.changeResourceAndStorage)&&t.flowAvailability.changeComputeResourceAndStorage})}),this.showReasons(i.changeResource,this.issues.changeResource),this.showReasons(i.changeStorage,this.issues.changeStorage),this.showReasons(i.changeResourceAndStorage,this.issues.changeResourceAndStorage)},e.prototype.processOption=function(e,t,i){var r=!0;return e===t.type&&(r=t.available,r||_.each(t.reasons,function(e){_.contains(i,e)||i.push(e)})),r},e.prototype.showReasons=function(e,t){var i=this;_.each(e,function(e){t.push(i.getReasonText(e))})},e.prototype.getReasonText=function(e){switch(e){case"hostInMaintenance":return this.i18n("VmUi","MigrationWizard.migrationTypePage.issue.hostInMaintenance");case"smpFt":return this.i18n("VmUi","MigrationWizard.migrationTypePage.issue.smpFt");case"ftSecondary":return this.i18n("VmUi","MigrationWizard.migrationTypePage.issue.ftSecondary");case"ftPrimaryNotInCorrectState":return this.i18n("VmUi","MigrationWizard.migrationTypePage.issue.ftPrimaryNotIncorrectState");case"noPrivilege":return this.i18n("VmUi","MigrationWizard.migrationTypePage.issue.noPrivilege")}},e.prototype.calculateMigrationType=function(){var e=this.migrationWizardManager.getSelectedMode();if(e&&this.flowAvailability[e])return e;if(this.destinationTarget){var t=this.defaultUriSchemeUtil.getEntityType(this.destinationTarget);switch(t){case this.managedEntityConstants.DATASTORE:case this.managedEntityConstants.STORAGE_POD:if(this.flowAvailability.changeStorageOnly)return this.migrationTypeConstants.MIGRATE_STORAGE_ONLY;break;default:if(this.flowAvailability.changeResourceOnly)return this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY}}return this.flowAvailability.changeResourceOnly?this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY:this.flowAvailability.changeStorageOnly?this.migrationTypeConstants.MIGRATE_STORAGE_ONLY:this.flowAvailability.changeComputeResourceAndStorage?this.migrationTypeConstants.MIGRATE_RESOURCE_AND_STORAGE:this.migrationTypeConstants.MIGRATE_RESOURCE_ONLY},e.$inject=["migrationTypeConstants","wizardPageService","dataService","dataServiceUtil","defaultUriSchemeUtil","managedEntityConstants","i18nService","$element","$timeout"],e}();angular.module("com.vmware.vsphere.client.vm").component("selectMigrationTypePageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.vms=[]}return e}();e.SelectMigrationTypePageModel=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/migrationWizard/pages/selectPriorityPageComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={migrationWizardManager:"<",pageModel:"<"}}return e}();e.SelectPriorityPageComponent=t;var i=function(){function e(e,t,i){this.i18nService=e,this.$element=t,this.$timeout=i,this.i18n=e.getString}return e.prototype.$onInit=function(){var e=this;this.pageModel.priority||(this.pageModel.priority=this.pageModel.initialPriority||"highPriority"),this.$timeout(function(){var t=e.$element[0].querySelector("#selectPriorityPageComponent input[value=highPriority]");"lowPriority"===e.pageModel.priority&&(t=e.$element[0].querySelector("#selectPriorityPageComponent input[value=lowPriority]")),t&&t.focus()},0)},e.$inject=["i18nService","$element","$timeout"],e}();e.SelectPriorityPageController=i,angular.module("com.vmware.vsphere.client.vm").component("selectPriorityPageComponent",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e}();e.SelectPriorityPageModel=t}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("vmMigrationFinishPageService",["i18nService","wizardPageService",function(e,t){return{build:function(i){function r(e){return e.xdrsRecommendationService?e.xdrsRecommendationService.hasInitErrors():e.recommendationService&&e.recommendationService.hasInitErrors()}return{title:e.getString("VmUi","MigrationWizard.readyPage.title"),description:e.getString("VmUi","MigrationWizard.readyPage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migrateFinishPage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",onCommit:function(){var n=i.migrationWizardManager.getFinishPageState();if(n.recommendationService.hasFaults())return t.markPageIncompleteWithError(i.wizardConfig,e.getString("VmUi","MigrationWizard.readyPage.error.sdrsFaults")),!1;if(n.xdrsRecommendationService&&n.xdrsRecommendationService.hasFaults()){var o=n.xdrsRecommendationService.getFaultsReason();return t.markPageIncompleteWithError(i.wizardConfig,e.getString("VmUi","MigrationWizard.readyPage.error.xdrs.drsFault",o)),!1}return r(n)?(t.markPageIncompleteWithError(i.wizardConfig,e.getString("VmUi","MigrationWizard.readyPage.error.invalid")),!1):(i.migrationWizardManager.submit(),t.markPageComplete(i.wizardConfig,i.migrationWizardManager.getSelectedMode()),!0)},finishReady:function(){return!i.wizardConfig.loading}}}}}]),angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectComputeResourcePageService",["i18nService","vuiConstants","wizardPageService",function(e,t,i){return{build:function(t){return{title:e.getString("VmUi","MigrationWizard.resourceListPage.title"),description:e.getString("VmUi","MigrationWizard.resourceListPage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/selectComputeResourcePage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",disableNext:function(){return t.migrationWizardManager.computeResourcePageModel.isValidating},onCommit:function(){return t.migrationWizardManager.hasValidComputeResourceSelected()?(t.wizardConfig.validationBanner.messages=[],i.markPageComplete(t.wizardConfig,t.attributes.creationType),!0):(i.markPageIncompleteWithError(t.wizardConfig,e.getString("VmUi","MigrationWizard.resourceListPage.error.invalid")),!1)}}}}}]);var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.wizardPageService=t,this.vmCryptUtilService=i}return e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.title"),description:this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/selectComputeResourceTreePage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",disableNext:function(){return e.migrationWizardManager.computeResourceTreePageModel.isValidating||!e.migrationWizardManager.computeResourceTreePageModel.resource},onCommit:function(){return t.onCommit(e)}}},e.prototype.onCommit=function(e){return e.migrationWizardManager.hasValidComputeResourceSelected()?(this.vmCryptUtilService.isVmCryptPolicyDisabledForMigrateWizard(e.migrationWizardManager.computeResourceTreePageModel.resource,e.migrationWizardManager.storagePageModel),e.wizardConfig.validationBanner.messages=[],this.wizardPageService.markPageComplete(e.wizardConfig,e.attributes.creationType),!0):(this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,this.i18nService.getString("VmUi","MigrationWizard.resourceListPage.error.invalid")),!1)},e.$inject=["i18nService","wizardPageService","vmCryptUtilService"],e}();e.VmMigrationSelectComputeResourceTreePageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectComputeResourceTreePageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.wizardPageService=t}return e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("VmUi","MigrationWizard.selectFolderPage.Title"),description:this.i18nService.getString("VmUi","MigrationWizard.selectFolderPage.Description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migrateSelectFolderPage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",disableNext:function(){return e.migrationWizardManager.folderPageModel.isValidating||e.migrationWizardManager.folderPageModel.isLoading},onCommit:function(){return t.onCommit(e)}}},e.prototype.onCommit=function(e){return e.migrationWizardManager.hasValidFolderSelected()?(e.wizardConfig.validationBanner.messages=[],this.wizardPageService.markPageComplete(e.wizardConfig,e.attributes.creationType),!0):(this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,this.i18nService.getString("VmUi","MigrationWizard.selectFolderPage.error.invalid")),!1)},e.$inject=["i18nService","wizardPageService"],e}();e.VmMigrationSelectFolderPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectFolderPageService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectMigrationTypePageService",["i18nService","wizardPageService","vmCryptUtilService","migrationTypeConstants",function(e,t,i,r){return{build:function(n,o){return{title:e.getString("VmUi","MigrationWizard.migrationTypePage.heading"),description:e.getString("VmUi","MigrationWizard.migrationTypePage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/selectMigrationTypePage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",hostData:n.attributes.hostData,decisionOptions:{flowIds:o,selectedFlowId:r.MIGRATE_RESOURCE_ONLY},disableNext:function(){return!n.migrationWizardManager.migrationTypePageModel.cachedProperties},onCommit:function(){return n.wizardConfig.validationBanner.messages=[],t.markPageComplete(n.wizardConfig,n.attributes.creationType),n.migrationWizardManager.getSelectedMode()===r.MIGRATE_STORAGE_ONLY&&(i.isVmCryptPolicyDisabledForMigrateWizard(n.migrationWizardManager._theModel.vms[0],n.migrationWizardManager.storagePageModel),n.migrationWizardManager.clearSelectedComputeResource()),!0}}}}}]);var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.wizardPageService=t,this.defaultUriSchemeUtil=i,this.dataServiceUtil=r,this.MigrateSelectNetworkPageModel=n,this.NetworkPageViewModes=o}return e.prototype.build=function(e){var t=this;return{title:this.i18nService.getString("VmUi","MigrationWizard.networkPage.title"),description:this.i18nService.getString("VmUi","MigrationWizard.networkPage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migrateSelectNetworkPage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",disableNext:function(){return t.disableNext(e)},onCommit:function(){return t.onCommit(e)}}},e.prototype.disableNext=function(e){var t=e.migrationWizardManager.networkPageModel;return t.getSelectNetworkPageIsValidating()},e.prototype.onCommit=function(e){var t=this,i={name:"name",key:"key",dvsUuid:"dvsUuid",opaqueNetworkType:"summary/opaqueNetworkType",opaqueNetworkId:"summary/opaqueNetworkId"},r=e.migrationWizardManager.networkPageModel,n=r.getSelectNetworkPageViewMode();if(n===this.NetworkPageViewModes.BASIC){if(!this.hasValidDestinationNetwork(r,r.getBasicNetworkMatches()))return this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,this.i18nService.getString("Common","vns.error.matchingIncompleteBasic")),!1}else if(!this.hasValidDestinationNetwork(r,r.getAdvancedNetworkMatches()))return this.wizardPageService.markPageIncompleteWithError(e.wizardConfig,this.i18nService.getString("Common","vns.error.matchingIncompleteAdvanced")),!1;e.wizardConfig.validationBanner.messages=[],this.wizardPageService.markPageComplete(e.wizardConfig,e.attributes.creationType);var o=e.migrationWizardManager.getNetworkMatches(),a=_.uniq(_.map(o,function(e){return t.defaultUriSchemeUtil.getVsphereObjectId(e.destinationNetwork)}));return this.dataServiceUtil.getPropertiesForObjects(a,[i.name,i.key,i.dvsUuid,i.opaqueNetworkType,i.opaqueNetworkId]).then(function(i){return t.onNetworkPropertiesReturn(e,i)})},e.prototype.onNetworkPropertiesReturn=function(e,t){var i=this,r=e.migrationWizardManager.getNetworkMatches();return _.forEach(r,function(e){var r=i.defaultUriSchemeUtil.getVsphereObjectId(e.destinationNetwork),n=t[r];n&&(e.destinationSwitchUuid=n.dvsUuid,e.destinationNetworkName=n.name,e.destinationPortgroupKey=n.key,e.destinationOpaqueId=n["summary/opaqueNetworkId"],e.destinationOpaqueType=n["summary/opaqueNetworkType"])}),!0},e.prototype.hasValidDestinationNetwork=function(e,t){if(t.length<=0)return!0;if(e.getSelectNetworkPageViewMode()===this.NetworkPageViewModes.BASIC&&!e.isBasicPageValid)return!1;if(e.getSelectNetworkPageViewMode()===this.NetworkPageViewModes.ADVANCED&&!e.isAdvancedPageValid)return!1;var i=!0;return _.each(t,function(e){!e.destinationNetwork&&e.sourceNetwork&&(i=!1)}),i},e.$inject=["i18nService","wizardPageService","defaultUriSchemeUtil","dataServiceUtil","MigrateSelectNetworkPageModel","NetworkPageViewModes"],e}();e.VmMigrationSelectNetworkPageService=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectNetworkPageService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectPriorityPageService",["i18nService","vuiConstants","wizardPageService",function(e,t,i){return{build:function(t){return{title:e.getString("VmUi","MigrationWizard.priorityPage.title"),description:e.getString("VmUi","MigrationWizard.priorityPage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/selectPriorityPage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",onCommit:function(){return i.markPageComplete(t.wizardConfig,t.attributes.creationType),!0}}}}}]),angular.module("com.vmware.vsphere.client.vm").service("vmMigrationSelectStoragePageService",["i18nService","wizardPageService",function(e,t){return{build:function(i){return{title:e.getString("VmUi","MigrationWizard.storageListPage.title"),description:e.getString("VmUi","MigrationWizard.storageListPage.description"),contentUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migrateSelectStoragePage.html",headerUrl:"vm-ui/resources/vm/views/migrationWizard/pages/migratePagesCustomHeader.html",disableNext:function(){return i.migrationWizardManager.storagePageModel.isValidating},onCommit:function(){return i.migrationWizardManager.hasValidStorage()?(i.wizardConfig.validationBanner.messages=[],t.markPageComplete(i.wizardConfig,i.attributes.creationType),!0):(t.markPageIncompleteWithError(i.wizardConfig,e.getString("VmUi","MigrationWizard.storageListPage.error.invalid")),!1)}}}}}]);var h5_vm;!function(e){var t=function(){function e(e){this.defaultUriSchemeUtil=e}return e.prototype.isXvcOperation=function(e,t){return this.isXvcOperationByRef(e,this.defaultUriSchemeUtil.getManagedObjectReference(t))},e.prototype.isXvcOperationByRef=function(e,t){var i=this;if(!t||!t.serverGuid)return!1;var r=t.serverGuid,n=_.some(e,function(e){var t=i.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).serverGuid;return r!==t});return n},e.$inject=["defaultUriSchemeUtil"],e}();e.MigrationHelperService=t,angular.module("com.vmware.vsphere.client.vm").service("migrationHelperService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.$q=e,this.i18nService=t,this.dataService=i,this.dataServiceUtil=r,this.defaultUriSchemeUtil=n,this.networkSelectorDialogService=o,this.migrationService=a,this.compatibilityResultsPresenter=s,this.managedEntityConstants=c,this.networkSelectorPrefetchingService=l,this.networkPageViewModes=d,this.migrationWizardManager=u,this.pageModel=p,this.validationLoadingHandlerFn=v,this.DESTINATION_NETWORKS_FOR_VMS="destinationNetworksForMigrateVms",this.MAX_PREFETCHED_NETWORKS_COUNT=10,this.migrationWizardManager=u,this.prefetchedNetworksBasic=p.getSelectNetworkPagePrefechedNetworks().basic,this.prefetchedNetworksAdvanced=p.getSelectNetworkPagePrefechedNetworks().advanced,this.isAutoSelectionMessageAdded=!1,this.isSelectionPerformed=!1,this.basicViewData=[],this.advancedViewData=[],this.compatibilityMessages=[],this.pageModel=p}return e.prototype.getTotalPrefetchedNetworksCount=function(){return this.pageModel.getSelectNetworkPagePrefechedNetworks().totalMatchesCount},e.prototype.setTotalPrefetchedNetworksCount=function(e){this.pageModel.getSelectNetworkPagePrefechedNetworks().totalMatchesCount=e},e.prototype.getNetworkMatches=function(){return this.migrationWizardManager.getNetworkMatches()},e.prototype.initPrefetchedNetworks=function(e){this.initPrefetchedNetwork(e,this.networkPageViewModes.BASIC),this.initPrefetchedNetwork(e,this.networkPageViewModes.ADVANCED)},e.prototype.initPrefetchedNetwork=function(e,t){var i=this,r=t===this.networkPageViewModes.BASIC?this.prefetchedNetworksBasic:this.prefetchedNetworksAdvanced;r.length=0,_.each(e,function(e){r.push(e)}),_.each(this.pageModel.initialMatches,function(e){var t=i.defaultUriSchemeUtil.getVsphereObjectId(e.destinationNetwork);_.find(r,function(e){return e.id===t})||r.push({name:e.destinationNetworkName,id:t,dvsUuid:e.destinationSwitchUuid,opaqueNetworkType:e.destinationOpaqueType,portgroupKey:e.destinationPortgroupKey})})},e.prototype.getViewData=function(){return this.pageModel.getSelectNetworkPageViewData()},e.prototype.getAdvancedNetworkMatches=function(){return this.pageModel.getAdvancedNetworkMatches()},e.prototype.setAdvancedNetworkMatches=function(e){this.updateWithInitialNetworkMatchesIfAvailable(e),this.pageModel.setAdvancedNetworkMatches(e)},e.prototype.getBasicNetworkMatches=function(){return this.pageModel.getBasicNetworkMatches()},e.prototype.setBasicNetworkMatches=function(e){return this.updateWithInitialNetworkMatchesIfAvailable(e),this.pageModel.setBasicNetworkMatches(e)},e.prototype.getPrefetchedNetworks=function(){return this.pageModel.getSelectNetworkPagePrefechedNetworks()},e.prototype.getNetworkProviderId=function(){var e=this.migrationWizardManager.getDestinationHostRef();return e||(e=this.migrationWizardManager.getDestinationClusterRef()),this.defaultUriSchemeUtil.getVsphereObjectId(e)},e.prototype.getBasicViewData=function(){return this.basicViewData},e.prototype.getAdvancedViewData=function(){return this.advancedViewData},e.prototype.getCompatibilityMessages=function(){return this.compatibilityMessages},e.prototype.addCompatibilityMessage=function(e){this.compatibilityMessages.push(e)},e.prototype.addCompatibilityMessages=function(e){if(e)for(var t=0;t<e.length;t++)this.addCompatibilityMessage(e[t])},e.prototype.setCompatibilityMessage=function(e){this.clearCompatibilityMessages(),this.addCompatibilityMessage(e)},e.prototype.setCompatibilityMessages=function(e,t){this.clearCompatibilityMessages(),this.addCompatibilityMessages(e),this.pageModel.getSelectNetworkPageViewMode()===this.networkPageViewModes.BASIC?(this.pageModel.setBasicCompatibilityResultsCache(e),this.pageModel.isBasicPageValid=t):(this.pageModel.setAdvancedCompatibilityResultsCache(e),this.pageModel.isAdvancedPageValid=t)},e.prototype.clearCompatibilityMessages=function(){this.compatibilityMessages.length=0},e.prototype.requestData=function(e){var t=this,i=!1;return this.$q.all({vmNameByIds:this.dataService.getPropertiesForObjects(e,["name"]),networksByIds:this.dataServiceUtil.getPropertiesForObjectsByRelation(e,"allNetwork",["name"]),destinationNetworkMatches:this.dataService.getProperties(this.getNetworkProviderId(),[this.DESTINATION_NETWORKS_FOR_VMS],{propertyParams:[{propertyName:this.DESTINATION_NETWORKS_FOR_VMS,parameterType:"[Lcom.vmware.vim.binding.vmodl.ManagedObjectReference;",parameter:this.defaultUriSchemeUtil.getManagedObjectReferences(e)}]})}).then(function(e){_.each(e.destinationNetworkMatches[t.DESTINATION_NETWORKS_FOR_VMS],function(i){var r=t.defaultUriSchemeUtil.getVsphereObjectId(i.sourceNetwork);i.sourceNetworkName=e.networksByIds&&e.networksByIds[r]?e.networksByIds[r].name:null});var r={};r.prefetchedNetworksPromise=t.prefetchNetworks(e).then(function(e){t.initPrefetchedNetworks(e)}),t.addDataToViewModel(e),t.buildBasicData(),t.buildAdvancedData();var n=t.pageModel.getSelectNetworkPageViewMode()===t.networkPageViewModes.BASIC?t.getBasicNetworkMatches():t.getAdvancedNetworkMatches();return t.migrationWizardManager.setNetworkMatches(n),(i=_.some(n,function(e){return e.sourceNetwork&&!e.destinationNetwork}))?r:(t.checkCompatibility(),r)})},e.prototype.prefetchNetworks=function(e){var t=this,i=this.networkSelectorDialogService.createNetworkSelectorFilterSpec(!0,!0,!0,!1,!0),r=_.filter(e.destinationNetworkMatches[this.DESTINATION_NETWORKS_FOR_VMS],function(e){return e.destinationNetwork}),n=_.map(r,function(e){return e.destinationNetwork}),o=this.MAX_PREFETCHED_NETWORKS_COUNT,a={skipLoadingNotification:!0};return this.networkSelectorPrefetchingService.prefetchNetworks(this.getNetworkProviderId(),i,n,o,a).then(function(e){return t.setTotalPrefetchedNetworksCount(e.networkMatchesCount),e.recentNetworks})},e.prototype.addDataToViewModel=function(e){this.getViewData().vmNamesById=this.dataServiceUtil.createPropertyByObjectMap(e.vmNameByIds,"name"),this.getViewData().sourceNetworkNamesById=this.dataServiceUtil.createPropertyByObjectMap(e.networksByIds,"name"),this.pageModel.getSelectNetworkPageIsInitialized()||(this.setBasicNetworkMatches(angular.copy(e.destinationNetworkMatches[this.DESTINATION_NETWORKS_FOR_VMS])),
this.setAdvancedNetworkMatches(angular.copy(e.destinationNetworkMatches[this.DESTINATION_NETWORKS_FOR_VMS]))),this.getViewData().networkSelector={}},e.prototype.networksMatchNetworkEquals=function(e,t){var i;i=angular.isObject(t)?this.defaultUriSchemeUtil.getVsphereObjectId(t):t;var r;return r=angular.isObject(e)?this.defaultUriSchemeUtil.getVsphereObjectId(e.sourceNetwork):e,r===i},e.prototype.networksMatchSourceAdapterEquals=function(e,t){var i=this.defaultUriSchemeUtil.getVsphereObjectId(e.sourceVm),r=this.defaultUriSchemeUtil.getVsphereObjectId(t.sourceVm);return t.sourceAdapter.key===e.sourceAdapter.key&&i===r},e.prototype.finderBasic=function(e,t){var i=this;if(t.sourceNetworkId&&e.sourceNetwork)return this.networksMatchNetworkEquals(e,t.sourceNetworkId);var r=!1;return _.each(t.adapterMatches,function(t){var n=i.networksMatchSourceAdapterEquals(e,{sourceVm:t.sourceVm,sourceAdapter:{key:t.sourceAdapter.key}});n&&(r=!0)}),r},e.prototype.finderAdvanced=function(e,t){return t.sourceNetworkId&&e.sourceNetwork?this.networksMatchNetworkEquals(e,t.sourceNetworkId)&&this.networksMatchSourceAdapterEquals(e,t):this.networksMatchSourceAdapterEquals(e,t)},e.prototype.setDestinationNetwork=function(e,t){e.destinationNetwork=t.networkRef,e.destinationNetworkName=t.name,e.destinationPortgroupKey=t.portgroupKey,e.destinationSwitchUuid=t.dvsUuid,e.destinationOpaqueType=t.opaqueNetworkType,e.destinationOpaqueId=t.destinationOpaqueId},e.prototype.onSelectNetwork=function(e,t,i){var r=this;if(this.pageModel.getSelectNetworkPageViewMode()===this.networkPageViewModes.BASIC?(this.pageModel.setBasicCompatibilityResultsCache(null),this.pageModel.isBasicPageValid=!1):(this.pageModel.setAdvancedCompatibilityResultsCache(null),this.pageModel.isAdvancedPageValid=!1),e.networkRef.type!==this.managedEntityConstants.OPAQUE_NETWORK)return this.$q.when(this.onNetworkPropertiesReturn(e,t,i));var n=this.defaultUriSchemeUtil.getVsphereObjectId(e.networkRef);return this.dataServiceUtil.getPropertiesForObjects([n],["summary/opaqueNetworkType","summary/opaqueNetworkId"]).then(function(o){return e.destinationOpaqueId=o[n]["summary/opaqueNetworkId"],e.opaqueNetworkType=o[n]["summary/opaqueNetworkType"],r.onNetworkPropertiesReturn(e,t,i)})},e.prototype.onNetworkPropertiesReturn=function(e,t,i){var r=this,n=i===this.networkPageViewModes.BASIC,o=n?this.getBasicNetworkMatches():this.getAdvancedNetworkMatches();return _.each(o,function(i){var o=n?r.finderBasic(i,t):r.finderAdvanced(i,t);o&&r.setDestinationNetwork(i,e)}),this.removeAutoSelectionMessageIfNeeded(),this.syncNetworkMatches(),n?this.buildBasicData():this.buildAdvancedData(),this.checkCompatibility()},e.prototype.buildBasicData=function(){var e=this,t=this.getViewData().vmNamesById,i=this.getViewData().sourceNetworkNamesById,r=this.getBasicNetworkMatches(),n={};this.basicViewData.length=0;var o=this.basicViewData,a=this;_.each(r,function(r){var s,c=e.defaultUriSchemeUtil.getVsphereObjectId(r.sourceNetwork),l=e.defaultUriSchemeUtil.getVsphereObjectId(r.sourceVm);n[c]?(s=n[c],s._attachedAdapters.push(r.sourceAdapter),s._attachedVmNamesById[l]=t[l],s.adapterMatches.push(r)):(s={index:o.length,sourceNetworkId:c,networkName:i[c],_attachedVmNamesById:{},_attachedAdapters:[r.sourceAdapter],usedBy:function(){return a.i18nService.getString("Common","vns.usedBy.format",_.keys(this._attachedVmNamesById).length.toString(),this._attachedAdapters.length.toString())},destinationNetworkName:r.destinationNetworkName,destinationNetworkRef:r.destinationNetwork,opaqueNetworkType:r.destinationOpaqueType,adapterMatches:[r]},s._attachedVmNamesById[l]=t[l],n[c]=s,o.push(s))})},e.prototype.buildAdvancedData=function(){var e=this,t=this.getViewData().vmNamesById,i=this.getViewData().sourceNetworkNamesById,r=this.getAdvancedNetworkMatches();this.advancedViewData.length=0;var n=this.advancedViewData;_.each(r,function(r,o){var a=e.defaultUriSchemeUtil.getVsphereObjectId(r.sourceNetwork),s=e.defaultUriSchemeUtil.getVsphereObjectId(r.sourceVm),c={index:o,vmName:t[s],sourceAdapterLabel:r.sourceAdapter.deviceInfo.label,sourceAdapter:r.sourceAdapter,sourceNetworkId:a,sourceNetworkName:i[a],destinationNetworkName:r.destinationNetworkName,destinationNetworkRef:r.destinationNetwork,sourceVm:r.sourceVm};n.push(c)})},e.prototype.updateWithInitialNetworkMatchesIfAvailable=function(e){var t=this;_.each(e,function(e){var i=t.findMatchHint(e.sourceVm,e.sourceAdapter);i&&t.updateMatchDestination(e,i)})},e.prototype.updateMatchDestination=function(e,t){e.destinationNetwork=t.destinationNetwork,e.destinationNetworkName=t.destinationNetworkName,e.destinationPortgroupKey=t.destinationPortgroupKey,e.destinationSwitchUuid=t.destinationSwitchUuid,e.destinationOpaqueId=t.destinationOpaqueId,e.destinationOpaqueType=t.destinationOpaqueType},e.prototype.findMatchHint=function(e,t){var i=this;if(this.pageModel.initialMatches)return _.find(this.pageModel.initialMatches,function(r){return i.defaultUriSchemeUtil.compareIds(r.sourceVm,e)&&r.sourceAdapter.key===t.key})},e.prototype.checkCompatibility=function(){var e=this;if(this.pageModel.getSelectNetworkPageViewMode()===this.networkPageViewModes.BASIC){if(this.pageModel.getBasicCompatibilityResultsCache())return void this.setCompatibilityMessages(this.pageModel.getBasicCompatibilityResultsCache(),this.pageModel.isBasicPageValid)}else if(this.pageModel.getAdvancedCompatibilityResultsCache())return void this.setCompatibilityMessages(this.pageModel.getAdvancedCompatibilityResultsCache(),this.pageModel.isAdvancedPageValid);this.validationLoadingHandlerFn(!0);var t=!1;return this.migrationService.validateNetworkPrivilege(this.migrationWizardManager.getNetworkMatches()).then(function(t){return _.find(t,function(e){return e.error})?t:e.migrationService.validateNetwork(e.migrationWizardManager.getVmIds(),e.migrationWizardManager.getNetworkMatches(),e.defaultUriSchemeUtil.getVsphereObjectId(e.migrationWizardManager.getTargetResourcePoolRef()),e.defaultUriSchemeUtil.getVsphereObjectId(e.migrationWizardManager.getDestinationComputeResourceRef()))}).then(function(i){return t=e.migrationService.isValidationSuccessful(i),e.compatibilityResultsPresenter.formatValidationResults(i)}).then(function(i){if(i.length>0)return e.setCompatibilityMessages(i,t),void e.validationLoadingHandlerFn(!1);var r=[{icon:"vsphere-icon-status-ok",message:e.i18nService.getString("VmUi","ProvisioningWizard.CompatibilityChecksSucceeded"),contents:[]}],n=e.migrationWizardManager.getNetworkMatches();e.addAutoSelectionMessageIfRequired(r,n),e.setCompatibilityMessages(r,t),e.validationLoadingHandlerFn(!1)})},e.prototype.addAutoSelectionMessageIfRequired=function(e,t){var i=this;this.isSingleNetworkPrefetched()&&this.areAllPortGroups(t)&&!this.isAutoSelectionMessageAdded&&_.find(t,function(t){if(i.isAutoSelectionMessageAdded===!1&&t.sourceNetwork&&t.destinationNetwork&&t.sourceNetwork.value!==t.destinationNetwork.value){var r={icon:"vsphere-icon-help-info-hover",message:i.i18nService.getString("VmUi","MigrationWizard.networkPage.info.autoSelectedDifferentNetwork"),contents:[]};return e.push(r),i.isAutoSelectionMessageAdded=!0,!0}return!1})},e.prototype.removeAutoSelectionMessageIfNeeded=function(){this.isSelectionPerformed&&this.isAutoSelectionMessageAdded&&this.setCompatibilityMessage({icon:"vsphere-icon-status-ok",message:this.i18nService.getString("VmUi","ProvisioningWizard.CompatibilityChecksSucceeded"),contents:[]})},e.prototype.areAllPortGroups=function(e){var t=this,i=!0;return _.each(e,function(e){(!e.destinationNetwork||e.sourceNetwork&&e.sourceNetwork.type!==e.destinationNetwork.type||e.sourceNetwork&&e.sourceNetwork.type!==t.managedEntityConstants.DISTRIBUTED_VIRTUAL_PORTGROUP)&&(i=!1)}),i},e.prototype.isSingleNetworkPrefetched=function(){return 1===this.getTotalPrefetchedNetworksCount()},e.prototype.syncNetworkMatches=function(){var e=this;this.pageModel.getSelectNetworkPageViewMode()===this.networkPageViewModes.ADVANCED?(this.pageModel.getSelectNetworkPageIsViewChanged()||(this.getAdvancedNetworkMatches().length=0,_.each(this.getBasicNetworkMatches(),function(t){e.getAdvancedNetworkMatches().push(angular.copy(t))}),this.initPrefetchedNetwork(this.prefetchedNetworksBasic,this.networkPageViewModes.ADVANCED),this.buildAdvancedData(),this.pageModel.setSelectNetworkPageIsViewChanged(!0)),this.migrationWizardManager.setNetworkMatches(this.getAdvancedNetworkMatches())):this.migrationWizardManager.setNetworkMatches(this.getBasicNetworkMatches())},e}();e.VmMigrateSelectNetworkService=t,angular.module("com.vmware.vsphere.client.vm").service("vmMigrateSelectNetworkService",["$q","i18nService","dataService","dataServiceUtil","defaultUriSchemeUtil","networkSelectorDialogService","migrationService","compatibilityResultsPresenter","managedEntityConstants","networkSelectorPrefetchingService","NetworkPageViewModes",function(e,i,r,n,o,a,s,c,l,d,u){return function(p,v,m){return new t(e,i,r,n,o,a,s,c,l,d,u,p,v,m)}}])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t,i,r,n,o=com.vmware.vsphere.client.vm.migration.LocationSpecPair,a=com.vmware.vsphere.client.h5.vm.model.migration.VmMigrationCancelRecommendationsSpec,s=function(){function e(){this._vmIds=[],this._recommendationsByPod={},this._faultsByVm={},this._selectedRecommendations={},this._recommendationsToCancel=[],this._hasInitErrors=!1}return e.prototype.load=function(e){var r=this;if(_.isEmpty(e))return n.when([]).then(function(){r.parseResponse([]),r.autoselectRecommendation()});this.attachCancelRecommendations(e);var a=(new o)._type;return this._vmIds=_.map(e,function(e){return t.getVsphereObjectId(e.entity)}),i.validateMultiSpec(a,e).then(function(e){r.parseResponse(e),r.autoselectRecommendation()})},e.prototype.hasRecommendations=function(){return Object.keys(this._recommendationsByPod).length>0},e.prototype.hasFaults=function(){return Object.keys(this._faultsByVm).length>0},e.prototype.hasFaultsForVm=function(e){return!_.isEmpty(this._faultsByVm[e])},e.prototype.getFaultsForVm=function(e){return this._faultsByVm[e]},e.prototype.hasDiskRecommendations=function(e,t){var i=this,r=t||{},n=r.parentStoragePodUrn?r.parentStoragePodUrn:r.storageUrn;if(!this._recommendationsByPod[n])return!1;var o=_.find(this._recommendationsByPod[n],function(t){return i.isRecommendationForVm(e,t)});return!!o},e.prototype.getDiskRecommendations=function(e,t){var i=this,r=t||{},n=r.parentStoragePodUrn?r.parentStoragePodUrn:r.storageUrn;return this._recommendationsByPod[n]?_.filter(this._recommendationsByPod[n],function(t){return i.isRecommendationForVm(e,t)}):null},e.prototype.getAllDiskRecommendationsAsArray=function(){var e=[];return _.each(this._recommendationsByPod,function(t){e=e.concat(t)}),e},e.prototype.getSelectedRecommendationsByVm=function(){var e=this,t={};return _.each(this._selectedRecommendations,function(i){_.each(e._vmIds,function(e){t[e]||(t[e]=[]);var r=i[e];r&&t[e].push(r)})}),t},e.prototype.setSelectedRecommendation=function(e,t,i){var r=t.parentStoragePodUrn?t.parentStoragePodUrn:t.storageUrn;this._selectedRecommendations[r][e]=i.spec},e.prototype.getSelectedRecommendation=function(e,t){var i=t.parentStoragePodUrn?t.parentStoragePodUrn:t.storageUrn;return this._selectedRecommendations[i]?this._selectedRecommendations[i][e]:void 0},e.prototype.cancelRecommendations=function(e){var r=this.getRecommendationToCancel(e);if(!_.isEmpty(r)){var n=new a;n.keys=r;var o=t.getRootFolderFromVsphereObjectId(this._vmIds[0]);i.apply(o,n._type,n),this._recommendationsToCancel=[]}},e.prototype.attachCancelRecommendations=function(e,t){void 0===t&&(t=!1);var i=this.getRecommendationToCancel(t);if(!_.isEmpty(e)&&!_.isEmpty(i)){var r=e[0];r.spec.cancelRecommendations=i}},e.prototype.getRecommendationToCancel=function(e){void 0===e&&(e=!1);var t=this._recommendationsToCancel;if(e){var i=[];_.each(this._selectedRecommendations,function(e){_.each(e,function(e){i.push(e.key)})}),t=_.difference(t,i)}return t},e.prototype.parseResponse=function(e){var i=this;this._recommendationsByPod={},this._faultsByVm={},this._hasInitErrors=!1,_.each(e,function(e){if(e){var r=t.getVsphereObjectId(e.entity);_.each(e.result,function(n){if(n.result&&n.result.recommendations){var o=n.result.recommendations;i._recommendationsToCancel=[],_.each(o,function(e){i._recommendationsToCancel.push(e.key);var r=t.getVsphereObjectId(e.target);i._recommendationsByPod[r]||(i._recommendationsByPod[r]=[]),i._recommendationsByPod[r].push(e)})}n.result&&n.result.drsFault&&_.each(n.result.drsFault.faultsByVm,function(e){var r=t.getVsphereObjectId(e.vm);i._faultsByVm[r]||(i._faultsByVm[r]=[]),i._faultsByVm[r]=i._faultsByVm[r].concat(e.fault)}),n.error&&(i._faultsByVm[r]||(i._faultsByVm[r]=[]),i._faultsByVm[r]=i._faultsByVm[r].concat(e.result[0].error))}),e.error&&(i._hasInitErrors=!0)}})},e.prototype.getTopRecommendations=function(){var e=this,t={};return _.each(this._recommendationsByPod,function(i,r){t[r]={},_.each(e._vmIds,function(n){var o=e.findTopRecommendationForVm(n,i);o&&(t[r][n]=o)})}),t},e.prototype.hasInitErrors=function(){return this._hasInitErrors},e.prototype.autoselectRecommendation=function(){this._selectedRecommendations=this.getTopRecommendations()},e.prototype.findTopRecommendationForVm=function(e,t){var i=this,n=_.filter(t,function(t){return i.isRecommendationForVm(e,t)});return r.findTopRecommendation(n)},e.prototype.isRecommendationForVm=function(e,i){if(!i||_.isEmpty(i.action))return!1;var r=_.find(i.action,function(i){return e===t.getVsphereObjectId(i.vm)});return!!r},e}();e.VmStorageRecommendationsService=s,angular.module("com.vmware.vsphere.client.vm").service("VmStorageRecommendationsService",["defaultUriSchemeUtil","mutationService","datastoreRecommendationService","$q",function(e,o,a,c){return t=e,i=o,r=a,n=c,s}])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t,i,r=function(){function e(){this._recommendations=[],this._faults=[],this._selectedRecommendation=void 0,this._hasInitErrors=!1}return e.prototype.load=function(e,t){var r=this,n={_type:"com.vmware.vsphere.client.vm.migration.VmPlacementSpec",vm:t.entity,relocateSpec:t.spec.relocateSpec,priority:t.spec.priority};return n.vm=t.entity,n.relocateSpec=t.spec.relocateSpec,n.priority=t.spec.priority,i.validate(e,n._type,n).then(function(e){r._hasInitErrors=!1,!e.error&&e.result&&(e.result.recommendations||e.result.drsFault)||(r._hasInitErrors=!0),r.init(e.result)})},e.prototype.getSelectedRecommendation=function(){return this._selectedRecommendation},e.prototype.setSelectedRecommendation=function(e){this._selectedRecommendation=e},e.prototype.hasRecommendations=function(){return this._recommendations&&!!this._recommendations.length},e.prototype.getRecommendations=function(){return this._recommendations},e.prototype.hasFaults=function(){return this._faults&&!!this._faults.length},e.prototype.getFaults=function(){return this._faults},e.prototype.getFaultsReason=function(){return this._faultsReason},e.prototype.hasInitErrors=function(){return this._hasInitErrors},e.prototype.init=function(e){this._recommendations=e&&e.recommendations?e.recommendations:[],this._faults=e&&e.drsFault?e.drsFault.faultsByVm:[],this._faultsReason=e&&e.drsFault?e.drsFault.reason:"",this._selectedRecommendation=this.getTopRecommendation(this._recommendations)},e.prototype.getTopRecommendation=function(e){if(e){var t=void 0;return e.forEach(function(e){t?e.rating>t.rating&&(t=e):t=e}),t}},e}();e.VmXdrsRecommendationService=r,angular.module("com.vmware.vsphere.client.vm").service("vmXdrsRecommendationService",["defaultUriSchemeUtil","mutationService",function(e,n){return t=e,i=n,r}])}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r){for(var n=this,o=e.modalOptions.dialogData,a=i.getColumnRenderer("object-name"),s=i.getColumnRenderer("wrapped-text"),c=i.getColumnRenderer("host-name"),l=[],d=0;d<o.notAttempted.length;d++){var u=o.notAttempted[d],p=r.getVsphereObjectId(u.vm),v={id:u.vm.value,parentId:null,vmName:_.escape(o.vmsProps[p].name),vmPrimaryIconId:o.vmsProps[p].primaryIconId,hostName:t.getString("VmUi","PowerOnVmFaultsView.host.notApplicable"),hideHostIcon:!0,description:u.fault.localizedMessage};l.push(v);var m=u.fault.error;if(m)for(var g=0;g<m.length;g++){var h={id:u.vm.value+"_child_"+g,parentId:v.id,vmName:_.escape(o.vmsProps[p].name),vmPrimaryIconId:o.vmsProps[p].primaryIconId,hostName:_.escape(o.vmsProps[p].hostName),hideHostIcon:!1,description:m[g].message};l.push(h)}}var f=new kendo.data.TreeListDataSource({data:l,schema:{model:{id:"id",expanded:!0}}}),S=[{title:t.getString("VmUi","PowerOnVmFaultsList.virtualMachine"),field:"vmName",template:function(e){return a(["","vmPrimaryIconId","vmName"],e)}},{title:t.getString("VmUi","PowerOnVmFaultsList.host"),field:"hostName",template:function(e){return c(["","hostName"],e)}},{title:t.getString("VmUi","PowerOnVmFaultsList.description"),field:"description",template:function(e){return s(["description"],e)}}];n.treeListOptions={dataSource:f,resizable:!0,columns:S,sortable:!0}}angular.module("com.vmware.vsphere.client.vm").controller("VmPowerOnFailuresController",e),e.$inject=["$scope","i18nService","columnRenderersRegistry","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r){function n(){var e=$("#recommendations > div").data("kendoGrid");e&&e.select("tr:first")}var o=this;e.modalOptions.onSubmit=function(){var n=o.dataGridOptions.selectedItems;if(n.length>0){var a=n[0],s=a.targetClusterId,c=l[a.key];return r.applyRecommendation(s,c),e.modalOptions.alerts=[],!0}return e.modalOptions.alerts=[{text:i.getString("VmUi","VmPowerOnRecommendationsController.errorSelectOneRecommendation"),type:t.notifications.type.ERROR}],!1};var a=i.getString("VmUi","RecommendationsList.recommendationColumnHeaderText"),s=i.getString("VmUi","RecommendationsList.priorityColumnHeaderText"),c=e.modalOptions.dialogData.rawRecommendations,l=_.indexBy(c,"key");o.dataGridOptions={dataBound:n,columnDefs:[{displayName:a,template:kendo.template('#:reasonText#<ul>   # for (var i = 0; i < actions.length; i++) { #     <li ng-non-bindable><span class="#:actions[i].icon#"></span>#:actions[i].text#</li>   # } # </ul>'),field:"reasonText",width:"80%"},{displayName:s,field:"priority",template:'<div style="text-align: center;">#:priority#</div>'}],sortMode:t.grid.sortMode.SINGLE,selectionMode:t.grid.selectionMode.SINGLE,selectedItems:[],data:e.modalOptions.dialogData.recommendations,resizable:!0,searchable:!1,height:350}}angular.module("com.vmware.vsphere.client.vm").controller("VmPowerOnRecommendationsController",e),e.$inject=["$scope","vuiConstants","i18nService","vmRecommendationsService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(){g.loading=!0,t.modalOptions.submitDisabled=!0;var e=[v,m];g.vmQuestionIssue||e.push(p),o.getProperties(g.vmId,e).then(function(e){if(e[p]){var i=e[p];g.vmQuestionIssue={details:i},g.selectedChoice=g.vmQuestionIssue?g.vmQuestionIssue.details.choice.defaultIndex.toString():"0"}if(g.otherVmsCount=e[v],g.otherVmsCount>0){var r=e[m];g.answerOtherMachinesLabel=a.getString("VmUi","VmQuestionAnswerView.answerOtherMachines",g.otherVmsCount,r),g.selectOtherVmsLinkText=l()}else g.answerOtherMachinesLabel=a.getString("VmUi","VmQuestionAnswerView.noOtherMachines");g.loading=!1,t.modalOptions.submitDisabled=!1,u()})}function l(){return g.showOtherVmsSelector?a.getString("VmUi","VmQuestionAnswerView.cancelVmsSelection"):a.getString("VmUi","VmQuestionAnswerView.selectVms")}function d(e){if(g.otherVmsRef=null,e){g.otherVmsRef=[];for(var t=0;t<e.length;t++)g.otherVmsRef.push(e[t].id)}}function u(){r(function(){var e=i[0].querySelector('input[type="radio"]');e&&e.focus()},0)}var p="VirtualMachine/localizedQuestion",v="otherVmsCountWithSameQuestion",m="vCenterName",g=this;g.vmId=t.modalOptions.dialogData.vmId,g.vmQuestionIssue=t.modalOptions.dialogData.vmQuestionIssue,g.selectedChoice=g.vmQuestionIssue?g.vmQuestionIssue.details.choice.defaultIndex.toString():null,g.showOtherVmsSelector=!1,g.otherVmsRef=[],t.modalOptions.onSubmit=function(){if(g.loading)return!1;var t,i=_.map(g.otherVmsRef,function(e){return s.getManagedObjectReference(e)});g.vmQuestionIssue.details.message&&g.vmQuestionIssue.details.message.length>0&&(t=g.vmQuestionIssue.details.message[0].id);var r={questionId:g.vmQuestionIssue.details.id,firstMessageId:t,answerChoice:g.selectedChoice,otherVmRefs:i};return n.apply(g.vmId,"com.vmware.vsphere.client.h5.vm.MultipleVmQuestionAnswerSpec",r).then(function(){e.$broadcast("IssueChangeEvent")}),!0},c(),g.toggleSelectVmsView=function(){g.showOtherVmsSelector=!g.showOtherVmsSelector,g.selectOtherVmsLinkText=l(),g.showOtherVmsSelector?r(function(){var e=i.find('[list-view-id="vsphere.core.vm.list"] [kendo-grid]');if(e){var t=e.data("kendoGrid");t&&t.resize()}},0):r(function(){var e=i.find('[list-view-id="vsphere.core.vm.list"] [kendo-grid]');e.data("kendoGrid").clearSelection()},0)};var h={label:a.getString("Common","typeResource.vmPlural"),listViewId:"vsphere.core.vm.list",dataModels:["VirtualMachine"],filterId:"otherVmsWithSameQuesitonFilter",preselectComparator:function(e){return!1}};g.objSelectorConfig={contextObject:g.vmId,multipleSelect:!0,listTabConfig:{selectedTabIndex:0,listConfig:[h]},onSelectionChanged:d}}angular.module("com.vmware.vsphere.client.vm").controller("VmQuestionAnswerDialogController",e),e.$inject=["$rootScope","$scope","$element","$timeout","mutationService","dataService","i18nService","defaultUriSchemeUtil"]}(),angular.module("com.vmware.vsphere.client.vm").service("controllerNodeFinderService",["vmDeviceInfoService",function(e){function t(e,t,i){if(i=_.filter(i,function(t){return t.controllerKey===e}),i.length<1)return t[0];if(i.length>=t.length)return null;var r=_.sortBy(i,"unitNumber");return _.find(t,function(e,t){var i=r[t];if(void 0===i||e.key!==i.unitNumber)return e})}return{findNextAvailableNodeForController:t}}]),angular.module("com.vmware.vsphere.client.vm").service("datastoreNameFetcher",["dataService","defaultUriSchemeUtil",function(e,t){return{fetchNames:function(i){return e.getProperties(i,["host"]).then(function(i){var r=t.getVsphereObjectId(i.host);return e.getProperties(r,["dc"])}).then(function(i){var r=t.getVsphereObjectId(i.dc);return e.getProperties(r,["datastore"])}).then(function(e){return e.datastore})}}}]);var h5_vm;!function(e){var t=function(){function e(){this.virtualDeviceClassMap=this.getVirtualDeviceClassMap(),this.deviceTypeLookUp={},this.collectTypes(this.virtualDeviceClassMap,null),this.loggedMissingDeviceTypeWarnings=[]}return e.prototype.isClassNameSubclassOf=function(e,t){e=this.getSimpleClassName(e),t=this.getSimpleClassName(t);var i=this.deviceTypeLookUp[e];if(!i)return this.loggedMissingDeviceTypeWarnings[e]||(console.warn("Unable to find device class for "+e),this.loggedMissingDeviceTypeWarnings[e]=!0),!1;for(;;){if(i.type===t)return!0;if(!i.parent)return!1;i=i.parent}},e.prototype.getVirtualControllerType=function(e){for(var t=this.getSimpleClassName(e),i=this.deviceTypeLookUp[t];i;){if(i.parent&&"VirtualController"===i.parent.type)return i.type;i=i.parent}return null},e.prototype.getSimpleClassName=function(e){var t=e.lastIndexOf(".");return t>=0?e.substr(t+1):e},e.prototype.collectTypes=function(e,t){var i=this;e.forEach(function(e){e.parent=t,i.deviceTypeLookUp[e.type]=e,e.children&&i.collectTypes(e.children,e)})},e.prototype.getVirtualDeviceClassMap=function(){return[{type:"VirtualDevice",children:[{type:"VirtualCdrom"},{type:"VirtualNVDIMM"},{type:"VirtualController",children:[{type:"VirtualIDEController"},{type:"VirtualNVMEController"},{type:"VirtualNVDIMMController"},{type:"VirtualPCIController"},{type:"VirtualPS2Controller"},{type:"VirtualSATAController",children:[{type:"VirtualAHCIController"}]},{type:"VirtualSCSIController",children:[{type:"ParaVirtualSCSIController"},{type:"VirtualBusLogicController"},{type:"VirtualLsiLogicController"},{type:"VirtualLsiLogicSASController"}]},{type:"VirtualSIOController"},{type:"VirtualUSBController"},{type:"VirtualUSBXHCIController"}]},{type:"VirtualDisk"},{type:"VirtualEthernetCard",children:[{type:"VirtualE1000"},{type:"VirtualE1000e"},{type:"VirtualPCNet32"},{type:"VirtualSriovEthernetCard"},{type:"VirtualVmxnet",children:[{type:"VirtualVmxnet2"},{type:"VirtualVmxnet3",children:[{type:"VirtualVmxnet3Vrdma"}]}]}]},{type:"InputDevice",children:[{type:"VirtualKeyboard"},{type:"VirtualPointingDevice"}]},{type:"VirtualFloppy"},{type:"VirtualVideoCard"},{type:"VirtualVMCIDevice"},{type:"VirtualVMIROM"},{type:"VirtualParallelPort"},{type:"VirtualPCIPassthrough"},{type:"VirtualSCSIPassthrough"},{type:"VirtualSerialPort"},{type:"VirtualSoundCard",children:[{type:"VirtualEnsoniq1371"},{type:"VirtualHdAudioCard"},{type:"VirtualSoundBlaster16"}]},{type:"VirtualUSB"},{type:"VirtualTPM"}]}]},e.$inject=[],e}();e.DeviceClassLineageService=t,angular.module("com.vmware.vsphere.client.vm").service("deviceClassLineageService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.recommendedController=_.isUndefined(e)?null:e,this.recommendedBusNo=_.isUndefined(t)?-1:t,this.recommendedUnitNo=_.isUndefined(i)?0:i}return e}();e.DiskControllerAdvice=t;var i=function(){function e(e,t){this.nodeCountService=e,this.deviceClassLineageService=t,this.INVALID=-1,this.MAX_SCSILIMIT=4,this.MAX_SATALIMIT=4,this.MAX_IDELIMIT=2,this.VIRTUAL_IDE_CONTROLLER="VirtualIDEController",this.VIRTUAL_SATA_CONTROLLER="VirtualSATAController",this.VIRTUAL_SCSI_CONTROLLER="VirtualSCSIController"}return e.prototype.getNextAvailableNodeIndexForController=function(e,t,i,r){var n=e.getCurrentDevice(),o=this.nodeCountService.getMaxNodeCountForControllerType(n._type,t,r),a=[];n.scsiCtlrUnitNumber&&a.push(n.scsiCtlrUnitNumber);var s=[];s=s.concat(a);var c=_.filter(i,function(t){var i=t.getCurrentDevice();return i.controllerKey===e.getKey()});if(c.length>=o)return this.INVALID;_.map(c,function(e){s.push(e.getCurrentDevice().unitNumber)});for(var l=0;l<=o;l++)if(!_.contains(s,l))return l;return this.INVALID},e.prototype.getAdviceOnReusableController=function(e,i,r,n){var o=this,a=[],s=0,c=null,l=this.deviceClassLineageService.getVirtualControllerType(e.typeClass),d=this.getControllerLimit(l),u=_.filter(r,function(e){return!!l&&e.isOfType(l)});if(_.isEmpty(u))return new t(null,0,0);_.every(u,function(e){return s=o.getNextAvailableNodeIndexForController(e,i,r,n),a.push(e.getCurrentDevice().busNumber),c=s!==o.INVALID?e:null,null===c});var p=new t(c,this.INVALID,s);if(p.recommendedController||a.length>=d)return p;for(var v=0;v<d;v++)if(!_.contains(a,v)){p.recommendedBusNo=v,p.recommendedUnitNo=0;break}return p},e.prototype.getControllerLimit=function(e){switch(e){case this.VIRTUAL_SCSI_CONTROLLER:return this.MAX_SCSILIMIT;case this.VIRTUAL_SATA_CONTROLLER:return this.MAX_SATALIMIT;case this.VIRTUAL_IDE_CONTROLLER:return this.MAX_IDELIMIT;default:return 0}},e.$inject=["nodeCountService","deviceClassLineageService"],e}();e.DiskControllerIndexAdviserService=i,angular.module("com.vmware.vsphere.client.vm").service("diskControllerIndexAdviserService",i)}(h5_vm||(h5_vm={}));var vm_ui;!function(e){var t=function(){function e(e,t,i,r){this.clarityModalService=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.datastoreBrowserConstants=r}return e.prototype.openExistingDiskSelectorDialog=function(e,t){var i=this,r=this.defaultUriSchemeUtil.getVsphereObjectId(e.datastoreBrowser),n=e.configTarget.datastore,o=_.map(n,function(e){return i.defaultUriSchemeUtil.getVsphereObjectId(e.datastore.datastore)}),a=this.datastoreBrowserConstants.fileQueryType.VM_DISK_TYPE_WITH_DETAILS,s=[{label:this.i18nService.getString("Common","dsBrowser.vmDiskFile"),value:this.datastoreBrowserConstants.fileQueryType.VM_DISK_TYPE_WITH_DETAILS}],c={datastoreBrowserId:r,datastoreIds:o,initialFileQueryType:a,filterFileQueryTypes:s,showVmImagesFolder:!0,selectedFileChanged:function(e){i.selectedFile=e,i.modalOptions.submitDisabled=!i.selectedFile}};this.okHandler=t,this.modalOptions={title:this.i18nService.getString("Common","dsBrowser.defaultTitle"),contentTemplate:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareExistingDisk/select-existing-hard-disk.view.html",defaultButton:"submit",dialogData:c,size:"lg",modalClass:"",hideSubmitButton:!1,submitDisabled:!0,selectedItems:[],alerts:[],onSubmit:function(){return null!==i.selectedFile&&(i.okHandler&&"function"==typeof i.okHandler&&i.okHandler(i.selectedFile),!0)}},this.clarityModalService.openOkCancelModal(this.modalOptions)},e.$inject=["clarityModalService","i18nService","defaultUriSchemeUtil","datastoreBrowserConstants"],e}();e.ExistingHardDiskSelectorDialogService=t,angular.module("com.vmware.vsphere.client.vm").service("existingHardDiskSelectorDialogService",t)}(vm_ui||(vm_ui={})),function(){"use strict";function e(){function e(e,t){var i=e.environment.configOption.guestOSDescriptor;return _.find(i,function(e){return e.id===t.id})}function t(e){var t=e.environment.configOption.guestOSDescriptor;if(t.length>1)throw new Error("Expected only one guestOSDescriptor but found "+t.length);return t[0]}function i(i,r){var n;return n=i.environment.configOption.guestOSDescriptor.length>1?e(i,r):t(i)}return{getGuestOsDescriptor:e,getSelectedGuestOs:t,getAppropriateGuestOs:i}}angular.module("com.vmware.vsphere.client.vm").service("guestOsService",e)}();var h5_vm;!function(e){var t=function(){function t(e,t,i,r,n,o){this.$q=e,this.defaultUriSchemeUtil=t,this.mutationService=i,this.diskProvisioningService=r,this.storageProfileService=n,this.vmDeviceInfoService=o,this.BASIC_MODE="basicMode",this.ADVANCED_MODE="advancedMode"}return t.prototype.computeInitialVmStorageConfig=function(t,i,r){var n=this,o=new e.VmStorageConfig;o.vmId=t,o.vmHome={key:-1,storageObj:i.datastore&&{storageRef:i.datastore},storageProfile:this.computeStorageProfile(i.profile),replicationGroup:this.computeReplicationGroup(i.profile,r)},o.vmDisks=[];var a=o.vmDisks;return _.each(i.disk,function(e){a.push({key:e.diskId,storageObj:e.datastore&&{storageRef:e.datastore},diskFormat:e.diskBackingInfo&&n.diskProvisioningService.getFormat(e.diskBackingInfo),storageProfile:n.computeStorageProfile(e.profile),replicationGroup:n.computeReplicationGroup(e.profile,r)})}),this.buildVmDisks(i.deviceChange,o.vmDisks,{}),o},t.prototype.computeInitialVmStorageConfigForCreateVm=function(t,i,r,n,o){var a=new e.VmStorageConfig;return a.vmId="",a.vmHome={key:-1,storageObj:{storageRef:t},storageProfile:this.computeStorageProfile(n),replicationGroup:this.computeReplicationGroup(n,o)},a.vmDisks=[],this.buildVmDisks(i,a.vmDisks,r),a},t.prototype.computeSourceVmStorageConfig=function(e,t,i,r){var n=angular.copy(e);r&&(i.sourceVmStorageConfig=[n]),_.isEmpty(n.vmDisks)||_.each(n.vmDisks,function(e){var r=_.find(i.sourceVmStorageConfig[0].vmDisks,function(t){return t.key===e.key});if(r){var n=_.find(t,function(t){return t.id===(e.storageProfile&&e.storageProfile.id)});n&&(r.storageProfile=n)}})},t.prototype.buildVmDisks=function(e,t,i){var r=this;_.each(e,function(e){if(r.vmDeviceInfoService.isDeviceSubclassOf(e.device,"VirtualDisk")){var n=e.device&&e.device.backing&&e.device.backing.fileName,o=void 0;if(n){var a=n.match(/\[(.*)\]/);n=a?a[1]:"",o=i[n]}t.push({key:e.device.key,storageObj:o&&{storageRef:o},diskFormat:e.device&&e.device.backing&&r.diskProvisioningService.getFormat(e.device.backing),storageProfile:r.computeStorageProfile(e.profile),replicationGroup:r.computeReplicationGroup(e.profile)})}})},t.prototype.computeStorageProfile=function(e){if(e&&e[0]){var t=this.storageProfileService.getProfileIdFromSpec(e[0]);if(t)return{id:t}}},t.prototype.computeReplicationGroup=function(e,t){if(e&&e[0]&&e[0].replicationSpec){var i=e[0].replicationSpec.replicationGroupId;if(i){var r,n=null===i?"":i.faultDomainId.id+":"+i.deviceGroupId.id;return n&&t&&t[n]&&(r=t[n]),{id:i,groupInfo:r}}}},t.prototype.computeStoragePageViewMode=function(e){var t=this;if(e.datastore&&!e.disk)return this.BASIC_MODE;var i=e.datastore,r=_.find(e.disk,function(e){return!t.defaultUriSchemeUtil.compareNullableIds(e.datastore,i);
});if(r)return this.ADVANCED_MODE;var n=e.disk&&e.disk[0];if(r=n&&_.find(e.disk,function(e){return!t.diskProvisioningService.areDiskFormatsEqual(e.diskBackingInfo,n.diskBackingInfo)}))return this.ADVANCED_MODE;var o=e.profile&&e.profile[0];return r=_.find(e.disk,function(e){return!t.storageProfileService.areProfileSpecsEqual(e.profile&&e.profile[0],o,!0)}),r?this.ADVANCED_MODE:this.BASIC_MODE},t.prototype.initSelectedStorageItems=function(e,t,i){var r=this;if(!i.initialViewMode||!i.initialVmStorageConfig)return!1;e.mode=i.initialViewMode;var n=i.initialVmStorageConfig.vmId;if(e.mode===this.BASIC_MODE){t.initialConfig||(t.initialConfig={});var o=i.initialVmStorageConfig.vmHome.storageObj,a=this.defaultUriSchemeUtil.getVsphereObjectId(o&&o.storageRef),s=this.findStorageItem(t.storageLocatorItemsData.datastoreItems,a);t.initialConfig.selectedItemInBasicMode=s;var c=i.initialVmStorageConfig.vmDisks[0],l=c&&c.diskFormat;t.initialConfig.selectedDiskFormatInBasicMode=l;var d=i.initialVmStorageConfig.vmHome.storageProfile,u=d&&d.id,p=this.findStorageProfileItem(t.storageProfilesData.storageProfiles,u);t.initialConfig.selectedStorageProfileInBasicMode=p;var v=i.initialVmStorageConfig.vmHome.replicationGroup;t.initialConfig.selectedReplicationGroupInBasicMode=v}else if(!e.vmStorageConfigInAdvancedMode){e.vmStorageConfigInAdvancedMode=angular.copy(t.sourceVmStorageConfig);var m=_.find(e.vmStorageConfigInAdvancedMode,function(e){return e.vmId===n});if(m){var o=i.initialVmStorageConfig.vmHome.storageObj,a=this.defaultUriSchemeUtil.getVsphereObjectId(o&&o.storageRef);m.vmHome.storageObj=this.findStorageItem(t.storageLocatorItemsData.datastoreItems,a),m.vmHome.replicationGroup=i.initialVmStorageConfig.vmHome.replicationGroup;var d=i.initialVmStorageConfig.vmHome.storageProfile,u=d&&d.id,p=this.findStorageProfileItem(t.storageProfilesData.storageProfiles,u);m.vmHome.storageProfile=p,_.each(m.vmDisks,function(e){var n=_.find(i.initialVmStorageConfig.vmDisks,function(t){return t.key===e.key});if(n){var o=n.storageObj,a=r.defaultUriSchemeUtil.getVsphereObjectId(o&&o.storageRef);e.storageObj=r.findStorageItem(t.storageLocatorItemsData.datastoreItems,a),e.diskFormat=n.diskFormat;var s=n.storageProfile,c=s&&s.id,l=r.findStorageProfileItem(t.storageProfilesData.storageProfiles,c);e.storageProfile=l,e.replicationGroup=n.replicationGroup}})}}return!0},t.prototype.findStorageItem=function(e,t){var i=this;return _.find(e,function(e){return i.defaultUriSchemeUtil.getVsphereObjectId(e.storageRef)===t})},t.prototype.findStorageProfileItem=function(e,t){return _.find(e,function(e){return e.id===t})},t.$inject=["$q","defaultUriSchemeUtil","mutationService","diskProvisioningService","storageProfileService","vmDeviceInfoService"],t}();e.InitialStorageConfigurationService=t,angular.module("com.vmware.vsphere.client.vm").service("initialStorageConfigurationService",t)}(h5_vm||(h5_vm={})),function(){function e(e){function t(t,i,r){var n={VirtualDisk:"Disks",VirtualCdrom:"Cdroms"},o=_.find(i,function(i){return e.isClassNameSubclassOf(t,i.type.typeClass)}),a=new RegExp("^num\\w+"+n[r]+"$"),s=_.find(_.keys(o),function(e){return e.match(a)});if(!s)throw new Error("Could not find max node count for "+r);return o[s].max}return{getMaxNodeCountForControllerType:t}}angular.module("com.vmware.vsphere.client.vm").service("nodeCountService",e),e.$inject=["deviceClassLineageService"]}(),angular.module("com.vmware.vsphere.client.vm").factory("openConsoleService",["$rootScope","$q","dataService","userSessionExService","browserLanguage",function(e,t,i,r,n){function o(e,o,a){function s(e){v=e.name}function c(e){function t(e){var t=document.createElement("a");return t.href=e,t.host}d=t(e.serverInfo.serviceUrl),u=e.sessionTicket,p=e.serverInfo.thumbprint,m=n.get()}function l(e,t,i,r,n,o){window.open("webconsole.html?vmId="+e+"&vmName="+encodeURIComponent(t)+"&serverGuid="+i+"&host="+r+"&sessionTicket="+n+"&thumbprint="+o+"&locale="+m)}var d,u,p,v,m,g=i.getProperties(e,["name"]).then(s),h=r.acquireCloneTicket(a).then(c);t.all([g,h]).then(function(){l(o,v,a,d,u,p)})}return{openConsole:o}}]);var h5_vm;!function(e){var t=function(){function e(){}return e}(),i=function(){function e(){}return e.prototype.convertOvfTemplateHardwareData=function(e){var i=new t;return i.hardware={numCPU:e.cpu.numCpus,memoryMB:e.memory.size,device:this.convertDevices(e)},i.cpuAllocation={reservation:e.cpu.reservation?e.cpu.reservation:0,limit:e.cpu.limit?e.cpu.limit:-1,shares:e.cpu.shares?e.cpu.shares:"-"},i.memoryData={memoryAllocation:{reservation:e.memory.reservation?e.memory.reservation:0,limit:e.memory.limit?e.memory.limit:-1,shares:e.memory.shares?e.memory.shares:"-"},memoryUtilization:0,isVmTemplate:!0},i},e.prototype.convertDevices=function(e){var t=[],i=this;if(e.diskData){var r=2e3;e.diskData.forEach(function(e){t.push({_type:"com.vmware.vim.binding.vim.vm.device.VirtualDisk",key:r++,deviceInfo:{label:e.name},backing:{},capacityInKB:1014*e.diskCapacity})})}if(e.nicData){var n=4e3;e.nicData.forEach(function(e){t.push({_type:"com.vmware.vim.binding.vim.vm.device.VirtualE1000",key:n++,deviceInfo:{label:e.name,summary:e.networkName},backing:{},macAddress:e.macAddress,startConnected:e.startConnected})})}if(e.driveData){var o=16e3;e.driveData.forEach(function(e){t.push({_type:"com.vmware.vim.binding.vim.vm.device.VirtualCdrom",key:o++,deviceInfo:{label:e.name,type:e.type,subType:e.subType},backing:{}})})}if(e.floppyData){var a=17e3;e.floppyData.forEach(function(e){t.push({_type:"com.vmware.vim.binding.vim.vm.device.VirtualFloppy",key:a++,deviceInfo:{label:e.name,type:e.type},backing:{}})})}if(e.videoCardData){var s=500;e.videoCardData.forEach(function(e){t.push({_type:"com.vmware.vim.binding.vim.vm.device.VirtualVideoCard",key:s++,deviceInfo:{label:e.name,type:e.type},videoRamSizeInKB:e.videoRamSize,numDisplays:e.numDisplays?e.numDisplays:"-",enable3DSupport:e.enable3d,use3dRenderer:"-"})})}if(e.diskControllerData){var c=200;e.diskControllerData.forEach(function(e){t.push({_type:i.getDeviceControllerType(e),key:c++,deviceInfo:{label:e.name},backing:{}})})}return t},e.prototype.getDeviceControllerType=function(e){switch(e.type){case"SCSI":return"com.vmware.vim.binding.vim.vm.device.VirtualSCSIController";case"IDE":return"com.vmware.vim.binding.vim.vm.device.VirtualIDEController";default:return"com.vmware.vim.binding.vim.vm.device.VirtualController"}},e}();e.OvfTemplateHardwareDataMapping=i,angular.module("com.vmware.vsphere.client.vm").service("ovfTemplateHardwareDataMapping",i)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("remoteConsoleService",["$rootScope","$q","dataService","userSessionExService","defaultUriSchemeUtil",function(e,t,i,r,n){function o(e){function i(e){function t(e){var t=document.createElement("a");return t.href=e,t.host}return s=t(e.serverInfo.serviceUrl),a=e.sessionTicket,{host:s,sessionTicket:a}}function o(e,t,i){var r="vmrc://clone:"+e+"@"+t+"/?moid="+i;return r}var a,s,c=t.defer(),l=n.getManagedObjectReference(e);return r.acquireCloneTicket(l.serverGuid).then(i).then(function(e){c.resolve(o(e.sessionTicket,e.host,l.value))}),c.promise}return{getRemoteConsoleUrl:o}}]),function(){"use strict";function e(e,t,i,r){return{display:function(n){var o,a="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDisk/select-iso-file.view.html",s={title:t.getString("Common","dsBrowser.defaultTitle"),contentTemplate:a,defaultButton:"submit",size:"lg",hideSubmitButton:!1,submitDisabled:!0,onSubmit:function(){return n.device.backing.fileName=o.path,n.$broadcast("isoDeviceBackingChange",n.device.backing),!0}},c=i.getVsphereObjectId(n.vmConfigContext.environment.datastoreBrowser),l=n.vmConfigContext.environment.configTarget.datastore,d=_.map(l,function(e){return i.getVsphereObjectId(e.datastore.datastore)}),u=r.fileQueryType.ISO_IMAGE+r.fileQueryType.FOLDERS+r.fileQueryType.FLOPPY_IMAGE,p=[{label:t.getString("Common","dsBrowser.isoImageFile"),value:r.fileQueryType.ISO_IMAGE+r.fileQueryType.FOLDERS},{label:t.getString("Common","dsBrowser.allFiles"),value:r.fileQueryType.ALL_FILES}];s.dsFileBrowserData={datastoreBrowserId:c,datastoreIds:d,initialFileQueryType:u,filterFileQueryTypes:p,showVmImagesFolder:!0,selectedFileChanged:function(e){o=e,s.submitDisabled=!o}},e.openOkCancelModal(s)}}}angular.module("com.vmware.vsphere.client.vm").service("selectIsoFileService",e),e.$inject=["clarityModalService","i18nService","defaultUriSchemeUtil","datastoreBrowserConstants"]}();var h5_vm;!function(e){var t=e.DeviceTypeConstants,i=function(){function i(e,t,i){this.vmHardwareUtil=e,this.i18nService=t,this.featureFlagsService=i,this.i18n=t.getString}return i.prototype.getAddDeviceActions=function(t,i,r){void 0===i&&(i=e.VmWorkflowMode.UpdateMode),void 0===r&&(r=[]);var n=this.hasPrivilegesToAddDevice(t,[e.Privileges.VM_ADDREMOVEDEVICE_PRIVILEGE]);i===e.VmWorkflowMode.CreateMode&&(n=!0);var o=this.getAllAddDeviceActions(t,n);return r.map(function(e){o.hasOwnProperty(e)&&delete o[e]}),o},i.prototype.getAllAddDeviceActions=function(i,r){return{addNewCdDvdDriveAction:{id:"addNewCdDvdDriveAction",label:this.i18n("VmUi","VmDeviceManager.Cdrom"),deviceType:"VirtualCdrom",hasPrivilege:r},addNewUSBDeviceAction:{id:"addNewUSBDeviceAction",label:this.i18n("VmUi","VmDeviceManager.USBDevice"),deviceType:"VirtualUSB",hasPrivilege:this.hasPrivilegesToAddDevice(i,[e.Privileges.VM_HOST_USB_DEVICE])},addNewHardDiskAction:{id:"addNewHardDiskAction",label:this.i18n("VmUi","VmDeviceManager.HardDisk"),deviceType:"VirtualDisk",hasPrivilege:this.hasPrivilegesToAddDevice(i,[e.Privileges.VM_ADDNEWDISK_PRIVILEGE])},addNewRDMDiskAction:{id:"addNewRDMDiskAction",label:this.i18n("VmUi","VmDeviceManager.RDMDisk"),deviceType:"RDMDisk",hasPrivilege:this.hasPrivilegesToAddDevice(i,[e.Privileges.VM_RAWDEVICE_PRIVILEGE])},addExistingDiskAction:{id:"addExistingDiskAction",label:this.i18n("VmUi","VmDeviceManager.ExistingHardDisk"),deviceType:"ExistingHardDisk",hasPrivilege:this.hasPrivilegesToAddDevice(i,[e.Privileges.VM_ADDEXISTINGDISK_PRIVILEGE])},addNewNetworkAdapterAction:{id:"addNewNetworkAdapterAction",label:this.i18n("VmUi","VmDeviceManager.NetworkAdapter"),deviceType:"VirtualEthernetCard",hasPrivilege:r},addNewSCSIControllerAction:{id:"addNewSCSIControllerAction",label:this.i18n("VmUi","VmDeviceManager.SCSIController"),deviceType:"VirtualSCSIController",hasPrivilege:r},addNewUSBControllerAction:{id:"addNewUSBControllerAction",label:this.i18n("VmUi","VmDeviceManager.USBController"),deviceType:"VirtualUSBController",hasPrivilege:r},addNewSATAControllerAction:{id:"addNewSATAControllerAction",label:this.i18n("VmUi","VmDeviceManager.SATAController"),deviceType:t.VIRTUAL_SATA_CONTROLLER,hasPrivilege:r},addNewNvdimmAction:{id:"addNewNvdimmAction",label:this.i18n("VmUi","VmDeviceManager.NvDimm"),deviceType:"VirtualNVDIMM",hasPrivilege:this.hasPrivilegesToAddDevice(i,[e.Privileges.VM_ADDREMOVEDEVICE_PRIVILEGE]),featureFlag:this.isNvmFeatureFlagEnabled()},addNewNVMeControllerAction:{id:"addNewNVMeControllerAction",label:this.i18n("VmUi","VmDeviceManager.NVME"),deviceType:"VirtualNVMEController",hasPrivilege:r},addPciSharedAction:{id:"addPciSharedAction",label:this.i18n("VmUi","VmDeviceManager.SharedPCI"),deviceType:"VirtualPCIPassthroughShared",hasPrivilege:r},addPciDeviceAction:{id:"addPciDeviceAction",label:this.i18n("VmUi","VmDeviceManager.PCIDevice"),deviceType:"VirtualPCIPassthrough",hasPrivilege:r},addNewTpmAction:{id:"addNewTpmAction",label:this.i18n("VmUi","VmDeviceManager.NewTPM"),deviceType:"VirtualTPM",hasPrivilege:!0,featureFlag:this.isVTpmFeatureFlagEnabled()},addSerialPortAction:{id:"addSerialPortAction",label:this.i18n("VmUi","VmDeviceManager.SerialPort"),deviceType:t.VIRTUAL_SERIAL_PORT,hasPrivilege:r}}},i.prototype.isVTpmFeatureFlagEnabled=function(){return"function"==typeof this.featureFlagsService.HWv14Enabled&&this.featureFlagsService.HWv14Enabled()},i.prototype.isNvmFeatureFlagEnabled=function(){return"function"==typeof this.featureFlagsService.PMemEnabled&&this.featureFlagsService.PMemEnabled()},i.prototype.hasPrivilegesToAddDevice=function(e,t){return this.vmHardwareUtil.checkPrivileges(e,t)},i.prototype.isAddDeviceMenuEnabled=function(e){return _.some(e,function(e){return e.enabled===!0})},i.prototype.getAddDevicesMenuConfig=function(e){return{showMenu:!1,menuItems:[],itemClick:e}},i.prototype.getAddDeviceMenuItems=function(e){var t=this,i=[],r=_.values(e);return r.forEach(function(e){if("undefined"==typeof e.featureFlag||e.featureFlag){var r=t.getAddDeviceItem(e);i.push(r)}}),i},i.prototype.getAddDeviceItem=function(e){return{id:e.id,label:e.label,itemClick:e.clickHandler,enabled:e.hasPrivilege,featureFlag:e.featureFlag}},i.$inject=["vmHardwareUtil","i18nService","featureFlagsService"],i}();e.VmHardwareDeviceMenuService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareDeviceMenuService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.prototype.getVmHomeProfile=function(){return this.vmHome&&this.vmHome.storageProfile},e.prototype.getVmHomeStorage=function(){return this.vmHome&&this.vmHome.storageObj},e.prototype.getReplicationGroupAssignments=function(){var e=[];return this.vmHome&&this.vmHome.replicationGroup&&e.push(this.vmHome.replicationGroup),_.forEach(this.vmDisks,function(t){t&&t.replicationGroup&&e.push(t.replicationGroup)}),e},e}();e.VmStorageConfig=t}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("vmDeviceInfoService",["i18nService","deviceClassLineageService","defaultUriSchemeUtil","managedEntityConstants",function(e,t,i,r){function n(e,i){if(!e._type)return!1;var r=w(e);return t.isClassNameSubclassOf(r,i)}function o(e,t){return!!e._type&&w(e)===C(t)}function a(e){return{name:e._type,typeClass:e._type,wsdlName:C(e._type)}}function s(t){var i,r=e.getString;switch(C(t)){case"VirtualE1000":i=r("VmUi","NetworkConfig.E1000");break;case"VirtualPCNet32":i=r("VmUi","NetworkConfig.PCNet32");break;case"VirtualVmxnet3":i=r("VmUi","NetworkConfig.VirtualVmxnet3");break;case"VirtualVmxnet3Vrdma":i=r("VmUi","NetworkConfig.VirtualVmxnet3Vrdma");break;case"VirtualVmxnet2":i=r("VmUi","NetworkConfig.VirtualVmxnet2");break;case"VirtualVmxnet":i=r("VmUi","NetworkConfig.VirtualVmxnet");break;case"VirtualE1000e":i=r("VmUi","NetworkConfig.E1000e");break;case"VirtualSriovEthernetCard":i=r("VmUi","NetworkConfig.Sriov");break;default:i=r("VmUi","NetworkConfig.Unknown")}return i}function c(t){return e.getString("VmUi","SCSIControllerConfig."+w(t))}function l(t,n,o,a){if(!n)return o&&t.name?t.name:e.getString("VmUi","ProvisioningWizardSummaryPage.GettingData");var s,c;if(t.storageRef.type===r.STORAGE_POD)return c=e.getString("VmUi","ProvisioningWizardSummaryPage.Recommended"),s=t.name,e.getString("VmUi","ProvisioningWizardSummaryPage.PodAndDsRecommended",s,n,c,"");if(!o){var l=i.getVsphereObjectId(t.parentStoragePod);return s=a[l],e.getString("VmUi","ProvisioningWizardSummaryPage.PodAndDsRecommended",s,n,"","")}return n}function d(e,t,i){var r=t.getCurrentDevice(),o=_.find(i,function(e){var t=e.getCurrentDevice();return t.key===r.controllerKey});if(!o)throw new Error("Could not find controller with device id "+r.controllerKey);var a=e.environment.configOption.hardwareOptions;return _.find(a.virtualDeviceOption,function(e){return e.type.name===r._type&&e.controllerType&&n(o.getCurrentDevice(),e.controllerType.name)})}function u(e,t,i){var r=d(e,t,i);return _.find(r.backingOption,function(e){return e.type.name===t.getCurrentDevice().backing._type})}function p(e,t){var i;if(e.isOfType("VirtualCdrom"))i=["VirtualIDEController","VirtualSATAController"];else{if(!e.isOfType("VirtualDisk"))throw new Error("Don't know what controllers are allowed for the device with type "+e.getCurrentDevice()._type);i=["VirtualIDEController","VirtualSATAController","VirtualSCSIController","VirtualNVMEController"]}return _.filter(t,function(e){return D(e,i)})}function v(e,t){var i=/num\w+Cdrom/;return g(e,t,i)}function m(e,t){var i=/num\w+Disk/;return g(e,t,i)}function g(e,t,i){for(var r=_.find(t,function(t){return t.type.typeClass===e._type}),n=_.find(_.keys(r),function(e){return e.match(i)}),o=r[n].max,a=[],s=0;s<o;s++)a.push({controllerTypePrefix:f(e),controllerBusNumber:e.busNumber,deviceUnitNumber:s});return a}function h(i,r,n){var o=C(i),a="Ide";return t.isClassNameSubclassOf(o,"VirtualSCSIController")?a="Scsi":t.isClassNameSubclassOf(o,"VirtualSATAController")?a="Sata":t.isClassNameSubclassOf(o,"VirtualNVMEController")&&(a="Nvme"),e.getString("VmUi","ProvisioningWizardSummaryPage.VdNode"+a,r,n)}function f(e){if(n(e,"VirtualIDEController"))return"IDE";if(n(e,"VirtualSCSIController"))return"SCSI";if(n(e,"VirtualNVMEController"))return"NVME";if(n(e,"VirtualSATAController"))return"SATA";throw new Error("Don't know how to render controller type prefix for a ",e._type)}function S(t){var i=b(t);return _.each(i,function(t){var i="",r="";t&&(t.portgroupName?(i=t.portgroupName,t.switchName&&(r=t.switchName)):t.network&&(i=t.network.name,t.network.opaqueNetworkType&&(r=t.network.opaqueNetworkType))),r?t.displayName=e.getString("VmUi","VmHardwareView.networkDisplayName",i,r):t.displayName=i}),i}function y(e,t){var r,n=b(e),o=_.find(n,function(e){var n=e._type;switch(n){case h5_vm.NetworkType.STD_NETWORK:case h5_vm.NetworkType.NSX_NETWORK:r=e.network.network;break;case h5_vm.NetworkType.DVSWITCH:r=e.distributedVirtualSwitch;break;case h5_vm.NetworkType.DVPORGGROUP:r=e.portgroup}return t===i.getVsphereObjectId(r)});return o}function P(e){var t;if(!e)return t={_type:h5_vm.NetBackingType.STD_NETWORK,deviceName:"",network:null};switch(e._type){case h5_vm.NetworkType.NSX_NETWORK:t={_type:h5_vm.NetBackingType.NSX_NETWORK,opaqueNetworkId:e.network.opaqueNetworkId,opaqueNetworkType:e.network.opaqueNetworkType};break;case h5_vm.NetworkType.DVPORGGROUP:t={_type:h5_vm.NetBackingType.DVPORGGROUP,port:{_type:"com.vmware.vim.binding.vim.dvs.PortConnection",portgroupKey:e.portgroupKey,switchUuid:e.switchUuid}};break;case h5_vm.NetworkType.STD_NETWORK:t={_type:h5_vm.NetBackingType.STD_NETWORK,deviceName:e.name,network:angular.extend(e.network.network,{type:"Network"})}}return t}function C(e){var t=e.lastIndexOf(".");return t>=0?e.substr(t+1):e}function D(e,t){return _.any(t,function(t){return n(e.getCurrentDevice(),t)})}function w(e){return C(e._type)}function b(e){var t=_.filter(e.distributedVirtualPortgroup,function(e){return!e.uplinkPortgroup}),i=e.network||[],r=i.concat(t),n=e.opaqueNetwork||[];return r=r.concat(n)}return{isDeviceSubclassOf:n,isDeviceInstanceOf:o,getEthernetCardLabel:s,getScsiControllerLabel:c,getStorageObjectLabel:l,optionForDevice:d,backingOptionForDevice:u,availableControllersForDevice:p,findCdromControllerNodes:v,findHardDiskControllerNodes:m,getControllerAndNodeLabelText:h,buildAvailableNetworkList:S,getNetworkInfo:y,buildNetworkDeviceBacking:P,getDeviceEthernetCard:a}}]),angular.module("com.vmware.vsphere.client.vm").factory("vmDeviceManagementService",["vmDeviceInfoService","opticalDriveService","lunSelectorDialogService","diskProvisioningService","networkAdapterService","scsiControllerService","sataControllerService","usbDeviceService","usbControllerService","nvmeControllerService","pciSharedService","existingHardDiskSelectorDialogService","tpmProvisioningService","nvdimmProvisioningService","deviceTypeConstants","$q","i18nService","vmCryptUtilService","clarityModalService","storageProfileService","serialPortService",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P){function C(e,t){if(e&&e.device){var i=e.controller;return i&&(t.getVirtualDevice(i.getKey())||t.addVirtualDevice(i)),t.addVirtualDevice(e.device),e.device.getKey()}}function D(e,t,i,r){S.openConfirmationModal({message:h.getString("VmUi","VmCryptConfig.alert.addEncryptedDisk"),clarityIcon:{shape:"warning","class":"is-warning",size:48},showXIcon:!1,preserveNewlines:!0,saveButtonLabel:h.getString("Common","yes.label"),cancelButtonLabel:h.getString("Common","no.label"),submit:function(){if(!t.storageProfiles||1!==t.storageProfiles.$$state.status||!t.storageProfiles.$$state.value)return void e.reject();var n=f.findEncryptionProfile(t.storageProfiles.$$state.value);return n?void f.getDefaultKmipServerStatus(t.serverGuid,!0).then(function(o){var a=o&&o.h5DefaultKmipClusterStatus&&o.h5DefaultKmipClusterStatus.noPermission,s=o&&o.h5DefaultKmipClusterStatus&&o.h5DefaultKmipClusterStatus.connectionStatus===h5_vm.ConnectionStatus.CONNECTED,c=o&&o.h5DefaultKmipClusterStatus&&o.h5DefaultKmipClusterStatus.certificateStatus===h5_vm.CertStatus.EXPIRED;return a||s?!a&&c?(e.reject(),void b(h.getString("VmUi","VmCryptConfig.reason.kmsCertificateRequiresUpdate"))):void w(e,n,t,i,r):(e.reject(),void b(h.getString("VmUi","VmCryptConfig.reason.noKms")))},function(){w(e,n,t,i,r)}):(e.reject(),void b(h.getString("VmUi","VmCryptConfig.reason.noEncryptionPolicies")))},onCancel:function(){e.reject()}})}function w(e,t,i,r,n){var o=y.makeProfile(t.id);i.vmConfigContext.vmProfile=[o],r.device.setOriginalProfile(o),r.device.updateDiskProfile(t),e.resolve({newVmProfile:t,newDeviceKey:C(r,n)})}function b(e){S.openConfirmationModal({message:e,clarityIcon:{shape:"warning","class":"is-warning",size:48},showXIcon:!1,hideCancelButton:!0})}return{createNewDevice:function(e,h,S,y,w){var b,I=y.getAllDevicesNotMarkedForRemoval(),T=h.configOption.hardwareOptions.virtualDeviceOption,E=h.configTarget;switch(e){case"VirtualUSBController":b=c.makeDefaultUSBController(S,h.configOption.hardwareOptions.virtualDeviceOption,y,w);break;case"VirtualUSB":var V=E.usb,M=y.devicesNotMarkedForRemovalOfType("VirtualUSBController"),O=y.devicesNotMarkedForRemovalOfType("VirtualUSBXHCIController");_.isEmpty(M)&&_.isEmpty(O)&&this.createNewDevice("VirtualUSBController",h,S,y,w),b=s.makeUSBDevice(T,V,I);break;case m.CDROM:b=t.makeDefaultOpticalDrive(h,S,I);break;case m.VIRTUALDISK:b=r.makeDefaultVirtualDisk(h,S,I,w);break;case m.RDMDISK:var A=g.defer();return i.openLunSelectorDialog(y.getRdmDisksNotMarkedForRemoval(),h,function(e){if(e&&!_.isEmpty(e)){var t=r.makeDefaultRDMDisk(h,S,I,w,e[0]);A.resolve(C(t,y))}}),A.promise;case m.EXISTINGHARDDISK:var k=g.defer();return u.openExistingDiskSelectorDialog(h,function(e){b=r.makeDefaultVirtualDiskFromExistingDisk(h,S,I,w,e),b.device.isDiskAlreadyEncrypted()&&!f.isVmHomeEncrypted(w.vmConfigContext)?D(k,w,b,y):k.resolve(C(b,y))}),k.promise;case m.ETHERNET:b=n.makeDefaultNetworkAdapter(h,S);break;case m.VirtualPCIPassthrough:b=d.createPciDevice(h,y);break;case m.VirtualPCIPassthrough+"Shared":b=d.createPciSharedDevice(h,y);break;case m.SCSICONTROLLER:b=o.makeDefaultSCSIController(S,h.configOption.hardwareOptions.virtualDeviceOption,y);break;case m.NVME_CONTROLLER:b=l.makeDefaultNVMeController(S,h.configOption.hardwareOptions.virtualDeviceOption,y,h.powerState);break;case m.VIRTUAL_SATA_CONTROLLER:b=a.makeDefaultSataController(h.configOption.hardwareOptions.virtualDeviceOption,y);break;case m.TPM:b=p.makeDefaultTpm(w.serverGuid,w.callback);break;case m.NVDIMM:b=v.makeDefaultNvdimm(h,S,y,w);break;case m.VIRTUAL_SERIAL_PORT:b=P.makeDefaultSerialPort(h,y);break;default:throw new Error("Unknown device: "+e)}return g.when(C(b,y))}}}]);var h5_vm;!function(e){var t="com.vmware.vsphere.client.vm.model.HardwareConfigData",i="VirtualMachine/vmStorageProfileAssignments",r="hardwareDataResult",n="storageProfilesResult",o="vmStorageProfileAssignmentsResult",a="hasAddRemoveDevicePrivilegeResult",s=function(){function e(e,t,i,r,n,o,a,s){this.vmHardwareUtil=e,this.dataService=t,this.vmNetworkService=i,this.defaultUriSchemeUtil=r,this.storageProfileService=n,this.$q=o,this.vmDeviceInfoService=a,this.VirtualMachineDevices=s}return e.prototype.getDataPromises=function(e){var i=this.dataService.getData(e,t),n={};return n[r]=i,this.$q.all(n)},e.prototype.useData=function(e,t){var s=t[r],c=t[n],l=s.vmConfigContext.environment.configTarget,d=this.vmDeviceInfoService.buildAvailableNetworkList(l),u=s.guestOsFamilyKey,p=t[o];p&&p.hasOwnProperty(i)&&(p=p[i]);var v=t[a],m={vmConfigContext:s.vmConfigContext,originalConfig:angular.copy(s.vmConfigContext.config),privileges:{hasAddRemoveDevicePrivilege:v},availableNetworks:d,storageProfiles:c,guestOsFamilyKey:u,vmStorageProfileAssignments:void 0};return null!==p&&(m.vmStorageProfileAssignments=p),m},e.prototype.getAndFormatData=function(e){var t=this;return this.getDataPromises(e).then(function(i){return t.useData(e,i)})},e.prototype.getVmNetworkInfo=function(e,t){return this.vmNetworkService.getVmNetworkInfo(e,t)},e.prototype.buildVirtualDevices=function(e){var t=_.indexBy(e.vmConfigContext.environment.configOption.hardwareOptions.virtualDeviceOption,function(e){return e.type.name}),i=new this.VirtualMachineDevices(e.vmConfigContext.config.hardware.device,e.vmStorageProfileAssignments,e.storageProfiles,e.availableNetworks,t);return i},e.VIRTUAL_ETHERNET_CARD="VirtualEthernetCard",e}();e.VmHardwareBaseService=s,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareBaseService",s)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges;angular.module("com.vmware.vsphere.client.vm").service("vmHardwareCdromManagerService",["$q","i18nService","EditableVirtualDevice","vmHardwareUtil","featureFlagsService","contentLibraryService","vcService",function(e,i,r,n,o,a,s){function c(e){return n.checkPrivileges(e,[t.VM_ADDREMOVEDEVICE_PRIVILEGE])}function l(e){return O=_.map(e,function(e,t){return{id:t,name:e.name}})}function d(e,t,i){return{_type:"com.vmware.vim.binding.vim.vm.device.VirtualCdrom$IsoBackingInfo",fileName:e,datastore:t?t:null,backingObjectId:i?i:null}}function u(e){var t,i=e.mediaType.id;return i===L?(e.deviceMode=x,O.length>0&&(e.selectedCdrom=O[0],t=M(e.selectedCdrom))):i===R&&(t=p(e.deviceMode)),t}function p(e){var t={deviceName:""};if(e.id===A)t._type="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$RemoteAtapiBackingInfo";else{if(e.id!==k)throw new Error("Unknown mode: "+e);t._type="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$RemotePassthroughBackingInfo",t.exclusive=!1}return t}function v(e,t){return s.is65VcOrLater(t).then(function(t){var r=V(e,t);return _.map(r,function(e){return{id:e,label:i.getString("VmUi",e)}})})}function m(){return[$,x]}function g(e){return e&&e.id===R}function h(e){return e._type.indexOf("Remote")>=0}function f(e){return e&&e.id===L}function S(e){return e&&e.id===N}function y(e){return e&&e.id===U}function P(e){return!(_.isEmpty(e)||!e.backing||"com.vmware.vim.binding.vim.vm.device.VirtualCdrom$AtapiBackingInfo"!==e.backing._type)}function C(e){return e.match("Passthrough")?$:x}function D(t,i){function r(e){return _.find(i,function(t){return t.id===e})}var n=e.defer(),o=t._type;if(o.match("IsoBackingInfo")){var s=r(N),c=r(U),l={mediaType:s};a.getContentLibraryItemByDatastorePath(t.fileName).then(function(e){var t=(function(){function e(){}return e}(),e.contentLibraryItemByDatastorePath),i=t?t.errorMessages:[],r=Array.isArray(i)&&i.length>0,o=t?t.friendlyName:"";o&&""!==o||(r=!0),t&&!r&&(l={mediaType:c,selectedIsoItem:t}),n.resolve(l)},function(e){n.resolve(l)})}else if(t._type.match("Remote"))n.resolve({mediaType:r(R)});else{var d=r(L);d||(d={id:F}),n.resolve({mediaType:d})}return n.promise}function w(e,t){if(t)return!1;var i=n.checkPrivileges(e,["VirtualMachine.Interact.SetCDMedia"]);return!i}function b(e,t,i){var r=function(){return g(e)};if(i)return r();var o=n.checkPrivileges(t,["VirtualMachine.Interact.DeviceConnection"]);return!o||r()}function I(e,t,i){var r=function(){return h(e)};if(i)return r();var o=n.checkPrivileges(t,["VirtualMachine.Interact.DeviceConnection"]);return!o||r()}function T(e,t){return!_.isEmpty(t)&&_.some(t,function(t){return t.name===e})}function E(e,t,i){var r=function(){return S(e)||y(e)||f(e)};if(i)return r();var o=n.checkPrivileges(t,["VirtualMachine.Interact.SetCDMedia"]);return!o||r()}function V(e,t){var i=[];return i.push(R),e.length>0&&i.push(L),i.push(N),o.h5uiDirectIsoMountFromCLEnabled&&t&&i.push(U),i}function M(e){return{_type:"com.vmware.vim.binding.vim.vm.device.VirtualCdrom$AtapiBackingInfo",deviceName:e.name}}var O,A=1,k=2,R="CdromConfig.ClientDevice",N="CdromConfig.DatastoreISOFile",U="CdromConfig.CLISOFile",L="CdromConfig.HostDevice",F="NotAvailableHostDevice",x={label:i.getString("VmUi","CdromConfig.EmulateCdrom"),id:A},$={label:i.getString("VmUi","CdromConfig.PassthroughCdrom"),id:k};return{createCdromList:l,createIsoBacking:d,getNewDeviceBacking:u,createClientDeviceBacking:p,getAvailableMediaTypes:v,getInitialMediaType:D,getInitialDeviceMode:C,getAvailableDeviceModes:m,isClientDevice:g,isDevicePresentInTheHost:T,isHostDevice:f,isDatastoreISOFile:S,isContentLibraryISOFile:y,isRemoteDevice:h,isCdRomDisabled:w,isCdRomConnectedAtPowerOnDisabled:b,isCdRomConnectedDisabled:I,isDeviceModeDisabled:E,hasPrivileges:c,hasHostDevicebacking:P}}])}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.VmHardwareBaseService,i=com.vmware.vsphere.client.vm.config.VmConfigContext,r=function(e){function r(t,i,r,n,o,a,s,c,l,d,u){e.call(this,i,r,n,o,a,s,c,l),this.vmFactoryService=t,this.managedEntityConstants=d,this.deviceTypeConstants=u,this.CONFIG_PROPERTY="config",this.STORAGE_PROFILES_PROPERTY="vmStorageProfileAssignments",this.CONFIG_RESULT="configResult",this.STORAGE_PROFILES_RESULT="spResult",this.PARENT_PRIVILEGES_RESULT="parentPrivilegesResult"}return __extends(r,e),r.prototype.getAndFormatData=function(e,t){var i=this,r=this.getPromises(e);return r.then(function(r){var n=_.extend({},r[i.CONFIG_RESULT],r[i.STORAGE_PROFILES_RESULT]);return e.setVmVersion(n.config.version),e.getVmConfigEnvironment().then(function(o){var a=i.buildHardwareData(e,t,o,n,r[i.PARENT_PRIVILEGES_RESULT]);if(e.getRecreateVm()||!e.getVmConfigSpec())a.virtualMachineDevices=i.buildVirtualDevices(a),i.vmFactoryService.buildCloneVM(e,a.vmConfigContext,a.virtualMachineDevices,a.originalConfig,a.vmStorageProfileAssignments),e.setRecreateVm(!1),a.vmConfigContext.environment.configTarget.resourcePool=e.getResourcePool().runtime;else{var s=a.virtualMachineDevices.existingDevicesOfType(i.deviceTypeConstants.VIRTUALDISK);i.vmFactoryService.applyStorageToVirtualDisks(s,a.vmStorageProfileAssignments,e)}var c=e.getVmConfigSpec();return a.vmConfigContext.config=c,a.virtualMachineDevices=e.getVirtualMachineDevices(),i.getVmNetworkInfoForClone(e).then(function(e){return a.networkProviderId=e.networkProviderId,a.availableNetworks=e.availableNetworks,a})})})},r.prototype.getVmNetworkInfoForClone=function(i){var r=i.getComputeResourceId(),n=i.getVirtualMachineDevices().existingDevicesOfType(t.VIRTUAL_ETHERNET_CARD);return e.prototype.getVmNetworkInfo.call(this,r,n)},r.prototype.getPromises=function(e){var t=this.dataService.getProperties(e.getVmId(),[this.CONFIG_PROPERTY]),i=this.dataService.getProperties(e.getVmId(),[this.STORAGE_PROFILES_PROPERTY],{skipErrorInterceptor:!0})["catch"](function(){return{vmStorageProfileAssignments:void 0}}),r={};return r[this.CONFIG_RESULT]=t,r[this.STORAGE_PROFILES_RESULT]=i,r[this.PARENT_PRIVILEGES_RESULT]=e.getPrivileges(),this.$q.all(r)},r.prototype.buildHardwareData=function(e,t,r,n,o){var a=r.vmConfigEnvironmentPerPool,s=this.getAvailableNetworks(a),c=this.createConfigInfoObject(n[this.CONFIG_PROPERTY]),l=new i;l.environment=a,l.config=angular.copy(c),l.privileges=o;var d=_.find(a.configOption.guestOSDescriptor,function(t){return t.id===e.getGuestOsId()}),u={originalConfig:c,selectedStorageProfile:e.getSelectedStorageProfile(),selectedReplicationGroupInfo:e.getSelectedReplicationGroupInfo(),vmConfigContext:l,guestOsFamilyKey:d?d.family:null,filterNetworksObjId:e.getFilterNetworksObjectId(),virtualMachineDevices:e.getVirtualMachineDevices(),networkProviderId:null,availableNetworks:s,storageProfiles:t.getStorageProfiles()};return null!==n[this.STORAGE_PROFILES_PROPERTY]&&(u.vmStorageProfileAssignments=n[this.STORAGE_PROFILES_PROPERTY]),
u},r.prototype.createConfigInfoObject=function(e){return angular.extend({_type:"com.vmware.vim.binding.vim.vm.ConfigInfo"},e)},r.prototype.getAvailableNetworks=function(e){var t=e.configTarget,i=this.vmDeviceInfoService.buildAvailableNetworkList(t);return i},r.$inject=["vmFactoryService","vmHardwareUtil","dataService","vmNetworkService","defaultUriSchemeUtil","storageProfileService","$q","vmDeviceInfoService","VirtualMachineDevices","managedEntityConstants","deviceTypeConstants"],r}(t);e.VmHardwareCloneService=r,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareCloneService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.SharesInfo,i=function(){function e(e,t,i,r){this.vmHardwareUtil=e,this.guestOsService=t,this.cpuClockFilter=i,this.i18nService=r,this.i18n=r.getString}return e.prototype.getVmCapabilities=function(e){var t=e.environment.configOption.capabilities;return t},e.prototype.getHostCapabilities=function(e){var t=e.environment.hostCapability;return t},e.prototype.isNumCpuEnabled=function(e,t,i,r,n,o){if(o)return!0;if(i)return!1;if(!this.haveCpuCountPermission(n))return!1;var a=!!r&&r.supportsCpuHotAdd;return(t.cpuHotAddEnabled!==!1&&a!==!1||!this.isPowerOnState(e))&&!this.isSuspendedState(e)},e.prototype.isCreatingNewVm=function(e){var t=!1;return e&&(t=!0),t},e.prototype.isReservationEnabled=function(e,t){return!!this.isCreatingNewVm(t)||!!this.haveChangeResourcePermission(e)},e.prototype.isLimitEnabled=function(e,t){return!!this.isCreatingNewVm(t)||!!this.haveChangeResourcePermission(e)},e.prototype.isSharesEnabled=function(e,t){return!!this.isCreatingNewVm(t)||!!this.haveChangeResourcePermission(e)},e.prototype.isNestedHVSupportedOnVmAndHost=function(e){var t=this.getVmCapabilities(e),i=this.getHostCapabilities(e),r=t.nestedHVSupported,n=i.nestedHVSupported,o=r===!0&&n===!0;return o},e.prototype.isNestedHVEnabled=function(e,t){var i=this.isNestedHVSupportedOnVmAndHost(e);return i===!0&&(!!this.isCreatingNewVm(t)||!this.isPoweredOn(e)&&!!this.haveSettingsPermission(e))},e.prototype.isCpuIdEnabled=function(e,t){return!!this.isCreatingNewVm(t)||!this.isPoweredOn(e)&&(!this.isSuspended(e)&&!!this.haveSettingsPermission(e))},e.prototype.isCpuMmuEnabled=function(e,t){return!!this.isCreatingNewVm(t)||!!this.haveSettingsPermission(e)},e.prototype.isSuspended=function(e){return"suspended"===e.environment.powerState},e.prototype.isPoweredOn=function(e){return!!this.isPowerOnState(e.environment.powerState)},e.prototype.isSuspendedState=function(e){return"suspended"===e},e.prototype.isPowerOnState=function(e){return"poweredOn"===e},e.prototype.haveCpuCountPermission=function(e){var t="VirtualMachine.Config.CPUCount",i=this.vmHardwareUtil.checkPrivileges(e,[t]);return i},e.prototype.haveChangeResourcePermission=function(e){var t=e.privileges,i="VirtualMachine.Config.Resource",r=this.vmHardwareUtil.checkPrivileges(t,[i]);return r},e.prototype.haveSettingsPermission=function(e){var t=this.vmHardwareUtil.haveVmConfigSettingsPermission(e);return t},e.prototype.checkPrivileges=function(e,t){var i=this.vmHardwareUtil.checkPrivileges(t,[e]);return i},e.prototype.isCpuHotPlugEnabled=function(e,t,i,r,n,o){var a=!!r&&r.supportsCpuHotAdd;return!("poweredOn"===e||this.vmHardwareUtil.isFtVm(t,i)||!a)&&!(!this.vmHardwareUtil.checkPrivileges(n,["VirtualMachine.Config.CPUCount"])&&!o)},e.prototype.buildSupportedCoresPerSocket=function(e,t,i){var r,n=[],o=e.environment.configOption.capabilities.multipleCoresPerSocketSupported,a=e.config.hardware.numCPU;r=o?Math.min(i.numSupportedCoresPerSocket,e.environment.configOption.hardwareOptions.numCoresPerSocket.max,a):1;for(var s=1;s<=r;s++){var c=a/s;a%s!==0||c>i.numSupportedPhysicalSockets||n.push(s)}var l=t.hardware.numCoresPerSocket,d=t.hardware.numCPU;return 0===n.length&&(a===d?n.push(l):n.push(1)),n},e.prototype.buildSupportedCpus=function(e,t,i){if(!(e.environment&&e.environment.configTarget&&e.environment.configOption))return[];var r=e.environment.configTarget.numCpus,n=t.supportedMaxCPUs,o=t.numSupportedPhysicalSockets,a=e.config.hardware.numCoresPerSocket,s="poweredOn"===e.environment.powerState,c=this.isHotAddEnabled(e,t),l=this.isHotRemoveEnabled(e,t),d=e.config.hardware.numCPU,u=!s||s&&c,p=!s||s&&l,v=e.environment.configOption.capabilities.multipleCoresPerSocketSupported,m=!s&&v,g=e.privileges,h=this.checkPrivilege(g,"VirtualMachine.Config.CPUCount",i),f=e.environment.configOption.hardwareOptions.numCPU,S=[],y=function(e,t,i){return(t<0||e<=t)&&(i<0||e<=i)},P=function(e,t,i,r){return e===t||e<t&&i||e>t&&r};return _.forEach(f,function(e){if(y(e,r,n)&&P(e,d,p,u)){if(v&&!m&&h&&(e%a>0||e/a>o))return;S.push(e)}}),S},e.prototype.isHotAddEnabled=function(e,t){return e.config.cpuHotAddEnabled&&t.supportsCpuHotAdd},e.prototype.isHotRemoveEnabled=function(e,t){return e.config.cpuHotRemoveEnabled&&t.supportsCpuHotRemove},e.prototype.checkPrivilege=function(e,t,i){return e?e.indexOf(t)>-1:!!i},e.prototype.getMaxReservation=function(e){var t=0,i=e.config.hardware.numCPU,r=e.environment.hostCpuMhz,n=this.vmHardwareUtil.isVmPoweredOn(e.environment.powerState),o=e.environment.isInCluster,a=e.environment.configTarget.resourcePool.cpu,s=a.maxUsage,c=e.config.cpuAllocation.limit,l=e.config.cpuAllocation.reservation,d=l?l:0,u=0;n&&(u=d);var p=s;r&&(p=i*r),n?(a.unreservedForVm!==-1&&(t=a.unreservedForVm),t+=u):t=Math.max(s,d),t>p&&!o&&(t=n?Math.min(p,t):Math.min(p,a.unreservedForVm));var v;return v=c!==-1?Math.min(c,t):t},e.prototype.formatEnabledDisabled=function(e){return e?this.i18n("VmUi","VmCpuView.Enabled"):this.i18n("VmUi","VmCpuView.Disabled")},e.prototype.formatRecommendations=function(e){var t=this;_.each(e,function(e){e.formattedValue=t.cpuClockFilter(e.value)})},e.prototype.isCpuIdMaskExposed=function(e){var t;return t=e.config.cpuFeatureMask&&e.config.cpuFeatureMask.length>0?e.config.cpuFeatureMask[0]:e.environment.configOption.guestOSDescriptor[0].cpuFeatureMask[0],!(!t.edx||"H"!==t.edx[11])},e.prototype.isSchedulingAffinityShown=function(e){var t=this.vmHardwareUtil.isVmPoweredOn(e.environment.powerState),i=e.environment.isInCluster,r=e.environment.configTarget.numCpus>1;return!t&&!i&&r},e.prototype.isSchedulingAffinityEnabled=function(e,t){return!!t||this.checkPrivilege(e.privileges,"VirtualMachine.Config.Resource")},e.prototype.getAffinityDisplayValue=function(e){for(var t,i=e[0],r=(e.slice(1),e[0]),n=(e.slice(1),[]),o=function(e,t){e!==t?n.push(e+"-"+t):n.push(t)},a=0;a<e.length;a++)t=e[a],a>0&&t!==i+1&&(o(r,i),r=t),i=t;return o(r,t),n.join(",")},e.prototype.getCpuAffinitySignpostContext=function(e){var t,i,r,n=e.environment.configTarget.numCpus,o=e.environment.configTarget.numCpuCores;return 0===n||0===o?(i=this.i18n("VmUi","Affinity.HyperThreading.Unknown"),r=this.i18n("VmUi","Affinity.NumProcs.Unknown",o),t=this.i18n("VmUi","Affinity.SelectAffinity.Unknown")):o!==n?(i=this.i18n("VmUi","Affinity.HyperThreading.Active"),r=this.i18n("VmUi","Affinity.NumProcs.Logical",n),t=this.i18n("VmUi","Affinity.SelectAffinity.Logical")):(i=this.i18n("VmUi","Affinity.HyperThreading.Inactive"),r=this.i18n("VmUi","Affinity.NumProcs.Physical",o),t=this.i18n("VmUi","Affinity.SelectAffinity.Physical")),{i18n:this.i18nService.getString,affinityText:t,htStatus:i,numProcs:r}},e.prototype.validateAffinity=function(e,t){if(""===e.trim())return!0;for(var i=function(e){return e&&!isNaN(Number(e))},r=e.split(","),n=0,o=r;n<o.length;n++){var a=o[n],s=a.trim().split("-");if(2===s.length){var c=s[0],l=s[1],d=void 0,u=void 0;if(!i(c))return!1;if(d=Number(c),!i(l))return!1;if(u=Number(l),d>u||u>t-1)return!1}else{if(1!==s.length)return!1;var p=s[0],v=void 0;if(!i(p))return!1;if(v=Number(p),v>t-1)return!1}}return!0},e.prototype.transformAffinity=function(e){var t=[];if(""===e.trim())return t;for(var i=e.split(","),r=0,n=i;r<n.length;r++){var o=n[r],a=o.trim().split("-");if(2===a.length)for(var s=a[0],c=a[1],l=Number(s),d=Number(c),u=l;u<=d;u++)t.push(u);else if(1===a.length){var p=a[0],v=Number(p);t.push(v)}}return t},e.prototype.setUpSharesInfo=function(e,i){var r=new t;r.level="normal",r.shares=1e3;var n=e.config.cpuAllocation;if(!n)return r;var o=n.shares;return this.isSharesEnabled(e,i)?r=o:o&&(r.level=o.level,r.shares=o.shares),r},e.$inject=["vmHardwareUtil","guestOsService","cpuClockFilter","i18nService"],e}();e.VmHardwareCpuService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareCpuService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.VmHardwareBaseService,i=function(){function e(e,t,i,r,n,o){this.vmFactoryService=e,this.authorizationService=t,this.vmHardwareVersionService=i,this.vmNetworkService=r,this.i18nService=n,this.$q=o}return e.prototype.getVmNetworkInfo=function(e,t){return this.vmNetworkService.getVmNetworkInfo(e,t)},e.prototype.getVmNetworkInfoForCreate=function(e,i){var r=e.getComputeResourceId(),n=i.newDevicesOfType(t.VIRTUAL_ETHERNET_CARD);return this.getVmNetworkInfo(r,n)},e.prototype.getAndFormatData=function(e,t){var i=this;return e.getVmConfigEnvironment().then(function(r){var n=r.vmConfigEnvironmentPerPool,o=e.getVirtualMachineDevices(),a=e.getScheduledData(),s=!_.isEmpty(a)&&a.useScheduledTaskData;!e.getRecreateVm()&&e.getVmConfigSpec()||(o=i.vmFactoryService.buildVirtualDevicesForCreate(n,s));var c={networkInfoForCreate:i.getVmNetworkInfoForCreate(e,o),folderRequiredPrivileges:e.getPrivileges(),retrieveGosDescriptor:i.$q.when()};return e.shouldRetrieveGosDescriptor()&&(c.retrieveGosDescriptor=e.retrieveGosDescriptor()),i.$q.all(c).then(function(a){_.isEmpty(a.retrieveGosDescriptor)||(n.configOption.guestOSDescriptor[0]=a.retrieveGosDescriptor.vmConfigGuestOsDescriptor);var s=a.folderRequiredPrivileges;if(e.getRecreateVm()||!e.getVmConfigSpec()){var c=i.vmFactoryService.buildNewVM(n,e,o,s),l=c.vmConfigSpec;e.setVirtualMachineDevices(c.virtualMachineDevices),e.setVmConfigSpec(l),e.setRecreateVm(!1),n.configTarget.resourcePool=e.getResourcePool().runtime}var d=e.getVmConfigSpec().config,u={originalConfig:angular.copy(d),selectedStorageProfile:e.getSelectedStorageProfile(),selectedReplicationGroupInfo:e.getSelectedReplicationGroupInfo(),storageProfiles:t.getStorageProfiles(),vmVersion:i.i18nService.getString("VmUi","VmHardware.HWVersion.vmVersionLabel",i.vmHardwareVersionService.getLongText(d.version)),vmConfigContext:{environment:n,config:d,privileges:s},guestOsFamilyKey:r.guestOsFamilyKey,virtualMachineDevices:e.getVirtualMachineDevices(),filterNetworksObjId:e.getFilterNetworksObjectId(),networkProviderId:a.networkInfoForCreate.networkProviderId,availableNetworks:a.networkInfoForCreate.availableNetworks};return u})})},e.$inject=["vmFactoryService","authorizationService","vmHardwareVersionService","vmNetworkService","i18nService","$q"],e}();e.VmHardwareCreateService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareCreateService",i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=e.VmHardwareBaseService,i=function(e){function i(t,i,r,n,o,a,s,c,l,d,u,p,v){e.call(this,a,s,c,l,d,u,p,v),this.$rootScope=t,this.vmFactoryService=i,this.mutationService=r,this.storageLocatorService=n,this.vcH5ConstantsService=o}return __extends(i,e),i.prototype.getHost=function(e){var t=this.defaultUriSchemeUtil.getVsphereObjectId(e.rtInfo.host);return t},i.prototype.fetchProfiles=function(e){var t=this.defaultUriSchemeUtil.getManagedObjectReference(e).serverGuid;return this.storageProfileService.fetchProfiles(t)},i.prototype.fetchAssignments=function(e){var t=["vmStorageProfileAssignments"];return this.dataService.getProperties(e,t)},i.prototype.fetchRgroups=function(e){var t=["vmReplicationGroupAssignments"];return this.dataService.getProperties(e,t)},i.prototype.getVmConfigContext=function(t){var i=this,r="vmConfigContext",n=this.dataService.getProperties(t,[r]),o=n.then(function(n){var o=n[r],a={hardwareDataResult:{vmConfigContext:o}};return e.prototype.useData.call(i,t,a)});return o},i.prototype.getAndFormatData=function(e){var t=this,i=this.$q.when(this.getVmConfigContext(e)),r=i.then(function(i){var r=t.fetchProfiles(e),n=t.fetchAssignments(e),o=t.fetchRgroups(e),a=t.postProcess(i,r,n,o);return a});return r},i.prototype.postProcess=function(t,i,r,n){var o=t.vmConfigContext.rtInfo.host;t.host=o,t.filterNetworksObjId=this.defaultUriSchemeUtil.getVsphereObjectId(o),t.virtualMachineDevices=e.prototype.buildVirtualDevices.call(this,t),t.storageProfiles=i,t.vmStorageProfileAssignments=r,t.vmReplicationGroupAssignments=n;var a={hardwareConfigPromise:this.$q.when(t)};return this.$q.all(a)},i.prototype.getStorageLocatorItems=function(e){return this.storageLocatorService.getStorageLocatorData(e,e)},i.prototype.getVmNetworkInfo=function(i,r){var n=this.defaultUriSchemeUtil.getVsphereObjectId(i),o=r.virtualMachineDevices.existingDevicesOfType(t.VIRTUAL_ETHERNET_CARD);return e.prototype.getVmNetworkInfo.call(this,n,o)},i.prototype.update=function(e,t,i,r,n,o,a){var s=n.getFinalChanges(),c={originalConfig:i,config:r,deviceChange:s,cpuFeatureMask:o,npivWwnOp:r.npivWwnOp};a&&(c.profile=a),this.mutationService.apply(e,"com.vmware.vsphere.client.vm.VmConfigSpec",c,t),this.broadcastEditSaved(e)},i.prototype.applyRecommendationAndUpdate=function(e,t,i){var r={recommendations:t};this.mutationService.apply(e,"com.vmware.vsphere.client.vm.storageDrs.VmRecommendationsSpec",r,i),this.broadcastEditSaved(e)},i.prototype.broadcastEditSaved=function(e){this.$rootScope.$broadcast(this.vcH5ConstantsService.VM_EDIT_SAVED,{vmId:e})},i.$inject=["$rootScope","vmFactoryService","mutationService","storageLocatorService","vcH5ConstantsService","vmHardwareUtil","dataService","vmNetworkService","defaultUriSchemeUtil","storageProfileService","$q","vmDeviceInfoService","VirtualMachineDevices"],i}(t);e.VmHardwareEditService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareEditService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.vmHardwareUtil=e}return e.prototype.getReservationMaxLimit=function(e,t,i,r){var n=0,o=-1;i&&(i.reservation&&(n=i.reservation),i.hasOwnProperty("limit")&&(o=i.limit));var a=this.vmHardwareUtil.isVmPoweredOn(r),s=a?n:0,c=this.vmHardwareUtil.bytesToMB(e.maxUsage),l=0,d=0;return a?(e.unreservedForVm!==-1&&(l=this.vmHardwareUtil.bytesToMB(e.unreservedForVm)),l+=s):l=Math.max(c,n),l>t&&(l=t),d=o!==-1?Math.min(o,l):l},e.prototype.getMinMemoryMB=function(e,t){return this.vmHardwareUtil.isVmPoweredOn(t.powerState)&&e.memoryHotAddEnabled?e.hardware.memoryMB:t.configOption.hardwareOptions.memoryMB.min},e.prototype.getMaxMemoryMB=function(e,t){return this.vmHardwareUtil.isVmPoweredOn(t.powerState)&&e.memoryHotAddEnabled?e.hotPlugMemoryLimit:t.configOption.hardwareOptions.memoryMB.max},e.prototype.isMemoryDisabled=function(e,t,i,r){var n=this;void 0===r&&(r=!1);var o=function(){return n.getMinMemoryMB(e,t)>=n.getMaxMemoryMB(e,t)||!e.memoryHotAddEnabled&&n.vmHardwareUtil.isVmPoweredOn(t.powerState)};if(r)return o();var a=this.vmHardwareUtil.checkPrivileges(i,["VirtualMachine.Config.Memory"]);return!a||o()},e.prototype.isReservationDisabled=function(e,t,i){void 0===i&&(i=!1);var r=function(){return e.memoryReservationLockedToMax};if(i)return r();var n=this.vmHardwareUtil.checkPrivileges(t,["VirtualMachine.Config.Resource"]);return!n||r()},e.prototype.isMaxReservationDisabled=function(e,t,i,r){void 0===e&&(e={}),void 0===i&&(i={}),void 0===r&&(r=!1);var n=function(){return"enabled"===e.faultToleranceState||!i.memoryReservationLockSupported};if(r)return n();var o=this.vmHardwareUtil.checkPrivileges(t,["VirtualMachine.Config.Resource"]);return!o||n()},e.prototype.isLimitDisabled=function(e,t){if(void 0===t&&(t=!1),t)return!1;var i=this.vmHardwareUtil.checkPrivileges(e,["VirtualMachine.Config.Resource"]);return!i},e.prototype.isSharesDisabled=function(e,t){if(void 0===t&&(t=!1),t)return!1;var i=this.vmHardwareUtil.checkPrivileges(e,["VirtualMachine.Config.Resource"]);return!i},e.prototype.isMemoryHotPlugDisabled=function(e,t,i,r){var n=this;void 0===r&&(r=!1);var o=function(){var t=!i.supportsMemoryHotAdd;return n.vmHardwareUtil.isVmPoweredOn(e.powerState)||t};if(r)return o();var a=this.vmHardwareUtil.checkPrivileges(t,["VirtualMachine.Config.Memory"]);return!a||o()},e.$inject=["vmHardwareUtil"],e}();e.VmHardwareMemoryService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareMemoryService",t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").factory("vmHardwareVersionService",["i18nService",function(e){function t(e){var t=parseInt(e.split("-")[1]);return _.isNaN(t)?-1:t}function i(t){return e.getString("VmUi","VmHardware.HWVersion.long."+t)}function r(t){var i,r,s;return t.upgrade&&t.upgrade.scheduledHardwareUpgradeStatus&&(s=t.upgrade.scheduledHardwareUpgradeStatus),s!==o&&(i=e.getString("VmUi","VmHardwareView."+s),s===a&&(r=n(t.upgrade.fault))),{status:i,error:r}}function n(e){var t="",i="";return e&&e.faultMessage&&e.faultMessage.length>0&&e.faultMessage.forEach(function(e){t+=i+e.message,""===i&&(i="\n")}),t}var o="none",a="failed";return{getVersionNumber:t,getLongText:i,getScheduledUpgradeData:r}}]),angular.module("com.vmware.vsphere.client.vm").factory("vmRecommendationsService",["dataService","actionDialogService","mutationService","i18nService","defaultUriSchemeUtil","$q","logService",function(e,t,i,r,n,o,a){function s(e){var t=[];return _.each(e,function(e){_.each(e.action,function(e){var i=n.getVsphereObjectId(e.target);t.push(i)})}),t}function c(e){return null===e||0===e.length?[]:_.reduce(e,function(e,t){if(null===t.action||0===t.action.length)return e;var i=function(e){return"com.vmware.vim.binding.vim.cluster.InitialPlacementAction"===e._type?n.getVsphereObjectId(e.targetHost):"com.vmware.vim.binding.vim.cluster.MigrationAction"===e._type?[n.getVsphereObjectId(e.drsMigration.source),n.getVsphereObjectId(e.drsMigration.destination)]:void p.error("Unknown action type: ",e)},r=_.chain(t.action).map(i).flatten().value();return e.concat(r)},[])}function l(e){var t=5;return t-e+1}function d(e,t,i){return _.map(e,function(e,o){var a=r.getString("VmUi","RecommendationListItemData.recommendation",o+1,e.reasonText),s={reasonText:a,priority:l(e.rating),actions:u(e.action,t,i),key:e.key,targetClusterId:n.getVsphereObjectId(e.target)};return s})}function u(e,t,i){return _.map(e,function(e){var o,a,s;if("com.vmware.vim.binding.vim.cluster.InitialPlacementAction"===e._type){var c=n.getVsphereObjectId(e.targetHost);return o=n.getVsphereObjectId(e.target),a=t[o],s=r.getEscapedString("VmUi","RecommendationListItemData.initialPlacement",a.name,i[c]),{text:s,icon:a.primaryIconId}}if("com.vmware.vim.binding.vim.cluster.MigrationAction"===e._type){var l=n.getVsphereObjectId(e.drsMigration.source),d=n.getVsphereObjectId(e.drsMigration.destination);o=n.getVsphereObjectId(e.target);var u="RecommendationListItemData.migration",v=i[l],m=i[d];return a=t[o],s=r.getEscapedString("VmUi",u,a.name,v,m),{text:s,icon:a.primaryIconId}}p.error("Unknown action type: ",e)})}var p=a("vmRecommendationsService"),v=function(t){if(angular.isUndefined(t)||angular.isUndefined(t[0]))return o.reject();var i=t[0].result?t[0].result.recommendations:null;if(null===i||0===i.length)return o.reject();var r=c(i),n=_.map(r,function(t){return e.getProperties(t,["name"])}),a=s(i),l=_.map(a,function(t){return e.getProperties(t,["name","primaryIconId"])}),u={};return o.all(l).then(function(e){var t={};return _.each(e,function(e){t[e.id]=e}),o.all(n).then(function(e){_.each(e,function(e){u[e.id]=e.name});var r=d(i,t,u);return r})})},m=function(e,t){var r={operation:"apply",keys:t},n="com.vmware.vsphere.client.cluster.services.recommendations.ClusterRecommendationSpec";return i.apply(e,n,r)},g=function(e,t){var r="com.vmware.vim.binding.vim.cluster.Recommendation";return i.apply(e,r,t)};return{fetchRecommendations:v,applyRecommendations:m,applyRecommendation:g}}]);var h5_vm;!function(e){var t=e.VmHardwareUtil,i=com.vmware.vim.binding.vim.ResourceAllocationInfo,r=function(){function r(e,t,i,r,n,o){if(void 0===o&&(o=null),this.vmConfigContext=e,this.guest=t,this.privileges=i,this.workflow=r,this.i18nService=n,this.removeDevice=o,this.originalRAM=0,this.BIOS_LIMIT_MB=6275072,this.FIRMWARE_EFI="efi",this.environment=this.vmConfigContext.environment,!this.environment)throw new Error("Class VmConfig missing config environment");this.config=e.config,this.config&&this.config.hardware&&(this.originalRAM=this.config.hardware.memoryMB),this.powerState=this.environment.powerState,this.removeInvalidCPUs()}return r.prototype.removeInvalidCPUs=function(){if(this.environment.configOption&&this.guest){var e=this.environment.configOption.hardwareOptions;if(e){var t=this.guest.numSupportedCoresPerSocket,i=this.guest.numSupportedPhysicalSockets,r=[];e.cpuBackup||(e.cpuBackup=e.numCPU.concat());for(var n=e.cpuBackup,o=0,a=n;o<a.length;o++)for(var s=a[o],c=1;c<=t;c++){var l=s%c;if(0===l){var d=s/c;if(!(d>i)){r.push(s);break}}}e.numCPU=r}}},r.prototype.getGuestOsDescriptror=function(){return this.guest},r.prototype.getVmConfigContext=function(){return this.vmConfigContext},r.prototype.getI18nService=function(){return this.i18nService},r.prototype.i18n=function(e){return this.i18nService.getString("VmUi",e)},Object.defineProperty(r.prototype,"grantedConfigSettings",{get:function(){if(!this.privileges)return!0;var t=e.VmHardwareUtil.hasPrivileges(this.privileges,[e.Privileges.VM_CONFIG_SETTINGS]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"grantedEditDevice",{get:function(){if(!this.privileges)return!0;var t=e.VmHardwareUtil.hasPrivileges(this.privileges,[e.Privileges.VM_EDITDEVICE_PRIVILEGE]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"grantedRemoveDevice",{get:function(){if(!this.privileges)return!0;var t=e.VmHardwareUtil.hasPrivileges(this.privileges,[e.Privileges.VM_ADDREMOVEDEVICE]);return t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"grantedDeviceConnection",{get:function(){if(!this.privileges)return!0;var t=e.VmHardwareUtil.hasPrivileges(this.privileges,[e.Privileges.VM_INTERACT_DEVICE_CONNECTION]);return t},enumerable:!0,configurable:!0}),r.prototype.canRemoveDevice=function(e){if(this.isUpdate){if(this.suspended)return!1;var t=this.grantedRemoveDevice;if(!t)return!1;var i=!e||e.hotRemoveSupported;return!(this.poweredOn&&!i)}if(this.isClone){var t=this.grantedRemoveDevice;return t}return!0},r.prototype.getVideoCardOption=function(){var e=this.getVirtualDeviceOption();if(!e)return null;var t=function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualVideoCard"===e.type.name},i=_.find(e,t),r=i;return r},Object.defineProperty(r.prototype,"configTarget",{get:function(){var e=this.environment.configTarget;return e},enumerable:!0,configurable:!0}),r.prototype.getGpuProfileList=function(){var e=this.configTarget.sharedGpuPassthroughTypes;return e},r.prototype.getSerialPortList=function(){var e=this.configTarget.serial;return e||(e=[]),e},r.prototype.getPciPassList=function(){var e=this.configTarget.pciPassthrough;return e},r.prototype.getVirtualDeviceOption=function(){return this.environment&&this.environment.configOption?this.environment.configOption.hardwareOptions.virtualDeviceOption:[]},Object.defineProperty(r.prototype,"poweredOn",{get:function(){return"poweredOn"===this.powerState},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"poweredOff",{get:function(){return"poweredOff"===this.powerState},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"suspended",{get:function(){return"suspended"===this.powerState},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isCreate",{get:function(){return this.workflow===e.VmWorkflowMode.CreateMode},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isUpdate",{get:function(){return this.workflow===e.VmWorkflowMode.UpdateMode},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"isClone",{get:function(){return this.workflow===e.VmWorkflowMode.CloneMode},enumerable:!0,configurable:!0}),r.prototype.isEditDeviceDisabled=function(e){void 0===e&&(e=!1);var t=!0,i=!1;if(this.isCreate)return i;if(this.isUpdate){if(!this.grantedEditDevice)return t;if(this.poweredOff)return i;if(this.suspended)return t;if(this.poweredOn)return e?i:t}return this.grantedEditDevice?i:t},r.prototype.memoryUnderReserved=function(){if(!this.config)return!1;if(!this.config.memoryAllocation)return!0;var e=this.config.memoryAllocation,t=this.config.hardware.memoryMB;return t>e.reservation},r.prototype.getVmCaps=function(){return this.environment&&this.environment.configOption?this.environment.configOption.capabilities:{}},Object.defineProperty(r.prototype,"memoryMB",{get:function(){return this.config.hardware.memoryMB},set:function(e){this.config.hardware.memoryMB=e},enumerable:!0,configurable:!0}),r.prototype.validateMemoryMB=function(e){var t={error:"",valid:!0};if(!e)return t;if(!1===this.isCreate&&this.originalRAM===e)return t;var i=this.getGuestOsDescriptror();if(i){var r=i.supportedMaxMemMB;if(e>r){var n=this.i18n("VmMemory.GuestMaxError");return n+=" "+i.fullName,{error:n,valid:!1}}}if(!0===this.isEfiConfigured())return t;if(e>this.BIOS_LIMIT_MB){var o=this.i18n("VmMemory.BiosMaxError");return{error:o,valid:!1}}return t},r.prototype.getMemoryRecommendations=function(){var e=this.getGuestOsDescriptror();if(!e)return[];var t=this.i18n("VmMemory.MB"),i=this.i18n("VmMemory.GB"),r=this.i18n("VmMemory.GuestOSmax"),n=this.i18n("VmMemory.GuestOSmin"),o=function(e){if(e>1024){var r=e/1024;return r.toString()+" "+i}return e.toString()+t},a=e.supportedMinMemMB,s=e.supportedMaxMemMB,c=[{name:e.fullName,value:this.memoryMB,formattedValue:" "},{name:r,value:s,formattedValue:o(s)},{name:n,value:a,formattedValue:o(a)}];return c},r.prototype.reserveAllMemory=function(){if(this.config){this.config.memoryAllocation||(this.config.memoryAllocation=new i);var e=this.config.memoryAllocation,t=this.config.hardware.memoryMB;e.reservation=t,this.getVmCaps().memoryReservationLockSupported&&(this.config.memoryReservationLockedToMax=!0)}},r.prototype.canReserveAllMemory=function(){if(this.isUpdate){var i=t.hasPrivileges(this.vmConfigContext.privileges,[e.Privileges.VM_CONFIG_SETTINGS]);return!!i}return!!this.isCreate||(this.isClone,!0)},Object.defineProperty(r.prototype,"cpu",{get:function(){var e=this.config.hardware.numCPU;return e},enumerable:!0,configurable:!0}),r.prototype.getBiosCpuLimit=function(){return r.ONE_TWENTY_EIGHT},r.prototype.isBigCpu=function(){return this.cpu>r.ONE_TWENTY_EIGHT},r.prototype.isCpuHotplugError=function(e){if(!this.isUpdate)return!1;if(!1===this.poweredOn)return!1;var t=e.hardware.numCPU;return this.cpu!==t&&(!(t>this.getBiosCpuLimit())&&this.cpu>this.getBiosCpuLimit())},r.prototype.isCpuFirmwareError=function(){return!this.isEfiConfigured()&&this.cpu>this.getBiosCpuLimit()},Object.defineProperty(r.prototype,"firmware",{get:function(){var e=this.config.firmware;return e},enumerable:!0,configurable:!0}),r.prototype.afterFirmwareChanged=function(){var e=this.cpu;e>this.getBiosCpuLimit()&&this.ensureBigCpu()},r.prototype.isFirmwareLocked=function(){var e=this.isEfiConfigured()&&this.isEfiRequired();return e},r.prototype.isEfiRequired=function(){var e=this.cpu;return e>this.getBiosCpuLimit()||this.memoryMB>this.BIOS_LIMIT_MB},r.prototype.configureEfi=function(){this.config.firmware=this.FIRMWARE_EFI},r.prototype.isEfiConfigured=function(){return this.firmware===this.FIRMWARE_EFI},Object.defineProperty(r.prototype,"vvtd",{get:function(){return this.config.flags.vvtdEnabled},set:function(e){this.config.flags.vvtdEnabled=e},enumerable:!0,configurable:!0}),r.prototype.isVvtdEnabled=function(){var e=this.config.flags;return!0===e.vvtdEnabled},r.prototype.isVvtdRequired=function(){var e=this.config.flags;return!(!e||!0!==e.vbsEnabled)||this.cpu>this.getBiosCpuLimit()},r.prototype.isBadPowerState=function(){if(this.isCreate)return!1;if(this.isClone)return!1;if(this.isUpdate){if(this.poweredOn)return!0;if(this.suspended)return!0}return!1},r.prototype.isBadUser=function(){return!this.isCreate&&(!this.isClone&&!(!this.isUpdate||!1!==this.grantedConfigSettings))},r.prototype.isConfigReadonly=function(){return!!this.isBadPowerState()||!!this.isBadUser()},r.prototype.isVvtdReadonly=function(){return!(!this.isVvtdEnabled()||!this.isVvtdRequired())||!!this.isConfigReadonly()},r.prototype.isVvtdEnforced=function(){return this.isVvtdEnabled()&&this.isVvtdRequired(),!0},r.prototype.isVbsConfigured=function(){if(!this.config)return!1;var e=this.config.flags;return!!e&&!0===e.vbsEnabled},r.prototype.whyVvtdRequired=function(){var e=this.isBigCpu(),t=this.isVbsConfigured();if(!e&&!t)return"";var i=this.i18n("VmCpu.iommu.DescriptionCpu128"),r=this.i18n("VmCpu.iommu.Description"),n=r+"<br>"+i;return e&&t?n:e?i:t?r:""},r.prototype.enableVvtd=function(){var e=this.config.flags;e.vvtdEnabled=!0},r.prototype.afterCpuChange=function(){var e=this.cpu;e>this.getBiosCpuLimit()&&this.ensureBigCpu()},r.prototype.firmwareDoesNotSupportBigCpu=function(){return!this.isEfiConfigured()},r.prototype.ensureBigCpu=function(){var e=!1,t=!1;if(this.isUpdate){if(!this.poweredOff)return;if(this.firmwareDoesNotSupportBigCpu())return}this.isClone&&this.firmwareDoesNotSupportBigCpu()||(this.isCreate&&!1===this.isEfiConfigured()&&(this.configureEfi(),e=!0),!1===this.isVvtdEnabled()&&(this.enableVvtd(),t=!0),e&&t?this.showI18nMsg("VmCpu.EFI_VVTD_FORCED"):e?this.showI18nMsg("VmCpu.EFI_FORCED"):t&&this.showI18nMsg("VmCpu.VVTD_FORCED"))},r.prototype.showI18nMsg=function(e){var t=this.i18n(e);this.showMsg&&this.showMsg(t)},r.prototype.getPciPassthoughOption=function(){var e=this.getVirtualDeviceOption();if(!e)return null;var t="com.vmware.vim.binding.vim.vm.device.",i=t+"VirtualPCIPassthrough",r=function(e){return e.type.name===i},n=_.find(e,r),o=n;return o},r.prototype.getDeviceOption=function(e){if(!e)return null;var t=e._type,i=this.getVirtualDeviceOption();if(!i)return null;for(var r=0,n=i;r<n.length;r++){var o=n[r];if(o){var a=o.type.typeClass;if(a===t)return o}}return null},r.prototype.remove=function(e){this.removeDevice&&this.removeDevice(e)},r.prototype.deviceRemoveEnabled=function(e){if(void 0===e&&(e=!1),this.isCreate)return!0;if(this.isUpdate){if(!1===this.grantedRemoveDevice)return!1;if(this.poweredOff)return!0;if(this.suspended)return!1;if(this.poweredOn)return e}else if(this.isClone&&!1===this.grantedRemoveDevice)return!1;return!0},r.prototype.isConnectDeviceDisabled=function(){if(this.isCreate)return!1;if(this.isUpdate){if(!this.grantedDeviceConnection)return!0;if(this.suspended)return!0}else if(this.isClone)return!this.grantedDeviceConnection;return!1},r.prototype.debugPermissions=function(e){this.privileges=e},r.prototype.debugNoPermissions=function(){this.privileges=[]},r.prototype.debugPowerState=function(e){this.powerState=e},r.prototype.debugPoweredOff=function(){this.debugPowerState(e.PowerState.POWERED_OFF)},r.prototype.debugPoweredOn=function(){this.debugPowerState(e.PowerState.POWERED_ON)},r.prototype.debugSuspended=function(){this.debugPowerState(e.PowerState.SUSPENDED)},r.prototype.debugWorkflow=function(e){this.workflow=e},r.prototype.debugCloneVm=function(){this.debugWorkflow(e.VmWorkflowMode.CloneMode)},r.prototype.debugNewVm=function(){this.debugWorkflow(e.VmWorkflowMode.CreateMode)},r.prototype.debugEditVm=function(){this.debugWorkflow(e.VmWorkflowMode.UpdateMode)},r.ONE_TWENTY_EIGHT=128,r}();e.VmConfig=r}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").directive("vmEditSettings",[function(){return{templateUrl:"vm-ui/resources/vm/views/settings/vmEditSettings.html",restrict:"AE",controller:"VmEditSettingsController",controllerAs:"vmEditSettingsController"}}]),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){
p=new Map,e.deployVmtx=!1,e.loading=!0,e.modalOptions?l():e.vmParams.getCreationType()===r.CLONE_VM_TO_VM||e.vmParams.getCreationType()===r.CLONE_TEMPLATE_TO_VM||e.vmParams.getCreationType()===r.DEPLOY_VM_FROM_VMTX?(d(),e.deployVmtx=e.vmParams.getCreationType()===r.DEPLOY_VM_FROM_VMTX):c()}function c(){o.getAndFormatData(e.vmParams,e.wizardViewData).then(u)}function l(){e.startEditSettings=Date.now();var t=e.modalOptions.availableTargets[0];e.vmId=t,n.getAndFormatData(t).then(function(e){u(e.hardwareConfigPromise)})}function d(){a.getAndFormatData(e.vmParams,e.wizardViewData).then(u)}function u(r){var n=function(e){window&&window.console&&window.console.log&&window.console.log(e)};e.endEditSettings=Date.now(),n("Edit VM Settings blocking data loading took "+(e.endEditSettings-e.startEditSettings)+"ms"),e.loading=!1,e.isInvalid=!1,e.hardwareConfigData=r;var o=r.vmConfigContext,a=o?o.times:null;if(a){n("Java timing "+a.javaTiming);var s=a.javaFinishTime-a.javaStartTime;n("Java total for getVmConfigContext = "+s+"ms")}var c=function(){e.showVmOptions=!0};setTimeout(c,1e3),i(function(){var e=t[0].querySelector("clr-tab-link");e&&e.querySelector("button").focus()},0)}s(),e.isInputStateValid=function(){var t=!0;return t=!e.loading,p.forEach(function(e){t=t&&e}),t},e.$on("onChildValidationChange",function(e,t,i){e.stopPropagation(),p.set(t,i)}),e.$on("editSettingsAlertMessageChanged",function(t,i){t.stopPropagation(),e.alertOptions=i}),e.onTabSelected=function(t){e.alertOptions=void 0};var p}angular.module("com.vmware.vsphere.client.vm").controller("VmEditSettingsController",e),e.$inject=["$scope","$element","$timeout","creationTypeConstants","vmHardwareEditService","vmHardwareCreateService","vmHardwareCloneService"]}(),angular.module("com.vmware.vsphere.client.vm").directive("sharesControl",["$document","i18nService",function(e,t){"use strict";return{templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/sharesControl/sharesControl.html",scope:{sharesInfo:"=",sharesValueMap:"=",shareValueMin:"@",shareValueMax:"@",isDisabled:"=",formInputFieldName:"@",formSelectFieldName:"@",showRecommendations:"=?",sharesAriaLabel:"<?",quantityCaretAriaLabel:"<?",quantityAriaLabel:"<?"},link:function(e,i,r,n){function o(){var t=e.sharesInfo.level;e.properties.selectedSharesLevel=_.find(e.shareInfoLevels,function(e){return e.data===t}),"custom"!==e.sharesInfo.level&&(e.sharesInfo.shares=a(t))}function a(t){if("custom"===t)return e.sharesInfo.shares;var i=e.sharesValueMap[t];if(void 0===i||null===i)throw new Error("Unknown level: ",t);return i}e.i18n=t.getString,e.shareValueMin=parseInt(e.shareValueMin,10),e.shareValueMax=parseInt(e.shareValueMax,10),e.shareValueErrorMessages={max:function(){return e.i18n("Common","SharesControl.RangeError",e.shareValueMin,e.shareValueMax)},min:function(){return e.i18n("Common","SharesControl.RangeError",e.shareValueMin,e.shareValueMax)}},e.shareInfoLevels=[{label:e.i18n("VmUi","sharesInfoLevel.low"),data:"low"},{label:e.i18n("VmUi","sharesInfoLevel.normal"),data:"normal"},{label:e.i18n("VmUi","sharesInfoLevel.high"),data:"high"},{label:e.i18n("VmUi","sharesInfoLevel.custom"),data:"custom"}],e.showRecommendations=!angular.isDefined(e.showRecommendations)||e.showRecommendations,e.showRecommendations&&(e.shareInfoValues=[{value:e.shareValueMin,name:"Minimum"},{value:e.shareValueMax,name:"Maximum"}]),e.properties={selectedSharesLevel:_.find(e.shareInfoLevels,function(t){return e.sharesInfo&&t.data===e.sharesInfo.level})},e.$watch("properties.selectedSharesLevel",function(t){t&&(e.sharesInfo.level=t.data,e.isShareLevelCustom="custom"===e.sharesInfo.level,o())}),e.$watch("sharesValueMap",function(e){e&&o()},!0)}}}]),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareCdrom",["i18nService","vcH5ConstantsService","vmDeviceInfoService","selectIsoFileService","vmHardwareCdromManagerService","defaultUriSchemeUtil","datastoreBrowserTreeService","datastoreBrowserConstants","contentLibraryIsoSelectorModalService","logService",function(e,t,i,r,n,o,a,s,c,l){var d=l("vmHardwareCdrom");return{scope:{inflatedDevice:"=",vmConfigContext:"=",virtualMachineDevicesNeededForControllerAndNode:"=",mergedInflatedDevices:"=",removeCallback:"&",createMode:"=",computeResourceId:"@",expanded:"=",vmId:"="},require:"^form",templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCdrom/vmHardwareCdrom.html",link:{pre:function(l,u,p,v){function m(e){var t=f();t&&t.$setValidity(S(),e)}function g(e){if(_.isEmpty(e))l.errors.isoError=D.fileMissing,m(!1);else{var t=o.getVsphereObjectId(l.vmConfigContext.environment.datastoreBrowser),i=s.fileQueryType.ISO_IMAGE;a.isFileExists(t,e,i).then(function(t){l.errors.isoError=t?D.noError:D.fileDoesNotExists,m(t),t&&(l.device.backing=n.createIsoBacking(e,l.device.backing.datastore,l.device.backing.backingObjectId))})}}function h(){var e=f();e&&!e.$validators[S()]&&(e.$validators[S()]=function(e,t){return!0})}function f(){var e="vmHardwareCdRomForm"+l.inflatedDevice.getKey(),t="editCdrom"+l.inflatedDevice.getKey()+"BackingFileName";return l.formCtrl[e]&&l.formCtrl[e][t]}function S(){return"isoValidator"+l.inflatedDevice.getKey()}function y(e){n.isDatastoreISOFile(e)?l.previousDatastoreISOSelection=l.device.backing.fileName:n.isContentLibraryISOFile(e)&&(l.previousContentLibraryISOSelection=l.device.backing.fileName)}function P(e){var t=[];return _.isEmpty(e)||(t=e.slice(0)),t}l.device=l.inflatedDevice.getCurrentDevice(),l.formCtrl=v,l.i18n=e.getString;var C=P(l.vmConfigContext.environment.configTarget.cdRom);n.hasHostDevicebacking(l.device)&&!n.isDevicePresentInTheHost(l.device.backing.deviceName,C)&&C.push({name:l.device.backing.deviceName}),l.cdromList=n.createCdromList(C);var D={noError:{isVisible:!1},fileMissing:{isVisible:!0,message:l.i18n("VmUi","CdromPage.FileRequired")},fileDoesNotExists:{isVisible:!0,message:l.i18n("VmUi","AsyncFileValidator.NotFound")}};if(l.errors={isoError:D.fileMissing,isoErrorForCL:D.noError},l.controllerSelectorName="editCdrom"+l.inflatedDevice.getKey()+"Controller",l.controllerNodeSelectorName="editCdrom"+l.inflatedDevice.getKey()+"ControllerNode",l.isVmPoweredOn="poweredOn"===l.vmConfigContext.environment.powerState,l.isNewCdDvdDrive=l.inflatedDevice.isNew(),l.skipPermissionCheck=l.isNewCdDvdDrive||l.createMode,l.availableDeviceModes=n.getAvailableDeviceModes(),l.properties={deviceMode:n.getInitialDeviceMode(l.device.backing._type),startConnected:l.device.connectable.startConnected,connected:l.device.connectable.connected,controllerNode:null},n.getAvailableMediaTypes(l.cdromList,l.vmId?l.vmId:l.computeResourceId).then(function(e){return l.availableMediaTypes=e,n.getInitialMediaType(l.device.backing,l.availableMediaTypes)}).then(function(e){l.properties.mediaType=e.mediaType,l.properties.selectedIsoItem=e.selectedIsoItem,l.$watchGroup(["properties.mediaType","device.backing.fileName"],function(e,t){if(!_.isEqual(e,t)){var i=e[0];l.validateCdDrive(i)}}),l.$watch("properties.mediaType",function(e,t){if(!_.isEqual(e,t))if(l.properties.startConnected=!1,l.properties.connected=!1,y(t),n.isDatastoreISOFile(e))l.previousDatastoreISOSelection?l.device.backing.fileName=l.previousDatastoreISOSelection:l.browseForDatastoreIso(),l.$evalAsync(h);else if(n.isContentLibraryISOFile(e))l.previousContentLibraryISOSelection?l.device.backing.fileName=l.previousContentLibraryISOSelection:l.browseForContentLibraryIso();else{var i=n.getNewDeviceBacking(l.properties);l.device.backing=i}})},function(e){d.error(e)}),l.device.backing.deviceName&&(l.properties.selectedCdrom=_.find(l.cdromList,function(e){return e.name===l.device.backing.deviceName})),l.availableControllers=i.availableControllersForDevice(l.inflatedDevice,l.virtualMachineDevicesNeededForControllerAndNode.getAllDevicesNotMarkedForRemoval()),l.properties.controller=_.find(l.availableControllers,function(e){return e.getKey()===l.device.controllerKey}),!l.properties.controller)throw new Error("Could not find controller for device: ",l.inflatedDevice.getKey());l.validateCdDrive=function(e){if(n.isContentLibraryISOFile(e))m(!0),l.properties.selectedIsoItem&&(l.device.backing=n.createIsoBacking(l.properties.selectedIsoItem.isoPath,l.device.backing.datastore,l.device.backing.backingObjectId));else if(n.isDatastoreISOFile(e)){if(l.inflatedDevice.isMarkedForRemoval())return void m(!0);m(!1),w()}else m(!0)},l.hasEditCdRomError=function(){var e=f();return!!e&&e.$invalid},l.shouldRemoveDeviceBeDisabled=function(){if(!l.createMode&&!n.hasPrivileges(l.vmConfigContext.privileges))return!0;if(l.isVmPoweredOn){var e=i.optionForDevice(l.vmConfigContext,l.inflatedDevice,l.virtualMachineDevicesNeededForControllerAndNode.getAllDevicesNotMarkedForRemoval());return!e.hotRemoveSupported}return!1},l.onCdRomRemoval=function(){!l.shouldRemoveDeviceBeDisabled()&&l.removeCallback&&(l.removeCallback()(l.inflatedDevice),m(!0))},l.onRevertRemoval=function(){l.inflatedDevice&&(l.inflatedDevice.revertRemoval(),l.validateCdDrive(l.properties.mediaType))},l.browseForDatastoreIso=function(){r.display(l)},l.browseForContentLibraryIso=function(){c.openContentLibraryIsoSelector(l.computeResourceId,l.properties.selectedIsoItem,function(e){l.properties.selectedIsoItem=e,l.device.backing.fileName=l.properties.selectedIsoItem.isoPath,l.errors.isoErrorForCL=D.noError},function(){l.properties&&l.properties.selectedIsoItem||(l.errors.isoErrorForCL=D.fileMissing)})},l.isDatastoreISOFile=function(){return n.isDatastoreISOFile(l.properties.mediaType)},l.isContentLibraryISOFile=function(){return n.isContentLibraryISOFile(l.properties.mediaType)},l.isHostDevice=function(){return n.isHostDevice(l.properties.mediaType)},l.isClientDevice=function(){return n.isClientDevice(l.properties.mediaType)},l.isRemoteDevice=function(){var e=l.inflatedDevice.getCurrentDevice();return n.isRemoteDevice(e.backing)},l.$watchGroup(["properties.startConnected","properties.connected"],function(e){l.device.connectable.startConnected=e[0],l.device.connectable.connected=e[1]}),l.$watch("properties.deviceMode",function(e){if(n.isClientDevice(l.properties.mediaType)){var t=n.createClientDeviceBacking(e);l.device.backing=t}}),l.onControllerNodeChanged=function(e,t){t&&(l.device.unitNumber=t.key)},l.onCdRomChanged=function(e){l.device.backing.deviceName=e},l.isCdRomDisabled=function(){return n.isCdRomDisabled(l.vmConfigContext.privileges,l.skipPermissionCheck)},l.isCdRomConnectedAtPowerOnDisabled=function(){return n.isCdRomConnectedAtPowerOnDisabled(l.properties.mediaType,l.vmConfigContext.privileges,l.skipPermissionCheck)},l.isCdRomConnectedDisabled=function(){var e=l.inflatedDevice.getCurrentDevice();return n.isCdRomConnectedDisabled(e.backing,l.vmConfigContext.privileges,l.skipPermissionCheck)},l.isDeviceModeDisabled=function(){return n.isDeviceModeDisabled(l.properties.mediaType,l.vmConfigContext.privileges,l.skipPermissionCheck)},l.hasError=function(){var e="vmHardwareCdRomForm"+l.inflatedDevice.getKey();return l.formCtrl[e].$invalid||l.isHostDeviceBackingInvalid()},l.isHostDeviceBackingInvalid=function(){return!(!n.hasHostDevicebacking(l.device)||n.isDevicePresentInTheHost(l.device.backing.deviceName,l.vmConfigContext.environment.configTarget.cdRom))},l.getCdRomLabel=function(e){return n.isDevicePresentInTheHost(e,l.vmConfigContext.environment.configTarget.cdRom)?e:e+" ("+l.i18n("VmUi","CdromPage.DeviceNotAvailable")+")"};var w=_.debounce(function(){g(l.device.backing.fileName)},t.CHANGELOG_REFRESH_DELAY),b=function(t,i){return i||(i="CdromPage"),e.getString("VmUi",i+"."+t)};l.ARIA_LBL_MEDIA_TYPE=b("MediaType"),l.ARIA_LBL_CONNECTED=b("Connected"),l.ARIA_LBL_START_CONNECTED=b("ConnectAtPowerOn","ConnectDevice"),l.ARIA_LBL_MODE=b("DeviceMode"),l.ARIA_LBL_FILE=b("Media"),l.ARIA_LBL_BROWSE=b("Browse"),l.ARIA_LBL_HOST=b("HostDevice","CdromConfig")}}}}]);var h5_vm;!function(e){var t=e.Privileges,i=e.VmWorkflowMode,r=e.DeviceTypeConstants,n=function(){function n(e,t,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C){var D=this;this.$scope=e,this.$document=t,this.creationTypeConstants=r,this.cpuService=n,this.guestOsService=o,this.vmDeviceInfoService=a,this.vmHardwareUtil=s,this.vmHardwareEditService=c,this.vmDeviceManagementService=l,this.i18nService=d,this.defaultUriSchemeUtil=u,this.vmEditSettingsDatastoreRecommendationService=p,this.storageProfileService=v,this.dataService=m,this.$q=g,this.vmHardwareDeviceMenuService=h,this.nvdimmProvisioningService=f,this.vmCryptUtilService=S,this.tpmProvisioningService=y,this.virtualDiskSettingsFormService=P,this.basicDiskUtilService=C,this.PCI_CONTROLLER_TYPE="com.vmware.vim.binding.vim.vm.device.VirtualPCIController",this.NVME_CONTROLLER_TYPE="com.vmware.vim.binding.vim.vm.device.VirtualNVMEController",this.VM_STORAGE_PROFILE_ASSIGNMENTS_PROPERTY="vmStorageProfileAssignments",this.VM_REPLICATION_GROUP_ASSIGNMENTS_PROPERTY="vmReplicationGroupAssignments",this.VM_HOST_PROPERTY="host",this.TPM_VIEW_ID="TPM_VIEW_ID",this.ON_CHILD_CHANGE_EVENT="onChildValidationChange",this.MAX_SOLO_HARD_DISK_COUNT=4,this.maxPciDevicesControllers=32,this.maxEthernetCards=10,this.maxPCIPassthrough=6,this.pciEthernetCount=0,this.keepExistingProfileAssignments=!1,this.totalHardDiskSizeText="",this.hardDiskStackBlockClicked=!1,this.isGroupingHardDisks=!1,this.removeDevice=function(e){D.removeDeviceInternal(e)},this.$scope.config=this.$scope.config||{},this.$scope.config.loading=!0,this.isInvalid=!1,this.iconForDevice=this.vmDeviceInfoService.iconForDevice,this.storageLocatorItemsData=this.$scope.storageLocatorItemsData,this.isXVc=this.$scope.vmParams&&this.$scope.vmParams.isXvc(),this.canAddDevice=!0,this.banner={},this.deployVmtxMode=!1,this.stackBlocksExpandedState=this.$scope.customizeHardwarePageModel?this.$scope.customizeHardwarePageModel.getStackBlocksExpandedState():{virtualDevices:[]};var w;this.$scope.modalOptions?(this.setupForEditMode(),w=function(e){D.notifyValidationChange(!e),D.isInvalid=e}):e.vmParams.getCreationType()===r.CLONE_VM_TO_VM||e.vmParams.getCreationType()===r.CLONE_TEMPLATE_TO_VM||this.$scope.vmParams.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_VMTX?(this.deployVmtxMode=this.$scope.vmParams.getCreationType()===this.creationTypeConstants.DEPLOY_VM_FROM_VMTX,this.setupForCloneMode(),w=function(t){D.notifyValidationChange(!t),e.customizeHardwarePageModel.setFormValidity(!t)}):(this.setupForCreate(),w=function(t){D.notifyValidationChange(!t),e.customizeHardwarePageModel.setFormValidity(!t)}),e.$watch("hardwareForm.$invalid",w,!0),this.addDevicesMenuConfig=this.vmHardwareDeviceMenuService.getAddDevicesMenuConfig(function(e,t){D.addDevice(e,t)}),this.createMode=this.vmWorkflowMode===i.CreateMode,this.cloneMode=this.vmWorkflowMode===i.CloneMode,this.pciEthernetCount=0,this.virtualEthernetCard&&(this.pciEthernetCount=this.virtualEthernetCard.length);var b=function(e){D.hideAddDevicesMenu(e)};this.$document.on("click",b),this.$scope.$on("$destroy",function(){D.$document.off("click",b)}),this.removeDevice=function(e){D.removeDeviceInternal(e)}}return n.prototype.updateActionDefsForAddDeviceMenu=function(e){e=e?e:[],this.vmWorkflowMode!==i.UpdateMode||this.showNewNvidmmMenu()||e.push("addNewNvdimmAction"),this.addDeviceActionDefs=this.vmHardwareDeviceMenuService.getAddDeviceActions(this.vmConfigContext.privileges,this.vmWorkflowMode,e)},n.prototype.removeDeviceInternal=function(e){var t=this,i=e.getKey();this.virtualMachineDevices.removeDeviceByKey(i),this.$scope.$broadcast("deviceRemoved",{deviceKey:e.getKey(),deviceType:e.getCurrentDevice()._type}),this.vmDeviceInfoService.isDeviceSubclassOf(e.getCurrentDevice(),"VirtualTPM")&&(this.shouldAllowAddTpmAction().then(function(e){e?t.updateActionDefsForAddDeviceMenu():t.updateActionDefsForAddDeviceMenu(["addNewTpmAction"])}),this.$scope.$emit(this.ON_CHILD_CHANGE_EVENT,this.TPM_VIEW_ID,!0)),_.isUndefined(this.stackBlocksExpandedState.virtualDevices[i])||delete this.stackBlocksExpandedState.virtualDevices[i]},n.prototype.getNewDevices=function(e){return this.virtualMachineDevices.newDevicesOfType(e)},n.prototype.isThereNewSATA=function(){return this.virtualMachineDevices.newDevicesOfType(r.VIRTUAL_SATA_CONTROLLER).length>0},n.prototype.toggleAddDevicesMenu=function(){this.addDevicesMenuConfig.showMenu=!this.addDevicesMenuConfig.showMenu,this.addDevicesMenuConfig.showMenu&&(this.addDevicesMenuConfig.menuItems=this.vmHardwareDeviceMenuService.getAddDeviceMenuItems(this.addDeviceActionDefs))},n.prototype.getUSBControllerList=function(){var e=[],t=this.virtualMachineDevices.existingDevicesOfType(r.VIRTUAL_USB_CONTROLLER),i=this.virtualMachineDevices.existingDevicesOfType(r.VIRTUAL_USB_XHCI_CONRTOLLER),n=this.virtualMachineDevices.newDevicesOfType(r.VIRTUAL_USB_CONTROLLER),o=this.virtualMachineDevices.newDevicesOfType(r.VIRTUAL_USB_XHCI_CONRTOLLER);return e=e.concat(t).concat(i).concat(n).concat(o)},n.prototype.getTpmList=function(){var e=this.getExistingAndNewDevices("VirtualTPM");return e},n.prototype.getExistingAndNewDevices=function(e){var t=[],i=this.virtualMachineDevices.existingDevicesOfType(e),r=this.virtualMachineDevices.newDevicesOfType(e);return t=t.concat(i).concat(r)},n.prototype.getUSBDeviceList=function(){var e=this.getExistingAndNewDevices(r.VIRTUAL_USB);return e},n.prototype.getInflatedVideoCard=function(){var e=this.getExistingAndNewDevices(r.VIDEO_CARD);if(!e||e.length<1)return null;var t=e[0];return t.attachVmConfig(this.vmConfig),t},n.prototype.getPciSharedList=function(){return this.getPciDeviceList(!0)},n.prototype.getPciDeviceList=function(e){void 0===e&&(e=!1);for(var t=this.getExistingAndNewDevices(r.VirtualPCIPassthrough),i=[],n=0,o=t;n<o.length;n++){var a=o[n],s=a,c=s.isSharedPCIBackingType();c===e&&(s.attachVmConfig(this.vmConfig),s.removeCallback=this.removeDevice,i.push(a))}return i},n.prototype.isDiskGroupingRequired=function(){return this.isGroupingHardDisks},n.prototype.hardDisksStackClicked=function(){this.hardDiskStackBlockClicked=!this.hardDiskStackBlockClicked},Object.defineProperty(n.prototype,"hardDisksStackExpanded",{get:function(){return this.hardDiskStackBlockClicked},enumerable:!0,configurable:!0}),n.prototype.isAddDeviceMenuEnabled=function(){return!this.isEditingSuspendedVM()&&!this.deployVmtxMode&&(0===this.addDevicesMenuConfig.menuItems.length&&(this.addDevicesMenuConfig.menuItems=this.vmHardwareDeviceMenuService.getAddDeviceMenuItems(this.addDeviceActionDefs)),this.vmHardwareDeviceMenuService.isAddDeviceMenuEnabled(this.addDevicesMenuConfig.menuItems))},n.prototype.isEditingSuspendedVM=function(){return this.vmWorkflowMode===i.UpdateMode&&e.VmHardwareUtil.isSuspended(this.vmConfigContext)},n.prototype.notifyValidationChange=function(e){this.$scope.$emit("onChildValidationChange",this,e)},n.prototype.isRDMDisk=function(e){return e.isRDMDisk()},n.prototype.isNotRDMDisk=function(e){return!e.isRDMDisk()},n.prototype.checkPciLimit=function(){this.pciEthernetCount>=this.maxEthernetCards?(this.showError(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached")),this.canAddDevice=!1):(this.clearError(),this.canAddDevice=!0)},n.prototype.emitInfo=function(e){this.$scope.$emit("editSettingsAlertMessageChanged",e)},n.prototype.showInfo=function(e){var t={isVisible:!0,"class":"info-standard",iconShape:"info-standard",text:e};this.emitInfo(t)},n.prototype.showError=function(e){var t=[{text:e,type:"error"}];this.$scope.config&&this.$scope.config.validationBanner?this.$scope.config.validationBanner.messages=t:this.banner.messages=t},n.prototype.clearError=function(){this.$scope.config&&this.$scope.config.validationBanner?this.$scope.config.validationBanner.messages=[]:this.banner.messages=[]},n.prototype.updatePciCounter=function(){var e=this;this.virtualControllers=this.virtualMachineDevices.existingDevicesOfType(r.VIRTUAL_CONTROLLER),this.changeDevices=this.virtualMachineDevices.getDeviceChanges(),this.virtualEthernetCard&&(this.pciEthernetCount=this.virtualEthernetCard.length),this.changeDevices.forEach(function(t){if(e.vmHardwareUtil.isEthernetDevice(t)){var i=t.operation;"add"===i?e.pciEthernetCount++:"remove"===i&&e.pciEthernetCount--}})},n.prototype.showErrorByDeviceType=function(e){return e===r.VIRTUAL_USB&&this.showErrorForUsb()},n.prototype.showErrorForUsb=function(){return!!e.VmHardwareUsbControllerUtil.areBothUSBControllerMarkedForRemoval(this.virtualMachineDevices)&&(this.showError(this.i18nService.getString("VmUi","VmDeviceManager.BothUSBControllersMarkedForRemoval")),!0)},n.prototype.addDevice=function(e,t){var i=this;this.clearError();var n=this.addDeviceActionDefs[t.id].deviceType,o={};if(n!==r.VIRTUALDISK&&n!==r.RDMDISK&&n!==r.EXISTINGHARDDISK||(o.selectedStorageProfile=this.selectedStorageProfile,o.selectedReplicationGroupInfo=this.selectedReplicationGroupInfo),"VirtualTPM"===n&&(this.addDeviceActionDefs=this.vmHardwareDeviceMenuService.getAddDeviceActions(this.vmConfigContext.privileges,this.vmWorkflowMode,["addNewTpmAction"]),o.serverGuid=this.getServerGuid(),o.callback=function(e){e.state!==e.NOT_CONNECTED&&e.state!==e.CONNECTING||(i.$scope.$emit(i.ON_CHILD_CHANGE_EVENT,i.TPM_VIEW_ID,!1),i.$scope.customizeHardwarePageModel&&i.$scope.customizeHardwarePageModel.setFormValidity(!1))}),n===r.ETHERNET&&(this.updatePciCounter(),this.checkPciLimit()),!this.showErrorByDeviceType(n)&&("VirtualNVDIMM"===n&&this.populateAdditionalParametersForNvdimm(o),n===r.EXISTINGHARDDISK&&(o.vmConfigContext=this.vmConfigContext,o.serverGuid=this.getServerGuid(),o.storageProfiles=this.storageProfiles),this.canAddDevice))try{this.vmDeviceManagementService.createNewDevice(n,this.vmConfigContext.environment,this.getGuestOsDescriptor(),this.virtualMachineDevices,o).then(function(e){var t=e.newDeviceKey?e.newDeviceKey:e;if(e.newVmProfile){if(i.$scope.vmParams&&(i.$scope.vmParams.setSelectedStorageProfile(e.newVmProfile),i.selectedStorageProfile=e.newVmProfile,i.$scope.vmParams.getStorageSelectorState())){var r=i.$scope.vmParams.getStorageSelectorState();r.basicModeState&&r.basicModeState.profilesData&&(r.basicModeState.profilesData.selectedProfile=e.newVmProfile)}i.$scope.$broadcast("vmHomeStorageProfileChanged",e.newVmProfile)}i.$scope.$broadcast("deviceAdded",{deviceKey:t,deviceType:n}),i.stackBlocksExpandedState.virtualDevices[t]=!1})}catch(a){this.showError.call(this,a.message)}},n.prototype.getGuestOsDescriptor=function(){var e=this;return this.vmWorkflowMode===i.CreateMode||this.vmWorkflowMode===i.CloneMode?_.find(this.vmConfigContext.environment.configOption.guestOSDescriptor,function(t){return t.id===e.$scope.vmParams.getGosVersion().id}):this.vmConfigContext.environment.configOption.guestOSDescriptor[0]},n.prototype.getServerGuid=function(){return this.vmWorkflowMode===i.CreateMode?this.defaultUriSchemeUtil.getManagedObjectReference(this.$scope.vmParams.getTargetInformation().folderUid).serverGuid:this.defaultUriSchemeUtil.getManagedObjectReference(this.vmId).serverGuid},n.prototype.setupVbsProperties=function(e,t){this.setVbsEnabled(!0,t),t.flags.vvtdEnabled=e["flags.vvtdEnabled"],t.nestedHVEnabled=e.nestedHVEnabled},n.prototype.setVbsEnabled=function(e,t){t.flags.vbsEnabled=e},n.prototype.setupForCreate=function(){var e=this;this.vmWorkflowMode=i.CreateMode,this.$scope.$on("$destroy",function(){e.$scope.config.loading=!1});var t=this.guestOsService.getGuestOsDescriptor(this.$scope.hardwareConfigData.vmConfigContext,this.$scope.vmParams.getGosVersion()),r=angular.extend({},this.$scope.hardwareConfigData,{guestOs:t});this.setup(r),this.storageLocatorItemsData=this.$scope.wizardViewData.getStorageLocatorItemsData(),this.setStorageForDisk=function(t,i){e.$scope.vmParams.setStorageForDisk(t,i)},this.getStorageForDisk=function(t){return e.$scope.vmParams.getStorageForDisk(t)},this.vmStorageId=this.defaultUriSchemeUtil.getVsphereObjectId(this.$scope.vmParams.getStorageObject().storageRef),this.$scope.vmParams.getVbsSupported()&&(this.$scope.vmParams.getVbsEnabled()?this.setupVbsProperties(this.getVbsProperties("flags.vbsEnabled"),this.$scope.vmParams.getVmConfigSpec().config):this.setVbsEnabled(!1,this.$scope.vmParams.getVmConfigSpec().config)),this.computeResourceId=this.$scope.vmParams.getComputeResourceId(),this.$scope.vmParams.getStorageSelectorState()&&(this.storageBaselineId=this.$scope.vmParams.getStorageSelectorState().storageBaselineId)},n.prototype.initializeCpu=function(e){var i=e.privileges.indexOf(t.VM_RESOURCE_PRIVILEGE)>-1;i&&!e.config.cpuAffinity&&(e.config.cpuAffinity={_type:"com.vmware.vim.binding.vim.vm.AffinityInfo",affinitySet:[]}),e.config.cpuFeatureMask||(e.config.cpuFeatureMask=[])},n.prototype.setupForCloneMode=function(){var e=this;this.vmWorkflowMode=i.CloneMode,this.$scope.$on("$destroy",function(){e.$scope.config.loading=!1}),this.vmId=this.$scope.vmParams.getVmId(),this.$scope.vmParams.setCustomizeCloneHardware(!0);var t=this.$scope.hardwareConfigData.vmConfigContext,r=this.guestOsService.getAppropriateGuestOs(t,this.$scope.vmParams.getGosVersion());this.initializeCpu(t);var n=angular.extend({},this.$scope.hardwareConfigData,{guestOs:r});this.setup(n),this.storageLocatorItemsData=this.$scope.wizardViewData.getStorageLocatorItemsData();var o=this.$scope.vmParams.getStorageSelectorState();if(o&&(this.storageBaselineId=o.storageBaselineId,"basicMode"===o.mode&&!_.isEmpty(o.basicModeState)&&!_.isEmpty(o.basicModeState.profilesData)&&!_.isEmpty(o.basicModeState.profilesData.selectedProfile))){var a=o.basicModeState.profilesData.selectedProfile.keepExistingProfileAssignments;this.keepExistingProfileAssignments=!_.isUndefined(a)&&a}this.setStorageForDisk=function(t,i){e.$scope.vmParams.setStorageForDisk(t,i)},this.computeResourceId=this.$scope.vmParams.getComputeResourceId(),this.vmStorageId=this.defaultUriSchemeUtil.getVsphereObjectId(this.$scope.vmParams.getStorageObject().storageRef),this.getStorageForDisk=function(t){return e.$scope.vmParams.getStorageForDisk(t)},this.selectedDiskFormat=this.$scope.vmParams.getDiskFormat()},n.prototype.setupForEditMode=function(){var e=this;this.vmId=this.$scope.modalOptions.availableTargets[0],this.vmWorkflowMode=i.UpdateMode;var t=this.guestOsService.getSelectedGuestOs(this.$scope.hardwareConfigData.vmConfigContext),r=angular.extend({},this.$scope.hardwareConfigData,{guestOs:t});this.isVmPoweredOn="poweredOn"===r.vmConfigContext.environment.powerState;var n=r.vmConfigContext.storageInfo.datastore;this.vmStorageId=n?this.defaultUriSchemeUtil.getVsphereObjectId(n):null,this.setup(r,!0,!1);var o={vmAssignmentsPropertiesRequest:this.vmAssignmentsProperties};this.$q.all(o).then(function(t){var i=t.vmAssignmentsPropertiesRequest;if(i){var r=i.vmStorageProfileAssignments,n=i.vmReplicationGroupAssignments;r&&r.then(function(t){if(t=t.vmStorageProfileAssignments){var i=t.homeStorageProfile;e.selectedStorageProfile={profileObj:i},i&&(e.selectedStorageProfile.id=i.profileId.uniqueId,e.selectedStorageProfile.label=i.name)}}),i.host&&(e.computeResourceId=e.defaultUriSchemeUtil.getVsphereObjectId(i.host)),n?n.then(function(t){t=t.vmReplicationGroupAssignments,e.vmHomeReplicationGroup=e.getVmHomeRg(t)}):e.vmHomeReplicationGroup=null}}),this.$scope.$parent.save=function(){var t=e.vmConfigContext.config,i=e.originalConfig,r=e.virtualMachineDevices,n=e.$scope.modalOptions.title,o=e.vmId,a=e.cpuService.createCpuIdInfoDelta(i.cpuFeatureMask,t.cpuFeatureMask),s=e.vmConfigContext.vmProfile,c={},l=e.vmConfigContext.storageInfo;l.datastore?(c.storageRef=l.datastore,c.parentStoragePod=l.datastoreCluster,c.parentStoragePod&&(c.parentStoragePod.isSdrsEnabled=l.isSdrsEnabledForDsCluster)):l.datastoreCluster?(c.storageRef=l.datastoreCluster,c.storageRef.isSdrsEnabled=l.isSdrsEnabledForDsCluster):c=void 0,e.vmEditSettingsDatastoreRecommendationService.shouldCheckRecommendations(c,r)?e.vmEditSettingsDatastoreRecommendationService.getRecommendations(o,c,r,i,t,a,function(t){if(t){var i=[t.recommendationSpec.key];e.vmHardwareEditService.applyRecommendationAndUpdate(o,i,n),e.$scope.closeModal()}},function(t){var i="";i=t&&t.length>0&&t[0].message?t[0].message:e.i18nService.getString("VmUi","SdrsRecommendations.faults.generic"),e.$scope.$emit("editSettingsAlertMessageChanged",{isVisible:!0,"class":"alert-warning",iconShape:"exclamation-triangle",text:i})}):(e.vmHardwareEditService.update(o,n,i,t,r,a,s),e.$scope.closeModal())}},n.prototype.isVmHomeEncrypted=function(){return!_.isEmpty(this.vmConfigContext)&&this.vmCryptUtilService.isVmHomeEncrypted(this.vmConfigContext)},n.prototype.setup=function(t,i,n){var o=this;void 0===i&&(i=!1),void 0===n&&(n=!0),this.vmConfigContext=t.vmConfigContext,this.originalConfig=t.originalConfig,this.stackBlocksExpandedState=this.buildStackBlockExpandedStateForDevices(this.stackBlocksExpandedState,t.virtualMachineDevices),this.virtualMachineDevices=t.virtualMachineDevices;var a=this.virtualMachineDevices.existingDevicesOfType("VirtualDisk");this.isGroupingHardDisks=a&&a.length>this.MAX_SOLO_HARD_DISK_COUNT;var s=a?a.length:0;if(this.totalHardDiskSizeText=this.i18nService.getString("VmUi","DiskPage.groupedMode.content",s,this.buildTotalHardDiskSizeText(a)),t.storageProfiles)this.storageProfiles=this.$q.when(t.storageProfiles);else{var c=this.defaultUriSchemeUtil.getManagedObjectReference(this.vmId).serverGuid;this.storageProfiles=this.storageProfileService.fetchProfiles(c)}var l={vmStorageProfileAssignments:t.vmStorageProfileAssignments,vmReplicationGroupAssignments:t.vmReplicationGroupAssignments,host:t.host};if(this.vmAssignmentsProperties=this.$q.when(l),this.vmId){var d=[];l.vmStorageProfileAssignments||d.push(this.VM_STORAGE_PROFILE_ASSIGNMENTS_PROPERTY),l.vmReplicationGroupAssignments||d.push(this.VM_REPLICATION_GROUP_ASSIGNMENTS_PROPERTY),i&&!l.host&&d.push(this.VM_HOST_PROPERTY),d.length&&(this.vmAssignmentsProperties=this.dataService.getProperties(this.vmId,d,{skipErrorInterceptor:!0}).then(function(e){return e?{vmStorageProfileAssignments:e[o.VM_STORAGE_PROFILE_ASSIGNMENTS_PROPERTY]||l.vmStorageProfileAssignments,vmReplicationGroupAssignments:e[o.VM_REPLICATION_GROUP_ASSIGNMENTS_PROPERTY]||l.vmReplicationGroupAssignments,host:e[o.VM_HOST_PROPERTY]||l.host}:l})["catch"](function(){}))}t.vmVersion&&(this.vmVersion=t.vmVersion),t.selectedStorageProfile&&(this.selectedStorageProfile=t.selectedStorageProfile,this.vmConfigContext.vmProfile=[this.selectedStorageProfile]),this.getAdvancedConfigurationForDisk=function(e){return o.getAdvancedConfigurationForDiskInternal(e)},t.selectedReplicationGroupInfo&&(this.selectedReplicationGroupInfo=t.selectedReplicationGroupInfo,n&&(this.vmHomeReplicationGroup=this.selectedReplicationGroupInfo)),this.selectedGuestOs=t.guestOs,this.filterNetworksObjId=t.filterNetworksObjId,this.virtualControllers=this.virtualMachineDevices.existingDevicesOfType(r.VIRTUAL_CONTROLLER),this.virtualScsiControllers=this.virtualMachineDevices.existingDevicesOfType(r.SCSICONTROLLER),this.inputDevices=this.virtualMachineDevices.existingDevicesOfType(r.INPUT_DEVICE),this.virtualEthernetCard=this.virtualMachineDevices.existingDevicesOfType(r.ETHERNET),this.pciEthernetCount=this.virtualEthernetCard.length,this.errorConfig={valid:!0,message:""},this.networkProviderId=t.networkProviderId,this.availableNetworks=t.availableNetworks,this.shouldAllowAddTpmAction().then(function(e){e?o.updateActionDefsForAddDeviceMenu():o.updateActionDefsForAddDeviceMenu(["addNewTpmAction"])}),this.controllerOptions=this.vmHardwareUtil.getDeviceOption(this.vmConfigContext,this.PCI_CONTROLLER_TYPE),this.controllerOptions&&(this.maxEthernetCards=this.controllerOptions.numEthernetCards.max,this.maxPCIPassthrough=this.controllerOptions.numPCIPassthroughDevices.max,this.maxPciDevicesControllers=this.controllerOptions.devices.max),this.nvmeDeviceOption=this.vmHardwareUtil.getDeviceOption(this.vmConfigContext,this.NVME_CONTROLLER_TYPE),this.vmConfig=new e.VmConfig(this.vmConfigContext,this.selectedGuestOs,this.vmConfigContext.privileges,this.vmWorkflowMode,this.i18nService,this.removeDevice),this.vmConfig.showMsg=this.showInfo.bind(this),this.$scope.hardwareConfigData.vm=this.vmConfig,
this.$scope.hardwareConfigData.vmConfigContext.selectedGuestOs=this.selectedGuestOs,this.$scope.config.loading=!1},n.prototype.buildTotalHardDiskSizeText=function(e){var t=this;if(!e||e.length<=0)return"";var i=0;_.each(e,function(e){i+=t.virtualDiskSettingsFormService.getCapacityInMB(e.getCurrentDevice())});var r=this.basicDiskUtilService.determineDisplayDiskSize(i);return this.basicDiskUtilService.roundToPrecision(r.size,2).toString()+" "+r.unitText},n.prototype.shouldAllowAddTpmAction=function(){var e=this;return this.tpmProvisioningService.checkDefaultKmsServer(this.getServerGuid()).then(function(i){var r=e.vmHardwareUtil.checkPrivileges(e.vmConfigContext.privileges,[t.CRYPTOGRAPHER_ENCRYPT,t.CRYPTOGRAPHER_ENCRYPT_NEW_VM]);if(i&&i.defaultKmsClusterExists&&r){var n=1,o=e.virtualMachineDevices.devicesOfType("VirtualTPM").length;if(o<n){var a=e.selectedGuestOs?e.selectedGuestOs.recommendedFirmware:void 0,s=!!e.selectedGuestOs&&!!e.selectedGuestOs.supportsTPM20,c=e.vmConfigContext.config.firmware?e.vmConfigContext.config.firmware:a,l="bios"===c,d=!l&&s;return e.$q.when(d)}return e.$q.when(!1)}return e.$q.when(!1)})},n.prototype.getPropertyRelations=function(){return _.reduce(this.vmConfigContext.environment.configOption.propertyRelations,function(e,t){return e[t.key.name]=t.relations,e},{})},n.prototype.getVbsProperties=function(e){return _.reduce(this.getPropertyRelations()[e],function(e,t){return e[t.name]=t.val,e},{})},n.prototype.hideAddDevicesMenu=function(e){this.addDevicesMenuConfig.showMenu&&this.isItAddNewDeviceElement(e.toElement)&&(this.addDevicesMenuConfig.showMenu=!1)},n.prototype.isItAddNewDeviceElement=function(e){return e.innerText.toUpperCase().trim()!==this.i18nService.getString("VmUi","VmDeviceManager.AddNewDevice").toUpperCase()},n.prototype.populateAdditionalParametersForNvdimm=function(e){this.vmWorkflowMode===i.UpdateMode&&(e.vm={powerState:this.vmConfigContext.rtInfo.powerState}),e.vmWorkflow=this.vmWorkflowMode,e.storageProfiles=this.storageProfiles},n.prototype.getAdvancedConfigurationForDiskInternal=function(e){if(this.$scope.vmParams.getIsAdvancedStorageMode()){var t=this.$scope.vmParams.getStorageSelectorState().vmStorageConfigInAdvancedMode[0].vmDisks;return _.find(t,function(t){return t.key===e.getKey()})}},n.prototype.showNewNvidmmMenu=function(){var e=this.vmConfigContext.environment,t={};return this.populateAdditionalParametersForNvdimm(t),this.nvdimmProvisioningService.canAddNvdimm(e,this.getGuestOsDescriptor(),this.virtualMachineDevices,t)},n.prototype.buildStackBlockExpandedStateForDevices=function(e,t){return _.each(t.getAllDevicesNotMarkedForRemoval(),function(t){var i=t.getKey();_.isUndefined(e.virtualDevices[i])&&(e.virtualDevices[i]=!1)}),e},n.prototype.getSortedVirtualDisks=function(){return this.virtualMachineDevices.existingSortedDevicesOfType("VirtualDisk")},n.prototype.getVmHomeRg=function(e){if(!e)return null;for(var t=this.defaultUriSchemeUtil.getManagedObjectReference(this.vmId),i=null,r=0,n=e;r<n.length;r++){var o=n[r];o&&o.vmObjectId===t.value&&(i=o.replicationGroup)}return i},n.prototype.getSerialPortDeviceList=function(){for(var e=this.getExistingAndNewDevices("VirtualSerialPort"),t=0,i=e;t<i.length;t++){var r=i[t];r.attachVmConfig(this.vmConfig)}return e},n.$inject=["$scope","$document","creationTypeConstants","cpuService","guestOsService","vmDeviceInfoService","vmHardwareUtil","vmHardwareEditService","vmDeviceManagementService","i18nService","defaultUriSchemeUtil","vmEditSettingsDatastoreRecommendationService","storageProfileService","dataService","$q","vmHardwareDeviceMenuService","nvdimmProvisioningService","vmCryptUtilService","tpmProvisioningService","virtualDiskSettingsFormService","basicDiskUtilService"],n}();angular.module("com.vmware.vsphere.client.vm").controller("VmHardwareController",n)}(h5_vm||(h5_vm={}));var vm_ui;!function(e){var t=h5_vm.Privileges,i=function(){function e(e){this.vmHardwareUtil=e}return e.prototype.isEditVmHardwareControllerAndNodeDisabled=function(e,t,i){return!e||!e.isNew()&&(!this.vmHardwareUtil.isVmPoweredOff(i)||!this.hasPrivilegesToEdit(t))},e.prototype.hasPrivilegesToEdit=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_EDITDEVICE_PRIVILEGE])},e.$inject=["vmHardwareUtil"],e}();e.VmHardwareControllerAndNodeService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareControllerAndNodeService",i)}(vm_ui||(vm_ui={})),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareControllerAndNode",["i18nService","informationalDialogService","controllerNodeFinderService","vmDeviceInfoService","vmHardwareControllerAndNodeService",function(e,t,i,r,n){function o(e,t){var i,n=e.getCurrentDevice();if(t.isOfType("VirtualCdrom"))i=e.getCdromNodeIndices();else{if(!t.isOfType("VirtualDisk"))throw new Error("Don't know how to determine controller nodes for device"+t.getCurrentDevice());i=e.getDiskNodeIndices()}return _.map(i,function(e){return{name:r.getControllerAndNodeLabelText(n._type,n.busNumber,e),key:e}})}function a(t){var i=function(t){return e.getString("VmUi","DiskPage."+t)};t.ARIA_LBL_CTRL=i("Controller"),t.ARIA_LBL_NODE=i("Node")}return{templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareControllerAndNode/vmHardwareControllerAndNode.html",scope:{inflatedDevice:"=",node:"=",powerState:"=",availableControllers:"=",virtualMachineDevices:"=",selectorName:"=",controllerSelectorName:"=",deviceController:"=",privileges:"=",onControllerChangeCallback:"&"},link:function(r){function s(){r.nodeOptions=c(),r.node=_.find(r.nodeOptions,function(e){return e.key===r.inflatedDevice.getCurrentDevice().unitNumber}),l=r.node}function c(){var e=o(r.deviceController,r.inflatedDevice),t=r.virtualMachineDevices.getDevicesAttachedToControllerKey(r.deviceController.getKey());return _.map(e,function(e){var i=_.find(t,function(t){return e.key===t.unitNumber});return i&&(e.name+=" "+i.deviceInfo.label),e})}r.i18n=e.getString,a(r);var l;r.$watch("virtualMachineDevices.getDeviceChanges()",function(){r.deviceController&&s()},!0),r.$watch(function(){return r.deviceController},function(e,t){e&&e!==t&&s()});var d=r.deviceController;r.onControllerChange=function(n){var a=o(r.deviceController,r.inflatedDevice),c=r.virtualMachineDevices.getDevicesThatHaveBeenAssignedToNodes(),l=i.findNextAvailableNodeForController(n.getKey(),a,c);if(l){var u=r.inflatedDevice.getCurrentDeviceSpec();u.device.unitNumber=l.key,u.device.controllerKey=n.getKey(),d=n,s(),r.onControllerChangeCallback&&r.onControllerChangeCallback({deviceController:r.deviceController,node:r.node})}else{r.deviceController=d;var p=n.getCurrentDevice().deviceInfo.label;t.display({title:p,content:e.getString("VmUi","GenericDevicePage.ControllerTaken",p),width:"300px",height:"150px"})}},r.onControllerNodeChange=function(i){if(i.key!==l.key){var n=r.virtualMachineDevices.isNodeInUse(r.deviceController.getKey(),i.key);n?(t.display({title:[i.name,r.inflatedDevice.getCurrentDevice().deviceInfo.label].join(" "),content:e.getString("VmUi","GenericDevicePage.NodeTaken"),width:"300px",height:"150px"}),r.node=l):(l=i,r.inflatedDevice.getCurrentDevice().unitNumber=i.key,r.onControllerChangeCallback&&r.onControllerChangeCallback({deviceController:r.deviceController,node:r.node}))}},r.disableSelection=function(){return n.isEditVmHardwareControllerAndNodeDisabled(r.inflatedDevice,r.privileges,r.powerState)}}}}]);var h5_vm;!function(e){var t=function(){function e(e){var t=this;this.cpuMmuService=e,this.onChange=function(){t.onCpuMmuChange({selectedOption:t.selectedOption})},this.isCpuMmuDisabled=function(){return t.cpuMmuService.isCpuMmuDisabled(t.vmConfigContext,t.createMode)}}return e.prototype.$onInit=function(){this.cpuMmuOptions=this.cpuMmuService.getCpuMmuOptions(),this.selectedOption=this.cpuMmuService.getCpuMmuCurrentSelection(this.cpuMmuService.getCpuMmuCurrentConfig(this.vmConfigContext))},e.$inject=["cpuMmuOptionService"],e}();e.CpuMmuViewController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuMmu/cpu-mmu-view.html",this.bindings={vmConfigContext:"<",onCpuMmuChange:"&",createMode:"<",ariaLabel:"<?"}}return e}();e.CpuMmuViewComponent=i,angular.module("com.vmware.vsphere.client.vm").component("cpuMmuView",new i)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareCpu",["templateHelperService","i18nService","cpuService","vmHardwareCpuService","vmHardwareUtil","guestOsService","helpService","$injector",function(e,t,i,r,n,o,a,s){return{templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/vmHardwareCpu.html",scope:{createMode:"=",deployVmtxMode:"=",vmWorkflowMode:"=",originalConfig:"=",vm:"<",vmConfigContext:"=",vbsEnabled:"=",expanded:"="},link:{pre:function(c){function l(){c.reservationErrorMessages={max:function(){return c.i18n("VmUi","Util.Validation.ValidRange",c.i18n("VmUi","VmCpu.Label.Reservation"),c.i18n("VmUi","cpuReservationLimit",0),c.i18n("VmUi","cpuReservationLimit",c.reservationMax))}}}function d(){var e=c.i18n("VmUi","VmCpu.MHz"),t=c.i18n("VmUi","VmCpu.GHz");c.reservationUnitOptions=[{label:e,multiplier:1},{label:t,multiplier:1e3}],c.limitUnitOptions=[{label:e,multiplier:1},{label:t,multiplier:1e3}]}function u(){c.sharesInfo=r.setUpSharesInfo(c.vmConfigContext,c.createMode)}function p(e){var t=e.vmConfigContext.config,i=e.i18n("VmUi","VmCpu.Label.CpuHotPlug"),n=r.getAffinityDisplayValue(t.cpuAffinity?t.cpuAffinity.affinitySet:[]),o=r.isCpuIdMaskExposed(e.vmConfigContext)?e.i18n("VmUi","CpuIdMask.exposed"):e.i18n("VmUi","CpuIdMask.hidden");e.fieldValue={NestedHV:r.formatEnabledDisabled(t.hardwareVirtualization),PerfCounters:r.formatEnabledDisabled(t.performanceCounters),CpuHotPlug:i,CpuAffinity:n,CpuIdMask:o}}function v(i,n){function o(r){var n="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuGeneralHelpText.html";e.renderTemplateWithScope(n,_.extend(i,{cpuGeneralHelpUrl:r})).then(function(e){i.cpuGeneralHelpSignPostParams={message:e,title:t.getString("Common","help")}})}var s=n?"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuMmuVirtualization6.7HostVm13HelpText.html":"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuMmuVirtualizationHelpText.html";e.renderTemplateWithScope(s,i).then(function(e){i.cpuMmuVirtSignPostParams={message:e,title:t.getString("Common","help"),"class":"cpu-mmu-help-text"}});var c="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/nestedHVHelpText.html";e.renderTemplateWithScope(c,i).then(function(e){i.nestedHVSignPostParams={message:e,title:t.getString("Common","help"),"class":"nested-hv-help-text"}});var l="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareCpu/cpuAffinityHelpText.html";e.renderTemplateWithScope(l,r.getCpuAffinitySignpostContext(i.vmConfigContext)).then(function(e){i.cpuAffinitySignPostParams={message:e,title:t.getString("Common","help"),height:"250px"}});var d="com.vmware.vsphere.vm_admin.doc.vc_153";a.getHelpPageUrl(d).then(function(e){o(e)})}function m(){c.RSRV_UNIT_ARIA_LBL=c.RSRV_QUANTITY_CARET_ARIA_LBL=c.RSRV_QUANTITY_ARIA_LBL=c.fieldLabel("Reservation"),c.LIMIT_UNIT_ARIA_LBL=c.LIMIT_QUANTITY_CARET_ARIA_LBL=c.LIMIT_QUANTITY_ARIA_LBL=c.fieldLabel("Limit"),c.SHARES_ARIA_LBL=c.SHARES_CARET_ARIA_LBL=c.SHARES_QNT_ARIA_LBL=c.fieldLabel("Shares"),c.IOMMU_ARIA_LBL=c.fieldLabel("ioMmuVirtualization"),c.INFO_PNG=c.i18n("CommonImages","info"),c.LBL_VVTD_ENABLED=c.i18n("VmUi","enabled")}function g(){c.i18n=t.getString,c.fieldLabel=function(e){return c.i18n("VmUi","VmCpu.Label."+e)},m(),c.validationError={message:"",isVisible:!0},c.isFtVm=n.isFtVmConfigContext(c.vmConfigContext);var e=!1,i=c.vmConfigContext.environment.configOption.capabilities;c.showCpuMmuVirtualization=!(!i.virtualMmuUsageIgnored||!i.virtualExecUsageIgnored);var a=c.vmConfigContext.environment.hostCapability;a.virtualMmuUsageIgnored&&a.virtualExecUsageIgnored&&!c.showCpuMmuVirtualization&&(e=!0),c.sharesValueMap={low:0,normal:0,high:0},d(),l(),h(),p(c),v(c,e),u();var s=o.getGuestOsDescriptor(c.vmConfigContext,{id:c.vmConfigContext.config.guestId});c.numCpuOptions=r.buildSupportedCpus(c.vmConfigContext,s,c.createMode),c.validNumCpuOptions=angular.copy(c.numCpuOptions),c.numCpuOptions.indexOf(c.vmConfigContext.config.hardware.numCPU)<0&&c.numCpuOptions.push(c.vmConfigContext.config.hardware.numCPU),c.coresPerSocketOptions=r.buildSupportedCoresPerSocket(c.vmConfigContext,c.originalConfig,s),c.fields=_.keys(c.fieldValue),c.ioMmuVirtualizationSupported=s.vvtdSupported&&s.vvtdSupported.supported,c.disableVvtdCheckbox=function(){var e=c.vm;return!!e&&!!e.isVvtdReadonly()},c.showVvtdInfo=function(){c.vvtdSignPostParams||(c.vvtdSignPostParams={});var e=c.vvtdSignPostParams,t=c.vm;return!!t&&(!!t.isVvtdRequired()&&(e.title=c.i18n("Common","help"),e.message=t.whyVvtdRequired(),!0))}}function h(){var e=i.determineCpuIdMaskFlag(c.vmConfigContext),t="advanced"===e;c.cpuIdMaskSettings=i.getCpuIdMaskSettingOptions(t),c.cpuIdMaskSelectedSetting=i.getCpuIdMaskFlagSelection(e),c.cpuIdMaskSelectedSettingOld=c.cpuIdMaskSelectedSetting}var f,S=!1;g(),c.$watch("vmConfigContext.config.cpuAllocation.limit",function(e){c.reservationMax=e===-1?r.getMaxReservation(c.vmConfigContext):e,l(),c.reservationRecommendations=[{name:c.i18n("VmUi","VmCpu.Reservation.Current"),value:c.originalConfig.cpuAllocation.reservation},{name:c.i18n("VmUi","VmCpu.Reservation.Minimum"),value:0},{name:c.i18n("VmUi","VmCpu.Reservation.Maximum"),value:c.reservationMax}],r.formatRecommendations(c.reservationRecommendations)}),c.$watch("vmConfigContext.config.cpuAllocation.reservation",function(e){c.limitRecommendations=[{name:c.i18n("VmUi","VmCpu.Limit.Current"),value:c.originalConfig.cpuAllocation.limit},{name:c.i18n("VmUi","VmCpu.Limit.Minimum"),value:e},{name:c.i18n("VmUi","VmCpu.Limit.Maximum"),value:-1}],r.formatRecommendations(c.limitRecommendations)}),c.$watch("vmConfigContext.config.hardware.numCPU",function(e){var t=o.getGuestOsDescriptor(c.vmConfigContext,{id:c.vmConfigContext.config.guestId});c.coresPerSocketOptions=r.buildSupportedCoresPerSocket(c.vmConfigContext,c.originalConfig,t);var i=c.vmConfigContext.config.hardware.numCoresPerSocket;c.coresPerSocketOptions.indexOf(i)<0&&(c.vmConfigContext.config.hardware.numCoresPerSocket=c.coresPerSocketOptions[0]);var n=c.vmConfigContext.config.hardware.numCPU;if(n){c.sharesValueMap={low:500*n,normal:1e3*n,high:2e3*n};var a=c.sharesInfo.level;"custom"!==a&&(S||(f=c.sharesValueMap[a]),S=!0,c.sharesInfo.shares=c.sharesValueMap[a])}}),c.isEditNumCpuEnabled=function(){var e=this.vmConfigContext,t=o.getAppropriateGuestOs(e,{id:e.config.guestId}),i=e.environment.powerState,n=r.isNumCpuEnabled(i,e.config,this.isFtVm,t,e.privileges,c.createMode);return n},c.isEditCoresPerSocketEnabled=function(){if(!c.createMode){var e=this.vmConfigContext,t=e.environment.powerState;if(this.isVmInPoweredOnState(t))return!1;if(this.isVmInSuspendedState(t))return!1}return this.isEditNumCpuEnabled()},c.isEditReservationEnabled=function(){return r.isReservationEnabled(this.vmConfigContext,c.createMode)},c.isEditLimitEnabled=function(){return r.isLimitEnabled(this.vmConfigContext,c.createMode)},c.isEditSharesEnabled=function(){return r.isSharesEnabled(this.vmConfigContext,c.createMode)},c.isEditCpuIdEnabled=function(){return r.isCpuIdEnabled(this.vmConfigContext,c.createMode)},c.isEditNestedHVEnabled=function(){return r.isNestedHVEnabled(this.vmConfigContext,c.createMode)},c.isEditCpuMmuEnabled=function(){return r.isCpuMmuEnabled(this.vmConfigContext,c.createMode)},c.isCpuHotPlugEnabled=function(){return r.isCpuHotPlugEnabled(this.vmConfigContext.environment.powerState,this.vmConfigContext.rtInfo?this.vmConfigContext.rtInfo.faultToleranceState:null,this.vmConfigContext.config.ftInfo,o.getAppropriateGuestOs(this.vmConfigContext,{id:this.vmConfigContext.config.guestId}),this.vmConfigContext.privileges,c.createMode)},c.cpuHotPlug=function(e){return angular.isDefined(e)&&(this.vmConfigContext.config.cpuHotAddEnabled=e),y.call(this)};var y=function(){var e=o.getAppropriateGuestOs(this.vmConfigContext,{id:this.vmConfigContext.config.guestId}),t=!!e&&e.supportsCpuHotAdd;return this.vmConfigContext.config.cpuHotAddEnabled&&t};c.hasError=function(){return!_.isEmpty(c.vmHardwareCpuForm)&&c.vmHardwareCpuForm.$invalid},c.hasChanged=function(){var e=c.sharesInfo.level,t=c.vmConfigContext.config.hardware.numCPU!==c.originalConfig.hardware.numCPU;return t=t||c.originalConfig.cpuAllocation.reservation!==c.vmConfigContext.config.cpuAllocation.reservation,t=t||c.originalConfig.cpuAllocation.limit!==c.vmConfigContext.config.cpuAllocation.limit,t=t||c.vmConfigContext.config.cpuHotAddEnabled!==c.originalConfig.cpuHotAddEnabled,t=t||c.vmConfigContext.config.flags.virtualExecUsage!==c.originalConfig.flags.virtualExecUsage,t=t||c.vmConfigContext.config.flags.virtualMmuUsage!==c.originalConfig.flags.virtualMmuUsage,t="custom"!==e?t||c.sharesInfo.shares!==f:t||c.sharesInfo.shares!==c.originalConfig.cpuAllocation.shares.shares},c.isVmInPoweredOnState=function(e){return n.isVmPoweredOn(e)},c.isVmInSuspendedState=function(e){return n.isVmSuspended(e)},c.isEnablePerfCountersIsDisabled=function(){var e=_.contains(c.vmConfigContext.privileges,"VirtualMachine.Config.Settings");return"poweredOff"!==c.vmConfigContext.environment.powerState||!c.vmConfigContext.environment.configOption.capabilities.vPMCSupported||!c.vmConfigContext.environment.hostCapability.vPMCSupported||!e},c.onAdvancedCpuIdMaskSubmit=function(e){var t=e.flagState,r="advanced"===t;c.cpuIdMaskSettings=i.getCpuIdMaskSettingOptions(r),c.cpuIdMaskSelectedSetting=i.getCpuIdMaskFlagSelection(t),c.vmConfigContext.config.cpuFeatureMask=e.cpuIdMask},c.onCpuIdMaskAdvanced=function(){var e=s.get("vscAdvancedCpuIdMaskModalService");e.showAdvancedCpuIdMaskModal(c.vmConfigContext,c.onAdvancedCpuIdMaskSubmit.bind(this))},c.onCpuIdMaskChange=function(){c.cpuIdMaskSelectedSetting!==c.cpuIdMaskSelectedSettingOld&&(c.cpuIdMaskSelectedSettingOld=c.cpuIdMaskSelectedSetting,i.updateCpuIdMaskSetting(c.cpuIdMaskSelectedSetting,c.vmConfigContext),c.cpuIdMaskSelectedSetting=i.getCpuIdMaskSettingForVm(c.vmConfigContext),c.cpuIdMaskSettings=i.getCpuIdMaskSettingOptions())},c.onCpuMmuChange=function(e){c.vmConfigContext.config.flags.virtualExecUsage=e._cpuUsage,c.vmConfigContext.config.flags.virtualMmuUsage=e._mmuUsage},c.isSchedulingAffinityShown=function(){return r.isSchedulingAffinityShown(c.vmConfigContext)},c.isHVDisabled=function(){return!c.isEditNestedHVEnabled()||(c.vbsEnabled||!c.createMode&&c.isVmInPoweredOnState(c.vmConfigContext.environment.powerState))},c.isSchedulingAffinityEnabled=function(){return r.isSchedulingAffinityEnabled(c.vmConfigContext,c.createMode)},c.onIOMmuChange=function(e){c.vmConfigContext.config.flags.vvtdEnabled=e.vvtdEnabled},c.isMultipleCoresPerSocketSupported=function(){return c.vmConfigContext.environment.configOption.capabilities.multipleCoresPerSocketSupported}},post:function(e){function t(){var t={message:e.i18n("VmUi","VmCpu.Error.InvalidCpuCount"),isVisible:!1},i=e.vmConfigContext.config.hardware.numCPU,r=function(i,r){var n=e.vmHardwareCpuForm;n&&n.$setValidity("editCPU",i),t.isVisible=!i,r&&(t.message=r)};return r(e.validNumCpuOptions&&e.validNumCpuOptions.indexOf(i)>=0?!0:!1),e.vm&&(e.vm.isCpuHotplugError(e.originalConfig)&&r(!1,e.i18n("VmUi","VmCpu.Hotplug128Error")),e.vm.isCpuFirmwareError()&&r(!1,e.i18n("VmUi","VmCpu.CpuFirmwareError"))),t}function i(){var t={message:e.i18n("VmUi","CpuAffinityValidator.Error.BadAffinity"),isVisible:!1},i=e.vmConfigContext.environment.configTarget.numCpus,n=e.fieldValue.CpuAffinity,o=r.validateAffinity(n,i);return o?e.vmHardwareCpuForm&&e.vmHardwareCpuForm.cpuAffinity&&e.vmHardwareCpuForm.cpuAffinity.$setValidity("badAffinityPattern",!0):(t.isVisible=!0,e.vmHardwareCpuForm&&e.vmHardwareCpuForm.cpuAffinity&&e.vmHardwareCpuForm.cpuAffinity.$setValidity("badAffinityPattern",!1)),t}e.onCpuCountChange=function(){e.cpuCountError=t(),e.vm&&e.vm.afterCpuChange()},e.$watch("vmConfigContext.config.firmware",function(i){e.cpuCountError=t()}),e.onAffinityChange=function(){var t=i();e.affinityError=t;var n=!t.isVisible;n&&(e.vmConfigContext.config.cpuAffinity.affinitySet=r.transformAffinity(e.fieldValue.CpuAffinity))},e.isAffinityInvalid=function(){return!(!e.vmHardwareCpuForm||!e.vmHardwareCpuForm.cpuAffinity)&&(e.vmHardwareCpuForm.cpuAffinity.$dirty&&e.vmHardwareCpuForm.cpuAffinity.$error.badAffinityPattern)},e.cpuCountError=t(),e.affinityError=i()}}}}]);var VmConfigContext=com.vmware.vsphere.client.vm.config.VmConfigContext,ConfigInfo=com.vmware.vim.binding.vim.vm.ConfigInfo,GuestOsDescriptor=com.vmware.vim.binding.vim.vm.GuestOsDescriptor,SharesInfo=com.vmware.vim.binding.vim.SharesInfo,VmHardwareUtil=h5_vm.VmHardwareUtil,VmHardwareMemoryService=h5_vm.VmHardwareMemoryService,VmConfig=h5_vm.VmConfig;angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareMemory",["i18nService","numberFormatterService","scopeUtil","bytesFilter","vmHardwareUtil","vmHardwareMemoryService",function(e,t,i,r,n,o){return{scope:{vm:"=",vmConfigContext:"=",originalConfig:"=",createMode:"=",deployVmtxMode:"=",expanded:"=",selectedGuestOs:"="},templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareMemory/vmHardwareMemory.html",link:{pre:function(i){function n(e){if(!p.vm)return!0;var t=p.vm.validateMemoryMB(e);return g.error=t.error,t.valid}function a(){return g.error}function s(){return p.i18n("VmUi","Util.Validation.ValidRange",p.i18n("VmUi","VmMemory.Label.Reservation"),p.i18n("VmUi","memValue",0),p.i18n("VmUi","memValue",p.limits.reservationMaxLimit))}function c(){p.reservationErrorMessages={max:s,min:s}}function l(){var e=p.vmConfigContext.environment.configTarget.resourcePool.memory,t=p.vmConfigContext.config.hardware.memoryMB,i=p.vmConfigContext.config.memoryAllocation,r=p.vmConfigContext.environment.powerState,n=o.getReservationMaxLimit(e,t,i,r);return n}function d(){var e,i,r=p.maxAllowedMemory/1024;return r<1?(e="vmHardwareMemory.invalidMemoryRangeMB",i=p.maxAllowedMemory):(e="vmHardwareMemory.invalidMemoryRangeGB",i=r),p.i18n("VmUi",e,p.minAllowedMemory,t.format(i,{fractionSize:1,trimTrailingZeros:!0}))}var u,p=i,v=!1;p.i18n=e.getString,p.MAX_SHARES_VALUE=1e6,p.MIN_SHARES_VALUE=1,p.fieldLabel=function(e){return p.i18n("VmUi","label"+e)},p.memoryOptions=[{label:p.i18n("VmUi","Vm.Units.MB"),multiplier:1},{label:p.i18n("VmUi","Vm.Units.GB"),multiplier:1024},{label:p.i18n("VmUi","Vm.Units.TB"),multiplier:1048576}],p.vm&&(p.memoryRecommendations=p.vm.getMemoryRecommendations());var m=p.vmConfigContext.config.hardware.memoryMB;m<1024&&(p.vmConfigContext.config.hardware.memoryUnitPreferred=p.memoryOptions[0]),p.onMemoryReservationLockedToMax=function(){p.vmConfigContext.config.memoryReservationLockedToMax&&(p.vmConfigContext.config.memoryAllocation.reservation=p.vmConfigContext.config.hardware.memoryMB)};var g={name:"memoryMB",validate:n,message:a,error:""};p.memoryValidators=[g],p.onUnitChanged=function(e){p.vmConfigContext.config.hardware.memoryUnitPreferred=e},p.onReservationUnitChanged=function(e){p.vmConfigContext.config.memoryAllocation.reservationMemoryUnitPreferred=e},p.onLimitUnitChanged=function(e){p.vmConfigContext.config.memoryAllocation.limitMemoryUnitPreferred=e},p.sharesValueMap={low:0,normal:0,high:0};var h=p.i18n("VmUi","labelUnlimited"),f=-1,S=0;!_.isEmpty(p.vmConfigContext.config.memoryAllocation)&&p.vmConfigContext.config.memoryAllocation.isInitialized||(f=p.originalConfig.memoryAllocation?p.originalConfig.memoryAllocation.limit:-1,S=p.originalConfig.memoryAllocation?p.originalConfig.memoryAllocation.reservation:0,p.vmConfigContext.config.memoryAllocation.isInitialized=!0,p.vmConfigContext.config.memoryAllocation.reservationMemoryUnitPreferred=p.memoryOptions[0],p.vmConfigContext.config.memoryAllocation.limitMemoryUnitPreferred=p.memoryOptions[0]),p.limitRecommendations=[{name:p.i18n("VmUi","VmMemory.Limit.Current"),value:f},{name:p.i18n("VmUi","VmMemory.Limit.Minimum"),value:0},{name:p.i18n("VmUi","VmMemory.Limit.Maximum"),value:-1}],p.reservationRecommendations=[{name:p.i18n("VmUi","VmMemory.Reservation.Current"),value:S},{name:p.i18n("VmUi","VmMemory.Reservation.Minimum"),value:0},{name:p.i18n("VmUi","VmMemory.Reservation.Maximum"),value:0}],c();var y=function(e){e.formattedValue=e.value===-1?h:r(e.value,"MB")};p.$watchGroup(["vmConfigContext.config.memoryAllocation.reservation","vmConfigContext.config.memoryAllocation.limit","vmConfigContext.config.hardware.memoryMB"],function(e){var t=p.vmConfigContext.config.memoryAllocation.reservation;t&&(p.limitRecommendations[1].value=t),p.limits={reservationMaxLimit:l()},c(),p.reservationRecommendations[2].value=p.limits.reservationMaxLimit,_.each(p.limitRecommendations,y),_.each(p.reservationRecommendations,y);var i=p.vmConfigContext.config.hardware.memoryMB;if(i){p.sharesValueMap={low:Math.min(5*i,p.MAX_SHARES_VALUE),normal:Math.min(10*i,p.MAX_SHARES_VALUE),high:Math.min(20*i,p.MAX_SHARES_VALUE)};var r=p.sharesInfo.level;"custom"!==r&&(v||(u=p.sharesValueMap[r]),v=!0,p.sharesInfo.shares=p.sharesValueMap[r])}}),p.hasChanged=function(){var e=!1,t=p.vmConfigContext.config.cpuAllocation.shares.level;return e=p.vmConfigContext.config.hardware.memoryMB!==p.originalConfig.hardware.memoryMB,e=e||p.originalConfig.memoryAllocation.reservation!==p.vmConfigContext.config.memoryAllocation.reservation,e=e||p.originalConfig.memoryAllocation.limit!==p.vmConfigContext.config.memoryAllocation.limit,e=e||p.vmConfigContext.config.memoryHotAddEnabled!==p.originalConfig.memoryHotAddEnabled,e="custom"!==t?e||p.sharesInfo.shares!==u:e||p.sharesInfo.shares!==p.originalConfig.memoryAllocation.shares.shares},p.$watch("vmConfigContext",function(e){e&&(p.minAllowedMemory=o.getMinMemoryMB(p.vmConfigContext.config,p.vmConfigContext.environment),p.maxAllowedMemory=o.getMaxMemoryMB(p.vmConfigContext.config,p.vmConfigContext.environment),e.config?p.memoryIncrementSize=e.config.hotPlugMemoryIncrementSize||4:p.memoryIncrementSize=4,p.memoryErrorMessages={max:d,min:d,mod:p.i18n("VmUi","VmMemory.ErrorMultiple",p.memoryIncrementSize+" MB")})}),p.isMemoryDisabled=function(){return o.isMemoryDisabled(p.vmConfigContext.config,p.vmConfigContext.environment,p.vmConfigContext.privileges,p.createMode)},p.isReservationDisabled=function(){return o.isReservationDisabled(p.vmConfigContext.config,p.vmConfigContext.privileges,p.createMode)},p.isMaxReservationDisabled=function(){return o.isMaxReservationDisabled(p.vmConfigContext.rtInfo,p.vmConfigContext.privileges,p.vmConfigContext.environment.configOption.capabilities,p.createMode)},p.isLimitDisabled=function(){return o.isLimitDisabled(p.vmConfigContext.privileges,p.createMode)},p.isSharesDisabled=function(){return o.isSharesDisabled(p.vmConfigContext.privileges,p.createMode)},p.isMemoryHotPlugDisabled=function(){return o.isMemoryHotPlugDisabled(p.vmConfigContext.environment,p.vmConfigContext.privileges,p.selectedGuestOs,p.createMode)},p.hasError=function(){return!_.isEmpty(p.vmHardwareMemoryForm)&&p.vmHardwareMemoryForm.$invalid};var P=p.vmConfigContext.config.memoryAllocation.shares;p.sharesInfo=P,p.isSharesDisabled()&&null!==P&&(p.sharesInfo={level:P.level,shares:P.shares,_type:""}),p.init_aria=function(){p.ARIA_LBL_MEMORY=p.i18n("VmUi","VmMemory.Title"),p.ARIA_LBL_RSRV=p.fieldLabel("Reservation"),p.ARIA_LBL_LIMIT=p.fieldLabel("Limit"),p.ARIA_LBL_SHARES=p.fieldLabel("Shares")},p.init_aria()}}}}]);var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.SharesInfo,i=e.VmWorkflowMode,r=function(){function e(){}return e}(),n=function(){function n(e,t,r,n,o,a,s,c,l,d){var u=this;this.i18nService=e,this.dataService=t,this.vmDeviceInfoService=r,this.networkSelectorDialogService=n,this.defaultUriSchemeUtil=o,this.NetworkSelectorMode=a,this.vmNetworkService=s,this.vmHardwareNetworkService=c,this.VirtualMachineDevices=l,this.$q=d,this.MAX_BANDWIDTH=1e4,this.reservationMax=this.MAX_BANDWIDTH,this.ARIA_LBL_RESTORE=this.i18n("DeviceDeletedControl.Restore"),this.ARIA_LBL_REMOVE=this.i18n("DeviceDeletedControl.DeviceDeleted"),this.ARIA_LBL_START_CONNECTED=this.i18n("ConnectDevice.ConnectAtPowerOn"),this.ARIA_LBL_CONNECTED=this.i18n("ConnectDevice.Connected"),this.ARIA_LBL_MTU=this.i18n("NetworkPage.GuestOSMTUChange"),this.ARIA_LBL_RSRV=this.i18n("NetworkPage.Reservation"),this.ARIA_LBL_LIMIT=this.i18n("NetworkPage.Limit"),this.ARIA_LBL_NIC_TYPE=this.i18n("VmNetView.adapterType"),this.ARIA_LBL_UPT=this.i18n("NetworkPage.UptCompatibility"),this.ARIA_LBL_SRIOV_PF=this.i18n("NetworkPage.PhysicalFunction"),this.ARIA_LBL_SHARES=this.i18n("NetworkPage.Shares"),this.isHotAddDevice=function(){return u.virtualNetworkDevice.isNew()&&u.vmWorkflowMode===i.UpdateMode&&u.isVmPoweredOn()},this.buildNetworkSelectorSpec=function(){return{filterSpec:u.vmNetworkService.getVmNetworkSelectorFilterSpec(),dialogSpec:u.networkSelectorDialogService.createNetworkSelectorDialogSpec(["Network.Assign"],u.i18nService.getString("Common","NetworkSelectorDialog.noPrivileges"),u.i18nService.getString("Common","NetworkSelectorDialog.noPrivilegesAndMore"))}},this.checkIsNetworkAvailable=function(){return u.errorConfig.isVisible=!1,u.selectedNetworkValid=!0,u.virtualNetworkDevice.isMarkedForRemoval()?void u.setErrorVisibility([!0]):void(_.isEmpty(u.properties.selectedNetwork)||u.vmWorkflowMode===i.UpdateMode||u.vmHardwareNetworkService.checkNetworkPrivileges(u.properties.selectedNetwork.id).then(function(e){u.setErrorVisibility(e)}))},this.onConnectAtPowerOnChange=function(){u.device.connectable.startConnected=u.properties.connectAtPowerOn,u.isHotAddDevice()&&u.setConnectedValue(u.properties.connectAtPowerOn)},this.setConnectedValue=function(e){u.properties.connected=e,u.device.connectable.connected=e},this.onConnectChange=function(){u.device.connectable.connected=u.properties.connected,u.isHotAddDevice()&&u.setConnectAtPowerOnValue(u.properties.connected)},this.setConnectAtPowerOnValue=function(e){u.properties.connectAtPowerOn=e,u.device.connectable.startConnected=e},this.onNetworkAdapterTypeChange=function(){u.device._type=u.properties.selectedAdapterType.type.name,u.updateSelectedDeviceProtocol(),u.updateNetworkReservationSupported(),u.afterAdapterTypeChange()},this._mtuChangeValueAllow={value:!0,id:1},this._mtuChangeValueDisallow={value:!1,id:0},this.LBL_PORT_ID=this.i18n("NetworkPage.PortID"),this.LBL_PORT_ID_ERR=this.i18n("NetworkPage.PortID.Error"),this._portKeys=null,this.reservationMax=this.MAX_BANDWIDTH}return n.prototype.i18n=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService?this.i18nService.getString("VmUi",e,t):""},n.prototype.$onInit=function(){var e=this;this.initSriov(),this.device=this.virtualNetworkDevice.getCurrentDevice(),this.originalAllocation=angular.copy(this.device.resourceAllocation),this.resourceAllocation=this.device.resourceAllocation,this.properties={};var t=this.buildNetworkSelectorSpec(),r=this.vmHardwareNetworkService.buildNetworkItemForSelectedNetworkBacking(this.vmConfigContext.environment.configTarget,this.virtualNetworkDevice.getCurrentDevice()),n=this.networkProvider?this.networkProvider:this.vmHardwareNetworkService.getNetworkProviderFromVmConfig(this.vmConfigContext);this.networkSelectorModel={objectRef:n,mode:this.NetworkSelectorMode.SINGLE_SELECTION_DROPDOWN,filterSpec:t.filterSpec,dialogSpec:t.dialogSpec,selectedNetwork:r,prefetchedNetworks:[r]},this.onNetworkSelectionChanged=function(t){var i=t[0],r=e.defaultUriSchemeUtil.getVsphereObjectId(i.networkRef),n=e.vmDeviceInfoService.getNetworkInfo(e.vmConfigContext.environment.configTarget,r);e.virtualNetworkDevice.setNetwork(n);var o={id:r,name:i.name,networkInfo:n};e.properties.selectedNetwork=o,e.checkIsNetworkAvailable(),e.isNetworkReservationSupported()?(e.device.resourceAllocation=e.resourceAllocation,e.properties.reservationSupported=!0):(e.device.resourceAllocation=e.newResourceAllocationInfo(),
e.properties.reservationSupported=!1),e._portKeys=null},this.onPreloadNetworks=function(){return e.vmWorkflowMode===i.UpdateMode&&e.vmId?e.vmConfigContext.configTargetIsBeingUpdated?e.$q.when(e.vmHardwareNetworkService.getNetworkSelectorNetworks(e.vmNetworkService.getVmNetworkSelectorFilterSpec(),e.vmConfigContext.environment.configTarget)):e.vmHardwareNetworkService.getVmConfigTarget(e.vmId).then(function(t){if(t&&t.vmConfigTarget)return e.vmConfigContext.configTargetIsBeingUpdated=!0,e.vmConfigContext.environment.configTarget=t.vmConfigTarget,e.vmHardwareNetworkService.getNetworkSelectorNetworks(e.vmNetworkService.getVmNetworkSelectorFilterSpec(),e.vmConfigContext.environment.configTarget)}):e.$q.when(void 0)},this.errorConfig={message:this.i18n("NetworkPage.NoPermission"),isVisible:!1},this.deviceProtocols=this.vmHardwareNetworkService.getPVRDMADeviceProtocols(),this.updateSelectedDeviceProtocol(),this.adapterTypes=[];var o,a=this.selectedGuestOs,s=this.vmConfigContext.environment.configOption.hardwareOptions.virtualDeviceOption,c=this.vmDeviceInfoService.getDeviceEthernetCard(this.device);a.supportedEthernetCard.forEach(function(t){s.forEach(function(i){t.name!==i.type.name&&c.name!==i.type.name||(a.recommendedEthernetCard.name===i.type.name&&(o=i),e.adapterTypes.push(i))})}),this.adapterTypes=_.uniq(this.adapterTypes,!1,function(e){return e.type.name}),this.removePVRDMAIfLimitReached(),this.properties={selectedAdapterType:this.vmNetworkService.getSelectedNetworkTypeForDevice(this.device,o,this.adapterTypes,s),selectedNetwork:{id:this.virtualNetworkDevice.getNetworkId(),name:this.virtualNetworkDevice.getNetworkName(),networkInfo:this.virtualNetworkDevice.getNetwork()},connected:this.device.connectable.connected,connectAtPowerOn:this.device.connectable.startConnected},this.getEthernetCardLabel=this.vmDeviceInfoService.getEthernetCardLabel,this.selectedNetworkValid=!0,this.setupResourceAllocation()},n.prototype.isVmPoweredOn=function(){return this.vmHardwareNetworkService.isVmPoweredOn(this.vmConfigContext)},n.prototype.$postLink=function(){this.checkIsNetworkAvailable(),this.checkSriovValidity()},n.prototype.isRemoveDisabled=function(){return!this.isNew()&&!this.deployVmtxMode&&this.vmHardwareNetworkService.isRemoveNetworkAdapterDisabled(this.vmConfigContext.privileges)},n.prototype.onRemoveDevice=function(){!this.isRemoveDisabled()&&this.removeCallback&&(this.removeCallback()(this.virtualNetworkDevice),this.setErrorVisibility([!0]),this.vmHardwareNetworkForm.$setValidity("sriov",!0))},n.prototype.revertRemoval=function(){this.virtualNetworkDevice&&(this.virtualNetworkDevice.revertRemoval(),this.checkIsNetworkAvailable(),this.setSriovValidity())},n.prototype.hasError=function(){return!_.isEmpty(this.vmHardwareNetworkForm)&&this.vmHardwareNetworkForm.$invalid},n.prototype.shouldDisplayPVRDMADeviceProtocol=function(){return this.supportsDeviceProtocol()},n.prototype.getDeviceProtocolLabel=function(e){return this.vmHardwareNetworkService.getPVRDMADeviceProtocolLabel(e)},n.prototype.updateSelectedDeviceProtocol=function(){this.virtualNetworkDevice.isNew()&&this.supportsDeviceProtocol()&&(this.device.deviceProtocol||(this.device.deviceProtocol=this.vmHardwareNetworkService.getDefaultRDMAProtocol(this.getVrdmaOption())),this.device.deviceProtocol=this.device.deviceProtocol||this.deviceProtocols[0])},n.prototype.setErrorVisibility=function(e){var t=e[0];void 0===t&&(t=!0),this.errorConfig.isVisible=!t,this.selectedNetworkValid=t,this.vmHardwareNetworkForm.$setValidity("nested",this.selectedNetworkValid)},n.prototype.isSriovEthernetCardType=function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualSriovEthernetCard"===e},n.prototype.isNetworkSelectDisabled=function(){return this.vmNetworkService.isNetworkSelectDisabled(this.vmConfigContext.privileges,this.isNew())},n.prototype.isConnectedDisabled=function(){return!!this.isNotConnectable()||this.vmNetworkService.isConnectedDisabled(this.vmConfigContext.privileges,this.isNew())},n.prototype.isConnectedAtPowerOnDisabled=function(){return!!this.isNotConnectable()||this.vmNetworkService.isConnectedAtPowerOnDisabled(this.vmConfigContext.privileges,this.isNew())},n.prototype.isMacAddressDisabled=function(){return this.vmNetworkService.isMacAddressDisabled(this.vmConfigContext.environment.powerState,this.virtualNetworkDevice.isNew(),this.vmConfigContext.privileges,this.vmWorkflowMode===i.CreateMode)},n.prototype.isNetworkAdapterDisabled=function(){return!this.isNew()},n.prototype.uptCompatibility=function(e){var t=this.device,i=this.properties.selectedAdapterType;return angular.isDefined(e)?(this.vmNetworkService.setUptCompatibility(t,e),e):this.vmNetworkService.getUptCompatibility(t,i)},n.prototype.isEditUptCompatibilityDisabled=function(){return this.vmNetworkService.isEditUptCompatibilityDisabled(this.vmConfigContext,this.isNew())},n.prototype.isUptCompatibilityVisible=function(){var e=this.properties.selectedAdapterType;return this.vmNetworkService.isUptCompatibilityVisible(e)},n.prototype.setupResourceAllocation=function(){this.sharesValueMap={low:25,normal:50,high:100},this.updateNetworkReservationSupported(),this.resourceAllocation||(this.resourceAllocation=this.newResourceAllocationInfo(),this.isNetworkReservationSupported()&&(this.device.resourceAllocation=this.resourceAllocation)),this.updateReservationRange(),this.setupBandwidthUnits(),this.reservationErrorMessages={max:this.getReservationError.bind(this)},this.limitErrorMessages={max:this.getReservationError.bind(this)},this.updateReservationRecommendations(),this.updateLimitRecommendations(),this.setupLimitValidator()},n.prototype.updateNetworkReservationSupported=function(){this.properties.reservationSupported=this.isNetworkReservationSupported()},n.prototype.isNetworkReservationSupported=function(){if(this.isSriovEthernetCardType(this.device._type))return!1;var e=this.properties.selectedNetwork.networkInfo;return!(!e||!e.hasOwnProperty("networkReservationSupported"))&&e.networkReservationSupported},n.prototype.newResourceAllocationInfo=function(){var e=new r;return e._type="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$ResourceAllocation",e.share=new t,e.reservation=0,e.limit=-1,e.share.level="normal",e.share.shares=50,e},n.prototype.setupLimitValidator=function(){this.limitValidator={name:"validateLimit",validate:this.validateLimit.bind(this),message:this.getLimitError.bind(this)},this.limitValidators=[this.limitValidator]},n.prototype.validateLimit=function(e){return e===-1||!(e>this.MAX_BANDWIDTH)&&!(e<1)},n.prototype.onLimitChanged=function(){this.updateReservationRange(),this.updateReservationRecommendations()},n.prototype.updateReservationRange=function(){this.resourceAllocation&&this.resourceAllocation.limit>0?this.reservationMax=this.resourceAllocation.limit:this.reservationMax=this.MAX_BANDWIDTH},n.prototype.onReservationChanged=function(){this.updateLimitRecommendations()},n.prototype.updateReservationRecommendations=function(){var e=this.originalAllocation,t=e?e.reservation:0;this.reservationRecommendations=[{name:this.i18n("NetworkPage.CurrentValue"),value:t},{name:this.i18n("NetworkPage.Minimum"),value:0},{name:this.i18n("NetworkPage.Maximum"),value:this.reservationMax}]},n.prototype.updateLimitRecommendations=function(){var e=this.i18nService.getString("Common","unlimited"),t=this.originalAllocation,i=t?t.limit:0,r="";null!==i&&(r=i.toString()),i===-1&&(r=e),this.limitRecommendations=[{name:this.i18n("NetworkPage.CurrentValue"),value:i,formattedValue:r},{name:this.i18n("NetworkPage.Minimum"),value:1},{name:this.i18n("NetworkPage.Maximum"),value:this.MAX_BANDWIDTH},{name:e,value:-1,formattedValue:e}]},n.prototype.getReservationError=function(){var e=this.i18nService.getString("Common","megabitSec.label"),t=this.i18n("NetworkPage.Reservation"),i="0",r=this.reservationMax.toString()+" "+e,n=this.i18nService.getString("VmUi","Util.Validation.ValidRange",t,i,r);return n},n.prototype.getLimitError=function(){var e=this.i18nService.getString("Common","megabitSec.label"),t=this.i18n("NetworkPage.Limit"),i=1,r=this.MAX_BANDWIDTH.toString()+" "+e,n=this.i18nService.getString("VmUi","Util.Validation.ValidRange",t,i.toString(),r);return n},n.prototype.setupBandwidthUnits=function(){var e=this.i18nService.getString("Common","megabitSec.label"),t=this.i18nService.getString("Common","gigabitSec.label");this.reservationUnitOptions=[{label:e,multiplier:1},{label:t,multiplier:1e3}]},n.prototype.isNew=function(){return!!this.virtualNetworkDevice&&this.virtualNetworkDevice.isNew()},n.prototype.initSriov=function(){this._mtuChangeValueAllow.label=this.i18n("NetworkConfig.AllowGuestOSMtuChange"),this._mtuChangeValueDisallow.label=this.i18n("NetworkConfig.AllowGuestOSMtuChangeNot"),this.sriov=new e.VmHwSriovDriver(this.vmConfigContext,this.virtualNetworkDevice,this.vmWorkflowMode)},n.prototype.isSriovEthernetCard=function(){return this.isSriovEthernetCardType(this.device._type)},n.prototype.afterAdapterTypeChange=function(){this.setSriovValidity(),this.isSriovEthernetCard()&&this.sriov.available()&&this.sriov.switchToSriovAdapterType()},n.prototype.setSriovValidity=function(){return this.isSriovEthernetCard()?(this.isVmPoweredOn()&&this.sriovValid(!1),void(this.sriov.unavailable()&&this.sriovValid(!1))):void this.sriovValid(!0)},n.prototype.sriovValid=function(e){this.vmHardwareNetworkForm.$setValidity("sriov",e)},Object.defineProperty(n.prototype,"sriovValue",{get:function(){return this.sriov.sriovValue},set:function(e){this.sriov.sriovValue=e},enumerable:!0,configurable:!0}),n.prototype.sriovList=function(){return this.sriov.sriovList()},n.prototype.isSriovVisible=function(){return this.isSriovEthernetCard()},n.prototype.isSriovSelectVisible=function(){return!!this.sriov.available()&&(this.isSriovEthernetCard()&&this.isNew())},n.prototype.isSriovLabelVisible=function(){return!this.isSriovSelectVisible()},n.prototype.getSriovLabelText=function(){return this.sriov.unavailable()?this.i18n("NetworkPage.SriovNotAvailable"):this.sriov.getSriovLabelText()},Object.defineProperty(n.prototype,"isSriovWarningVisible",{get:function(){return this.isSriovEthernetCard()&&this.sriov.available()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sriovWarningText",{get:function(){var e=this.i18n("NetworkPage.WarnLimitedOperations");return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMemWarnVisible",{get:function(){return!this.sriov.unavailable()&&(!1!==this.isSriovVisible()&&this.sriov.reservationIssue())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"memWarnText",{get:function(){return this.i18n("NetworkPage.WarnReservation")},enumerable:!0,configurable:!0}),n.prototype.isNotConnectable=function(){return this.vmNetworkService.isNotConnectable(this.device,this.vmConfigContext)},Object.defineProperty(n.prototype,"showHotAddError",{get:function(){return!!this.isNew()&&!(!this.isSriovEthernetCard()||!this.isVmPoweredOn())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hotAddErrorText",{get:function(){return this.i18n("NetworkPage.HotAddError")},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mtuChangeValue",{get:function(){return this.isSriovEthernetCard()&&this.sriov.allowMtuChange?this._mtuChangeValueAllow:this._mtuChangeValueDisallow},set:function(e){this.isSriovEthernetCard()&&(this.sriov.allowMtuChange=e.value)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mtuChangeList",{get:function(){return[this._mtuChangeValueAllow,this._mtuChangeValueDisallow]},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMtuChangeVisible",{get:function(){return this.isSriovEthernetCard()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMtuChangeEditable",{get:function(){return this.sriov.isAllowMtuChangeEditable()},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"showDeviceWarning",{get:function(){return this.isMemWarnVisible},enumerable:!0,configurable:!0}),n.prototype.checkSriovValidity=function(){return this.virtualNetworkDevice.isMarkedForRemoval()?void this.sriovValid(!0):void(this.isSriovEthernetCard()&&!this.virtualNetworkDevice.isNew()&&this.sriov.unavailable()&&this.sriovValid(!1))},n.prototype.getVrdmaOption=function(){var e=this.properties.selectedAdapterType,t=e;return t},n.prototype.supportsDeviceProtocol=function(){var e=this.getVrdmaOption();return this.vmHardwareNetworkService.supportsDeviceProtocol(e)},n.prototype.isPVRDMALimitReached=function(){return!!this.virtualNetworkDevice.isNew()&&this.vmHardwareNetworkService.isPVRDMALimitReached(this.virtualMachineDevices,this.vmConfigContext)},n.prototype.removePVRDMAIfLimitReached=function(){this.virtualNetworkDevice.isNew()&&this.isPVRDMALimitReached()&&(this.adapterTypes=this.vmHardwareNetworkService.removePVRDMAType(this.adapterTypes))},Object.defineProperty(n.prototype,"showPortID",{get:function(){if(this.deployVmtxMode)return!1;if(this.vmWorkflowMode!==i.UpdateMode)return!1;if(!this.virtualNetworkDevice)return!1;if(!this.device||!this.device.backing)return!1;if(this.isNew())return!1;var e=this.device.backing.port;return!!e&&(""===e.portKey||!!e.portKey)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"port",{get:function(){var e=this.device.backing,t=e.port||{};return t.portKey},set:function(e){var t=this.device.backing,i=t.port||{};e!==i.portKey&&(i.portKey=e,this._portKeys||this.fetchPortKeys())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"portIsInvalid",{get:function(){if(!this._portKeys)return!1;var e=this.port;return!e||this._portKeys.indexOf(e)<0},enumerable:!0,configurable:!0}),n.prototype.fetchPortKeys=function(){var e=this;this._portKeys=null;var t=this.virtualNetworkDevice.getNetwork();if(t){var i="com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroupInfo";if(t._type===i){var r=t.portgroup;if(r){var n=this.defaultUriSchemeUtil.createVmomiUri(r.type,r.value,r.serverGuid),o=function(t){return t&&t.portKeys?void(e._portKeys=t.portKeys):void(e._portKeys=null)},a=function(){e._portKeys=null},s="portKeys",c=this.dataService.getProperties(n,s);c.then(o,a)}}}},n.$inject=["i18nService","dataService","vmDeviceInfoService","networkSelectorDialogService","defaultUriSchemeUtil","NetworkSelectorMode","vmNetworkService","vmHardwareNetworkService","vmHardwareVersionService","$q"],n}(),o=function(){function e(){this.bindings={virtualNetworkDevice:"<",virtualMachineDevices:"<",networkProvider:"<",availableNetworks:"<",networkPrivilegeMap:"<",vmWorkflowMode:"<",selectedGuestOs:"<",filterNetworksObjId:"<",vmConfigContext:"<",removeCallback:"&",vmId:"<",deployVmtxMode:"=",expanded:"="},this.controller=n,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareNetwork/vm-hardware-network.html"}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareNetwork",new o)}(h5_vm||(h5_vm={}));var vm_ui;!function(e){var t=h5_vm.Privileges,i=function(){function e(e,t,i,r,n,o,a){this.$q=e,this.i18nService=t,this.dataService=i,this.defaultUriSchemeUtil=r,this.authorizationService=n,this.vmHardwareUtil=o,this.vmHardwareVersionService=a,this.ROCEV1="rocev1",this.ROCEV2="rocev2",this.PCI_CONTROLLER_TYPE="com.vmware.vim.binding.vim.vm.device.VirtualPCIController",this.RDMA_DEVICE_CLASS="com.vmware.vim.binding.vim.vm.device.VirtualVmxnet3Vrdma"}return e.prototype.isVmPoweredOn=function(e){return this.vmHardwareUtil.isVmPoweredOn(e.environment.powerState)},e.prototype.getNetworkProviderFromVmConfig=function(e){return this.defaultUriSchemeUtil.getVsphereObjectId(e.rtInfo.host)},e.prototype.getVmConfigTarget=function(e){return this.dataService.getProperties(e,["vmConfigTarget"])},e.prototype.getNetworkSelectorNetworks=function(e,t){var i=this,r=[];if(!t||!e)return r;if(e.includeDistributedPortGroups){var n=t.distributedVirtualPortgroup;n&&n.length>0&&_.forEach(n,function(t){if(e.includeUplinkPortGroups||!t.uplinkPortgroup){var n=i.createDvpgNetworkSelectorData(t);n&&r.push(n)}})}if(e.includeOpaqueNetworks){var o=t.opaqueNetwork;o&&o.length>0&&_.forEach(o,function(e){var t=i.createOpaqueNetworkSelectorData(e);t&&r.push(t)})}if(e.includeStandardNetworks){var a=t.network;a&&a.length>0&&_.forEach(a,function(e){var t=i.createStandardNetworkSelectorData(e);t&&r.push(t)})}return r},e.prototype.createDvpgNetworkSelectorData=function(e){if(e)return{_type:"com.vmware.vsphere.client.modules.api.networkselector.NetworkSelectorPortgroupData",name:e.portgroupName,portgroupKey:e.portgroupKey,dvsName:e.switchName,dvsUuid:e.switchUuid,networkRef:e.portgroup,isUplink:e.uplinkPortgroup}},e.prototype.createOpaqueNetworkSelectorData=function(e){if(e&&e.network)return{_type:"com.vmware.vsphere.client.modules.api.networkselector.NetworkSelectorPortgroupData",isOpaqueNetwork:!0,name:e.name,networkRef:e.network.network,opaqueNetworkType:e.network.opaqueNetworkType}},e.prototype.createStandardNetworkSelectorData=function(e){if(e&&e.network)return{_type:"com.vmware.vsphere.client.modules.api.networkselector.NetworkSelectorPortgroupData",isStandardNetwork:!0,name:e.name,networkRef:e.network.network}},e.prototype.checkNetworkPrivileges=function(e){return e?this.authorizationService.checkPrivileges(e,["Network.Assign"]):this.$q.when([!1])},e.prototype.buildNetworkItemForSelectedNetworkBacking=function(e,t){var i=t.backing;return i._type.indexOf("DistributedVirtualPortBackingInfo")>-1?this.buildDistributedVirtualPortGroupItem(e,i):i._type.indexOf("OpaqueNetworkBackingInfo")>-1?this.buildOpaqueNetworkItem(e,i):i._type.indexOf("NetworkBackingInfo")>-1?this.buildNetworkItem(e,i):void 0},e.prototype.getResourcePoolForVm=function(e){return this.dataService.getProperties(e,["resourcePool"])},e.prototype.canConfigurePVRDMADeviceProtocol=function(e){return this.vmHardwareVersionService.getVersionNumber(e)>=14},e.prototype.getPVRDMADeviceProtocols=function(){return[this.ROCEV1,this.ROCEV2]},e.prototype.getPVRDMADeviceProtocolLabel=function(e){return this.i18nService.getString("VmUi","NetworkConfig.VirtualVmxnet3Vrdma."+e)},e.prototype.buildDistributedVirtualPortGroupItem=function(e,t){var i=t.port.portgroupKey,r=e.distributedVirtualPortgroup,n=_.find(r,function(e){return e.portgroupKey===i});if(!n)return this.generateEmptyNetworkItem();var o=n.portgroup,a=this.defaultUriSchemeUtil.createVmomiUri(o.type,o.value,o.serverGuid);return this.generateNetworkItem(n.portgroupName,n.switchUuid,a,a,null)},e.prototype.buildNetworkItem=function(e,t){var i=t.deviceName,r=e.network,n=_.find(r,function(e){return e.name===i});if(!n)return this.generateEmptyNetworkItem();var o=n.network.network,a=this.defaultUriSchemeUtil.createVmomiUri(o.type,o.value,o.serverGuid);return this.generateNetworkItem(n.name,null,a,a,null)},e.prototype.buildOpaqueNetworkItem=function(e,t){var i=t.opaqueNetworkId,r=e.opaqueNetwork,n=_.find(r,function(e){return e.network.opaqueNetworkId===i});if(!n)return this.generateEmptyNetworkItem();var o=n.network;return this.generateNetworkItem(o.name,null,o.opaqueNetworkId,o.opaqueNetworkId,o.opaqueNetworkType)},e.prototype.generateEmptyNetworkItem=function(){return this.generateNetworkItem("",null,null,null,null)},e.prototype.generateNetworkItem=function(e,t,i,r,n){return{name:e,dvsUuid:t,networkId:i,id:r,opaqueNetworkType:n}},e.prototype.isRemoveNetworkAdapterDisabled=function(e){return!this.hasAddRemoveDevicePrivilege(e)},e.prototype.hasAddRemoveDevicePrivilege=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_ADDREMOVEDEVICE_PRIVILEGE])},e.prototype.supportsDeviceProtocol=function(e){var t=e;if(!t)return!1;var i=t.deviceProtocol;return!!i&&!(i.choiceInfo.length<2)},e.prototype.getDefaultRDMAProtocol=function(e){if(!e)return"";var t=e.deviceProtocol,i=t.choiceInfo,r=t.defaultIndex;0===r&&i.length>1&&(r=1);var n=i[r];return n.key},e.prototype.isPVRDMALimitReached=function(e,t){var i=this.getPVRDMALimit(t),r=this.getPVRDMACount(e);return r>=i},e.prototype.getPVRDMACount=function(e){var t=e.devicesOfType("VirtualVmxnet3Vrdma");if(!t||0===t.length)return 0;var i=t.length;return i},e.prototype.getPVRDMALimit=function(e){var t=this.vmHardwareUtil.getDeviceOption(e,this.PCI_CONTROLLER_TYPE),i=t.numVmxnet3VrdmaEthernetCards,r=1;return i&&(r=i.max),r},e.prototype.removeType=function(e,t){var i,r=function(e){return e.type.name!==t};return i=_.filter(e,r)},e.prototype.removePVRDMAType=function(e){var t=this.RDMA_DEVICE_CLASS;return this.removeType(e,t)},e.$inject=["$q","i18nService","dataService","defaultUriSchemeUtil","authorizationService","vmHardwareUtil","vmHardwareVersionService"],e}();e.VmHardwareNetworkService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareNetworkService",i)}(vm_ui||(vm_ui={}));var h5_vm;!function(e){var t=function(){function t(t,i,r){if(this.vm=t,this.virtualNetworkDevice=i,this.workflow=r,this.service=new e.VmHwSriovService,this.device=this.virtualNetworkDevice.getCurrentDevice(),t&&t.environment){this.configTarget=this.vm.environment.configTarget;var n=this.virtualNetworkDevice.getNetwork();this._sriovList=this.service.getSriovList(t,n);var o=this.service.getSriovInfo(this.device,this._sriovList);o&&(this._sriovValue=o)}}return t.prototype.isSriovEthernetCardType=function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualSriovEthernetCard"===e},t.prototype.unavailable=function(){return!this.available()},t.prototype.available=function(){return!!this.configTarget&&!!(this.configTarget&&this.configTarget.sriov&&this.configTarget.sriov.length>0)},t.prototype.switchToSriovAdapterType=function(){var e=this.virtualNetworkDevice.getNetwork();this._sriovList=this.service.switchToSriovAdapterType(this.device,this.vm,e),this._sriovValue=this._sriovList[0]},t.prototype.isSriovEthernetCard=function(){return this.isSriovEthernetCardType(this.device._type)},Object.defineProperty(t.prototype,"sriovValue",{get:function(){return this._sriovValue},set:function(e){this.service.assignSriovBacking(this.device,e),this._sriovValue=e},enumerable:!0,configurable:!0}),t.prototype.sriovList=function(){return this._sriovList},t.prototype.isNew=function(){return!!this.virtualNetworkDevice&&this.virtualNetworkDevice.isNew()},t.prototype.getSriovLabelText=function(){return this.isNew()?"":this.service.getSriovDeviceText(this.device,this.vm)},t.prototype.reservationIssue=function(){if(!this.vm)return!1;var e=this.vm.config,t=e.hardware.memoryMB,i=e.memoryAllocation?e.memoryAllocation.reservation:0;return t>i},Object.defineProperty(t.prototype,"allowMtuChange",{get:function(){return!!this.device&&this.device.allowGuestOSMtuChange},set:function(e){this.device&&(this.device.allowGuestOSMtuChange=e)},enumerable:!0,configurable:!0}),t.prototype.isAllowMtuChangeEditable=function(){return!!this.isNew()||this.service.isAllowMtuChangeEditable(this.vm,this.workflow)},t}();e.VmHwSriovDriver=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.NetworkInfo,i=com.vmware.vim.binding.vmodl.ManagedObjectReference,r=function(){function e(){}return e.prototype.getSriovInfo=function(){return e.makeSriovInfo()},e.prototype.getMultipleSriovInfo=function(){var e=[{_type:"com.vmware.vim.binding.vim.vm.SriovInfo",name:"",configurationTag:[],pciDevice:{_type:"com.vmware.vim.binding.vim.host.PciDevice",id:"0000:04:00.0",classId:512,bus:4,slot:0,physicalSlot:0,slotDescription:"","function":0,vendorId:-32634,subVendorId:-32634,vendorName:"Intel Corporation",deviceId:5404,subDeviceId:-24516,parentBridge:"0000:00:07.0",deviceName:"82599EB 10 Gigabit TN Network Connection"},systemId:"5b74bbaa-3542-aa1c-57c1-180373f2fec5",virtualFunction:!1,pnic:"vmnic4",devicePool:{_type:"com.vmware.vim.binding.vim.vm.SriovNetworkDevicePoolInfo",key:"5295db74-7343-6f96-d123-59974c659348",switchKey:"",switchUuid:"50 29 20 56 ec 99 0d 18-eb a1 ba b3 0a e1 06 cd"}},{_type:"com.vmware.vim.binding.vim.vm.SriovInfo",name:"",configurationTag:[],pciDevice:{_type:"com.vmware.vim.binding.vim.host.PciDevice",id:"0000:05:00.0",classId:512,bus:4,slot:0,physicalSlot:0,slotDescription:"","function":0,vendorId:-32634,subVendorId:-32634,vendorName:"Intel Corporation",deviceId:5404,subDeviceId:-24516,parentBridge:"0000:00:07.0",deviceName:"82599EB 10 Gigabit TN Network Connection"},systemId:"5b74bbaa-3542-aa1c-57c1-180373f2fec5",virtualFunction:!0,pnic:"vmnic5",devicePool:{_type:"com.vmware.vim.binding.vim.vm.SriovNetworkDevicePoolInfo",key:"5295db74-7343-6f96-d123-59974c659348",switchKey:"",switchUuid:"50 29 20 56 ec 99 0d 18-eb a1 ba b3 0a e1 06 cd"}},{_type:"com.vmware.vim.binding.vim.vm.SriovInfo",name:"",configurationTag:[],pciDevice:{_type:"com.vmware.vim.binding.vim.host.PciDevice",id:"0000:06:00.0",classId:512,bus:4,slot:0,physicalSlot:0,slotDescription:"","function":0,vendorId:-32634,subVendorId:-32634,vendorName:"Intel Corporation",deviceId:5404,subDeviceId:-24516,parentBridge:"0000:00:07.0",deviceName:"82599EB 10 Gigabit TN Network Connection"},systemId:"5b74bbaa-3542-aa1c-57c1-180373f2fec5",virtualFunction:!1,pnic:"vmnic6",devicePool:{_type:"com.vmware.vim.binding.vim.vm.SriovNetworkDevicePoolInfo",key:"5295db74-7343-6f96-d123-59974c659348",switchKey:"5295db74-7343-6f96-d123-59974c659348",switchUuid:""}}];return e},e.makeSriovInfo=function(){var e={_type:"com.vmware.vim.binding.vim.vm.SriovInfo",name:"",configurationTag:[],pciDevice:{_type:"com.vmware.vim.binding.vim.host.PciDevice",id:"0000:04:00.0",classId:512,bus:4,slot:0,physicalSlot:0,slotDescription:"","function":0,vendorId:-32634,subVendorId:-32634,vendorName:"Intel Corporation",deviceId:5404,subDeviceId:-24516,parentBridge:"0000:00:07.0",deviceName:"82599EB 10 Gigabit TN Network Connection"},systemId:"5b74bbaa-3542-aa1c-57c1-180373f2fec5",virtualFunction:!1,pnic:"vmnic4",devicePool:{_type:"com.vmware.vim.binding.vim.vm.SriovNetworkDevicePoolInfo",key:"5295db74-7343-6f96-d123-59974c659348",switchKey:"",switchUuid:"50 29 20 56 ec 99 0d 18-eb a1 ba b3 0a e1 06 cd"}};return e},e.prototype.fixContext=function(){var e={environment:{configTarget:{sriov:[this.getSriovInfo()]}}};return e.config={hardware:{memoryMB:100},memoryAllocation:{reservation:0}},e},e.prototype.makeNetworkInfo=function(){var e=new t;return e.vswitch="vswitch-1",e.network={network:new i},e},e.addSriov=function(t){t.environment.configTarget.sriov=[e.makeSriovInfo()]},e}();e.VmHwSriovFixture=r}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.SriovInfo,i=com.vmware.vim.binding.vim.vm.device.VirtualSriovEthernetCard$SriovBackingInfo,r=com.vmware.vim.binding.vim.vm.SriovNetworkDevicePoolInfo,n=com.vmware.vim.binding.vim.dvs.DistributedVirtualPortgroupInfo,o=com.vmware.vim.binding.vim.vm.NetworkInfo,a=com.vmware.vim.binding.vim.host.PciDevice,s=function(){function s(){}return s.prototype.switchToSriovAdapterType=function(e,t,i){var r=this.getSriovList(t,i);if(!r||0===r.length)return e.sriovBacking=null,[{pnic:"Unavailable"}];var n=r[0];return this.assignSriovBacking(e,n),e.allowGuestOSMtuChange=!1,r},s.prototype.assignSriovBacking=function(e,t){return t?t.pciDevice&&"auto"===t.pciDevice.deviceName?void(e.sriovBacking=null):void(e.sriovBacking=this.makeSriovBacking(t)):void delete e.sriovBacking},s.prototype.isAllowMtuChangeEditable=function(t,i){if(e.VmWorkflowMode.CreateMode===i)return!0;var r=e.VmHardwareUtil.userHasModifyDevicePermission(t);return e.VmWorkflowMode.UpdateMode===i?!e.VmHardwareUtil.isSuspended(t)&&(!e.VmHardwareUtil.isPoweredOn(t)&&r):e.VmWorkflowMode.CloneMode!==i||r},s.prototype.makeSriovBacking=function(t){var r=e.PciDeviceService.info2backing(t),n=new i;return n.physicalFunctionBacking=r,n},s.prototype.getSriovList=function(e,t){var i=e.environment.configTarget.sriov,r=this.getSriovPF(i);return this.sriovPoolConfigured(t,i)&&r.unshift(this.makeAutoimatic()),r},s.prototype.makeAutoimatic=function(){var e=new t;return e.pnic="Automatic",e.pciDevice=new a,e.pciDevice.deviceName="auto",e.label="Automatic",e},s.prototype.sriovPoolConfigured=function(e,t){if(!t||!e)return!1;var i=(new o)._type,r=(new n)._type,a=e._type,s=this.getSriovNetworkDevicePools(t);return a===i?this.IsStdSwtichOnPool(e,s):a===r&&this.isDvsSriovPool(e,s)},s.prototype.getSriovNetworkDevicePools=function(e){if(!e)return[];for(var t=[],i=(new r)._type,n=0,o=e;n<o.length;n++){var a=o[n];if(!a.virtualFunction&&a.devicePool){var s=a.devicePool._type;s===i&&t.push(a.devicePool)}}return t},s.prototype.IsStdSwtichOnPool=function(e,t){if(!t||!e)return!1;for(var i=e.vswitch,r=0,n=t;r<n.length;r++){var o=n[r];if(o.switchKey&&i===o.switchKey)return!0}return!1},s.prototype.isDvsSriovPool=function(e,t){if(!t||!e)return!1;for(var i=e.switchUuid,r=0,n=t;r<n.length;r++){var o=n[r];if(i===o.switchUuid)return!0}return!1},s.prototype.getSriovPF=function(e){if(!e)return[];for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i];if(n&&!1===n.virtualFunction){t.push(n);var o=n.pnic+" "+this.info2text(n);n.label=o}}return t},s.prototype.getSriovDeviceText=function(e,t){if(!e)return"";var i=e.sriovBacking;if(!i)return"";var r=i.physicalFunctionBacking;if(!r)return"";var n=t.environment.configTarget.sriov,o=this.getPfBackingText(r,n);return o},s.prototype.getSriovInfo=function(e,t){if(!e)return null;var i=e.sriovBacking;if(!i){var r=_.find(t,function(e){return"Automatic"===e.pnic});return r?r:null}var n=i.physicalFunctionBacking;if(!n)return null;var o=this.findSriovInfo(n,t);return o},s.prototype.getPfBackingText=function(e,t){if(!e)return"";var i=this.findSriovInfo(e,t);if(!i)return e.id;var r=this.info2text(i);return r},s.prototype.findSriovInfo=function(e,t){if(!e||!e.id||!t)return null;for(var i=e.id,r=0,n=t;r<n.length;r++){var o=n[r];if(o&&o.pciDevice.id===i)return o}return null},s.prototype.info2text=function(e){var t=e;if(!t)return"";var i=t.pciDevice.id,r=t.pciDevice.vendorName,n=t.pciDevice.deviceName,o=i+" | "+n+" "+r;return o},s}();e.VmHwSriovService=s}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").service("VmHardwareNetworkSriovService",h5_vm.VmHwSriovService);var h5_vm;!function(e){var t=e.PmemUtilService,i=function(){function e(){this.bindings={nvdimmControllerDevice:"<",removeCallback:"&",vmConfigContext:"<",vmWorkflow:"<",virtualMachineDevices:"<",selectedGuestOs:"<"},this.controller=r,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareNvdimmController/vm-hardware-nvdimm-controller.component.html"}return e}();e.VmHardwareNvdimmController=i;var r=function(){function e(e,t,i,r,n){this.i18nService=e,this.virtualNvdimmService=t,this.pmemUtilService=i,this.pmemCapacityService=r,this.$scope=n}return e.prototype.$onInit=function(){var e=this;this.deviceName=this.nvdimmControllerDevice.getCurrentDevice().deviceInfo.label,this.isRemoveDisabled=this.virtualNvdimmService.isControllerRemoveDisabled(this.vmConfigContext,this.virtualMachineDevices,this.vmWorkflow),this.listenerDeregistrationFuction=this.$scope.$on(this.virtualNvdimmService.NVDIMM_REMOVED,function(t){e.isRemoveDisabled=e.virtualNvdimmService.isControllerRemoveDisabled(e.vmConfigContext,e.virtualMachineDevices,e.vmWorkflow),e.isRemoveDisabled&&e.nvdimmControllerDevice.isMarkedForRemoval()&&e.revertNvdimmControllerRemoval()})},e.prototype.$onDestroy=function(){this.listenerDeregistrationFuction&&this.listenerDeregistrationFuction()},e.prototype.removeNvdimmController=function(){!this.isRemoveDisabled&&this.removeCallback&&this.removeCallback()(this.nvdimmControllerDevice)},e.prototype.revertNvdimmControllerRemoval=function(){this.nvdimmControllerDevice.revertRemoval()},e.prototype.getAvailablePmemCapacity=function(){return this.pmemUtilService.getAvailablePmemCapacity(this.vmConfigContext)},e.prototype.getNvDimmDeviceSummary=function(){var e=this.virtualMachineDevices.devicesOfTypeNotMarkedForRemoval(t.NVDIMM),i=this.pmemCapacityService.getTotalNvdimmMemory(this.virtualMachineDevices);return this.i18nService.getString("VmUi","NVDIMM.totalNVDIMMs",e.length,i)},e.prototype.getSupportedPmemByGuestOs=function(){return this.pmemUtilService.getSupportedPmemByGuestOs(this.selectedGuestOs);
},e.prototype.i18n=function(e,t,i){return void 0===t&&(t=""),void 0===i&&(i="VmUi"),this.i18nService.getString(i,e,t)},e.$inject=["i18nService","virtualNvdimmService","pmemUtilService","pmemCapacityService","$scope"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareNvdimmController",new i)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareOther",["i18nService",function(e){return{templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareOther/vmHardwareOther.html",controllerAs:"vmHardwareOtherCtrl",controller:function(){this.getSummaryText=function(e,t){var i=e.getCurrentDevice(),r=i.deviceInfo.summary,n=i.deviceInfo.label,o=i._type;return"com.vmware.vim.binding.vim.vm.device.VirtualKeyboard"===o||"com.vmware.vim.binding.vim.vm.device.VirtualPointingDevice"===o?n:"InputDevice"===t?r:r===n?r:n+" ("+r+")"}},link:function(t){t.i18n=e.getString}}}]).filter("deviceTypeFilter",function(){return function(e,t){return e.filter(function(e){return!e.isOfType(t)})}});var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough,i=com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough$VmiopBackingInfo,r=com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough$DeviceBackingInfo,n=function(){function n(e,t,i,r,n){this.deviceService=e,this.i18nService=t,this.deviceDiffService=i,this.vmDeviceInfoService=r,this.vmHardwareUtil=n}return n.prototype.createPciDevice=function(i,r){var o=i.configTarget,a=i.configOption.hardwareOptions.virtualDeviceOption,s=i.powerState,c=new t,l=_.find(a,function(e){return e.type.name===c._type});if(!l)throw this.newErrorDeviceNotSupported();var d=_.find(a,function(e){return"VirtualPCIController"===e.type.wsdlName}),u=16;d&&d.numPCIPassthroughDevices&&(u=d.numPCIPassthroughDevices.max);var p=r.findDevicesOfType("VirtualPCIPassthrough").length;if(p>=u)throw this.newErrorDeviceLimitReached();if(!o||!o.pciPassthrough||0===o.pciPassthrough.length)throw this.newErrorNoPCIDevices();if("poweredOn"===s&&!l.plugAndPlay)throw this.newErrorHotAddNotSupported();c.backing=n.info2backing(o.pciPassthrough[0]),c.key=this.deviceService.newKey();var v=new e.VmHwPciDevice(c,this.deviceDiffService,this.vmDeviceInfoService,this.vmHardwareUtil);return this.deviceService.setDeviceInfo(v),{device:v}},n.prototype.createPciSharedDevice=function(r,n){var o=r.configTarget,a=r.configOption.hardwareOptions.virtualDeviceOption,s=r.powerState,c=_.find(a,function(e){return"VirtualPCIPassthrough"===e.type.wsdlName});if(!c)throw this.newErrorDeviceNotSupported();var l=this.getVmiopMaxInstances(c);if(l<=0)throw this.newErrorDeviceNotSupported();var d=n.findDevicesOfType("VirtualPCIPassthrough"),u=this.countVmiopBacking(d);if(u>=l)throw this.newErrorDeviceLimitReached();if("poweredOn"===s&&!c.plugAndPlay)throw this.newErrorHotAddNotSupported();"suspended"===s&&this.newErrorHotAddNotSupported();var p=new t,v=new i,m=o.sharedGpuPassthroughTypes;v.vgpu=m&&m.length>0?m[0].vgpu:"",p.backing=v,p.key=this.deviceService.newKey();var g=new e.VmHwPciDevice(p,this.deviceDiffService,this.vmDeviceInfoService,this.vmHardwareUtil);return this.deviceService.setDeviceInfo(g),{device:g}},n.prototype.countVmiopBacking=function(e){var t=0;try{for(var i=0,r=e;i<r.length;i++){var n=r[i];n&&n.isSharedPCIBackingType()&&t++}}catch(o){}return t},n.prototype.newErrorDeviceLimitReached=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceLimitReached"))},n.prototype.newErrorDeviceNotSupported=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.DeviceNotSupported"))},n.prototype.newErrorNoPCIDevices=function(){return new Error(this.i18nService.getString("VmUi","VmDeviceManager.NoPCIDevices"))},n.prototype.newErrorHotAddNotSupported=function(){return this.newError(this.i18nService.getString,"HotAddNotSupported")},n.prototype.newError=function(e,t){var i=e("VmUi","VmDeviceManager."+t),r=new Error(i);return r},n.info2backing=function(e,t){return void 0===t&&(t=null),null===t&&(t=new r),null===e?t:(t.systemId=e.systemId,t.deviceName=e.pciDevice.deviceName,t.deviceId=e.pciDevice.deviceId.toString(16),t.id=e.pciDevice.id,t.vendorId=e.pciDevice.vendorId,t)},n.prototype.getVmiopMaxInstances=function(e){var t="com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthroughOption$VmiopBackingOption";if(!e)return 0;for(var i=e.backingOption,r=0,n=i;r<n.length;r++){var o=n[r],a=o._type;if(t===a){var s=o;return s.maxInstances?s.maxInstances:0}}return 0},n.$inject=["deviceService","i18nService","deviceDiffService","vmDeviceInfoService","vmHardwareUtil"],n}();e.PciDeviceService=n,angular.module("com.vmware.vsphere.client.vm").service("pciSharedService",n)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e}return e.prototype.$onDestroy=function(){this.inflatedDevice&&this.inflatedDevice.cleanup(),this.inflatedDevice=null},e.prototype.$onInit=function(){this.inflatedDevice?this.deviceLabel=this.inflatedDevice.deviceLabel():this.deviceLabel=""},e.prototype.i18n=function(e){if(!this.i18nService)return"";var t=this.i18nService.getString("VmUi","PciDevicePage."+e);return t},e.prototype.removeDevice=function(){this.inflatedDevice&&this.inflatedDevice.canRemove()&&this.inflatedDevice.removeDevice()},e.prototype.revertRemoval=function(){this.inflatedDevice&&this.inflatedDevice.revertRemoval()},e.prototype.isMarkedForRemoval=function(){return!!this.inflatedDevice&&this.inflatedDevice.isMarkedForRemoval()},e.prototype.isRemoveDisabled=function(){return!this.inflatedDevice||!this.inflatedDevice.canRemove()},e.prototype.deviceList=function(){if(!this.inflatedDevice)return[];try{var e=this.inflatedDevice.deviceList();return e}catch(t){return[]}},Object.defineProperty(e.prototype,"deviceValue",{get:function(){return this.inflatedDevice?this.inflatedDevice.deviceValue:null},set:function(e){this.inflatedDevice&&(this.inflatedDevice.deviceValue=e)},enumerable:!0,configurable:!0}),e.prototype.isEditDeviceValueDisabled=function(){if(!this.inflatedDevice)return!0;var e=this.inflatedDevice.deviceValue_isReadonly();return e},e.prototype.showMemorySection=function(){if(!this.inflatedDevice)return!1;var e=this.inflatedDevice.memoryUnderReserved();return e},e.prototype.showDeviceWarning=function(){return this.showMemorySection()},e.prototype.reserveAllMemory=function(e){this.inflatedDevice&&this.inflatedDevice.reserveAllMemory()},e.$inject=["i18nService"],e}();e.VmHwPciDeviceController=t;var i=function(){function e(e,i,r){void 0===e&&(e={inflatedDevice:"<"}),void 0===i&&(i=t),void 0===r&&(r="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwarePciDevice/vm-hw-pci-device.html"),this.bindings=e,this.controller=i,this.templateUrl=r}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmHwPciDevice",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){function t(e,t,r){var n=function(n){var o=new i(n,e,t,r);return o};return n}var i=function(t){function i(e,i,r,n){t.call(this,e,i,r,n),this.target=[],this.choice=[],this.option=null,this._gpuProfileInfoList=[],this._sharedGpuList=[],this._deviceValue=null,this.rawDevice=t.prototype.getCurrentDevice.call(this),this.backing=this.rawDevice.backing,this.target=[]}return __extends(i,t),i.prototype.onVmConfigAttached=function(){null!==this.vm&&(this.option=this.vm.getPciPassthoughOption(),this.rawDevice=t.prototype.getCurrentDevice.call(this),this.backing=this.rawDevice.backing,this._gpuProfileInfoList=this.vm.getGpuProfileList(),this.target=this.vm.getPciPassList(),this.buildSharedGpuList(),this.choice=this.buildDeviceList(),this._deviceValue=this.findHostPciDevice())},i.prototype.buildDeviceList=function(){if(this.isSharedPCIBackingType())return[];var e=[];if(!this.target)return this.target=[],[];for(var t=0,i=this.target;t<i.length;t++){var r=i[t],n=this.info2text(r),o=r.pciDevice.id,a=r,s={label:n,value:a,key:o};e.push(s)}return e},i.prototype.buildSharedGpuList=function(){if(this.isSharedPCIBackingType()){var e=this.sharedGpuValue,t=[];this._gpuProfileInfoList||(this._gpuProfileInfoList=[]);for(var i=0,r=this._gpuProfileInfoList;i<r.length;i++){var n=r[i];if(n){var o=n.vgpu;t.push(o)}}t.indexOf(e)<0&&t.push(e),this._sharedGpuList=t}},Object.defineProperty(i.prototype,"sharedGpuList",{get:function(){return this._sharedGpuList},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sharedGpuListIsEmpty",{get:function(){return!this._gpuProfileInfoList||0===this._gpuProfileInfoList.length},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"sharedGpuValue",{get:function(){var e=this.backing;return e?e.vgpu:""},set:function(e){var t=this.backing;t&&(t.vgpu=e)},enumerable:!0,configurable:!0}),i.prototype.sharedGpuValue_isReadonly=function(){return!!this.vm&&this.vm.isEditDeviceDisabled()},i.prototype.deviceList=function(){var e=this.choice;return e},Object.defineProperty(i.prototype,"deviceValue",{get:function(){return this._deviceValue},set:function(t){this._deviceValue=t,t&&e.PciDeviceService.info2backing(t.value,this.backing)},enumerable:!0,configurable:!0}),i.prototype.deviceValue_isReadonly=function(){return!this.isNew()},i.prototype.findHostPciDevice=function(){for(var e=this.backing,t=0,i=this.choice;t<i.length;t++){var r=i[t],n=r.value,o=this.backing.id;if(n.pciDevice.id===o)return r}var a="Unavailable("+e.id+")",s={label:a,value:null,key:-1};return this.choice.push(s),s},i.prototype.isSharedPCIBackingType=function(){var e=t.prototype.getCurrentDevice.call(this).backing,i=e._type;return!!(i&&i.toUpperCase().indexOf("VMIOP")>-1)},i.prototype.memoryUnderReserved=function(){if(!this.vm)return!1;var e=this.vm.memoryUnderReserved();return e},i.prototype.reserveAllMemory=function(){this.vm&&this.vm.reserveAllMemory()},i.prototype.canRemove=function(){if(!this.vm)return!1;var e=this.vm.canRemoveDevice(this.option);return e},i.prototype.info2text=function(e){var t=e;if(!t)return"";var i=t.pciDevice.id,r=t.pciDevice.vendorName,n=t.pciDevice.deviceName,o=i+" | "+n+" "+r;return o},i}(e.EditableVirtualDeviceClass);e.VmHwPciDevice=i,angular.module("com.vmware.vsphere.client.vm").factory("VirtualPCITs",["deviceDiffService","vmDeviceInfoService","vmHardwareUtil",t])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(){}return t.setup=function(i,r,n,o,a,s,c,l){void 0===o&&(o=11),void 0===l&&(l=!1);var d=i.vmHardwareConfigData(),u=d.vmConfigContext,p=u.environment.configOption.guestOSDescriptor[0],v=u.environment;v.powerState=a;var m=u.privileges;s||(m=_.without(u.privileges,e.Privileges.VM_EDITDEVICE_PRIVILEGE)),v.configTarget.pciPassthrough=t.getPciPassthoughFixture();var g=l?t.getPciSharedFixture():t.getPciDeviceFixture();u.config.hardware.device.push(g);var h=r.buildVirtualMachineDevices(u),f=h.getVirtualDevice(13001),S=new e.VmConfig(u,p,m,c,n);return f.attachVmConfig(S),f.removeCallback=t.removeCallback,f},t.removeCallback=function(e){e.markForRemoval()},t.getPciSharedFixture=function(){var e={_type:"com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough",key:13001,deviceInfo:{_type:"com.vmware.vim.binding.vim.Description",label:"PCI device 0",summary:"NVIDIA GRID vGPU profile1"},backing:{_type:"com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough$VmiopBackingInfo",vgpu:"profile1"},connectable:null,slotInfo:null,controllerKey:100,unitNumber:18};return e},t.getPciDeviceFixture=function(){var e={_type:"com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough",key:13001,deviceInfo:{_type:"com.vmware.vim.binding.vim.Description",label:"PCI device 1",summary:""},backing:{_type:"com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough$DeviceBackingInfo",deviceName:"",useAutoDetect:null,id:"0000:00:1d.1",deviceId:"3a35",systemId:"4f881b30-0eab-995c-46a9-e83935aed97e",vendorId:-32634},connectable:null,slotInfo:null,controllerKey:100,unitNumber:19};return e},t.getPciPassthoughFixture=function(){var e={_type:"com.vmware.vim.binding.vim.vm.PciPassthroughInfo",name:"",pciDevice:{_type:"com.vmware.vim.binding.vim.host.PciDevice",id:"0000:00:1d.1",classId:3075,bus:0,slot:29,"function":1,vendorId:-32634,subVendorId:4156,vendorName:"Intel Corporation",deviceId:14901,subDeviceId:13069,deviceName:"82801JI (ICH10 Family) USB UHCI Controller #2"},systemId:"4f881b30-0eab-995c-46a9-e83935aed97e"},t={_type:"com.vmware.vim.binding.vim.vm.PciPassthroughInfo",name:"",pciDevice:{_type:"com.vmware.vim.binding.vim.host.PciDevice",id:"0000:00:1d.2",classId:3075,bus:0,slot:29,"function":2,vendorId:-32634,subVendorId:4156,vendorName:"Intel Corporation",deviceId:14902,subDeviceId:13069,deviceName:"82801JI (ICH10 Family) USB UHCI Controller #3"},systemId:"4f881b30-0eab-995c-46a9-e83935aed97e"},i=[];return i.push(e,t),i},t.getPciSharedFixtureOld=function(){var e={_type:"com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough",key:13001,deviceInfo:{_type:"com.vmware.vim.binding.vim.Description",label:"PCI device 0",summary:"NVIDIA GRID vGPU 1"},backing:{_type:"com.vmware.vim.binding.vim.vm.device.VirtualPCIPassthrough$VmiopBackingInfo",vgpu:"1"},connectable:null,slotInfo:null,controllerKey:100,unitNumber:18};return e},t}();e.VmHwPciDeviceSetup=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e,this.removalDisabled=!0,this.pciList=[]}return e.prototype.$onInit=function(){this.inflatedDevice?this.deviceLabel=this.inflatedDevice.deviceLabel():this.deviceLabel="",this.removalDisabled=!0,this.pciList=this.inflatedDevice.deviceList()},e.prototype.i18n=function(e){if(!this.i18nService)return"";var t=this.i18nService.getString("VmUi","PciDevicePage."+e);return t},e.prototype.removeDevice=function(){this.inflatedDevice&&this.inflatedDevice.canRemove()&&this.inflatedDevice.removeDevice()},e.prototype.revertRemoval=function(){this.inflatedDevice&&this.inflatedDevice.revertRemoval()},e.prototype.isMarkedForRemoval=function(){return!!this.inflatedDevice&&this.inflatedDevice.isMarkedForRemoval()},e.prototype.isRemoveDisabled=function(){if(!this.inflatedDevice)return!0;var e=this.inflatedDevice.canRemove()===!1;return e},Object.defineProperty(e.prototype,"pluginValue",{get:function(){var e="NVIDIA GRID vGPU";return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pluginList",{get:function(){var e=["NVIDIA GRID vGPU"];return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profileList",{get:function(){var e=this.inflatedDevice.sharedGpuList;return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"profile",{get:function(){if(!this.inflatedDevice)return"";var e=this.inflatedDevice.sharedGpuValue;return e},set:function(e){this.inflatedDevice&&(this.inflatedDevice.sharedGpuValue=e)},enumerable:!0,configurable:!0}),e.prototype.isProfileValueDisabled=function(){if(!this.inflatedDevice)return!0;var e=this.inflatedDevice.sharedGpuValue_isReadonly();return e},e.prototype.isProfileInputVisible=function(){if(!this.inflatedDevice)return!1;var e=this.inflatedDevice.sharedGpuListIsEmpty;return e},e.prototype.isProfileSelectVisible=function(){if(!this.inflatedDevice)return!1;var e=!this.inflatedDevice.sharedGpuListIsEmpty;return e},e.prototype.showMemorySection=function(){if(!this.inflatedDevice)return!1;var e=this.inflatedDevice.memoryUnderReserved();return e},e.prototype.showDeviceWarning=function(){return this.showMemorySection()},e.prototype.reserveAllMemory=function(e){this.inflatedDevice&&this.inflatedDevice.reserveAllMemory()},e.$inject=["i18nService"],e}();e.VmHwPciSharedController=t;var i=function(){function e(e,i,r){void 0===e&&(e={inflatedDevice:"<"}),void 0===i&&(i=t),void 0===r&&(r="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwarePciDevice/vm-hw-pci-shared.html"),this.bindings=e,this.controller=i,this.templateUrl=r}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmHwPciShared",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.VmWorkflowMode,i=e.VmDisplayMode,r=e.VmStorageProfileMetadata,n=e.VmStorageBrowserMetadata,o=com.vmware.vim.binding.vim.StorageResourceManager$IOAllocationInfo,a=com.vmware.vim.binding.vim.SharesInfo,s=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v){this.$q=e,this.$rootScope=t,this.$scope=i,this.$timeout=r,this.i18nService=n,this.virtualDiskSettingsFormService=o,this.storageProfileService=a,this.vmHardwareRdmVirtualDiskService=s,this.vmHardwareVirtualDiskService=c,this.datastoreService=l,this.vmDeviceInfoService=d,this.defaultUriSchemeUtil=u,this.basicDiskUtilService=p,this.vmCryptUtilService=v,this.diskLocationError=!1,this.isDiskProfileValid=!0,this.isComponentInitiailized=!1,this.VIRTUAL_COMPATIBILITY_MODE="virtualMode",this.PHYSICAL_COMPATIBILITY_MODE="physicalMode",this.DELETE_FILE_FROM_DISK_OPERATION="destroy",this.i18n=function(e,t){return void 0===t&&(t="VmUi"),n.getString(t,e)},this.subscribeToDeviceEvents()}return e.prototype.isNewDevice=function(){return!!this.isComponentInitiailized&&this.inflatedDevice.isNew()},e.prototype.$onInit=function(){var e=this;this.buildSettingsForm().then(function(){e.setStorageProfileMetadata(),e.setSharingInfo(),e.setLocationBrowserMetadata(),e.setSharesInfo(),e.setDeviceNodeInfo(),e.setCompatibilityMode(),e.setDiskMode(),e.setIopsLimit(),e.setPhysicalLunInfo(),e.setDiskFile(),e.setFlashCacheInfo(),e.setSelectedStorage(),e.checkDiskLocationError(),e.setupExpandChangeListener(),e.deviceLabel=e.inflatedDevice.getCurrentDevice().deviceInfo.label,e.locationLabel=e.i18n("DiskPage.Location"),e.diskFileLabel=e.i18n("DiskPage.DiskFile"),e.sharingLabel=e.i18n("DiskPage.Sharing"),e.sharesLabel=e.i18n("DiskPage.Shares"),e.revertRemovalLabel=e.i18n("DiskPage.revertRemoval"),e.removeLabel=e.i18n("DiskPage.remove"),e.cacheReservationLabel=e.i18n("DiskPage.CacheReservation"),e.iopsLimitLabel=e.i18n("DiskPage.LimitIOPs"),e.deviceRemovedLabel=e.i18n("RemoveDevice.DeviceRemoved"),e.deleteFilesLabel=e.i18n("DeviceDeletedControl.DeleteFiles"),e.storageProfileLabel=e.i18n("DiskPage.Profile"),e.physicalLunLabel=e.i18n("DiskPage.PhysicalLUN"),e.diskModeLabel=e.i18n("DiskPage.DiskMode"),e.compatibilityModeLabel=e.i18n("DiskPage.CompatibilityMode"),e.deviceNodeLabel=e.i18n("DiskPage.VirtualDeviceNode"),e.isCreateMode=e.displayMode===i.CreateMode,e.diskProfileErrorConfig={message:e.i18n("DiskConfig.ErrorCrypt2RDM"),isVisible:!1},e.vmStorageProfileMetadata?e.onStorageProfileChange(e.vmStorageProfileMetadata.selectedProfile):e.checkEncryptionWarning(),e.isComponentInitiailized=!0,e.destroyDisk=e.inflatedDevice.getDiskFileOperation()===e.DELETE_FILE_FROM_DISK_OPERATION})},e.prototype.deviceEventCallback=function(e,t){if(t){var i=t.deviceType;t.deviceKey===this.inflatedDevice.getKey()&&this.inflatedDevice.isNew()&&this.$rootScope.$broadcast(this.vmHardwareVirtualDiskService.DISKS_UPDATED),this.vmHardwareRdmVirtualDiskService.isDiskController(i)&&this.rebuildControllersDropdown()}},e.prototype.subscribeToDeviceEvents=function(){var e=this.deviceEventCallback.bind(this);this.$scope.$on("deviceAdded",e),this.$scope.$on("deviceRemoved",e)},e.prototype.rebuildControllersDropdown=function(){var e=this.virtualMachineDevices.getAllDevicesNotMarkedForRemoval(),t=this.virtualDiskSettingsFormService.buildControllersDropdown(this.inflatedDevice,e);this.settingsForm.controllers=t},e.prototype.$onChanges=function(e){e.vmConfigContext&&e.vmConfigContext.currentValue&&this.vmConfigContext.vmProfile&&this.checkEncryptionWarning()},Object.defineProperty(e.prototype,"shouldDisplayStorageProfile",{get:function(){return this.expanded&&(this.inflatedDevice.isNew()||this.vmWorkflowMode===t.UpdateMode)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayPhysicalLun",{get:function(){return this.expanded&&!(!this.physicalLunInfo||!this.physicalLunInfo.name)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayCompatibilityMode",{get:function(){return this.expanded&&!this.inflatedDevice.isCreatedFromExistingDisk()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayDiskMode",{get:function(){return this.expanded&&this.inflatedDevice.getCurrentDevice().backing.compatibilityMode===this.VIRTUAL_COMPATIBILITY_MODE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldDisplayFlashCache",{get:function(){return this.expanded&&this.flashCacheInfo&&this.flashCacheInfo.vFlashSupportedOnHost},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCompatibilityModeEditable",{get:function(){return this.inflatedDevice.isNew()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFlashCacheReservationDisabled",{get:function(){return this.inflatedDevice.getCurrentDevice().backing.compatibilityMode===this.PHYSICAL_COMPATIBILITY_MODE||this.vmHardwareRdmVirtualDiskService.isEditFlashReadCacheDisabled(this.vmConfigContext.privileges,this.isNewDevice())},enumerable:!0,configurable:!0}),e.prototype.isEditIopsLimitDisabled=function(){return this.isSharesDisabled()},e.prototype.isSharesDisabled=function(){return this.vmHardwareRdmVirtualDiskService.isSharesOrLimitDisabled(this.vmConfigContext.privileges,this.isNewDevice())},e.prototype.isEncryptionProfileApplied=function(){return this.inflatedDevice.isEncryptionProfileApplied()},e.prototype.onLocationChange=function(e,t){this.updateSelectedProfile(e),this.inflatedDevice.updateFileName("["+t.name+"]"),this.inflatedDevice.updateDiskProfile(e),this.setStorageForDisk({storageInfo:t,device:this.inflatedDevice.getCurrentDevice()}),this.inflatedDevice.updateDatastoreMor(t.storageObject.storageRef)},e.prototype.onDiskDistroyStatusChange=function(){this.vmHardwareRdmVirtualDiskService.onDiskDistroyStatusChange(this.destroyDisk,this.inflatedDevice)},e.prototype.isRemoveDisabled=function(){return this.vmWorkflowMode===t.UpdateMode&&this.vmHardwareRdmVirtualDiskService.isRemoveRdmDiskDisabled(this.vmConfigContext.privileges)},e.prototype.onRemove=function(){!this.isRemoveDisabled()&&this.removeCallback&&this.removeCallback()(this.inflatedDevice)},e.prototype.markedForRemoval=function(){return this.inflatedDevice.isMarkedForRemoval()},e.prototype.revertRemoval=function(){this.inflatedDevice.revertRemoval()},e.prototype.errorMessages=function(){return{}},e.prototype.validators=function(){return[{name:"non-zero",validate:function(e){return 0!==e},message:this.i18n("DiskConfig.ErrorCapacityZero")}]},e.prototype.hasError=function(){var e=this.getFormName();return!_.isEmpty(this[e])&&(this.updateLocationValidity(e),this[e].$invalid)},e.prototype.expandedChanged=function(e){this.expanded!==e&&(this.expanded=e,this.expanded&&this.isGroupingHardDisks&&this.$rootScope.$broadcast(this.vmHardwareVirtualDiskService.DISK_STACK_EXPANDED,{deviceKey:this.inflatedDevice.getKey()}))},e.prototype.setupExpandChangeListener=function(){var e=this;this.$rootScope.$on(this.vmHardwareVirtualDiskService.DISK_STACK_EXPANDED,function(t,i){e.inflatedDevice.getKey()!==i.deviceKey&&(e.expanded=!1)})},e.prototype.updateLocationValidity=function(e){this[e].$setValidity("disk-location",!this.diskLocationError),this.updateFormValidity(this[e])},e.prototype.isVmPoweredOn=function(){return this.vmHardwareRdmVirtualDiskService.isPoweredOn(this.vmConfigContext)},e.prototype.isDiskModeDisabled=function(){return this.vmHardwareRdmVirtualDiskService.isDiskModeDisabled(this.inflatedDevice,this.vmWorkflowMode,this.vmConfigContext)},e.prototype.getFormName=function(){return this.formKey=this.inflatedDevice.getKey().toString().replace("-","__"),"vmHardwareRdmVirtualDisk"+this.formKey},e.prototype.onCompatibilityModeChange=function(e){this.inflatedDevice.updateCompatibilityMode(e)},e.prototype.onStorageProfileChange=function(e){this.updateSelectedProfile(e),this.inflatedDevice.updateDiskProfile(e),this.checkEncryptionWarning(),this.$rootScope.$broadcast(this.vmHardwareVirtualDiskService.DISKS_UPDATED)},e.prototype.onSharingChange=function(e){this.inflatedDevice.updateSharing(e.value)},e.prototype.onFlashCacheReservationChange=function(e){this.inflatedDevice.updateFlashCacheReservation(e)},e.prototype.ensureIOAllocation=function(){var e=this.inflatedDevice.getCurrentDevice();e.storageIOAllocation||(e.storageIOAllocation=new o),e.storageIOAllocation.shares||(e.storageIOAllocation.shares=new a)},e.prototype.onSharesChange=function(e){this.ensureIOAllocation(),this.inflatedDevice.updateShares(e)},e.prototype.onIopsLimitChange=function(e){this.ensureIOAllocation(),this.inflatedDevice.updateStorageIOAllocation(e)},e.prototype.onDiskControllerChange=function(e,t){t&&this.inflatedDevice.updateControllerAndNodeKeys(e.getKey(),t.key)},e.prototype.onDiskModeChange=function(e){this.inflatedDevice.updateDiskMode(e)},e.prototype.hasChanged=function(){return this.inflatedDevice.hasChanged()},e.prototype.setFlashCacheInfo=function(){this.flashCacheInfo=this.vmHardwareRdmVirtualDiskService.getFlashCacheReservationInfo(this.inflatedDevice.getCurrentDevice(),this.vmConfigContext.environment.hostCapability.vFlashSupported)},e.prototype.setSelectedStorage=function(){var e=this.inflatedDevice.getCurrentDevice();if(this.getStorageForDisk&&this.inflatedDevice.isNew()){var t=this.getStorageForDisk({diskKey:e.key});t&&(this.selectedStorage={key:t.diskKey,id:t.dsId,name:t.dsName,storageObject:t.dsObject})}},e.prototype.setStorageProfileMetadata=function(){var e=this;this.settingsForm||this.buildSettingsForm(),this.settingsForm.storageProfile&&!this.settingsForm.storageProfile.selection&&this.settingsForm.storageProfile.options.some(function(t){return"defaultId"===t.id&&(e.settingsForm.storageProfile.selection=t,!0)}),this.settingsForm.storageProfile&&(this.vmStorageProfileMetadata=new r(this.settingsForm.storageProfile.options,this.settingsForm.storageProfile.selection))},e.prototype.updateSelectedProfile=function(e){this.vmStorageProfileMetadata=new r(this.vmStorageProfileMetadata.storageProfiles,e)},e.prototype.checkEncryptionWarning=function(){this.updateDiskProfileValidity(!this.isEncryptionProfileApplied())},e.prototype.updateDiskProfileValidity=function(e){this.isDiskProfileValid=e,this.diskProfileErrorConfig&&(this.diskProfileErrorConfig.isVisible=!e);var t=this[this.getFormName()];if(t){var i=t["storage-profile"];i&&(i.$invalid=!e),t.$setValidity("diskProfile",e),this.updateFormValidity(t)}},e.prototype.updateFormValidity=function(e){e.$invalid=!this.isDiskProfileValid||!!this.diskLocationError},e.prototype.setIopsLimit=function(){this.iopsLimit=this.vmHardwareRdmVirtualDiskService.getIopsLimit(this.inflatedDevice)},e.prototype.setLocationBrowserMetadata=function(){var e={storageLocatorItemsData:this.storageLocatorItemsData};this.vmStorageBrowserMetadata=new n(e)},e.prototype.checkDiskLocationError=function(){var e=this,t=this.datastoreService.findDatastore(this.vmStorageId,this.vmConfigContext.environment.configTarget);if(null===t){var i=_.filter(this.vmConfigContext.environment.configTarget.datastore,function(e){return e.capability.rawDiskMappingsSupported}),r=_.filter(this.storageLocatorItemsData.datastoreItems,function(t){return e.defaultUriSchemeUtil.getVsphereObjectId(t.parentStoragePod)===e.vmStorageId});t=i[_.findLastIndex(i,{name:r[0].name})]}this.inflatedDevice.getCurrentDevice().key>0||t&&t.capability.rawDiskMappingsSupported&&this.inflatedDevice.getCurrentDevice().key<0?this.diskLocationError=!1:this.diskLocationError=!0},e.prototype.setCompatibilityMode=function(){this.compatibilityModeInfo=this.vmHardwareRdmVirtualDiskService.getCompatibilityModeInfo(this.vmConfigContext,this.inflatedDevice,this.virtualMachineDevices.getAllDevicesNotMarkedForRemoval())},e.prototype.setDiskMode=function(){this.diskModeInfo=this.vmHardwareRdmVirtualDiskService.getDiskModeInfo(this.vmConfigContext,this.inflatedDevice,this.virtualMachineDevices.getAllDevicesNotMarkedForRemoval())},e.prototype.setSharingInfo=function(){this.settingsForm||this.buildSettingsForm(),this.sharingInfo={sharingOptions:this.settingsForm.sharing.options,selectedSharing:this.settingsForm.sharing.selection,enableSharing:this.vmHardwareRdmVirtualDiskService.enableSharing(this.vmConfigContext,this.inflatedDevice)}},e.prototype.setSharesInfo=function(){this.settingsForm||this.buildSettingsForm(),this.sharesContext={sharesId:this.getFormName(),shareMin:this.settingsForm.shares.min,shareMax:this.settingsForm.shares.max,sharesInfo:{level:this.settingsForm.shares.value.level,shares:this.settingsForm.shares.value.shares},sharesLevelPresetOptions:this.settingsForm.shares.presetOptions,showRecommendations:!1}},e.prototype.setDeviceNodeInfo=function(){var e=this.inflatedDevice.getKey().toString().replace("-","__"),t="editVirtualDeviceController"+e,i="editVirtualDeviceNode"+e;this.deviceNodeInfo={inflatedDevice:this.inflatedDevice,virtualMachineDevices:this.virtualMachineDevices,controllerNodeSelectorName:i,controllerSelectorName:t,virtualDiskSettingsForm:this.settingsForm,vmConfigContext:this.vmConfigContext}},e.prototype.setPhysicalLunInfo=function(){this.physicalLunInfo={name:this.inflatedDevice.getCurrentDevice().backing.deviceName}},e.prototype.setDiskFile=function(){var e=this.inflatedDevice.getCurrentDevice();e&&e.backing&&e.backing.fileName&&(this.displayDiskFile=this.expanded&&this.vmWorkflowMode!==t.CloneMode,this.diskFile=e.backing.fileName)},e.prototype.getDiskText=function(){if(!this.capacity)return"";var e=this.basicDiskUtilService.determineDisplayDiskSize(this.capacity.valueInMB);return e?this.basicDiskUtilService.roundToPrecision(e.size,2).toString()+" "+e.unitText:""},e.prototype.getSelectedVirtualNodeText=function(){if(this.deviceNodeInfo&&this.deviceNodeInfo.virtualDiskSettingsForm&&this.deviceNodeInfo.virtualDiskSettingsForm.controllers){var e=this.deviceNodeInfo.virtualDiskSettingsForm.controllers.selection.getCurrentDevice();if(e)return this.vmDeviceInfoService.getControllerAndNodeLabelText(e._type,e.busNumber,this.inflatedDevice.getCurrentDevice().unitNumber)}return""},e.prototype.buildSettingsForm=function(){var e=this;return this.$q.all(this.getAllBackendStorageCallPromises()).then(function(i){if(e.storageProfiles=i.storageProfilesPromiseResult,e.vmAssignmentsProperties=i.vmAssignmentsPromiseResult||{},e.vmWorkflowMode===t.UpdateMode&&e.vmAssignmentsProperties&&e.vmAssignmentsProperties.vmStorageProfileAssignments&&e.storageProfiles&&!e.inflatedDevice.isNew()){var r=e.storageProfileService.makeProfileFromDevice(e.inflatedDevice.getCurrentDeviceSpec().device,e.storageProfiles,e.vmAssignmentsProperties.vmStorageProfileAssignments);e.inflatedDevice.setOriginalProfile(r)}e.diskLocationError=!1,e.settingsForm=e.vmHardwareRdmVirtualDiskService.buildSettingsForm(e.vmAssignmentsProperties.vmStorageProfileAssignments,e.vmWorkflowMode,e.vmConfigContext,e.inflatedDevice,e.vmStorageId,e.selectedStorageProfile,e.storageProfiles,e.virtualMachineDevices),e.capacity={validUnits:e.settingsForm.capacity.validUnits,maxInMB:e.settingsForm.capacity.maxInMB,minInMB:e.settingsForm.capacity.minInMB,valueInMB:e.settingsForm.capacity.valueInMB,memoryUnitPreferred:e.settingsForm.capacity.memoryUnitPreferred.label}})},e.prototype.getAllBackendStorageCallPromises=function(){return this.vmAssignmentsProperties&&this.vmWorkflowMode===t.UpdateMode?this.vmHardwareVirtualDiskService.getAllBackendStorageCallPromises(this.$q,this.vmAssignmentsProperties,this.storageProfiles):{storageProfilesPromiseResult:this.storageProfiles,vmAssignmentsPromiseResult:this.vmAssignmentsProperties}},e.prototype.isExpandable=function(){return!!this.settingsForm},e.$inject=["$q","$rootScope","$scope","$timeout","i18nService","virtualDiskSettingsFormService","storageProfileService","vmHardwareRdmVirtualDiskService","vmHardwareVirtualDiskService","datastoreService","vmDeviceInfoService","defaultUriSchemeUtil","basicDiskUtilService","vmCryptUtilService"],
e}(),c=function(){function e(){this.bindings={vmWorkflowMode:"<",displayMode:"<",inflatedDevice:"<",vmStorageId:"@",vmConfigContext:"<",virtualMachineDevices:"<",getStorageForDisk:"&",storageProfiles:"<",isVmEncrypted:"<",selectedStorageProfile:"<",storageLocatorItemsData:"<",vmAssignmentsProperties:"<",computeResourceId:"<",removeCallback:"&",vmId:"<",showStoragePods:"<",expanded:"=",vmStorageObject:"<",setStorageForDisk:"&",isGroupingHardDisks:"<"},this.controller=s,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareRDMVirtualDisk/vm-hardware-rdm-virtual-disk.html"}return e}();e.VmHardwareRdmVirtualDisk=c,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareRdmVirtualDisk",new c)}(h5_vm||(h5_vm={}));var vm_ui;!function(e){var t=h5_vm.VmWorkflowMode,i=h5_vm.DeviceType,r=function(){function e(e,t,i,r,n,o,a,s){this.deviceClassLineageService=e,this.virtualDiskSettingsFormService=t,this.vmHardwareVirtualDiskSharesService=i,this.vmHardwareVirtualDiskCompatibilityModeService=r,this.vmHardwareVirtualDiskModeService=n,this.vmHardwareVirtualDiskIopsService=o,this.vmHardwareVirtualDiskFlashReadCacheService=a,this.vmHardwareUtil=s}return e.prototype.buildSettingsForm=function(e,i,r,n,o,a,s,c){return this.virtualDiskSettingsFormService.build(e,i===t.CreateMode||i===t.CloneMode,r,n,o,a,s,c)},e.prototype.isPoweredOn=function(e){return"poweredOn"===e.environment.powerState},e.prototype.enableSharing=function(e,t){return!(this.isPoweredOn(e)&&!t.isNew())},e.prototype.onDiskDistroyStatusChange=function(e,t){e?t.setDiskFileOperation("destroy"):t.setDiskFileOperation(null)},e.prototype.isEditFlashReadCacheDisabled=function(e,t){return this.vmHardwareVirtualDiskFlashReadCacheService.isEditFlashReadCacheDisabled(e,t)},e.prototype.isSharesOrLimitDisabled=function(e,t){if(t)return!1;var i=[h5_vm.Privileges.VM_RAWDEVICE_PRIVILEGE,h5_vm.Privileges.VM_CONFIG_RESOURCE];return!this.vmHardwareUtil.checkPrivileges(e,i)},e.prototype.isRemoveRdmDiskDisabled=function(e){return!this.hasPrivilegesToRemoveDisk(e)},e.prototype.hasPrivilegesToRemoveDisk=function(e){return this.vmHardwareUtil.checkPrivileges(e,[h5_vm.Privileges.VM_RAWDEVICE_PRIVILEGE])},e.prototype.isDiskModeDisabled=function(e,i,r){return this.vmHardwareVirtualDiskModeService.isEditDiskModeDisabled(e,i===t.CreateMode,r)},e.prototype.getCompatibilityModeInfo=function(e,t,i){return this.vmHardwareVirtualDiskCompatibilityModeService.getCompatibilityModeInfo(e,t,i)},e.prototype.getDiskModeInfo=function(e,t,i){return this.vmHardwareVirtualDiskModeService.getDiskModeInfo(e,t,i)},e.prototype.getIopsLimit=function(e){return this.vmHardwareVirtualDiskIopsService.getIopsLimit(e)},e.prototype.getFlashCacheReservationInfo=function(e,t){return this.vmHardwareVirtualDiskFlashReadCacheService.getFlashCacheReservationInfo(e,t)},e.prototype.isDiskController=function(e){var t=this,r=function(e,i){return e===i||t.deviceClassLineageService.isClassNameSubclassOf(e,i)},n=r(e,i.SCSICONTROLLER),o=r(e,i.VIRTUAL_SATA_CONTROLLER),a=r(e,i.NVME_CONTROLLER),s=r(e,i.IDE);return n||o||a||s},e.$inject=["deviceClassLineageService","virtualDiskSettingsFormService","vmHardwareVirtualDiskSharesService","vmHardwareVirtualDiskCompatibilityModeService","vmHardwareVirtualDiskModeService","vmHardwareVirtualDiskIopsService","vmHardwareVirtualDiskFlashReadCacheService","vmHardwareUtil"],e}();e.VmHardwareRdmVirtualDiskService=r,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareRdmVirtualDiskService",r)}(vm_ui||(vm_ui={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.i18nService=e,this.deviceClassLineageService=t,this.VmController=i,this.vmHardwareScsiControllerService=r,this.LBL_TYPE=this.i18n("SCSIControllerPage.ChangeType"),this.LBL_SHARING=this.i18n("SCSIControllerPage.SCSIBusSharing")}return e.prototype.i18n=function(e,t){return void 0===t&&(t="VmUi"),this.i18nService.getString(t,e)},e.prototype.$onInit=function(){var e=this;this.device=this.inflatedDevice.getCurrentDevice();var t=this.vmConfigContext.environment.configOption.hardwareOptions.virtualDeviceOption,i=new this.VmController(this.device,t);this.deviceName=this.getSCSIName(this.device._type),this.scsiTypeList=this.getSCSITypeList(t),this.busSharingList=_.map(i.sharingOptions(),function(t){return e.createSharingListItem(t)}),this.unsupportedWarning=this.getUnsupportedWarning(this.inflatedDevice.getCurrentDevice()._type),this.properties={selectedScsiType:{name:this.deviceName,id:this.device._type},selectedBusSharing:this.createSharingListItem(this.device.sharedBus)}},e.prototype.onScsiControllerTypeChange=function(){var e=this.properties.selectedScsiType.id;this.deviceName=this.getSCSIName(e),this.inflatedDevice.getCurrentDevice()._type=e,this.unsupportedWarning=this.getUnsupportedWarning(this.inflatedDevice.getCurrentDevice()._type)},e.prototype.onScsiControllerRemove=function(){this.isRemoveScsiControllerEnabled()&&this.removeCallback&&this.removeCallback()(this.inflatedDevice)},e.prototype.onScsiBusSharingChange=function(){this.inflatedDevice.getCurrentDevice().sharedBus=this.properties.selectedBusSharing.id},e.prototype.isRemoveScsiControllerEnabled=function(){return this.createMode?!this.isControllerInUse():!(this.isControllerInUse()||!this.vmHardwareScsiControllerService.hasAddRemoveDevicePrivilege(this.vmConfigContext.privileges))&&!this.isVmInSuspendedState()},e.prototype.isEditScsiControllerDisabled=function(){return this.vmHardwareScsiControllerService.isEditScsiControllerDisabled(this.vmConfigContext.environment.powerState,this.vmConfigContext.privileges,this.inflatedDevice.isNew())},e.prototype.isVmInPoweredOnState=function(){return"poweredOn"===this.vmConfigContext.environment.powerState},e.prototype.isVmInSuspendedState=function(){return"suspended"===this.vmConfigContext.environment.powerState},e.prototype.getUnsupportedWarning=function(e){var t=_.findIndex(this.selectedGuestOs.supportedDiskControllerList,function(t){return t.typeClass===e});return t<0?this.i18n("SCSIControllerConfig.NotRecommended"):void 0},e.prototype.getSCSITypeList=function(e){var t=this,i=_.select(e,function(e){return t.deviceClassLineageService.isClassNameSubclassOf(e.type.name,"VirtualSCSIController")}),r=_.map(i,function(e){return{name:t.getSCSIName(e.type.name),id:e.type.typeClass}});return r},e.prototype.getSCSIName=function(e){var t=_.last(e.split("."));return this.i18n("SCSIControllerConfig."+t)},e.prototype.createSharingListItem=function(e){return{name:this.i18n("SCSIControllerConfig."+e),id:e}},e.prototype.isControllerInUse=function(){var e=this.virtualMachineDevices.getDevicesAttachedToControllerKey(this.inflatedDevice.getKey());return e.length>0},e.$inject=["i18nService","deviceClassLineageService","VmController","vmHardwareScsiControllerService"],e}(),i=function(){function e(){this.bindings={inflatedDevice:"<",createMode:"<",vmConfigContext:"<",virtualMachineDevices:"<",selectedGuestOs:"<",removeCallback:"&",expanded:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareScsiController/vmHardwareScsiController.html"}return e}();e.VmHardwareScsiController=i,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareScsiController",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=function(){function e(e){this.vmHardwareUtil=e}return e.prototype.isEditScsiControllerDisabled=function(e,t,i){return!i&&(this.vmHardwareUtil.isVmPoweredOn(e)||!this.hasPrivilegesToEdit(t,i))},e.prototype.hasPrivilegesToEdit=function(e,i){return!!i||this.vmHardwareUtil.checkPrivileges(e,[t.VM_EDITDEVICE_PRIVILEGE])},e.prototype.hasAddRemoveDevicePrivilege=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_ADDREMOVEDEVICE_PRIVILEGE])},e.$inject=["vmHardwareUtil"],e}();e.VmHardwareScsiControllerService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareScsiControllerService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r){var n=this;this.$scope=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.datastoreBrowserConstants=r,this.formData={selectedTreeItem:null,fileName:""},this.i18n=function(e,i){return void 0===i&&(i="VmUi"),t.getString(i,e)},this.dsFileBrowserData=this.getDatastoreFileBrowserData(),this.setFilePathForSubmitCallback(),e.$watchCollection(function(){return n.formData},this.validateForm.bind(this))}return e.prototype.hasValidFileNameAndFolderLocation=function(){var e=this.formData.fileName.length>0,t=this.formData.selectedTreeItem;return e&&t},e.prototype.getFilePath=function(){return this.formData.selectedTreeItem.path+"/"+this.formData.fileName},e.prototype.validateForm=function(){this.$scope.modalOptions.submitDisabled=!this.hasValidFileNameAndFolderLocation()},e.prototype.setFilePathForSubmitCallback=function(){var e=this,t=this.$scope.modalOptions.onSubmit;this.$scope.modalOptions.onSubmit=function(){var i=e.getFilePath();t(i),e.$scope.destroyModal()}},e.prototype.getDatastoreFileBrowserData=function(){var e=this,t=this.$scope.modalOptions.dialogData.vmId,i=this.$scope.modalOptions.dialogData.vmConfigContext,r=i.environment.configTarget.datastore,n=r.map(function(t){return e.defaultUriSchemeUtil.getVsphereObjectId(t.datastore.datastore)}),o=this.datastoreBrowserConstants.fileQueryType.ALL_FILES;return{vmId:t,datastoreIds:n,initialFileQueryType:o,showVmImagesFolder:!0,disablePreselect:!0}},e.$inject=["$scope","i18nService","defaultUriSchemeUtil","datastoreBrowserConstants"],e}();angular.module("com.vmware.vsphere.client.vm").controller("vmHardwareSerialPortFileBrowserController",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.clarityModalService=t,this.defaultUriSchemeUtil=i,this.i18n=function(t,i){return void 0===i&&(i="VmUi"),e.getString(i,t)}}return e.prototype.openFileBrowserModal=function(e,t){var i=this.defaultUriSchemeUtil.getVsphereObjectId(e.environment.datastoreBrowser),r={title:this.i18n("SerialPortPage.FileBrowser.Title"),submitButtonTitle:this.i18n("SerialPortPage.FileBrowser.Save"),contentTemplate:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareSerialPort/vm-hardware-serial-port-file-browser.html",defaultButton:"submit",size:"lg",onSubmit:t,onCancel:function(){},dialogData:{vmId:i,vmConfigContext:e}};this.clarityModalService.openOkCancelModal(r)},e.$inject=["i18nService","clarityModalService","defaultUriSchemeUtil"],e}();e.VmHardwareSerialPortService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareSerialPortService",t)}(h5_vm||(h5_vm={}));var VmHwSerialPort=h5_vm.VmHwSerialPort,VmHwSerialPortLabels=function(){function e(){}return e.prototype.initialize=function(e){this.REMOVING=e("RemoveDevice.DeviceRemoved"),this.CONNECTED=e("ConnectDevice.Connected"),this.START_CONNECTED=e("ConnectDevice.ConnectAtPowerOn"),this.START_CONNECTED_SHORT=e("ConnectDevice.ConnectAtPowerOnShort");var t=function(t){return e("SerialPortPage."+t)};this.STATUS=t("Status"),this.CONNECTION=t("Connection"),this.OUTPUT_FILE=t("ConnectedFile"),this.FILE_PLACEHOLDER=t("ConnectedFile.Placeholder"),this.BROWSE=t("Browse"),this.PHYSICAL=t("Device"),this.PIPE_NAME=t("PipeName"),this.NEAR_END=t("NearEnd"),this.FAR_END=t("FarEnd"),this.IO_MODE=t("IOMode"),this.YIELD_CPU=t("YieldCPU"),this.DIRECTION=t("Direction"),this.PORT_URI=t("PortURI"),this.USE_VSPCURI=t("UseVSPC"),this.VSPCURI=t("VSPCURI");var i=function(t){return e("SerialPortConfig."+t)};this.CLIENT=i("client"),this.SERVER=i("server"),this.PIPE_FAR_END_VM=i("Vm"),this.PIPE_FAR_END_PROCESS=i("Process")},e}(),h5_vm;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.vmHardwareSerialPortService=t,this.LABELS=new VmHwSerialPortLabels,this.i18n=function(t,i){return void 0===i&&(i="VmUi"),e.getString(i,t)},this.LABELS.initialize(this.i18n)}return Object.defineProperty(e.prototype,"ID",{get:function(){return this.port.key?this.port.key.toString():"0"},enumerable:!0,configurable:!0}),e.prototype.$onInit=function(){this.port.attachLabels(this.i18n),this.port.isNew()&&(this.expanded=!0)},Object.defineProperty(e.prototype,"hasChanged",{get:function(){return this.port.hasChanged()},enumerable:!0,configurable:!0}),e.prototype.revalidate=function(){var e=this.port.isValid();return this.setValidity(e),e},e.prototype.setValidity=function(e){this.form&&this.form.$setValidity("",e,this.form)},e.prototype.remove=function(){this.port.removeDevice(),this.expanded=!1},Object.defineProperty(e.prototype,"isRemoveDisabled",{get:function(){return this.port.removeDisabled()},enumerable:!0,configurable:!0}),e.prototype.restore=function(){this.port.revertRemoval()},Object.defineProperty(e.prototype,"NotMarkedForRemoval",{get:function(){return!0!==this.port.isMarkedForRemoval()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMarkedForRemoval",{get:function(){return this.port.isMarkedForRemoval()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceLabel",{get:function(){return this.port.deviceLabel()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"connected",{get:function(){return this.port.connected},set:function(e){this.port.connected=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isConnectDisabled",{get:function(){return this.port.isConnectDeviceDisabled()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditDisabled",{get:function(){return this.port.isEditDeviceDisabled()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startConnected",{get:function(){return this.port.startConnected},set:function(e){this.port.startConnected=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backingValue",{get:function(){return this.port.backing},set:function(e){this.expanded=!0,this.port.backing=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"backingList",{get:function(){return this.port.backingList},enumerable:!0,configurable:!0}),e.prototype.getBackingLabel=function(e){var t=this,i=function(e){return t.i18n("SerialPortConfig."+e)};return e.indexOf("FileBacking")>-1?i("File"):e.indexOf("DeviceBacking")>-1?i("Device"):e.indexOf("PipeBacking")>-1?i("Pipe"):e.indexOf("URIBacking")>-1?i("Network"):""},Object.defineProperty(e.prototype,"showFileBacking",{get:function(){return this.port.hasFileBacking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"yield",{get:function(){return this.port["yield"]},set:function(e){this.port["yield"]=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"file",{get:function(){return this.port.file},set:function(e){this.port.file=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isFileInvalid",{get:function(){return!this.port.isFileValid()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fileError",{get:function(){return"invalid file name"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceList",{get:function(){return this.port.deviceList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deviceValue",{get:function(){return this.port.deviceValue},set:function(e){this.port.deviceValue=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"filePlaceHolder",{get:function(){return this.LABELS.FILE_PLACEHOLDER},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDeviceBacking",{get:function(){return this.port.hasDeviceBacking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showPipeBacking",{get:function(){return this.port.hasPipeBacking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showURIBacking",{get:function(){return this.port.hasURIBacking},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showProxy",{get:function(){return this.showURIBacking&&this.port.vspc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showStartConnectedInHeader",{get:function(){return!this.expanded&&(!this.port.vm.isUpdate||!this.port.vm.poweredOn)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showConnectedInHeader",{get:function(){return!(!this.port.vm.isUpdate||!this.port.vm.poweredOn)},enumerable:!0,configurable:!0}),e.prototype.browse=function(){var e=this;this.vmHardwareSerialPortService.openFileBrowserModal(this.port.vm.getVmConfigContext(),function(t){e.port.file=t})},Object.defineProperty(e.prototype,"pipe",{get:function(){return this.port.pipe},set:function(e){this.port.pipe=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPipeInvalid",{get:function(){return!this.port.isPipeValid()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pipeError",{get:function(){return this.port.getPipeError()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nearEndList",{get:function(){return this.port.nearEndList},enumerable:!0,configurable:!0}),e.prototype.getNearEndLabel=function(e){switch(e){case"client":return this.LABELS.CLIENT;case"server":return this.LABELS.SERVER;default:return""}},Object.defineProperty(e.prototype,"nearEndValue",{get:function(){return this.port.nearEnd},set:function(e){this.port.nearEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"farEndList",{get:function(){return this.port.farEndList},enumerable:!0,configurable:!0}),e.prototype.getFarEndLabel=function(e){return e?this.LABELS.PIPE_FAR_END_PROCESS:this.LABELS.PIPE_FAR_END_VM},Object.defineProperty(e.prototype,"farEndValue",{get:function(){return this.port.farEnd},set:function(e){this.port.farEnd=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serviceURI",{get:function(){return this.port.serviceURI},set:function(e){this.port.serviceURI=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isServiceInvalid",{get:function(){return!this.port.isServiceURIValid()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serviceError",{get:function(){return this.port.getServiceURIError()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"vspc",{get:function(){return this.port.vspc},set:function(e){this.port.vspc=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"proxy",{get:function(){return this.port.proxyURI},set:function(e){this.port.proxyURI=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isProxyInvalid",{get:function(){return!this.port.isProxyURIValid()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isProxyDisabled",{get:function(){return!!this.isEditDisabled||!this.port.vspc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"proxyError",{get:function(){return this.port.getProxyURIError()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directionList",{get:function(){return this.port.directionList},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"directionValue",{get:function(){return this.port.direction},set:function(e){this.port.direction=e},enumerable:!0,configurable:!0}),e.prototype.getDirectionLabel=function(e){switch(e){case"client":return this.LABELS.CLIENT;case"server":return this.LABELS.SERVER;default:return""}},e.$inject=["i18nService","vmHardwareSerialPortService"],e}(),i=function(){function e(){this.bindings={port:"<",expanded:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareSerialPort/vm-hw-serial-port.html"}return e}();e.VmHwSerialPortComponent=i,angular.module("com.vmware.vsphere.client.vm").component("vmHwSerialPort",new i)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){function t(e,t,i){var r=function(r){var n=new c(r,e,t,i);return n};return r}var i=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$DeviceBackingInfo,r=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$FileBackingInfo,n=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$PipeBackingInfo,o=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$ThinPrintBackingInfo,a=com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$URIBackingInfo,s=com.vmware.vim.binding.vim.vm.device.VirtualDevice$ConnectInfo,c=function(e){function t(t,c,l,d){e.call(this,t,c,l,d),this.option=null,this.deviceBacking=new i,this.fileBacking=new r,this.pipeBacking=new n,this.thinPrintBacking=new o,this.uriBacking=new a,this._connectable=new s,this._vspc=!1,t.backing||(t.backing=this.fileBacking)}return __extends(t,e),t.prototype.onVmConfigAttached=function(){this.rawDevice=e.prototype.getCurrentDevice.call(this),this.option=this.vm.getDeviceOption(this.rawDevice),this.findOptions(),this.findBacking()},t.prototype.findBacking=function(){if(this.rawDevice){var e=this.rawDevice.backing;if(e){var t=e._type;t===this.fileBacking._type?this.fileBacking=e:t===this.deviceBacking._type?this.deviceBacking=e:e._type===this.pipeBacking._type?this.pipeBacking=e:this.uriBacking._type===e._type&&(this.uriBacking=e);var i=function(e){if(!e)return"";var t=e.defaultIndex,i=e.choiceInfo,r=i[t].key;return r};this.pipeBacking.endpoint||(this.pipeBacking.endpoint=i(this.pipeOption.endpoint)),this.pipeBacking.hasOwnProperty("noRxLoss")||(this.pipeBacking.noRxLoss=this.pipeOption.noRxLoss.defaultValue),this.uriBacking.direction||(this.uriBacking.direction=i(this.uriOption.directions)),this._vspc=this.notEmpty(this.proxyURI)}}},t.prototype.attachLabels=function(e){},Object.defineProperty(t.prototype,"connectable",{get:function(){return this.rawDevice.connectable?this.rawDevice.connectable:this._connectable},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"connected",{get:function(){return this.connectable.connected},set:function(e){this.connectable.connected=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"startConnected",{get:function(){return this.connectable.startConnected},set:function(e){this.connectable.startConnected=e},enumerable:!0,configurable:!0}),t.prototype.removeDisabled=function(){return!!this.option&&e.prototype.removeDeviceDisabled.call(this,this.option)},Object.defineProperty(t.prototype,"deviceList",{get:function(){for(var e=this.vm.getSerialPortList(),t=[],i=0,r=e;i<r.length;i++){var n=r[i];t.push(n.name)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"deviceValue",{get:function(){if(!this.deviceBacking.deviceName){var e=this.deviceList;this.deviceBacking.deviceName=e&&e.length>0?e[0]:""}return this.deviceBacking.deviceName},set:function(e){this.deviceBacking.deviceName=e},enumerable:!0,configurable:!0}),t.prototype.findOptions=function(){this.option=this.vm.getDeviceOption(this.rawDevice);for(var e=this.option?this.option.backingOption:[],t="com.vmware.vim.binding.vim.vm.device.VirtualSerialPort$",i="BackingInfo",r=function(e){return t+e+i},n=0,o=e;n<o.length;n++){var a=o[n],s=a.type.typeClass;s===r("Device")?this.deviceOption=a:s===r("File")?this.fileOption=a:s===r("URI")?this.uriOption=a:s===r("ThinPrint")?this.thinPrintOption=a:s===r("Pipe")&&(this.pipeOption=a)}},Object.defineProperty(t.prototype,"yield",{get:function(){return this.rawDevice.yieldOnPoll},set:function(e){this.rawDevice.yieldOnPoll=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"file",{get:function(){return this.fileBacking?this.fileBacking.fileName:""},set:function(e){this.fileBacking&&(this.fileBacking.fileName=e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backing",{get:function(){return this.rawDevice.backing._type},set:function(e){var t=this.findBackingByType(e);this.rawDevice.backing=t},enumerable:!0,configurable:!0}),t.prototype.findBackingByType=function(e){switch(e){case this.fileBacking._type:return this.fileBacking;case this.deviceBacking._type:return this.deviceBacking;case this.pipeBacking._type:return this.pipeBacking;case this.uriBacking._type:return this.uriBacking}return this.fileBacking},Object.defineProperty(t.prototype,"backingType",{get:function(){return this.rawDevice.backing?this.rawDevice.backing._type:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"backingList",{get:function(){return[this.fileBacking._type,this.deviceBacking._type,this.pipeBacking._type,this.uriBacking._type]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasFileBacking",{get:function(){return this.backingType===this.fileBacking._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasDeviceBacking",{get:function(){return this.backingType===this.deviceBacking._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasPipeBacking",{get:function(){return this.backingType===this.pipeBacking._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasURIBacking",{get:function(){return this.backingType===this.uriBacking._type},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serviceURI",{get:function(){return this.uriBacking.serviceURI},set:function(e){this.uriBacking.serviceURI=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vspc",{get:function(){return this._vspc},set:function(e){e||(this.uriBacking.proxyURI=""),this._vspc=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"proxyURI",{get:function(){return this.uriBacking.proxyURI},set:function(e){this.uriBacking.proxyURI=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"directionList",{get:function(){return["client","server"]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this.uriBacking.direction},set:function(e){this.uriBacking.direction=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pipe",{get:function(){return this.pipeBacking.pipeName},set:function(e){this.pipeBacking.pipeName=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nearEnd",{get:function(){return this.pipeBacking.endpoint},set:function(e){this.pipeBacking.endpoint=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nearEndList",{get:function(){return this.pipeOption&&this.pipeOption.endpoint?this.pipeOption.endpoint.choiceInfo.map(function(e){return e.key}):[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"farEndList",{get:function(){return[!1,!0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"farEnd",{get:function(){return this.pipeBacking.noRxLoss},set:function(e){this.pipeBacking.noRxLoss=e},enumerable:!0,configurable:!0}),t.prototype.isValid=function(){return!!e.prototype.isMarkedForRemoval.call(this)||(this.hasFileBacking?this.isFileValid():this.hasPipeBacking?this.isPipeValid():this.hasURIBacking?this.isServiceURIValid()&&this.isProxyURIValid():!this.hasDeviceBacking||this.isEsxDeviceValid())},t.prototype.notEmpty=function(e){return!!e&&!(e.length<1)},t.prototype.isFileValid=function(){return!!e.prototype.isMarkedForRemoval.call(this)||this.notEmpty(this.file)},t.prototype.getFileError=function(){return e.prototype.i18n.call(this,"SerialPortPage.FileRequired")},t.prototype.isPipeValid=function(){return!!e.prototype.isMarkedForRemoval.call(this)||this.notEmpty(this.pipe)},t.prototype.getPipeError=function(){return e.prototype.i18n.call(this,"SerialPortPage.PipeRequired")},t.prototype.isEsxDeviceValid=function(){return!!e.prototype.isMarkedForRemoval.call(this)||this.notEmpty(this.deviceValue)},t.prototype.isServiceURIValid=function(){return!!e.prototype.isMarkedForRemoval.call(this)||this.notEmpty(this.serviceURI)},t.prototype.getServiceURIError=function(){return e.prototype.i18n.call(this,"SerialPortPage.ServiceURIRequired")},t.prototype.isProxyURIValid=function(){return!!e.prototype.isMarkedForRemoval.call(this)||(!this.vspc||this.notEmpty(this.proxyURI))},t.prototype.getProxyURIError=function(){return e.prototype.i18n.call(this,"SerialPortPage.ConcentratorURIRequired")},t}(e.EditableVirtualDeviceClass);e.VmHwSerialPort=c,angular.module("com.vmware.vsphere.client.vm").factory("VmHwSerialPort",["deviceDiffService","vmDeviceInfoService","vmHardwareUtil",t])}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSettings",[function(){return{templateUrl:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareSettings.html",controller:"VmHardwareController",controllerAs:"ctrl"}}]);var h5_vm;!function(e){var t=function(){function e(){this.scope={handler:"&fileOnChange"},this.restrict="A",this.controllerAs="fileOnChangeCtrl",this.controller=i}return e.Metastructure={name:"fileOnChange",factory:[function(){return new e}]},e}(),i=function(){function e(e,t){this.$scope=e,this.$element=t}return e.prototype.$onInit=function(){},e.prototype.$postLink=function(){var e=this;this.$element.bind("change",function(t){e.$scope.$apply(function(){if(t.target.files&&t.target.files.length){var i={files:t.target.files};e.$scope.handler(i)}})})},e.$inject=["$scope","$element"],e}();angular.module("com.vmware.vsphere.client.vm").directive(t.Metastructure.name,t.Metastructure.factory)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.$q=e}return e.prototype.readFileContentAsBinaryString=function(e){if(!e)return this.$q.when(null);var t=this.$q.defer(),i=new FileReader;return i.onload=function(){var e=i.result;t.resolve(e)},i.addEventListener("load",function(){var e=i.result;t.resolve(e)}),i.addEventListener("error",function(){t.resolve(null)}),i.readAsBinaryString(e),t.promise},e.$inject=["$q"],e}();e.VmFileReaderService=t,angular.module("com.vmware.vsphere.client.vm").service("vmFileReaderService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={tpmCertificate:"<",onCertificateChange:"&"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareTpm/tpmCertificateSelector/tpm-certificate-selector.component.html"}return e}();e.TpmCertificateSelector=t;var i=function(){function e(e,t,i,r,n){this.i18nService=e,this.$element=t,this.$timeout=i,this.vmFileReaderService=r,this.vmTpmService=n,this.certificateDropdownOptions=[],this.invalidCertAlertOptions={text:"",isClosed:!0},this.i18n=function(t,i){return void 0===i&&(i="VmUi"),e.getString(i,t)},this.errorConfig={message:"",isVisible:!1}}return e.prototype.$onInit=function(){this.selectedCertificate=this.tpmCertificate,this.certificateDropdownOptions.push(this.tpmCertificate)},e.prototype.$postLink=function(){this.certificateFileInput=this.$element.find("input[type='file']")},e.prototype.openFileSelector=function(){var e=this;this.$timeout(function(){e.certificateFileInput.click()},0)},e.prototype.showAlertForInvalidCertificate=function(e){this.invalidCertAlertOptions.text=e,this.invalidCertAlertOptions.isClosed=!1},e.prototype.uploadCertificate=function(e){var t=this;if(e&&e.length){var i=e[0];this.vmFileReaderService.readFileContentAsBinaryString(i).then(function(e){t.vmTpmService.parseCertificate(e).then(function(e){e?t.onCertificateChange({uploadedCertificate:e,originalCertificate:t.tpmCertificate}):t.showAlertForInvalidCertificate(t.i18n("VmDeviceManager.TPMCertificateInvalid"))},function(e){t.showAlertForInvalidCertificate(t.i18n("VmDeviceManager.TPMCertificateInvalid"))})})}},e.$inject=["i18nService","$element","$timeout","vmFileReaderService","vmTpmService"],e}();angular.module("com.vmware.vsphere.client.vm").component("tpmCertificateSelector",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={tpmDevice:"<",removeCallback:"&",createMode:"<",vmPoweredOn:"<",vmId:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareTpm/vm-hardware-tpm.component.html"}return e}();e.VmHardwareTpm=t;var i=function(){function e(e,t,i){
this.i18nService=e,this.templateHelperService=t,this.vmTpmService=i,this.showModal=!1,this.tpmCertificates=[],this.i18n=function(t,i){return void 0===i&&(i="VmUi"),e.getString(i,t)}}return e.prototype.$onInit=function(){var e=this;this.device=this.tpmDevice.getCurrentDevice();var t="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareTpm/tpm-help-text.html",i="<br><br>",r="https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=2147566",n={i18n:this.i18n,createMode:this.createMode,vmPoweredOn:this.vmPoweredOn,actionableText:this.i18n("VmDeviceManager.TpmHelpAdd.NewVM.Description")+i,extraText:"",kbArticleLink:r,linkLabel:this.i18n("VmDeviceManager.TpmHelp.Link.Label")};!this.createMode&&this.vmId&&(this.vmTpmService.getCertificates(this.vmId).then(function(t){e.tpmCertificates=_.forEach(t,function(e,t){return e.id=t})}),n.actionableText=this.i18n("VmDeviceManager.TpmHelpAddDelete.ExistingVM.Description")+i,n.extraText=this.i18n("VmDeviceManager.TpmHelp.KMS.Description")+i),this.templateHelperService.renderTemplateWithScope(t,n).then(function(t){e.tpmSignPostParams={message:t,title:e.i18nService.getString("Common","help"),"class":""}})},e.prototype.isTpmRemovalDisabled=function(){return this.vmPoweredOn},e.prototype.onCertificateUpdate=function(e,t){var i=t.id;Array.isArray(this.device.endorsementKeyCertificate)&&this.device.endorsementKeyCertificate.length>0&&(this.device.endorsementKeyCertificate[i]={value:this.vmTpmService.stripHeadersFromCertificate(e.rawData)}),this.tpmCertificates[i]=e},e.prototype.onTpmRemoval=function(){this.tpmDevice.isNew()?this.removeCallback()(this.tpmDevice):this.showModal=!0},e.prototype.onAcceptModalWarning=function(){this.showModal=!1,this.removeCallback()(this.tpmDevice)},e.prototype.onCancelModalWarning=function(){this.showModal=!1},e.$inject=["i18nService","templateHelperService","vmTpmService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareTpm",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e){this.i18nService=e,this.i18n=function(t){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return e.getString("VmUi","USBControllerPage."+t,i)}}return t.prototype.$onInit=function(){this.rawDevice=this.inflatedDevice.getCurrentDevice()},t.prototype.getDeviceLabel=function(){return this.rawDevice?this.rawDevice.deviceInfo.label:""},t.prototype.isUnsupportedByGuest=function(){return e.VmHardwareUsbControllerUtil.isUnsupportedByGuest(this.inflatedDevice,this.selectedGuestOs)},t.prototype.getUSBLabel=function(){if(!this.rawDevice)return"";var e=this.rawDevice._type;return this.getUsbTypeLabel(e)},t.prototype.getUsbTypeList=function(){var t=this.vmConfigContext.environment.configOption.hardwareOptions.virtualDeviceOption,i=_.find(t,function(e){return"VirtualUSBXHCIController"===e.type.wsdlName}),r=[e.VmHardwareUsbControllerUtil.GetUsb20VmodlType()];return i&&r.push(e.VmHardwareUsbControllerUtil.GetUsb30VmodlType()),r},t.prototype.getUsbTypeLabel=function(t){var i=e.VmHardwareUsbControllerUtil.GetUsbTypeI18nKey(t);return this.i18nService.getString("VmUi",i)},Object.defineProperty(t.prototype,"usbType",{get:function(){return this.rawDevice._type},set:function(e){this.rawDevice._type=e},enumerable:!0,configurable:!0}),t.prototype.isUsbTypeEditable=function(){return!(!this.inflatedDevice||!this.inflatedDevice.isNew())},t.prototype.isMarkedForRemoval=function(){return!!this.inflatedDevice&&this.inflatedDevice.isMarkedForRemoval()},t.prototype.isRemoveDisabled=function(){return e.VmHardwareUsbControllerUtil.isRemovalDisabled(this.inflatedDevice,this.virtualMachineDevices,this.vmConfigContext,this.vmWorkflowMode)},t.prototype.removeDevice=function(){!this.isRemoveDisabled()&&this.removeCallback&&this.removeCallback()(this.inflatedDevice)},t.prototype.revertRemoval=function(){this.inflatedDevice&&this.inflatedDevice.revertRemoval()},t.$inject=["i18nService"],t}(),i=function(){function e(){this.bindings={inflatedDevice:"<",selectedGuestOs:"<",removeCallback:"&",vmConfigContext:"<",virtualMachineDevices:"<",vmWorkflowMode:"<",expanded:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareUsbController/vm-hardware-usb-controller.html"}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareUsbController",new i)}(h5_vm||(h5_vm={}));var VmWorkflowMode=h5_vm.VmWorkflowMode,VmHardwareUsbControllerInput=function(){function e(){}return e}(),h5_vm;!function(e){var t=e.VmHardwareUtil,i=e.DeviceTypeConstants,r=function(){function r(){}return r.GetUsb20VmodlType=function(){return"com.vmware.vim.binding.vim.vm.device.VirtualUSBController"},r.GetUsb30VmodlType=function(){return"com.vmware.vim.binding.vim.vm.device.VirtualUSBXHCIController"},r.isUnsupportedByGuest=function(e,t){var i=e.getCurrentDevice()._type,r=t.supportedUSBControllerList;return!_.find(r,function(e){return e.typeClass===i})},r.GetUsbTypeI18nKey=function(t){return t===e.VmHardwareUsbControllerUtil.GetUsb20VmodlType()?"USBController.USB20":t===e.VmHardwareUsbControllerUtil.GetUsb30VmodlType()?"USBController.USB30":""},r.isRemovalDisabled=function(n,o,a,s){var c=s===e.VmWorkflowMode.UpdateMode;if(!n)return!0;var l=n.getCurrentDevice();if(!l)return!0;if(!n.isNew()&&!t.userHasAddRemoveDevicePermission(a))return!0;if(c&&t.isSuspended(a))return!0;if(r.hasAttachedDevices(l))return!0;var d=o.newDevicesOfType(i.VIRTUAL_USB);return!(!d||0===d.length)&&!r.isSecondUSBControllerAvailable(l,o)},r.isSecondUSBControllerAvailable=function(e,t){var i=r.GetUsb20VmodlType(),n=r.GetUsb30VmodlType(),o=e._type,a=o===i?n:i,s=t.devicesNotMarkedForRemovalOfType(a);return!!(s&&s.length>0)},r.hasAttachedDevices=function(e){if(!e)return!1;if(!e.device)return!1;var t=e.device;return!!t&&e.device.length>0},r.areBothUSBControllerMarkedForRemoval=function(e){var t=e.devicesMarkedForRemovalOfType(i.VIRTUAL_USB_CONTROLLER),r=e.devicesMarkedForRemovalOfType(i.VIRTUAL_USB_XHCI_CONRTOLLER);return!(!t||!r)&&(t.length>0&&r.length>0)},r}();e.VmHardwareUsbControllerUtil=r}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={inflatedDevice:"<",selectedGuestOs:"<",removeCallback:"&",vmConfigContext:"<",expanded:"="},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareUsbDevice/vm-hardware-usb-device.html"}return e}(),i=function(){function e(e){this.i18nService=e,this.i18n=function(t){for(var i=[],r=1;r<arguments.length;r++)i[r-1]=arguments[r];return e.getString("VmUi","USBDevicePage."+t,i)}}return e.prototype.$onInit=function(){this.usb=this.inflatedDevice,this.i18n=this.usb.i18n,this.usb.onInit(this.vmConfigContext)},e.prototype.$postLink=function(){this.validateUSBSelection()},e.prototype.getDeviceLabel=function(){return this.usb.getDeviceLabel()},e.prototype.getUsbDeviceLabel=function(){return this.usb.getUsbDeviceLabel(this.vmConfigContext)},e.prototype.isMarkedForRemoval=function(){return!!this.inflatedDevice&&this.inflatedDevice.isMarkedForRemoval()},e.prototype.hasError=function(){return this.isNew()&&!this.usb.isDeviceAvailable()},e.prototype.isRemoveDisabled=function(){return!this.usb.isRemovalEnabled()},e.prototype.removeDevice=function(){this.usb.hostUsb&&(this.usb.hostUsb.taken=!1),!this.isRemoveDisabled()&&this.removeCallback&&this.removeCallback()(this.inflatedDevice)},e.prototype.revertRemoval=function(){this.inflatedDevice.revertRemoval()},e.prototype.isNew=function(){return this.inflatedDevice&&this.inflatedDevice.isNew()},e.prototype.getHostUsbList=function(){var e=this.vmConfigContext.environment.configTarget.usb;return e},e.prototype.getHostUsbLabel=function(e){return e?e.description:""},Object.defineProperty(e.prototype,"hostUsb",{get:function(){return this.usb.hostUsb},set:function(e){if(e){var t=this.usb.hostUsb;this.usb.hostUsb=e,e.taken=!0,t&&(t.taken=!1)}},enumerable:!0,configurable:!0}),e.prototype.isDevicePresent=function(){return this.usb.isDevicePresent()},e.prototype.validateUSBSelection=function(){var e=this.hasError();this.usbError={message:this.getDeviceAvailableText(),isVisible:e},this.vmHardwareUsbDevice.$setValidity("newDevice",!e)},Object.defineProperty(e.prototype,"USBUniqueID",{get:function(){return this.usb.getUSBUniqueID()},enumerable:!0,configurable:!0}),e.prototype.getUSBConnectionStatusText=function(){return this.usb.getUSBConnectionStatusText()},e.prototype.getVMotionSupportText=function(){return this.usb.getVMotionSupportText()},e.prototype.getDeviceAvailableText=function(){return this.usb.getDeviceAvailableText()},Object.defineProperty(e.prototype,"vMotion",{get:function(){return this.usb.vMotion},set:function(e){this.usb.vMotion=e},enumerable:!0,configurable:!0}),e.$inject=["i18nService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareUsbDevice",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualUSB$RemoteClientBackingInfo,i=function(){function e(){}return e.getUsbTargetDescription=function(t,i){if(!t||!t.backing)return"";var r=t.backing,n=t.deviceInfo;if(r._type===e.clientUsb)return n.summary;var o=e.getTargetUsbInfo(t,i);if(o)return o.description;var a=r;return a.deviceName},e.getTargetUsbInfo=function(e,t){if(!e||!e.backing)return null;if(!t)return null;var i=e.backing;if(!i.hasOwnProperty("deviceName"))return null;var r=i.deviceName,n=t.environment.configTarget.usb,o=_.find(n,function(e){return e&&e.physicalPath===r});return o?o:null},e.getUSBUniqueID=function(e){if(!e||!e.backing)return"";var t=e.backing;if(!t.hasOwnProperty("deviceName"))return"";var i=t.hasOwnProperty("hostname")?t.hostname:"localhost",r=t.deviceName;return"host: "+i+" device: "+r},e.clientUsb=(new t)._type,e}();e.VmHardwareUsbDeviceUtil=i}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e,this.ARIA_LBL_VIDEO=this.i18n2("Title"),this.ARIA_LBL_NUM_DISPLAYS=this.i18n2("NumberOfDisplays"),this.ARIA_LBL_VRAM=this.i18n2("TotalVideoMemory"),this.ARIA_LBL_3D=this.i18n2("3DGraphics"),this.ARIA_LBL_3DRNDR=this.i18n2("3DRenderer"),this.ARIA_LBL_3DRAM=this.i18n2("3DMemory"),this.expanded=!1}return e.prototype.i18n2=function(e,t){void 0===t&&(t="VideoCardPage");var i=this.i18nService.getString("VmUi",t+"."+e);return i},e.prototype.i18n=function(e){return this.inflatedDevice?this.inflatedDevice.i18n(e):""},e.prototype.isReady=function(){return!!this.inflatedDevice},e.prototype.hasChanged=function(){return!!this.isReady()&&this.inflatedDevice.hasChanged()},e.prototype.$postLink=function(){this.videoRamSizeInKB_Validatate(),this.graphicsMemorySizeInMB_Validate()},e.prototype.hasError=function(){return!_.isEmpty(this.vmHardwareVideoCardForm)&&this.vmHardwareVideoCardForm.$invalid},e.prototype.useAutoDetect_List=function(){return this.isReady()?this.inflatedDevice.useAutoDetect_List():[]},e.prototype.useAutoDetect_Text=function(e){return this.isReady()?this.inflatedDevice.useAutoDetect_Text(e):""},Object.defineProperty(e.prototype,"useAutoDetect",{get:function(){return!!this.isReady()&&this.inflatedDevice.useAutoDetect},set:function(e){this.isReady()&&(this.inflatedDevice.useAutoDetect=e,this.expandIfCustomSettings())},enumerable:!0,configurable:!0}),e.prototype.expandIfCustomSettings=function(){this.isReady()&&(this.inflatedDevice.useAutoDetect||(this.expanded=!0))},e.prototype.useAutoDetect_isEditDisabled=function(){return!this.isReady()||this.inflatedDevice.useAutoDetect_isEditDisabled()},e.prototype.videoRamSizeInKB_isEditDisabled=function(){return!this.isReady()||this.inflatedDevice.videoRamSizeInKB_isEditDisabled()},e.prototype.videoRamSizeInKB_isInvalid=function(){return!!this.isReady()&&this.inflatedDevice.videoRamSizeInKB_isInvalid()},e.prototype.videoRamSizeInKB_getError=function(){return this.isReady()?this.inflatedDevice.videoRamSizeInKB_getError():""},Object.defineProperty(e.prototype,"videoRamSizeInKB",{get:function(){return this.isReady()?this.inflatedDevice.videoRamSizeInKB:""},set:function(e){this.isReady()&&(this.inflatedDevice.videoRamSizeInKB=e,this.videoRamSizeInKB_Validatate())},enumerable:!0,configurable:!0}),e.prototype.videoRamSizeInKB_Validatate=function(){if(this.isReady()){var e=this.inflatedDevice.videoRamSizeInKB_isInvalid();this.setValidityByName("videoRamSizeInKB",e)}},e.prototype.setValidityByName=function(e,t){if(this.isReady()){var i=this.vmHardwareVideoCardForm[e];if(i){var r=e+"_value",n=!t;i.$setValidity(r,n)}}},e.prototype.numberOfDisplays_List=function(){return this.isReady()?this.inflatedDevice.numDisplays_getList():[]},Object.defineProperty(e.prototype,"numberOfDisplays",{get:function(){return this.isReady()?this.inflatedDevice.numDisplays:1},set:function(e){this.isReady()&&(this.inflatedDevice.numDisplays=e)},enumerable:!0,configurable:!0}),e.prototype.numberOfDisplays_isEditDisabled=function(){return!this.isReady()||this.inflatedDevice.numDisplays_isEditDisabled()},Object.defineProperty(e.prototype,"enable3DSupport",{get:function(){return!!this.isReady()&&this.inflatedDevice.enable3DSupport},set:function(e){this.isReady()&&(this.inflatedDevice.enable3DSupport=e)},enumerable:!0,configurable:!0}),e.prototype.enable3DSupport_isEditDisabled=function(){return!this.isReady()||this.inflatedDevice.enable3DSupport_isEditDisabled()},e.prototype.enable3DSupport_isVisible=function(){return!this.isReady()||this.inflatedDevice.enable3DSupport_isVisible()},e.prototype.use3dRenderer_isVisible=function(){return!this.isReady()||this.inflatedDevice.use3dRenderer_isVisible()},Object.defineProperty(e.prototype,"use3dRenderer",{get:function(){return this.isReady()?this.inflatedDevice.use3dRenderer:""},set:function(e){this.isReady()&&(this.inflatedDevice.use3dRenderer=e)},enumerable:!0,configurable:!0}),e.prototype.use3dRenderer_List=function(){return this.isReady()?this.inflatedDevice.use3dRenderer_List():[]},e.prototype.use3dRenderer_Text=function(e){return this.isReady()?this.inflatedDevice.use3dRenderer_Text(e):""},e.prototype.use3dRenderer_isEditDisabled=function(){return!this.isReady()||this.inflatedDevice.use3dRenderer_isEditDisabled()},Object.defineProperty(e.prototype,"graphicsMemorySizeInMB",{get:function(){return this.isReady()?this.inflatedDevice.graphicsMemorySizeInMB:""},set:function(e){this.isReady()&&(this.inflatedDevice.graphicsMemorySizeInMB=e,this.graphicsMemorySizeInMB_Validate())},enumerable:!0,configurable:!0}),e.prototype.graphicsMemorySizeInMB_Validate=function(){if(this.isReady()){var e=this.inflatedDevice.graphicsMemorySizeInMB_isInvalid();this.setValidityByName("graphicsMemorySizeInMB",e)}},e.prototype.graphicsMemorySizeInMB_isEditDisabled=function(){return!this.isReady()||this.inflatedDevice.graphicsMemorySizeInMB_isEditDisabled()},e.prototype.graphicsMemorySizeInMB_isVisible=function(){return!!this.isReady()&&this.inflatedDevice.graphicsMemorySizeInMB_isVisible()},e.prototype.graphicsMemorySizeInMB_isInvalid=function(){return!!this.isReady()&&this.inflatedDevice.graphicsMemorySizeInMB_isInvalid()},e.prototype.graphicsMemorySizeInMB_getError=function(){return this.isReady()?this.inflatedDevice.graphicsMemorySizeInMB_getError():""},e.prototype.getAutoIncreaseText=function(){return this.isReady()?this.inflatedDevice.getAutoIncreaseText():""},e.prototype.getAutoIncreaseVisible=function(){return!!this.isReady()&&this.inflatedDevice.getAutoIncreaseVisible()},e.$inject=["i18nService"],e}(),i=function(){function e(e,i,r){void 0===e&&(e={inflatedDevice:"<"}),void 0===i&&(i=t),void 0===r&&(r="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVideoCard/vm-hw-video-card.html"),this.bindings=e,this.controller=i,this.templateUrl=r}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVideoCard",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){function t(e){var t=function(t,i){void 0===i&&(i=!1);var n=new r(t,i);return e.call(n,t),n};return t}var i=function(){function e(){}return e.AUTOMATIC="automatic",e.SOFTWARE="software",e.HARDWARE="hardware",e}(),r=function(){function e(e,t){void 0===t&&(t=!1),this.OP_ADD="add",this.videoRamSizeText=null,this.videoRamSizeInKB_Error="",this.preBumpVideoMemoryInKB=void 0,this.autoIncreaseInfoText="",this.autoIncreaseInfoVisible=!1,this._graphicsMemorySizeInMB=null,this.graphicsMemorySizeInMBError="",this.base=this,this.rawDevice=e,this.isScheduledTask=t,this.originalDevice=angular.copy(e)}return e.prototype.attachVmConfig=function(e){!this.vmConfig&&e&&(this.vmConfig=e,this.onVmConfigAttached())},e.prototype.onVmConfigAttached=function(){this.rawDevice=this.base.getCurrentDevice(),this.vm&&(this.option=this.vm.getVideoCardOption(),this.guest=this.vm.getGuestOsDescriptror(),this.i18nService=this.vm.getI18nService(),this.vm.isCreate&&(e.fixNewVideoCard(this.rawDevice,this.option,this.guest,this.isScheduledTask),this.fixDeviceSpecOp()))},e.prototype.fixDeviceSpecOp=function(){var e=this.base.getCurrentDeviceSpec();this.vm.isCreate&&(e.operation=this.OP_ADD)},e.fixNewVideoCard=function(e,t,r,n){void 0===n&&(n=!1),e&&(e.useAutoDetect||(e.useAutoDetect=!1),e.numDisplays||(e.numDisplays=1),!e.videoRamSizeInKB&&r&&(e.videoRamSizeInKB=r.vRAMSizeInKB.defaultValue),n||(e.enable3DSupport=!!t&&t.support3D.defaultValue),r&&!r.supports3D&&(e.enable3DSupport=!1),!e.use3dRenderer&&t&&t.use3dRendererSupported&&t.use3dRendererSupported.supported&&(e.use3dRenderer=i.AUTOMATIC),!e.graphicsMemorySizeInKB&&t&&t.graphicsMemorySizeSupported&&t.graphicsMemorySizeSupported.supported&&(e.graphicsMemorySizeInKB=t.graphicsMemorySizeInKB.defaultValue))},e.prototype.i18n=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return this.i18nService?this.i18nService.getString("VmUi","VideoCardPage."+e,t):""},Object.defineProperty(e.prototype,"vm",{get:function(){return this.vmConfig},enumerable:!0,configurable:!0}),e.prototype.hasChanged=function(){return!!this.rawDevice&&this.base.hasChanged()},e.prototype.isEditDeviceDisabled=function(){return!this.vm||this.vm.isEditDeviceDisabled()},e.prototype.reduceKB2MB=function(e){if(!e)return 0;var t=e/1024;return t},e.prototype.increaseMB2KB=function(e){if(!e)return 0;var t=1024*e;return t},e.prototype.formatKB2MB=function(e){if(null===e)return"";if(angular.isUndefined(e))return"";var t=this.reduceKB2MB(e);return t.toString()},e.prototype.useAutoDetect_List=function(){return[!0,!1]},e.prototype.useAutoDetect_Text=function(e){return e?this.i18n("AutoDetect"):this.i18n("SpecifyCustom")},Object.defineProperty(e.prototype,"useAutoDetect",{get:function(){return this.rawDevice.useAutoDetect},set:function(e){this.rawDevice.useAutoDetect=e},enumerable:!0,configurable:!0}),e.prototype.useAutoDetect_isEditDisabled=function(){return this.isEditDeviceDisabled()},e.prototype.videoRamSizeInKB_isEditDisabled=function(){return!!this.useAutoDetect||this.isEditDeviceDisabled()},Object.defineProperty(e.prototype,"videoRamSizeInKB",{get:function(){return null===this.videoRamSizeText&&this.initVideoRamSizeText(),null===this.videoRamSizeText?"":this.videoRamSizeText},set:function(e){if(e!==this.videoRamSizeText){this.videoRamSizeText=e;var t=parseFloat(e),i=this.increaseMB2KB(t);this.videoRamSizeInKB_Error=this.videoRamSizeInKB_validate(i),this.rawDevice.videoRamSizeInKB=this.increaseMB2KB(t)}},enumerable:!0,configurable:!0}),e.prototype.initVideoRamSizeText=function(){if(this.rawDevice){var e=this.rawDevice.videoRamSizeInKB;this.videoRamSizeText=this.formatKB2MB(e)}},e.prototype.videoRamSizeInKB_isInvalid=function(){return!!this.videoRamSizeInKB_Error},e.prototype.videoRamSizeInKB_getError=function(){return this.videoRamSizeInKB_Error},e.prototype.videoRamSizeInKB_validate=function(e){if(!this.option)return"";var t=this.option.videoRamSizeInKB.max,i=this.option.videoRamSizeInKB.min;return e<i||e>t?this.formatRangeError(i/1024,t/1024,"TotalVideoMemory"):""},Object.defineProperty(e.prototype,"numDisplays",{get:function(){return this.rawDevice.numDisplays},set:function(e){if(this.rawDevice.numDisplays!==e){var t=this.rawDevice.numDisplays;this.rawDevice.numDisplays=e,this.afterNumDisplaysChanged(t,e)}},enumerable:!0,configurable:!0}),e.prototype.afterNumDisplaysChanged=function(e,t){var i=t-e;this.enable3DSupport&&(this.graphicsMemorySupported()||this.bumpUpVideoRamByMB(16*i))},e.prototype.numDisplays_isEditDisabled=function(){return!!this.useAutoDetect||this.isEditDeviceDisabled()},e.prototype.numDisplays_getList=function(){return this._numDisplays_List_Cached||this.numDisplays_List_init(),this._numDisplays_List_Cached},e.prototype.numDisplays_List_init=function(){for(var e=this.get_numDisplays_max(),t=[],i=1;i<=e;i++)t.push(i);this._numDisplays_List_Cached=t},e.prototype.get_numDisplays_max=function(){var e=0;return this.option&&this.option.numDisplays&&(e=this.option.numDisplays.max),e||(e=4),e},e.prototype.enable3DSupport_isVisible=function(){return this.enable3DSupport,!0},e.prototype.enable3DSupport_isEditDisabled=function(){return!!this.isEditDeviceDisabled()||!this.enable3DSupport&&!!this.guestLacks3DSupport()},Object.defineProperty(e.prototype,"enable3DSupport",{get:function(){return this.rawDevice.enable3DSupport},set:function(e){e!==this.rawDevice.enable3DSupport&&(this.enable3DSupport_isEditDisabled()||(this.rawDevice.enable3DSupport=e,this.afterEnable3DSupportChanged(e)))},enumerable:!0,configurable:!0}),e.prototype.afterEnable3DSupportChanged=function(e){this.graphicsMemorySupported()||(e?this.bump2dMemoryFor3dOps():this.restore2dMemory())},e.prototype.bump2dMemoryFor3dOps=function(){this.preBumpVideoMemoryInKB=this.rawDevice.videoRamSizeInKB;var e=this.rawDevice.numDisplays,t=64+16*(e-1);this.bumpVideoRamToMB(t),1===e?this.autoIncreaseInfoText=this.i18n("3DAutoIncrease"):this.autoIncreaseInfoText=this.i18n("3DAutoIncrease2"),this.autoIncreaseInfoVisible=!0},e.prototype.restore2dMemory=function(){this.preBumpVideoMemoryInKB&&(this.updateVideoRamSize(this.preBumpVideoMemoryInKB),this.preBumpVideoMemoryInKB=void 0),this.autoIncreaseInfoVisible=!1,this.autoIncreaseInfoText=""},e.prototype.getAutoIncreaseText=function(){return this.autoIncreaseInfoText},e.prototype.getAutoIncreaseVisible=function(){return this.autoIncreaseInfoVisible},e.prototype.graphicsMemorySupported=function(){if(!this.option)return!1;var e=this.option.graphicsMemorySizeSupported;return!!e&&!!e.supported},e.prototype.bumpVideoRamToMB=function(e){var t=this.trimVideoRamSize(1024*e);this.updateVideoRamSize(t)},e.prototype.bumpUpVideoRamByMB=function(e){var t=this.rawDevice.videoRamSizeInKB,i=t+1024*e;i=this.trimVideoRamSize(i),this.updateVideoRamSize(i)},e.prototype.updateVideoRamSize=function(e){this.rawDevice.videoRamSizeInKB=e,this.videoRamSizeText=null},e.prototype.trimVideoRamSize=function(e){var t=e;if(this.option&&this.option.videoRamSizeInKB){var i=this.option.videoRamSizeInKB.max;t>i&&(t=i);var r=this.option.videoRamSizeInKB.min;t<r&&(t=r)}return t},e.prototype.guestLacks3DSupport=function(){return!(!this.guest||this.guest.supports3D)},Object.defineProperty(e.prototype,"use3dRenderer",{get:function(){return this.rawDevice.use3dRenderer},set:function(e){this.rawDevice.use3dRenderer=e},enumerable:!0,configurable:!0}),e.prototype.use3dRenderer_List=function(){return[i.AUTOMATIC,i.HARDWARE,i.SOFTWARE]},e.prototype.use3dRenderer_Text=function(e){return this.i18n(e)},e.prototype.use3dRenderer_isEditDisabled=function(){return!!this.isEditDeviceDisabled()||(!!this.guestLacks3DSupport()||!this.enable3DSupport)},e.prototype.graphicsMemorySizeInMB_isVisible=function(){if(!this.option)return!0;var e=this.option.graphicsMemorySizeSupported;return!(!e||!e.supported)},e.prototype.graphicsMemorySizeInMB_isEditDisabled=function(){return!!this.isEditDeviceDisabled()||(!!this.guestLacks3DSupport()||!this.enable3DSupport)},Object.defineProperty(e.prototype,"graphicsMemorySizeInMB",{get:function(){if(null===this._graphicsMemorySizeInMB){var e=this.rawDevice.graphicsMemorySizeInKB,t="";t=null===e?"":(e/1024).toString(),this._graphicsMemorySizeInMB=t}return this._graphicsMemorySizeInMB},set:function(e){this._graphicsMemorySizeInMB=e;var t=parseFloat(e);this.rawDevice.graphicsMemorySizeInKB=1024*t,this.graphicsMemorySizeInMBError=this.graphicsMemorySizeInMB_getErrorText()},enumerable:!0,configurable:!0}),e.prototype.graphicsMemorySizeInMB_isInvalid=function(){var e=this.graphicsMemorySizeInMBError;return!!(e&&e.length>0)},e.prototype.graphicsMemorySizeInMB_getError=function(){return this.graphicsMemorySizeInMBError=this.graphicsMemorySizeInMB_getErrorText(),this.graphicsMemorySizeInMBError},e.prototype.graphicsMemorySizeInMB_getErrorText=function(){var e="";if(!this.rawDevice)return e;var t=this.rawDevice.graphicsMemorySizeInKB;if(angular.isUndefined(t))return e;if(!this.option)return e;var i=this.option.graphicsMemorySizeInKB;if(!i)return e;var r=i.max,n=i.min;return t>=n&&t<=r?e:this.formatRangeError(n/1024,r/1024,"3DMemory")},e.prototype.formatRangeError=function(e,t,i){i=this.i18n(i);var r=" "+this.i18n("MB"),n=e.toLocaleString()+r,o=t.toLocaleString()+r,a="Util.Validation.ValidRange",s=this.i18nService.getString("VmUi",a,i,n,o);return s},e.prototype.use3dRenderer_isVisible=function(){if(!this.option)return!0;var e=this.option.use3dRendererSupported;return!(!e||!e.supported)},e}();e.VirtualVideoCardClass=r,angular.module("com.vmware.vsphere.client.vm").factory("VirtualVideoCard",["EditableVirtualDevice",t])}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(){}return t.setup=function(i,r,n,o,a,s,c,l,d,u,p){void 0===o&&(o=11),void 0===a&&(a=!0),void 0===d&&(d=!1),void 0===u&&(u=!1),void 0===p&&(p=!1);var v=i.vmHardwareConfigData();if(p){var m=_.find(v.vmConfigContext.config.hardware.device,function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualVideoCard"===e._type});m&&(m.enable3DSupport=p)}var g=v.vmConfigContext,h=g.environment.configOption.guestOSDescriptor[0],f=g.environment;f.powerState=s;var S=g.privileges;c||(S=_.without(g.privileges,e.Privileges.VM_EDITDEVICE_PRIVILEGE)),h.supports3D=a;var y=f.configOption.hardwareOptions.virtualDeviceOption,P=t.findVideoCardOption(y);o>=7?P.numDisplays.max=10:P.numDisplays.max=1,9===o||10===o?P.videoRamSizeInKB.max=524288:P.videoRamSizeInKB.max=131072,P.support3D.supported=!1,P.support3D.defaultValue=d,o>8?P.use3dRendererSupported.supported=!0:P.use3dRendererSupported.supported=!1,o>10?P.graphicsMemorySizeSupported.supported=!0:P.graphicsMemorySizeSupported.supported=!1;var C=r.buildVirtualMachineDevices(g,u),D=new e.VmConfig(g,h,S,l,n),w=C.getVirtualDevice(500);return l===e.VmWorkflowMode.CreateMode&&t.unsetRawDevice(w.rawDevice),w.attachVmConfig(D),w},t.unsetRawDevice=function(e){},t.findVideoCardOption=function(e){var t=function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualVideoCard"===e.type.name},i=_.find(e,t),r=i;return r},t}();e.VirtualVideoCardSetup=t}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=function(){function e(e,t,i,r,n,o,a,s){this.managedEntityConstants=e,this.authorizationService=t,this.i18nService=i,this.vmHardwareUtil=r,this.vmHardwareVirtualDiskSharesService=n,this.vmHardwareVirtualDiskIopsService=o,this.vmHardwareVirtualDiskModeService=a,this.vmHardwareVirtualDiskFlashReadCacheService=s,this.DISK_SIZE_UPDATED="disk-size-updated",this.DISKS_UPDATED="disks-updated",this.DISK_STACK_EXPANDED="disk-stack-expanded",this.i18n=i.getString}return e.prototype.isEditSharesDisabled=function(e,t,i){return this.vmHardwareVirtualDiskSharesService.isEditSharesDisabled(e,t,i)},e.prototype.isEditDiskModeDisabled=function(e,t,i){return this.vmHardwareVirtualDiskModeService.isEditDiskModeDisabled(e,t,i)},e.prototype.isEditIopsLimitDisabled=function(e,t){return this.vmHardwareVirtualDiskIopsService.isEditIopsLimitDisabled(e,t)},e.prototype.isRemoveDiskDisabled=function(e){return!this.hasPrivilegesToRemoveDisk(e)},e.prototype.hasPrivilegesToRemoveDisk=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_REMOVEDISK_PRIVILEGE])},e.prototype.isEditFlashReadCacheDisabled=function(e,t){return this.vmHardwareVirtualDiskFlashReadCacheService.isEditFlashReadCacheDisabled(e,t)},e.prototype.hasPrivilegesToEditCapacity=function(e,i){return void 0===i&&(i=!1),!!i||this.vmHardwareUtil.checkPrivileges(e,[t.VM_DISKEXTEND_PRIVILEGE])},e.prototype.hasPrivilegesToEditShares=function(e,i){return void 0===i&&(i=!1),!!i||this.vmHardwareUtil.checkPrivileges(e,[t.VM_RESOURCE_PRIVILEGE])},e.prototype.isStoragePod=function(e){return e&&e.storageObject&&e.storageObject.storageRef&&e.storageObject.storageRef.type===this.managedEntityConstants.STORAGE_POD},e.prototype.hasDatastoreAllocateSpacePrivilege=function(e){var i=this.authorizationService.checkPrivileges(e,[t.DATASTORE_ALLOCATESPACE_PRIVILEGE]);return i.then(function(e){return!!e[0]})},e.prototype.buildStorageSelectConfig=function(e){var t={name:this.i18n("VmUi","DiskPage.StoreWithVM")},i={name:this.i18n("VmUi","DiskPage.Browse")},r={};if(e){var n={name:e.name,id:e.id,storageObject:e.storageObject};r={options:[t,n,i],selection:n}}else r={options:[t,i],selection:t};return r},e.prototype.getAllBackendStorageCallPromises=function(e,t,i){var r=t,n=r.then(function(t){var i={assignments:t.vmStorageProfileAssignments,replication:t.vmReplicationGroupAssignments};return i.replication||(i.replication=e.when({})),i=e.all(i).then(function(e){var t=e.assignments.vmStorageProfileAssignments,i=e.replication.vmReplicationGroupAssignments,r={vmStorageProfileAssignments:t,vmReplicationGroupAssignments:i};return r},function(e){return{vmStorageProfileAssignments:null,vmReplicationGroupAssignments:null}})})["catch"](function(e){return{vmStorageProfileAssignments:null,vmReplicationGroupAssignments:null}}),o={storageProfilesPromiseResult:i,vmAssignmentsPromiseResult:n};return o},e.$inject=["managedEntityConstants","authorizationService","i18nService","vmHardwareUtil","vmHardwareVirtualDiskSharesService","vmHardwareVirtualDiskIopsService","vmHardwareVirtualDiskModeService","vmHardwareVirtualDiskFlashReadCacheService"],e}();e.VmHardwareVirtualDiskService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskService",i)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t){var i=this,r=t.getString.bind(t,"Common");e.i18n=t.getString,i.descriptionText=r("StorageLocatorControl.SelectDatastoreDesc")}angular.module("com.vmware.vsphere.client.vm").controller("VmDatastoreLocationBrowserController",e),e.$inject=["$scope","i18nService"]}(),function(){function e(e,t,i,r,n,o){return{getStorageLocatorItems:function(e){return i.getProperties(e,"host").then(function(e){var t=n.getVsphereObjectId(e.host);return o.getStorageLocatorData(t,t)})},choose:function(i,o){var a=e.defer(),s={storageData:o.storageData,storageProfilesData:o.storageProfilesData,disableSdrs:o.disableSdrs,comparatorWrapper:o.comparatorWrapper,preselectItem:o.preselectItem,onSelectionChanged:function(e){s.submitDisabled=!e},title:t.getString("Common","StorageLocatorDialog.Title"),contentTemplate:"vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDisk/vmDatastoreLocationBrowserDialog.html",defaultButton:"submit",size:"lg",hideSubmitButton:!1,submitDisabled:!0,onCancel:function(){return a.reject(),!0}};return s.onSubmit=function(){return a.resolve({selectedStorageItem:{storageObject:s.storageData.selectedStorageItem,name:s.storageData.selectedStorageItem.name,id:n.getVsphereObjectId(s.storageData.selectedStorageItem.storageRef)},selectedStorageProfile:s.storageProfilesData.selectedProfile}),!0},r.openOkCancelModal(s),a.promise}}}angular.module("com.vmware.vsphere.client.vm").service("vmDatastoreLocationBrowserService",e),e.$inject=["$q","i18nService","dataService","clarityModalService","defaultUriSchemeUtil","storageLocatorService"]}();var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDisk/vmHardwareVirtualDisk.html",this.controllerAs="ctrl",this.controller=i,this.bindings={inflatedDevice:"<",
selectedStorageProfile:"<",selectedDiskFormat:"<",storageBaselineId:"<",getAdvancedConfigurationForDisk:"&",getStorageForDisk:"&",storageProfiles:"<",isVmEncrypted:"<",createMode:"<",cloneMode:"<",deployVmtxMode:"<",virtualMachineDevices:"<",setStorageForDisk:"&",vmConfigContext:"<",vmStorageId:"@",vmAssignmentsProperties:"<",computeResourceId:"<",vmHomeReplicationGroup:"<",storageLocatorItemsData:"<",removeCallback:"&",vmId:"<",showStoragePods:"<",expanded:"=",keepExistingProfileAssignments:"<",isGroupingHardDisks:"<"}}return e}(),i=function(){function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C,D,w){this.$q=e,this.$scope=t,this.$rootScope=i,this.$element=r,this.i18nService=n,this.virtualDiskSettingsFormService=o,this.diskProvisioningService=a,this.vmDatastoreLocationBrowserService=s,this.defaultUriSchemeUtil=c,this.datastoreService=l,this.authorizationService=d,this.VirtualDisk=u,this.vmHardwareVirtualDiskService=p,this.vmDeviceInfoService=v,this.managedEntityConstants=m,this.deviceClassLineageService=g,this.$timeout=h,this.diskBackingInfoConstants=f,this.storageProfileService=S,this.spbmReplicationGroupInfoService=y,this.deviceTypeConstants=P,this.virtualDiskPmemService=C,this.vmCryptUtilService=D,this.basicDiskUtilService=w,this.DELETE_FILE_FROM_DISK_OPERATION="destroy",this._unitChangedCallback=null,this._updateProfileFromUiCallback=null,this.ARIA_LBL_CAPACITY=this.i18n("VmUi","VmDiskView.capacity"),this.ARIA_LBL_PROFILE=this.disk18n("Profile"),this.ARIA_LBL_LOCATION=this.disk18n("Location"),this.ARIA_LBL_RGROUP=this.disk18n("ProtectionGroup"),this.ARIA_LBL_PROVISION=this.disk18n("DiskProvisioning"),this.ARIA_LBL_LIMIT_IOPS=this.disk18n("LimitIOPs"),this.ARIA_LBL_CACHE=this.disk18n("CacheReservation"),this.ARIA_LBL_SHARING=this.disk18n("Sharing"),this.ARIA_LBL_SHARES=this.disk18n("Shares"),this.ARIA_LBL_DISK_MODE=this.disk18n("DiskMode"),this.ARIA_LBL_REMOVE=this.device18n("DeviceDeleted"),this.ARIA_LBL_DESTROY=this.device18n("DeleteFiles"),this.ARIA_LBL_RESTORE=this.device18n("Restore")}return e.prototype.i18n=function(e,t){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var n=(o=this.i18nService).getString.apply(o,[e,t].concat(i));return n;var o},e.prototype.$onInit=function(){var e=this;e.device=e.inflatedDevice.getCurrentDevice(),e.datastoreInfo=this.datastoreService.findDatastore(e.vmStorageId,e.vmConfigContext.environment.configTarget),e.isPoweredOn="poweredOn"===e.vmConfigContext.environment.powerState,e.deviceName=e.device.deviceInfo.label,e.formKey=e.inflatedDevice.getKey().toString().replace("-","__"),e.controllerSelectorName="editVirtualDeviceController"+e.formKey,e.controllerNodeSelectorName="editVirtualDeviceNode"+e.formKey,e.deleteFilesFromDisk=!1,e.inflatedDevice.getDiskFileOperation()===this.DELETE_FILE_FROM_DISK_OPERATION&&(e.deleteFilesFromDisk=!0),e.formId="vmHardwareVirtualDiskForm"+e.formKey,e.diskLocationErrorConfig={message:e.i18n("VmUi","SelectDatastoreProvisioningPage.NoPermissionOnDatastore"),isVisible:!1},e.diskProfileErrorConfig={message:void 0,isVisible:!1},e.isPmemDisk=e.inflatedDevice.isPmemDisk(),e.isExistingPmemDisk=e.inflatedDevice.isPmemDisk()&&!e.inflatedDevice.isNew(),e.isVmHomeProfileChanged=!1,e.isDiskAlreadyEncrypted=e.inflatedDevice.isDiskAlreadyEncrypted(),e.isStorageProfileChanged=!1,e.isEncryptionProfileApplied=e.inflatedDevice.isEncryptionProfileApplied(),this.$scope.$watch(function(){return e.vmConfigContext.vmProfile},_.bind(function(t,i){t!==i&&(e.isVmHomeProfileChanged=!0,e.checkEncryptionWarning())},e)),this.$scope.$watch(function(){return e.inflatedDevice.storageProfile},_.bind(function(t,i){t!==i&&(e.updateProfile(t,null,!1),e.virtualDiskSettingsForm.storageProfile&&(e.virtualDiskSettingsForm.storageProfile.selection=t))},e)),e.replicationGroupItems=[],e.selectedReplicationGroupItem=null,e.replicationGroupErrorConfig={message:"",isVisible:!1},e.virtualMachineDevices.addRgValidationCallback(e.device.key,this.validateReplicationGroupSelection.bind(this)),this.$rootScope.$on(this.vmHardwareVirtualDiskService.DISK_STACK_EXPANDED,function(t,i){e.inflatedDevice.getKey()!==i.deviceKey&&(e.expanded=!1)}),this.$q.all(this.getAllBackendStorageCallPromises()).then(function(t){if(e.storageProfiles=t.storageProfilesPromiseResult,e.vmAssignmentsProperties=t.vmAssignmentsPromiseResult||{},!e.createMode&&!e.cloneMode&&e.vmAssignmentsProperties&&e.vmAssignmentsProperties.vmStorageProfileAssignments&&e.storageProfiles){var i=e.inflatedDevice.getCurrentDeviceSpec().device,r=null;i&&i.key&&_.forEach(t.vmAssignmentsPromiseResult.vmReplicationGroupAssignments,function(e){if(e&&e.vmObjectId){var t=e.vmObjectId.split(":");t.length>1&&t[1]===i.key.toString()&&(r=e.replicationGroup)}});var n=e.storageProfileService.makeProfileFromDevice(i,e.storageProfiles,e.vmAssignmentsProperties.vmStorageProfileAssignments,r,e.inflatedDevice.isNew());e.inflatedDevice.setOriginalProfile(n,r)}if(e.inflatedDevice.isNew()){e.virtualDiskSettingsForm=e.virtualDiskSettingsFormService.build(e.vmAssignmentsProperties.vmStorageProfileAssignments,e.createMode||e.cloneMode,e.vmConfigContext,e.inflatedDevice,e.vmStorageId,e.selectedStorageProfile,e.storageProfiles,e.virtualMachineDevices);var o=e.virtualDiskSettingsForm.selectedDiskProvisioningOption?e.virtualDiskSettingsForm.selectedDiskProvisioningOption.type:e.virtualDiskSettingsForm.diskProvisioningOptions[0].type;e.updateDiskProvisioningType(o),e.virtualDiskSettingsForm.storageProfile&&e.virtualDiskSettingsForm.storageProfile.selection&&e.updateProfile(e.virtualDiskSettingsForm.storageProfile.selection,e.inflatedDevice.getCurrentReplicationGroup());var a={id:null,hasPrivilege:!0};e.storeWithVmOption={name:e.i18n("VmUi","DiskPage.StoreWithVM")},e.browseDialogOption={name:e.i18n("VmUi","DiskPage.Browse")},e.buildStorageSelectConfig=function(t){if(t){var i={name:t.name,id:t.id,storageObject:t.storageObject};return{options:[e.storeWithVmOption,i,e.browseDialogOption],selection:i}}return{options:[e.storeWithVmOption,e.browseDialogOption],selection:e.storeWithVmOption}},e.checkDiskLocationPrivilege=function(t){var i=e.defaultUriSchemeUtil.getEntityType(t);if(i===e.managedEntityConstants.STORAGE_POD)return void e.setDiskLocationValidity(!0);if(a.id===t)return void e.setDiskLocationValidity(a.hasPrivilege);a.id=t;var r=["Datastore.AllocateSpace"],n=e.authorizationService.checkPrivileges(t,r);return n.then(function(t){var i=t[0];a.hasPrivilege=i,e.setDiskLocationValidity(i)})},e.setDiskLocationValidity=function(t){e.diskLocationErrorConfig.isVisible=!t,e.$timeout(function(){var i=e[e.formId];if(i){var r=i["disk-location"];r&&(r.$invalid=!t),e[e.formId].$setValidity("diskLocation",t)}},50)};var s=null;if(e.getStorageForDisk){var c=e.getStorageForDisk({diskKey:e.device.key});c&&(s={key:c.dsKey,id:c.dsId,name:c.dsName,storageObject:c.dsObject})}e.datastores=e.buildStorageSelectConfig(s)}else e.virtualDiskSettingsForm=e.virtualDiskSettingsFormService.build(e.vmAssignmentsProperties.vmStorageProfileAssignments,e.createMode||e.cloneMode,e.vmConfigContext,e.inflatedDevice,e.vmStorageId,null,e.storageProfiles,e.virtualMachineDevices);e.applyPmemPostProcessingToDisk(),e.postInit()}),this.$scope.$on("deviceAdded",function(t,i){e.isAddedDeviceAController(i.deviceType)&&e.rebuildControllersDropdown()}),this.$scope.$on("deviceRemoved",function(t,i){e.inflatedDevice.isOfType("VirtualDisk")&&e.$rootScope.$broadcast(e.vmHardwareVirtualDiskService.DISKS_UPDATED),e.isAddedDeviceAController(i.deviceType)&&e.rebuildControllersDropdown(),e.validateReplicationGroupSelection()}),e.isDiskEditable=this.determineDiskEditability(),e.isRDMDisk=this.determineIfRdmDisk(),e.customValidators=[{name:"non-zero",validate:function(e){return 0!==e},message:e.i18n("VmUi","DiskConfig.ErrorCapacityZero")}],this.buildIopsLimitDetails()},Object.defineProperty(e.prototype,"unitChangedCallback",{get:function(){var e=this;return this._unitChangedCallback||(this._unitChangedCallback=function(t){e.onUnitChanged(t)}),this._unitChangedCallback},enumerable:!0,configurable:!0}),e.prototype.onUnitChanged=function(e){var t=this;t.virtualDiskSettingsForm.capacity.memoryUnitPreferred=e,t.inflatedDevice.getCurrentDeviceSpec().memoryUnitPreferred=e},e.prototype.onValueChanged=function(){var e=this;e.inflatedDevice.updateCapacity(e.virtualDiskSettingsForm.capacity.valueInMB),this.$rootScope.$broadcast(this.vmHardwareVirtualDiskService.DISK_SIZE_UPDATED,{size:e.virtualDiskSettingsForm.capacity.valueInMB,units:e.virtualDiskSettingsForm.capacity.memoryUnitPreferred.label})},e.prototype.isExpandable=function(){var e=this;return!e.deployVmtxMode&&!!e.virtualDiskSettingsForm},Object.defineProperty(e.prototype,"updateProfileFromUiCallback",{get:function(){var e=this;return this._updateProfileFromUiCallback||(this._updateProfileFromUiCallback=function(t){e.updateProfileFromUi(t)}),this._updateProfileFromUiCallback},enumerable:!0,configurable:!0}),e.prototype.updateProfileFromUi=function(e){var t=this;t.updateProfile(e),t.inflatedDevice.setStorageProfileManuallySet(!0),this.updateReplicationGroupData(e)},e.prototype.updateProfile=function(e,t,i){void 0===t&&(t=void 0),void 0===i&&(i=void 0);var r=this;r.isStorageProfileChanged=!0,t=t||(r.selectedReplicationGroupItem?r.selectedReplicationGroupItem.replicationGroupInfo:null),r.inflatedDevice.updateDiskProfile(e,t),r.isPmemDisk=this.virtualDiskPmemService.handlePmemIfPmemProfile(r.inflatedDevice,e,r.selectedDiskFormat),r.isEncryptionProfileApplied=r.inflatedDevice.isEncryptionProfileApplied(),r.isEncryptionProfileApplied||(r.inflatedDevice.getCurrentDevice().backing.keyId=null),r.checkEncryptionWarning(),i!==!1&&this.$rootScope.$broadcast(this.vmHardwareVirtualDiskService.DISKS_UPDATED)},e.prototype.checkEncryptionWarning=function(){var e=this;return e.isEncryptionProfileApplied&&!e.isVmHomeEncrypted()?void e.setDiskProfileValidity(!1,e.i18n("VmUi","DiskConfig.ErrorVmHomeEncryptionRequired")):e.inflatedDevice.isCreatedFromExistingDisk()&&e.isEncryptionProfileApplied&&!e.isDiskAlreadyEncrypted?void e.setDiskProfileValidity(!1,e.i18n("VmUi","DiskConfig.ErrorNoEncryptionOnAttach")):e.inflatedDevice.isCreatedFromExistingDisk()&&!e.isEncryptionProfileApplied&&e.isDiskAlreadyEncrypted?void e.setDiskProfileValidity(!1,e.i18n("VmUi","DiskConfig.ErrorNoDecryptionOnAttach")):void e.setDiskProfileValidity(!0)},e.prototype.isVmHomeEncrypted=function(){var e=this;if(e.vmConfigContext.vmProfile){var t=this.storageProfileService.findProfile(e.storageProfiles,e.vmConfigContext.vmProfile[0]);return e.isVmEncrypted=this.storageProfileService.isEncryptionStorageProfile(t),e.isVmEncrypted}return e.isVmHomeProfileChanged||this.vmCryptUtilService.isCryptoKeyEmpty(e.vmConfigContext.config.keyId)?e.isVmEncrypted:(e.isVmEncrypted=!0,e.isVmEncrypted)},e.prototype.getDiskEncryptionStatus=function(){var e=this;return this.vmCryptUtilService.getDiskEncryptionStatus(e.isDiskAlreadyEncrypted,e.isStorageProfileChanged,e.isEncryptionProfileApplied)},e.prototype.setDiskProfileValidity=function(e,t){void 0===t&&(t=void 0);var i=this;i.diskProfileErrorConfig.isVisible=!e,i.diskProfileErrorConfig.message=t;var r=i[i.formId];if(r){var n=r["storage-profile"];n&&(n.$invalid=!e),i[i.formId].$setValidity("diskProfile",e)}},e.prototype.updateDiskProvisioningType=function(e){var t=this.diskProvisioningService.backingInfoKeys(e);this.inflatedDevice.updateDiskProvisioningOption(t)},e.prototype.updateDiskController=function(e,t){t&&this.inflatedDevice.updateControllerAndNodeKeys(e.getKey(),t.key)},e.prototype.showDiskFile=function(){var e=this;return e.expanded&&(!e.createMode&&!e.cloneMode||e.inflatedDevice.isCreatedFromExistingDisk())&&!!e.virtualDiskSettingsForm&&!!e.virtualDiskSettingsForm.diskFile},e.prototype.isRemoveDisabled=function(){var e=this;return!e.createMode&&this.vmHardwareVirtualDiskService.isRemoveDiskDisabled(e.vmConfigContext.privileges)},e.prototype.onRemoveHardDisk=function(){var e=this;!e.isRemoveDisabled()&&e.removeCallback&&(e.removeCallback()(e.inflatedDevice),e.isPmemDisk&&(e.deleteFilesFromDisk=!0,e.updateDiskFileOperation()))},e.prototype.isEditIopsLimitDisabled=function(){var e=this;return e.isPmemDisk||this.vmHardwareVirtualDiskService.isEditIopsLimitDisabled(e.vmConfigContext.privileges,e.createMode)},e.prototype.getPmemMax=function(){var e=this;return this.virtualDiskPmemService.getMaxAllowedCapacity(e.vmConfigContext,e.inflatedDevice,e.virtualMachineDevices)},e.prototype.getDiskText=function(){var e=this;if(!e.virtualDiskSettingsForm)return"";var t=this.basicDiskUtilService.determineDisplayDiskSize(e.virtualDiskSettingsForm.capacity.valueInMB);return t?this.basicDiskUtilService.roundToPrecision(t.size,2).toString()+" "+t.unitText:""},e.prototype.shouldShowDiskSizeLabelOnly=function(){var e=this;return!e.virtualDiskSettingsForm||!e.inflatedDevice.isNew()&&e.isGroupingHardDisks&&(!e.virtualDiskSettingsForm.capacity.validUnits||!e.expanded)},e.prototype.getMax=function(){var e=this;return this.isExistingDiskAddition()?Number.MAX_VALUE:e.isPmemDisk?e.getPmemMax():e.virtualDiskSettingsForm.capacity.maxInMB},e.prototype.getMin=function(){var e=this;return this.isExistingDiskAddition()?Number.MIN_VALUE:e.isDiskEditable?e.isExistingPmemDisk?e.inflatedDevice.getOriginalCapacityInMB():e.isPmemDisk?this.virtualDiskPmemService.getDefaultMinValueForNewPmemDisk():e.virtualDiskSettingsForm.capacity.minInMB:Number.MIN_VALUE},e.prototype.onReplicationGroupSelectionChange=function(){var e=this;e.updateProfile(e.virtualDiskSettingsForm.storageProfile.selection),this.validateReplicationGroupSelection(),e.virtualMachineDevices.notifyRgValidationCallbacks()},e.prototype.onDatastoreSelectionChange=function(e,t){var i=this;e.name===this.browseDialogOption.name?(i.getStorageForDisk&&(this.selectedStorage=i.getStorageForDisk({diskKey:i.device.key})),t.storageObject&&t.storageObject.storageRef||!t.id||(t.storageObject=t.storageObject?t.storageObject:{},t.storageObject.storageRef=this.defaultUriSchemeUtil.getManagedObjectReference(t.id)),this.getStorageLocatorItemsForCreateOrEditMode().then(function(e){var r=i.virtualDiskSettingsForm.storageProfile?i.virtualDiskSettingsForm.storageProfile.selection:void 0;i.vmDatastoreLocationBrowserService.choose(i.$scope,{storageProfilesData:{storageProfiles:i.storageProfiles,selectedProfile:r},storageData:{storageLocatorItemsData:e,selectedStorageItem:t.storageObject},disableSdrs:!i.showStoragePods}).then(function(e){i.virtualDiskSettingsForm.storageProfile||(i.virtualDiskSettingsForm.storageProfile={}),i.virtualDiskSettingsForm.storageProfile.selection=e.selectedStorageProfile,i.updateProfile(e.selectedStorageProfile),i.datastores=i.buildStorageSelectConfig(e.selectedStorageItem),i.checkDiskLocationPrivilege(i.datastores.selection.id),i.setCapacityAndErrorMessage(i.datastores.selection,i.datastores.selection.id),i.updateReplicationGroupData(e.selectedStorageProfile,e.selectedStorageItem.storageObject.storageRef),i.virtualDiskSettingsForm.diskProvisioningOptions=i.virtualDiskSettingsFormService.buildDiskProvisioningTypes(i.datastores.selection.storageObject.type,i.datastores.selection.storageObject.vStorageSupport),i.virtualDiskSettingsForm.selectedDiskProvisioningOption=i.virtualDiskSettingsForm.diskProvisioningOptions[0]},function(){i.datastores.selection=t})})):e.name===i.storeWithVmOption.name?(this.setDiskLocationValidity(!0),this.setCapacityAndErrorMessage(null),this.updateReplicationGroupData(),i.virtualDiskSettingsForm.diskProvisioningOptions=this.virtualDiskSettingsFormService.buildDiskProvisioningTypes(i.datastoreInfo?i.datastoreInfo.datastore.type:"",i.datastoreInfo?i.datastoreInfo.vStorageSupport:""),i.virtualDiskSettingsForm.selectedDiskProvisioningOption=i.virtualDiskSettingsForm.diskProvisioningOptions[0]):(this.checkDiskLocationPrivilege(e.id),this.setCapacityAndErrorMessage(e,e.id),this.updateReplicationGroupData(null,i.datastores.selection.storageObject.storageRef),i.virtualDiskSettingsForm.diskProvisioningOptions=this.virtualDiskSettingsFormService.buildDiskProvisioningTypes(i.datastores.selection.storageObject.type,i.datastores.selection.storageObject.vStorageSupport),i.virtualDiskSettingsForm.selectedDiskProvisioningOption=i.virtualDiskSettingsForm.diskProvisioningOptions[0])},e.prototype.expandedChanged=function(e){var t=this;t.expanded!==e&&(t.expanded=e,t.inflatedDevice.isNew()?(this.setDiskLocationValidity(!t.diskLocationErrorConfig.isVisible),t.setDiskProfileValidity(!t.diskProfileErrorConfig.isVisible,t.diskProfileErrorConfig.message)):t.expanded&&t.isGroupingHardDisks&&this.$rootScope.$broadcast(this.vmHardwareVirtualDiskService.DISK_STACK_EXPANDED,{deviceKey:t.inflatedDevice.getKey()}))},e.prototype.revertRemoval=function(){var e=this;e.inflatedDevice.revertRemoval(),e.virtualMachineDevices.notifyRgValidationCallbacks()},e.prototype.isEditDiskModeDisabled=function(){var e=this;return e.isPmemDisk||this.vmHardwareVirtualDiskService.isEditDiskModeDisabled(e.inflatedDevice,e.createMode,e.vmConfigContext)},e.prototype.isEditFlashReadCacheDisabled=function(){var e=this;return e.isPmemDisk||this.vmHardwareVirtualDiskService.isEditFlashReadCacheDisabled(e.vmConfigContext.privileges,e.createMode)},e.prototype.isEditSharesDisabled=function(){var e=this;return e.isPmemDisk||this.vmHardwareVirtualDiskService.isEditSharesDisabled(e.vmConfigContext.privileges,e.createMode,e.vmConfigContext.environment.configOption.capabilities.diskSharesSupported)},e.prototype.isDiskSharingDisabled=function(){var e=this;return e.isPmemDisk||e.isPoweredOn&&!e.inflatedDevice.isNew()},e.prototype.hasPrivilegesToEdit=function(){var e=this;return this.vmHardwareVirtualDiskService.hasPrivilegesToEditCapacity(e.vmConfigContext.privileges,e.createMode)},e.prototype.updateDiskFileOperation=function(){var e=this;e.deleteFilesFromDisk?e.inflatedDevice.setDiskFileOperation(this.DELETE_FILE_FROM_DISK_OPERATION):e.inflatedDevice.setDiskFileOperation(void 0)},e.prototype.updateFlashCacheReservation=function(e){this.inflatedDevice.updateFlashCacheReservation(e)},e.prototype.hasError=function(){var e=this;return!_.isEmpty(e[e.formId])&&e[e.formId].$invalid},e.prototype.shouldDisplayShares=function(e){var t=this;if(!_.isEmpty(t[t.formId])){var i=t[t.formId].$error;if(!_.isEmpty(i))for(var r in i)if(i[r].length>1&&i[r][1].$name.startsWith("DiskSharesValue"))return!0}return e},e.prototype.shouldDisplayIOPS=function(e){var t=this;if(!_.isEmpty(t[t.formId])){var i=t[t.formId].$error;if(!_.isEmpty(i))for(var r in i)if(i[r].length>1&&i[r][1].$name.startsWith("IopsLimitValue"))return!0}return e},e.prototype.showVmStoragePolicy=function(e){var t=this;return e=e||!1,e&&(!t.cloneMode||t.inflatedDevice.isNew())},e.prototype.showReplicationGroup=function(e){var t=this;return e=e||!1,e&&t.replicationGroupItems.length&&(!t.cloneMode||t.inflatedDevice.isNew())},e.prototype.areStorageProfilesReadOnly=function(){var e=this;return!e.virtualDiskSettingsForm||!e.virtualDiskSettingsForm.storageProfile||!e.virtualDiskSettingsForm.storageProfile.options||0===e.virtualDiskSettingsForm.storageProfile.options.length||e.isExistingPmemDisk},e.prototype.shouldDisableDiskEdit=function(){var e=this;return!e.isDiskEditable||e.inflatedDevice.isCreatedFromExistingDisk()||!e.hasPrivilegesToEdit()},e.prototype.getSelectedVirtualNodeText=function(){var e=this;if(e.virtualDiskSettingsForm&&e.virtualDiskSettingsForm.controllers){var t=e.virtualDiskSettingsForm.controllers.selection.getCurrentDevice();return this.vmDeviceInfoService.getControllerAndNodeLabelText(t._type,t.busNumber,e.inflatedDevice.getCurrentDevice().unitNumber)}return""},e.prototype.validateReplicationGroupSelection=function(){function e(){if(!t.replicationGroupItems||!t.replicationGroupItems.length)return"";if(!t.selectedReplicationGroupItem)return t.i18n("VmUi","DiskConfig.selectReplicationGroup");var e=[];return t.vmHomeReplicationGroup&&e.push(t.vmHomeReplicationGroup),_.forEach(t.virtualMachineDevices.devicesNotMarkedForRemovalOfType("VirtualDisk"),function(i){var r=null;if(t.cloneMode){var n=t.getAdvancedConfigurationForDisk({virtualDiskDevice:i});r=n?n.replicationGroup:i.getCurrentReplicationGroup()}else r=i.getCurrentReplicationGroup();r&&e.push(r)}),t.spbmReplicationGroupInfoService.validateVmReplicationGroupAssignments(e)}var t=this;t.replicationGroupErrorConfig.message=e();var i=!t.replicationGroupErrorConfig.message;t.replicationGroupErrorConfig.isVisible=!i;var r=t[t.formId];if(r){var n=r["replication-group"];n&&(n.$invalid=!i),t[t.formId].$setValidity("replicationGroup",i)}},e.prototype.updateReplicationGroupData=function(e,t){void 0===e&&(e=void 0),void 0===t&&(t=void 0);var i=this;if(!i.cloneMode||i.inflatedDevice.isNew()){if(!e&&i.virtualDiskSettingsForm.storageProfile&&(e=i.virtualDiskSettingsForm.storageProfile.selection),!t){var r=i.inflatedDevice.getCurrentDeviceSpec();r&&r.device&&r.device.backing&&r.device.backing.datastore?t=r.device.backing.datastore:i.vmStorageId&&(t=this.defaultUriSchemeUtil.getManagedObjectReference(i.vmStorageId))}this.storageProfileService.requestCompatibilityResultForDatastore(e&&e.profileObj,t).then(function(e){i.replicationGroupItems=[],i.selectedReplicationGroupItem=null;var t=i.inflatedDevice.getCurrentReplicationGroup()?i.inflatedDevice.getCurrentReplicationGroup().id:null,r=!!t;if(e&&e.compatibilityResult){var n=i.computeResourceId?i.defaultUriSchemeUtil.getManagedObjectReference(i.computeResourceId):null,o=n&&"HostSystem"===n.type?[n]:[],a=i.spbmReplicationGroupInfoService.extractReplicationGroupInfos(e.compatibilityResult,o,e.replicationGroupInfo);_.forEach(a,function(e){var r={label:i.spbmReplicationGroupInfoService.getReplicationGroupName(e),replicationGroupInfo:e};i.replicationGroupItems.push(r),t&&i.spbmReplicationGroupInfoService.equalReplicationGroupIds(t,e.id)&&(i.selectedReplicationGroupItem=r)}),t&&!i.selectedReplicationGroupItem||(r=!1)}r&&i.onReplicationGroupSelectionChange(),i.validateReplicationGroupSelection()})}},e.prototype.isExistingDiskAddition=function(){var e=this;return e.inflatedDevice.isNew()&&e.inflatedDevice.isCreatedFromExistingDisk()},e.prototype.determineDiskEditability=function(){var e=this;return!this.determineIfRdmDisk()&&(!!e.createMode||(!e.isPmemDisk||!e.isPoweredOn)&&!e.inflatedDevice.getCurrentDevice().backing.parent)},e.prototype.determineIfRdmDisk=function(){var e=this;return e.inflatedDevice.getCurrentDevice().backing._type===this.diskBackingInfoConstants.RAWDISKMAPPING},e.prototype.buildIopsLimitDetails=function(){var e=this,t=16,i=Math.pow(2,31)-1;e.iopsLimitDetails={},e.iopsLimitDetails.min=t,e.iopsLimitDetails.max=i,e.iopsLimitDetails.iopsRecommendations=[{name:e.i18n("VmUi","VmCpu.Limit.Minimum"),value:t},{name:e.i18n("VmUi","VmCpu.Limit.Maximum"),value:i}],e.iopsLimitDetails.iopsLimitSelectList=[{label:e.i18n("VmUi","DiskConfig.Unlimited"),data:"unlimited"},{label:e.i18n("VmUi","sharesInfoLevel.custom"),data:"custom"}],e.iopsLimitDetails.errorMessage={max:function(){return e.i18n("Common","SharesControl.RangeError",t,i)},min:function(){return e.i18n("Common","SharesControl.RangeError",t,i)}},e.iopsLimitDetails.selectChange=function(){"unlimited"===e.iopsLimitDetails.iopsLimitSelection.data?e.virtualDiskSettingsForm.ioLimit=e.VirtualDisk.UNLIMITED_DISK:e.virtualDiskSettingsForm.ioLimit=t,e.inflatedDevice.updateStorageIOAllocation(e.virtualDiskSettingsForm.ioLimit)}},e.prototype.applyPmemPostProcessingToDisk=function(){var e=this;if((!e.createMode||!this.applyPmemProfileToDisk())&&e.cloneMode){var t=e.getAdvancedConfigurationForDisk(e.inflatedDevice);if(t)return void e.updateProfile(t.storageProfile,t.replicationGroup);if(this.applyPmemProfileToDisk())return;var i=this.storageProfileService;if(!e.inflatedDevice.isStorageProfileManuallySet()){var r=e.selectedStorageProfile;if(!e.inflatedDevice.isNew()&&e.keepExistingProfileAssignments){r=i.getDefaultProfile();var n=i.findDiskAssignment(e.vmAssignmentsProperties.vmStorageProfileAssignments,e.inflatedDevice.getCurrentDevice());n&&(r={id:n.profile.profileId.uniqueId,label:n.profile.name})}e.updateProfile(r,e.inflatedDevice.getCurrentReplicationGroup()),e.virtualDiskSettingsForm.storageProfile.selection=r}}},e.prototype.findPmemProfile=function(e){var t=this;return _.find(e,function(e){return t.storageProfileService.isPmemStorageProfile(e)})},e.prototype.applyPmemProfileToDisk=function(){var e=this;if(this.virtualDiskPmemService.shouldApplyPmemProfileToDisk(e.inflatedDevice,e.storageBaselineId)){var t=this.findPmemProfile(e.storageProfiles);return e.updateProfile(t),e.virtualDiskSettingsForm.storageProfile.selection=t,!0}return!1},e.prototype.postInit=function(){var e=this;this.setErrorMessage(e.virtualDiskSettingsForm.capacity.maxExceededErrorMessage),e.iopsLimitDetails.iopsLimitSelection=e.virtualDiskSettingsForm.ioLimit===this.VirtualDisk.UNLIMITED_DISK?e.iopsLimitDetails.iopsLimitSelectList[0]:e.iopsLimitDetails.iopsLimitSelectList[1],e.createMode||(e.errorMessages.min=e.i18n("VmUi","DiskConfig.ErrorCapacityShrink")),this.updateReplicationGroupData()},e.prototype.setErrorMessage=function(e){var t=this;t.errorMessages={max:e}},e.prototype.setCapacityAndErrorMessage=function(e,t){void 0===t&&(t=void 0);var i=this,r=this.datastoreService.findDatastore(t||i.vmStorageId,i.vmConfigContext.environment.configTarget);e&&!this.isStoragePod(e)?i.virtualDiskSettingsForm.diskFile="["+e.name+"]":i.virtualDiskSettingsForm.diskFile="";var n=this.virtualDiskSettingsFormService.buildCapacity(i.inflatedDevice,i.createMode||i.cloneMode,r);i.virtualDiskSettingsForm.capacity.minInMB=n.minInMB,i.virtualDiskSettingsForm.capacity.maxInMB=n.maxInMB,i.virtualDiskSettingsForm.capacity.maxExceededErrorMessage=n.maxExceededErrorMessage,i.virtualDiskSettingsForm.capacity.isMaxAvailable=n.isMaxAvailable,this.setErrorMessage(i.virtualDiskSettingsForm.capacity.maxExceededErrorMessage),i.setStorageForDisk({storageInfo:e,device:i.device}),i.inflatedDevice.updateFileName(i.virtualDiskSettingsForm.diskFile),e&&e.storageObject?(i.inflatedDevice.updateDatastoreMor(e.storageObject.storageRef),e.storageObject.parentStoragePod&&i.inflatedDevice.updateParentStoragePodMor(e.storageObject.parentStoragePod)):i.inflatedDevice.updateDatastoreMor(null)},e.prototype.isStoragePod=function(e){return e&&e.storageObject&&e.storageObject.storageRef&&e.storageObject.storageRef.type===this.managedEntityConstants.STORAGE_POD},e.prototype.isAddedDeviceAController=function(e){var t=e===this.deviceTypeConstants.SCSICONTROLLER||this.deviceClassLineageService.isClassNameSubclassOf(e,this.deviceTypeConstants.SCSICONTROLLER),i=e===this.deviceTypeConstants.VIRTUAL_SATA_CONTROLLER||this.deviceClassLineageService.isClassNameSubclassOf(e,this.deviceTypeConstants.VIRTUAL_SATA_CONTROLLER),r=e===this.deviceTypeConstants.NVME_CONTROLLER||this.deviceClassLineageService.isClassNameSubclassOf(e,this.deviceTypeConstants.NVME_CONTROLLER);return t||i||r},e.prototype.rebuildControllersDropdown=function(){var e=this;e.virtualDiskSettingsForm.controllers=this.virtualDiskSettingsFormService.buildControllersDropdown(e.inflatedDevice,e.virtualMachineDevices.getAllDevicesNotMarkedForRemoval())},e.prototype.getStorageLocatorItemsForCreateOrEditMode=function(){var e=this;return e.storageLocatorItemsData?this.$q.when(e.storageLocatorItemsData):this.vmDatastoreLocationBrowserService.getStorageLocatorItems(e.vmId)},e.prototype.getAllBackendStorageCallPromises=function(){var e=this;return e.createMode||e.cloneMode||!e.vmAssignmentsProperties?{storageProfilesPromiseResult:e.storageProfiles,vmAssignmentsPromiseResult:e.vmAssignmentsProperties}:this.vmHardwareVirtualDiskService.getAllBackendStorageCallPromises(this.$q,e.vmAssignmentsProperties,e.storageProfiles)},e.prototype.disk18n=function(e){return this.i18nService.getString("VmUi","DiskPage."+e)},e.prototype.device18n=function(e){return this.i18nService.getString("VmUi","DeviceDeletedControl."+e)},e.$inject=["$q","$scope","$rootScope","$element","i18nService","virtualDiskSettingsFormService","diskProvisioningService","vmDatastoreLocationBrowserService","defaultUriSchemeUtil","datastoreService","authorizationService","VirtualDisk","vmHardwareVirtualDiskService","vmDeviceInfoService","managedEntityConstants","deviceClassLineageService","$timeout","diskBackingInfoConstants","storageProfileService","spbmReplicationGroupInfoService","deviceTypeConstants","virtualDiskPmemService","vmCryptUtilService","basicDiskUtilService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDisk",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){}return e.prototype.onCompatibilityModeChange=function(e){this.onChange({compatibilityMode:e.value})},e}(),i=function(){function e(){this.bindings={isDisabled:"<",ariaLabel:"<",compatibilityModeInfo:"<",onChange:"&"},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskCompatibilityMode/vm-hardware-virtual-disk-compatibility-mode.html"}return e}();e.VmHardwareVirtualDiskCompatibilityMode=i,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskCompatibilityMode",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.vmDeviceInfoService=t,this.VIRTUAL_COMPATIBILITY_MODE="virtualMode"}return e.prototype.getCompatibilityModeInfo=function(e,t,i){var r=this,n=this.vmDeviceInfoService.backingOptionForDevice(e,t,i);if(n.compatibilityMode){var o=_.map(n.compatibilityMode.choiceInfo,function(e){return{name:r.i18nService.getString("VmUi","DiskPage."+e.key),value:e.key}}),a=_.find(o,function(e){return e.value===t.getCurrentDevice().backing.compatibilityMode});return{options:o,selection:a}}},e.$inject=["i18nService","vmDeviceInfoService"],e}();e.VmHardwareVirtualDiskCompatibilityModeService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskCompatibilityModeService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.i18nService=e,this.i18n=e.getString}return e.prototype.onFlashCacheReservationChange=function(){this.onChange({flashCacheReservation:this.flashCacheReservationInfo.valueInMB})},e.$inject=["i18nService"],e}(),i=function(){function e(){this.bindings={flashCacheReservationInfo:"<",isDisabled:"<",ariaLabel:"<",onChange:"&"},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskFlashReadCache/vm-hardware-virtual-disk-flash-read-cache.html"}return e}();e.VmHardwareVirtualDiskFlashReadCache=i,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskFlashReadCache",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=function(){function e(e,t,i){this.virtualDiskSettingsFormService=e,this.vmHardwareUtil=t,this.i18nService=i}return e.prototype.getFlashCacheReservationInfo=function(e,t){return{vFlashSupportedOnHost:t,valueInMB:e.vFlashCacheConfigInfo?e.vFlashCacheConfigInfo.reservationInMB:0,validUnits:[{label:this.i18nService.getString("VmUi","Vm.Units.MB"),multiplier:1}]}},e.prototype.hasPrivilegesToEditFlashReadCache=function(e,i){return void 0===i&&(i=!1),!!i||this.vmHardwareUtil.checkPrivileges(e,[t.VM_EDITDEVICE_PRIVILEGE])},e.prototype.isEditFlashReadCacheDisabled=function(e,t){return!this.hasPrivilegesToEditFlashReadCache(e,t)},e.$inject=["virtualDiskSettingsFormService","vmHardwareUtil","i18nService"],e}();e.VmHardwareVirtualDiskFlashReadCacheService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskFlashReadCacheService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){var r=this;this.i18nService=e,this.unlimited=t,this.iopsLimit=i,this.IOPSLIMIT_MIN=16,this.IOPSLIMIT_MAX=Math.pow(2,31)-1,this.IOPS_UNLIMITED_SELECTION="unlimited",this.IOPS_CUSTOM_SELECTION="custom";var n=e.getString;this.min=this.IOPSLIMIT_MIN,this.max=this.IOPSLIMIT_MAX,this.iopsRecommendations=[{
name:n("VmUi","VmCpu.Limit.Minimum"),value:this.IOPSLIMIT_MIN},{name:n("VmUi","VmCpu.Limit.Maximum"),value:this.IOPSLIMIT_MAX}],this.iopsLimitSelectList=[{label:n("VmUi","DiskConfig.Unlimited"),data:"unlimited"},{label:n("VmUi","sharesInfoLevel.custom"),data:"custom"}],this.errorMessage={max:function(){return n("Common","SharesControl.RangeError",r.IOPSLIMIT_MIN,r.IOPSLIMIT_MAX)},min:function(){return n("Common","SharesControl.RangeError",r.IOPSLIMIT_MIN,r.IOPSLIMIT_MAX)}},this.iopsLimitSelection=i===t?this.iopsLimitSelectList[0]:this.iopsLimitSelectList[1]}return e}();e.IopsLimitDetails=t;var i=function(){function e(){}return e}();e.IopsRecommendation=i;var r=function(){function e(){}return e}();e.IopsLimitSelect=r;var n=function(){function e(e,t){this.i18nService=e,this.VirtualDisk=t,this.i18n=e.getString}return e.prototype.onIopsLimitSelectionChange=function(){this.iopsLimitDetails.iopsLimitSelection.data===this.iopsLimitDetails.IOPS_UNLIMITED_SELECTION?this.iopsLimit=this.VirtualDisk.UNLIMITED_DISK:this.iopsLimit=this.iopsLimitDetails.IOPSLIMIT_MIN,this.onChange({iopsLimit:this.iopsLimit})},e.prototype.onIopsLimitValueChange=function(){this.onChange({iopsLimit:this.iopsLimit})},e.prototype.isCustom=function(){return!!this.iopsLimitDetails&&this.iopsLimitDetails.iopsLimitSelection.data===this.iopsLimitDetails.IOPS_CUSTOM_SELECTION},e.prototype.$onInit=function(){this.iopsLimit&&(this.iopsLimitDetails=new t(this.i18nService,this.VirtualDisk.UNLIMITED_DISK,this.iopsLimit))},e.prototype.$onChanges=function(e){e.iopsLimit.currentValue&&(this.iopsLimitDetails=new t(this.i18nService,this.VirtualDisk.UNLIMITED_DISK,this.iopsLimit))},e.$inject=["i18nService","VirtualDisk"],e}(),o=function(){function e(){this.bindings={iopsLimit:"<",isDisabled:"<",ariaLabel:"<",onChange:"&"},this.controller=n,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskIops/vm-hardware-virtual-disk-iops.html"}return e}();e.VmHardwareVirtualDiskIops=o,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskIops",new o)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=function(){function e(e,t){this.i18nService=e,this.vmHardwareUtil=t}return e.prototype.getIopsLimit=function(e){var t=e.getCurrentDevice().storageIOAllocation.limit;return t===-1?this.i18nService.getString("VmUi","DiskConfig.Unlimited"):t},e.prototype.isEditIopsLimitDisabled=function(e,t){return!this.hasPrivilegeToEditIopsLimit(e,t)},e.prototype.hasPrivilegeToEditIopsLimit=function(e,i){return void 0===i&&(i=!1),!!i||this.vmHardwareUtil.checkPrivileges(e,[t.VM_RESOURCE_PRIVILEGE,t.VM_EDITDEVICE_PRIVILEGE])},e.$inject=["i18nService","vmHardwareUtil"],e}();e.VmHardwareVirtualDiskIopsService=i,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskIopsService",i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t){var i=this;this.vmHardwareVirtualDiskModeService=e,this.i18nService=t,this.i18n=this.i18nService.getString,this.vmHardwareVirtualDiskModeService.getDiskModeSignPostParams().then(function(e){i.diskModeSignPostParams=e})}return e.prototype.onDiskModeChange=function(){this.onChange({diskMode:this.diskModeInfo.selection.value})},e.$inject=["vmHardwareVirtualDiskModeService","i18nService"],e}(),i=function(){function e(){this.bindings={diskModeInfo:"<",isDisabled:"<",ariaLabel:"<",onChange:"&"},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskMode/vm-hardware-virtual-disk-mode.html"}return e}();e.VmHardwareVirtualDiskMode=i,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskMode",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t,i,r){this.vmDeviceInfoService=e,this.i18nService=t,this.templateHelperService=i,this.vmHardwareUtil=r}return t.prototype.getDiskModeInfo=function(e,t,i){var r=this,n=this.vmDeviceInfoService.backingOptionForDevice(e,t,i),o=_.map(n.diskMode.choiceInfo,function(e){return{name:r.i18nService.getString("VmUi","DiskConfig."+e.key),value:e.key}}),a=_.find(o,function(e){return e.value===t.getCurrentDevice().backing.diskMode});return{options:o,selection:a}},t.prototype.getDiskModeSignPostParams=function(){var e=this,t="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskShared/vmHardwareVirtualDiskMode/vm-hardware-virtual-disk-mode-sign-post.html";return this.templateHelperService.renderTemplateWithScope(t,{i18n:this.i18nService.getString}).then(function(t){return{message:t,title:e.i18nService.getString("Common","help"),height:"250px"}})},t.prototype.hasPrivilegesToEditDiskMode=function(t,i){return void 0===i&&(i=!1),!!i||this.vmHardwareUtil.checkPrivileges(t,[e.Privileges.VM_EDITDEVICE_PRIVILEGE])},t.prototype.isEditDiskModeDisabled=function(e,t,i){return!this.hasPrivilegesToEditDiskMode(i.privileges,t)||(!(!this.vmHardwareUtil.isVmPoweredOn(i.environment.powerState)||e.isNew())||!t&&!!e.getCurrentDevice().backing.parent)},t.$inject=["vmDeviceInfoService","i18nService","templateHelperService","vmHardwareUtil"],t}();e.VmHardwareVirtualDiskModeService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareVirtualDiskModeService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.vmHardwareRdmVirtualDiskTypeService=e}return Object.defineProperty(e.prototype,"provisioningTypeLabel",{get:function(){if(!this.deviceBacking)return"";if(!this.vmHardwareRdmVirtualDiskTypeService)return"";var e=this.vmHardwareRdmVirtualDiskTypeService.getProvisioningTypeLabel(this.deviceBacking);return e},enumerable:!0,configurable:!0}),e.$inject=["vmHardwareRdmVirtualDiskTypeService"],e}(),i=function(){function e(){this.bindings={deviceBacking:"<"},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualDiskType/vm-hardware-virtual-disk-type.html"}return e}();e.VmHardwareVirtualDiskType=i,angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualDiskType",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.diskBackingInfoConstants=t,this.diskProvisioningService=i}return e.prototype.isRdmDisk=function(e){return e._type===this.diskBackingInfoConstants.RAWDISKMAPPING},e.prototype.getProvisioningTypeLabel=function(e){return this.isRdmDisk(e)?this.i18nService.getString("VmUi","VmDeviceManager.RDMDisk"):this.diskProvisioningService.getName(e)},e.$inject=["i18nService","diskBackingInfoConstants","diskProvisioningService"],e}();e.VmHardwareRdmVirtualDiskTypeService=t,angular.module("com.vmware.vsphere.client.vm").service("vmHardwareRdmVirtualDiskTypeService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.PmemUtilService,i=e.VmWorkflowMode,r=function(){function e(e,t,i){this.pmemUtilService=e,this.pmemCapacityService=t,this.i18nService=i,this.NVDIMM_REMOVED="nvdimmRemoved",this.MB_UNIT_LOCALIZED=this.i18nService.getString("VmUi","Vm.Units.MB"),this.GB_UNIT_LOCALIZED=this.i18nService.getString("VmUi","Vm.Units.GB")}return e.prototype.getGrowthGranularityInMB=function(e,t,i){var r;return r=!this.isUpdateWorkflow(i)||this.vmIsPoweredOff(e)?t.persistentMemoryColdGrowthGranularityMB:t.persistentMemoryHotGrowthGranularityMB,(isNaN(r)||0===r)&&(r=1),r},e.prototype.isGrowthSupported=function(e,t,i){var r;return!!this.isCloneWorkflow(i)||(r=!this.isUpdateWorkflow(i)||this.vmIsPoweredOff(e)?t.persistentMemoryColdGrowthSupported:t.persistentMemoryHotGrowthSupported)},e.prototype.isRemoveDisabled=function(e,t,i){return!(!this.isUpdateWorkflow(i)||this.vmIsPoweredOff(e))&&!t.persistentMemoryHotRemoveSupported},e.prototype.isControllerRemoveDisabled=function(e,i,r){if(!this.isUpdateWorkflow(r)||this.vmIsPoweredOff(e))return!this.areAllNvdimmsMarkedForRemoval(i);var n=this.pmemUtilService.findOption(e.environment,t.NVDIMM_CONTROLLER),o=n.hotRemoveSupported;return!(o||!this.areAllNvdimmsMarkedForRemoval(i))},e.prototype.getMinimumAllowedCapacity=function(e,i,r){var n=this.pmemUtilService.findOption(e.environment,t.NVDIMM),o=i.supportedMinPersistentMemoryMB,a=Math.max(n.capacityInMB.min,o);return r.isNew()?a:r.getCurrentDevice().capacityInMB},e.prototype.getMaximumAllowedCapacity=function(e,t,i,r){return this.pmemCapacityService.getMaxCapacityForNvdimm(e,t,i,r)},e.prototype.getIsNvmAndRamExceedingGuestOsLimits=function(e,t,i){return this.pmemCapacityService.getIsNvmAndRamExceedingGuestOsLimits(e,t,i)},e.prototype.getDefaultMemoryUnit=function(e){return e&&e.capacityInMB<1024?this.MB_UNIT_LOCALIZED:this.GB_UNIT_LOCALIZED},e.prototype.areAllNvdimmsMarkedForRemoval=function(e){for(var i=0,r=0,n=e.devicesOfType(t.NVDIMM),o=0,a=n;o<a.length;o++){var s=a[o];r++,s.isMarkedForRemoval()&&i++}return i===r},e.prototype.vmIsPoweredOff=function(t){return!(!t||!t.rtInfo)&&t.rtInfo.powerState===e.POWERED_OFF_STATE},e.prototype.isUpdateWorkflow=function(e){return e===i.UpdateMode},e.prototype.isCloneWorkflow=function(e){return e===i.CloneMode},e.POWERED_OFF_STATE="poweredOff",e.$inject=["pmemUtilService","pmemCapacityService","i18nService"],e}();e.VirtualNvdimmService=r,angular.module("com.vmware.vsphere.client.vm").service("virtualNvdimmService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={nvdimmDevice:"<",removeCallback:"&",vmWorkflowMode:"<",vmConfigContext:"<",virtualMachineDevices:"<",selectedGuestOs:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmHardwareSettings/vmHardwareVirtualNvdimm/vm-hardware-virtual-nvdimm.component.html"}return e}();e.VmHardwareVirtualNvdimm=t;var i=function(){function e(e,t,i,r,n,o){this.i18nService=e,this.virtualNvdimmService=t,this.pmemUtilService=i,this.$scope=r,this.$rootScope=n,this.vmHardwareVirtualDiskService=o}return e.prototype.$onInit=function(){var e=this;this.memoryOptions=this.getMemoryOptions(),this.rawNvdimmDevice=this.nvdimmDevice.getCurrentDevice(),this.deviceName=this.rawNvdimmDevice.deviceInfo.label,this.growthGranularityMB=this.virtualNvdimmService.getGrowthGranularityInMB(this.vmConfigContext,this.selectedGuestOs,this.vmWorkflowMode),this.isGrowthEnabled=this.virtualNvdimmService.isGrowthSupported(this.vmConfigContext,this.selectedGuestOs,this.vmWorkflowMode),this.minAllowedCapacity=this.virtualNvdimmService.getMinimumAllowedCapacity(this.vmConfigContext,this.selectedGuestOs,this.nvdimmDevice),this.calculateMaxAllowedCapacity(),this.isRemoveDisabled=this.virtualNvdimmService.isRemoveDisabled(this.vmConfigContext,this.selectedGuestOs,this.vmWorkflowMode),this.defaultMemoryUnit=this.virtualNvdimmService.getDefaultMemoryUnit(this.rawNvdimmDevice),this.capacityErrorMessages=this.getDefaultErrorMessages(this.growthGranularityMB,this.minAllowedCapacity),this.dummyCapacity=this.rawNvdimmDevice.capacityInMB,this.listenerDeregistrationFuction=this.$scope.$on(this.virtualNvdimmService.NVDIMM_REMOVED,function(t){e.calculateMaxAllowedCapacity()}),this.hardDiskListenerDeregistrationFuction=this.$scope.$on(this.vmHardwareVirtualDiskService.DISK_SIZE_UPDATED,function(t){e.calculateMaxAllowedCapacity()})},e.prototype.$onDestroy=function(){this.listenerDeregistrationFuction&&this.listenerDeregistrationFuction(),this.hardDiskListenerDeregistrationFuction&&this.hardDiskListenerDeregistrationFuction()},e.prototype.onCapacityChange=function(e){this.rawNvdimmDevice.capacityInMB=e,this.calculateMaxAllowedCapacity();var t=this.virtualNvdimmService.getIsNvmAndRamExceedingGuestOsLimits(this.vmConfigContext,this.selectedGuestOs,this.virtualMachineDevices);this.capacityErrorMessages={max:t?this.i18n("NVDIMM.exceedsGuest1"):this.i18n("NVDIMM.exceedsPMem"),min:this.i18n("NVDIMM.noShrink",this.minAllowedCapacity.toString()),mod:this.i18n("NVDIMM.growGranularityError",this.growthGranularityMB.toString())}},e.prototype.hasError=function(){return!_.isEmpty(this.$scope.vmHardwareNvdimmForm)&&this.$scope.vmHardwareNvdimmForm.$invalid},e.prototype.removeNvdimm=function(){!this.isRemoveDisabled&&this.removeCallback&&(this.nvdimmDevice.setFileOperation("destroy"),this.removeCallback()(this.nvdimmDevice),this.broadcastNvdimmRemoveded())},e.prototype.revertNvdimmRemoval=function(){this.nvdimmDevice.revertRemoval(),this.nvdimmDevice.setFileOperation(void 0),this.broadcastNvdimmRemoveded()},e.prototype.getAvailablePmemCapacity=function(){return this.pmemUtilService.getAvailablePmemCapacity(this.vmConfigContext)},e.prototype.getSupportedPmemByGuestOs=function(){return this.pmemUtilService.getSupportedPmemByGuestOs(this.selectedGuestOs)},e.prototype.i18n=function(e,t,i){return void 0===t&&(t=""),void 0===i&&(i="VmUi"),this.i18nService.getString(i,e,t)},e.prototype.calculateMaxAllowedCapacity=function(){this.maxAllowedCapacity=this.virtualNvdimmService.getMaximumAllowedCapacity(this.vmConfigContext,this.selectedGuestOs,this.nvdimmDevice,this.virtualMachineDevices)},e.prototype.getDefaultErrorMessages=function(e,t){return{max:this.i18n("NVDIMM.exceedsPMem"),min:this.i18n("NVDIMM.noShrink",t.toString()),mod:this.i18n("NVDIMM.growGranularityError",e.toString())}},e.prototype.getMemoryOptions=function(){return[{label:this.virtualNvdimmService.MB_UNIT_LOCALIZED,multiplier:1},{label:this.virtualNvdimmService.GB_UNIT_LOCALIZED,multiplier:1024}]},e.prototype.broadcastNvdimmRemoveded=function(){this.$rootScope.$broadcast(this.virtualNvdimmService.NVDIMM_REMOVED)},e.$inject=["i18nService","virtualNvdimmService","pmemUtilService","$scope","$rootScope","vmHardwareVirtualDiskService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareVirtualNvdimm",new t)}(h5_vm||(h5_vm={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.BootOptions,i=e.VmWorkflowMode,r=function(){function e(){}return e.BOOT_DELAY_MIN=0,e.BOOT_DELAY_MAX=1e4,e.RETRY_DELAY_MIN=10,e.RETRY_DELAY_MAX=2147483,e.BOOT_DELAY_STEP=100,e.VM_POWERED_OFF="poweredOff",e}();e.BootOptionsConstants=r;var n=function(){function e(e,t,i,r){this.displayName=e,this.realName=t,this.id=i,this.isRecommended=r}return e}();e.FirmwareMenuItem=n;var o=function(e){function i(t){void 0===t&&(t={}),e.call(this),this.BOOT_DELAY_DEFAULT=r.BOOT_DELAY_MIN,this.RETRY_DELAY_DEFAULT=r.RETRY_DELAY_MIN*i.MILLISECONDS,this.RETRY_ENABLED_DEFAULT=!1,this.ENTER_BIOS_DEFAULT=!1,this.bootDelayMin=r.BOOT_DELAY_MIN,this.bootDelayMax=r.BOOT_DELAY_MAX,this.bootDelayStep=r.BOOT_DELAY_STEP,this.retryDelayMin=r.RETRY_DELAY_MIN,this.retryDelayMax=r.RETRY_DELAY_MAX,this.firmwareList=[],this.firmwareWarningFlag=!1,this.firmwareCompatibilityWarningFlag=!1,this.incompatibleFirmware="",this.inCreateMode=!1,this.bootRecoverySettingsEditDisabled=!1,this.bootDelayEditDisabled=!1,this.isEnterBIOSSetupEditDisabled=!1,this.bootRetryEditDisabled=!1,this.bootRetryDelayEditDisabled=!1,this.bootOptionsSupported=!1,this.bootRetryOptionsSupported=!1,this.bootDelay=t.bootDelay||this.BOOT_DELAY_DEFAULT,this.bootRetryDelay=t.bootRetryDelay||this.RETRY_DELAY_DEFAULT,this.bootRetryDelay=this.bootRetryDelay/i.MILLISECONDS,this.bootRetryEnabled=t.bootRetryEnabled||this.RETRY_ENABLED_DEFAULT,this.efiSecureBootEnabled=t.efiSecureBootEnabled||!1,this.enterBIOSSetup=t.enterBIOSSetup||this.ENTER_BIOS_DEFAULT,this.networkBootProtocol=t.networkBootProtocol||null,this.bootOrder=t.bootOrder||null}return __extends(i,e),i.prototype.cloneBootOptionsData=function(){var e=new t;return e._type="com.vmware.vim.binding.vim.vm.BootOptions",e.bootDelay=this.bootDelay,e.bootRetryDelay=this.bootRetryDelay*i.MILLISECONDS,e.bootRetryEnabled=this.bootRetryEnabled,e.bootOrder=this.bootOrder,e.efiSecureBootEnabled=this.efiSecureBootEnabled,e.networkBootProtocol=this.networkBootProtocol,e.enterBIOSSetup=this.enterBIOSSetup,e},i.prototype.selectFirmware=function(e){var t=this.firmwareList;if(t)for(var i=0,r=t;i<r.length;i++){var n=r[i];if(n&&n.id===e)return void(this.firmwareSelection=n)}},i.MILLISECONDS=1e3,i}(t);e.BootOptionsViewModel=o;var a=function(){function t(e,t){var i=this;this.i18nService=e,this.templateHelperService=t,this.STEP_MIDVALUE=r.BOOT_DELAY_STEP/2,this.buildViewModel=function(e,t,n,a){var s;s=e&&e.config&&e.config.bootOptions?new o(e.config.bootOptions):new o;var c="";n&&(s.efiSecureBootEnabled=a["bootOptions.efiSecureBootEnabled"],c=a.firmware),s=i.addFirmwareListToModel(s,e,c),s.firmwareEnabled=e.environment.powerState===r.VM_POWERED_OFF,i.needsPrivilegeCheck(t)&&i.checkSettingsPrivileges(s,e);var l=e.environment.configOption.capabilities;return s.bootOptionsSupported=l.bootOptionsSupported,s.bootRetryOptionsSupported=l.bootRetryOptionsSupported,s},this.processBootOptionsForUpdate=function(e,t){if(!e)return null;e.bootDelay=i.limitBootDelay(e.bootDelay,t)||r.BOOT_DELAY_MIN,e.bootDelay=i.roundOff(e.bootDelay),e.bootRetryDelay=i.limitBootRetryDelay(e.bootRetryDelay,t)||r.RETRY_DELAY_MIN;var n=e;return n},this.roundOff=function(e){var t=e%r.BOOT_DELAY_STEP;return 0===t?e:t<i.STEP_MIDVALUE?e-t:e+r.BOOT_DELAY_STEP-t},this.i18n=e.getString}return t.prototype.isBootRetryDelayEditDisabled=function(e){return null!==e&&(e.bootRetryDelayEditDisabled||!e.bootRetryEnabled)},t.prototype.needsPrivilegeCheck=function(e){return e!==i.CreateMode},t.prototype.checkSettingsPrivileges=function(t,i){var r=e.VmHardwareUtil.userHasVmSettingsPermission(i);r!==!0&&(t.firmwareEnabled=!1,t.bootRecoverySettingsEditDisabled=!0,t.bootDelayEditDisabled=!0,t.isEnterBIOSSetupEditDisabled=!0,t.bootRetryEditDisabled=!0,t.bootRetryDelayEditDisabled=!0)},t.prototype.shouldEnableFirmwareWarning=function(e,t){return!e.inCreateMode&&e.firmwareSelection.id!==t.id},t.prototype.shouldEnableFirmwareCompatibilityWarning=function(e){return!e.inCreateMode&&e.incompatibleFirmware===e.firmwareSelection.id},t.prototype.getFirmwareSignPostParams=function(){var e=this,t="vm-ui/resources/vm/views/settings/vmOptions/bootOptions/boot-options-firmware-help-text.html";return this.templateHelperService.renderTemplateWithScope(t,{i18n:this.i18nService.getString}).then(function(t){return{message:t,title:e.i18nService.getString("Common","help"),"class":"boot-options-help-text"}})},t.prototype.getSecureBootSignPostParams=function(){var e=this,t="vm-ui/resources/vm/views/settings/vmOptions/bootOptions/boot-options-secureBoot-help-text.html";return this.templateHelperService.renderTemplateWithScope(t,{i18n:this.i18nService.getString}).then(function(t){return{message:t,title:e.i18nService.getString("Common","help"),"class":"boot-options-help-text"}})},t.prototype.addFirmwareListToModel=function(e,t,i){if(!t||!t.config||!t.environment||!t.environment.configOption||_.isEmpty(t.environment.configOption.guestOSDescriptor))return e.firmwareList.push(this.buildFirmwareMenuItem("","unknown")),e.firmwareSelection=e.firmwareList[0],e;var r=t.environment.configOption;if(r.guestOSDescriptor.length>1){var n=t.config.guestId;e=this.addFirmwareListForCreateMode(e,n,r.guestOSDescriptor,i)}else e=this.buildFirmwareListOnModel(e,r.guestOSDescriptor[0],t.config.firmware);return e},t.prototype.addFirmwareListForCreateMode=function(e,t,i,r){var n=_.find(i,function(e){return e.id===t});return this.buildFirmwareListOnModel(e,n,"",!0,r)},t.prototype.buildFirmwareListOnModel=function(e,t,i,r,n){var o=this;if(void 0===r&&(r=!1),void 0===n&&(n=""),n=_.isEmpty(n)?_.isEmpty(i)?t.recommendedFirmware:i:n,_.each(t.supportedFirmware,function(i){var a=o.buildFirmwareMenuItem(t.recommendedFirmware,i);e.firmwareList.push(a),e.inCreateMode=r,n===i&&(e.firmwareSelection=a)}),!r&&!_.contains(t.supportedFirmware,i)){var a=this.buildFirmwareMenuItem(t.recommendedFirmware,i);e.firmwareList.push(a),e.inCreateMode=r,e.firmwareSelection=a,e.incompatibleFirmware=i}return e},t.prototype.buildFirmwareMenuItem=function(e,t){var i=!1,r=this.i18n("VmUi","BIOSOptions."+t),o=r;return e!==t||_.isEmpty(e)||(o=r+" "+this.i18n("VmUi","BIOSOptions.recommended"),i=!0),new n(o,r,t,i)},t.prototype.limitBootDelay=function(e,t){return isNaN(e)?t.bootDelay:e>r.BOOT_DELAY_MAX?r.BOOT_DELAY_MAX:e<r.BOOT_DELAY_MIN?r.BOOT_DELAY_MIN:e},t.prototype.limitBootRetryDelay=function(e,t){return isNaN(e)?t.bootRetryDelay/o.MILLISECONDS:e>r.RETRY_DELAY_MAX?r.RETRY_DELAY_MAX:e<r.RETRY_DELAY_MIN?r.RETRY_DELAY_MIN:e},t.$inject=["i18nService","templateHelperService"],t}();e.BootOptionsBuilderService=a,angular.module("com.vmware.vsphere.client.vm").service("vmBootOptionsBuilderService",a)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={vm:"<",vmConfigContext:"<",vmWorkflowMode:"<",onBootoptionsUpdate:"&?",onFirmwareUpdate:"&?",vbsEnabled:"<",vbsProperties:"<",doesTpmExist:"&",expanded:"="},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmOptions/bootOptions/bootOptions.html"}return e}();e.BootOptions=t;var i=function(){function e(e,t){var i=this;this.i18nService=e,this.vmBootOptionsBuilderService=t,this.$onInit=function(){i.viewModel=i.vmBootOptionsBuilderService.buildViewModel(i.vmConfigContext,i.vmWorkflowMode,i.vbsEnabled,i.vbsProperties),i.originalCoreModel=i.viewModel.cloneBootOptionsData(),i.originalFirmwareSelection=angular.copy(i.viewModel.firmwareSelection),i.viewModel.firmwareCompatibilityWarningFlag=i.vmBootOptionsBuilderService.shouldEnableFirmwareCompatibilityWarning(i.viewModel)},this.onPropertyChanged=function(){var e=i.vmBootOptionsBuilderService.processBootOptionsForUpdate(i.viewModel,i.originalCoreModel).cloneBootOptionsData();i.onBootoptionsUpdate&&i.onBootoptionsUpdate({updatedModel:e})},this.getString=function(e,t){var r=i.i18n("VmUi","BIOSOptions."+t);return i.i18n("VmUi",e,r)},this.i18n=e.getString,this.vmBootOptionsBuilderService.getFirmwareSignPostParams().then(function(e){i.signFirmwarePostParams=e}),this.vmBootOptionsBuilderService.getSecureBootSignPostParams().then(function(e){i.signSecureBootPostParams=e})}return e.prototype.isBootRetryDelayEditDisabled=function(){return this.vmBootOptionsBuilderService.isBootRetryDelayEditDisabled(this.viewModel)},e.prototype.onFirmwareSelectionChanged=function(){this.viewModel.firmwareWarningFlag=this.vmBootOptionsBuilderService.shouldEnableFirmwareWarning(this.viewModel,this.originalFirmwareSelection),this.viewModel.firmwareCompatibilityWarningFlag=this.vmBootOptionsBuilderService.shouldEnableFirmwareCompatibilityWarning(this.viewModel),this.isSecureBootAllowed()||(this.viewModel.efiSecureBootEnabled=!1,this.onPropertyChanged());var e=this.viewModel.firmwareSelection.id;this.onFirmwareUpdate&&this.onFirmwareUpdate({newFirmware:e})},e.prototype.isFirmwareDisabled=function(){return!(!this.vm||!this.vm.isFirmwareLocked())||(this.vbsEnabled||!this.viewModel.firmwareEnabled||this.doesTpmExist())},e.prototype.isVbsEnabled=function(){return this.vbsEnabled},e.prototype.isSecureBootAllowed=function(){var e=this.viewModel.firmwareSelection,t=e?e.id:"bios",i=this.vmConfigContext.selectedGuestOs;return"efi"===t&&i&&i.supportsSecureBoot},e.prototype.showFirmwareCompatibilityWarning=function(){return this.viewModel.firmwareCompatibilityWarningFlag},Object.defineProperty(e.prototype,"firmware",{get:function(){var e=this.vmConfigContext.config.firmware;return e},set:function(e){this.vmConfigContext&&(this.vmConfigContext.config.firmware=e),this.vm&&this.vm.afterFirmwareChanged(),this.viewModel&&(this.viewModel.selectFirmware(e),this.onFirmwareSelectionChanged())},enumerable:!0,configurable:!0}),e.$inject=["i18nService","vmBootOptionsBuilderService"],e}();e.BootOptionsController=i,angular.module("com.vmware.vsphere.client.vm").component("bootOptions",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=(function(){function e(){}return e}(),function(){function t(e,t,i,r,n,o){this.$scope=e,this.$q=t,this.i18nService=i,this.storageProfileService=r,this.vmCryptUtilService=n,this.defaultUriSchemeUtil=o,this.ENCRYPTED_VMOTION_MODE_DISABLED="disabled",this.ENCRYPTED_VMOTION_MODE_OPPORTUNISTIC="opportunistic",this.ENCRYPTED_VMOTION_MODE_REQUIRED="required",this.hasVmConfigSettingsPriviledge=!1,this.hasStorageProfileViewPermission=!1,this.hasCryptographerManageKeyServersPermission=!1,this.isKmipStatusChecked=!1,this.hostSupportsEncryption=!1,this.i18n=function(e,t){return void 0===t&&(t="VmUi"),i.getString(t,e)}}return t.prototype.$onInit=function(){var e=this;this.waitSpbmData().then(function(){e.initEncryptionProfiles(),e.initialize()}),this.$scope.$on("vmHomeStorageProfileChanged",function(t,i){e.vmStorageProfile=i,e.initEncryptionProfiles()})},t.prototype.initialize=function(){this.selectedEncryptionProfile=this.vmStorageProfile,this.encryptedVmotionModes=[this.ENCRYPTED_VMOTION_MODE_DISABLED,this.ENCRYPTED_VMOTION_MODE_OPPORTUNISTIC,this.ENCRYPTED_VMOTION_MODE_REQUIRED],this.migrateEncryption=this.ENCRYPTED_VMOTION_MODE_OPPORTUNISTIC,this.vmConfigContext.config&&this.vmConfigContext.config.migrateEncryption&&(this.migrateEncryption=this.vmConfigContext.config.migrateEncryption),(this.isVmHomeEncrypted()||this.doesTpmExist)&&(this.migrateEncryption=this.ENCRYPTED_VMOTION_MODE_REQUIRED),this.onMigrateEncryptionChanged(),this.hasVmConfigSettingsPriviledge=e.VmHardwareUtil.userHasVmSettingsPermission(this.vmConfigContext),this.hasStorageProfileViewPermission=e.VmHardwareUtil.userHasStorageProfileViewPermission(this.vmConfigContext),this.hasCryptographerManageKeyServersPermission=e.VmHardwareUtil.userHasCryptographerManageKeyServersPermission(this.vmConfigContext),this.hostSupportsEncryption=this.vmConfigContext.environment.hostCapability.cryptoSupported,this.canChangeVmHomePolicy=this.workflowMode===e.VmWorkflowMode.UpdateMode,this.expanded&&this.checkKmipStatusIfNeeded()},t.prototype.expandedChanged=function(e){this.checkKmipStatusIfNeeded()},t.prototype.checkKmipStatusIfNeeded=function(){this.isKmipStatusChecked||(this.isKmipStatusChecked=!0,this.checkKmipStatus())},t.prototype.checkKmipStatus=function(){var t=this;if(this.hasCryptographerManageKeyServersPermission){if(this.canEncryptHdds=!1,this.hostSupportsEncryption){var i=this.workflowMode===e.VmWorkflowMode.UpdateMode?this.vmConfigContext.rtInfo.host.serverGuid:this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(this.datacenterId).serverGuid;this.vmCryptUtilService.getDefaultKmipServerStatus(i,!0).then(function(i){if(!t.canNotEncryptReason){if(i&&i.h5DefaultKmipClusterStatus&&i.h5DefaultKmipClusterStatus.noPermission)return void(t.canEncryptHdds=!0);var r=i&&i.h5DefaultKmipClusterStatus&&i.h5DefaultKmipClusterStatus.connectionStatus===e.ConnectionStatus.CONNECTED,n=i&&i.h5DefaultKmipClusterStatus&&i.h5DefaultKmipClusterStatus.certificateStatus===e.CertStatus.EXPIRED,o=t.isVmHomeEncrypted();t.canEncryptHdds=o||r&&!n,o||(r?n&&(t.canNotEncryptReason=t.i18nService.getString("VmUi","VmCryptConfig.reason.kmsCertificateRequiresUpdate")):t.canNotEncryptReason=t.i18nService.getString("VmUi","VmCryptConfig.reason.noKms"))}},function(){t.canEncryptHdds=!0})}}else this.canEncryptHdds=!0},t.prototype.$onChanges=function(e){e.vmStorageProfile,e.doesTpmExist&&(this.doesTpmExist&&(this.migrateEncryption=this.ENCRYPTED_VMOTION_MODE_REQUIRED),this.onMigrateEncryptionChanged()),e.hardDisks&&this.refreshHddEncryptionStatuses()},t.prototype.initEncryptionProfiles=function(){var e=this;if(this.storageProfiles&&this.vmStorageProfile){this.encryptionProfiles=_.filter(this.storageProfiles,function(t){return e.storageProfileService.isEncryptionStorageProfile(t)}),_.isEmpty(this.encryptionProfiles)&&(this.canEncryptHdds=!1,this.canNotEncryptReason=this.i18nService.getString("VmUi","VmCryptConfig.reason.noEncryptionPolicies"));var t=void 0;this.storageProfileService.isEncryptionStorageProfile(this.vmStorageProfile)?(t=this.storageProfileService.getDefaultProfile(),this.selectedEncryptionProfile=this.vmStorageProfile,this.migrateEncryption=this.ENCRYPTED_VMOTION_MODE_REQUIRED,this.onMigrateEncryptionChanged()):(t=angular.copy(this.vmStorageProfile),this.selectedEncryptionProfile=t),t.label=this.i18nService.getString("VmUi","VmCryptConfig.encryptVM.profileNone"),this.encryptionProfiles.splice(0,0,t)}},t.prototype.onStorageProfileChanged=function(e){var t=this,i=this.selectedEncryptionProfile;this.selectedEncryptionProfile=e,this.vmConfigContext.vmProfile=[this.storageProfileService.makeProfile(e.id)],this.isVmHomeEncrypted()?(this.migrateEncryption=this.ENCRYPTED_VMOTION_MODE_REQUIRED,this.onMigrateEncryptionChanged(),_.each(this.hardDisks,function(e){var r=e.isDiskEncrypted(),n=!e.isStorageProfileManuallySet()&&e.getProfile()&&e.getProfile().profileId===i.id;r&&!n||e.updateDiskProfile(t.selectedEncryptionProfile)}),this.onAlert({options:{isVisible:!1}})):(this.vmConfigContext.config.keyId=null,_.each(this.hardDisks,function(e){!e.isCreatedFromExistingDisk()&&e.isDiskEncrypted()&&e.updateDiskProfile(t.storageProfileService.getDefaultProfile())}),this.onAlert({options:{isVisible:!0,"class":"alert-warning",iconShape:"exclamation-triangle",text:this.i18nService.getString("VmUi","VmCryptConfig.alert.vmHomeNotEncypted")}})),this.refreshHddEncryptionStatuses()},t.prototype.toggleEncryptHardDisk=function(e){if(!e.isCreatedFromExistingDisk()){var t=this.storageProfileService.getDefaultProfile().label;e.isDiskEncrypted()?(e.updateDiskProfile(this.storageProfileService.getDefaultProfile()),e.getCurrentDevice().backing.keyId=null):e.updateDiskProfile(this.selectedEncryptionProfile),this.refreshHddEncryptionStatuses(),this.hasUnencryptedDisks()?this.onAlert({options:{isVisible:!0,"class":"alert-warning",iconShape:"exclamation-triangle",text:this.i18nService.getString("VmUi","VmCryptConfig.alert.someDisksAreNotEncypted",t)}}):this.onAlert({options:{isVisible:!0,"class":"alert-success",iconShape:"check-circle",text:this.i18n("VmCryptConfig.alert.allDisksAreEncypted")}})}},t.prototype.onMigrateEncryptionChanged=function(){return this.isVmHomeEncrypted()||this.doesTpmExist?void delete this.vmConfigContext.config.migrateEncryption:void(this.migrateEncryption&&(this.vmConfigContext.config.migrateEncryption=this.migrateEncryption))},t.prototype.isVmotionReadOnly=function(){return!!this.doesTpmExist||(this.workflowMode===e.VmWorkflowMode.UpdateMode&&!this.hasVmConfigSettingsPriviledge||this.isVmHomeEncrypted())},t.prototype.isVmHomeEncrypted=function(){return this.storageProfileService.isEncryptionStorageProfile(this.selectedEncryptionProfile)},t.prototype.isVmPoweredOn=function(){return this.vmConfigContext.rtInfo&&"poweredOn"===this.vmConfigContext.rtInfo.powerState},t.prototype.displayEncryptVmBlock=function(){return this.hostSupportsEncryption&&this.hasStorageProfileViewPermission&&this.workflowMode!==e.VmWorkflowMode.CloneMode},t.prototype.displayEncryptVmDisksBlock=function(){return this.displayEncryptVmBlock()&&this.isVmHomeEncrypted()&&!_.isEmpty(this.hardDisks)},t.prototype.buildSignPostContentVmotion=function(){var e=this,t=[{title:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.vtpm.Text"),tip:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.vtpm.Tip")},{title:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.disabled.Text"),tip:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.disabled.Tip")},{title:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.opportunistic.Text"),tip:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.opportunistic.Tip")},{title:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.required.Text"),tip:this.i18nService.getString("VmUi","VmCryptConfig.vMotion.required.Tip")}],i=[];return _.each(t,function(t,r){(0!==r||e.doesTpmExist)&&i.push('<li>\n                  <div class="title">'+t.title+'</div>\n                  <div class="tip">'+t.tip+"</div>\n               </li>")}),"<ul>"+i.join(" ")+"</ul>"},t.prototype.refreshHddEncryptionStatuses=function(){this.hardDiskEncryptionStatuses=_.map(this.hardDisks,function(e){return e.diskEncryptionStatus=void 0,e.isDiskEncrypted()})},t.prototype.hasUnencryptedDisks=function(){
return _.contains(this.hardDiskEncryptionStatuses,!1)},t.prototype.waitSpbmData=function(){var t=this,i=this.$q.when();if(this.workflowMode!==e.VmWorkflowMode.UpdateMode)return i;var r={assignments:this.vmStorageProfileAssignments,profiles:this.storageProfiles};return this.$q.all(r).then(function(e){var r=e;return t.applySpbmData(r),i})},t.prototype.applySpbmData=function(e){this.vmStorageProfileAssignments=e.assignments.vmStorageProfileAssignments,this.storageProfiles=e.profiles,this.initVmHomeProfile()},t.prototype.initVmHomeProfile=function(){if(!this.vmStorageProfileAssignments)return void(this.vmStorageProfile=null);this.vmStorageProfile=this.storageProfileService.getDefaultProfile();var e=this.vmStorageProfileAssignments.homeStorageProfile;if(e&&e.profileId){var t=e.profileId.uniqueId,i=_.find(this.storageProfiles,function(e){return e.id===t});i&&(this.vmStorageProfile=i)}},t.$inject=["$scope","$q","i18nService","storageProfileService","vmCryptUtilService","defaultUriSchemeUtil"],t}()),i=function(){function e(){this.bindings={workflowMode:"<",vmStorageProfileAssignments:"<",storageProfiles:"<",vmStorageProfile:"<",hardDisks:"<",vmConfigContext:"<",datacenterId:"<",onAlert:"&",doesTpmExist:"<",expanded:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmOptions/encryption/encryption-options.html"}return e}();angular.module("com.vmware.vsphere.client.vm").component("encryptionOptions",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=(function(){function e(){}return e}(),function(){function e(e,t){this.i18nService=e,this.service=t,this.ARIA_LBL_NAME=this.i18n2("vm_name_body"),this.ARIA_LBL_GOS_FML=this.i18n2("gos_family"),this.ARIA_LBL_GOS_VER=this.i18n2("gos_version"),this.guestOsListRequested=!1,this.i18n=function(t,i){return void 0===i&&(i="VmUi"),e.getString(i,t)}}return e.prototype.i18n2=function(e,t){return void 0===t&&(t="GeneralOptions"),this.i18nService.getString("VmUi",t+"."+e)},e.prototype.$onInit=function(){this.modalOptions?this.setupForEditMode():this.setupForCloneAndCreate()},e.prototype.setupForEditMode=function(){this.editMode=!0,this.vmName=this.config.name,this.vmConfigFile=this.config.files.vmPathName,this.vmWorkingLocation=this.config.files.snapshotDirectory},e.prototype.expandedChanged=function(e){this.editMode&&this.requestGuestOsListIfNeeded()},e.prototype.requestGuestOsListIfNeeded=function(){this.editMode&&(this.guestOsListRequested||(this.guestOsListRequested=!0,this.service.getAllGosVersionsPromise(this.vmId).then(this.onGuestOsList.bind(this))))},e.prototype.onGuestOsList=function(e){this.guestOsList=e?e.guestOsList:[],this.initGuestOptions()},e.prototype.initGuestOptions=function(){var e=this.config.guestId,t=this.service.findDescriptor(e,this.guestOsList),i=t?t.family:"otherGuestFamily";i=this.service.simplifyFamily(i),this.gosFamily=this.service.familyObject(i),this.gosFamilyOptions=this.service.getGosFamilyOptions();var r=this.config.guestFullName;this.gosVersion={id:e,name:r};var n=this.service.getFamilyVersions(i,this.guestOsList);this.gosVersionOptions=this.service.getVersionsOptions(n)},e.prototype.setupForCloneAndCreate=function(){this.vmName=this.vmParams.getName(),this.gosFamily={name:this.vmParams.getGosFamily().name,id:""},this.gosFamilyOptions=[this.gosFamily],this.gosVersion={name:this.vmParams.getGosVersion().name,id:""},this.gosVersionOptions=[this.gosVersion],this.editMode=!1},e.prototype.isEditNameDisabled=function(){return this.service.isEditNameDisabled(this.vmConfigContext.privileges,this.editMode)},e.prototype.isEditGOSDisabled=function(){return!this.editMode||this.service.isEditGOSDisabled(this.vmConfigContext)},e.prototype.familyChanged=function(){this.editMode&&this.guestOsList&&this.changeFamily(this.gosFamily.id)},e.prototype.changeFamily=function(e){if(this.editMode&&this.guestOsList){var t=this.service.getFamilyVersions(e,this.guestOsList);if(t&&0!==t.length){var i=t[0];this.gosVersion={name:i.fullName,id:i.id},this.gosVersionOptions=this.service.getVersionsOptions(t),this.updateConfigInfo(i)}}},e.prototype.versionChanged=function(){if(this.editMode&&this.guestOsList&&this.gosVersion){var e=this.gosVersion.id,t=this.service.findDescriptor(e,this.guestOsList);t&&this.updateConfigInfo(t)}},e.prototype.updateConfigInfo=function(e){this.editMode&&(this.config.guestFullName=e.fullName,this.config.guestId=e.id)},e.$inject=["i18nService","vmGeneralOptionsService"],e}()),i=function(){function e(){this.bindings={config:"<?",vmId:"<",vmParams:"<?",vmConfigContext:"<",modalOptions:"<?",expanded:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmOptions/generalOptions/general-options.html"}return e}();angular.module("com.vmware.vsphere.client.vm").component("generalOptions",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=e.VmHardwareUtil,r=(function(){function e(){}return e}(),function(){function e(e,t,i,r){this.i18nService=e,this.vmHardwareUtil=t,this.gosFamilyConstants=i,this.dataService=r,this.i18n=e.getString}return e.prototype.hasPrivilegesToRename=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_CONFIG_RENAME])},e.prototype.hasPrivilegesToEditGos=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_CONFIG_SETTINGS])},e.prototype.familyObject=function(e){return{id:e,name:this.i18n("VmUi","GeneralOptions.gos_family."+e)}},e.prototype.isEditNameDisabled=function(e,t){return!!t&&!this.hasPrivilegesToRename(e)},e.prototype.isEditGOSDisabled=function(e){return!i.isPoweredOff(e)||!this.hasPrivilegesToEditGos(e.privileges)},e.prototype.getGosFamilyOptions=function(){return[this.familyObject(this.gosFamilyConstants.WINDOWS),this.familyObject(this.gosFamilyConstants.LINUX),this.familyObject(this.gosFamilyConstants.OTHER)]},e.prototype.getFamilyVersions=function(e,t){if(!t)return[];for(var i=[],r=0,n=t;r<n.length;r++){var o=n[r],a=this.simplifyFamily(o.family);e=this.simplifyFamily(e),a===e&&i.push(o)}return i},e.prototype.simplifyFamily=function(e){return"windowsGuest"!==e&&"linuxGuest"!==e&&(e="otherGuestFamily"),e},e.prototype.getVersionsOptions=function(e){for(var t=[],i=0,r=e;i<r.length;i++){var n=r[i],o={name:n.fullName,id:n.id};t.push(o)}return t},e.prototype.findDescriptor=function(e,t){if(!t||!e)return null;for(var i=0,r=t;i<r.length;i++){var n=r[i];if(e===n.id)return n}return null},e.prototype.getAllGosVersionsPromise=function(e){return this.dataService.getProperties(e,["guestOsList"])},e.$inject=["i18nService","vmHardwareUtil","gosFamilyConstants","dataService"],e}());e.VmGeneralOptionsService=r,angular.module("com.vmware.vsphere.client.vm").service("vmGeneralOptionsService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e){this.vcH5ConstantsService=e,this.version=-1,this.watchObjects=[],this.liveProperties=["config.vAppConfig","disabledMethod","runtime.powerState"],this.refreshEventTypes=[],this.refreshEventTypes.push(e.DATA_REFRESH_INVOCATION_EVENT),this.refreshEventTypes.push(e.OBJECT_DETAILS_CHANGED_EVENT),this.refreshEventTypes.push(e.MODEL_CHANGED_EVENT)}return e.prototype.$onInit=function(){this.watchObjects=[this.vmId]},e.prototype.onRefresh=function(){this.version++},e.$inject=["vcH5ConstantsService"],e}();angular.module("com.vmware.vsphere.client.vm").component("legacyVappOptionsView",{bindings:{vmId:"<"},controller:t,template:'\n          <div vx-refreshable \n            watch-objects="{{$ctrl.watchObjects}}"\n            refresh="$ctrl.onRefresh()"\n            live-refresh-properties="$ctrl.liveProperties"\n            refresh-event-types="{{$ctrl.refreshEventTypes}}"> \n             <vm-edit-vapp-options-component [vm-id]="$ctrl.vmId" [version]="$ctrl.version">\n            </vm-edit-vapp-options-component>\n         </div>'})}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function t(e,t,i){var r=this;this.i18nService=e,this.vmStandbyOptionsService=t,this.vmDeviceInfoService=i,this.onStandbyOptionsChange=function(){r.onChange({standbyAction:r.standbyValue}),r.setWakeOnLanValues({})},this.onWakeOnLanChange=function(e){"powerOnSuspend"!==r.standbyValue&&(e.wakeOnLanEnabled=!e.wakeOnLanEnabled)},this.isWakeOnLanVisible=function(){var e=!1,t=!1;return _.isEmpty(r.vmConfigContext)||(e=r.vmConfigContext.selectedGuestOs&&r.vmConfigContext.selectedGuestOs.supportsWakeOnLan,t=r.vmConfigContext.environment&&r.vmConfigContext.environment.configOption&&r.vmConfigContext.environment.configOption.capabilities&&r.vmConfigContext.environment.configOption.capabilities.s1AcpiManagementSupported),e&&t},this.i18n=function(t,i){void 0===i&&(i="VmUi");for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return e.getString.apply(e,[i,t].concat(r))},this.vmStandbyOptionsService=t,this.vmDeviceInfoService=i}return t.prototype.$onInit=function(){this.standbyValue=this.options?this.options.standbyAction||"checkpoint":"checkpoint",this.standbyOptions=[{id:"suspend",label:this.i18n("VmStandbyPage.Suspend"),value:"powerOnSuspend"},{id:"leaveOn",label:this.i18n("VmStandbyPage.LeaveOn"),value:"checkpoint"}],this.setExpandedDevices(),this.setOriginalWakeOnLanValues(),this.vmWorkflowMode===e.VmWorkflowMode.CreateMode?this.setWakeOnLanValues({forceTrue:!0}):this.setWakeOnLanValues({})},t.prototype.getErrorString=function(e){var t=this.vmConfigContext.selectedGuestOs?this.vmConfigContext.selectedGuestOs.fullName:"",i=this.vmDeviceInfoService.getEthernetCardLabel(e._type);return this.i18n("VmStandbyPage.WakeUnsupported","VmUi",t,i)},t.prototype.setExpandedDevices=function(){this.expandedDevices={};for(var e=0;e<this.networkDevices.length;e++){var t=this.networkDevices[e],i=t.getCurrentDevice();this.expandedDevices[i.key]=i}},t.prototype.setOriginalWakeOnLanValues=function(){var t=this;this.originalWakeOnLanValues={},angular.forEach(this.expandedDevices,function(i){t.originalWakeOnLanValues[i.key]=t.vmWorkflowMode===e.VmWorkflowMode.CreateMode||i.wakeOnLanEnabled})},t.prototype.setWakeOnLanValues=function(e){var t=this;this.wakeOnLanValues={},angular.forEach(this.expandedDevices,function(i){e.forceTrue?t.wakeOnLanValues[i.key]=!0:t.wakeOnLanValues[i.key]="powerOnSuspend"!==t.standbyValue&&i.wakeOnLanEnabled})},t.prototype.getDeviceLabel=function(e){var t="",i=e.backing;if(i&&"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$NetworkBackingInfo"===i._type){var r=i.deviceName;t=r?" ("+r+")":""}else if(i&&"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$DistributedVirtualPortBackingInfo"===i._type){var n=this.findPortgroupInfo(i);t=n?" ("+n.portgroupName+")":""}else if(i&&"com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$OpaqueNetworkBackingInfo"===i._type){var o=this.findOpaqueInfo(i);t=o?" ("+o.name+")":""}return e.deviceInfo.label+t},t.prototype.findPortgroupInfo=function(e){return this.vmStandbyOptionsService.findPortgroupInfo(e,this.vmConfigContext)},t.prototype.findOpaqueInfo=function(e){return this.vmStandbyOptionsService.findOpaqueInfo(e,this.vmConfigContext)},t.prototype.isTypeSupported=function(e){return this.vmStandbyOptionsService.isTypeSupported(e,this.vmConfigContext)},t.prototype.isEditSettingsDisabled=function(){return this.vmStandbyOptionsService.isEditSettingsDisabled(this.vmConfigContext.privileges,this.vmWorkflowMode)},t.prototype.isEditWakeOnLanDisabled=function(e){return this.vmStandbyOptionsService.isEditWakeOnLanDisabled(e,{vmConfigContext:this.vmConfigContext,originalWakeOnLanValues:this.originalWakeOnLanValues,standbyValue:this.standbyValue,vmWorkflowMode:this.vmWorkflowMode})},t.$inject=["i18nService","vmStandbyOptionsService","vmDeviceInfoService"],t}(),i=function(){function e(){this.bindings={vmWorkflowMode:"<",onChange:"&",networkDevices:"<",vmConfigContext:"<",options:"<",expanded:"="},this.controller=t,this.templateUrl="vm-ui/resources/vm/views/settings/vmOptions/standbyOptions/standby-options.html"}return e}();angular.module("com.vmware.vsphere.client.vm").component("standbyOptions",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=e.VmWorkflowMode,r=function(){function e(e){this.vmHardwareUtil=e}return e.prototype.hasPrivilegesToEditSettings=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_CONFIG_SETTINGS])},e.prototype.isEditSettingsDisabled=function(e,t){return t===i.UpdateMode?!this.hasPrivilegesToEditSettings(e):t===i.CloneMode&&!this.hasPrivilegesToEditSettings(e)},e.prototype.hasPrivilegesToEditDevices=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_EDITDEVICE_PRIVILEGE])},e.prototype.isEditDevicesDisabled=function(e,t){return t!==i.CreateMode&&!this.hasPrivilegesToEditDevices(e)},e.prototype.isEditWakeOnLanDisabled=function(e,t){return!(!e||this.isTypeSupported(e,t.vmConfigContext)||t.originalWakeOnLanValues[e.key])||("powerOnSuspend"===t.standbyValue||this.isEditDevicesDisabled(t.vmConfigContext.privileges,t.vmWorkflowMode))},e.prototype.isTypeSupported=function(e,t){var i=t.selectedGuestOs;if(!i)return!0;var r=i.wakeOnLanEthernetCard;if(!r||!r.length)return!1;for(var n=e._type,o=0;o<r.length;o++){var a=r[o].typeClass;if(a===n)return!0}return!1},e.prototype.findPortgroupInfo=function(e,t){for(var i={},r=e.port.switchUuid,n=e.port.portgroupKey,o=t.environment.configTarget.distributedVirtualPortgroup,a=0;a<o.length;a++){var s=o[a];r===s.switchUuid&&n===s.portgroupKey&&(i=s)}return i},e.prototype.findOpaqueInfo=function(e,t){for(var i={},r=e.opaqueNetworkId,n=e.opaqueNetworkType,o=t.environment.configTarget.opaqueNetwork,a=0;a<o.length;a++){var s=o[a];r===s.network.opaqueNetworkId&&n===s.network.opaqueNetworkType&&(i=s)}return i},e.$inject=["vmHardwareUtil"],e}();e.VmStandbyOptionsService=r,angular.module("com.vmware.vsphere.client.vm").service("vmStandbyOptionsService",r)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.bindings={configFlags:"<",guestOsDescriptor:"<",onVbsUpdate:"&",visible:"<",vmPoweredOn:"<"},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmOptions/vbs/vbs.html"}return e}();e.VBS=t;var i=function(){function e(e,t){var i=this;this.i18nService=e,this.featureFlagsService=t,this.onPropertyChanged=function(){i.onVbsUpdate({vbsEnabled:i.configFlags.vbsEnabled}),i.configFlags.vbsEnabled?(i.vbsWillTurnOn=!0,i.vbsWillTurnOff=!1):(i.vbsWillTurnOn=!1,i.vbsWillTurnOff=!0)},this.$onInit=function(){i.featureFlagsService.hardwareV14_vbsEnabled&&i.featureFlagsService.hardwareV14_vbsEnabled()&&i.guestOsDescriptor.vbsSupported&&i.guestOsDescriptor.vbsSupported.supported||(i.visible=!1)},this.isDisabled=function(){return i.vmPoweredOn},this.i18n=e.getString}return e.$inject=["i18nService","featureFlagsService"],e}();e.VbsController=i,angular.module("com.vmware.vsphere.client.vm").component("vbs",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=e.Privileges,i=e.VmWorkflowMode,r=e.VmHardwareUtil,n=function(){function n(e,t){this.i18nService=e,this.vmHardwareUtil=t,this.isEditingLsLevelVisible=function(e){var t=e.environment.hostCapability;return!!t&&!!t.latencySensitivitySupported},this.i18n=e.getString}return n.prototype.hasPrivilegesToEditSwapFileLocation=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_CONFIG_SWAPFILEPLACEMENT])},n.prototype.hasCapabilitiesToEditSwapFileLocation=function(e){return e.swapPlacementSupported},n.prototype.isEditSwapFileLocationDisabled=function(e,t){return!this.hasPrivilegesToEditSwapFileLocation(e)||!this.hasCapabilitiesToEditSwapFileLocation(t)},n.prototype.hasPrivilegesToDisableAcceleration=function(e){return this.vmHardwareUtil.checkPrivileges(e,[t.VM_CONFIG_SETTINGS])},n.prototype.isDisableAccelerationDisabled=function(e,t){return t!==i.CreateMode&&!this.hasPrivilegesToDisableAcceleration(e)},n.prototype.isEnableLoggingDisabled=function(e,r){return r!==i.CreateMode&&!this.vmHardwareUtil.checkPrivileges(e,[t.VM_CONFIG_SETTINGS])},n.prototype.isEditMonitorTypeDisabled=function(t,n){var o=t;if(i.CreateMode===n)return!1;if(e.VmHardwareUtil.noVmSettingsPermission(o))return!0;if(i.CloneMode===n)return!1;var a=r.getVmCapabilities(o),s=a.poweredOnMonitorTypeChangeSupported,c=r.isPoweredOff(o);return!c&&s!==!0||(!!this.vmHardwareUtil.isFtVmConfigContext(o)||!!r.hasRecordReplay(o))},n.prototype.getMonitorTypeList=function(e){var t=e&&e.environment&&e.environment.configOption&&e.environment.configOption.supportedMonitorType;return t&&0!==t.length?t:["release","debug"]},n.prototype.getLsLevelList=function(e){return["normal","high"]},n.prototype.isEditingLsLevelDisabled=function(t,r){var n=t;return!this.isEditingLsLevelVisible(n)||i.CreateMode!==r&&(!(!e.VmHardwareUtil.noVmSettingsPermission(n)&&!e.VmHardwareUtil.noVmResourcePermission(n))||(i.CloneMode===r,!1))},n.$inject=["i18nService","vmHardwareUtil"],n}();e.VmAdvancedOptionsService=n,angular.module("com.vmware.vsphere.client.vm").service("vmAdvancedOptionsService",n)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r){var n=this,o=function(t){return e.getString("VmUi","AdvancedOptions."+t)};n.LBL_TITLE=o("title"),n.LBL_EXPAND=o("expand"),n.LBL_SETTINGS=o("settings"),n.LBL_ACCEL=o("settings.acceleration"),n.LBL_LOGGING=o("settings.logging"),n.LBL_MONITOR=o("monitor"),n.LBL_SWAP=o("swapfile"),n.LBL_SWAP_DEF=o("swapfile.default"),n.LBL_SWAP_VM=o("swapfile.vm"),n.LBL_SWAP_HOST=o("swapfile.host"),n.LBL_PARAMS=o("config_params"),n.LBL_EDIT_PARAMS=o("config_params.label"),n.LBL_LATENCY=o("latency_sensitivity.label"),n.service=t,n.vmHardwareUtil=r,n.$onInit=function(){n.monitorTypeList=n.service.getMonitorTypeList(n.vmConfigContext);const e=n.vmConfigContext.privileges.indexOf(h5_vm.Privileges.VM_RESOURCE_PRIVILEGE)>-1;!e&&n.vmWorkflowMode!==h5_vm.VmWorkflowMode.CreateMode||n.vmConfigContext.config.latencySensitivity||(n.vmConfigContext.config.latencySensitivity={_type:"com.vmware.vim.binding.vim.LatencySensitivity",level:"normal",sensitivity:null}),n.lsense=n.vmConfigContext.config.latencySensitivity,n.lsense||(n.lsense={level:"normal"}),n.swapPlacementTypeOptions=[{id:"inherit",label:n.LBL_SWAP_DEF.split("\n")[0],description:n.LBL_SWAP_DEF.split("\n")[1]},{id:"vmDirectory",label:n.LBL_SWAP_VM.split("\n")[0],description:n.LBL_SWAP_VM.split("\n")[1]},{id:"hostLocal",label:n.LBL_SWAP_HOST.split("\n")[0],description:n.LBL_SWAP_HOST.split("\n")[1]}],void 0===n.advancedOptions.enableLogging&&(n.advancedOptions.enableLogging=!0),void 0!==n.swapPlacementType||this.isEditSwapFileLocationDisabled()||(n.swapPlacementType=n.swapPlacementTypeOptions[0].id)},this.openAdvancedEditConfigurationModal=function(){i.openModal(n.vmConfigContext,this.vmConfigContext.environment.powerState,n.vmHardwareUtil.checkPrivileges(n.vmConfigContext.privileges,["VirtualMachine.Config.AdvancedConfig"]))},this.isEditSwapFileLocationDisabled=function(){return t.isEditSwapFileLocationDisabled(n.vmConfigContext.privileges,n.vmConfigContext.environment.configOption.capabilities)},this.getMonitorTypeLabel=function(e){return o("monitor."+e)},this.isEditMonitorTypeDisabled=function(){return n.service.isEditMonitorTypeDisabled(n.vmConfigContext,n.vmWorkflowMode)},this.isDisableAccelerationDisabled=function(){return t.isDisableAccelerationDisabled(n.vmConfigContext.privileges,n.vmWorkflowMode)},this.isEnableLoggingDisabled=function(){return t.isEnableLoggingDisabled(n.vmConfigContext.privileges,n.vmWorkflowMode)},this.getSetLsLevel=function(e){return angular.isDefined(e)?n.lsense.level=e:n.lsense.level},this.getLsLevelList=function(){return n.service.getLsLevelList(n.vmConfigContext)},this.getLsLevelLabel=function(t){var i="VmOptionsView.Advanced.LatencySensitivityLevel."+t;return e.getString("VmUi",i)},this.isEditingLsLevelDisabled=function(){return n.service.isEditingLsLevelDisabled(n.vmConfigContext,n.vmWorkflowMode)},this.isEditingLsLevelVisible=function(){return n.service.isEditingLsLevelVisible(n.vmConfigContext)}}angular.module("com.vmware.vsphere.client.vm").component("vmAdvancedOptions",{templateUrl:"vm-ui/resources/vm/views/settings/vmOptions/vmAdvancedOptions/vmAdvancedOptions.html",controller:e,controllerAs:"ctrl",bindings:{advancedOptions:"=",swapPlacementType:"=",vmConfigContext:"<",vmWorkflowMode:"<",expanded:"="}}),e.$inject=["i18nService","vmAdvancedOptionsService","vscAdvancedEditConfigurationModalService","vmHardwareUtil"]}(),angular.module("com.vmware.vsphere.client.vm").directive("vmOptions",[function(){return{templateUrl:"vm-ui/resources/vm/views/settings/vmOptions/vmOptions.html",controller:"VmOptionsController",controllerAs:"vmOptionsController"}}]),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e){e.bootOptions={_type:"com.vmware.vim.binding.vim.vm.BootOptions",efiSecureBootEnabled:u.vbsProperties["bootOptions.efiSecureBootEnabled"]},e.firmware=u.vbsProperties.firmware}function c(e){e.flags.vvtdEnabled=u.vbsProperties["flags.vvtdEnabled"],e.nestedHVEnabled=u.vbsProperties.nestedHVEnabled}function l(e){return e.modalOptions?h5_vm.VmWorkflowMode.UpdateMode:e.vmParams.getCreationType()===a.CLONE_VM_TO_VM||e.vmParams.getCreationType()===a.CLONE_TEMPLATE_TO_VM?h5_vm.VmWorkflowMode.CloneMode:h5_vm.VmWorkflowMode.CreateMode}function d(){u.vbsProperties=u.getVbsProperties(),e.vmParams&&e.vmParams.getVbsEnabled?u.vbsEnabled=e.vmParams.getVbsEnabled():u.vbsEnabled=e.hardwareConfigData.vmConfigContext.config.flags.vbsEnabled,u.vbsEnabled&&s(e.hardwareConfigData.vmConfigContext.config)}this.networkAdapterDevices=e.hardwareConfigData.virtualMachineDevices.findDevicesOfType("VirtualEthernetCard"),this.stackBlocksExpandedState=e.customizeHardwarePageModel?e.customizeHardwarePageModel.getStackBlocksExpandedState():{};var u=this;u.hardDisks=e.hardwareConfigData.virtualMachineDevices.devicesOfType("VirtualDisk"),u.storageProfiles=e.hardwareConfigData.storageProfiles,u.vmStorageProfileAssignments=e.hardwareConfigData.vmStorageProfileAssignments,e.modalOptions?u.vmStorageProfile=null:u.vmStorageProfile=e.hardwareConfigData.selectedStorageProfile,this.workflow=l(e),e.$on(r.DISKS_UPDATED,function(t){u.hardDisks=e.hardwareConfigData.virtualMachineDevices.devicesOfType("VirtualDisk")}),e.$on("vmHomeStorageProfileChanged",function(e,t){u.vmStorageProfile=t}),this.onVmwareToolsChange=function(t){e.hardwareConfigData.vmConfigContext.config.tools=t},this.isVmPoweredOn=function(){return i.isVmPoweredOn(e.hardwareConfigData.vmConfigContext.environment.powerState)},this.hasVmConfigSettingsPrivilege=function(){return i.checkPrivileges(e.hardwareConfigData.vmConfigContext.privileges,["VirtualMachine.Config.Settings"])},u.onBootOptionsChanged=function(t){e.hardwareConfigData.vmConfigContext.config.bootOptions=t},u.onVbsUpdate=function(t){var i=e.hardwareConfigData.vmConfigContext.config;i.flags.vbsEnabled=t,u.vbsEnabled=t,t&&(s(i),c(i))},u.onAlert=function(t){e.$emit("editSettingsAlertMessageChanged",t)},u.onFirmwareSelectionChanged=function(t){e.hardwareConfigData.vmConfigContext.config.firmware=t,"bios"===t.toLowerCase()?e.ctrl.updateActionDefsForAddDeviceMenu(["addNewTpmAction"]):e.ctrl.updateActionDefsForAddDeviceMenu()},u.onStandbyOptionsChange=function(t){e.hardwareConfigData.vmConfigContext.config.defaultPowerOps.standbyAction=t},u.vbsVisible=function(){return!!e.modalOptions},u.getVbsProperties=function(){var t=_.reduce(e.hardwareConfigData.vmConfigContext.environment.configOption.propertyRelations,function(e,t){return e[t.key.name]=t.relations,e},{});return _.reduce(t["flags.vbsEnabled"],function(e,t){return e[t.name]=t.val,e},{})},u.doesTPMExist=function(){return!(!e.ctrl||!e.ctrl.virtualMachineDevices)&&e.ctrl.virtualMachineDevices.devicesOfType("VirtualTPM").length>0},d()}angular.module("com.vmware.vsphere.client.vm").controller("VmOptionsController",e),e.$inject=["$scope","$q","vmHardwareUtil","vmHardwareVirtualDiskService","defaultUriSchemeUtil","storageProfileService","creationTypeConstants"]}();var h5_vm;!function(e){var t=e.VmWorkflowMode,i=function(){function e(e,i,r){var n=this;this.i18nService=e,this.creationTypeConstants=i,this.vmHardwareUtil=r,this.ARIA_LBL_UPGRADE=this.i18n2("upgrade.policy"),this.ARIA_LBL_TIME_SYNC=this.i18n2("time.synch"),this.ARIA_LBL_AFTER_POWER_ON=this.i18n2("scripts.after_power_on"),this.ARIA_LBL_AFTER_RESUME=this.i18n2("scripts.after_resuming"),this.ARIA_LBL_BEFORE_SUSPEND=this.i18n2("scripts.before_suspending"),this.ARIA_LBL_BEFORE_SHUTDOWN=this.i18n2("scripts.before_shutting_guest"),this.toolsUpgradePolicyEnabled=function(){return n.vmWorkflowMode===t.CreateMode||!!n.vmHasConfigSettingsPrivilege},this.syncTimeWithHostDisabled=function(){return!n.vmToolsCapabilities.toolsSyncTimeSupported||n.vmWorkflowMode!==t.CreateMode&&!n.vmHasConfigSettingsPrivilege},this.onVmwareToolsChange=function(){n.vmToolsOptions._type="com.vmware.vim.binding.vim.vm.ToolsConfigInfo",n.onChange({vmToolsOptions:n.vmToolsOptions,vmDefaultPowerOperations:n.vmDefaultPowerOperations})},this.i18n=function(t,i){return void 0===i&&(i="VmUi"),e.getString(i,t)}}return e.prototype.i18n2=function(e,t){return void 0===t&&(t="VMwareTools"),this.i18nService.getString("VmUi",t+"."+e)},e.prototype.$onInit=function(){this.canChangeScriptOptions=this.vmWorkflowMode===t.CreateMode||this.vmHasConfigSettingsPrivilege&&!this.vmHardwareUtil.isVmPoweredOn(this.vmPowerState)},e.$inject=["i18nService","creationTypeConstants","vmHardwareUtil"],e}(),r=function(){function e(){this.bindings={vmWorkflowMode:"<",vmDefaultPowerOperations:"<",vmToolsOptions:"<",vmToolsCapabilities:"<",vmPowerState:"<",vmHasConfigSettingsPrivilege:"<",onChange:"&",expanded:"="},this.controller=i,this.templateUrl="vm-ui/resources/vm/views/settings/vmOptions/vmwareTools/vmware-tools.html"}return e}();angular.module("com.vmware.vsphere.client.vm").component("vmwareTools",new r)}(h5_vm||(h5_vm={})),function(){function e(e,t,i,r,n,o,a){function s(e){var t={title:e.title,message:e.message||"",submit:e.submit};return t}function c(e,i){i.objectId===y.vmId&&("CHANGE"===i.operationType?y.updateSnapshotTreeDebounced():"DELETE"===i.operationType&&t.closeModal())}function l(){e.getSnapshotsForVM(y.vmId).then(function(e){var t=i.formatData(e);y.treeViewOptions=t,y.hasSnapshots=d(t),y.setAsSelected(i.getCurrentSnapshot()),t.onClick=function(e){y.setAsSelected(e)},g(),h()})}function d(e){return!!(angular.isArray(e.data)&&e.data.length>0&&angular.isArray(e.data[0].items)&&e.data[0].items.length>0)&&e.data[0].items[0].iconClass!==i.icons.youAreHere}function u(e){var t=e===i.icons.vm,r=t?"SnapshotManagerView.FullDiskUsage":"SnapshotManagerView.DiskUsage";y.diskUsageLabel=o.getString("vmuiSnapshot",r)}function p(){var e=y.selectedSnapshot.metadata.snapshotMOR;if(e)return r.getVsphereObjectId(e)}function v(){e.revertToSnapshot(y.selectedSnapshot.metadata.snapshotMOR)}function m(){var t=p();t&&e.removeSnapshot(t)}function g(){e.getPrivilegesForVM(y.vmId).then(function(e){y.hasDeletePrivilege=e[0],y.hasRevertPrivilege=e[1],y.hasEditPrivilege=e[2]})}function h(){e.getCapabilitiesForVM(y.vmId).then(function(e){y.snapshotConfigSupported=e.capability.snapshotConfigSupported,y.revertToSnapshotSupported=e.capability.revertToSnapshotSupported})}var f,S,y=this;y.updateSnapshotTreeDebounced=_.debounce(l,300),y.vmId=t.modalOptions.availableTargets[0],y.liveRefreshProperties=["config.hardware.device","snapshot.rootSnapshotList","snapshot.currentSnapshot","rootSnapshot","snapshot"],y.isEditing=!1,t.$on(n.MODEL_CHANGED_EVENT,c),l(),this.setAsSelected=function(e){u(e.iconClass),y.selectedSnapshot=e,y.isSnapshotSelected=Boolean(e.metadata&&e.metadata.snapshotMOR),y.isRootSelected=e.iconClass===i.icons.vm,t.revertAlertOptions.message=o.getString("vmuiSnapshot","SnapshotActionCommand.RevertToSnapshot",e.label),y.isSelectedItemEditable=!y.isRootSelected&&e.iconClass!==i.icons.youAreHere,t.removeAlertOptions.message=o.getString("vmuiSnapshot","SnapshotActionCommand.Delete.Message",e.label),f=e.metadata.description,S=e.label,y.isEditing=!1},t.revertAlertOptions=s({title:o.getString("vmuiSnapshot","SnapshotActionCommand.ConfirmRevert"),submit:v}),this.onRevertToButtonClicked=function(){a.openConfirmationModal(t.revertAlertOptions)},t.removeAlertOptions=s({title:o.getString("vmuiSnapshot","SnapshotActionCommand.ConfirmDelete"),submit:m}),this.onRemoveSelectedSnapshotButtonClicked=function(){a.openConfirmationModal(t.removeAlertOptions)},this.onRemoveAllSnapshotsButtonClicked=function(){e.openRemoveAllSnapshotsConfirmationDialog(y.vmId)},this.onEditSelectedSnapshotButtonClicked=function(){f=y.selectedSnapshot.metadata.description,S=y.selectedSnapshot.label,y.isEditing=!0},this.onConfirmEditButtonClicked=function(){y.isEditing=!1,e.updateSnapshot(y.vmId,p(),y.selectedSnapshot.label,y.selectedSnapshot.metadata.description)},this.onCancelEditButtonClicked=function(){y.selectedSnapshot.label=S,y.selectedSnapshot.metadata.description=f,y.isEditing=!1},this.isEditDisabled=function(){return!(y.isSelectedItemEditable&&y.hasEditPrivilege&&y.snapshotConfigSupported)},this.isRevertDisabled=function(){return!(y.isSnapshotSelected&&y.hasRevertPrivilege&&y.revertToSnapshotSupported)}}angular.module("com.vmware.vsphere.client.vm").controller("manageSnapshotsController",e),e.$inject=["snapshotService","$scope","snapshotTreeService","defaultUriSchemeUtil","vcH5ConstantsService","i18nService","clarityModalService"]}(),function(){function e(e,t,i){var r=this;r.isMemoryDisabled=t.isTakingSnapshotWithMemoryDisabled(e.modalOptions.dialogData),r.isQuiesceEnabled=t.isQuiesceEnabled(e.modalOptions.dialogData)&&r.isMemoryDisabled,r.includeMemory=t.isSnapshotTakenWithMemoryByDefault(e.modalOptions.dialogData),r.quiesce=!1,r.snapshotName=i.getString("vmuiSnapshot","SnapshotManagerView.DefaultSnapshotName")+" "+(new Date).toLocaleString(),r.enableDisableMemoryQuiesce=function(){r.isQuiesceEnabled=t.isQuiesceEnabled(e.modalOptions.dialogData)&&!r.includeMemory,r.isMemoryDisabled=t.isTakingSnapshotWithMemoryDisabled(e.modalOptions.dialogData)||r.quiesce},r.createSnapshot=function(){var i=e.modalOptions.dialogData.objectId;t.takeSnapshot(i,r.snapshotName,r.snapshotDescription,r.includeMemory,r.quiesce),e.closeModal()},e.handleKeypress=function(e){13===e.which&&e.stopPropagation()}}angular.module("com.vmware.vsphere.client.vm").controller("snapshotDialogController",e),e.$inject=["$scope","snapshotService","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(t,r,n,o,a){var s={name:r,description:n,vm:i.getManagedObjectReference(t),memory:o,quiesce:a};e.add(A,s)}function u(e,i){var r=["name","snapshot","diskUsage"];return i&&r.push("managedByInfo"),t.getProperties(e,r)}function p(e){return t.getProperties(e,["capability"])}function v(e){var t=[h5_vm.Privileges.VM_REMOVE_SNAPSHOT,h5_vm.Privileges.VM_REVERT_SNAPSHOT,h5_vm.Privileges.VM_RENAME_SNAPSHOT];return o.checkPrivileges(e,t)}function m(t){var i={removeChildren:!1,consolidate:!0};return e.remove(t,k,i)}function g(t){return e.remove(t,L,{})}function h(t,r,n,o){var a={name:n,description:o,vm:i.getManagedObjectReference(t)};e.apply(r,U,a)}function f(e){y(e)}function S(e){return y(i.getVsphereObjectId(e))}function y(t){var i={suppressPowerOn:!1};return e.apply(t,N,i)}function P(e,t){var i=C(t.snapshot.rootSnapshotList[0]),n={};n[e]=t;var o=function(){y(e)},c=r.getString("vmuiSnapshot","SnapshotActionCommand.ConfirmRevert"),l=r.getString("vmuiSnapshot","SnapshotActionCommand.RevertToSnapshot",i);a.buildWarningMessage([e],!1,n).then(function(e){e&&(l=e+"\n\n"+l);var i=E(o,l,c,t.name);s.showConfirmationDialog(i)})}function C(e){return null!==e.childSnapshotList&&e.childSnapshotList?C(e.childSnapshotList[0]):e.name}function D(t){return e.apply(t,R,{})}function w(e,i){var r=e[0],o=c.getActions(r,["vsphere.core.vm.actions.installToolsAction"]),a=t.getProperties(r,["powerState","capability","name"]);return l.all([o,a]).then(function(t){var o=t[1],a=t[0][0].available;n.openModal(i,e,{objectId:r,powerState:o.powerState,memorySupported:o.capability.memorySnapshotsSupported,quiesceSupported:o.capability.quiescedSnapshotsSupported,diskOnlySnapshotOnSuspendedVMSupported:o.capability.diskOnlySnapshotOnSuspendedVMSupported,
vmToolsInstalledNeeded:a,secondaryTitle:o.name},"vm-ui/resources/vm/views/snapshots/snapshotDialog.html")})}function b(e,t){n.openModal(t,e,void 0,"vm-ui/resources/vm/views/snapshots/vmManageSnapshots.html")}function I(e){var t=e[0],i=function(){D(t)},n=r.getString("vmuiSnapshot","SnapshotActionCommand.ConfirmConsolidate"),o=r.getString("vmuiSnapshot","SnapshotActionCommand.Consolidate.All");a.buildWarningMessage([t],!1).then(function(e){e&&(o=e+"\n\n"+o);var r=E(i,o,n,"",t);s.showConfirmationDialog(r)})}function T(e){var t={title:r.getString("vmuiSnapshot","SnapshotActionCommand.ConfirmDeleteAll"),message:r.getString("vmuiSnapshot","SnapshotActionCommand.DeleteSnapshotForVM"),showXIcon:!1,submit:function(){g(e)}};n.openConfirmationModal(t)}function E(e,t,i,r,n){var o={};n?o.objectId=n:r&&(o.text=r);var a={title:i,message:t,yesHandler:e,useClarity:!0,icon:null,clarityIcon:{shape:"warning","class":"is-warning",size:48},showXIcon:!1};return _.isEmpty(o)||(a.subTitle=o),a}function V(e){return e.powerState!==F.POWERED_OFF}function M(e){return e.powerState===F.POWERED_OFF||!e.memorySupported||e.powerState===F.SUSPENDED&&!e.diskOnlySnapshotOnSuspendedVMSupported}function O(e){return e.powerState===F.POWERED_ON&&e.quiesceSupported&&!e.vmToolsInstalledNeeded}var A="com.vmware.vsphere.client.vm.snapshot.VmSnapshotSpec",k="com.vmware.vsphere.client.vm.snapshot.VmSnapshotRemovalSpec",R="com.vmware.vsphere.client.vm.snapshot.VmSnapshotConsolidateSpec",N="com.vmware.vsphere.client.vm.snapshot.VmSnapshotRevertSpec",U="com.vmware.vsphere.client.vm.snapshot.VmSnapshotEditSpec",L="com.vmware.vsphere.client.vm.snapshot.VmSnapshotRemoveAllSpec";const F=h5_vm.PowerState;return{takeSnapshot:d,getSnapshotsForVM:u,revertToCurrentSnapshot:f,revertToSnapshot:S,removeSnapshot:m,removeAllSnapshots:g,updateSnapshot:h,onRevertToActionMenuClicked:P,consolidateSnapshots:D,getPrivilegesForVM:v,getCapabilitiesForVM:p,openTakeSnapshotDialog:w,openManageSnapshotDialog:b,openConsolidateSnapshotDialog:I,openRemoveAllSnapshotsConfirmationDialog:T,isQuiesceEnabled:O,isTakingSnapshotWithMemoryDisabled:M,isSnapshotTakenWithMemoryByDefault:V}}angular.module("com.vmware.vsphere.client.vm").service("snapshotService",e),e.$inject=["mutationService","dataService","defaultUriSchemeUtil","i18nService","clarityModalService","authorizationService","managedByMessageBuilderService","actionConfirmationService","actionsService","$q"]}(),function(){"use strict";function e(e,r){return v=e,g=r,{formatData:t,getCurrentSnapshot:i,icons:h}}function t(e){var t=r(e);return e.snapshot&&e.snapshot.rootSnapshotList?t.items=l(e.snapshot.rootSnapshotList,e):(m=_.pick(t,["label","metadata","iconClass"]),t.selected=!0,t.items=[n(e)]),{data:[t]}}function i(){return m}function r(e){var t={diskUsage:e.diskUsage.totalDiskUsageInBytes};return o(e.name,h.vm,t)}function n(e){var t={diskUsage:e.diskUsage.currentDiskUsageInBytes};return o(g.getString("vmuiSnapshot","SnapshotManagerView.YouAreHere"),h.youAreHere,t)}function o(e,t,i){var r={label:e,iconClass:t,items:[],expanded:!0};return i&&(r.metadata=i),r}function a(e,t){for(var i=0;i<t.length;i++)if(e.snapshot.value===t[i].snapshotId)return t[i].diskUsageInBytes}function s(e,t){var i=c(e,t),r=t.snapshot.currentSnapshot;return null!==e.childSnapshotList&&(i.items=l(e.childSnapshotList,t)),r&&e.snapshot.value===r.value&&(m=_.pick(i,["label","metadata"]),i.selected=!0,i.items.unshift(n(t))),i}function c(e,t){var i={description:e.description,createTime:e.createTime,snapshotMOR:e.snapshot,isMemoryIncluded:d(e.state),quiesced:e.quiesced?g.getString("vmuiSnapshot","SnapshotManagerView.Option.Yes"):g.getString("vmuiSnapshot","SnapshotManagerView.Option.No"),diskUsage:a(e,t.diskUsage.snapshotDiskUsage)};return v.formatDate(e.createTime).then(function(e){i.createTime=e}),o(e.name,u(e.state),i)}function l(e,t){return _.map(e,function(e){return s(e,t)})}function d(e){switch(e){case p.SUSPENDED:case p.POWERED_ON:return g.getString("vmuiSnapshot","SnapshotManagerView.Option.Yes");case p.POWERED_OFF:return g.getString("vmuiSnapshot","SnapshotManagerView.Option.No");default:return g.getString("vmuiSnapshot","SnapshotManagerView.Option.No")}}function u(e){switch(e){case p.SUSPENDED:return h.snapshotSuspended;case p.POWERED_ON:return h.snapshotPoweredOn;case p.POWERED_OFF:return h.snapshotPoweredOff;default:return h.snapshotPoweredOff}}angular.module("com.vmware.vsphere.client.vm").service("snapshotTreeService",e),e.$inject=["timeFormatterService","i18nService"];const p=h5_vm.PowerState;var v,m,g,h={vm:"vsphere-icon-vm",snapshotPoweredOff:"vsphere-icon-snapshot",snapshotPoweredOn:"vsphere-icon-snapshot_run",snapshotSuspended:"vsphere-icon-snapshot_suspend",youAreHere:"vsphere-icon-snapshot_here"}}(),function(){"use strict";function e(e,t,i,r,n){var o=this;o.$scope=e;var a="com.vmware.usersettings.defaultConsole",s="vsphere.core.vm.actions.openConsole",c="vsphere.core.vm.actions.launchRemoteConsole";o.currentlySelectedFormat="WEB_CONSOLE",o.onClick=function(){if(o.shouldRemember){var t={defaultConsole:o.currentlySelectedFormat};r.setData(a,t,{},"defaultConsole","CONTENT_TYPE_TEXT")}var i="WEB_CONSOLE"===o.currentlySelectedFormat?s:c;return n.getAction(i,[e.modalOptions.dialogData.vmId]).then(function(e){n.invokeAction(e)}),!0},e.modalOptions.onSubmit=o.onClick}angular.module("com.vmware.platform.ui").controller("SelectConsoleDialogController",e),e.$inject=["$scope","$rootScope","i18nService","persistenceService","actionsService"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o){this.clarityModalService=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.datastoreBrowserConstants=r,this.contentLibraryService=n,this.dataService=o}return e.prototype.openHostDeviceSelector=function(e,t,i){var r=this,n={i18nService:this.i18nService,hosts:[],selectedHost:"",isLoading:!0,onHostChange:this.onHostChange.bind(this)};this.dataService.getProperties(e,["vmCdromContext"]).then(function(e){r.processResponse(e,n,t,i)})},e.prototype.processResponse=function(e,t,i,r){t.isLoading=!1;var n={title:this.i18nService.getString("VmUi","USBDevicePage.SelectHostDevice"),contentTemplate:"vm-ui/resources/vm/views/summary/modals/select-host/select-host.html",defaultButton:"submit",size:"md",dialogData:t,hideSubmitButton:!1,submitDisabled:!0,onCancel:this.onCancel.bind(this,r)};return e.vmCdromContext.cdRom&&(t.hosts=e.vmCdromContext.cdRom,t.selectedHost=t.hosts[0],n.submitDisabled=!1),n.dialogData.isSelectorDisabled=this.isSelectorDisabled.bind(this,n),n.onSubmit=this.onSubmit.bind(this,i,n),this.clarityModalService.openOkCancelModal(n),n},e.prototype.onCancel=function(e){angular.isFunction(e)&&e()},e.prototype.onSubmit=function(e,t){return angular.isFunction(e)&&e(t.dialogData.selectedHost),!0},e.prototype.isSelectorDisabled=function(e){return e.dialogData.isLoading||!e.dialogData.hosts.length},e.prototype.onHostChange=function(e,t){t.dialogData.selectedHost=e,t.submitDisabled=!1},e.$inject=["clarityModalService","i18nService","defaultUriSchemeUtil","datastoreBrowserConstants","contentLibraryService","dataService"],e}();e.SelectHostModalService=t,angular.module("com.vmware.vsphere.client.vm").service("selectHostModalService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(e,t,i,r,n,o){this.clarityModalService=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.datastoreBrowserConstants=r,this.contentLibraryService=n,this.dataService=o}return e.prototype.openIsoDeviceSelector=function(e,t,i){var r=this,n={i18nService:this.i18nService,selectedIso:{},datastoreBrowserId:"",datastoreIds:new Array,initialFileQueryType:"",filterFileQueryTypes:new Array,showVmImagesFolder:!0,onIsoChange:this.onIsoChange.bind(this)};this.dataService.getProperties(e,["vmCdromContext"]).then(function(e){return r.processResponse(e,n,t,i)})},e.prototype.processResponse=function(e,t,i,r){var n,o=this,a=this.defaultUriSchemeUtil.getVsphereObjectId(e.vmCdromContext.datastoreBrowser),s=e.vmCdromContext.datastore;n=s?s.map(function(e){return o.defaultUriSchemeUtil.getVsphereObjectId(e.datastore.datastore)}):[];var c=this.datastoreBrowserConstants.fileQueryType.ISO_IMAGE+this.datastoreBrowserConstants.fileQueryType.FOLDERS+this.datastoreBrowserConstants.fileQueryType.FLOPPY_IMAGE,l=[{label:this.i18nService.getString("Common","dsBrowser.isoImageFile"),value:this.datastoreBrowserConstants.fileQueryType.ISO_IMAGE+this.datastoreBrowserConstants.fileQueryType.FOLDERS},{label:this.i18nService.getString("Common","dsBrowser.allFiles"),value:this.datastoreBrowserConstants.fileQueryType.ALL_FILES}];t.datastoreBrowserId=a,t.datastoreIds=n,t.initialFileQueryType=c,t.filterFileQueryTypes=l;var d={title:this.i18nService.getString("VmUi","contentLibISO.infoHeader"),contentTemplate:"vm-ui/resources/vm/views/summary/modals/select-iso/select-iso.html",defaultButton:"submit",size:"lg",dialogData:t,hideSubmitButton:!1,submitDisabled:!0,onCancel:this.onCancel.bind(this)};return d.onSubmit=this.onSubmit.bind(this,i,d),this.clarityModalService.openOkCancelModal(d),d},e.prototype.onCancel=function(e){angular.isFunction(e)&&e()},e.prototype.onSubmit=function(e,t){return angular.isFunction(e)&&e(t.dialogData.selectedIso),!0},e.prototype.onIsoChange=function(e,t){t.dialogData.selectedIso=e,e?t.submitDisabled=!1:t.submitDisabled=!0},e.$inject=["clarityModalService","i18nService","defaultUriSchemeUtil","datastoreBrowserConstants","contentLibraryService","dataService"],e}();e.SelectIsoModalService=t,angular.module("com.vmware.vsphere.client.vm").service("selectIsoModalService",t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=com.vmware.vim.binding.vim.vm.device.VirtualDeviceSpec,i=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/summary/vm-hardware-summary-cdrom.html",this.controller=r,this.bindings={device:"=",ctrl:"="}}return e}();e.VmHardwareSummaryCdrom=i;var r=function(){function e(e,t,i,r,n,o,a,s,c,l,d){this.contentLibraryService=e,this.i18nService=t,this.selectIsoFileService=i,this.contentLibraryIsoSelectorModalService=r,this.selectHostModalService=n,this.selectIsoModalService=o,this.defaultUriSchemeUtil=a,this.dataService=s,this.authorizationService=c,this.mutationService=l,this.configurationService=d,this.lastAccessedISOFile="",this.hasDeviceConnectionPriv=!1,this.hasSetCdMediaPriv=!1,this.hasCLConfig=!0,this.BACKING_ISO="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$IsoBackingInfo",this.BACKING_ATAPI="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$AtapiBackingInfo",this.BACKING_REMOTE_ATAPI="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$RemoteAtapiBackingInfo",this.VM_DEVICE_CONNECTION_SPEC="com.vmware.vsphere.client.vm.VmDeviceConnectionSpec",this.i18n=t.getString}return e.prototype.$onInit=function(){var e=this.device.deviceInfo;this.label=e?e.label:"",this.ctrl.isVmTemplateCLitem||this.ctrl.isVmtxTemplateCLitem||this.getPermissions(["VirtualMachine.Interact.DeviceConnection","VirtualMachine.Interact.SetCDMedia"]),this.checkForCLConfig(),this.shouldRefetchISOItemType()&&this.fetchISOItemType()},e.prototype.shouldShowDropdown=function(){return!this.ctrl.isVmTemplateCLitem&&!this.ctrl.hardwareViewData.isTemplate&&"poweredOn"===this.ctrl.hardwareViewData.powerState},e.prototype.getDeviceConnected=function(){if(this.ctrl&&this.ctrl.isVmTemplateCLitem)return this.getOvfTemplateDeviceType();var e=this.isDeviceConnected()?"connected":"disconnected";return this.i18n("VmUi","DeviceConnection."+e)},e.prototype.isDeviceConnected=function(){return this.device.connectable&&this.device.connectable.connected},e.prototype.getConnectedTo=function(){if(this.isLoading)return this.i18n("VmUi","DeviceConnection.loading");switch(this.device.backing._type){case this.BACKING_ISO:return this.shouldRefetchISOItemType()?void this.fetchISOItemType():this.isContentLibraryIso?this.i18n("VmUi","DeviceConnection.manager.info.cl_image_file"):this.i18n("VmUi","DeviceConnection.manager.info.host_image_file");case this.BACKING_ATAPI:return this.resetLastAccessedISOBackingInfo(),this.i18n("VmUi","DeviceConnection.manager.info.host_cdrom_device");case this.BACKING_REMOTE_ATAPI:return this.resetLastAccessedISOBackingInfo(),this.i18n("VmUi","DeviceConnection.manager.info.client_machine");default:return this.resetLastAccessedISOBackingInfo(),this.i18n("VmUi","DeviceConnection.manager.unknown_device")}},e.prototype.disconnectCdRom=function(){this.expanded=!1,this.device.connectable.connected=!1,this.device.connectable.startConnected=!1,this.mutate()},e.prototype.connectToHostCdDevice=function(){var e=this;this.selectHostModalService.openHostDeviceSelector(this.ctrl.objectId,function(t){var i=e.device.backing;i.deviceName=t.name,i._type=e.BACKING_ATAPI,e.device.connectable.connected=!0,e.mutate()})},e.prototype.browseForDatastoreIso=function(){var e=this;this.selectIsoModalService.openIsoDeviceSelector(this.ctrl.objectId,function(t){var i=e.device.backing;i.fileName=t.path,i._type=e.BACKING_ISO,e.device.connectable.connected=!0,e.mutate()})},e.prototype.browseForContentLibraryIso=function(){var e=this,t=function(){};this.dataService.getProperties(this.ctrl.objectId,["resourcePool"]).then(function(i){var r=e.defaultUriSchemeUtil.getVsphereObjectId(i.resourcePool);e.contentLibraryIsoSelectorModalService.openContentLibraryIsoSelector(r,void 0,function(t){var i=e.device.backing;i.fileName=t.isoPath,i._type=e.BACKING_ISO,e.device.connectable.connected=!0,e.mutate()},t)})},e.prototype.mutate=function(){var e={},i=new t;i.device=this.device,i.operation="edit",e.deviceSpec=i,this.mutationService.apply(this.ctrl.objectId,this.VM_DEVICE_CONNECTION_SPEC,e)},e.prototype.shouldRefetchISOItemType=function(){return!!this.device.backing&&this.device.backing._type===this.BACKING_ISO&&this.getCurrentFileName()!==this.lastAccessedISOFile},e.prototype.resetLastAccessedISOBackingInfo=function(){this.lastAccessedISOFile="",this.isContentLibraryIso=!1},e.prototype.getCurrentFileName=function(){var e=this.device.backing;return this.device&&e?e.fileName:""},e.prototype.hasPermission=function(){return this.hasDeviceConnectionPriv&&this.hasSetCdMediaPriv},e.prototype.hasPermissionAndConfigForCL=function(){return this.hasPermission()&&this.hasCLConfig},e.prototype.getCurrentDeviceName=function(){var e=this.device.backing;return this.device&&e?e.deviceName:""},e.prototype.fetchISOItemType=function(){var e=this;this.isDeviceConnected()&&(this.isLoading=!0,this.contentLibraryService.getContentLibraryItemByDatastorePath(this.getCurrentFileName()).then(function(t){t&&t.contentLibraryItemByDatastorePath&&!e.isoItemHasErrorMessage(t)?e.isContentLibraryIso=!0:e.resetLastAccessedISOBackingInfo(),e.lastAccessedISOFile=e.getCurrentFileName()}).then(function(){e.isLoading=!1}))},e.prototype.isoItemHasErrorMessage=function(e){return e.contentLibraryItemByDatastorePath&&Array.isArray(e.contentLibraryItemByDatastorePath.errorMessages)&&e.contentLibraryItemByDatastorePath.errorMessages.length>0},e.prototype.getDeviceOrFile=function(){if(this.isLoading)return{title:this.i18n("VmUi","DeviceConnection.loading"),value:this.i18n("VmUi","DeviceConnection.loading")};if(this.device.backing){if(this.getCurrentDeviceName())return{title:this.i18n("VmUi","DeviceConnection.manager.info.device"),value:this.getCurrentDeviceName()};if(this.getCurrentFileName())return{title:this.i18n("VmUi","DeviceConnection.manager.info.file"),value:this.getCurrentFileName()}}},e.prototype.getOvfTemplateDeviceType=function(){var e=this.device.deviceInfo,t=e&&e.type?e.type:"",i=e&&e.subType?e.subType:"",r=this.i18n("LibraryUi","vm.hardware.drive.type."+t),n=this.i18n("LibraryUi","vm.hardware.drive.subType."+i);return r+"/"+n},e.prototype.getPermissions=function(e){var t=this;this.authorizationService.checkPrivileges(this.ctrl.objectId,e).then(function(e){t.hasDeviceConnectionPriv=e[0],t.hasSetCdMediaPriv=e[1]})},e.prototype.checkForCLConfig=function(){var e=this;this.configurationService.getProperty("vmc.gateway.mode").then(function(t){"true"===t&&(e.hasCLConfig=!1)})},e.$inject=["contentLibraryService","i18nService","selectIsoFileService","contentLibraryIsoSelectorModalService","selectHostModalService","selectIsoModalService","defaultUriSchemeUtil","dataService","authorizationService","mutationService","configurationService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareSummaryCdrom",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/summary/vm-hardware-summary-encryption.html",this.controller=i,this.bindings={devices:"<"}}return e}();e.VmHardwareSummaryEncryption=t;var i=function(){function t(e,t){this.i18nService=e,this.vmCryptUtilService=t}return t.prototype.$onInit=function(){this.label=this.i18nService.getString("VmUi","VmCryptConfig.encryptionLabel")},t.prototype.$onChanges=function(e){e.devices&&this.refreshContent()},t.prototype.refreshContent=function(){this.vmConfigContent=this.i18nService.getString("VmUi","VmCryptConfig.vmHomeEncrypted");var t=this.devices[e.DeviceTypeConstants.VIRTUALDISK]?this.devices[e.DeviceTypeConstants.VIRTUALDISK].length:0,i=this.getEncryptedDisksCount();0===i?this.disksContent=this.i18nService.getString("VmUi","VmCryptConfig.StatusDisksNone"):t===i?1===t?this.disksContent=this.i18nService.getString("VmUi","VmCryptConfig.StatusDisks1Encrypted"):this.disksContent=this.i18nService.getString("VmUi","VmCryptConfig.StatusDisksAll",t):this.disksContent=this.i18nService.getString("VmUi","VmCryptConfig.StatusDisksSome",i,t)},t.prototype.getEncryptedDisksCount=function(){var t=this;return _.filter(this.devices[e.DeviceTypeConstants.VIRTUALDISK],function(e){return t.vmCryptUtilService.isExistingDiskEncrytped(e)}).length},t.$inject=["i18nService","vmCryptUtilService"],t}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareSummaryEncryption",new t)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/summary/vm-hardware-summary-floppy.html",this.controller=i,this.bindings={device:"=",ctrl:"="}}return e}();e.VmHardwareSummaryFloppy=t;var i=function(){function e(e,t,i,r,n,o){this.contentLibraryService=e,this.i18nService=t,this.defaultUriSchemeUtil=i,this.dataService=r,this.authorizationService=n,this.mutationService=o,this.BACKING_FLOPPY_HOST_IMAGE="com.vmware.vim.binding.vim.vm.device.VirtualFloppy$ImageBackingInfo",this.BACKING_FLOPPY_HOST_FLOPPY_DEVICE="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$DeviceBackingInfo",this.BACKING_FLOPPY_REMOTE_CLIENT_DEVICE="com.vmware.vim.binding.vim.vm.device.VirtualCdrom$RemoteDeviceBackingInfo",this.i18n=t.getString}return e.prototype.$onInit=function(){var e=this.device.deviceInfo;this.label=this.device||e?e.label:""},e.prototype.getDeviceConnected=function(){var e=this.isDeviceConnected()?"connected":"disconnected";return this.i18n("VmUi","DeviceConnection."+e)},e.prototype.isDeviceConnected=function(){return this.device.connectable&&this.device.connectable.connected},e.prototype.getConnectedTo=function(){if(this.ctrl&&this.ctrl.isVmTemplateCLitem){var e=this.device.deviceInfo;return this.i18n("LibraryUi","vm.hardware.floppy.type."+e.type)}if(this.isLoading)return this.i18n("VmUi","DeviceConnection.loading");switch(this.device.backing._type){case this.BACKING_FLOPPY_HOST_IMAGE:return this.i18n("VmUi","DeviceConnection.manager.info.host_image_file");case this.BACKING_FLOPPY_HOST_FLOPPY_DEVICE:return this.i18n("VmUi","DeviceConnection.manager.info.host_floppy_device");case this.BACKING_FLOPPY_REMOTE_CLIENT_DEVICE:return this.i18n("VmUi","DeviceConnection.manager.info.remote_client_device");default:return this.i18n("VmUi","DeviceConnection.manager.unknown_device")}},e.prototype.getCurrentFileName=function(){var e=this.device.backing;return this.device&&e?e.fileName:""},e.prototype.getCurrentDeviceName=function(){var e=this.device.backing;return this.device&&e?e.deviceName:""},e.prototype.getDeviceOrFile=function(){if(this.ctrl&&this.ctrl.isVmTemplateCLitem){var e=this.device.deviceInfo;return this.i18n("LibraryUi","vm.hardware.floppy.type."+e.type)}if(this.isLoading)return this.i18n("VmUi","DeviceConnection.loading");if(this.device.backing){if(this.getCurrentDeviceName())return{title:this.i18n("VmUi","DeviceConnection.manager.info.device"),value:this.getCurrentDeviceName()};if(this.getCurrentFileName())return{title:this.i18n("VmUi","DeviceConnection.manager.info.file"),value:this.getCurrentFileName()}}},e.$inject=["contentLibraryService","i18nService","selectIsoFileService","contentLibraryIsoSelectorModalService","selectHostModalService","defaultUriSchemeUtil","dataService","authorizationService","mutationService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareSummaryFloppy",new t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m){function g(){if(y.isVmTemplateCLitem){var e="type",i="morIdOfVmtx";return t.getProperties(y.objectId,[e,i]).then(function(t){if(t&&t[e]===v.VM_TEMPLATE){var r=t[i],n=u.createVmomiUri(r.type,r.value,r.serverGuid);return y.isVmtxTemplateCLitem=!0,y.isVmTemplateCLitem=!1,y.watchObjects.includes(n)||y.watchObjects.push(n),p.resolve(n)}return p.resolve(y.objectId)})}return p.resolve(y.objectId)}function h(e){var i=s("VmHardwareSummaryController"),r=y.isVmTemplateCLitem?"com.vmware.vsphere.client.library.h5model.OvfTemplateHardwareData":"com.vmware.vsphere.client.vm.model.HardwareViewData";t.getData(e,r,{queryName:"VmHardwareSummaryController."+h.name}).then(function(e){if(y.isVmTemplateCLitem){if(e.isVappTemplate||!e.cpu||!e.memory)return void(e=null);e=c.convertOvfTemplateHardwareData(e)}if(y.hardwareViewData=e,e.hardware){var t=e.hardware.device,r=_.reject(t,function(e){var t=a.isDeviceInstanceOf(e,"VirtualDevice");return t&&i.error("Invalid device (unstable VMODL between ESX and VC?): "+JSON.stringify(e)),t});r=_.filter(r,function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualTPM"!==e._type}),y.devices=o.groupAndSortDevices(r);var s=y.devices.VirtualDisk,l=_.partition(y.devices.VirtualDisk,function(e){return!S(e)}),u=l&&l[0]?l[0]:[],p=l&&l[1]?l[1]:[];y.shouldGroupHardDisks=!!s&&s.length>2,y.totalHardDiskCount=s?s.length:0,y.displayHardDiskDevices=[],y.displayRdmDiskDevices=[],y.shouldGroupHardDisks?u.length?y.displayHardDiskDevices.push(u[0]):y.displayRdmDiskDevices.push(p[0]):(y.displayHardDiskDevices=u,y.displayRdmDiskDevices=p);var v=_.filter(t,function(e){return"com.vmware.vim.binding.vim.vm.device.VirtualTPM"===e._type});v&&v.length>0?y.tpmDevice=v[0]:y.tpmDevice=null,y.isPmemSummaryVisible=f(y.devices),y.isEncryptionSummaryVisible=!d.isCryptoKeyEmpty(e.cryptoKeyId)}else n.sendDebugMessage("null hardwareViewData.hardware in VmHardwareSummaryController!",e)})}function f(e){return!_.isEmpty(y.devices.VirtualNVDIMM)||_.some(e.VirtualDisk,function(e){return l.isPmemDisk(e)})}function S(e){return e&&e.backing._type===m.RAWDISKMAPPING}var y=this,P=e._route.objectId;y.liveRefreshProperties=["config.hardware.numCPU","config.hardware.memoryMB","config.hardware.device","config.version"],y.watchObjects=[P],y.objectId=P,y.isVmtxTemplateCLitem=!1,y.isEncryptionSummaryVisible=!1,y.isPmemSummaryVisible=!1,y.displayHardDiskDevices=[],y.isVmTemplateCLitem=0===P.indexOf("urn:vapi:com.vmware.content.library.Item");var C=i.getString("VmUi","actionLabelEditSettings"),D=i.getString("VmUi","actionDescEditSettings");e.portlet&&(y.isVmTemplateCLitem?e.portlet.footerLinks=null:r.getAction("vsphere.core.vm.editSettingsAction",[P]).then(function(t){var i=!!t&&!!t.available;y.editAction=t&&t.available?t:void 0,e.portlet.footerLinks=[{label:C,ariaLabel:D,onClick:y.invokeEditAction,enabled:i}]})),y.invokeEditAction=function(e){return e&&(e.stopPropagation(),e.preventDefault()),y.editAction?r.invokeAction(y.editAction):null},y.getVmHardwareData=function(){return g().then(function(e){h(e)})},y.getVmHardwareData(),y.getGroupedDiskText=function(){return i.getString("VmUi","summaryView.groupedDisks.value",y.totalHardDiskCount)}}angular.module("com.vmware.vsphere.client.vm").controller("VmHardwareSummaryController",e),e.$inject=["$scope","dataService","i18nService","actionsService","feedbackService","deviceOrganizer","vmDeviceInfoService","logService","ovfTemplateHardwareDataMapping","pmemUtilService","vmCryptUtilService","defaultUriSchemeUtil","$q","managedEntityConstants","diskBackingInfoConstants"]}(),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSummaryCpu",["i18nService",function(e){return{templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryCpu.html",scope:{ctrl:"="},link:function(t){function i(e){return e<0?t.i18n("VmUi","labelUnlimited"):t.i18n("VmUi","cpuReservationLimit",e)}function r(e){return e?t.i18n("VmUi","VmCpuView.Enabled"):t.i18n("VmUi","VmCpuView.Disabled")}function n(e){var t=e.ctrl.hardwareViewData,n=e.i18n("VmUi","numCpuUtilization",t.hardware.numCPU,t.cpuUtilization),o=e.i18n("VmUi","numCpu",t.hardware.numCPU),a=e.i18n("VmUi","VmCpu.Label.CpuHotPlug"),s=e.i18n("VmUi","cpuReservationLimit",t.cpuAllocation.reservation),c=i(t.cpuAllocation.limit),l=e.ctrl.isVmTemplateCLitem?t.cpuAllocation.shares:e.i18n("VmUi","sharesAndType",t.cpuAllocation.shares.shares,e.i18n("VmUi","sharesInfoLevel."+t.cpuAllocation.shares.level));e.fieldValue={ConfiguredCPU:o,Utilization:n,Reservation:s,Limit:c,NestedHV:r(t.hardwareVirtualization),IommuHV:r(t.vvtdEnabled),PerfCounters:r(t.performanceCounters),CpuHotPlug:a,Shares:l}}t.i18n=e.getString,t.fieldLabel=function(t){return e.getString("VmUi",t)},t.isTemplate=t.ctrl.hardwareViewData.memoryData.isVmTemplate,t.$watch("ctrl.hardwareViewData.cpuAllocation",function(e){e&&(n(t),t.fields=_.keys(t.fieldValue))})}}}]),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSummaryHwVersion",["i18nService","vmHardwareVersionService",function(e,t){return{templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryHwVersion.html",scope:{ctrl:"="},link:function(i){i.vmHwVersionLabel=e.getString("VmUi","VmHardwareView.HWVersion"),i.$watch("ctrl.hardwareViewData",function(e){var r=e.vmVersion;i.vmHwVersion=t.getLongText(r);var n=t.getScheduledUpgradeData(e);i.hasScheduledUpgrade=!!n.status,i.scheduledUpgradeStatus=n.status,i.scheduledUpgradeError=n.error})}}}]),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSummaryMemory",["$filter","i18nService","feedbackService",function(e,t,i){return{scope:{ctrl:"="},templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryMemory.html",link:function(i){i.i18n=t.getString,i.fieldLabel=function(e){return i.i18n("VmUi","label"+e)},i.isTemplate=i.ctrl.hardwareViewData.memoryData.isVmTemplate;var r=i.ctrl.isVmTemplateCLitem;i.$watch("ctrl.hardwareViewData",function(t){if(t&&t.hardware){var n=e("bytes");i.memoryUtilizationPercentage=Math.round(t.memoryData.memoryUtilization/t.hardware.memoryMB*100),i.memoryUtilizationPercentage>100&&(i.memoryUtilizationPercentage=100);var o=i.i18n("VmUi","memValue",t.hardware.memoryMB),a=r?"":i.i18n("VmUi","h5memValueUtilization",n(t.hardware.memoryMB,"MB","GB"),n(t.memoryData.memoryUtilization,"MB","GB")),s=r?t.memoryData.memoryAllocation.shares:i.i18n("VmUi","sharesAndType",t.memoryData.memoryAllocation.shares.shares,i.i18n("VmUi","sharesInfoLevel."+t.memoryData.memoryAllocation.shares.level)),c=i.i18n("VmUi","memValue",t.memoryData.memoryAllocation.reservation),l=t.memoryData.memoryAllocation.limit<0?i.i18n("VmUi","labelUnlimited"):t.memoryData.memoryAllocation.limit,d=i.i18n("VmUi","memValue",t.memoryData.overheadMemory);i.fieldValue={ConfiguredMemory:o,Utilization:a,Shares:s,Reservation:c,Limit:l,HostOverhead:d},i.fields=_.keys(i.fieldValue)}})}}}]),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSummaryNetwork",["dataService","vmDeviceInfoService","i18nService","scopeUtil","defaultUriSchemeUtil","navigation",function(e,t,i,r,n,o){return{scope:{device:"=",ctrl:"="},templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryNetwork.html",link:function(a){function s(e){e||(a.networkName="",a.networkRef=null);var t;e._type===c?t=_.find(a.ctrl.hardwareViewData.dvPortGroupData,function(t){return t.key===e.port.portgroupKey}):e._type===l?t=_.find(a.ctrl.hardwareViewData.opaqueNetworkData,function(t){return t.opaqueNetworkType===e.opaqueNetworkType&&t.opaqueNetworkId===e.opaqueNetworkId}):(a.networkName=a.device.deviceInfo.summary,a.networkRef=n.getVsphereObjectId(e.network)),t&&(a.networkName=t.name,a.networkRef=n.getVsphereObjectId(t.provider)),a.ctrl.isVmTemplateCLitem&&(a.connectOnStart=a.device.startConnected)}var c="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$DistributedVirtualPortBackingInfo",l="com.vmware.vim.binding.vim.vm.device.VirtualEthernetCard$OpaqueNetworkBackingInfo";a.i18n=i.getString,a.isTemplate=a.ctrl.hardwareViewData.memoryData.isVmTemplate,a.ethernetCardLabel=t.getEthernetCardLabel(a.device._type),o.populateScope(a),a.$watch("device",function(){s(a.device.backing)}),a.ctrl.isVmTemplateCLitem||r.watchUntilTrue(a,"expanded",function(){var t=n.getVsphereObjectId(a.ctrl.hardwareViewData.provider);e.getProperties(t,"runtime").then(function(e){var t=_.find(e.runtime.device,function(e){return e.key===a.device.key});t&&(a.directpathEnabled=t.runtimeState.vmDirectPathGen2Active)})}),a.labelForConnectionState=function(){if(a.device.connectable){var e=i.getString("VmUi",a.device.connectable.connected?"VmHardwareView.deviceConnected":"VmHardwareView.deviceDisconnected");return i.getString("VmUi","VmNetView.networkConnection",e)}}}}}]);var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/summary/vmHardwareSummaryNvdimm.html",this.controller=i,this.bindings={device:"<"}}return e}();e.VmHardwareSummaryNvdimm=t;var i=function(){function e(e){this.bytesFilter=e}return e.prototype.$onInit=function(){this.label=this.device.deviceInfo.label,this.content=this.getContent()},e.prototype.getContent=function(){return this.bytesFilter(this.device.capacityInMB,"MB")},e.prototype.$onChanges=function(e){var t=e.device;t&&!t.isFirstChange()&&(this.content=this.getContent())},e.$inject=["bytesFilter"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareSummaryNvdimm",new t)}(h5_vm||(h5_vm={})),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSummaryOther",["i18nService",function(e){return{templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryOther.html",scope:{ctrl:"=",devices:"="},link:function(t){t.i18n=e.getString,t.getSummaryText=function(e,t){var i=e.deviceInfo.summary,r=e.deviceInfo.label,n=e._type;return"com.vmware.vim.binding.vim.vm.device.VirtualKeyboard"===n||"com.vmware.vim.binding.vim.vm.device.VirtualPointingDevice"===n?r:"InputDevice"===t?i:i===r?i:i?r+" ("+i+")":r}}}}]);var h5_vm;!function(e){var t=function(){function e(){this.templateUrl="vm-ui/resources/vm/views/summary/vmHardwareSummaryPmem.html",this.controller=i,this.bindings={devices:"<"}}return e}();e.VmHardwareSummaryPmem=t;var i=function(){function e(e,t,i){this.bytesFilter=e,this.i18nService=t,this.pmemUtilService=i}return e.prototype.$onInit=function(){this.label=this.i18nService.getString("VmUi","VmHardwareSummaryView.PMem"),this.content=this.getContent()},e.prototype.getContent=function(){return this.bytesFilter(this.getTotalMemoryInKb(),"KB")},e.prototype.$onChanges=function(e){var t=e.devices;t&&!t.isFirstChange()&&(this.content=this.getContent())},e.prototype.getTotalMemoryInKb=function(){var e=this;if(_.isEmpty(this.devices))return 0;var t=0;return _.each(this.devices.VirtualNVDIMM,function(e){t+=1024*e.capacityInMB}),_.each(this.devices.VirtualDisk,function(i){e.pmemUtilService.isPmemDisk(i)&&(t+=i.capacityInKB)}),t},e.$inject=["bytesFilter","i18nService","pmemUtilService"],e}();angular.module("com.vmware.vsphere.client.vm").component("vmHardwareSummaryPmem",new t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e){this.i18n=e.getString}angular.module("com.vmware.vsphere.client.vm").component("vmHardwareSummaryVideoCard",{
bindings:{device:"<"},templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryVideoCard.html",controller:e}),e.$inject=["i18nService"]}(),angular.module("com.vmware.vsphere.client.vm").directive("vmHardwareSummaryVirtualDisk",["i18nService","dataService","scopeUtil","defaultUriSchemeUtil","navigation","pmemUtilService","vmCryptUtilService",function(e,t,i,r,n,o,a){return{templateUrl:"vm-ui/resources/vm/views/summary/vmHardwareSummaryVirtualDisk.html",scope:{device:"=",ctrl:"="},link:function(t){function i(i){t.deviceLabel=a.isExistingDiskEncrytped(i)?e.getString("VmUi","VmDiskView.encryptedDiskLabel",i.deviceInfo.label):i.deviceInfo.label}function s(e,t){return _.find(t,function(t){return r.getVsphereObjectId(t.provider)===e})}t.i18n=e.getString,t.deviceLabel=t.device.deviceInfo.label,n.populateScope(t),t.$watch(function(){return t.device.backing.datastore},function(){var e=t.device.backing.datastore;e&&(t.datastoreRef=r.getVsphereObjectId(e),t.datastoreInfo=s(t.datastoreRef,t.ctrl.hardwareViewData.datastoreInfo),t.isPmemDisk=o.isPmemDisk(t.device))}),i(t.device),t.$watch(function(){return t.device.backing},function(e,r){e!==r&&i(t.device)})}}}]),angular.module("com.vmware.vsphere.client.vm").directive("vmSummaryImage",["i18nService","actionsService","featureFlagsService","dataService","persistenceService","clarityModalService",function(e,t,i,r,n,o){function a(e,t){var i,r,n,o;if(e.powerState&&!e.isTemplate){switch(e.powerState){case"poweredOn":o=!0,i=t("VmUi","VmImage.poweredOn"),r="icon-vSphere-vmPowerOn";break;case"poweredOff":n=t("VmUi","VmImage.poweredOff"),o=!1;break;case"suspended":i=t("VmUi","VmImage.suspended"),r="icon-vSphere-vmSuspend",o=!1}return{isWebConsoleAvailable:o,stateLabel:n,imageCaption:i,imageCaptionIcon:r}}}return{templateUrl:"vm-ui/resources/vm/views/summary/vmSummaryImage.html",link:function(s){function c(){s.screenshotInProgress||(s.screenshotInProgress=!0,r.getProperties(s.entityReference,["vmScreenshot"],{propertyParams:[{propertyName:"vmScreenshot",parameterType:"com.vmware.vsphere.client.vm.screenshot.VmScreenshotSize",parameter:{width:160,height:120}}]}).then(function(e){var t=e.vmScreenshot;_.isEmpty(t)||(s.imageBytes=t)}).then(function(){s.screenshotInProgress=!1}))}function l(){t.getAction("vsphere.core.vm.actions.launchRemoteConsole",[p]).then(function(e){s.launchConsoleActionEval=e})}function d(){t.getAction("vsphere.core.vm.actions.downloadVMRC").then(function(e){t.invokeAction(e)})}function u(){return"R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}var p=s.entityReference;s.screenshotInProgress=!1,s.i18n=e.getString,s.featureFlagsService=i,s.launchConsoleActionEval=null,s.getVmScreenshot=c,s.imageBytes=u();var v="com.vmware.usersettings.defaultConsole",m="vsphere.core.vm.actions.openConsole",g="vsphere.core.vm.actions.launchRemoteConsole";s.$watch("summaryData",function(e,t){angular.extend(s,a(s.summaryData,s.i18n)),s.launchConsoleActionEval&&e===t||(angular.isDefined(e.isTemplate)&&!e.isTemplate&&l(),t.powerState!==e.powerState&&("poweredOff"===e.powerState?s.imageBytes=null:c()))},!0),s.signPostContentTemplate='<div class="locked-vm-signpost-content">'+e.getString("VmUi","summaryView.unlockVm.signpost.text")+"</div>",c(),s.vmrcInfoSignPostParams={message:e.getString("VmUi","summaryView.downloadVMRCPlayer.tooltip"),title:e.getString("Common","help"),linkLabel:e.getString("VmUi","summaryView.downloadVMRCPlayer"),linkFunction:d},s.launchVmrcInfoSignPostParams={message:e.getString("VmUi","summaryView.launchVMRCConsoleInfo.text"),title:e.getString("VmUi","summaryView.launchVMRCConsole"),linkLabel:e.getString("VmUi","summaryView.downloadVMRCPlayer"),linkFunction:d},s.itemClicked=function(t){var i={key:"uid",op:"=",value:v};n.getData(i).then(function(i){var r=i[0];if(r&&r.value&&r.value.defaultConsole){var n=r.value.defaultConsole;"WEB_CONSOLE"===n?s.launchWebConsole():s.launchVMRCConsole()}else o.openOkCancelModal({contentTemplate:"vm-ui/resources/vm/views/summary/modals/select-default-console/SelectConsoleDialog.html",title:e.getString("VmUi","launchConsoleModal.title"),dialogData:{vmId:t}})})},s.unlockVmClicked=function(e){t.getAction("vsphere.core.vm.actions.cryptoUnlock",[e]).then(function(e){t.invokeAction(e)})},s.unlockVmClicked=function(e){t.getAction("vsphere.core.vm.actions.cryptoUnlock",[e]).then(function(e){t.invokeAction(e)})},s.launchVMRCConsole=function(){t.getAction(g,[p]).then(function(e){t.invokeAction(e)})},s.launchWebConsole=function(){t.getAction(m,[p]).then(function(e){t.invokeAction(e)})}}}}]);var h5_vm;!function(e){var t=function(){function e(e,t,i){this.$rootScope=e,this.vmTpmService=t,this.i18nService=i,this.i18n=i.getString}return e.prototype.$onInit=function(){var e=this;this.vmTpmService.getCertificates(this.vmId).then(function(t){e.tpmCertificates=t})},e.prototype.navigateToConfigureTab=function(){this.$rootScope._navigateToViewAndObject("vsphere.core.vm.manage.settings.tpmCertificatesView",this.vmId)},e.$inject=["$rootScope","vmTpmService","i18nService"],e}();e.VmTpmController=t;var i=function(){function e(){this.controller=t,this.templateUrl="vm-ui/resources/vm/views/summary/vmTpm/vm-tpm.html",this.bindings={vmId:"<",label:"<"}}return e}();e.VmTpmComponent=i,angular.module("com.vmware.vsphere.client.vm").component("vmTpm",new i)}(h5_vm||(h5_vm={}));var h5_vm;!function(e){e.BEGIN_CERT_MARKER="-----BEGIN CERTIFICATE-----\n",e.END_CERT_MARKER="\n-----END CERTIFICATE-----\n",e.BEGIN_CSR_MARKER="-----BEGIN CERTIFICATE REQUEST-----\n",e.END_CSR_MARKER="\n-----END CERTIFICATE REQUEST-----\n";var t=function(){function t(e,t,i){this.dataService=e,this.$http=t,this.$q=i}return t.prototype.stripHeadersFromCertificate=function(e){var t=/-+BEGIN CERTIFICATE-+([^-]+)-+END CERTIFICATE-+/im,i=e.match(t);return i?i[1]:e},t.prototype.getCertificates=function(t){return this.dataService.getProperties(t,["tpmCertificates"]).then(function(t){return _.map(t.tpmCertificates.certificateInfos,function(t){return t.rawData=e.BEGIN_CERT_MARKER+t.rawData+e.END_CERT_MARKER,t})})},t.prototype.getCertSigningRequests=function(t){return this.dataService.getProperties(t,["tpmCertificates"]).then(function(t){return _.map(t.tpmCertificates.csrInfos,function(t){return t.rawData=e.BEGIN_CSR_MARKER+t.rawData+e.END_CSR_MARKER,t})})},t.prototype.isTpmRemovalDisabled=function(e){return e},t.prototype.parseCertificate=function(e){var t=this;if(!e)return this.$q.when(null);var i=this.stripHeadersFromCertificate(e),r="certs/cert-info",n=$.param({certificate:i}),o={headers:{"Content-Type":"application/x-www-form-urlencoded"}};return this.$http.post(r,n,o).then(function(t){var i=t.data,r=i.issuerName.match(/CN=([^,]*)/);return i.issuerNameCN=r?r[1]:i.issuerName,i.rawData=e,i},function(e){return t.$q.reject(e.data)})},t.$inject=["dataService","$http","$q"],t}();e.VmTpmService=t,angular.module("com.vmware.vsphere.client.vm").service("vmTpmService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r,n,o){var a="auto",s=this,c={};s.installCount=0,s.upgradeCount=0,s.totalCount=e.modalOptions.dialogData.totalVmsCount,s.selectedUpgradeMethod=a,s.multiUpgradeOptions="";var l=e.modalOptions.dialogData.availableVmIds;s.buttonContinueText=n.getString("VmUi","defaultConsole.dialog.button.continue"),s.instructionText=n.getString("VmUi","VmToolsPopupForm.multiAction.instruction"),_.isEmpty(l)?(s.installCount=0,s.upgradeCount=0,s.skippedCount=s.totalCount,i(function(){const e=t[0].querySelector("#install-upgrade-vmware-tools-ok-button");e&&e.focus()},0)):(s.loading=!0,r.getGroupedVms(l).then(function(e){c=e.groupedVms,o.buildWarningMessage(l,!1,e.properties).then(function(e){s.managedByMessage=e,s.installCount=c.install.length,s.upgradeCount=c.upgrade.length,s.skippedCount=s.totalCount-(s.installCount+s.upgradeCount);var r="#install-upgrade-vmware-tools-ok-button";s.installCount>0&&(r="#install-upgrade-vmware-tools-submit-button"),s.upgradeCount>0&&(r=s.selectedUpgradeMethod===a?"#install-upgrade-vmware-tools-automatic-upgrade":"#install-upgrade-vmware-tools-interactive-upgrade"),i(function(){const e=t[0].querySelector(r);e&&e.focus()},0)})}).then(function(){s.loading=!1})),s.cancel=function(){e.closeModal()},s.submit=function(){r.installTools(c.install),r.upgradeTools(c.upgrade,s.selectedUpgradeMethod,s.multiUpgradeOptions),e.closeModal()},s.isAutoUpgradeSelected=function(){return s.selectedUpgradeMethod===a}}angular.module("com.vmware.vsphere.client.vm").controller("InstallUpgradeVmToolsController",e),e.$inject=["$scope","$element","$timeout","installUpgradeVmToolsService","i18nService","managedByMessageBuilderService"]}(),function(){"use strict";function e(e,t){function i(t){var i=[s,c,l,d],n=e.getPropertiesForObjects(t,i).then(function(e){var t=r(e),i={groupedVms:t,properties:e};return i});return n}function r(e){var t={poweredOff:[],install:[],upgrade:[]};return _.each(e,function(e,i){e[l]===u?t.poweredOff.push(i):e[s]===p?t.install.push(i):n(e)&&t.upgrade.push(i)}),t}function n(e){var t=e[c]===m||e[c]===g||e[c]===h||e[c]===f;return e[s]===v&&t}function o(e){if(0!==e.length){var i={operation:"mountInstaller"};t.applyOnMultiEntity(e,P,i)}}function a(e,i,r){if(0!==e.length){var n;i===S?n={operation:"upgradeTools",upgradeOptions:r}:i===y&&(n={operation:"mountInstaller"}),t.applyOnMultiEntity(e,P,n)}}var s="toolsRunningStatus",c="toolsVersionStatus",l="runtime.powerState",d="managedByInfo",u="poweredOff",p="guestToolsNotRunning",v="guestToolsRunning",m="guestToolsNeedUpgrade",g="guestToolsSupportedOld",h="guestToolsTooOld",f="guestToolsBlacklisted",S="auto",y="interactive",P="com.vmware.vsphere.client.vm.tools.VmToolsInstallerSpec";return{getGroupedVms:i,installTools:o,upgradeTools:a}}angular.module("com.vmware.vsphere.client.vm").service("installUpgradeVmToolsService",e),e.$inject=["dataService","mutationService"]}();var h5_vm;!function(e){var t=function(){function e(e,t,i,r){this.defaultUriSchemeUtil=e,this.dataService=t,this.storageProfileService=i,this.i18nService=r}return e.prototype.isExistingDiskEncrytped=function(e){if(!e||!e.backing)return!1;var t=this.getCryptoKeyId(e.backing);return!this.isCryptoKeyEmpty(t)},e.prototype.isCryptoKeyEmpty=function(e){return!e||!e.keyId},e.prototype.getKmipClusters=function(t){var i=this.defaultUriSchemeUtil.getRootFolder(t);return this.dataService.getProperties(i,[e.PROPERTY_KMIP_CLUSTERS])},e.prototype.getDefaultKmipServerStatus=function(t,i){void 0===i&&(i=!1);var r=this.defaultUriSchemeUtil.getRootFolder(t);return this.dataService.getProperties(r,[e.PROPERTY_DEFAULT_KMIP_CLUSTER_STATUS],{skipErrorInterceptor:i})},e.prototype.getDiskEncryptionStatus=function(e,t,i){return!e&&t&&i?this.i18nService.getString("VmUi","DiskPage.diskWillBeEncrypted"):e&&t&&!i?this.i18nService.getString("VmUi","DiskPage.diskWillBeDecrypted"):e?this.i18nService.getString("VmUi","DiskPage.Encrypted"):void 0},e.prototype.isVmHomeEncrypted=function(e){return e.vmProfile?this.storageProfileService.isEncryptionStorageProfile(e.vmProfile[0]):!this.isCryptoKeyEmpty(e.config.keyId)},e.prototype.findEncryptionProfile=function(e){var t=this;return _.find(e,function(e){return t.storageProfileService.isEncryptionStorageProfile(e)})},e.prototype.isVmCryptPolicyDisabledForMigrateWizard=function(e,t){var n=this.defaultUriSchemeUtil.getPartsFromVsphereObjectId(e).serverGuid;t.isEncryptionOptionsDisabled=!1,this.getDefaultKmipServerStatus(n).then(function(e){if(e&&e.h5DefaultKmipClusterStatus&&e.h5DefaultKmipClusterStatus.noPermission)return void(t.isEncryptionOptionsDisabled=!1);var n=e&&e.h5DefaultKmipClusterStatus&&e.h5DefaultKmipClusterStatus.connectionStatus===i.CONNECTED,o=e&&e.h5DefaultKmipClusterStatus&&e.h5DefaultKmipClusterStatus.certificateStatus===r.EXPIRED;t.isEncryptionOptionsDisabled=!n||o})},e.prototype.getCryptoKeyId=function(e){return null===e?null:e.keyId||e.keyid?e.keyId||e.keyid:null},e.$inject=["defaultUriSchemeUtil","dataService","storageProfileService","i18nService"],e.PROPERTY_KMIP_CLUSTERS="kmipClusters",e.PROPERTY_DEFAULT_KMIP_CLUSTER_STATUS="h5DefaultKmipClusterStatus",e}();e.VmCryptUtilService=t,function(e){e[e.CONNECTED="CONNECTED"]="CONNECTED",e[e.NO_TRUST_CONNECTION="NO_TRUST_CONNECTION"]="NO_TRUST_CONNECTION",e[e.ERROR_RETRIEVING="ERROR_RETRIEVING"]="ERROR_RETRIEVING"}(e.ConnectionStatus||(e.ConnectionStatus={}));var i=e.ConnectionStatus;!function(e){e[e.GOOD="GOOD"]="GOOD",e[e.ABOUT_TO_EXPIRE="ABOUT_TO_EXPIRE"]="ABOUT_TO_EXPIRE",e[e.EXPIRED="EXPIRED"]="EXPIRED",e[e.NA="NA"]="NA",e[e.ERROR_RETRIEVING="ERROR_RETRIEVING"]="ERROR_RETRIEVING"}(e.CertStatus||(e.CertStatus={}));var r=e.CertStatus;angular.module("com.vmware.vsphere.client.vm").service("vmCryptUtilService",t)}(h5_vm||(h5_vm={})),function(){"use strict";function e(e,t,i,r){function n(){var t=e.modalOptions.dialogData.objectId,r="com.vmware.vsphere.client.vm.tools.VmToolsInstallerSpec",n={operation:"mountInstaller"};return i.apply(t,r,n),e.closeModal(),!0}var o=this,a=_.bind(t.getString,t,"VmUi");o.loading=!0,r.buildWarningMessage([e.modalOptions.dialogData.objectId]).then(function(e){o.loading=!1,o.header=a("VmToolsPopupForm.header"),o.managedByMessage=e,o.instruction=a("VmToolsPopupForm.singleInstall.instruction"),o.mount=a("VmToolsPopupForm.singleInstall.mount"),o.cancel=t.getString("Common","cancelButtonLabel")}),e.onSubmit=n}angular.module("com.vmware.vsphere.client.vm").controller("VmInstallToolsController",e),e.$inject=["$scope","i18nService","mutationService","managedByMessageBuilderService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){var t,i=e.modalOptions.dialogData.objectId,r="com.vmware.vsphere.client.vm.tools.VmToolsInstallerSpec";return u.toolsUpgradeValue===u.TOOLS_AUTO_UPGRADE?t={operation:"upgradeTools",upgradeOptions:u.toolsUpgradeAdvancedOptions}:u.toolsUpgradeValue===u.TOOLS_INTERACTIVE_UPGRADE&&(t={operation:"mountInstaller"}),n.apply(i,r,t),e.closeModal(),!0}function c(){u.loading=!0;var r=e.modalOptions.dialogData.objectId;o.getProperties(r,[l,d]).then(function(e){var n={};n[r]=e,a.buildWarningMessage([r],!1,n).then(function(r){u.loading=!1,u.managedByMessage=r,u.toolsAutoUpdateSupported=e[l],u.toolsAutoUpdateSupported||(u.toolsUpgradeValue=u.TOOLS_INTERACTIVE_UPGRADE);var n="";n=u.toolsUpgradeValue===u.TOOLS_AUTO_UPGRADE?"#toolsAutoUpgradeRadio":"#toolsInteractiveUpgradeRadio",i(function(){var e=t[0].querySelector(n);e&&e.focus()},0)})})}var l="capability.toolsAutoUpdateSupported",d="managedByInfo",u=this;u.TOOLS_INTERACTIVE_UPGRADE="toolsInteractiveUpgrade",u.TOOLS_AUTO_UPGRADE="toolsAutoUpgrade",u.toolsAutoUpdateSupported=!0,u.loading=!1,u.header=r.getString("VmUi","VmToolsPopupForm.header"),u.instruction=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.instruction"),u.cancelBtn=r.getString("Common","cancelButtonLabel"),u.interactiveLabel=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.interactive"),u.interactiveExplained=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.interactiveExplained"),u.autoLabel=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.auto"),u.autoExplained=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.autoExplained"),u.advancedOptionsLabel=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.advancedOptions"),u.upgradeLabel=r.getString("VmUi","VmToolsPopupForm.singleUpgrade.upgrade"),u.toolsUpgradeValue="toolsAutoUpgrade",u.toolsUpgradeAdvancedOptions="",u.isAutoUpgradeSelected=function(){return"toolsAutoUpgrade"===u.toolsUpgradeValue},e.onSubmit=s,c()}angular.module("com.vmware.vsphere.client.vm").controller("VmUpgradeToolsController",e),e.$inject=["$scope","$element","$timeout","i18nService","mutationService","dataService","managedByMessageBuilderService"]}(),angular.module("com.vmware.vsphere.client.vm").run(["$templateCache",function(e){e.put("vm-ui/resources/vm/views/summary/vm-hardware-summary-cdrom.html",'<clr-stack-block [(clr-sb-expanded)]="$ctrl.expanded"\n                 [(clr-sb-expandable)]="$ctrl.isDeviceConnected()"\n                 class="vm-hardware-summary-cdrom">\n   <clr-stack-label ng-attr-title="{{ $ctrl.label }}">\n      <span>{{ $ctrl.label }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content class="device-status">\n      <span ng-if="!$ctrl.expanded">\n         {{$ctrl.getDeviceConnected()}}\n      </span>\n\n      <div\n         class="dropdown bottom-right vm-hardware-summary-cdrom-dropdown pull-right"\n         ng-if="$ctrl.shouldShowDropdown()"\n         ng-class="{\'open\': isOpen}" ng-click="isOpen = !isOpen">\n\n         <button type="button" class="dropdown-toggle">\n            <clr-icon shape="connect" size="18"\n                      ng-if="$ctrl.isDeviceConnected()"></clr-icon>\n            <clr-icon shape="disconnect" size="18"\n                      ng-if="!$ctrl.isDeviceConnected()"></clr-icon>\n            <clr-icon shape="caret down"></clr-icon>\n         </button>\n         <div class="dropdown-menu">\n            <button type="button" class="dropdown-item"\n                    test-id="dropdown-item-disconnect"\n                    ng-class="{\'disabled\': $ctrl.disconnectDeviceDisabled}"\n                    ng-if="$ctrl.device.connectable.connected"\n                    ng-disabled="!$ctrl.hasDeviceConnectionPriv"\n                    ng-click="$ctrl.disconnectCdRom()">{{$ctrl.i18n(\'VmUi\',\n               \'DeviceConnection.manager.disconnect\')}}\n            </button>\n            <button type="button" class="dropdown-item"\n                    test-id="dropdown-item-host-device"\n                    ng-class="{\'disabled\': $ctrl.connectHostDeviceDisabled}"\n                    ng-if="!$ctrl.isDeviceConnected()"\n                    ng-disabled="!$ctrl.hasPermission()"\n                    ng-click="$ctrl.connectToHostCdDevice()">\n               {{$ctrl.i18n(\'VmUi\',\n               \'DeviceConnection.manager.connect_host_cd_device_short\')}}\n            </button>\n            <button type="button" class="dropdown-item"\n                    test-id="dropdown-item-datastore-iso"\n                    ng-if="!$ctrl.isDeviceConnected()"\n                    ng-disabled="!$ctrl.hasPermission()"\n                    ng-click="$ctrl.browseForDatastoreIso()">\n               {{$ctrl.i18n(\'VmUi\',\n               \'DeviceConnection.manager.connect_host_cd_image_short\')}}\n            </button>\n            <button type="button" class="dropdown-item"\n                    test-id="dropdown-item-cl-iso"\n                    ng-if="!$ctrl.isDeviceConnected()"\n                    ng-disabled="!$ctrl.hasPermissionAndConfigForCL()"\n                    ng-click="$ctrl.browseForContentLibraryIso()">\n               {{$ctrl.i18n(\'VmUi\',\n               \'DeviceConnection.manager.connect_host_cliso_image_short\')}}\n            </button>\n         </div>\n      </div>\n   </clr-stack-content>\n\n   <!--Connected to row-->\n   <clr-stack-block ng-if="$ctrl.isDeviceConnected()">\n      <clr-stack-label\n         ng-attr-title="{{ $ctrl.i18n(\'VmUi\', \'DeviceConnection.manager.info.connected_to\') }}">\n         {{ $ctrl.i18n(\'VmUi\', \'DeviceConnection.manager.info.connected_to\') }}\n      </clr-stack-label>\n      <clr-stack-content class="device-connected-to">{{$ctrl.getConnectedTo()}}</clr-stack-content>\n   </clr-stack-block>\n\n   <!--Device row-->\n   <clr-stack-block ng-if="$ctrl.isDeviceConnected()">\n      <clr-stack-label\n         ng-attr-title="{{ $ctrl.getDeviceOrFile().title }}">{{ $ctrl.getDeviceOrFile().title }}</clr-stack-label>\n      <clr-stack-content class="device-file-or-device">{{$ctrl.getDeviceOrFile().value}}</clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/summary/vm-hardware-summary-encryption.html",'<clr-stack-block>\n   <clr-stack-label ng-attr-title="$ctrl.label">\n      <span>{{ $ctrl.label }}</span>\n   </clr-stack-label>\n   <clr-stack-content>\n      <div>{{ $ctrl.vmConfigContent }}</div>\n      <div>{{ $ctrl.disksContent }}</div>\n   </clr-stack-content>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/summary/vm-hardware-summary-floppy.html",'<clr-stack-block [(clr-sb-expanded)]="expanded"\n                 [(clr-sb-expandable)]="$ctrl.isDeviceConnected()">\n   <clr-stack-label ng-attr-title="{{ $ctrl.label }}">\n      <span>{{ $ctrl.label }}</span>\n   </clr-stack-label>\n\n   <clr-stack-content class="device-status">\n      <span ng-if="!expanded">\n         {{$ctrl.getDeviceConnected()}}\n      </span>\n   </clr-stack-content>\n\n   <!--Connected to row-->\n   <clr-stack-block ng-if="$ctrl.isDeviceConnected()">\n      <clr-stack-label\n         ng-attr-title="{{ $ctrl.i18n(\'VmUi\', \'DeviceConnection.manager.info.connected_to\') }}">\n         {{ $ctrl.i18n(\'VmUi\', \'DeviceConnection.manager.info.connected_to\') }}\n      </clr-stack-label>\n      <clr-stack-content class="device-connected-to">{{$ctrl.getConnectedTo()}}</clr-stack-content>\n   </clr-stack-block>\n\n   <!--Device row-->\n   <clr-stack-block ng-if="$ctrl.isDeviceConnected()">\n      <clr-stack-label\n         ng-attr-title="{{$ctrl.getDeviceOrFile().title}}">{{$ctrl.getDeviceOrFile().title}}</clr-stack-label>\n      <clr-stack-content class="device-file-or-device">{{$ctrl.getDeviceOrFile().value}}</clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummary.html",'<div ng-controller="VmHardwareSummaryController as ctrl">\n   <clr-stack-view class="clr-component"\n                   ng-if="ctrl.hardwareViewData"\n                   vx-refreshable watch-objects=\'{{ctrl.watchObjects}}\'\n                   live-refresh-properties="ctrl.liveRefreshProperties"\n                   refresh=\'ctrl.getVmHardwareData()\'>\n\n      <vm-hardware-summary-encryption ng-if="ctrl.isEncryptionSummaryVisible"\n               devices="ctrl.devices">\n      </vm-hardware-summary-encryption>\n\n      <vm-hardware-summary-cpu ctrl="ctrl">\n      </vm-hardware-summary-cpu>\n\n      <vm-hardware-summary-memory ctrl="ctrl">\n      </vm-hardware-summary-memory>\n\n      <vm-hardware-summary-pmem ng-if="ctrl.isPmemSummaryVisible"\n               devices="ctrl.devices">\n      </vm-hardware-summary-pmem>\n\n      <vm-hardware-summary-virtual-disk\n               ctrl="ctrl"\n               class="vm-hardware-summary-virtual-disk"\n               device="device"\n               ng-repeat="device in ctrl.displayHardDiskDevices track by device.key">\n      </vm-hardware-summary-virtual-disk>\n\n      <vm-hardware-summary-virtual-disk\n         ctrl="ctrl"\n         class="vm-hardware-summary-virtual-disk"\n         device="device"\n         ng-repeat="device in ctrl.displayRdmDiskDevices track by device.key">\n      </vm-hardware-summary-virtual-disk>\n\n      <clr-stack-block ng-if="ctrl.shouldGroupHardDisks">\n         <clr-stack-label>\n            {{i18n(\'VmUi\', \'summaryView.groupedDisks.label\')}}\n         </clr-stack-label>\n         <clr-stack-content>\n            <a href="javascript:void(0);" ng-click="ctrl.invokeEditAction($event)">\n               {{ctrl.getGroupedDiskText()}}\n            </a>\n         </clr-stack-content>\n      </clr-stack-block>\n\n      <vm-hardware-summary-network\n               ctrl="ctrl"\n               device="device"\n               ng-repeat="device in ctrl.devices[\'VirtualEthernetCard\'] track by device.key">\n      </vm-hardware-summary-network>\n\n      <vm-hardware-summary-cdrom\n               ctrl="ctrl"\n               device="device"\n               ng-repeat="device in ctrl.devices[\'VirtualCdrom\'] track by device.key">\n      </vm-hardware-summary-cdrom>\n\n      <vm-hardware-summary-floppy\n         ctrl="ctrl"\n         device="device"\n         ng-repeat="device in ctrl.devices[\'VirtualFloppy\'] track by device.key">\n      </vm-hardware-summary-floppy>\n\n      <vm-hardware-summary-video-card\n         device="device"\n         ng-repeat="device in ctrl.devices[\'VirtualVideoCard\'] track by device.key">\n      </vm-hardware-summary-video-card>\n\n      <vm-hardware-summary-nvdimm\n         device="device"\n         ng-repeat="device in ctrl.devices[\'VirtualNVDIMM\'] track by device.key">\n      </vm-hardware-summary-nvdimm>\n\n      <vm-tpm ng-if="ctrl.tpmDevice" label="ctrl.tpmDevice.deviceInfo.summary"\n              vm-id="ctrl.objectId"></vm-tpm>\n\n      <clr-stack-block\n              ng-repeat="device in ctrl.devices[\'VirtualDevice\'] track by device.key">\n         <clr-stack-label ng-attr-title="{{ device.deviceInfo.label }}">\n               {{ device.deviceInfo.label }}\n         </clr-stack-label>\n         <clr-stack-content>\n               {{ device.deviceInfo.summary }}\n         </clr-stack-content>\n      </clr-stack-block>\n\n      <vm-hardware-summary-other ctrl="ctrl" devices="ctrl.devices">\n      </vm-hardware-summary-other>\n\n      <vm-hardware-summary-hw-version ctrl="ctrl" ng-if="!ctrl.isVmTemplateCLitem">\n      </vm-hardware-summary-hw-version>\n\n   </clr-stack-view>\n</div>\n'),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryCpu.html","<clr-stack-block class=\"numCpu\" [(clr-sb-expanded)]=\"expanded\">\n   <clr-stack-label ng-attr-title=\"{{i18n('VmUi', 'VmCpu.Title')}}\">\n      {{i18n('VmUi', 'VmCpu.Title')}}\n   </clr-stack-label>\n\n   <clr-stack-content class=\"value\">\n      <span ng-if=\"!expanded\">\n         {{i18n('VmUi', 'numCpu', ctrl.hardwareViewData.hardware.numCPU)}}\n      </span>\n   </clr-stack-content>\n\n   <clr-stack-block ng-if=\"!isTemplate\" class=\"Utilization\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelUtilization') }}\">{{ fieldLabel('labelUtilization') }}</clr-stack-label>\n      <clr-stack-content>{{ fieldValue['Utilization'] }}</clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if=\"isTemplate\" class=\"ConfiguredCPU\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelConfigured') }}\">{{ fieldLabel('labelConfigured') }}</clr-stack-label>\n      <clr-stack-content>{{ fieldValue['ConfiguredCPU'] }}</clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"Shares\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelShares') }}\">{{ fieldLabel('labelShares') }}</clr-stack-label>\n      <clr-stack-content>{{ fieldValue['Shares'] }}</clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"Reservation\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelReservation') }}\">{{ fieldLabel('labelReservation') }}</clr-stack-label>\n      <clr-stack-content>\n         <div class=\"reservation-value\">{{ fieldValue['Reservation'] }}</div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"Limit\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelLimit') }}\">{{ fieldLabel('labelLimit') }}</clr-stack-label>\n      <clr-stack-content>\n         <div>{{ fieldValue['Limit'] }}</div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if=\"!ctrl.isVmTemplateCLitem\" class=\"NestedHV\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelNestedHV') }}\">{{ fieldLabel('labelNestedHV') }}</clr-stack-label>\n      <clr-stack-content>{{ fieldValue['NestedHV'] }}</clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if=\"!ctrl.isVmTemplateCLitem\" class=\"ioMmu\">\n      <clr-stack-label>{{ fieldLabel('labelIoMmuHV') }}</clr-stack-label>\n      <clr-stack-content>{{ fieldValue['IommuHV'] }}</clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block ng-if=\"!ctrl.isVmTemplateCLitem\" class=\"PerfCounters\">\n      <clr-stack-label ng-attr-title=\"{{ fieldLabel('labelVPMCEnabled') }}\">{{ fieldLabel('labelVPMCEnabled') }}</clr-stack-label>\n      <clr-stack-content>{{ fieldValue['PerfCounters'] }}</clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n"),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryHwVersion.html",'<clr-stack-block class="hwversion">\n   <clr-stack-label class="value" ng-attr-title="{{ vmHwVersionLabel }}">\n      <span>{{ vmHwVersionLabel }}</span>\n   </clr-stack-label>\n   <clr-stack-content class="value">\n      <div>{{ vmHwVersion }}</div>\n      <div ng-if="hasScheduledUpgrade">\n         <div>{{scheduledUpgradeStatus}}</div>\n         <div class="hw-upgrade-error" title="{{scheduledUpgradeError}}">\n            {{scheduledUpgradeError}}\n         </div>\n      </div>\n   </clr-stack-content>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryMemory.html",'<clr-stack-block class="memory" [(clr-sb-expanded)]="expanded">\n    <clr-stack-label ng-attr-title="{{i18n(\'VmUi\', \'VmMemory.Title\')}}">\n        {{i18n(\'VmUi\', \'VmMemory.Title\')}}\n    </clr-stack-label>\n\n    <clr-stack-content class="memory-heading">\n       <span ng-if="!expanded">\n          <div ng-if="ctrl.hardwareViewData.hardware.memoryMB && !expanded && !isTemplate">\n             <vx-resource-meter percentage="memoryUtilizationPercentage" orientation="vertical"></vx-resource-meter>\n             {{ fieldValue[\'Utilization\'] }}\n          </div>\n          <div ng-if="!expanded && isTemplate">\n             {{ fieldValue[\'ConfiguredMemory\'] }}\n          </div>\n       </span>\n    </clr-stack-content>\n\n    <clr-stack-block ng-if="!isTemplate" class="Utilization">\n        <clr-stack-label ng-attr-title="{{ fieldLabel(\'Utilization\') }}">\n            {{ fieldLabel(\'Utilization\') }}\n        </clr-stack-label>\n        <clr-stack-content>\n           <vx-resource-meter percentage="memoryUtilizationPercentage" orientation="vertical"></vx-resource-meter>\n           {{ fieldValue[\'Utilization\'] }}\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block ng-if="isTemplate" class="ConfiguredMemory">\n        <clr-stack-label ng-attr-title="{{ fieldLabel(\'Configured\') }}" ng-bind="fieldLabel(\'Configured\')"></clr-stack-label>\n        <clr-stack-content>{{ fieldValue[\'ConfiguredMemory\'] }}</clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block class="Shares">\n        <clr-stack-label ng-attr-title="{{ fieldLabel(\'Shares\') }}" ng-bind="fieldLabel(\'Shares\')"></clr-stack-label>\n        <clr-stack-content ng-bind="fieldValue[\'Shares\']"></clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block class="Reservation">\n        <clr-stack-label ng-attr-title="{{ fieldLabel(\'Reservation\') }}" ng-bind="fieldLabel(\'Reservation\')"></clr-stack-label>\n        <clr-stack-content ng-bind="fieldValue[\'Reservation\']"></clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block class="Limit">\n        <clr-stack-label ng-attr-title="{{fieldLabel(\'Limit\')}}" ng-bind="fieldLabel(\'Limit\')"></clr-stack-label>\n        <clr-stack-content ng-bind="fieldValue[\'Limit\']"></clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block ng-if="!isTemplate" class="HostOverhead">\n        <clr-stack-label ng-attr-title="{{ fieldLabel(\'HostOverhead\') }}" ng-bind="fieldLabel(\'HostOverhead\')"></clr-stack-label>\n        <clr-stack-content class="stack-view-cell" ng-bind="fieldValue[\'HostOverhead\']"></clr-stack-content>\n    </clr-stack-block>\n\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryNetwork.html","<clr-stack-block [(clr-sb-expanded)]=\"expanded\">\n   <clr-stack-label ng-attr-title=\"{{device.deviceInfo.label}}\">\n       {{device.deviceInfo.label}}\n   </clr-stack-label>\n   <clr-stack-content>\n      <div ng-if=\"!expanded && !ctrl.isVmTemplateCLitem\">\n         <a ng-click=\"_navigateToObject(networkRef)\">\n            {{networkName}}</a> {{labelForConnectionState()}}\n      </div>\n      <div ng-if=\"!expanded && ctrl.isVmTemplateCLitem\">\n            {{networkName}}\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block>\n      <clr-stack-label ng-attr-title=\"{{i18n('VmUi', 'VmNetView.adapterType')}}\">\n          {{i18n('VmUi', 'VmNetView.adapterType')}}\n      </clr-stack-label>\n\n      <clr-stack-content ng-bind=\"ethernetCardLabel\">\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block>\n      <clr-stack-label ng-attr-title=\"{{i18n('VmUi', 'VmNetView.macAddress')}}\">\n         {{i18n('VmUi', 'VmNetView.macAddress')}}\n      </clr-stack-label>\n\n      <clr-stack-content ng-bind=\"device.macAddress\">\n      </clr-stack-content>\n   </clr-stack-block>\n\n    <clr-stack-block ng-if=\"!isTemplate\">\n        <clr-stack-label ng-attr-title=\"{{i18n('VmUi', 'VmNetView.directPath')}}\">\n            {{i18n('VmUi', 'VmNetView.directPath')}}\n        </clr-stack-label>\n\n        <clr-stack-content>\n            {{i18n('NetworkUi', directpathEnabled ? 'DirectPath.status.active' : 'DirectPath.status.inactive')}}\n        </clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block>\n        <clr-stack-label ng-attr-title=\"{{i18n('VmUi', 'VmNetView.network')}}\">\n            {{i18n('VmUi', 'VmNetView.network')}}\n        </clr-stack-label>\n\n        <clr-stack-content ng-if=\"!ctrl.isVmTemplateCLitem\">\n            <a ng-click=\"_navigateToObject(networkRef)\">\n                {{networkName}}</a> {{labelForConnectionState()}}\n        </clr-stack-content>\n\n       <clr-stack-content ng-if=\"ctrl.isVmTemplateCLitem\">\n             {{networkName}}\n       </clr-stack-content>\n    </clr-stack-block>\n\n    <clr-stack-block ng-if=\"ctrl.isVmTemplateCLitem\">\n       <clr-stack-label ng-attr-title=\"{{i18n('VmUi', 'VmNetView.connectOnStart')}}\">\n         {{i18n('VmUi', 'VmNetView.connectOnStart')}}\n       </clr-stack-label>\n\n       <clr-stack-content>\n          {{i18n('VmUi', connectOnStart ? 'yes' : 'no')}}\n       </clr-stack-content>\n    </clr-stack-block>\n</clr-stack-block>\n"),
e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryNvdimm.html",'<clr-stack-block>\n   <clr-stack-label ng-attr-title="$ctrl.label">\n      <span>{{ $ctrl.label }}</span>\n   </clr-stack-label>\n   <clr-stack-content>\n      {{ $ctrl.content }}\n   </clr-stack-content>\n</clr-stack-block>\n'),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryOther.html","<clr-stack-block [(clr-sb-expanded)]=\"expanded\">\n   <clr-stack-label ng-attr-title=\"{{ i18n('VmUi', 'VmHardwareView.OtherHardware') }}\">\n      {{ i18n('VmUi', 'VmHardwareView.OtherHardware') }}\n   </clr-stack-label>\n\n   <clr-stack-content>\n      <div ng-if=\"!expanded\">\n         {{ i18n('VmUi', 'VmHardwareView.AdditionalHardware') }}\n      </div>\n   </clr-stack-content>\n\n   <clr-stack-block class=\"controllers\">\n      <clr-stack-label ng-attr-title=\"{{ i18n('VmUi', 'VmOtherHardwareView.Controllers') }}\"\n        ng-bind=\"i18n('VmUi', 'VmOtherHardwareView.Controllers')\"></clr-stack-label>\n      <clr-stack-content>\n         <div class=\"controller vm-hardware-generic\"\n              ng-repeat=\"device in devices['VirtualController'] track by device.key\"\n              ng-bind=\"getSummaryText(device, 'VirtualController')\">\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"scsi-adapters\">\n      <clr-stack-label ng-attr-title=\"{{ i18n('VmUi', 'VmOtherHardwareView.ScsiAdapters') }}\"\n        ng-bind=\"i18n('VmUi', 'VmOtherHardwareView.ScsiAdapters')\"></clr-stack-label>\n      <clr-stack-content>\n         <div class=\"scsi-adapter vm-hardware-generic\"\n              ng-repeat=\"device in devices['VirtualSCSIController'] track by device.key\"\n              ng-bind=\"getSummaryText(device, 'VirtualSCSIController')\">\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"input-devices\" ng-if=\"!ctrl.isVmTemplateCLitem\">\n      <clr-stack-label ng-attr-title=\"{{ i18n('VmUi', 'VmOtherHardwareView.InputDevices') }}\"\n        ng-bind=\"i18n('VmUi', 'VmOtherHardwareView.InputDevices')\"></clr-stack-label>\n      <clr-stack-content>\n         <div class=\"input-device vm-hardware-generic\"\n              ng-repeat=\"device in devices['InputDevice'] track by device.key\"\n              ng-bind=\"getSummaryText(device, 'InputDevice')\">\n         </div>\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n"),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryPmem.html",'<clr-stack-block>\n   <clr-stack-label ng-attr-title="$ctrl.label">\n      <span>{{ $ctrl.label }}</span>\n   </clr-stack-label>\n   <clr-stack-content>\n      <span\n            aria-label="{{ $ctrl.label + \' - \' + $ctrl.content }}">{{ $ctrl.content }}</span>\n   </clr-stack-content>\n</clr-stack-block>\n\n\n'),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryVideoCard.html","<clr-stack-block class=\"videocard\" [(clr-sb-expanded)]=\"expanded\">\n   <clr-stack-label ng-attr-title=\"{{ $ctrl.i18n('VmUi', 'VideoCardPage.Title') }}\">\n      {{ $ctrl.i18n('VmUi', 'VideoCardPage.Title') }}\n   </clr-stack-label>\n\n   <clr-stack-content class=\"videocard__value\">\n      <span ng-if=\"!expanded\">\n         {{ $ctrl.device.videoRamSizeInKB | bytes: 'KB'}}\n      </span>\n   </clr-stack-content>\n\n   <clr-stack-block class=\"videocard__memory\">\n      <clr-stack-label ng-attr-title=\"{{ $ctrl.i18n('VmUi', 'VideoCardPage.TotalVideoMemory') }}\">\n         {{ $ctrl.i18n('VmUi', 'VideoCardPage.TotalVideoMemory') }}\n      </clr-stack-label>\n      <clr-stack-content>\n         {{ $ctrl.device.videoRamSizeInKB | bytes: 'KB'}}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"videocard__display\">\n      <clr-stack-label ng-attr-title=\"{{ $ctrl.i18n('VmUi', 'VideoCardPage.NumberOfDisplays') }}\">\n         {{ $ctrl.i18n('VmUi', 'VideoCardPage.NumberOfDisplays') }}\n      </clr-stack-label>\n      <clr-stack-content>\n         {{ $ctrl.device.numDisplays }}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"videocard__3dgraphics\">\n      <clr-stack-label ng-attr-title=\"{{ $ctrl.i18n('VmUi', 'VideoCardPage.3DGraphics') }}\">\n         {{ $ctrl.i18n('VmUi', 'VideoCardPage.3DGraphics') }}\n      </clr-stack-label>\n      <clr-stack-content>\n         {{ $ctrl.device.enable3DSupport | enabled }}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"videocard__3drenderer\">\n      <clr-stack-label ng-attr-title=\"{{ $ctrl.i18n('VmUi', 'VideoCardPage.3DRenderer') }}\">\n         {{ $ctrl.i18n('VmUi', 'VideoCardPage.3DRenderer') }}\n      </clr-stack-label>\n      <clr-stack-content>\n         {{ $ctrl.device.use3dRenderer | render3d }}\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class=\"videocard__3dmemory\">\n      <clr-stack-label ng-attr-title=\"{{ $ctrl.i18n('VmUi', 'VideoCardPage.3DMemory') }}\">\n         {{ $ctrl.i18n('VmUi', 'VideoCardPage.3DMemory') }}\n      </clr-stack-label>\n      <clr-stack-content>\n         {{ $ctrl.device.graphicsMemorySizeInKB | bytes: 'KB' }}\n      </clr-stack-content>\n   </clr-stack-block>\n\n</clr-stack-block>\n"),e.put("vm-ui/resources/vm/views/summary/vmHardwareSummaryVirtualDisk.html",'<clr-stack-block ng-form name="vmHardwareVirtualDisk{{formKey}}"\n                 [(clr-sb-expanded)]="expanded">\n   <clr-stack-label ng-attr-title="{{deviceLabel}}">\n      {{deviceLabel}}\n   </clr-stack-label>\n   <clr-stack-content>\n      <div ng-if="!expanded" ng-bind="device.capacityInKB | bytes:\'KB\'"/>\n   </clr-stack-content>\n\n   <clr-stack-block class="capacity">\n      <clr-stack-label\n         ng-attr-title="{{ i18n(\'VmUi\', \'VmDiskView.capacity\') }}"\n         ng-bind="i18n(\'VmUi\', \'VmDiskView.capacity\')"></clr-stack-label>\n      <clr-stack-content\n         ng-bind="device.capacityInKB | bytes:\'KB\'"></clr-stack-content>\n   </clr-stack-block>\n\n\n   <clr-stack-block ng-if="!ctrl.isVmTemplateCLitem && !isPmemDisk">\n      <clr-stack-label\n         ng-attr-title="{{ i18n(\'VmUi\', \'VmDiskView.diskType\') }}"\n         ng-bind="i18n(\'VmUi\', \'VmDiskView.diskType\')"></clr-stack-label>\n      <clr-stack-content>\n         <vm-hardware-virtual-disk-type\n            device-backing="device.backing"></vm-hardware-virtual-disk-type>\n      </clr-stack-content>\n   </clr-stack-block>\n\n   <clr-stack-block class="location" ng-if="!ctrl.isVmTemplateCLitem">\n      <clr-stack-label\n         ng-attr-title="{{ i18n(\'VmUi\', \'VmDiskView.location\') }}"\n         ng-bind="i18n(\'VmUi\', \'VmDiskView.location\')"></clr-stack-label>\n      <clr-stack-content>\n         <a ng-click="_navigateToObject(datastoreRef)"\n               ng-class="{\'virtual-disk-link-not-clickable\': isPmemDisk}">\n            {{datastoreInfo.name}}</a> {{i18n(\'VmUi\',\n         \'VmDiskView.datastoreFreeSpace\', (datastoreInfo.freeSpaceInBytes |\n         bytes:\'B\'))}}\n      </clr-stack-content>\n   </clr-stack-block>\n</clr-stack-block>\n\n'),e.put("vm-ui/resources/vm/views/summary/vmSummaryImage.html",'<div class="summary-image-block" ng-if="summaryData.name" vx-refreshable\n     refresh="getVmScreenshot()" refresh-event-types="dataRefreshInvocationEvent">\n   <div class="summary-image-state-label" ng-if="stateLabel">\n      <div>\n         <div>{{stateLabel}}</div>\n         <div ng-if="summaryData.isVmLocked">\n            {{::i18n(\'VmUi\', \'summaryView.stateLabel.locked.suffix\')}}\n         </div>\n      </div>\n   </div>\n   <div ng-if="!stateLabel">\n      <img ng-src="{{imageUrl}}" ng-if="!imageBytes && !screenshotInProgress" alt="">\n      <div class="summary-image-state-label flex-row spinner-body"\n           ng-show="!imageBytes && screenshotInProgress">\n         <span class="spinner spinner-inline"></span>\n      </div>\n      <div class="summary-image-thumbnail-container"\n           ng-if="imageBytes"\n           ng-click="itemClicked(entityReference)">\n         <img class="summary-image-thumbnail"\n              ng-src="data:image/png;base64,{{imageBytes}}"\n              alt="">\n         <span class="summary-image-caption">\n                <span ng-class="imageCaptionIcon"></span>\n                {{imageCaption}}\n             </span>\n      </div>\n   </div>\n\n   <div ng-if="!summaryData.isTemplate && !summaryData.isVmLocked" class="launch-web-console">\n      <div>\n         <div class="launch-web-console-text-disabled"\n              ng-if="!isWebConsoleAvailable">\n            {{i18n(\'VmUi\', \'summaryView.launchWebConsole\')}}\n         </div>\n         <a class="launch-web-console-text" href="" ng-click="itemClicked(entityReference)"\n            ng-if="isWebConsoleAvailable"\n            target="_blank">\n            {{i18n(\'VmUi\', \'summaryView.launchWebConsole\')}}</a>\n      </div>\n   </div>\n   <div ng-if="!summaryData.isTemplate && !summaryData.isVmLocked">\n         <span class="launch-remote-console">\n            <a class="launch-remote-console-text" href="" ng-click="launchVMRCConsole()" target="_blank"\n               vui-sign-post=\'launchVmrcInfoSignPostParams\'  ng-class="{\'disabled-link\': !launchConsoleActionEval.available}">{{i18n(\'VmUi\', \'summaryView.launchVMRCConsole\')}}</a>\n            <a class="launch-remote-console-icon" vui-sign-post=\'vmrcInfoSignPostParams\'\n               href="" role="button">\n               <img ng-src="{{i18n(\'CommonImages\', \'info\')}}" alt="{{vmrcInfoSignPostParams.title}}">\n            </a>\n         </span>\n   </div>\n   <div ng-if="!summaryData.isTemplate && summaryData.isVmLocked && featureFlagsService.VMcrypt2Enabled()" class="unlock-vm">\n      <a href="" ng-click="unlockVmClicked(entityReference)">\n          {{::i18n(\'VmUi\', \'summaryView.unlockVm.label\')}}\n      </a>\n      <vsc-sign-post [sign-post-position]="\'right\'"\n                     [sign-post-header]="::i18n(\'VmUi\', \'summaryView.unlockVm.signpost.title\')"\n                     [sign-post-content-template]="signPostContentTemplate">\n      </vsc-sign-post>\n   </div>\n</div>\n'),e.put("vm-ui/resources/vm/views/summary/vmSummaryImageWrapper.html","<vm-summary-image></vm-summary-image>"),e.put("vm-ui/resources/vm/views/summary/vmTpm/vm-tpm.html","<clr-stack-block [(clr-sb-expanded)]=\"expanded\">\n   <clr-stack-label>\n      {{ $ctrl.label }}\n   </clr-stack-label>\n   <clr-stack-content>\n      {{$ctrl.i18n('VmUi', 'VmDeviceManager.TPMPresent')}}\n   </clr-stack-content>\n\n   <clr-stack-block ng-repeat=\"tpmCertificate in $ctrl.tpmCertificates\">\n      <clr-stack-label>\n         {{ tpmCertificate.algorithmName }}-{{tpmCertificate.publicKeyAlgorithmName}}\n      </clr-stack-label>\n      <clr-stack-content>{{ tpmCertificate.issuerNameCN }}</clr-stack-content>\n   </clr-stack-block>\n   <clr-stack-block><a\n      data-test-id=\"tpm-manage-certificates\"\n      ng-click=\"$ctrl.navigateToConfigureTab()\">\n      {{$ctrl.i18n('VmUi','VmDeviceManager.ManageCertificates')}}</a>\n   </clr-stack-block>\n\n</clr-stack-block>\n\n\n"),e.put("vm-ui/resources/vm/views/summary/modals/select-default-console/SelectConsoleDialog.html",'<!-- Change Date Time Format Dialog -->\n<form class="compact select-default-console"\n      ng-controller="SelectConsoleDialogController as ctrl">\n   <div class="radio">\n      <input type="radio"\n             name="console-web"\n             id="console-web"\n             value="WEB_CONSOLE"\n             ng-model="ctrl.currentlySelectedFormat">\n      <label for="console-web">\n         {{i18n(\'Common\', \'changeDefaultConsole.web\')}}\n      </label>\n   </div>\n   <div class="radio">\n      <input type="radio"\n             name="console-vmrc"\n             id="console-vmrc"\n             value="VMRC_CONSOLE"\n             ng-model="ctrl.currentlySelectedFormat">\n      <label for="console-vmrc">\n         {{i18n(\'Common\', \'changeDefaultConsole.vmrc\')}}\n      </label>\n   </div>\n   <div class="checkbox">\n      <input type="checkbox" id="remember" ng-model="shouldRemember">\n      <label for="remember">\n         {{i18n(\'VmUi\', \'launchConsoleModal.remember\')}}</label>\n   </div>\n</form>\n\n\n'),e.put("vm-ui/resources/vm/views/summary/modals/select-host/select-host.html",'<form name="host-select-form">\n      <div class="select" ng-class="{\'disabled\': modalOptions.dialogData.isLoading}">\n         <select name="host-select" id="host-select"\n                 ng-change="modalOptions.dialogData.onHostChange(modalOptions.dialogData.selectedHost, modalOptions)"\n                 ng-options="option.name for option in modalOptions.dialogData.hosts"\n                 ng-model="modalOptions.dialogData.selectedHost"\n                 ng-disabled="modalOptions.dialogData.isSelectorDisabled()">\n            <option value="" ng-if="!modalOptions.dialogData.hosts.length">\n               {{modalOptions.dialogData.i18nService.getString(\'VmUi\',\n               \'DeviceConnection.select_device.no_host_device_available\')}}\n            </option>\n         </select>\n      </div>\n</form>'),e.put("vm-ui/resources/vm/views/summary/modals/select-iso/select-iso.html",'<div>\n   <datastore-file-browser\n      object-id="modalOptions.dialogData.datastoreBrowserId"\n      datastore-ids="modalOptions.dialogData.datastoreIds"\n      initial-file-query-type="modalOptions.dialogData.initialFileQueryType"\n      filter-file-query-types="modalOptions.dialogData.filterFileQueryTypes"\n      show-vm-images-folder="modalOptions.dialogData.showVmImagesFolder"\n      selected-file-changed="modalOptions.dialogData.onIsoChange(selectedFile, modalOptions)">\n   </datastore-file-browser>\n</div>\n')}]),h5=h5||{},h5.host={angularModule:angular.module("com.vmware.vsphere.client.host",["com.vmware.platform.ui","com.vmware.vsphere.client.commonModule","com.vmware.vsphere.client.licenseLibUi"])},angular.module("com.vmware.vsphere.client.host").run(["columnRenderersRegistry","templateHelperService",function(e,t){var i={"cluster-link":function(t,i,r){var n=e.getColumnRenderer("object-link");return n([t[0],t[1],"vsphere-icon-cluster"],i,r)}},r="<span class='object' title='{{title}}'><i class='{{icon}}'></i>{{text}}</span>",n=t.getHtmlEscapingTemplateRenderFunction(r),o={"host-ha-state":function(e,t){var i="",r=t[e[0]];switch(t[e[1]]){case"master":case"connectedToMaster":i="vsphere-icon-status-ok";break;case"uninitialized":case"election":i="vsphere-icon-status-warning";break;case"fdmUnreachable":case"hostDown":case"initializationError":case"networkIsolated":case"networkPartitionedFromMaster":case"uninitializationError":i="vsphere-icon-status-error";break;default:i="vsphere-icon-status-unknown"}return n({title:r,icon:i,text:r})}},a={"host-version":function(e,t){return null===t[e[0]]||null===t[e[1]]?"":"embeddedEsx"!==t[e[0]]?"":t[e[1]]}};e.registerColumnRenderers(i),e.registerColumnRenderers(o),e.registerColumnRenderers(a)}]).run(["$rootScope","hciCapabilityService","mutationService","actionDialogService","actionConfirmationService","removeHostAction","columnRenderersRegistry","i18nService","addHostWizardService","clarityModalService","refreshCertificateService","hostAuthService","securityProfileDialogService","hostConnectionService","suppressWarningSettingService","moveHostToService","assignLicenseService","vscExportWizardLauncherService","addHostsActionWizardService","vuiUtils","vxGridSettingsService","suppressWarningSettingConstants",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S,y,P,C){h5.actions["vsphere.core.host.actions.editPowerConfigHardware"]=function(e,t){var i={title:s.getString("HostUi","powerPolicy.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/EditPowerConfigHardware.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editPowerConfigSoftware"]=function(e,t){var i={title:s.getString("HostUi","powerConfigSoftware.powerManagementSettings"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/editPowerConfigSoftware.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editAgentVmSettings"]=function(e,t){var i={title:s.getString("HostUi","settings.agentVm.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/EditAgentVmSettings.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.enterMaintenanceMode"]=function(e,t){var i={title:s.getString("HostUi","actionEnterMaintenanceLabel"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/maintenanceMode/MaintenanceModeConfirmation.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.exitMaintenanceMode"]=function(e,t){var r={maintenanceOpType:"exit"};i.applyOnMultiEntity(t,"com.vmware.vsphere.client.host.maintenance.HostMaintenanceSpec",r)},h5.actions["vsphere.core.host.actions.enterStandbyAction"]=function(e,t){var i={title:s.getString("HostUi","actionEnterStandbyLabel"),subTitle:t.length>1?"":{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/standby/standbyModeConfirmationDialog.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.exitStandby"]=function(e,t){var r={standbyOpType:"exit"};i.applyOnMultiEntity(t,"com.vmware.vsphere.client.host.standby.HostStandbySpec",r)},h5.actions["vsphere.core.host.actions.shutdownAction"]=function(e,t){var i={title:1===t.length?s.getString("HostUi","actionShutdownHostDialogTitle"):s.getString("HostUi","actionShutdownHostsDialogTitle"),subTitle:t.length>1?"":{objectId:t[0]},dialogData:{availableTargets:t},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/shutdownConfirmation.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.rebootAction"]=function(e,t){var i={title:1===t.length?s.getString("HostUi","actionRebootHostDialogTitle"):s.getString("HostUi","actionRebootHostsDialogTitle"),subTitle:t.length>1?"":{objectId:t[0]},dialogData:{availableTargets:t},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/RebootConfirmation.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editAdvancedSystemSettings"]=function(e,t,i){i={selectedItems:P.getSelectedSettings()};var r={title:s.getString("HostUi","advancedSettings.edit.dialogTitle"),subTitle:{objectId:t[0]},dialogData:{availableTargets:t,selectedItems:i.selectedItems},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/advancedSystemSettings/editAdvancedSystemSettings.html",size:"lg"};l.openOkCancelModal(r)},h5.actions["vsphere.core.host.actions.enableEncryptionMode"]=function(e,t,r){i.apply(r.entityId,"com.vmware.vsphere.client.host.config.HostEncryptionModeSpec",{encryptionMode:"safe"})},h5.actions["vsphere.core.host.actions.connectHost"]=function(e,t){var i={title:s.getString("HostUi","actionConnectLabel"),subTitle:t.length>1?"":{objectId:t[0]},message:t.length>1?s.getString("HostUi","confirmReconnect.multipleHostsWarning"):s.getString("HostUi","confirmReconnect.singleHostWarning"),icon:"icon-warning-32",submit:function(){v.reconnect(t)},preserveNewlines:!0};l.openConfirmationModal(i)},h5.actions["vsphere.core.host.actions.disconnectHost"]=function(e,t){var i={title:s.getString("HostUi","actionDisconnectLabel"),subTitle:t.length>1?"":{objectId:t[0]},message:t.length>1?s.getString("HostUi","confirmDisconnectHostsQuestion"):s.getString("HostUi","confirmDisconnectHostQuestion"),icon:"icon-warning-32",submit:function(){v.disconnect(t)},preserveNewlines:!0};l.openConfirmationModal(i)},h5.actions["vsphere.core.host.actions.reconfigureDAS"]=function(e,t){i.applyOnMultiEntity(t,"com.vmware.vsphere.client.host.config.ReconfigureDasSpec",{})},h5.actions["vsphere.core.host.actions.removeHost"]=function(e,t){o.perform(t)},h5.actions["vsphere.core.host.actions.editVmStartupShutdownAction"]=function(e,t){var i={title:s.getString("HostUi","vmStartUp.editLabel"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/vmStartupShutdown/editVmStartupShutdown.html",size:"lg",modalClass:"editVmStartupShutdown"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editSwapfileLocation"]=function(e,t){var i={title:s.getString("HostUi","editSwapfile.titleFormat"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/editVmSwapFileLocationView.html",size:"lg",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editDefaultHwVersionAction"]=function(e,t){var i={title:s.getString("HostUi","defaultVmCompatibilityDialog.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/EditDefaultVmCompatibility.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.navToSettings"]=function(t,i){e._navigateToViewAndObject("vsphere.core.host.manage",i[0])},h5.actions["vsphere.core.host.actions.refreshServicesAction"]=function(e,t){i.apply(t[0],"com.vmware.vsphere.client.host.config.RefreshServicesSpec",{})},h5.actions["vsphere.core.host.actions.addHost"]=function(e,t){c.showWizard(t[0],e)},h5.actions["vsphere.core.host.actions.service.editStartupPolicy"]=function(e,t,i){var r={title:s.getString("HostUi","service.edit.startup.policy.title"),subTitle:{text:i.service.label},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/hostServices/editServiceStartupPolicyDialog.html",modalClass:"edit-service-startup-policy-dialog",dialogData:{model:{service:i.service,hostId:i.hostId}}};l.openOkCancelModal(r)},h5.actions["vsphere.core.host.actions.editFirewallSettings"]=function(e,t){var i={title:s.getString("HostUi","editFirewallSettingsDialog.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/editFirewallSettingsDialog.html",size:"lg",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editTimeConfigurationSettings"]=function(e,t){var i={title:s.getString("HostUi","timeConfig.editTimeConfiguration"),subTitle:{objectId:t[0]},defaultButton:"submit",size:"lg",contentTemplate:"host-ui/resources/host/views/settings/timeConfiguration/editTimeConfigurationDialog.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.authenticationServiceSettingsJoinDomain"]=function(e,t){var i={title:s.getString("HostUi","authJoinDomain.tiwoName"),subTitle:{objectId:t[0]},defaultButton:"submit",modalClass:"edit-auth-join-domain-dialog",contentTemplate:"host-ui/resources/host/views/settings/authenticationServices/authJoinDomainDialog.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.authenticationServiceSettingsLeaveDomain"]=function(e,t){u.leaveDomain(t[0])},h5.actions["vsphere.core.host.actions.authenticationServiceSettingsAddCertificate"]=function(e,t){var i={title:s.getString("HostUi","importCert.actionDescription"),subTitle:{objectId:t[0]},defaultButton:"submit",modalClass:"edit-auth-add-certificate-dialog",contentTemplate:"host-ui/resources/host/views/settings/authenticationServices/authImportCertificateDialog.html",dialogData:{availableTargets:t}};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editImageProfile"]=function(e,t){var i={title:s.getString("HostUi","imageProfileAcceptance.label"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/securityProfile/editImageProfileAcceptanceLevel.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editEncryptionMode"]=function(e,t){var i={title:s.getString("HostUi","hostEncryption.edit.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/securityProfile/editEncryptionMode.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editLockdownMode"]=function(e,t){p.show(t[0],e)},h5.actions["vsphere.core.host.configissues.SuppressESXiAndSSHConfigIssue"]=function(e,t){m.suppressWarnings(t[0],C.SUPPRESS_SHELL_WARNING_KEY)},h5.actions["vsphere.core.host.configissues.SuppressHyperthreadWarning"]=function(e,t){m.suppressWarnings(t[0],C.SUPPRESS_HYPERTHREAD_WARNING_KEY)},h5.actions["vsphere.core.host.actions.editSystemSwap"]=function(e,t){var i={title:s.getString("HostUi","userWorldSwap.edit.title"),subTitle:{objectId:t[0]},dialogData:{availableTargets:t},modalClass:"edit-system-swap-settings",defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/systemSwap/editSystemSwapSettingsView.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.refreshCertificate"]=function(e,t){d.refreshCertificate(t[0])},h5.actions["vsphere.core.host.actions.refreshCaCertificate"]=function(e,t){d.refreshCaCertificate(t[0])},h5.actions["vsphere.core.host.configissues.SuppressNoRedundantManagementNetworkIssue"]=function(e,t){var r=t[0],n=s.getString("HostUi","SuppressHostNoRedundantManagementNetwork.taskName");i.apply(r,"com.vmware.vsphere.client.host.config.SuppressHostNoRedundantManagementNetworkWarningSpec",{},n)},h5.actions["vsphere.core.host.actions.editProcessorGeneralConfig"]=function(e,t){var i={title:s.getString("HostUi","processorConfig.generalConfiguration"),subTitle:{objectId:t[0]},icon:"icon-warning-32",defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/processors/editHardwareProcessorsView.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editBootOptions"]=function(e,t){var i={title:s.getString("HostUi","bootDevice.title"),subTitle:{objectId:t[0]},icon:"icon-warning-32",defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/processors/editBootOptions.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editPciDevices"]=function(e,t){var i={title:s.getString("HostUi","vmdpConfig.edit.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/pciDevices/editPciDevicesView.html",size:"lg"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.moveHostTo"]=function(e,t){var i={title:s.getString("HostUi","actionMoveHostTitle"),subTitle:{objectId:t[0]},defaultButton:"submit",dialogData:{objectIds:t},contentTemplate:"host-ui/resources/host/views/settings/moveto/moveToDialog.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.editHostGraphics"]=function(e,t){var i={title:s.getString("HostUi","settings.graphics.editHostConfigForm.title"),subTitle:{objectId:t[0]},defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/graphics/editHostGraphicsSettingsView.html"};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.refreshPciDevices"]=function(e,t){var r=t[0];i.apply(r,"com.vmware.vsphere.client.h5.host.vmdp.spec.HostVmdpRefreshSpec",{})},h5.actions["vsphere.core.host.actions.moveHostToDrag"]=function(e,t,i){g.moveHostTo(i.dropTarget,t)},h5.actions["vsphere.core.host.actions.editSmartCardAuthentication"]=function(e,t){var i={title:s.getString("HostUi","smartCardAuthnetication.title"),subTitle:{objectId:t[0]},size:"lg",defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/authenticationServices/editSmartCardAuthenticationDialog.html",objectId:t[0]};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.actions.clearNfsKerberosCredentials"]=function(e,t){var r={title:s.getString("HostUi","nfsCredentials.clear.confirm.title"),message:s.getString("HostUi","nfsCredentials.clear.confirm.text"),icon:"icon-warning-32",submit:function(){return i.apply(t[0],"com.vmware.vsphere.client.storage.NfsClearCredentialsSpec",{}),!0},preserveNewlines:!0};l.openConfirmationModal(r)},h5.actions["vsphere.core.host.actions.editNfsKerberosCredentials"]=function(e,t){var i={title:s.getString("HostUi","nfsCredentials.edit.dialogTitle"),subTitle:{objectId:t[0]},size:"md",defaultButton:"submit",contentTemplate:"host-ui/resources/host/views/settings/authenticationServices/editNfsKerberosCredentialsDialog.html",objectId:t[0]};l.openOkCancelModal(i)},h5.actions["vsphere.core.host.assignLicenseKeyAction"]=function(e,t){_.isEmpty(t)||h.showAssignLicenseForm(t)},h5.actions["vsphere.core.host.exportLogsAction"]=function(e,t,i){_.isEmpty(t)||f.showSystemLogExportDialog(t)};var D=window.Zone.current;h5.actions["vsphere.core.hci.addHosts"]=function(i,r){D.run(function(){var i=r[0];t.checkHCISupported(i).then(function(t){y.safeApply(e,function(){t?S.openWizard(i):c.showWizard(i)})})})}}]);var host_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"addHostsActionWizardService",{get:function(){return this._addHostsActionWizardService||(this._addHostsActionWizardService=this.$injector.get("hciAddHostsActionWizardService")),this._addHostsActionWizardService},enumerable:!0,configurable:!0}),e.prototype.openWizard=function(e){return this.addHostsActionWizardService.openWizard(e)},e.$inject=["$injector"],e}();e.AddHostsActionWizardService=t,angular.module("com.vmware.vsphere.client.host").service("addHostsActionWizardService",t)}(host_ui||(host_ui={})),angular.module("com.vmware.vsphere.client.host").constant("helpConstants",{EDIT_DEFAULT_VM_COMPATIBILITY_ID:"com.vmware.vsphere.vm_admin.doc.vc_312"}),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("hostServiceStartupPolicy",{ON:"on",OFF:"off",AUTOMATIC:"automatic"})}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("systemSwapConfigurationConstants",{systemSwapConfigurationOptionType:{DATASTORE_OPTION_TYPE:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$DatastoreOption",HOST_CACHE_OPTION_TYPE:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$HostCacheOption",HOST_LOCAL_SWAP_OPTION_TYPE:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$HostLocalSwapOption",DISABLED_TYPE:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$DisabledOption"}})}(),function(){"use strict";function e(e,t){function i(i){var r=e.getString("CommonUi","byte.label");return i>=s?(i/=s,r=u):i>=a?(i/=a,r=d):i>=o?(i/=o,r=l):i>=n&&(i/=n,r=c),t.format(i,{fractionSize:2,suffix:r})}var r=1024,n=r,o=n*r,a=o*r,s=a*r,c=e.getString("CommonUi","kiloByte.label"),l=e.getString("CommonUi","megaByte.label"),d=e.getString("CommonUi","gigaByte.label"),u=e.getString("CommonUi","teraByte.label");return{bytesFormat:i}}angular.module("com.vmware.vsphere.client.host").service("bytesFormatter",e),e.$inject=["i18nService","numberFormatterService"]}(),function(){"use strict";function e(e,t,i,r){function n(e,t){r.getProperties(e,["name","inMaintenanceMode"]).then(function(e){t(e.name,e.inMaintenanceMode)})}function o(e,t){r.getPropertiesForObjects(e,["name","inMaintenanceMode"]).then(function(i){_.each(e,function(r,n){var o=!0;n===e.length-1&&(o=!1),t(i[r].name,i[r].inMaintenanceMode,r,o)})})}function a(e,t){r.getPropertiesForObjects(e,["name","inMaintenanceMode","config.vsanHostConfig.enabled"]).then(function(i){_.each(e,function(r,n){var o=!0;n===e.length-1&&(o=!1),t(i[r].name,i[r].inMaintenanceMode,i[r]["config.vsanHostConfig.enabled"],r,o)})})}function s(t,r,n,o,a,s){if(!t())return c(e.getString("HostUi","bootDevice.rebootAndShutdownReasonEnterReason"),o),!1;var l={powerOpType:n,reason:t(),force:!0};if(r()){if(0===s().length)return!0;i.applyOnMultiEntity(s(),"com.vmware.vsphere.client.host.powerops.HostPowerSpec",l)}else i.applyOnMultiEntity(a,"com.vmware.vsphere.client.host.powerops.HostPowerSpec",l);return!0}function c(e,i){i.alerts=[{text:e,type:t.validationBanner.type.ERROR
}]}return{fetchHostNameAndMaintenanceModeStatus:n,fetchHostsNameAndMaintenanceModeStatus:o,fetchHostsRebootData:a,onOKClicked:s}}angular.module("com.vmware.vsphere.client.host").service("confirmationDialogWithReasonService",e),e.$inject=["i18nService","vuiConstants","mutationService","dataService"]}(),angular.module("com.vmware.vsphere.client.host").service("connectInfoParser",[function(){return{parse:function(e){var t={};return t.connectInfo=e,t.name=e.host.config.name,t.vendor=e.host.hardware.vendor,t.model=e.host.hardware.model,t.version=e.host.config.product.fullName,t.vms=_.map(e.vm,function(e){return e.config.name}),t.networks=_.map(e.network,function(e){return e.summary.name}),t.datastores=_.map(e.datastore,function(e){return e.summary.name}),t.serverIp=e.serverIp,t.hostAccessManagerAvailable=!!e.capability&&e.capability.hostAccessManagerSupported,t}}}]),function(){"use strict";function e(e,t){function i(i){var n=t.getManagedObjectReference(i);if(!r[n.serverGuid]){var o={value:"ServiceInstance",type:"ServiceInstance",serverGuid:n.serverGuid},a=t.getVsphereObjectId(o);r[n.serverGuid]=e.getProperties(a,["capability.hciWorkflowSupported"]).then(function(e){return!!e&&!!e["capability.hciWorkflowSupported"]})}return r[n.serverGuid]}var r={};return{checkHCISupported:i}}angular.module("com.vmware.vsphere.client.host").service("hciCapabilityService",e),e.$inject=["dataService","defaultUriSchemeUtil"]}(),angular.module("com.vmware.vsphere.client.host").factory("HostAdder",["mutationService","defaultUriSchemeUtil","managedEntityConstants","dataService","hostnameParser","lockdownModeStrings","addHostWizardPageModelGetter","licenseCommonUtil","connectInfoParser","i18nService","addHostWizardConstants","vscSchedulingHelper",function(e,t,i,r,n,o,a,s,c,l,d,u){return function(){function l(){h.reconnectHost?e.apply(h.hostUid,"com.vmware.vsphere.client.host.connection.api.HostConnectionStateSpec",g(),h.operationName):h.scheduleTaskPageModel?e.add("com.vmware.vise.data.scheduling.ScheduledMutationOperationSpec",m()):e.add("com.vmware.vsphere.client.host.add.HostAddSpec",v(),h.operationName)}function p(){var e={hostName:h.hostname,hostPort:h.port,userName:h.username,password:h.password,sslThumbprint:h.sslThumbprint};return e}function v(){var e=null,t=h.userSelectedLicense.embeddedOem&&"true"===h.userSelectedLicense.embeddedOem.toLowerCase();t||_.isEmpty(h.userSelectedLicense.serialKeys)||(e=h.userSelectedLicense.serialKeys[0]);var i=_.extend(p(),{container:h.destination.ref,licenseKey:e});return h.vmLocation&&(i.vmFolder=h.vmLocation.ref),h.hostAccessManagerAvailable?(i.lockdownMode=o.forSpec(h.lockdownMode),i.enableLockDownMode=!1):i.enableLockDownMode="normal"===h.lockdownMode,h.resourceLocationType===d.RESOURCE_LOCATION_NEW&&(i.newRpName=h.resourceLocationName),i}function m(){var e=v(),t=h.scheduleTaskPageModel;return t.spec=e,t.spec._type="com.vmware.vsphere.client.host.add.HostAddSpec",t.schedulingSpec.recurrence=u.formatRecurrenceData(t.schedulingSpec.recurrence),t}function g(){var e=_.extend(p(),{_type:"com.vmware.vim.binding.vim.host.ConnectSpec",force:!0});h.vmLocation&&(e.vmFolder=h.vmLocation.ref);var t={connectionOpType:"connect",connectSpec:e};return t}var h={},f={getNameLocationPageModel:a.getNameLocationPageModel.bind(this,h),getConnectionSettingsPageModel:a.getConnectionSettingsPageModel.bind(this,h),getHostSummaryPageModel:a.getHostSummaryPageModel.bind(this,h),getAssignLicensePageModel:a.getAssignLicensePageModel.bind(this,h),getLockdownModePageModel:a.getLockdownModePageModel.bind(this,h),getVmLocationPageModel:a.getVmLocationPageModel.bind(this,h),getResourceLocationPageModel:a.getResourceLocationPageModel.bind(this,h),getResourcePoolInput:a.getResourcePoolInput.bind(this,h),getReadyToCompletePageModel:a.getReadyToCompletePageModel.bind(this,h),isHostnameValid:a.isHostnameValid.bind(this,h),isUsernameValid:a.isUsernameValid.bind(this,h),getHostAlreadyManagedMessage:a.getHostAlreadyManagedMessage.bind(this,h),getStateLoadedFlag:a.getStateLoadedFlag.bind(this,h),getDestinationUid:a.getDestinationUid.bind(this,h),getScheduleTaskPageModel:a.getScheduleTaskPageModel.bind(this,h),getLastAssetAssignLicenseValidationResult:function(){return h.lastAssetAssignLicenseValidationResult},getErrorInResponse:function(){return h.errorInResponse},setStateLoadedFlag:function(e){h.loadedFlag=e},setDatacenter:function(e){h.dc=e},setDestination:function(e){h.destination={ref:e.ref,name:e.name,icon:e.icon,drsState:e.drsState}},setDestinationUid:function(e){h.destinationUid=e},isDestinationCluster:function(){return h.destination&&h.destination.ref.type===i.CLUSTER},isDestinationDrsEnabledCluster:function(){return this.isDestinationCluster()&&h.destination.drsState},setOperationName:function(e){h.operationName=e},setHostname:function(e){h.userEnteredHostname=e;var t=n.parse(e);t?(h.hostname=t.hostname,h.port=t.port):(h.hostname=null,h.port=null)},setHostUid:function(e){h.hostUid=e},setReconnectHost:function(e){h.reconnectHost=e},setUserSelectedLicense:function(e){h.userSelectedLicense=e},setConnectInfo:function(e){_.extend(h,c.parse(e))},setConnectionSettings:function(e){h.username=e.username,h.password=e.password},setSslThumbprint:function(e){h.sslThumbprint=e},setVmLocation:function(e){h.vmLocation={ref:e.ref,displayName:e.displayName}},setResourceLocationType:function(e){h.resourceLocationType=e},setResourceLocationName:function(e){h.resourceLocationName=e},setLockdownMode:function(e){h.lockdownMode=e},isReconnectHost:function(){return h.reconnectHost},setScheduleTaskPageModel:function(e){h.scheduleTaskPageModel=e},prepareLicenseValidation:function(e){h.preFetchedLicenses=r.getProperties(e.rootFolder,["licenses"],{skipErrorInterceptor:!0})["catch"](function(){return null})},validateLicense:function(t){return h.lastAssetAssignLicenseValidationResult=null,h.preFetchedLicenses.then(function(i){var r=i?i.licenses:null;return e.validateSpec("com.vmware.license.client.cis.management.ds.specs.AssetAssignLicenseConnectInfoValidateSpec",{connectInfo:t.connectInfo,scope:{id:t.serverGuid},licenses:r}).then(function(e){if(e&&e.result){var t=e.result;return s.normalizeValidationResult(t),h.lastAssetAssignLicenseValidationResult=t,t}h.errorInResponse=e.error})})},validateConnection:function(){var i;return i=h.reconnectHost?h.hostUid:t.getVsphereObjectId(h.destination.ref),e.validate(i,"com.vmware.vsphere.client.host.add.HostConnectionSpec",p())},submit:function(){h.vmLocation&&h.vmLocation.ref.type!==i.FOLDER?r.getProperties(t.getVsphereObjectId(h.vmLocation.ref),["vmFolder"]).then(function(e){h.vmLocation.ref=e.vmFolder,l()}):l()}};return f}}]),angular.module("com.vmware.vsphere.client.host").service("hostDataValidationService",[function(){var e=/^[a-zA-Z0-9]+([\.\-]?[a-zA-Z0-9]+)*\.[a-zA-Z]+(\/(.)+)*$/;return{isDomainValid:function(t){return e.test(t)}}}]),angular.module("com.vmware.vsphere.client.host").service("hostnameParser",["ipParserService",function(e){function t(t){var i=e.parse(t);return i?{hostname:i.address,port:i.port||o}:null}function i(e){var t=e.lastIndexOf(":");if(t<0)return{hostname:e,port:o};var i=e.substring(t+1,e.length);return n.test(i)?{hostname:e.substring(0,t),port:parseInt(i)}:void 0}function r(e){for(var t=["!","@","#","%","$","^","&","*",":"],i=0;i<t.length;i++)if(e.indexOf(t[i])>o)return!0;return!1}var n=new RegExp("^\\d+$"),o=-1;return{parse:function(e){if(e){var n=t(e);if(n)return n;var o=i(e);return o&&!r(o.hostname)?o:void 0}}}}]),angular.module("com.vmware.vsphere.client.host").service("hostVuiService",["vuiWizardService",function(e){return{createWizard:e}}]),angular.module("com.vmware.vsphere.client.host").service("lockdownModeStrings",["i18nService",function(e){var t={disabled:"lockdownDisabled",normal:"lockdownNormal",strict:"lockdownStrict"},i={disabled:"addHostWizard.confirmationPage.lockDownModeValueDisabled",normal:"addHostWizard.confirmationPage.lockDownModeValueNormal",strict:"addHostWizard.confirmationPage.lockDownModeValueStrict"};return{forSpec:function(e){return t[e]},forDisplay:function(t){var r=i[t];return r?e.getString("HostUi",r):void 0}}}]),angular.module("com.vmware.vsphere.client.host").factory("hostConnectionService",["dataService","mutationService","alertService","i18nService","addHostWizardService","defaultUriSchemeUtil",function(e,t,i,r,n,o){var a=function(e){var i={connectionOpType:"connect"},a=r.getString("HostUi","reconnectHostOperation.name");return t.applyOnMultiEntity(e,"com.vmware.vsphere.client.h5.host.connect.spec.ReconnectConnectionStateSpec",i,a).then(function(e){for(var t=0;t<e.length;t++)if(e[t].error){n.showWizardInReconnectState(o.getVsphereObjectId(e[t].entity));break}}),!0},s=function(e){var i={connectionOpType:"disconnect"};return t.applyOnMultiEntity(e,"com.vmware.vsphere.client.host.connection.api.HostConnectionStateSpec",i),!0};return{reconnect:a,disconnect:s}}]),angular.module("com.vmware.vsphere.client.host").factory("removeHostAction",["dataService","mutationService","alertService","i18nService","clarityModalService","defaultUriSchemeUtil","hostConnectionState",function(e,t,i,r,n,o,a){function s(e,t){var i={title:e.length>1?r.getString("HostUi","actionRemoveHostsCaption"):r.getString("HostUi","actionRemoveHostCaption"),subTitle:e.length>1?"":{text:e[0]},message:e.length>1?r.getString("HostUi","actionRemoveHostsWarning",e):r.getString("HostUi","actionRemoveHostWarning"),saveButtonLabel:r.getString("Common","yes.label"),cancelButtonLabel:r.getString("Common","no.label"),preserveNewlines:!0,icon:"vx-icon-warning-32x32",submit:t};n.openConfirmationModal(i)}function c(e){var t=e.length>1?r.getString("HostUi","actionRemoveHostsCaption",e):r.getString("HostUi","actionRemoveHostCaption",e),n=e.length>1?r.getString("HostUi","actionRemoveHostsError",e):r.getString("HostUi","actionRemoveHostError",e);i.error(t,n)}function l(t){return e.getPropertiesForObjects(t,["parent","runtime","name"]).then(function(e){var i={nonRemovableHosts:[],removableHostsNames:[],removableHostsObjToRemoveId:[]};return _.each(t,function(t){var r=e[t].parent,n=e[t].runtime,s=e[t].name;if("ClusterComputeResource"!==r.type||n.connectionState!==a.CONNECTED||n.inMaintenanceMode){var c="ComputeResource"===r.type?o.getVsphereObjectId(r):t;i.removableHostsNames.push(s),i.removableHostsObjToRemoveId.push(c)}else i.nonRemovableHosts.push(s)}),i})}var d=function(e){var i=[];l(e).then(function(e){i=e,0===i.removableHostsNames.length&&i.nonRemovableHosts.length>0?c(i.nonRemovableHosts):s(i.removableHostsNames,function(){t.removeOnMultiEntity(i.removableHostsObjToRemoveId),i.nonRemovableHosts.length>0&&c(i.nonRemovableHosts)})})};return{perform:d}}]),angular.module("com.vmware.vsphere.client.host").factory("VuiWizardHelper",["$rootScope","wizardPageService","hostVuiService","defaultUriSchemeUtil","managedEntityConstants","dataService","addHostWizardConstants","i18nService",function(e,t,i,r,n,o,a,s){return function(c){function l(e){var t,i=e.getDestinationUid(),s=r.getPartsFromVsphereObjectId(i);return t=s.type===n.DATACENTER?["name","primaryIconId"]:["name","primaryIconId","dc","configuration.drsConfig.enabled"],o.getProperties(i,t).then(function(t){s.type!==n.DATACENTER?e.setDatacenter(t.dc):e.setDatacenter(s),e.setDestination({ref:s,name:t.name,icon:t.primaryIconId,drsState:t["configuration.drsConfig.enabled"]}),e.isDestinationDrsEnabledCluster()&&e.setResourceLocationType(a.RESOURCE_LOCATION_ROOT),d(e),e.setStateLoadedFlag(!0)})}function d(e){_.each(g.pages,function(t){u(t,s.getString("HostUi","addHostWizard.assignLicensePage.title"),p(e)),u(t,s.getString("HostUi","addHostWizard.lockDownPage.title"),p(e)),u(t,s.getString("HostUi","addHostWizard.vmLocationPage.title"),v(e)),u(t,s.getString("HostUi","addHostWizard.drsClusterRpPage.title"),m(e))})}function u(e,i,r){r&&e.title===i&&t.markPageSkipped(g.pages,i)}function p(e){return e.isReconnectHost()}function v(e){return e.isDestinationCluster()&&!e.isReconnectHost()}function m(e){return!e.isDestinationDrsEnabledCluster()||e.isReconnectHost()}var g;return{markPageComplete:function(e){return t.clearErrors(g),t.markPageComplete(g,e)},markPageIncompleteWithError:function(e){return t.markPageIncompleteWithError(g,e)},markPageIncompleteWithErrors:function(e){return t.markPageIncompleteWithErrors(g,e)},clearErrors:function(){return t.clearErrors(g)},showLoadingIndicator:function(){return t.showLoadingIndicator(g)},hideLoadingIndicator:function(){return t.hideLoadingIndicator(g)},show:function(r,n,o){g={title:c,pages:t.initializePageStates(r),cssClass:o,resizeMinHeight:500,onFinish:function(){return n.submit(),!0}};var a=e.$new();a.manager=n,a.wizardConfig=g,i.createWizard({scope:a,configObjectName:"wizardConfig"}).show(),this.showLoadingIndicator();var s=this;l(n).then(function(){s.hideLoadingIndicator()})}}}}]),function(){"use strict";function e(e,t,i,r,n){function o(){return t.applyOnMultiEntity(c,"com.vmware.vsphere.client.host.standby.HostStandbySpec",a),!0}var a={standbyOpType:"enter"},s=this;s.loading=!0,s.confirmationData=[],s.hasWarningMessages=!1,s.shouldEvacuateVms=!1;var c=e.modalOptions.dialogData.availableTargets;e.modalOptions.onSubmit=o,e.evacuateVms=!1,e.onEvacuateVmsChange=function(e){a.evacuatePoweredOffVms=e},t.validateOnMultiEntity(c,"com.vmware.vsphere.client.host.standby.HostStandbySpec",a).then(function(e){var t=i.processStandbyValidationResult(e);s.confirmationData=t,s.hasWarningMessages=t.warningMessages.length>0,s.shouldEvacuateVms=t.shouldEvacuateVms,s.loading=!1})}angular.module("com.vmware.vsphere.client.host").controller("StandbyModeConfirmationController",e),e.$inject=["$scope","mutationService","standbyModeConfirmationService","$element","$timeout"]}(),function(){"use strict";function e(e){function t(t){function i(e,t){var i=0===o.length;o.push({shortDescription:e,message:t,expanded:i})}var r,n,o=[],a=!1,s=[],c=[],l=[],d=[];return _.each(t,function(e){e.result.lastStandbyExitUncertain&&s.push(e.result.hostName),e.result.highAvailabilityCompromise&&(c[e.result.parentClusterName]||(c[e.result.parentClusterName]=[],l.push(e.result.parentClusterName)),c[e.result.parentClusterName].push(e.result.hostName)),e.result.vmsPoweredOn&&d.push(e.result.hostName),e.result.drsEnabled&&e.result.vmsCount>0&&(a=!0)}),s.length>0&&(r=e.getString("HostUi","ConfirmStandbyForm.lastStandbyUncertainWarningMessage.label"),n=e.getString("HostUi","ConfirmStandbyForm.lastStandbyUncertainWarningMessage.description",s.join(", ")),i(r,n)),_.each(l,function(t){c[t].length>0&&(r=e.getString("HostUi","ConfirmStandbyForm.highAvailabilityWarning.label"),n=e.getString("HostUi","ConfirmStandbyForm.highAvailabilityWarning.description",t,c[t].join(", ")),i(r,n))}),d.length>0&&(r=e.getString("HostUi","actionEnterStandbyVMsPoweredOnTitle"),n=e.getString("HostUi","actionEnterStandbyVMsPoweredOn",d.join(", ")),i(r,n)),{hostname:t[0].result.hostName,warningMessages:o,shouldEvacuateVms:a}}return{processStandbyValidationResult:t}}angular.module("com.vmware.vsphere.client.host").service("standbyModeConfirmationService",e),e.$inject=["i18nService"]}(),angular.module("com.vmware.vsphere.client.host").constant("addHostWizardConstants",{RESOURCE_LOCATION_ROOT:"clusterRootResourcePool",RESOURCE_LOCATION_NEW:"newResourcePool",LICENSE_RESOURCE_MODEL:"License",LICENSE_PROPERTY:"license",LICENSE_TYPE_PROPERTY:"licenseType",LICENSE_SCOPE_PROPERTY:"scope",LICENSE_SERIAL_KEY_TYPE:"SERIAL_KEY"}),angular.module("com.vmware.vsphere.client.host").service("addHostWizardPageModelGetter",["defaultUriSchemeUtil","lockdownModeStrings","managedEntityConstants","addHostWizardConstants","i18nService","hostWizardScheduleTaskPageModel",function(e,t,i,r,n,o){return{getNameLocationPageModel:function(e){return{destinationName:e.destination.name,destinationIcon:e.destination.icon,hostname:e.userEnteredHostname,reconnectHost:e.reconnectHost}},getConnectionSettingsPageModel:function(e){return{username:e.username,password:e.password}},getHostSummaryPageModel:function(e){return{name:e.name,vendor:e.vendor,model:e.model,version:e.version,vms:e.vms,serverIp:e.serverIp}},getAssignLicensePageModel:function(e){return{serverGuid:e.destination.ref.serverGuid,connectInfo:e.connectInfo,userSelectedLicense:e.userSelectedLicense}},getLockdownModePageModel:function(e){return{lockdownMode:e.lockdownMode||"disabled",showStrictModeOption:e.hostAccessManagerAvailable}},getVmLocationPageModel:function(t){var i={treeRoot:e.getVsphereObjectId(t.dc)};return t.vmLocation&&(i.selectedLocationId=e.getVsphereObjectId(t.vmLocation.ref)),i},getResourceLocationPageModel:function(e){var t=e.resourceLocationName||n.getString("HostUi","addHostWizard.defaultNewRpNameValueFormat",e.hostname);return{resourceLocationType:e.resourceLocationType,resourceLocationName:t}},getResourcePoolInput:function(e){return{destination:e.destination.ref,type:e.resourceLocationType,name:e.resourceLocationName}},getReadyToCompletePageModel:function(e){var n={name:e.name,version:e.version,licenseName:e.userSelectedLicense?e.userSelectedLicense.name:"",vms:e.vms,networks:e.networks,datastores:e.datastores,lockdownMode:t.forDisplay(e.lockdownMode),destinationName:e.destination.name,destinationIcon:e.destination.icon};return e.vmLocation&&(n.vmLocation=e.vmLocation.displayName),e.destination.ref.type===i.CLUSTER&&e.destination.drsState===!0&&(e.resourceLocationType===r.RESOURCE_LOCATION_ROOT?n.destinationResourceLocation=e.destination.name:n.destinationResourceLocation=e.resourceLocationName),n},isHostnameValid:function(e){return!!e.hostname},isUsernameValid:function(e){return e.username&&e.username.length>0},getHostAlreadyManagedMessage:function(e){if(e.serverIp){var t=!1;_.isEmpty(e.connectInfo.vm)||(t=_.any(e.connectInfo.vm,function(e){return e.config&&e.config.ftInfo}));var i=t?n.getString("HostUi","addHostWizard.hostSummaryPage.ftVmExistsOnHostMsgFormat",e.serverIp):n.getString("HostUi","addHostWizard.hostSummaryPage.alreadyManagedMessageFormat",e.serverIp);return i}return""},getStateLoadedFlag:function(e){return e.loadedFlag},getDestinationUid:function(e){return e.destinationUid},getScheduleTaskPageModel:function(e){return{hostWizardScheduleTaskPageModel:e.scheduleTaskPageModel}}}}]),angular.module("com.vmware.vsphere.client.host").service("addHostWizardService",["hostVuiService","i18nService","dataService","$rootScope","addHostNameLocationPageService","addHostConnectionSettingsPageService","addHostHostSummaryPageService","addHostAssignLicensePageService","addHostLockdownModePageService","addHostVmLocationPageService","addHostResourceLocationPageService","addHostReadyToCompletePageService","HostAdder","vuiConstants","wizardPageService","defaultUriSchemeUtil","VuiWizardHelper","addHostScheduleTaskPageService","lockdownModeStrings",function(e,t,i,r,n,o,a,s,c,l,d,u,p,v,m,g,h,f,S){function y(e,i,r,n){var o="addHostWizard.title";n&&n.additionalData&&n.additionalData.isScheduledTask&&(o=1===n.additionalData.schedulingData.scheduleTaskOperationMode?"scheduledtask.edit."+o:"scheduledtask."+o);var a=t.getString("HostUi",o),s=new p,c=new h(a);s.setDestinationUid(e);var l=[],d=!!i;if(d){s.setHostUid(i),s.setHostname(r),s.setReconnectHost(d);var u=t.getString("HostUi","reconnectHostOperation.name");s.setOperationName(u),l=P(s,c,n),c.show(l,s,"add-host-wizard")}else s.setOperationName(a),n&&n.additionalData&&n.additionalData.isScheduledTask&&1===n.additionalData.schedulingData.scheduleTaskOperationMode?C(s,c,n):(l=P(s,c,n),c.show(l,s,"add-host-wizard"))}function P(e,t,i){var r=[];return i&&i.additionalData&&i.additionalData.isScheduledTask===!0&&(e.getScheduleTaskPageModel.isScheduledTaskFlow=i.additionalData.isScheduledTask,e.getScheduleTaskPageModel.mutationSpec=i.additionalData.schedulingData,r.push(f.build(e,t))),r.push(n.build(e,t)),r.push(o.build(e,t)),r.push(a.build(t)),r.push(s.build(e,t)),r.push(c.build(t)),r.push(l.build(e,t)),r.push(d.build(e,t)),r.push(u.build()),r}function C(e,t,r){var n=[],o=r.additionalData.schedulingData.spec.argument,a=o[0].value;if(e.setHostname(a.hostName),e.setConnectionSettings({username:a.userName,password:a.password}),e.setSslThumbprint(a.sslThumbprint),e.setResourceLocationType(null),e.setLockdownMode(S.forSpec(a.lockdownMode)),a.vmFolder){var s=g.getVsphereObjectId(a.vmFolder);i.getProperties(s,["name"]).then(function(i){var o="";i&&i.name&&(o=i.name),e.setVmLocation({ref:a.vmFolder,displayName:o}),n=P(e,t,r),t.show(n,e,"add-host-wizard")})}else n=P(e,t,r),t.show(n,e,"add-host-wizard")}return{showWizardInReconnectState:function(e){i.getProperties(e,["dcOrUserCreatedHostFolder","cluster","name"]).then(function(t){var i=t.cluster;if(i||(i=t.dcOrUserCreatedHostFolder),i){var r=g.getVsphereObjectId(i);y(r,e,t.name)}})},showWizard:function(e,t){y(e,null,null,t)}}}]),function(){"use strict";function e(e,t){var i=this;i.model=e.manager.getAssignLicensePageModel(),i.selectedLicense=i.model.userSelectedLicense,i.onLicenseItemChanged=function(t){e.manager.setUserSelectedLicense(t)},e.wizardConfig.loading=!0,e.manager.validateLicense(i.model).then(function(r){e.wizardConfig.loading=!1,i.validationResult=r;var n=e.manager.getErrorInResponse();n&&(e.wizardConfig.validationBanner.messages=[{type:t.notifications.type.ERROR,text:n.localizedMessage}])})}angular.module("com.vmware.vsphere.client.host").controller("AddHostAssignLicensePageController",e),e.$inject=["$scope","vuiConstants"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").controller("AddHostConnectionSettingsPageController",["$scope",function(e){var t=this;t.model=e.manager.getConnectionSettingsPageModel(),e.$watch(function(){return t.model},function(t){e.manager.setConnectionSettings(t)},!0)}])}(),function(){"use strict";function e(e){_.extend(this,e.manager.getHostSummaryPageModel()),_.extend(this,{warningMessage:e.manager.getHostAlreadyManagedMessage()})}angular.module("com.vmware.vsphere.client.host").controller("AddHostHostSummaryPageController",e),e.$inject=["$scope"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").controller("AddHostLockdownModePageController",["$scope",function(e){var t=this;this.model=e.manager.getLockdownModePageModel(),e.$watch(function(){return t.model.lockdownMode},function(t){e.manager.setLockdownMode(t)})}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").controller("AddHostNameLocationPageController",["$scope",function(e){function t(){i.model=e.manager.getNameLocationPageModel(),e.$watch(function(){return i.model},function(t){e.manager.setHostname(t.hostname)},!0)}var i=this;e.manager.getStateLoadedFlag()?t():e.$watch(e.manager.getStateLoadedFlag,function(e){e&&t()})}])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").controller("AddHostReadyToCompletePageController",["$scope","i18nService","vxPropertyViewService",function(e,t,i){var r=e.manager.getReadyToCompletePageModel(),n=_.bind(t.getString,t,"HostUi"),o=function(e){return e?e:n("none.label")},a=i.createPropertyViewBuilder(),s=a.category("").section("");s.property(n("addHostWizard.confirmationPage.hostNameLabel"),r.name).propertyBuilder().keyBuilder().text(n("addHostWizard.confirmationPage.locationLabel")).exit().valueBuilder().text(r.destinationName).icon(r.destinationIcon).exit().exit().property(n("addHostWizard.confirmationPage.hostVersionLabel"),r.version),r.licenseName&&s.property(n("addHostWizard.confirmationPage.licenseKeyLabel"),r.licenseName),s.property(n("addHostWizard.confirmationPage.networksLabel"),o(r.networks)).property(n("addHostWizard.confirmationPage.datastoresLabel"),o(r.datastores)),r.lockdownMode&&s.property(n("addHostWizard.confirmationPage.lockDownModeLabel"),r.lockdownMode),r.vmLocation&&s.property(n("addHostWizard.confirmationPage.vmLocationLabel"),r.vmLocation),r.destinationResourceLocation&&s.property(n("addHostWizard.confirmationPage.rpLabel"),r.destinationResourceLocation),this.propertyViewData=a.build()}])}(),function(){"use strict";function e(e,t){this.model=e.manager.getResourceLocationPageModel(),this.addHostWizardConstants=t,e.$watch("ctrl.model.resourceLocationType",function(t){e.manager.setResourceLocationType(t)}),e.$watch("ctrl.model.resourceLocationName",function(t){e.manager.setResourceLocationName(t)})}angular.module("com.vmware.vsphere.client.host").controller("AddHostResourceLocationPageController",["$scope","addHostWizardConstants",e])}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").controller("AddHostVmLocationPageController",["$scope","defaultUriSchemeUtil",function(e,t){this.model=e.manager.getVmLocationPageModel(),this.onVmLocationSelected=function(i,r){var n=t.getManagedObjectReference(i);e.manager.setVmLocation({ref:n,displayName:r})}}])}(),function(){"use strict";function e(e,t,i,r){return{build:function(n,o){var a={rootFolder:r.getRootFolderFromVsphereObjectId(n.getDestinationUid())};return n.prepareLicenseValidation(a),{title:e.getString("HostUi","addHostWizard.assignLicensePage.title"),description:e.getString("HostUi","addHostWizard.assignLicensePage.description"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostAssignLicensePage.html",onCommit:function(){if(!n.getLastAssetAssignLicenseValidationResult())return!1;var e=t.getValidationBlockingErrors(n.getAssignLicensePageModel().userSelectedLicense,n.getLastAssetAssignLicenseValidationResult(),!0);if(_.isEmpty(e)){var r=t.getValidationWarnings(n.getAssignLicensePageModel().userSelectedLicense,n.getLastAssetAssignLicenseValidationResult(),!0);return _.isEmpty(r)?(o.markPageComplete(),!0):t.showLicenseWarningsConfirmationDialog(r).then(function(e){return e?o.markPageComplete():o.markPageIncompleteWithErrors([]),e},function(e){return o.markPageIncompleteWithErrors([]),i.reject(e)})}return o.markPageIncompleteWithErrors(e),!1}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostAssignLicensePageService",e),e.$inject=["i18nService","licenseValidationUtil","$q","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i){return{build:function(r,n){function o(i,o){var s=o.error.thumbprint,c=e.getString("HostUi",o.result.isEsx60OrHigher?"addHostWizard.hostConnectionPage.sslVerifyWarningMsgFormat60":"addHostWizard.hostConnectionPage.sslVerifyWarningMsgFormat",s),l={title:e.getString("HostUi","addHostWizard.hostConnectionPage.sslVerifyWarningTitle"),message:c,yesHandler:function(){return n.showLoadingIndicator(),r.setSslThumbprint(s),r.validateConnection().then(function(e){n.hideLoadingIndicator(),a(e,i)}),!0},noHandler:function(){n.markPageIncompleteWithError(o.error.localizedMessage),i.resolve(!1)},yesIsDefaultButton:!1,useClarity:!0,parent:".vui-wizard"};t.showConfirmationDialog(l)}function a(e,t){e.error?(n.markPageIncompleteWithError(_.escape(e.error.localizedMessage)),t.resolve(!1)):(r.setConnectInfo(e.result.connectInfo),n.markPageComplete(),t.resolve(!0))}return{title:e.getString("HostUi","addHostWizard.hostConnectionPage.title"),description:e.getString("HostUi","addHostWizard.hostConnectionPage.description"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostConnectionSettingsPage.html",onCommit:function(){var t=i.defer();return r.isUsernameValid()?(n.showLoadingIndicator(),r.validateConnection().then(function(e){return n.hideLoadingIndicator(),e}).then(function(e){e.error&&e.error.thumbprint?o(t,e):a(e,t)})):(n.markPageIncompleteWithError(e.getString("HostUi","addHostWizard.hostConnectionPage.missingUsername")),t.resolve(!1)),t.promise}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostConnectionSettingsPageService",e),e.$inject=["i18nService","actionConfirmationService","$q"]}(),function(){"use strict";function e(e){return{build:function(t){return{title:e.getString("HostUi","addHostWizard.hostSummaryPage.title"),description:e.getString("HostUi","addHostWizard.hostSummaryPage.description"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostHostSummaryPage.html",onCommit:function(){return t.markPageComplete(),!0}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostHostSummaryPageService",e),e.$inject=["i18nService"]}(),function(){"use strict";function e(e){return{build:function(t){return{title:e.getString("HostUi","addHostWizard.lockDownPage.title"),description:e.getString("HostUi","addHostWizard.lockDownPage.description"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostLockdownModePage.html",onCommit:function(){return t.markPageComplete(),!0}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostLockdownModePageService",e),e.$inject=["i18nService"]}(),function(){"use strict";function e(e){return{build:function(t,i){return{title:e.getString("HostUi","addHostWizard.hostNameAndLocationPage.title"),description:e.getString("HostUi","addHostWizard.hostNameAndLocationPage.hostNameDescription"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostNameLocationPage.html",onCommit:function(){return t.isHostnameValid()?(i.markPageComplete(),!0):(i.markPageIncompleteWithError(e.getString("HostUi","addHostWizard.hostNameAndLocationPage.invalidHostError")),!1)}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostNameLocationPageService",e),e.$inject=["i18nService"]}(),angular.module("com.vmware.vsphere.client.host").service("addHostReadyToCompletePageService",["i18nService",function(e){return{build:function(){return{title:e.getString("HostUi","addHostWizard.confirmationPage.title"),description:e.getString("HostUi","addHostWizard.confirmationPage.description"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostReadyToCompletePage.html"}}}}]),function(){"use strict";function e(e,t,i,r,n){var o=r("addHostResourceLocationPageService");return{build:function(r,a){function s(i){if(i.type===t.RESOURCE_LOCATION_ROOT)return a.markPageComplete(),!0;if(!i.name||0===i.name.length){var r=e.getString("HostUi","hostToClusterOp.resPoolPage.rpNameReqError");return a.markPageIncompleteWithError(r),!1}var o=n.getVsphereObjectId(i.destination);return c(o,i.name)}function c(e,t){return a.showLoadingIndicator(),i.validate(e,"com.vmware.vsphere.client.h5.rp.CreateResourcePoolNameSpec",d(t)).then(l)}function l(e){return a.hideLoadingIndicator(),e||o.error("Server error: Can't validate resource location name."),e&&e.error&&(e.error.message?o.error(e.error.message):o.error("Server error: The validation result has an error")),e&&e.result&&e.result.length>0?(a.markPageIncompleteWithError(e.result),!1):(a.markPageComplete(),!0)}function d(e){var t={name:e};return t}return{title:e.getString("HostUi","addHostWizard.drsClusterRpPage.title"),description:e.getString("HostUi","addHostWizard.drsClusterRpPage.description"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostResourceLocationPage.html",onCommit:function(){var e=r.getResourcePoolInput();return s(e)}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostResourceLocationPageService",e),e.$inject=["i18nService","addHostWizardConstants","mutationService","logService","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e){return{build:function(t,i){return{title:e.getString("HostUi","addHostWizard.vmLocationPage.title"),contentUrl:"host-ui/resources/host/views/addHostWizard/pages/addHostVmLocationPage.html",onCommit:function(){return t.getVmLocationPageModel().selectedLocationId?(i.markPageComplete(),!0):(i.markPageIncompleteWithErrors([e.getString("HostUi","addHostWizard.vmLocationPage.error")]),!1)}}}}}angular.module("com.vmware.vsphere.client.host").service("addHostVmLocationPageService",e),e.$inject=["i18nService"]}();var host_ui;!function(e){var t=function(){function e(){}return e.prototype.validatePage=function(){return{}},e.prototype.submitPage=function(){return{invalidateNextPages:!1}},e.prototype.resetForm=function(){},e}();e.HostWizardScheduleTaskPageModel=t;var i=function(){return t};angular.module("com.vmware.vsphere.client.host").service("hostWizardScheduleTaskPageModel",i)}(host_ui||(host_ui={}));
var host_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.wizardPageService=t}return e.prototype.build=function(e,t){var i=this;return{title:this.i18nService.getString("HostUi","addHostWizard.scheduleTaskPage.title"),contentUrl:"host-ui/resources/host/views/addHostWizard/scheduleTaskWizard/scheduleTaskPage/hostWizardScheduleTaskPage.html",onCommit:function(){return i.onCommit(e,t)}}},e.prototype.onCommit=function(e,t){var i=e.getScheduleTaskPageModel.mutationSpec.schedulingSpec.recurrence,r=e.getScheduleTaskPageModel.mutationSpec.schedulingSpec.isFormStatusValid;return i&&r?(e.setScheduleTaskPageModel(e.getScheduleTaskPageModel.mutationSpec),t.markPageComplete(),!0):(t.markPageIncompleteWithError(this.i18nService.getString("HostUi","addHostWizard.scheduleTaskPage.invalidHostSchedulerError")),!1)},e.$inject=["i18nService","wizardPageService"],e}();e.AddHostScheduleTaskPageService=t,angular.module("com.vmware.vsphere.client.host").service("addHostScheduleTaskPageService",t)}(host_ui||(host_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("hardwareHealthConstants",{status:{NORMAL:"normal",WARNING:"warning",ALERT:"alert",UNKNOWN:"unknown"},HARDWARE_STATUS_PROPERTY:"hardwareStatus",HARDWARE_STATUS_65_PROPERTY:"hardwareHealthStatus",HARDWARE_STATUS_XML_PROPERTY:"hardwareStatusXml",ACTION:{REFRESH_DATA:"refresh_data",RESET_SENSORS:"reset_sensors",RESET_EVENTS:"reset_events",EXPORT_XML:"export_xml"},OPERATION:{REFRESH_DATA:"REFRESH_DATA",RESET_SENSORS:"RESET_SENSORS",RESET_EVENTS_LOG:"RESET_EVENTS_LOG"},SENSOR_ICONS:{processor:"vx-icon-CPU",temperature:"vx-icon-temp",storage:"vx-icon-storage",battery:"vx-icon-battery",fan:"vx-icon-fan",memory:"vx-icon-memory",pci:"vx-icon-pci",voltage:"vx-icon-voltage",power:"vx-icon-power",network:"vx-icon-network",software:"vx-icon-software",bmc:"vx-icon-system_board",sel:"vx-icon-sel",cable:"vx-icon-cable",watchdog:"vx-icon-watchdog"}})}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l,d,u){function p(e,t){_.each(t.updates,function(e){if(e.data&&e.data.entity&&e.data.entity._value===d.getPartsFromVsphereObjectId(v.hostId).value)return void v.requestHardwareHealthData()})}this.constants=r,this.hardwareHealthService=n,this.vxPropertyViewService=a,this.i18nService=s,this.authorizationService=c,this.vcService=l,this.data=null,this.sensors=[],this.alertsAndWarnings=[],this.systemEventLog=[],this.hostId=e._route.objectId,this.loading=!1,this.hasActionPrivileges=!0,this.sensorsShown=!1,this.alertsAndWarningsShown=!1,this.systemEventLogShown=!1,this.is65VcOrLater=null,this.is66VcOrLater=null,this.showExpandRowLabel=!1,this.liveRefreshProperties=["hardware.systemInfo","hardware.biosInfo","runtime.healthSystemRuntime.systemHealthInfo.numericSensorInfo"];var v=this;this.headerOptions=n.createHeaderOptions(this.hostId),this.sensorActionBarOptions=n.createSensorActionBarOptions(this.hostId),this.alertsAndWarningsActionBarOptions=n.createAlertsAndWarningsActionBarOptions(this.hostId),this.alertAndWarningDatagridOptions=n.createAlertsAndWarningsDatagridOptions(),this.systemEventLogActionBarOptions=n.createSystemEventLogActionBarOptions(this.hostId),this.systemEventLogDatagridOptions=n.createSystemEventLogDatagridOptions(),this.splitterOptions={orientation:o.splitter.orientation.HORIZONTAL,height:"100%",resizable:!1,panes:[{size:"50%"},{size:"50%"}]},this.detailHeaderOptions={title:s.getString("HostUi","hardwareHealth.sensors.sensorDetails.title"),objectId:this.hostId},this.propertyViewMessage=s.getString("HostUi","hardwareHealth.sensors.sensorDetails.noItems"),this.propertyViewData=null,this.showPropertyGrid=!1,this.getHardwareHealthDataByVcVersion();var m=t.$on("alarms",p);this.visibilitySubscriberId=u.subscribeForVisibilityChange(i,function(e){e?m=t.$on("alarms",p):m()}),e.$on("$destroy",function(){null!==v.visibilitySubscriberId&&(u.unsubscribe(v.visibilitySubscriberId),v.visibilitySubscriberId=null),m()})}angular.module("com.vmware.vsphere.client.host").controller("HardwareHealthController",e),e.$inject=["$scope","$rootScope","$element","hardwareHealthConstants","hardwareHealthService","vuiConstants","vxPropertyViewService","i18nService","authorizationService","vcService","defaultUriSchemeUtil","visibilityMonitorService"],e.prototype.checkPrivileges=function(){this.authorizationService.checkPrivileges(this.hostId,["Host.Cim.CimInteraction"]).then(function(e){this.hasActionPrivileges=!!e[0],this.updateActionbarButtonStatus()}.bind(this))},e.prototype.updateActionbarButtonStatus=function(){var e=this.sensorTreeListOptions&&0!==this.sensorTreeListOptions.dataSource.data().length||this.sensors.length>0;_.each(this.sensorActionBarOptions.actions,function(t){t.enabled=this.hardwareHealthService.getActionStatus(t.id,e,this.hasActionPrivileges)},this),_.each(this.alertsAndWarningsActionBarOptions.actions,function(t){t.enabled=this.hardwareHealthService.getActionStatus(t.id,e,this.hasActionPrivileges)},this),_.each(this.systemEventLogActionBarOptions.actions,function(t){t.enabled=this.hardwareHealthService.getActionStatus(t.id,e,this.hasActionPrivileges)},this)},e.prototype.getDefaultHardwareHealthData=function(){var e={};return e[this.constants.HARDWARE_STATUS_PROPERTY]={alertsAndWarnings:[],bios:null,chassis:[],sensorCounts:null,sensors:[],systemEventLog:[]},e},e.prototype.getHardwareHealthDataByVcVersion=function(){this.vcService.is66VcOrLater(this.hostId).then(function(e){this.is66VcOrLater=e,e?this.hardwareHealthService.requestHardwareHealthData(this.hostId,this.constants.HARDWARE_STATUS_65_PROPERTY).then(function(e){this.loading=!1,this.hardwareHealthService.getUserTimeFormat().then(function(t){this.initVc66OrLaterHardwareHealthData(e,t),this.checkPrivileges()}.bind(this))}.bind(this)):this.initHardwareHealthData()}.bind(this))},e.prototype.initHardwareHealthData=function(){this.vcService.is65VcOrLater(this.hostId).then(function(e){this.is65VcOrLater=e,this.sensorTreeListOptions=this.hardwareHealthService.createSensorTreeListOptions(this.showPropertyGridItemDetails.bind(this),e),this.requestHardwareHealthData(),this.checkPrivileges()}.bind(this))},e.prototype.requestHardwareHealthData=function(){if(null!==this.is65VcOrLater){var e=this.is65VcOrLater?this.constants.HARDWARE_STATUS_65_PROPERTY:this.constants.HARDWARE_STATUS_PROPERTY;this.loading=!0,this.hardwareHealthService.requestHardwareHealthData(this.hostId,e).then(function(t){this.loading=!1,this.hardwareHealthService.getUserTimeFormat().then(function(i){t=angular.merge({},this.getDefaultHardwareHealthData(),t);var r=t[e],n=this.data;this.data=r,_.isEmpty(r.sensors)||(r.sensors=this.getExtendedHardwareHealthData(r.sensors,i)),this.sensorCountLabels=this.hardwareHealthService.getSensorCountLabels(r.sensorCounts);var o=this.getSensorsPartialUpdate(r,n);o===!1?this.sensorTreeListOptions.dataSource=this.hardwareHealthService.createSensorTreeListDataSource(r.sensors):this.sensorTreeListOptions.dataSource.pushUpdate(o),this.alertAndWarningDatagridOptions.data=r.alertsAndWarnings,this.systemEventLogDatagridOptions.data=_.isNull(r.systemEventLog)?[]:this.getExtendedHardwareHealthData(r.systemEventLog,i),this.updateActionbarButtonStatus()}.bind(this))}.bind(this))}},e.prototype.showPropertyGridItemDetails=function(e){if("string"==typeof e&&e.length>0){var t=_.find(this.sensorTreeListOptions.dataSource.data(),function(t){return t.id===e}),i=t.details;if(i){var r=this.vxPropertyViewService.createPropertyViewBuilder(),n=r.category(""),o=this.hardwareHealthService.getSensorIcon(t.sensorType),a=n.section("").title(t.name).titleIcon(o);_.each(i,function(e){a.property(e.label,e.value)},this),this.propertyViewData=r.build(),this.showPropertyGrid=!0}else this.propertyViewMessage=this.i18nService.getString("HostUi","hardwareHealth.sensors.sensorDetails.noDetails"),this.showPropertyGrid=!1}else this.showPropertyGrid=!1,this.propertyViewMessage=this.i18nService.getString("HostUi","hardwareHealth.sensors.sensorDetails.noItems")},e.prototype.showSensorsTab=function(){this.sensorsShown=!0},e.prototype.showAlertsAndWarningsTab=function(){this.alertsAndWarningsShown=!0},e.prototype.showSystemEventLogTab=function(){this.systemEventLogShown=!0},e.prototype.getSensorsPartialUpdate=function(e,t){if(!t)return!1;var i=_.map(e.sensors,function(e){return _.pick(e,"id","parentId","type")}),r=_.map(t.sensors,function(e){return _.pick(e,"id","parentId","type")});if(!_.isEqual(i,r))return!1;var n=_.filter(e.sensors,function(e,i){var r=t.sensors[i];return!_.isEqual(e,r)});return n},e.prototype.initVc66OrLaterHardwareHealthData=function(e,t){e=angular.merge({},this.getDefaultHardwareHealthData(),e);var i=e.hardwareHealthStatus;this.data=i,this.sensorCountLabels=this.hardwareHealthService.getSensorCountLabels(i.sensorCounts),i.sensors&&i.sensors.length>0&&(this.sensors=this.getExtendedSensorsHardwareHealthData(i.sensors,t),this.showExpandRowLabel=_.some(i.sensors,function(e){return e.selEntriesList&&e.selEntriesList.length>0||e.fru})),this.alertsAndWarnings=_.isNull(i.alertsAndWarnings)||_.isEmpty(i.alertsAndWarnings)?[]:i.alertsAndWarnings,this.systemEventLog=_.isNull(i.systemEventLog)||_.isEmpty(i.systemEventLog)?[]:this.getExtendedHardwareHealthData(i.systemEventLog,t),this.updateActionbarButtonStatus()},e.prototype.getExtendedHardwareHealthData=function(e,t){return _.map(e,function(e){var i=this.hardwareHealthService.getTimestampFormatted(e.timestamp,t);return _.extend(e,{timestampFormatted:null!==e.timestamp?i:this.i18nService.getString("Common","notAvailable")})}.bind(this))},e.prototype.getExtendedSensorsHardwareHealthData=function(e,t){return _.map(e,function(e){var i=this.hardwareHealthService.getTimestampFormatted(e.timestamp,t),r=_.isNull(e.selEntriesList)||_.isEmpty(e.selEntriesList)?[]:this.getExtendedSelEntriesList(e.selEntriesList,t);return _.extend(e,{timestampFormatted:null!==e.timestamp?i:this.i18nService.getString("Common","notAvailable"),selEntriesList:r})}.bind(this))},e.prototype.getExtendedSelEntriesList=function(e,t){return _.map(e,function(e){var i=this.hardwareHealthService.getTimestampFormatted(e.timestamp,t);return _.extend(e,{timestampFormatted:null!==e.timestamp?i:this.i18nService.getString("Common","notAvailable")})}.bind(this))}}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(e){var t=new kendo.data.TreeListDataSource({data:e,schema:{model:{id:"id",expanded:!1}}});return t.read(),t}function d(e,t){var i=[];return t&&i.push({field:"sensorId",title:I("idHeaderText"),template:O,width:"10%"}),i=i.concat([{field:"name",title:I("sensorHeaderText"),template:E,width:"35%"},{field:"status",title:I("statusHeaderText"),template:function(e){return V(e.status)},sortable:{compare:_},width:"15%"},{field:"reading",title:I("readingHeaderText"),template:M,width:"15%"}]),t&&(i.push({field:"category",title:I("categoryHeaderText"),template:"#:sensorType#",width:"15%"}),i.push({field:"timestampFormatted",title:I("timestampHeaderText"),template:"#:timestampFormatted#",width:"15%"})),{dataSource:l([]),sortable:{mode:"multiple"},columns:i,resizable:!1,selectable:"row",change:function(){var t=this.dataItem(this.select()[0]),i=t.parentId?t.id:"";e(i)}}}function u(e){var t=f(n.ACTION.REFRESH_DATA,e,r.getString("HostUi","hardwareHealth.sensors.refresh"),n.OPERATION.REFRESH_DATA),i=m(e);return{actions:[t,i]}}function p(e){var t=f(n.ACTION.REFRESH_DATA,e,r.getString("HostUi","hardwareHealth.sensors.refresh"),n.OPERATION.REFRESH_DATA),i=m(e);return{actions:[t,i]}}function v(e){var t=f(n.ACTION.REFRESH_DATA,e,r.getString("HostUi","hardwareHealth.systemEventLog.refresh"),n.OPERATION.REFRESH_DATA),i=f(n.ACTION.RESET_EVENTS,e,r.getString("HostUi","hardwareHealth.systemEventLog.reset"),n.OPERATION.RESET_EVENTS_LOG),o=m(e);return{actions:[t,i,o]}}function m(e){return{id:n.ACTION.EXPORT_XML,label:r.getString("HostUi","hardwareHealth.sensors.export"),enabled:!1,onClick:function(){return g(e)}}}function g(t){var i=s.$new();i.cimXmlData=null,i.loading=!0,i.exportData=function(){e.save(i.cimXmlData,i.fileName)},i.modalOptions={title:r.getString("HostUi","hardwareHealth.modal.exportDialogTitle"),contentUrl:"host-ui/resources/host/views/monitor/hardwareHealthExportView.html",size:"lg"},h(t).then(function(e){i.loading=!1,i.cimXmlData=e[n.HARDWARE_STATUS_XML_PROPERTY];var t=e.name;i.fileName=t?t+".xml":"host_health_data.xml",i.modalOptions.title=r.getString("HostUi","hardwareHealth.modal.exportDialogTitle")+" "+t}),a.openPopUp(i)}function h(e){return t.getProperties(e,[n.HARDWARE_STATUS_XML_PROPERTY,"name"])}function f(e,t,i,r){return{id:e,label:i,enabled:!0,onClick:function(){return S(t,r)}}}function S(e,t){var i="com.vmware.vsphere.client.cimmonitor.CimMonitorSpec",r={operationId:t},n=y(t);o.apply(e,i,r,n)}function y(e){var t;switch(e){case n.OPERATION.REFRESH_DATA:t="cimDataBeingRefreshed";break;case n.OPERATION.RESET_EVENTS_LOG:t="cimEventLogBeingReset";break;default:t="cimDataBeingRefreshed"}return r.getString("HostUi",t)}function P(){return{data:[],columnDefs:[{field:"name",displayName:I("sensorHeaderText"),template:function(e){return E(e)}},{field:"status",type:"object",searchable:!1,displayName:I("statusHeaderText"),template:function(e){return V(e.status)},sortable:function(e,t){return _(e,t)}},{field:"reading",displayName:I("readingHeaderText"),template:function(e){return M(e)}}],height:"100%",resizable:!1}}function C(){return{data:[],columnDefs:[{displayName:I("systemEventLogMessageTimestampHeaderText"),field:"timestampFormatted",template:"#:timestampFormatted#",sortable:!1,searchable:!1},{displayName:I("systemEventLogMessageHeaderText"),field:"message",template:function(e){return b(e)},sortable:!1,searchable:!1}],height:"100%",resizable:!1}}function D(e){return{title:I("title"),objectId:e}}function w(e,i){return t.getProperties(e,[i])}function b(e){var t=i.getColumnRenderer("text");return t(["message"],e)}function I(e,t){return r.getString("HostUi","hardwareHealth."+e,t)}function _(e,t){var i=e.status[0].status,r=t.status[0].status;return L[i]-L[r]}function T(e){return e?{oneAlert:I("oneAlert"),oneWarning:I("oneWarning"),nAlerts:I("nAlerts",e.alerts),nWarnings:I("nWarnings",e.warnings),sensor:I("sensor"),sensors:I("sensors",e.all),noAlertsWarningNSensors:I("noAlertOrWarningOutOfNSensors",e.all),noAlertsWarningOneSensor:I("noAlertOrWarningOutOfOneSensor")}:null}function E(e){if(!e.sensorType)return"";var t=i.getColumnRenderer("icon-text");return t(["icon","text"],{icon:k(e.sensorType),text:e.name})}function V(e){if(!e||0===e.length)return"";var t=i.getColumnRenderer("icon-text"),r=e.map(function(e){return t(["icon","text"],{icon:A(e.status),text:e.statusMessage})}).reduce(function(e,t){return e+t});return r}function M(e){var t=i.getColumnRenderer("text");return t(["reading"],e)}function O(e){var t=i.getColumnRenderer("text"),n={sensorId:null!==e.sensorId?e.sensorId:r.getString("HostUi","none.label")};return t(["sensorId"],n)}function A(e){switch(e){case n.status.NORMAL:return"vsphere-icon-status-ok";case n.status.WARNING:return"vsphere-icon-status-warning";case n.status.ALERT:return"vsphere-icon-status-error";case n.status.UNKNOWN:return"vui-icon-datagrid-status-unknown";default:return""}}function k(e){return n.SENSOR_ICONS[e.toLowerCase()]||"vx-icon-other"}function R(e,t,i){var r;return r=e===n.ACTION.EXPORT_XML?t&&i:i}function N(){return c.getUserTimeFormatPreference()}function U(e,t){return c.timestampToText(e,t)}var L={unknown:0,alert:1,warning:2,normal:3};return{createHeaderOptions:D,createSensorTreeListDataSource:l,createSensorTreeListOptions:d,createSensorActionBarOptions:u,createAlertsAndWarningsActionBarOptions:p,createSystemEventLogActionBarOptions:v,createAlertsAndWarningsDatagridOptions:P,createSystemEventLogDatagridOptions:C,requestHardwareHealthData:w,getSensorCountLabels:T,getSensorIcon:k,requestHardwareHealthXmlData:h,getActionStatus:R,getUserTimeFormat:N,getTimestampFormatted:U}}angular.module("com.vmware.vsphere.client.host").service("hardwareHealthService",e),e.$inject=["fileSaverService","dataService","columnRenderersRegistry","i18nService","hardwareHealthConstants","mutationService","clarityModalService","$rootScope","timeFormatterService"]}(),function(){"use strict";function e(e,t,i,r){function n(t,i){return{selectionMode:e.grid.selectionMode.SINGLE,sortMode:e.grid.sortMode.SINGLE,resizable:!0,selectedItems:[],data:[],columnDefs:o(i),height:"100%",editable:{mode:"incell",createAt:"bottom"},save:t}}function o(e){return[{displayName:a("advancedSettings.edit.nameColumnHeader"),field:"key",type:"string",searchable:!1,editable:!1,width:"480px"},{displayName:a("advancedSettings.edit.valueColumnHeader"),field:"value",type:"string",searchable:!1,editable:{validator:{validationFunction:e}}}]}function a(e,i){return t.getString("HostUi",e,i)}function s(e,t){var r=_.values(t),n={hostSettingsChangeset:r},o=a("advancedSettings.edit.taskName");i.apply(e,"com.vmware.vsphere.client.host.config.HostAdvancedSettingsSpec",n,o)}function c(e,t){r.getResourceInfo(e,"advancedSettings").then(function(e){t.data=e.properties})}function l(e){var t={_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.model.key,value:[d(e.model.type),e.values.value]};return t}function d(e){var t;switch(e){case"int":t="java.lang.Integer";break;case"long":t="java.lang.Long";break;case"boolean":t="java.lang.Boolean";break;default:t="java.lang.String"}return t}function u(e){var t={min:null,max:null,enumeration:[]};return _.each(e,function(e){"MININCLUSIVE"===e.type&&(t.min=e.value),"MAXINCLUSIVE"===e.type&&(t.max=e.value),"ENUMERATION"===e.type&&t.enumeration.push(e.value)}),t}function p(e){var t,i,r,n="true, false",o={allowedMin:null,allowedMax:null,allowedValues:null,description:null};_.isEmpty(e)||(t=e[0].staticValueSpace,i=e[0].description,r=e[0].type);var a=u(t);return"boolean"===r?o.allowedValues=n:o.allowedValues=a.enumeration.filter(function(e){return!!e.trim()}).join(", "),o.allowedMin=a.min,o.allowedMax=a.max,o.description=i,o}function v(e,t){var i={status:!0,message:null};return e?(i=m(t,e.type),i.status&&(i=h(t,e.staticValueSpace)),i):i}function m(e,t){var i={status:!1,message:a("advancedSettings.invalidInput")};switch(t){case"int":case"long":g(e)&&(i.status=!0,i.message=null);break;case"boolean":"false"!==e&&"true"!==e||(i.status=!0,i.message=null);break;default:i.status=!0,i.message=null}return i}function g(e){var t=Number.parseInt(e);return t<=Number.MIN_SAFE_INTEGER||t>=Number.MAX_SAFE_INTEGER||"NaN"!==e&&t.toString()===e}function h(e,t){var i={status:!0,message:null};return t?(null!==t.min&&t.min>Number.MIN_SAFE_INTEGER&&t.min>e&&(i.status=!1,i.message=a("advancedSettings.numberInput.minError",t.min)),null!==t.max&&t.max<Number.MAX_SAFE_INTEGER&&t.max<e&&(i.status=!1,i.message=a("advancedSettings.numberInput.maxError",t.max)),t.enumeration.length>0&&t.enumeration.indexOf(e)<0&&(i.status=!1,i.message=a("advancedSettings.invalidInput")),i):i}return{getGridOptions:n,updateAdvancedSystemSettings:s,loadAdvancedSystemSettings:c,createOptionValue:l,getOptionValueSpec:u,getSelectedSettingData:p,getValidationResult:v}}angular.module("com.vmware.vsphere.client.host").service("advancedSystemSettingsService",e),e.$inject=["vuiConstants","i18nService","mutationService","resourceService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){return e.hasValidationError?(e.modalOptions.alerts=[{text:r.getString("HostUi","advancedSettings.validationError"),type:i.validationBanner.type.ERROR}],!1):(e.changedHostAdvancedSettings&&(t.updateAdvancedSystemSettings(d,e.changedHostAdvancedSettings),e.changedHostAdvancedSettings=null),!0)}function a(){n.getResourceInfo(d,"advancedSettings").then(function(e){p=e.properties,u.gridOptions.data=e.properties})}function s(i){var r=i.parent().parent().find("td:first-child").text(),n=u.gridOptions.selectedItems[0];void 0===n||r!==n.key||u.validationMap[r]||(u.validationMap[r]={type:n.type,staticValueSpace:t.getOptionValueSpec(n.staticValueSpace)});var o=u.validationMap[r],a=i.val(),s=t.getValidationResult(o,a);return s.status===!1?(e.hasValidationError=!0,i.attr("data-validationFunction-msg",s.message)):e.hasValidationError=!1,s.status}function c(i){var r=t.createOptionValue(i);e.changedHostAdvancedSettings||(e.changedHostAdvancedSettings={}),e.changedHostAdvancedSettings[r.key]=r}function l(){var e=u.searchTerm.toLowerCase();u.gridOptions.data=p.filter(function(t){var i=t.value||"";return t.key.toLowerCase().indexOf(e)!==-1||i.toLowerCase().indexOf(e)!==-1})}e.modalOptions.onSubmit=o.bind(this);var d=e.modalOptions.dialogData.availableTargets[0],u=this,p=[];u.selectedSetting={},u.validationMap={},u.gridOptions=t.getGridOptions(c,s),u.filterPlaceholderText=r.getString("Common","filter.label"),u.filterSettings=l,u.searchTerm="",e.hasValidationError=!1,u.preselectComparator=function(t){var i=!1,r=e.modalOptions.dialogData.selectedItems;return r&&!_.isEmpty(r)&&(i=t.key===r[0].key),i},a(),e.$watch(function(){return u.gridOptions.selectedItems},function(e){u.selectedSetting=t.getSelectedSettingData(e)})}angular.module("com.vmware.vsphere.client.host").controller("EditAdvancedSystemSettingsController",e),e.$inject=["$scope","advancedSystemSettingsService","vuiConstants","i18nService","resourceService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("authConstants",{loginType:{LOGIN_USING_CREDENTIAL:"credential",LOGIN_USING_CAM_SERVER:"camServer"}})}(),function(){"use strict";function e(e,t,i,r){function n(){return e.modalOptions.isAlertClosed=!0,e.modalOptions.alerts=[],a(e.certificateInfo.ip),o(e.certificateInfo.path),0===e.modalOptions.alerts.length?(i.addCertificate(c,e.certificateInfo),!0):void(e.modalOptions.isAlertClosed=!1)}function o(t){t||(e.modalOptions.alerts=i.addAlertMessage("importCert.error.certPathRequired",e.modalOptions.alerts))}function a(t){t?r.isAddressValid(t)||(e.modalOptions.alerts=i.addAlertMessage("importCert.error.serverIPInvalid",e.modalOptions.alerts)):e.modalOptions.alerts=i.addAlertMessage("importCert.error.serverIPRequired",e.modalOptions.alerts)}var s=this;e.certificateInfo={path:"",ip:""},s.settingHeader={title:t.getString("HostUi","authJoinDomain.activeDirAuthChoicesBlockTitle")};var c=e.modalOptions.dialogData.availableTargets[0];e.modalOptions.onSubmit=n}angular.module("com.vmware.vsphere.client.host").controller("authAddCertificateController",e),e.$inject=["$scope","i18nService","hostAuthService","ipParserService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){return e.modalOptions.isAlertClosed=!0,l(e.domainInfo),0===e.modalOptions.alerts.length?(o.joinDomain(m,e.domainInfo),!0):void(e.modalOptions.isAlertClosed=!1)}function c(){r.getProperties(m,["isProxyAuthenticationSupported"]).then(function(t){e.isProxyAuthenticationSupported=t.isProxyAuthenticationSupported})}function l(t){e.modalOptions.alerts=[],u(t.domain),t.loginType===i.loginType.LOGIN_USING_CREDENTIAL?d(t.username):p(t.ipAddress)}function d(t){t||(e.modalOptions.alerts=o.addAlertMessage("authJoinDomain.error.usernameRequired",e.modalOptions.alerts))}function u(t){t?n.isDomainValid(t)||(e.modalOptions.alerts=o.addAlertMessage("authJoinDomain.error.domainInvalid",e.modalOptions.alerts)):e.modalOptions.alerts=o.addAlertMessage("authJoinDomain.error.domainRequired",e.modalOptions.alerts)}function p(t){t?a.isAddressValid(t)||(e.modalOptions.alerts=o.addAlertMessage("authJoinDomain.error.camServerInvalid",e.modalOptions.alerts)):e.modalOptions.alerts=o.addAlertMessage("authJoinDomain.error.camServerRequired",e.modalOptions.alerts)}var v=this;v.settingHeader={title:t.getString("HostUi","authJoinDomain.activeDirAuthChoicesBlockTitle")};var m=e.modalOptions.dialogData.availableTargets[0];e.loginType=i.loginType,e.isProxyAuthenticationSupported=!0,e.domainInfo={domain:"",loginType:i.loginType.LOGIN_USING_CREDENTIAL,username:"",password:"",ipAddress:""},e.modalOptions.onSubmit=s,c()}angular.module("com.vmware.vsphere.client.host").controller("authJoinDomainController",e),e.$inject=["$scope","i18nService","authConstants","dataService","hostDataValidationService","hostAuthService","ipParserService"]}(),function(){"use strict";function e(e,t,i,r,n,o){var a="isSmartCardAuthenticationEnabled",s="smartCardTrustAnchors",c=e._route.objectId;this.objectsToWatch=[c],this.settingsViewHeaderAccessor={},this.smartcardSettingsViewHeaderAccessor={},this.nfsKerberosCredentialsViewAccessor={},this.headerOptions=o.hostAuthHeaderOptions(c),this.smartCardHeaderOptions=o.smartCardHeaderOptions(),this.nfsKerberosHeaderOptions=o.nfsKerberosHeaderOptions(),this.smartCardData={},this.data={},this.smartcardSupported=!1,this.nfsKerberosSupported=!1,this.userName=i.getString("StorageUi","nfsCredentials.noUserName"),this.enabled=!1,this.state="",this.liveRefreshProperties=["config.network.dnsConfig.searchDomain","config.network.dnsConfig.address","config.network.netStackInstance","config.domainList","config.authenticationManagerInfo.authConfig","config.service.service"],this.refresh=function(){this.getViewData(),this.settingsViewHeaderAccessor&&this.settingsViewHeaderAccessor.refresh&&this.smartcardSettingsViewHeaderAccessor&&this.smartcardSettingsViewHeaderAccessor.refresh&&this.nfsKerberosCredentialsViewAccessor&&this.nfsKerberosCredentialsViewAccessor.refresh&&(this.settingsViewHeaderAccessor.refresh(),this.smartcardSettingsViewHeaderAccessor.refresh(),this.nfsKerberosCredentialsViewAccessor.refresh())},this.getViewData=function(){t.getData(c,"com.vmware.vsphere.client.h5.host.model.authentiaction.AuthenticationServicesData").then(function(e){e&&(this.smartcardSupported=e.isSmartCardAuthenticationSupported,this.smartcardSupported&&e.isHostConnected&&t.getProperties(c,[a,s]).then(function(e){e&&(this.smartCardData.enabled=o.getSmartCardEnabledStatus(e.isSmartCardAuthenticationEnabled),this.setGridOptionsData(e))}.bind(this)),this.data.domain=i.getString("HostUi","none.label"),this.data.trustedDomain=i.getString("HostUi","none.label"),this.setAuthenticationStatus(e),this.buildPropertyViewData(e),this.nfsKerberosSupported=e.isNfsSupproted,this.nfsKerberosSupported&&this.setNfsKerberosCredentials(e))}.bind(this))},this.setGridOptionsData=function(e){e.smartCardTrustAnchors&&n.getUserTimeFormatPreference().then(function(t){this.datagridOptions=o.getDatagridOptions(t),this.datagridOptions.data=e.smartCardTrustAnchors}.bind(this))},this.setAuthenticationStatus=function(e){if(e.isActiveDirectoryAuthenticationUsed){this.data.authStatus=i.getString("HostUi","authServices.directory.devices.active");var t=e.authenticationConfig;for(var r in t)if("com.vmware.vim.binding.vim.host.ActiveDirectoryInfo"===t[r]._type){this.data.domain=t[r].joinedDomain,this.data.trustedDomain=t[r].trustedDomain;break}}else this.data.authStatus=i.getString("HostUi","authServices.directory.devices.local")},this.buildPropertyViewData=function(){var e=r.createPropertyViewBuilder(),t=e.category("");o.buildDirectoryServicesConfigSection(t,this.data.authStatus),o.buildDomainSettingsSection(t,this.data),this.propertyViewData=e.build()},this.setNfsKerberosCredentials=function(e){e.inDomain?e.nfsKerberosUser?this.state=i.getString("StorageUi","nfsCredentials.state.enabled"):this.state=i.getString("StorageUi","nfsCredentials.state.noUser"):this.state=i.getString("StorageUi","nfsCredentials.state.noDomain"),this.enabled=e.inDomain&&e.nfsKerberosUser,this.userName=this.enabled?e.nfsKerberosUser:i.getString("StorageUi","nfsCredentials.noUserName")},this.getViewData()}angular.module("com.vmware.vsphere.client.host").controller("AuthServicesController",e),e.$inject=["$scope","dataService","i18nService","vxPropertyViewService","timeFormatterService","hostAuthService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){t.getProperties(s,["nfsKerberosUser"]).then(function(e){e?(v.username=e.nfsKerberosUser,u=!e.nfsKerberosUser,u&&(p=i.getString("HostUi","nfsCredentials.edit.emptyUserName"))):(u=!0,p=i.getString("HostUi","nfsCredentials.edit.emptyUserName")),v.loading=!1})["catch"](function(e){v.loading=!1,o.reject(e)})}var s=e.modalOptions.objectId,c=!1,l=!0,d=!0,u=!0,p=i.getString("HostUi","nfsCredentials.edit.emptyPassword"),v=this;v.loading=!0,v.usernameError={message:"",isVisible:!1},v.passwordError={message:"",isVisible:!1},e.modalOptions.onSubmit=function(){return e.modalOptions.alerts=[],u||d||!l?(c||v.updateValue(),e.modalOptions.alerts=[{text:p,type:n.notifications.type.ERROR}],!1):(r.apply(s,"com.vmware.vsphere.client.storage.NfsEditCredentialsSpec",{userName:v.username,password:v.password}),!0)},v.updateValue=function(){c=!0,l=v.password===v.confirmPassword,d=!v.password||""===v.password,u=!v.username||""===v.username,v.passwordError.isVisible=!l||d,v.usernameError.isVisible=u,u&&(p=v.usernameError.message=i.getString("HostUi","nfsCredentials.edit.emptyUserName")),d?p=v.passwordError.message=i.getString("HostUi","nfsCredentials.edit.emptyPassword"):l||(p=v.passwordError.message=i.getString("HostUi","nfsCredentials.edit.confirmPassword.error"))},a()}angular.module("com.vmware.vsphere.client.host").controller("EditNfsKerberosCredentialsController",e),e.$inject=["$scope","dataService","i18nService","mutationService","vuiConstants","$q"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(t){e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0;var i=t.target.files[0];p.readAsArrayBuffer(i),u.prop("value","")}function l(){return{actionId:"removeCertificates",label:a.getString("HostUi","smartCardAuthentication.removeCertificate"),tooltipText:a.getString("HostUi","smartCardAuthentication.removeCertificate"),enabled:!1,iconClass:"vx-icon-removeIcon"}}function d(){return{actionId:"addCertificate",label:a.getString("HostUi","smartCardAuthentication.addCertificate"),tooltipText:a.getString("HostUi","smartCardAuthentication.addCertificate"),enabled:!0,iconClass:"vx-icon-addIcon",onClick:function(){u.click()}}}this.loading=!0,this.objectId=e.modalOptions.objectId,this.gridWidget=null,this.isSmartCardAuthenticationEnabled=!1,this.isSmartCardAuthenticationEnabledOldState=!1,this.originalSmartCardTrustAnchors=[];var u=t.find('input[type="file"]'),p=new FileReader,v=d.call(this),m=l.call(this);u.on("change",c.bind(this)),p.onload=function(t){t.target.result&&n.validateCertificate(this.objectId,t.target.result).then(function(t){if(t&&t.result){var i=_.some(this.datagridOptions.data,function(e){return e.serialNumber===t.result[0].serialNumber});i||this.datagridOptions.data.push(t.result[0])}else e.modalOptions.alerts=[{text:a.getString("HostUi","editSmartCardAuthentication.error"),type:s.notifications.type.ERROR}],e.modalOptions.isAlertClosed=!1}.bind(this))}.bind(this),e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,this.getViewData=function(){i.getProperties(this.objectId,["isSmartCardAuthenticationEnabled","smartCardTrustAnchors"]).then(function(e){r.getUserTimeFormatPreference().then(function(t){this.initializeData(e,t)}.bind(this))}.bind(this))},e.modalOptions.onSubmit=function(){return n.updateCertificateData(this.objectId,this.originalSmartCardTrustAnchors,this.datagridOptions.data,this.isSmartCardAuthenticationEnabled,this.isSmartCardAuthenticationEnabledOldState)}.bind(this),e.$watch(function(){if(this.datagridOptions)return this.datagridOptions.selectedItems.length}.bind(this),function(e){m.enabled=e>0}.bind(this)),e.$on("kendoWidgetCreated",function(e,t){t&&t.constructor===kendo.ui.Grid&&(this.gridWidget=t)}.bind(this)),e.$watchCollection(function(){if(this.datagridOptions&&this.datagridOptions.data)return this.datagridOptions.data}.bind(this),function(e,t){this.gridWidget&&e!==t&&(this.gridWidget.dataSource.data(e),this.gridWidget.refresh())}.bind(this)),this.initializeData=function(e,t){this.isSmartCardAuthenticationEnabled=e.isSmartCardAuthenticationEnabled,this.isSmartCardAuthenticationEnabledOldState=e.isSmartCardAuthenticationEnabled,this.datagridOptions=n.getDataGridOptions(t),this.originalSmartCardTrustAnchors=e.smartCardTrustAnchors,
this.datagridOptions.data=angular.merge([],e.smartCardTrustAnchors),m.onClick=function(){var e=this.datagridOptions.selectedItems[0];this.datagridOptions.data=_.filter(this.datagridOptions.data,function(t){return e.serialNumber!==t.serialNumber})}.bind(this),this.datagridOptions.actionBarOptions.actions=[v,m],this.loading=!1},this.getViewData()}angular.module("com.vmware.vsphere.client.host").controller("EditSmartCardAuthenticationController",e),e.$inject=["$scope","$element","dataService","timeFormatterService","editSmartCardAuthService","$timeout","i18nService","clarityConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(i){return[{field:"subject",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.subject")},{field:"issuer",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.issuer")},{field:"version",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.version")},{field:"validFrom",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.validFrom"),template:function(t){return e.timestampToText(parseInt(t.validFrom),i)}},{field:"validTo",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.validTo"),template:function(t){return e.timestampToText(parseInt(t.validTo),i)}},{field:"algorithm",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.algorithm")},{field:"publicKey",sortable:!1,searchable:!1,displayName:t.getString("HostUi","smartCardAuthnetication.certificates.publicKeyAlgorithm")}]}function o(e){return{columnDefs:n(e),data:[],selectionMode:r.grid.selectionMode.SINGLE,selectedItems:[],actionBarOptions:{actions:[]},resizable:!1,height:"275px"}}function a(e,t){var r=new Int8Array(t),n=Array.prototype.slice.call(r);return i.validate(e,"com.vmware.vsphere.client.host.DecodePemFileSpec",{file:n})}function s(e,t,r,n,o){function a(e){return _.object(_.map(e,function(e){return e.serialNumber}),e)}var s=a(t),c=a(r),l=_.map(_.filter(r,function(e){return!s.hasOwnProperty(e.serialNumber)}),function(e){return e.certificateAsString}),d=_.map(_.filter(t,function(e){return!c.hasOwnProperty(e.serialNumber)}),function(e){return{algorithm:e.algorithm,thumbprint:e.thumbprint}}),u=n!==o,p={removeCertificates:d,addCertificates:l,enable:u?n:null};return _.isEmpty(d)&&_.isEmpty(l)&&!u||i.apply(e,"com.vmware.vsphere.client.host.SmartCardAuthSettingsSpec",p),!0}return{getDataGridOptions:o,validateCertificate:a,updateCertificateData:s}}angular.module("com.vmware.vsphere.client.host").service("editSmartCardAuthService",e),e.$inject=["timeFormatterService","i18nService","mutationService","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r,n){function o(t){e.apply(t,"com.vmware.vsphere.client.host.DomainSettingSpec",{})}function a(i,r){var n={domain:r.domain};r.loginType===t.loginType.LOGIN_USING_CREDENTIAL?(n.username=r.username,n.password=r.password):n.camServer=r.ipAddress,e.apply(i,"com.vmware.vsphere.client.host.DomainSettingSpec",n)}function s(t,i){var r={certPath:i.path,serverIp:i.ip};e.apply(t,"com.vmware.vsphere.client.host.ImportCertificateInfo",r)}function c(e,t){var n={text:i.getString("HostUi",e),type:r.notifications.type.ERROR};return t.push(n),t}function l(e){return{title:i.getString("HostUi","authServices.settings.tabLabel"),objectId:e,actions:[{actionUid:"vsphere.core.host.actions.authenticationServiceSettingsAddCertificate",customLabel:i.getString("HostUi","importCert.actionLabel")},{actionUid:"vsphere.core.host.actions.authenticationServiceSettingsJoinDomain",customLabel:i.getString("HostUi","authJoinDomain.actionLabel")},{actionUid:"vsphere.core.host.actions.authenticationServiceSettingsLeaveDomain",customLabel:i.getString("HostUi","authLeaveDomain.actionLabel")}]}}function d(){return{title:i.getString("HostUi","smartCardAuthnetication.title"),actions:[{actionUid:"vsphere.core.host.actions.editSmartCardAuthentication",customLabel:i.getString("HostUi","smartCardAuthentication.editAction.label")}]}}function u(){return{title:i.getString("StorageUi","nfsCredentials.blockTitle"),actions:[{actionUid:"vsphere.core.host.actions.clearNfsKerberosCredentials",customLabel:i.getString("HostUi","nfsCredentials.clear.actionLabel")},{actionUid:"vsphere.core.host.actions.editNfsKerberosCredentials",customLabel:i.getString("HostUi","nfsCredentials.edit.actionLabel")}]}}function p(e){var t;return t=e?i.getString("HostUi","smartCardAuthentication.enabled.label"):i.getString("HostUi","smartCardAuthentication.disabled.label")}function v(e){return{selectionMode:"single",sortMode:"single",searchable:!1,columnDefs:[{field:"subject",sortable:!1,searchable:!1,displayName:i.getString("HostUi","smartCardAuthnetication.certificates.subject")},{field:"issuer",sortable:!1,searchable:!1,displayName:i.getString("HostUi","smartCardAuthnetication.certificates.issuer")},{field:"validTo",sortable:!1,searchable:!1,displayName:i.getString("HostUi","smartCardAuthnetication.certificates.validTo"),template:function(t){return n.timestampToText(parseInt(t.validTo),e)}}],data:[],height:"200px",pageConfig:{hidePager:!0}}}function m(e,t){e.section("domainSettings").title(i.getString("HostUi","authServices.domain.settingsTitle")).property(i.getString("HostUi","authServices.domain.settings.domain"),t.domain).property(i.getString("HostUi","authServices.domain.settings.trustedControllers"),t.trustedDomain)}function g(e,t){e.section("directoryServicesConfig").title(i.getString("HostUi","authServices.directory.configTitle")).property(i.getString("HostUi","authServices.directory.typeTitle"),t)}return{leaveDomain:o,joinDomain:a,addCertificate:s,addAlertMessage:c,hostAuthHeaderOptions:l,smartCardHeaderOptions:d,nfsKerberosHeaderOptions:u,getSmartCardEnabledStatus:p,getDatagridOptions:v,buildDomainSettingsSection:m,buildDirectoryServicesConfigSection:g}}angular.module("com.vmware.vsphere.client.host").service("hostAuthService",e),e.$inject=["mutationService","authConstants","i18nService","vuiConstants","timeFormatterService"]}(),function(){"use strict";function e(e,t,i,r){function n(e,i){var n;n=e?t.getString("VmUi","VmHardware.HWVersion.short."+e):t.getString("VmUi","defaultVmHwVersionView.default"),i&&(o.objectsToWatch.push(r.getVsphereObjectId(i)),"ClusterComputeResource"===i.type&&(n=t.getString("VmUi","defaultVmHwVersionView.compatibilityHostInCluster",n))),o.defaultVmHwVersion=n}var o=this;e.i18nService=t,o.objectsToWatch=[e._route.objectId],o.liveRefreshProperties=["configurationEx","configuration"],o.headerOptions={title:t.getString("VmUi","defaultVmHardwareVersion")};var a,s=e._view.contentSpec,c=[];s&&s.metadata&&(s.metadata.editActionId&&(o.headerOptions.actions=[{actionUid:s.metadata.editActionId,customLabel:t.getString("Common","settingsView.defaultEditActionLabel")}]),s.metadata.defaultHardwareVersionProperty&&(a=s.metadata.defaultHardwareVersionProperty,c.push(a)),s.metadata.watchParentForChanges&&c.push("parent")),c.length>0&&a&&(o.fetchViewData=function(){i.getProperties(e._route.objectId,c).then(function(e){n(e[a],e.parent)})},o.fetchViewData())}angular.module("com.vmware.vsphere.client.host").controller("DefaultVmCompatibilityController",e),e.$inject=["$scope","i18nService","dataService","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r){function n(){t.getProperties(c,["fullAgentVmSettings"]).then(function(e){s.datastoreOptions=e.fullAgentVmSettings.datastores;var t=e.fullAgentVmSettings.selectedDatastore;if(t){var i=o(s.datastoreOptions,t);s.selectedDatastore=s.datastoreOptions[i]}else s.selectedDatastore=null;s.networkOptions=e.fullAgentVmSettings.networks;var r=e.fullAgentVmSettings.selectedNetwork;if(r){var n=o(s.networkOptions,r);s.selectedNetwork=s.networkOptions[n]}else s.selectedNetwork=null;s.loading=!1})}function o(e,t){return _.findIndex(e,function(e){return _.isEqual(e.value,t)})}function a(){return i.apply(c,"com.vmware.vsphere.client.h5.host.config.spec.AgentVmSettingsSpec",{datastore:s.selectedDatastore?s.selectedDatastore.value:null,network:s.selectedNetwork?s.selectedNetwork.value:null},r.getString("HostUi","settings.agentVm.operation")),!0}var s=this;s.loading=!0;var c=e.modalOptions.dialogData.availableTargets[0];e.modalOptions.onSubmit=a.bind(this),n()}angular.module("com.vmware.vsphere.client.host").controller("EditAgentVmSettingsController",["$scope","dataService","mutationService","i18nService",e])}(),function(){"use strict";function e(e,t,i,r,n,o,a){var s=this,c="unspecified";s.popupParams={title:t.getString("Common","help"),message:t.getString("Common","signpost.hardwareVersionSelector"),linkLabel:t.getString("HostUi","edit.defaultvm.helperlink.label"),linkFunction:function(){n.showHelpPage(o.EDIT_DEFAULT_VM_COMPATIBILITY_ID)}},s.loading=!0,e.modalOptions.submitDisabled=!0,e.i18nService=t;var l=e._route.objectId;e.modalOptions.onSubmit=function(){if(s.loading)return!1;var e="";return s.selectedOption.key!==c&&(e=s.selectedOption.key),r.apply(l,"com.vmware.vsphere.client.mixed.DefaultHwVersionSpec",{hwVersionKey:e},"EditDefaultVmCompatibility"),!0},s.compatibilityOptions=[];var d=a.getEntityType(l);i.getProperties(l,["optionDescriptorsWithCreateSupported","defaultHardwareVersionKey"]).then(function(i){var r=i.optionDescriptorsWithCreateSupported,n=0;s.compatibilityOptions.push({key:c,localizedShortString:t.getString("HostUi","Datacenter"===d?"defaultVmCompatibilityDialog.short.unspecifiedForDc":"defaultVmCompatibilityDialog.short.unspecifiedForCr"),localizedDescriptionString:t.getString("HostUi","Datacenter"===d?"defaultVmCompatibilityDialog.unspecifiedForDc":"defaultVmCompatibilityDialog.unspecifiedForCr")});var o=_.map(r,function(e,i){return e.defaultConfigOption&&(n=i+1),{key:e.key,localizedShortString:t.getString("HostUi","defaultVmCompatibilityDialog.short."+e.key),localizedDescriptionString:t.getString("HostUi","defaultVmCompatibilityDialog."+e.key)}});s.compatibilityOptions=s.compatibilityOptions.concat(o),i.defaultHardwareVersionKey?s.selectedOption=s.compatibilityOptions[n]:s.selectedOption=s.compatibilityOptions[0],s.loading=!1,e.modalOptions.submitDisabled=!1})}angular.module("com.vmware.vsphere.client.host").controller("EditDefaultVmCompatiblityController",e),e.$inject=["$scope","i18nService","dataService","mutationService","helpService","helpConstants","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){d(!0),i.getData(p.hostId,"com.vmware.vsphere.client.h5.host.model.FirewallSettingsData").then(function(t){p.originalData=t.connections,p.modifiedData=_.map(t.connections,function(e){return angular.merge({},e)});var i=_.map(p.modifiedData,function(e){return angular.merge({_rawItem:e},e)});p.dataGridOriginalData=i,e.datagridOptions.data=i,d(!1)})}function a(e){$("[data-uid="+e+"] td:nth-child(2) td:nth-child(2)").mousedown().mouseup(),$('tbody[role="rowgroup"] tr').attr("aria-selected","false").removeClass("k-state-selected"),$("[data-uid="+e+"]").attr("aria-selected","true").addClass("k-state-selected")}function s(t,i,r){if(e.ipError=!1,e.ipErrorShow=!1,r){if(t){var n=p.firewallService.removeInvalidData(i),o=n?n.filteredItems:"",a=_.isEmpty(o)?[]:p.firewallService.createRawIpList(o);t.rawIpList.ipAddress=a,t.ipList=o;var s=_.isEmpty(o)?[]:p.firewallService.createRawNetworkList(o);t.rawIpList.ipNetwork=s,t.rawIpList.allIp=r,t._rawItem.rawIpList.allIp=r,t._rawItem.rawIpList.ipNetwork=s,t._rawItem.rawIpList.ipAddress=a,t._rawItem.ipList=o}return!0}if(p.firewallService.validateIpAddresses(i)){if(t){var c=p.firewallService.createRawIpList(i);t.rawIpList.ipAddress=c,t.ipList=i;var l=p.firewallService.createRawNetworkList(i);t.rawIpList.ipNetwork=l,t.rawIpList.allIp=r,t._rawItem.rawIpList.allIp=r,t._rawItem.rawIpList.ipNetwork=l,t._rawItem.rawIpList.ipAddress=c,t._rawItem.ipList=i}return!0}return e.invalidItems=p.firewallService.removeInvalidData(i).invalidItems,e.ipError=!0,e.ipErrorShow=!0,!1}function c(e){return t.getString("HostUi",e)}function l(){var t=s(e.datagridOptions.selectedItems[0],e.ipObject.ipList,e.ipObject.allIp);if(t){var i=p.firewallService.createSpec(p.modifiedData,p.originalData);return!!_.isEmpty(i)||(r.apply(p.hostId,"com.vmware.vsphere.client.h5.host.firewall.spec.FirewallConfigurationSpec",i,c("editFirewallSettingsDialog.applySecurityProfileOperationName")),!0)}}function d(t){e.modalOptions.submitDisabled=t,p.loading=t}function u(){var t=["serviceName","serviceKey","daemonStatus","inboundDirectionInfo.combinedPorts","outboundDirectionInfo.combinedPorts"];e.datagridOptions.data=p.firewallService.filterSettings(p.dataGridOriginalData,p.searchTerm,t)}var p=this;p.hostId=e.modalOptions.dialogData.availableTargets[0],p.firewallService=n,p.filterPlaceholderText=t.getString("Common","filter.label"),p.searchTerm="",p.dataGridOriginalData=[],p.filterSettings=u,e.datagridOptions=p.firewallService.getDataGridOptions(),e.ipObject={},p.getViewData=o,e.modalOptions.onSubmit=l,e.$watch("ipObject.ipList",function(t){e.ipError=!p.firewallService.validateIpAddresses(t)}),e.$watch("datagridOptions.selectedItems",function(t,i){if(e.ipErrorShow=!1,t&&1===t.length){e.selectedDatagridItem=!0;var r=p.firewallService.removeInvalidData(e.ipObject.ipList);e.ipError&&!e.ipObject.allIp?i&&(e.datagridOptions.selectedItems[0]=i[0],a(i[0].uid),e.invalidItems=r.invalidItems,e.ipErrorShow=!0):(e.ipError&&e.ipObject.allIp&&(e.ipObject.ipList=r.filteredItems),i[0]&&s(i[0],e.ipObject.ipList,e.ipObject.allIp),e.datagridOptions.selectedItems[0]=t[0],"all"!==t[0].ipList.toLowerCase()?e.ipObject.ipList=t[0].ipList:e.ipObject.ipList=p.firewallService.createIpListFromRawData(t[0].rawIpList),e.ipObject.allIp=t[0].rawIpList.allIp)}else e.selectedDatagridItem=!1}),o()}angular.module("com.vmware.vsphere.client.host").controller("EditFirewallSettingsController",e),e.$inject=["$scope","i18nService","dataService","mutationService","editFirewallSettingsService"]}(),function(){"use strict";function e(e,t,i){function r(e){var t="",i="";return e.ipAddress&&e.ipAddress.length>0&&(t=e.ipAddress.join()),e.ipNetwork&&e.ipNetwork.length>0&&_.each(e.ipNetwork,function(t,r){i+=t.network+"/"+t.prefixLength,r!==e.ipNetwork.length-1&&(i+=", ")}),""!==t&&""!==i?t+", "+i:""!==t&&""===i?t:""===t&&""!==i?i:""}function n(e){var t=[];if(e){var i=e.split(",");_.each(i,function(e){e.indexOf("/")===-1&&t.push(e.trim())})}return t}function o(e){if(e){var t=e.split(","),i=_.filter(t,function(e){return u(e)}),r=_.filter(t,function(e){return!u(e)});return{filteredItems:i.join(),invalidItems:r.join()}}}function a(e){if(!e)return!0;if(""===e)return!0;var t=e.split(",");return _.every(t,function(e){return u(e)})}function s(e){var t=[];if(e){var i=e.split(",");_.each(i,function(e){if(e.indexOf("/")>-1){var i=e.split("/");t.push({network:i[0].trim(),prefixLength:parseInt(i[1])})}})}return t}function c(){return{height:"100%",selectionMode:t.grid.selectionMode.SINGLE,selectedItems:[],resizable:!0,data:[],columnDefs:v(),sortOrder:[{field:"serviceName",dir:"asc"}],groupOrder:[{field:"group",dir:"asc"}]}}function l(e,t){var i={},r=y(e,t),n=_.isEmpty(r.connectionsWithModifiedIpList),o=_.isEmpty(r.connectionsWithModifiedEnabledState);return o&&n?i:i=n?{rulesetToEnabledState:f(r.connectionsWithModifiedEnabledState)}:o?{ipNetworkConfigurationSpec:S(r.connectionsWithModifiedIpList)}:{rulesetToEnabledState:f(r.connectionsWithModifiedEnabledState),ipNetworkConfigurationSpec:S(r.connectionsWithModifiedIpList)}}function d(e){return i.getString("HostUi",e)}function u(t){if(t=t.trim(),e.isIpv6AddressValid(t)||e.isIpv4AddressValid(t))return!0;var i=t.split("/");return p(i)}function p(t){if(t&&2===t.length){var i=t[0],r=parseInt(t[1]),n=e.isIpv4AddressValid(i)&&r>=0&&r<32,o=e.isIpv6AddressValid(i)&&r>=0&&r<=128;return n||o}return!1}function v(){return[{displayName:d("editFirewallSettingsDialog.grid.column.groupLabel"),field:"group",visible:!1},{displayName:d("firewallConnection.serviceName"),field:"serviceName",filterable:!1,searchable:!1,template:function(e){return m(e)}},{displayName:d("editFirewallSettingsDialog.grid.column.inbound"),field:"inboundDirectionInfo.combinedPorts",filterable:!1,searchable:!1,template:function(e){return e.inboundDirectionInfo.combinedPorts||d("none.label")}},{displayName:d("editFirewallSettingsDialog.grid.column.outbound"),field:"outboundDirectionInfo.combinedPorts",filterable:!1,searchable:!1,template:function(e){return e.outboundDirectionInfo.combinedPorts||d("none.label")}},{displayName:d("editFirewallSettingsDialog.grid.column.daemonStatus"),field:"daemonStatus",filterable:!1,searchable:!1,template:function(e){return w(e.daemonStatus)}}]}function m(e){return'<label>  <input type="checkbox"      ng-model="dataItem.enabled"     ng-change="dataItem._rawItem.enabled = dataItem.enabled">  {{dataItem.serviceName}}</label>'}function g(e,t){return _.filter(e,function(e,i){return e.enabled!==t[i].enabled})}function h(e,t){return _.filter(e,function(e,i){return e.rawIpList.allIp!==t[i].rawIpList.allIp||e.ipList!==t[i].ipList})}function f(e){return _.object(_.map(e,function(e){return[e.serviceKey,e.enabled]}))}function S(e){return _.object(_.map(e,function(e){return[e.serviceKey,{allIp:e.rawIpList.allIp,ipAddresses:e.rawIpList.ipAddress,ipNetworks:e.rawIpList.ipNetwork}]}))}function y(e,t){var i=g(e,t),r=h(e,t);return{connectionsWithModifiedEnabledState:i,connectionsWithModifiedIpList:r}}function P(e,t,i){var r=t.toLowerCase();return _.filter(e,function(e){return C(e,r,i)})}function C(e,t,i){return _.some(i,function(i){var r=e[i];return"daemonStatus"===i?D(r,t):r.toLowerCase().indexOf(t)>=0})}function D(e,t){var i=w(e).toLowerCase();return i.indexOf(t)>=0}function w(e){var t="";return t=d(null===e?"editFirewallSettingsDialog.daemonStatus.notPresented":"true"===e?"editFirewallSettingsDialog.daemonStatus.running":"editFirewallSettingsDialog.daemonStatus.stopped")}return{createIpListFromRawData:r,removeInvalidData:o,createRawIpList:n,validateIpAddresses:a,createRawNetworkList:s,getDataGridOptions:c,createSpec:l,filterSettings:P}}angular.module("com.vmware.vsphere.client.host").service("editFirewallSettingsService",e),e.$inject=["ipParserService","vuiConstants","i18nService"]}(),function(){"use strict";function e(e,t,i){function r(){o.loading=!0,t.getProperties(a,["powerSystemCapability","config.powerSystemInfo.currentPolicy"]).then(function(e){o.data=e,o.model.selectedPolicyKey=e["config.powerSystemInfo.currentPolicy"].key,o.loading=!1})}function n(){if(!o.model.selectedPolicyKey)return!0;var t={policyKey:o.model.selectedPolicyKey},r="com.vmware.vsphere.client.host.config.PowerConfigHardwareSpec",n=e.modalOptions.title;return i.apply(a,r,t,n),!0}var o=this,a=e.modalOptions.dialogData.availableTargets[0];o.model={selectedPolicyKey:null},o.data={},e.modalOptions.onSubmit=n.bind(this),r()}angular.module("com.vmware.vsphere.client.host").controller("EditPowerConfigHardwareController",["$scope","dataService","mutationService",e])}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(){u(!0),t.getProperties(m,["powerConfigSoftware"]).then(function(e){c(e.powerConfigSoftware.properties),u(!1)})["catch"](function(e){u(!1),a.reject(e)})}function c(e){_.each(e,function(e){switch(e.name){case"login":v.userName=e.value;break;case"password":v.password=e.value;break;case"bmcIpAddress":v.bmcIpAddress=e.value;break;case"bmcMacAddress":v.bmcMacAddress=e.value}})}function l(){var e={login:v.userName,password:v.password,bmcIpAddress:v.bmcIpAddress,bmcMacAddress:v.bmcMacAddress},t=d(e);return 0===t.length?(i.apply(m,"com.vmware.vsphere.client.h5.host.config.spec.PowerConfigSoftwareSpec",e),!0):(p(t),!1)}function d(e){var t=[];if(""===e.login&&""===e.password&&""===e.bmcIpAddress&&""===e.bmcMacAddress)return t;if(""===e.login||""===e.password||""===e.bmcIpAddress||""===e.bmcMacAddress){var i=o.getString("HostUi","powerConfigSoftware.error.allParametersRequired");t.push(i)}if(""!==e.bmcIpAddress&&!r.isAddressValid(e.bmcIpAddress)){var n=o.getString("HostUi","powerConfigSoftware.error.invalidIpAddress");t.push(n)}return t}function u(t){e.modalOptions.submitDisabled=t,v.loading=t}function p(t){var i=_.map(t,function(e){return{type:n.validationBanner.type.ERROR,text:e}});return e.modalOptions.isAlertClosed=!1,e.modalOptions.alerts=i,!1}var v=this,m=e.modalOptions.dialogData.availableTargets[0];v.loading=!1,e.modalOptions.isAlertClosed=!0,e.modalOptions.onSubmit=l,s()}angular.module("com.vmware.vsphere.client.host").controller("EditPowerConfigSoftwareController",e),e.$inject=["$scope","dataService","mutationService","ipParserService","vuiConstants","i18nService","$q"]}(),function(){function e(e,t,i,r,n,o,a){function s(){t.getData(h,"com.vmware.vsphere.client.h5.host.model.SwapfileLocationData").then(function(e){e&&(f.originalSwapFileLocation=e.vmSwapPlacement,f.swapfileLocation=e.vmSwapPlacement,f.computeResource=e.computeResource,f.isRadioDisabled=!e.isStandalone&&"vmDirectory"!==f.swapfileLocation)}),c()}function c(){t.getProperties(h,["configTargetDatastoreInfo"]).then(function(e){e&&(f.gridOptions.data=l(e.configTargetDatastoreInfo)),v(!1)})["catch"](function(e){v(!1),a.reject(e)})}function l(e){return e=_.filter(e,function(e){return"VVOL"!==e.datastore.type}),f.datastoreMorefs=_.map(e,function(e){return{name:e.name,moRef:e.datastore.datastore}}),_.map(e,function(e){var t=d(e.datastore);return{name:e.name,raw_capacity:e.datastore.capacity,capacity:i.bytesFormat(e.datastore.capacity),raw_provisioned:t,provisioned:i.bytesFormat(t),raw_free:e.datastore.freeSpace,free:i.bytesFormat(e.datastore.freeSpace),type:e.datastore.type,thin:u(e)}})}function d(e){var t=e.freeSpace,i=e.capacity,r=i-t;return e.uncommitted&&!isNaN(e.uncommitted)&&(r+=e.uncommitted),r}function u(e){var t=r.getString("HostUi","swapfile.supported");return e.capability&&!e.capability.perFileThinProvisioningSupported&&(t=r.getString("HostUi","swapfile.notsupported")),t}function p(){var t={swapFileLocationType:f.swapfileLocation,computeResource:f.computeResource,reconfigure:f.swapfileLocation!==f.originalSwapFileLocation};if(f.swapfileLocation&&"hostLocal"===f.swapfileLocation){if(!f.selectedDatastore)return e.modalOptions.alerts=[{type:n.validationBanner.type.ERROR,text:r.getString("HostUi","settings.swapfile.missing.datastore.error")}],e.modalOptions.isAlertClosed=!1,!1;var i=_.find(f.datastoreMorefs,function(e){return e.name===f.selectedDatastore.name});t.datastore=i.moRef}return o.apply(h,"com.vmware.vsphere.client.host.config.HostSwapFileReconfigureSpec",t),!0}function v(t){e.modalOptions.submitDisabled=t,f.loading=t}function m(){return[{displayName:r.getString("HostUi","swapfile.datastore.name"),field:"name"},{displayName:r.getString("HostUi","swapfile.datastore.capacity"),field:"capacity",sortable:function(e,t){return g(e,t,"raw_capacity")}},{displayName:r.getString("HostUi","swapfile.datastore.provisioned"),field:"provisioned",sortable:function(e,t){return g(e,t,"raw_provisioned")}},{displayName:r.getString("HostUi","swapfile.datastore.free"),field:"free",sortable:function(e,t){return g(e,t,"raw_free")}},{displayName:r.getString("HostUi","swapfile.datastore.type"),field:"type"},{displayName:r.getString("HostUi","swapfile.datastore.thin"),field:"thin"}]}function g(e,t,i){return e[i]<t[i]?-1:e[i]>t[i]?1:0}var h=e.modalOptions.dialogData.availableTargets[0],f=this;e.modalOptions.isAlertClosed=!0,f.datastoreMorefs=[],f.datastores=[],v(!0),f.gridOptions={selectionMode:n.grid.selectionMode.SINGLE,sortMode:n.grid.sortMode.SINGLE,searchable:!1,resizable:!0,selectedItems:[],data:[],columnDefs:m(),height:"auto"},e.$watch(function(){return f.gridOptions.selectedItems},function(e){f.selectedDatastore=e[0]}),e.modalOptions.onSubmit=p,s()}angular.module("com.vmware.vsphere.client.host").controller("EditVmSwapfileLocationController",e),e.$inject=["$scope","dataService","bytesFormatter","i18nService","vuiConstants","mutationService","$q"]}(),function(){"use strict";function e(e,t,i,r){function n(){l.loading=!0,r.getData(l.hostId,"com.vmware.vsphere.client.h5.host.model.FirewallSettingsData").then(function(e){var t=_.map(e.connections,function(e){var t=angular.merge({},e);t.directionInfo=t.inboundDirectionInfo,delete t.inboundDirectionInfo,delete t.outboundDirectionInfo;var i=angular.merge({},e);return i.directionInfo=i.outboundDirectionInfo,delete i.inboundDirectionInfo,delete i.outboundDirectionInfo,[t,i]});t=_.flatten(t),t=_.filter(t,function(e){return e.enabled&&(!_.isEmpty(e.directionInfo.rawTcpPorts)||!_.isEmpty(e.directionInfo.rawUdpPorts))}),l.datagridOptions.data=t,l.loading=!1})}function o(){return{title:c("securityProfile.firewall"),objectId:l.hostId,actions:[{actionUid:"vsphere.core.host.actions.editFirewallSettings",customLabel:i.getString("HostUi","editFirewallSettingsButton.label")}]}}function a(){return{height:"100%",selectionMode:t.grid.selectionMode.NONE,selectedItems:[],data:[],columnDefs:s(),sortOrder:[{field:"serviceName",dir:"asc"}],groupOrder:[{field:"directionInfo.direction",dir:"asc"}]}}function s(){return[{displayName:c("firewallConnection.connection"),field:"directionInfo.direction",visible:!1},{displayName:c("firewallConnection.serviceName"),field:"serviceName",template:"#:serviceName#"},{displayName:c("firewallConnection.tcpPort"),field:"directionInfo.tcpPorts",template:function(e){return e.directionInfo.tcpPorts||c("none.label")}},{displayName:c("firewallConnection.udpPort"),field:"directionInfo.udpPorts",template:function(e){return e.directionInfo.udpPorts||c("none.label")}},{displayName:c("firewallConnection.ipAddresses"),field:"ipList",template:function(e){return e.ipList||c("none.label")}}]}function c(e){return i.getString("HostUi",e)}var l=this;l.hostId=e._route.objectId,l.watchForObjects=[l.hostId],l.liveRefreshProperties=["config.firewall.ruleset","config.service.service"],l.datagridOptions=a(),l.headerOptions=o(),l.getViewData=n,n()}angular.module("com.vmware.vsphere.client.host").controller("FirewallSettingsController",e),e.$inject=["$scope","vuiConstants","i18nService","dataService"]}(),function(){"use strict";function e(e,t,i){var r=this,n=e.modalOptions.dialogData.selectedItem,o=e.modalOptions.dialogData.objectId;r.xorgServiceRestart=!0," "===n.configuredType?r.sharedMode="":r.sharedMode=n.configuredType,e.modalOptions.onSubmit=function(){var a={_type:"com.vmware.vim.binding.vim.host.GraphicsConfig",hostDefaultGraphicsType:e.modalOptions.dialogData.defaultGraphicsType,sharedPassthruAssignmentPolicy:e.modalOptions.dialogData.sharedPassthruAssignmentPolicy,deviceType:[{_type:"com.vmware.vim.binding.vim.host.GraphicsConfig$DeviceType",deviceId:n.pciId,graphicsType:r.sharedMode}]};t.apply(o,"com.vmware.vim.binding.vim.host.GraphicsConfig",a),r.xorgServiceRestart&&t.apply(o,"com.vmware.vsphere.client.host.config.ServiceActionSpec",{action:i.action.RESTART,serviceKey:"xorg"}),e.closeModal()}}angular.module("com.vmware.vsphere.client.host").controller("editGraphicDeviceController",e),e.$inject=["$scope","mutationService","hostServicesConstants"]}(),function(){"use strict";function e(e,t,i,r){var n=e._route.objectId;i.getData(n,"com.vmware.vsphere.client.h5.host.model.GraphicsData").then(function(e){e&&(this.defaultGraphicsType=e.defaultGraphicsType,this.sharedPassthruAssignmentPolicy=e.sharedPassthruAssignmentPolicy)}.bind(this)),e.modalOptions.onSubmit=function(){var i=r.getString("HostUi","settings.graphics.hostConfigView.update.operationName");t.apply(n,"com.vmware.vim.binding.vim.host.GraphicsConfig",{_type:"com.vmware.vim.binding.vim.host.GraphicsConfig",hostDefaultGraphicsType:this.defaultGraphicsType,sharedPassthruAssignmentPolicy:this.sharedPassthruAssignmentPolicy},i),e.closeModal()}.bind(this)}angular.module("com.vmware.vsphere.client.host").controller("editHostGraphicsSettingsController",e),e.$inject=["$scope","mutationService","dataService","i18nService"]}(),function(){"use strict";function e(e,t,i){function r(){t.getData(n.hostId,"com.vmware.vsphere.client.h5.host.model.GraphicsData").then(function(e){e&&(n.typeLabel=i.getTypeLabel(e.defaultGraphicsType),n.policyLabel=i.getPolicyLabel(e.sharedPassthruAssignmentPolicy),n.isHostSettingsEnabled=e.isHostSettingsEnabled)})}var n=this;n.hostId=e._route.objectId,n.watchForObjects=[n.hostId],n.headerOptions=i.getHostSettingsHeaderOptions(n.hostId),n.getData=r,n.liveRefreshProperties=["config.graphicsConfig.hostDefaultGraphicsType","config.graphicsConfig.sharedPassthruAssignmentPolicy","config.graphicsInfo"],r()}angular.module("com.vmware.vsphere.client.host").controller("hostGraphicsController",e),e.$inject=["$scope","dataService","hostGraphicsService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(){var i={title:t.getString("HostUi","settings.graphics.editDevicesConfigForm.title"),subTitle:{text:e.dataGridGraphicsOptions.selectedItems[0].pciId},contentTemplate:"host-ui/resources/host/views/settings/graphics/editGraphicDeviceView.html",defaultButton:"submit",dialogData:{selectedItem:e.dataGridGraphicsOptions.selectedItems[0],defaultGraphicsType:e.defaultGraphicsType,sharedPassthruAssignmentPolicy:e.sharedPassthruAssignmentPolicy,objectId:s.hostId}};n.openOkCancelModal(i)}function a(t){e.dataGridVmOptions.data=t}var s=this;s.hostId=e._route.objectId,e.dataGridGraphicsOptions=r.getGridGraphicsOptions(o),e.dataGridVmOptions=r.getGridVmsOptions(),s.headerOptions={title:t.getString("HostUi","settings.graphics.devicesView.title")},s.watchForObjects=[s.hostId],s.liveRefreshProperties=["config.graphicsConfig.deviceType","config.graphicsInfo"],s.loadGraphicsSettingsData=function(){i.getData(s.hostId,"com.vmware.vsphere.client.h5.host.model.GraphicsData").then(function(t){t&&t.graphicsInformation&&(e.defaultGraphicsType=t.defaultGraphicsType,e.sharedPassthruAssignmentPolicy=t.sharedPassthruAssignmentPolicy,e.dataGridGraphicsOptions.data=t.graphicsInformation,t.isHostSettingsEnabled&&(e.dataGridGraphicsOptions.actionBarOptions.actions[0].enabled=!0))})},e.$watch("dataGridGraphicsOptions.selectedItems",function(i,n){i&&i!==n&&(r.getVmInfoAndUpdateGridData(i,a),i[0]&&(e.titleOfGraphicCard=t.getString("HostUi","settings.graphics.vmsView.title",i[0].deviceName)))}),s.loadGraphicsSettingsData()}angular.module("com.vmware.vsphere.client.host").controller("hostGraphicsDevicesController",e),e.$inject=["$scope","i18nService","dataService","hostGraphicsService","clarityModalService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(t){var i;switch(t){case"shared":i=e.getString("HostUi","settings.graphics.type.default.shared");break;case"sharedDirect":i=e.getString("HostUi","settings.graphics.type.default.sharedDirect");break;default:i=""}return i}function s(t){var i;switch(t){case"performance":i=e.getString("HostUi","settings.graphics.hostConfigView.performancePolicy");break;case"consolidation":i=e.getString("HostUi","settings.graphics.hostConfigView.consolidationPolicy");break;default:i=""}return i}function c(t){var i={basic:e.getString("HostUi","settings.graphics.type.default.basic"),shared:e.getString("HostUi","settings.graphics.type.default.shared"),sharedDirect:e.getString("HostUi","settings.graphics.type.default.sharedDirect"),direct:e.getString("HostUi","settings.graphics.type.default.direct")};return i[t]}function l(){return[{displayName:e.getString("HostUi","settings.graphics.devicesView.nameColumn"),field:"deviceName",type:"string",editable:!1},{displayName:e.getString("HostUi","vmdpConfig.deviceId.label"),field:"pciId",type:"string",editable:!1},{displayName:e.getString("HostUi","settings.graphics.devicesView.vendorColumn"),field:"vendor",type:"string",editable:!1},{displayName:e.getString("HostUi","settings.graphics.devicesView.activeTypeColumn"),field:"defaultType",type:"string",editable:!1,template:function(e){return c(e.defaultType)}},{displayName:e.getString("HostUi","settings.graphics.devicesView.configuredTypeColumn"),field:"configuredType",type:"string",
editable:!1,template:function(t){return t.configuredType&&""!==t.configuredType?c(t.configuredType):e.getString("HostUi","settings.graphics.type.na")}},{displayName:e.getString("HostUi","settings.graphics.devicesView.memoryColumn"),field:"memory",type:"string",editable:!1,template:function(e){return t.bytesFormat(e.memory)}}]}function d(){return[{displayName:e.getString("HostUi","settings.graphics.devicesView.nameColumn"),field:"name",type:"string",editable:!1},{displayName:e.getString("HostUi","stateHeaderText"),field:"powerState",type:"string",editable:!1},{displayName:e.getString("HostUi","statusHeaderText"),field:"overallStatus",type:"string",editable:!1,template:u},{displayName:e.getString("VmUi","provisionedSpaceHeaderText"),field:"usedSpace",type:"string",editable:!1},{displayName:e.getString("VmUi","usedSpaceHeaderText"),field:"provisionedSpace",type:"string",editable:!1},{displayName:e.getString("VmUi","hostCPUHeaderText"),field:"overallCpuUsage",type:"string",editable:!1},{displayName:e.getString("VmUi","hostMemHeaderText"),field:"hostMemoryUsage",type:"string",editable:!1}]}function u(e){var t=o.getColumnRenderer("icon-text"),i=S(e.overallStatus),r=t(["icon","text"],i);return r}function p(e){return{selectionMode:i.grid.selectionMode.SINGLE,sortMode:i.grid.sortMode.SINGLE,resizable:!0,selectedItems:[],data:[],columnDefs:l(),actionBarOptions:{actions:[C(e)]},height:"calc(100% - 12px)"}}function v(e,t){var i=e[0];if(i&&i.vms&&i.vms[0]){var o=[],a=[];_.each(i.vms,function(e){o.push(r.getVsphereObjectId(e))}),n.getPropertiesForObjects(o,["parent","name","runtime.powerState","overallStatus","summary.storage.committed","summary.storage.uncommitted","summary.quickStats.overallCpuUsage","summary.quickStats.hostMemoryUsage","storage.perDatastoreUsage"]).then(function(e){_.each(o,function(t){a.push(e[t])}),t(m(a))})}else t([])}function m(i){var r=[];return _.each(i,function(i){r.push({name:i.name,powerState:e.getString("Common","powerState."+i["runtime.powerState"]),overallStatus:i.overallStatus,usedSpace:t.bytesFormat(g(i)),provisionedSpace:t.bytesFormat(f(i)),overallCpuUsage:i["summary.quickStats.overallCpuUsage"]+" "+e.getString("CommonUi","megaHertz.label"),hostMemoryUsage:i["summary.quickStats.hostMemoryUsage"]+" "+e.getString("CommonUi","megaByte.label")})}),r}function g(e){var t="Datastore";if(e.parent.type===t&&null!==e["storage.perDatastoreUsage"]){var i=e["storage.perDatastoreUsage"],r=_.find(i,function(t){return t.datastore===e.parent});return r.committed}return e["summary.storage.committed"]}function h(e){var t="Datastore";if(e.parent.type===t&&null!==e["storage.perDatastoreUsage"]){var i=e["storage.perDatastoreUsage"],r=_.find(i,function(t){return t.datastore===e.parent});return r.uncommitted}return e["summary.storage.uncommitted"]}function f(e){return g(e)+h(e)}function S(e){var t,i;switch(e){case"green":t="vsphere-icon-status-ok",i=y(e);break;case"yellow":t="vsphere-icon-status-warning",i=y(e);break;case"red":t="vsphere-icon-status-error",i=y(e);break;case"grey":t="vsphere-icon-status-unknown",i=y(e);break;default:t="vsphere-icon-status-unknown",i=y(e)}var r={icon:t,text:i};return r}function y(t){var i="";if(t){var r="entityStatus."+t;i=e.getString("Common",r)}return i}function P(){return{selectionMode:i.grid.selectionMode.SINGLE,sortMode:i.grid.sortMode.SINGLE,resizable:!0,selectedItems:[],data:[],columnDefs:d(),height:"calc(100% - 10px)"}}function C(t){return{actionId:"editGraphicDevice",tooltipText:e.getString("HostUi","settings.graphics.devicesView.button.edit.tooltip"),iconClass:"vx-icon-edit16x16",enabled:!1,onClick:t}}function D(t){return{title:e.getString("HostUi","settings.graphics.editHostConfigForm.title"),objectId:t,actions:[{actionUid:"vsphere.core.host.actions.editHostGraphics",customLabel:e.getString("HostUi","settings.graphics.hostConfigView.edit.label")}]}}return{getTypeLabel:a,getPolicyLabel:s,getGridGraphicsOptions:p,getVmInfoAndUpdateGridData:v,getGridVmsOptions:P,getHostSettingsHeaderOptions:D}}angular.module("com.vmware.vsphere.client.host").service("hostGraphicsService",e),e.$inject=["i18nService","bytesFormatter","vuiConstants","defaultUriSchemeUtil","dataService","columnRenderersRegistry"]}(),function(){"use strict";function e(e,t){function i(){t.getData(r.hostId,"com.vmware.vsphere.client.h5.host.model.GraphicsData").then(function(e){e&&(r.isHostSettingsEnabled=e.isHostSettingsEnabled)})}var r=this;r.hostId=e._route.objectId,r.getData=i,i()}angular.module("com.vmware.vsphere.client.host").controller("hostGraphicsTabsController",e),e.$inject=["$scope","dataService"]}(),function(){"use strict";function e(e,i,a){return r=e,n=i,o=a,{"vsphere.core.host.manage.settings.agentVmSettingsView":{headerOptions:{title:e.getString("HostUi","settings.agentVm.title"),actions:[{actionUid:"vsphere.core.host.actions.editAgentVmSettings",customLabel:e.getString("HostUi","settings.edit")}]},settingsViewOptions:{propertyName:"agentVmSettings",liveRefreshProperties:["summary.config.agentVmNetwork","summary.config.agentVmDatastore","config.fileSystemVolume.mountInfo"]}},"vsphere.core.host.manage.settings.memoryConfigView":{headerOptions:{title:e.getString("HostUi","settings.memoryConfig.title"),actions:[]},settingsViewOptions:{propertyName:"memoryConfig",liveRefreshEnabled:!1}},"vsphere.core.host.manage.settings.powerConfigHardwareView":{headerOptions:{title:e.getString("HostUi","settings.powerConfigHardware.title"),actions:[{actionUid:"vsphere.core.host.actions.editPowerConfigHardware",customLabel:e.getString("HostUi","settings.edit")}]},settingsViewOptions:{propertyName:"powerConfigHardware",delayRefreshTimeInMsecsOnObjectUpdate:1e3,liveRefreshProperties:["config.powerSystemInfo.currentPolicy.name","hardware.cpuPowerManagementInfo.currentPolicy","config.powerSystemInfo.currentPolicy.description","config.powerSystemInfo.currentPolicy.shortName","config.powerSystemInfo.currentPolicy.key"]}},"vsphere.core.host.manage.settings.powerConfigSoftwareView":{headerOptions:{title:e.getString("HostUi","powerConfigSoftware.powerManagementSettings"),actions:[{actionUid:"vsphere.core.host.actions.editPowerConfigSoftware",customLabel:e.getString("HostUi","settings.edit")}]},settingsViewOptions:{propertyName:"powerConfigSoftware",liveRefreshProperties:["config.ipmi.bmcMacAddress","config.ipmi.bmcIpAddress","config.ipmi.login"]}},"vsphere.core.host.manage.settings.certificateView":{headerOptions:{title:e.getString("HostUi","settings.certificate.title"),actions:[{actionUid:"vsphere.core.host.actions.refreshCertificate",customLabel:e.getString("HostUi","settings.certificate.refresh.label")},{actionUid:"vsphere.core.host.actions.refreshCaCertificate",customLabel:e.getString("HostUi","settings.certificate.refreshCA.label")}]},settingsViewOptions:{propertyName:"certificateConfig",supportedKey:"isCertificateManagerSupported",unsupportedMessage:e.getString("HostUi","certificate.unsupported.msg"),liveRefreshProperties:["config.certificate"],formatValueCallback:t}},"vsphere.core.host.manage.settings.advancedSystemSettingsView":{headerOptions:{title:e.getString("HostUi","advancedSettings.view.title"),actions:[{actionUid:"vsphere.core.host.actions.editAdvancedSystemSettings",customLabel:e.getString("HostUi","settings.edit")}]},settingsViewOptions:{type:"grid",propertyName:"advancedSettings",liveRefreshProperties:["config.option"]}}}}function t(e,t){return"certificateStatus"===e?o.when(i(t)):"certificateValidFrom"===e||"certificateValidTo"===e?o.when(t):o.when(t)}function i(e){var t=e||"unknown";return r.getString("HostUi","certificate.status."+t)}angular.module("com.vmware.vsphere.client.host").factory("HostDataDrivenSettingsConfigFactory",e);var r,n,o;e.$inject=["i18nService","timeFormatterService","$q"]}(),function(){"use strict";function e(e,t,i,r){var n=e.modalOptions.dialogData.model.hostId,o=e.modalOptions.dialogData.model.service.key;e.policy=i.policy,e.selectedPolicy=e.modalOptions.dialogData.model.service.policy,e.modalOptions.onSubmit=function(){return t.apply(n,"com.vmware.vsphere.client.host.config.ServicePolicySpec",{policy:e.selectedPolicy,serviceKey:o}),!0},e.popupParams={title:r.getString("HostUi","policy.auto.label"),message:r.getString("HostUi","policy.auto.desc")}}angular.module("com.vmware.vsphere.client.host").controller("EditServiceStartupPolicyController",e),e.$inject=["$scope","mutationService","hostServicesConstants","i18nService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("hostServicesConstants",{status:{RUNNING:"true",STOPPED:"false"},action:{START:"start",STOP:"stop",RESTART:"restart",EDIT:"edit"},policy:{ON:"on",OFF:"off",AUTOMATIC:"automatic"},NO_PRIVILEGE:"No privilege"})}(),function(){"use strict";function e(e,t,i,r){function n(){o(),a()}function o(){r.checkPrivileges(m,["Host.Config.NetService"]).then(function(e){g=e[0],u()})}function a(){h=l(),t.getProperties(m,["config.service","runtime.connectionState"]).then(function(e){e&&e["config.service"]&&(f.datagridOptions.data=e["config.service"].service||[]),e&&e["runtime.connectionState"]&&(f.isHostConnected="connected"===e["runtime.connectionState"])})}function s(){e.$watchCollection(function(){return f.datagridOptions.selectedItems},p)}function c(){var e=d();return e.running}function l(){var e=d();return e.key}function d(){var e;return e=_.isEmpty(f.datagridOptions.selectedItems)?"":f.datagridOptions.selectedItems[0]}function u(){var e=c();f.datagridOptions.actionBarOptions.updateActionBar(e,g,f.isHostConnected)}function p(){u()}function v(e){var t=f.datagridOptions.selectedItems[0],r=t.key,n=t.label,o=t.policy,a={key:r,label:n,policy:o};i.confirmAndExecuteServiceCommand(m,e,a)}var m=e._route.objectId,g=!0,h="",f=this;f.headerOptions=i.getViewHeaderOptions(m),f.datagridOptions=i.getDatagridOptions(v),f.updateViewData=n,f.showMenu=i.showServiceActionContextMenu,f.watchForObjects=[m],f.isHostConnected=!1,f.liveRefreshProperties=["config.service.service"],e.preselectComparator=function(e){return h&&h===e.key},n(),s()}angular.module("com.vmware.vsphere.client.host").controller("HostServicesController",e),e.$inject=["$scope","dataService","hostServicesService","authorizationService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c,l){function d(t){switch(t){case e.status.RUNNING:w.enabled=!1,b.enabled=!0,I.enabled=!0,T.enabled=!0;break;case e.status.STOPPED:w.enabled=!0,b.enabled=!1,I.enabled=!1,T.enabled=!0;break;default:w.enabled=!1,b.enabled=!1,I.enabled=!1,T.enabled=!1}}function u(t,i,r){d(r&&i?t:e.NO_PRIVILEGE)}function p(e,i){return t.getString("HostUi",e,i)}function v(t){return w.onClick=function(){t(e.action.START)},b.onClick=function(){t(e.action.STOP)},I.onClick=function(){t(e.action.RESTART)},T.onClick=function(){t(e.action.EDIT)},{actions:[I,w,b,a.actions.SEPARATOR,T],updateActionBar:u}}function m(t,i,r){function n(){g(t,i,r.key)}var o={};switch(i){case e.action.RESTART:o={title:p("service.restart.confirmation.title"),message:p("service.restart.confirmation.text",r.label),submit:n},l.openConfirmationModal(o);break;case e.action.START:n();break;case e.action.STOP:o={title:p("service.stop.confirmation.title"),message:p("service.stop.confirmation.text",r.label),submit:n},l.openConfirmationModal(o);break;case e.action.EDIT:c.invokeAction({available:!0,invoker:[C],action:{uid:C}},{hostId:t,service:r})}}function g(e,t,i){var n="com.vmware.vsphere.client.host.config.ServiceActionSpec",o={action:t,serviceKey:i};return r.apply(e,n,o)}function h(){return[{displayName:p("services.col.name"),field:"label"},{displayName:p("services.col.daemon"),field:"running",template:function(e){return p("true"===e.running?"daemon.running":"daemon.stopped")}},{displayName:p("services.col.startupPolicy"),field:"policy",template:function(e){return S(e.policy)}}]}function f(e){return{title:p("settings.service"),objectId:e,actions:[{actionUid:"vsphere.core.host.actions.refreshServicesAction",customLabel:p("refresh.services.button.label")}]}}function S(t){var i;switch(t){case e.policy.ON:i=p("policy.on.label");break;case e.policy.OFF:i=p("policy.off.label");break;case e.policy.AUTOMATIC:i=p("policy.auto.label");break;default:D.error("Unexpected startup policy: "+t),i=p("policy.na.label")}return i}function y(e){var t="";e&&!_.isEmpty(e.data)&&e.data[0]&&(t=p("service.menu.label",e.data[0].label));var i=o.$new();i.hostServicesMenuDescriptor={label:t,iconClass:"",items:[I,w,b,a.actions.SEPARATOR,T]};var r=e.currentTarget;!r&&e&&(r=e.target);var s={scope:i,configObjectName:"hostServicesMenuDescriptor",target:r,coordinates:{x:e.clientX,y:e.clientY},menuContainerId:"applicationMenuContainer"};n.showMenu(s)}function P(e){return{selectionMode:a.grid.selectionMode.SINGLE,sortMode:a.grid.sortMode.SINGLE,searchable:!1,resizable:!1,selectedItems:[],actionBarOptions:v(e),data:[],columnDefs:h(),height:"100%",pageConfig:{hidePager:!0}}}var C="vsphere.core.host.actions.service.editStartupPolicy",D=i("HostServicesService"),w={id:e.action.START,tooltipText:p("service.start.action.description"),label:p("service.start.action.label"),enabled:!1,iconClass:"vx-icon-serviceStart"},b={id:e.action.STOP,tooltipText:p("service.stop.action.description"),label:p("service.stop.action.label"),enabled:!1,iconClass:"vx-icon-serviceStop"},I={id:e.action.RESTART,tooltipText:p("service.restart.action.description"),label:p("service.restart.action.label"),enabled:!1,iconClass:"vx-icon-serviceRestart"},T={id:e.action.EDIT,tooltipText:p("service.edit.action.description"),label:p("service.edit.action.label"),enabled:!1,iconClass:"vx-icon-serviceEdit"};return{confirmAndExecuteServiceCommand:m,getColumnDefs:h,showServiceActionContextMenu:y,getDatagridOptions:P,getViewHeaderOptions:f}}angular.module("com.vmware.vsphere.client.host").service("hostServicesService",e),e.$inject=["hostServicesConstants","i18nService","logService","mutationService","vuiActionsMenuService","$rootScope","vuiConstants","actionConfirmationService","actionsService","clarityModalService"]}(),function(){"use strict";function e(e,t){var i=this,r=e._route.extensionId,n=t[r].headerOptions,o=t[r].settingsViewOptions,a=e._route.objectId;n.objectIds=[a],o.objectId=a,o.setSelectedAdvancedOption=!0,angular.isDefined(o.type)||(o.type="stack"),i.headerOptions=n,i.settingsViewOptions=o}angular.module("com.vmware.vsphere.client.host").controller("HostSettingsDataDrivenController",e),e.$inject=["$scope","HostDataDrivenSettingsConfigFactory"]}(),function(){"use strict";function e(e,t,i,r){function n(t){var i=t.hostCount,r=t.drsEnabled;a.hostName=t.hostName,a.clusterMor=t.clusterMor,a.showMigrationConfirmation=!(!i||!r),a.isVsanSupportedAndEnabled=!!t.isVsanSupportedAndEnabled,a.isVsanSupportedAndEnabled&&(a.isPreCheckEvacuationSupported=!!t.isPreCheckEvacuationSupported,e.modalOptions.size="lg"),a.loading=!1}function o(){return t.onOKClicked(s,a.isVsanSupportedAndEnabled,a.shouldMigrateVms,a.showMigrationConfirmation,a.vSanEvacuationType?a.vSanEvacuationType:t.getDefaultEvacuationType())}var a=this;a.loading=!0,a.shouldMigrateVms=!0,e.modalOptions.onSubmit=o;var s=e.modalOptions.dialogData.availableTargets;a.hostId=s[0],a.precheckUnsupportedImage="",a.precheckUnsupportedText="",a.multipleHostsSelected=s.length>1,a.multipleHostsSelected&&(a.precheckUnsupportedImage="vsphere-icon-status-warning",a.precheckUnsupportedText=r.getString("HostUi","ConfirmMaintenanceForm.vsanEvacuation.precheck.unsupported")),t.retrieveVsanData(s,n),a.onVsanSelectedDecommisionModeChanged=function(e){a.vSanEvacuationType=e},a.navigateToPrecheckView=function(){e.closeModal(),t.navigateToPrecheckView(a.clusterMor,s[0],a.vSanEvacuationType)}}angular.module("com.vmware.vsphere.client.host").controller("MaintenanceModeConfirmationController",e),e.$inject=["$scope","maintenanceModeConfirmationService","maintenanceModeConstants","i18nService"]}(),angular.module("com.vmware.vsphere.client.host").service("maintenanceModeConfirmationService",["maintenanceModeConstants","i18nService","mutationService","dataService","clarityModalService","defaultUriSchemeUtil","h5SdkApplicationService",function(e,t,i,r,n,o,a){function s(e,t){r.getData(e[0],"com.vmware.vsphere.client.h5.host.model.HostMaintenanceModeData").then(function(e){e&&t(e)})}function c(){return e.ENSURE_OBJECT_ACCESSIBILITY}function l(e,o,a,s,c){var l=a&&s,u=d(o,l,c);return i.applyOnMultiEntity(e,"com.vmware.vsphere.client.host.maintenance.HostMaintenanceSpec",u),r.getProperties(e[0],["name","poweredOnVMs._length"]).then(function(i){if(i["poweredOnVMs._length"]>0){var r={title:t.getString("Common","issueStatus.warning"),subTitle:{objectId:e[0]},hideCancelButton:!0,message:p("actionEnterMaintenanceVMsPoweredOn",i.name),icon:"icon-warning-32",submit:function(){return!0},preserveNewlines:!0};n.openConfirmationModal(r)}}),!0}function d(e,t,i){var r={maintenanceOpType:"enter",evacuatePoweredOffVms:t};return e&&(r.maintenanceSpec={_type:"com.vmware.vim.binding.vim.host.MaintenanceSpec",vsanMode:{_type:"com.vmware.vim.binding.vim.vsan.host.DecommissionMode",objectAction:i}}),r}function u(e,t,i){var r="com.vmware.vsan.client.h5vsanui.cluster.monitor.vsan.evacuationStatus",n={selectedEntity:t,selectedEvacuationType:i},s={targetViewId:r,objectId:o.getVsphereObjectId(e),customData:n};a.navigateTo(s)}var p=_.partial(t.getString,"HostUi");return{retrieveVsanData:s,onOKClicked:l,getDefaultEvacuationType:c,navigateToPrecheckView:u}}]),angular.module("com.vmware.vsphere.client.host").constant("maintenanceModeConstants",{EVACUATE_ALL_DATA:"evacuateAllData",ENSURE_OBJECT_ACCESSIBILITY:"ensureObjectAccessibility",NO_ACTION:"noAction"});var host_ui;!function(e){var t=function(){function e(){this.templateUrl="host-ui/resources/host/views/settings/memory/hardwareMemoryComponent.html",this.controller=i,this.controllerAs="ctrl",this.bindings={hostId:"<"}}return e}();e.HardwareMemoryComponent=t;var i=function(){function e(e,t){this.hardwareMemoryService=e,this.featureFlagsService=t}return e.prototype.$onInit=function(){var e=this.hardwareMemoryService.getMemorySettingsOptions(this.hostId);this.memoryHeaderOptions=e.headerOptions,this.memorySettingsViewOptions=e.settingsViewOptions;var t=this.hardwareMemoryService.getPmemSettingsOptions(this.hostId);t&&(this.pmemHeaderOptions=t.headerOptions,this.pmemSettingsViewOptions=t.settingsViewOptions,this.isPmemEnabled=this.featureFlagsService.PMemEnabled())},e.$inject=["hardwareMemoryService","featureFlagsService"],e}();e.HardwareMemoryController=i,angular.module("com.vmware.vsphere.client.host").component("hardwareMemoryComponent",new t)}(host_ui||(host_ui={}));var host_ui;!function(e){var t=function(){function e(e,t){this.i18nService=e,this.bytesFilter=t,this.PROP_TOTAL_PMEM="totalPMem",this.PROP_AVAILABLE_PMEM="availablePMem",this.PROP_NOT_AVAILABLE="--"}return e.prototype.formatPropertyValue=function(e,t){return e===this.PROP_TOTAL_PMEM||e===this.PROP_AVAILABLE_PMEM?t===this.PROP_NOT_AVAILABLE?this.bytesFilter(0,"MB"):this.bytesFilter(t,"MB"):t},e.prototype.getMemorySettingsOptions=function(e){var t=this.getHeaderOptions("settings.memoryConfig.title",e);return{headerOptions:t,settingsViewOptions:this.getSettingsViewOptions("memoryConfig",e)}},e.prototype.getPmemSettingsOptions=function(e){var t=this.getHeaderOptions("settings.pMemConfig.title",e);return{headerOptions:t,settingsViewOptions:this.getSettingsViewOptions("pMemConfig",e)}},e.prototype.getHeaderOptions=function(e,t){return{title:this.i18nService.getString("HostUi",e),actions:[],objectIds:[t]}},e.prototype.getSettingsViewOptions=function(e,t){var i=this;return{objectId:t,propertyName:e,formatValueCallback:function(e,t){return i.formatPropertyValue(e,t)},type:"stack"}},e.$inject=["i18nService","bytesFilter"],e}();e.HardwareMemoryService=t,angular.module("com.vmware.vsphere.client.host").service("hardwareMemoryService",t)}(host_ui||(host_ui={})),function(){"use strict";function e(e,t,i){function r(e){n.entityToMoveHostTo=e}var n=this;n.hostIds=e.modalOptions.dialogData.objectIds,n.onLocationSelected=r,n.treeRoot=i.getRootFolderFromVsphereObjectId(n.hostIds[0]),e.modalOptions.onSubmit=function(){t.moveHostTo(n.entityToMoveHostTo,n.hostIds),e.closeModal()}}angular.module("com.vmware.vsphere.client.host").controller("moveHostToController",e),e.$inject=["$scope","moveHostToService","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(t){var r={message:e.getString("HostUi","hostNotInMaintenanceModeError",t),title:e.getString("HostUi","common.util.error"),icon:"vx-icon-warning-32x32",hideCancelButton:!0,preserveNewlines:!0,submit:function(){}};i.openConfirmationModal(r)}function s(r,n,o){var a={message:e.getString("HostUi","cluster.moveInto.noDRS.singleHost",r),title:e.getString("HostUi","common.util.warning"),icon:"vx-icon-warning-32x32",preserveNewlines:!0,submit:function(){var e={entities:n,attributes:null,allowLoosingNestedRps:!0};t.apply(o,"com.vmware.vsphere.client.h5.host.moveHost.MoveHostSpec",e)}};i.openConfirmationModal(a)}function c(t,r,n,o,a){var s={title:e.getString("HostUi","warning.hostNotConnectedToAllDsClusterDatastores.single.dialogTitle"),subTitle:{objectId:r},contentTemplate:"host-ui/resources/host/views/settings/moveto/moveHostVmsAndRpsDialog.html",defaultButton:"submit",dialogData:{hostMor:t,hostId:r,hostName:n,dpmTurnedOn:a,entityToMoveHostTo:o}};i.openOkCancelModal(s)}function l(e,t){return{entities:[e],attributes:null,allowLoosingNestedRps:!0,moveVmsAndRpsConfigSpec:{moveEnabled:!0,moveToRoot:t,moveToCustomRp:!t}}}function d(e,t){var i=n.defer();if(t){var o=!1;r.getData(e,"com.vmware.vsphere.client.h5.host.moveHost.HostConfigInformation").then(function(e){e&&!e.lastExitSucceeded&&(o=!0),i.resolve(o)})}return i.promise}function u(e,i){var r=_.map(i,function(e){return o.getManagedObjectReference(e)}),n={entities:r,attributes:null,allowLoosingNestedRps:!1,moveVmsAndRpsConfigSpec:{moveEnabled:!1,moveToRoot:!1,moveToCustomRp:!1}};t.apply(e,"com.vmware.vsphere.client.h5.host.moveHost.MoveHostSpec",n).then(function(t){if(!t.error){var i=t.result,n=_.find(i,function(e){var t=e.parameter;return t&&t.displayMaintenanceModeError});n?a(n.clusterName):_.each(i,function(t){var i=t.parameter;if(i&&i.showWarningDialog)s(i.clusterName,r,e);else if(i&&i.showMovementDialog){var n=i.hostRef,a=o.getVsphereObjectId(n);c(n,a,i.hostName,e,i.dpmTurnedOn)}})}})}return{getMoveRpSpec:l,showRpmWarningCondition:d,moveHostTo:u}}angular.module("com.vmware.vsphere.client.host").service("moveHostToService",e),e.$inject=["i18nService","mutationService","clarityModalService","dataService","$q","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t,i,r,n){var o=this;o.destinationType="root",o.hostId=e.modalOptions.dialogData.hostId,o.hostName=e.modalOptions.dialogData.hostName,o.showDpmWarning=!1,r.showRpmWarningCondition(o.hostId,e.modalOptions.dialogData.dpmTurnedOn,o.showDpmWarning).then(function(e){o.showDpmWarning=e}),e.modalOptions.onSubmit=function(){var a={};if("root"===o.destinationType)a=r.getMoveRpSpec(e.modalOptions.dialogData.hostMor,!0),t.apply(e.modalOptions.dialogData.entityToMoveHostTo,"com.vmware.vsphere.client.h5.host.moveHost.MoveHostSpec",a),e.closeModal();else if(o.destination)a=r.getMoveRpSpec(e.modalOptions.dialogData.hostMor,!1),a.moveVmsAndRpsConfigSpec.newRpName=o.destination,t.apply(e.modalOptions.dialogData.entityToMoveHostTo,"com.vmware.vsphere.client.h5.host.moveHost.MoveHostSpec",a).then(function(t){var r=t.parameter;if(r&&r.unsuccessfulMovementOperation){var a=i.getString("HostUi","moveHost.moveVms.error.nameAlreadyExist",o.destination);e.modalOptions.alerts=[],e.modalOptions.alerts.push({text:a,type:n.validationBanner.type.ERROR})}else e.closeModal()});else{e.modalOptions.alerts=[];var s=i.getString("HostUi","hostToClusterOp.resPoolPage.rpNameReqError");e.modalOptions.alerts.push({text:s,type:n.validationBanner.type.ERROR})}}}angular.module("com.vmware.vsphere.client.host").controller("moveHostVmsAndRpsController",e),e.$inject=["$scope","mutationService","i18nService","moveHostToService","vuiConstants"]}();var host_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t,this.hostId=e._route.objectId,this.objectsToWatch=[e._route.objectId],this.headerOptions={title:this.i18nService.getString("HostUi","imageProfileTOC.softwarePackages.header"),actions:[]}}return e.$inject=["$scope","i18nService"],e}();angular.module("com.vmware.vsphere.client.host").controller("HostSoftwarePackagesController",t)}(host_ui||(host_ui={})),function(){"use strict";function e(e,t,i,r,n,o){function a(){var t=r.getChangedPciDevicesUpdateSpec(d.treeListOptions.dataSource.data()),i=r.getPciDevicesWithEsxiDevice(d.treeListOptions.dataSource.data());return i.length>0?void r.showConfirmationDialog(i,t,e.closeModal,c):r.applyEditPciDevices(t,c)}function s(){t.getData(c,"com.vmware.vsphere.client.h5.host.vmdp.VmdpDeviceNodeData").then(function(e){e&&(d.modifiedData=_.map(e.vmdpDeviceNodeList,function(e){return angular.merge({_originalStatus:e.status},e)}),d.initializeTreeListDataSource(d.modifiedData))})}var c=e._route.objectId,l=_.bind(i.getString,i,"HostUi"),d=this;d.getData=s,s(),e.modalOptions.onSubmit=a,d.treeListWidget=null,d.showPciDevicePortlets=!0,d.showHideLabel=l("vmdpConfig.hidedetails.label"),d.showPortlets=function(){d.showHideLabel===l("vmdpConfig.hidedetails.label")?(d.showPciDevicePortlets=!1,d.showHideLabel=l("vmdpConfig.showdetails.label")):(d.showPciDevicePortlets=!0,d.showHideLabel=l("vmdpConfig.hidedetails.label"))},d.initializeTreeListDataSource=function(e){d.treeListOptions.dataSource=new kendo.data.TreeListDataSource({data:e,schema:u}),d.treeListOptions.dataSource.read()};var u={model:{id:"nodeId",expanded:!0}};d.treeListColumns=[{field:"busId",title:l("vmdpConfig.idColHeader.label"),template:function(e){return r.createPciDeviceCheckbox(e)}},{field:"statusMessage",title:l("vmdpConfig.statusHeader.label")},{field:"vendor",title:l("vmdpConfig.vendorName.label")},{field:"deviceName",title:l("vmdpConfig.deviceNameHeader.label"),template:r.textTitleRenderer},{field:"esxDeviceInfo",title:l("vmdpConfig.esxName.label"),template:function(e){return e.esxDeviceInfo?e.esxDeviceInfo.split(" ")[0]:""}}],o.on("selectPciDevice",function(e,t){e.stopPropagation();var i=d.treeListOptions.dataSource.data(),n=_.find(i,function(e){return e.uid===t});n.dependentDevice?_.each(i,function(e){n.dependentDevice===e.dependentDevice&&r.updateStatus(e)}):r.updateStatus(n),d.treeListWidget.refresh()}),d.onTreeListSelect=function(){var e=d.treeListWidget.select(),t=d.treeListWidget.dataItem(e);t?(d.pciDetailsData=r.createPciDetails(t),d.pciDeviceBusDetatils=r.createPciBusDetails(t),d.esxDeviceInfo=r.createEsxDeviceInfoDetails(t),d.directPathMessage=t.directPathMessage,d.selectedPciId=t.busId,d.hasSelectedPciDevice=!0):d.hasSelectedPciDevice=!1},d.treeListOptions={columns:d.treeListColumns,sortable:!1,resizable:!0,selectable:!0,change:_.partial(n.safeApply,e,d.onTreeListSelect)}}angular.module("com.vmware.vsphere.client.host").controller("editPciDevicesController",e),e.$inject=["$scope","dataService","i18nService","pciDeviceService","vuiUtils","$element"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){t.getData(p,"com.vmware.vsphere.client.h5.host.vmdp.VmdpDeviceInfoData").then(function(e){e&&(h.gridOptions.data=e.availableVmdpDeviceInfo,h.pendingDevicesMessage=r.formatPendingDeviceMessage(h.gridOptions.data),c())})}function s(){t.getData(p,"com.vmware.vsphere.client.h5.host.vmdp.VmdpAllDevicesNodeData").then(function(e){e&&(h.allDevicesData=e.vmdpDeviceNodeList,h.allPendingDevicesMessage=r.formatPendingDeviceMessage(h.allDevicesData),h.initializeTreeListDataSource(h.allDevicesData))})}function c(){e.$watch(function(){return h.gridOptions.selectedItems},function(e){e&&e.length>0?(h.pciDetailsData=r.createPciDetails(e[0]),h.pciDeviceBusDetatils=r.createPciBusDetails(e[0]),h.esxDeviceInfo=r.createEsxDeviceInfoDetails(e[0]),h.directPathMessage=e[0].directPathMessage,h.selectedPciId=e[0].busId,h.hasSelectedPciDevice=!0):h.hasSelectedPciDevice=!1})}function l(e){return h.hasSelectedPciDevice&&e&&h.selectedPciId===e.busId}function d(){h.showCapablePassthruDevices=!0,h.showAllDevices=!1}function u(){h.showCapablePassthruDevices=!1,h.showAllDevices=!0,h.splitterOptionsAllItems=r.getSplitterOptions(),h.allDevicesData||s()}var p=e._route.objectId,v=_.bind(i.getString,i,"HostUi"),m=n.getColumnRenderer("icon-text"),g={model:{id:"nodeId",expanded:!0}},h=this;h.headerOptions={title:v("vmdpConfig.list.title"),actions:[{actionUid:"vsphere.core.host.actions.refreshPciDevices",customLabel:i.getString("Common","refresh")},{actionUid:"vsphere.core.host.actions.editPciDevices",customLabel:i.getString("HostUi","vmdpConfig.editButton.label")}]},h.gridOptions=r.getGridOptions(),h.splitterOptions=r.getSplitterOptions(),h.showCapablePassthruDevices=!0,h.showAllDevices=!1,h.watchForObjects=[p],h.liveRefreshProperties=["config.pciPassthruInfo","summary.rebootRequired"],h.updateViewData=a,h.getAllDevicesData=s,h.rebootHost=function(){h5.actions["vsphere.core.host.actions.rebootAction"]({},[p])},h.treeListWidget=null,h.treeListColumns=[{field:"busId",title:v("vmdpConfig.idColHeader.label"),template:function(e){return m(["icon","text"],{icon:"vx-icon-pci",text:e.busId})}},{field:"statusMessage",title:v("vmdpConfig.statusHeader.label")},{field:"vendor",title:v("vmdpConfig.vendorName.label")},{field:"deviceName",title:v("vmdpConfig.deviceNameHeader.label"),template:r.textTitleRenderer},{field:"esxDeviceInfo",title:v("vmdpConfig.esxName.label"),template:function(e){return e.esxDeviceInfo?e.esxDeviceInfo.split(" ")[0]:""}}],h.initializeTreeListDataSource=function(e){h.treeListOptions.dataSource=new kendo.data.TreeListDataSource({data:e,schema:g}),h.treeListOptions.dataSource.read()},h.onShowCapablePassthruDevices=d,h.onShowAllDevices=u,a(),h.onTreeListSelect=function(){var e=h.treeListWidget.select(),t=h.treeListWidget.dataItem(e);t?(h.pciDetailsTreeData=r.createPciDetails(t),h.pciDeviceTreeBusDetatils=r.createPciBusDetails(t),h.treeEsxDeviceInfo=r.createEsxDeviceInfoDetails(t),h.treeDirectPathMessage=t.directPathMessage,h.selectedTreePciId=t.busId,h.hasSelectedTreePciDevice=!0):h.hasSelectedTreePciDevice=!1},h.treeListOptions={columns:h.treeListColumns,sortable:!1,resizable:!0,selectable:!0,change:_.partial(o.safeApply,e,h.onTreeListSelect)},e.pciDevicesPreselectComparator=l}angular.module("com.vmware.vsphere.client.host").controller("pciDevicesController",e),e.$inject=["$scope","dataService","i18nService","pciDeviceService","columnRenderersRegistry","vuiUtils"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(t){var i=e.createPropertyViewBuilder(),r=i.category("").section("pciDetailsData").title(A("vmdpConfig.pciDeviceDetails.label"));return r.property(A("vmdpConfig.deviceName.label"),t.deviceName).property(A("vmdpConfig.deviceId.label"),t.deviceId).property(A("vmdpConfig.subDeviceId.label"),t.subDeviceId).property(A("vmdpConfig.classId.label"),t.classId).property(A("vmdpConfig.vendorName.label"),t.vendor).property(A("vmdpConfig.vendorId.label"),t.vendorId).property(A("vmdpConfig.subVendorId.label"),t.subVendorId),i.build()}function s(t){if(t.esxDeviceInfo){var i=e.createPropertyViewBuilder(),r=i.category("").section("esxDeviceInfo");return r.property(A("vmdpConfig.esxName.label"),t.esxDeviceInfo),i.build()}return null}function c(t){var i=e.createPropertyViewBuilder(),r=i.category("").section("busDetails").title(A("vmdpConfig.bsfLocation.label"));return r.property(A("vmdpConfig.id.label"),t.busId).property(A("vmdpConfig.bus.label"),t.bus).property(A("vmdpConfig.slot.label"),t.busSlot).property(A("vmdpConfig.function.label"),t["function"]),i.build()}function l(){return{orientation:r.splitter.orientation.VERTICAL,panes:[{min:"150px",size:"47%"},{min:"250px",size:"53%"}]}}function d(){return{selectionMode:r.grid.selectionMode.SINGLE,sortMode:r.grid.sortMode.SINGLE,resizable:!0,selectedItems:[],data:[],columnDefs:u(),height:"100%",pageConfig:{
hidePager:!0}}}function u(){return[{field:"busId",displayName:A("vmdpConfig.idColHeader.label"),template:function(e){var t="vx-icon-pci";return e.status!==U&&e.status!==L||(t="vx-icon-pci-pt-reboot"),O(["icon","text"],{icon:t,text:e.busId})}},{field:"statusMessage",displayName:A("vmdpConfig.statusHeader.label")},{field:"vendor",displayName:A("vmdpConfig.vendorName.label")},{field:"deviceName",displayName:A("vmdpConfig.deviceNameHeader.label"),template:p}]}function p(e){var t=e&&e.deviceName?e.deviceName:"";return'<span title="'+t+'">'+t+"</span>"}function v(e){var t=_.filter(e,function(e){return e.status===U}).length,i=_.filter(e,function(e){return e.status===L}).length;return{availablePendingDevices:t,unavailablePendingDevices:i}}function m(e){var t=v(e),i=t.availablePendingDevices,r=t.unavailablePendingDevices,n=(i>=2?2:i).toString(),o=(r>=2?2:r).toString(),a=g(i,r);return a[n+o]}function g(e,t){return{"00":"","01":A("vmdpConfig.rebootToDeactivateDevicesSingular.label",t),"02":A("vmdpConfig.rebootToDeactivateDevicesPlural.label",t),10:A("vmdpConfig.rebootToActivateDevicesSingular.label",e),20:A("vmdpConfig.rebootToActivateDevicesPlural.label",e),11:A("vmdpConfig.rebootToChangeDevicesSingular.label",e,t),12:A("vmdpConfig.rebootToChangeDevicesSingular.label",e,t),21:A("vmdpConfig.rebootToChangeDevicesPlural.label",e,t),22:A("vmdpConfig.rebootToChangeDevicesPlural.label",e,t)}}function h(e){return _.filter(e,function(e){return e.status!==e._originalStatus})}function f(e){var t=h(e);return _.filter(t,function(e){return null!==e.esxDeviceInfo})}function S(e){var t=h(e);return V(t)}function y(e){var t,i,r;return 1===e.length?(t=A("vmdpConfig.esxDeviceWarningSingular.title"),i=P(e),r=A("vmdpConfig.esxDeviceWarningSingular.label",i)):2===e.length?(t=A("vmdpConfig.esxDeviceWarningDual.title"),i=P(e),r=A("vmdpConfig.esxDeviceWarningDual.label",i)):(t=A("vmdpConfig.esxDeviceWarningPlural.title"),i=P(e),r=A("vmdpConfig.esxDeviceWarningPlural.label",i)),{description:r,title:t}}function P(e){var t=_.map(e,function(e){var t;if(e.esxDeviceInfo.indexOf("virtual switch")!==-1?t="vmdpConfig.esxSwitchWarning.label":e.esxDeviceInfo.indexOf("dvs")!==-1&&(t="vmdpConfig.esxDvsWarning.label"),t){var i=e.esxDeviceInfo.split(" "),r=i[0],n=i[i.length-1].replace(")","");return A(t,e.busId,r,n)}return A("vmdpConfig.esxDeviceWarning.label",e.busId,e.esxDeviceInfo)});return t.join(",\n")}function C(e){return e.status===k?w(e):D(e)}function D(e){return e.enabled=e.status&&(e.status===U||e.status===R),'<label><input type="checkbox"  '+(e.enabled?"checked":"")+" onchange=\"$(this).trigger('selectPciDevice', '"+e.uid+"')\"/>"+O(["icon","text"],{icon:"vx-icon-pci",text:e.busId})+"</label>"}function w(e){return O(["icon","text"],{icon:"vx-icon-pci",text:e.busId})}function b(e){switch(e.status){case U:e.status=N,e.statusMessage=A("vmdpConfig.devStatus.unavailable");break;case R:e.status=L,e.statusMessage=A("vmdpConfig.devStatus.unavailableLater");break;case L:e.status=R,e.statusMessage=A("vmdpConfig.devStatus.available");break;case N:e.status=U,e.statusMessage=A("vmdpConfig.devStatus.availableLater")}}function I(e){return e.status===R||e.status===U}function T(e,t){return _.isEmpty(e.configs)||n.apply(t,"com.vmware.vsphere.client.host.config.PciPassthruUpdateSpec",e),!0}function E(e,t,i,r){var n=function(){T(t,r),i()},a=y(e),s={title:a.title,message:a.description,submit:n,icon:"icon-warning-32",saveButtonLabel:A("answerYes"),cancelButtonLabel:A("answerNo"),preserveNewlines:!0};o.openConfirmationModal(s)}function V(e){return{configs:M(e)}}function M(e){return _.map(e,function(e){return{_type:"com.vmware.vim.binding.vim.host.PciPassthruConfig",id:e.vmdpDeviceId,passthruEnabled:I(e)}})}var O=i.getColumnRenderer("icon-text"),A=_.bind(t.getString,t,"HostUi"),k="NOT_CONFIGURABLE",R="AVAILABLE",N="UNAVAILABLE",U="AVAILABLE_PENDING",L="UNAVAILABLE_PENDING";return{createPciDetails:a,createPciBusDetails:c,createEsxDeviceInfoDetails:s,getGridOptions:d,getSplitterOptions:l,formatPendingDeviceMessage:m,getChangedPciDevicesUpdateSpec:S,createPciDeviceCheckbox:C,updateStatus:b,getPciDevicesWithEsxiDevice:f,applyEditPciDevices:T,showConfirmationDialog:E,textTitleRenderer:p}}angular.module("com.vmware.vsphere.client.host").service("pciDeviceService",e),e.$inject=["vxPropertyViewService","i18nService","columnRenderersRegistry","vuiConstants","mutationService","clarityModalService"]}();var host_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.dataService=t,this.mutationService=i,this.i18nService=r,this.hostId=e._route.objectId,e.modalOptions.onSubmit=this.onSubmit.bind(this),this.getBootDevices()}return e.prototype.getBootDevices=function(){var e=this;this.dataService.getProperties(this.hostId,["bootDeviceInfo"]).then(function(t){t&&t.bootDeviceInfo?(e.bootDevices=t.bootDeviceInfo.bootDevices,e.selectedOption=e.getCurrentDeviceByKey(t.bootDeviceInfo.currentBootDeviceKey)):(e.bootDevices=[],e.selectedOption={key:"",description:""})})},e.prototype.getCurrentDeviceByKey=function(e){return _.find(this.bootDevices,function(t){return e===t.key})},e.prototype.onSubmit=function(){var e={bootDeviceKey:this.selectedOption.key,rebootAfterApply:!1};return this.mutationService.apply(this.hostId,"com.vmware.vsphere.client.host.config.BootDeviceConfigSpec",e,this.i18nService.getString("HostUi","bootDevice.operationName")),!0},e.$inject=["$scope","dataService","mutationService","i18nService"],e}();angular.module("com.vmware.vsphere.client.host").controller("EditBootOptionsController",t)}(host_ui||(host_ui={})),function(){"use strict";function e(e,t,i){function r(){i.getResourceInfo(n.hostId,"processorGeneralConfig").then(function(e){n.viewData=e.properties})}var n=this;n.hostId=e._route.objectId,n.viewData=null,r(),e.modalOptions.onSubmit=function(){var e={hyperthreading:{htOnRestart:n.hyperthreadingAvailable}};return t.applyByPropName(n.hostId,"processorGeneralConfig",e),!0}}angular.module("com.vmware.vsphere.client.host").controller("EditHardwareProcessorsController",e),e.$inject=["$scope","mutationService","resourceService"]}(),function(){"use strict";function e(e,t){this.hostId=e._route.objectId,this.watchForObjects=[this.hostId];var i=t.getGeneralSettingsOptions(this.hostId);this.generalHeaderOptions=i.headerOptions,this.generalSettingsViewOptions=i.settingsViewOptions;var r=t.getSystemSettingsOptions(this.hostId);this.systemHeaderOptions=r.headerOptions,this.systemSettingsViewOptions=r.settingsViewOptions}angular.module("com.vmware.vsphere.client.host").controller("HardwareProcessorsController",e),e.$inject=["$scope","hardwareProcessorsService"]}(),function(){"use strict";function e(e){function t(e,t){return"hyperthreading"===e?n(t):t}function i(t){var i=o("processorConfig.generalConfiguration",t);return i.actions.push({actionUid:"vsphere.core.host.actions.editProcessorGeneralConfig",customLabel:e.getString("HostUi","processorConfig.editGeneralConfiguration")}),{headerOptions:i,settingsViewOptions:a("processorGeneralConfig",t)}}function r(t){var i=o("processorConfig.systemConfiguration",t);return i.actions.push({actionUid:"vsphere.core.host.actions.editBootOptions",customLabel:e.getString("HostUi","processorConfig.bootOptions")}),{headerOptions:i,settingsViewOptions:a("processorSystemConfig",t)}}function n(t){if(!t)return null;var i=t.htAvailable;if(!i)return e.getString("HostUi","notAvailable");var r=t.ht,n=t.htOnRestart,o=e.getString("HostUi","enabled"),a=e.getString("HostUi","disabled");if(r===n)return r?o:a;var s=n?e.getString("HostUi","onRestartFormat",o):e.getString("HostUi","onRestartFormat",a);return r?e.getString("HostUi","processorConfig.hyperThreadingFormat",o,s):e.getString("HostUi","processorConfig.hyperThreadingFormat",a,s)}function o(t,i){return{title:e.getString("HostUi",t),actions:[],objectIds:[i]}}function a(e,i){return{objectId:i,propertyName:e,formatValueCallback:t,type:"stack"}}return{formatPropertyValue:t,getGeneralSettingsOptions:i,getSystemSettingsOptions:r}}angular.module("com.vmware.vsphere.client.host").service("hardwareProcessorsService",e),e.$inject=["i18nService"]}(),function(){"use strict";function e(e,t,i,r){function n(t){l.hostName=t.hostName,l.clusterMor=t.clusterMor,l.isVsanSupportedAndEnabled=!!t.isVsanSupportedAndEnabled,l.inMaintenanceMode=t.inMaintenanceMode,l.isVsanSupportedAndEnabled&&(e.modalOptions.size="lg"),l.showGuardRail=!l.inMaintenanceMode,l.loading=!1}function o(e,t,i,n,o){l.isVsanSupportedAndEnabled=l.isVsanSupportedAndEnabled?l.isVsanSupportedAndEnabled:i,t?(l.hostsInMm.push(n),l.selectedHosts.push({label:e,iconClass:"vsphere-icon-host-maintenance"})):(l.inMaintenanceMode=t,l.hostsNotInMm.push(e),l.selectedHosts.push({label:r.getString("HostUi","rebootHostNotInMaintenanceMode",e),iconClass:"vsphere-icon-host"})),l.loading=o}function a(){return l.rebootReason}function s(){return l.onlyMmHosts}function c(){return l.hostsInMm}var l=this,d=e.modalOptions.dialogData.availableTargets;e.modalOptions.onSubmit=t.onOKClicked.bind(this,a,s,"reboot",e.modalOptions,d,c),l.loading=!0,l.inMaintenanceMode=!0,l.onlyMmHosts=!1,d.length>1?(l.multipleHosts=!0,l.onlyMmHosts=!0,l.hostsNotInMm=[],l.hostsInMm=[],l.selectedHosts=[],t.fetchHostsRebootData(d,o),e.modalOptions.size="lg",l.showGuardRail=!0):(l.hostId=d[0],i.getData(l.hostId,"com.vmware.vsphere.client.h5.host.model.HostRebootData").then(function(e){e&&n(e)}))}angular.module("com.vmware.vsphere.client.host").controller("RebootConfirmationController",e),e.$inject=["$scope","confirmationDialogWithReasonService","dataService","i18nService"]}(),function(){"use strict";function e(e){function t(t){e.applyOnMultiEntity([t],"com.vmware.vsphere.client.host.certificates.HostCertificateOpSpec",{certOpType:"refresh"})}function i(t){e.applyOnMultiEntity([t],"com.vmware.vsphere.client.host.certificates.HostCertificateOpSpec",{certOpType:"refreshCACertificates"})}return{refreshCertificate:t,refreshCaCertificate:i}}angular.module("com.vmware.vsphere.client.host").service("refreshCertificateService",e),e.$inject=["mutationService"]}(),function(){"use strict";function e(e){var t=this;t.users="",t.parseUsers=function(){var e=_.filter(t.users.split(";"),function(e){return""!==e});return _.map(e,function(e){return e.replace(/localhost\//i,"")})}.bind(this),e.modalOptions.onSubmit=function(){var i=e.modalOptions.dialogData.model.exceptionUsers;return e.modalOptions.dialogData.model.exceptionUsers=_.union(i,t.parseUsers()),e.modalOptions.dialogData.datagridOptions.data=e.modalOptions.dialogData.model.exceptionUsers,e.modalOptions.dialogData.gridWidget.refresh(),!0}}angular.module("com.vmware.vsphere.client.host").controller("AddExceptionUsersController",e),e.$inject=["$scope"]}();var host_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.i18nService=t,this.dataService=i,this.mutationService=r,this.encryptionModes=[],e.modalOptions.onSubmit=this.onSubmit.bind(this),this.hostId=e._route.objectId,this.encryptionModes=[this.getModeByKey("safe"),this.getModeByKey("incapable")],this.getData()}return e.prototype.getData=function(){var e=this;this.dataService.getProperties(this.hostId,["runtime.cryptoState"]).then(function(t){t&&(t["runtime.cryptoState"]&&"safe"===t["runtime.cryptoState"]?(e.isEncryptionModeEnabled=!0,e.encryptionMode=e.getModeByKey("safe")):(e.isEncryptionModeEnabled=!1,e.encryptionMode=e.getModeByKey("incapable")))})},e.prototype.onSubmit=function(){return this.isEncryptionModeEnabled||this.mutationService.apply(this.hostId,"com.vmware.vsphere.client.host.config.HostEncryptionModeSpec",{encryptionMode:this.encryptionMode.key}),!0},e.prototype.getModeByKey=function(e){return{safe:{key:"safe",label:this.i18nService.getString("HostUi","hostEncryption.mode.enabled")},incapable:{key:"incapable",label:this.i18nService.getString("HostUi","hostEncryption.mode.disabled")}}[e]},e.$inject=["$scope","i18nService","dataService","mutationService"],e}();angular.module("com.vmware.vsphere.client.host").controller("editEncryptionModeController",t)}(host_ui||(host_ui={})),function(){"use strict";function e(e,t,i,r){function n(){var e={title:t.getString("HostUi","addExceptionUser.action.label"),contentTemplate:"host-ui/resources/host/views/settings/securityProfile/addExceptionUserView.html",dialogData:{model:a.model,gridWidget:a.gridWidget,datagridOptions:a.datagridOptions},defaultButton:"submit"};r.openOkCancelModal(e)}function o(){var e=a.datagridOptions.selectedItems[0];e&&(a.datagridOptions.data=_.filter(a.model.exceptionUsers,function(t){return e!==t}),a.model.exceptionUsers=a.datagridOptions.data),a.gridWidget&&a.gridWidget.refresh()}var a=this;a.model=e.manager.getExceptionUsersPageModel(),a.gridWidget=null,e.$on("kendoWidgetCreated",function(e,t){t&&t.constructor===kendo.ui.Grid&&(a.gridWidget=t)});var s={actionId:"removeItems",tooltipText:t.getString("HostUi","removeExceptionUser.action.description"),label:t.getString("HostUi","removeExceptionUser.action.label"),enabled:a.model.exceptionUsers,iconClass:"vx-icon-removeIcon",onClick:o},c={actionId:"addExceptionUsers",tooltipText:t.getString("HostUi","addExceptionUser.action.description"),label:t.getString("HostUi","addExceptionUser.action.label"),enabled:!0,iconClass:"vx-icon-addIcon",onClick:n};e.$watchCollection(function(){return a.datagridOptions.selectedItems},function(){a.datagridOptions.selectedItems&&a.datagridOptions.selectedItems.length>0?s.enabled=!0:s.enabled=!1}),a.datagridOptions={columnDefs:[{displayName:t.getString("HostUi","editExceptionUsersView.colHeader.User"),field:"exceptionUsers",template:function(e){return e}}],data:a.model.exceptionUsers?a.model.exceptionUsers:[],selectionMode:i.grid.selectionMode.SINGLE,selectedItems:[],actionBarOptions:{actions:[c,s]},resizable:!1,height:"240px"}}angular.module("com.vmware.vsphere.client.host").controller("EditExceptionUsersController",e),e.$inject=["$scope","i18nService","vuiConstants","clarityModalService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){u.loading=!0,r.getProperties(d,["imageAcceptanceLevel"]).then(function(e){u.selectedOption=l(e.imageAcceptanceLevel),u.loading=!1})}function s(){return!u.changeEvent||(i.apply(d,"com.vmware.vsphere.client.host.config.ImageProfileAcceptanceLevelSpec",{acceptanceLevel:u.selectedOption.value},n.getString("HostUi","acceptanceLevel.operation")).then(function(e){e.error||t.$emit(o.UPDATE_HOST_IMAGE_PROFILE_ACCEPTANCE_LEVEL)}),!0)}function c(){return[{label:n.getString("HostUi","acceptanceLevel.vmware_certified"),value:"vmware_certified"},{label:n.getString("HostUi","acceptanceLevel.vmware_accepted"),value:"vmware_accepted"},{label:n.getString("HostUi","acceptanceLevel.partner"),value:"partner"},{label:n.getString("HostUi","acceptanceLevel.community"),value:"community"}]}function l(e){var t=c(),i=_.filter(t,function(t){return t.value===e});return i?i[0]:null}var d=e._route.objectId,u=this;e.modalOptions.onSubmit=s,u.dialogSubtitle=n.getString("HostUi","edit.imageProfile.desc"),u.imageAcceptanceLevelOptions=c(),u.changeEvent=!1,a(),e.$watch(function(){return u.selectedOption},function(e,t){e!==t&&(u.changeEvent=!0)},!0)}angular.module("com.vmware.vsphere.client.host").controller("EditImageProfileAcceptanceLevelController",["$scope","$rootScope","mutationService","dataService","i18nService","imageProfileEvents",e])}(),function(){"use strict";function e(e){var t=this;t.model=e.manager.getLockdownModePageModel()}angular.module("com.vmware.vsphere.client.host").controller("EditLockdownModeController",e),e.$inject=["$scope"]}();var host_ui;!function(e){var t=function(){function e(){this.controllerAs="ctrl",this.bindings={header:"<",hostEncryption:"<"},this.templateUrl="host-ui/resources/host/views/settings/securityProfile/encryptionModeTemplate.html",this.controller=i}return e.$inject=["i18nService"],e}();e.EncryptionMode=t;var i=function(){function e(e){this.i18nService=e,this.i18n=e.getString.bind(e),this.subtitle=this.i18nService.getString("HostUi","hostEncryption.description"),this.encryptionLabel=this.i18nService.getString("HostUi","hostEncryption.mode.label")}return e.$inject=["i18nService"],e}();e.EncryptionModeController=i,angular.module("com.vmware.vsphere.client.host").component("encryptionMode",new t)}(host_ui||(host_ui={})),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("imageProfileEvents",{UPDATE_HOST_IMAGE_PROFILE_ACCEPTANCE_LEVEL:"updateHostImageProfileAcceptanceLevel"})}(),function(){"use strict";function e(e,t,i,r,n){function o(e){return r.getString("HostUi",e)}function a(e){return{lockdownNormal:"lockdownView.mode.normal.label",lockdownStrict:"lockdownView.mode.strict.label",lockdownDisabled:"lockdownView.mode.disabled.label"}[e]}function s(e){return{vmware_certified:"acceptanceLevel.vmware_certified",vmware_accepted:"acceptanceLevel.vmware_accepted",partner:"acceptanceLevel.partner",community:"acceptanceLevel.community"}[e]}var c=e._route.objectId;e.i18nService=r,this.objectsToWatch=[c],this.liveRefreshProperties=["config.lockdownMode","config.service.service"],this.headerOptions={title:o("securityProfile.lockdownMode.label"),actions:[{actionUid:"vsphere.core.host.actions.editLockdownMode",customLabel:o("settings.edit")}],objectId:c},this.imageAcceptanceLevelHeaderOptions={title:o("imageProfileAcceptance.label"),actions:[{actionUid:"vsphere.core.host.actions.editImageProfile",customLabel:o("imageProfile.action.label")}],objectId:c},this.encryptionMode={title:o("hostEncryption.label"),actions:[{actionUid:"vsphere.core.host.actions.editEncryptionMode",customLabel:o("settings.edit")}],objectId:this.objectsToWatch},this.setSecurityProfileProperties=function(e){this.lockdownMode=o(a(e.lockdownMode)),this.exceptionUsers=e.exceptionUsers,this.showExceptionUsers=e.isHostAccessManagerAvailable,this.isHostEncryptionCapable=!!e.cryptoState,this.hostEncryption=o(e.cryptoState&&"safe"===e.cryptoState?"hostEncryption.mode.enabled":"hostEncryption.mode.disabled")},this.fetchViewData=function(){i.getProperties(c,["securityProfileSummaryData"]).then(function(e){e&&e.securityProfileSummaryData&&(this.setSecurityProfileProperties(e.securityProfileSummaryData),this.getImageAcceptanceLevel(e.securityProfileSummaryData))}.bind(this))};var l=t.$on(n.UPDATE_HOST_IMAGE_PROFILE_ACCEPTANCE_LEVEL,function(e,t){this.getImageAcceptanceLevel()}.bind(this));e.$on("$destroy",function(){l()}),this.getImageAcceptanceLevel=function(e){this.imageAcceptanceLevel=o("acceptanceLevel.nameLoadingPlaceholder"),e&&e.imageAcceptanceLevel?this.imageAcceptanceLevel=o(s(e.imageAcceptanceLevel)):i.getProperties(c,["imageAcceptanceLevel"]).then(function(e){e&&(this.imageAcceptanceLevel=o(s(e.imageAcceptanceLevel)))}.bind(this))},this.fetchViewData()}angular.module("com.vmware.vsphere.client.host").controller("SecurityProfileController",e),e.$inject=["$scope","$rootScope","dataService","i18nService","imageProfileEvents"]}(),function(){"use strict";function e(e,t){return function(i,r){function n(){l={page:{title:e.getString("HostUi","editLockdownView.title"),contentUrl:"host-ui/resources/host/views/settings/securityProfile/editLockdownModeView.html"}},d={page:{title:e.getString("HostUi","editExceptionUsersView.title"),contentUrl:"host-ui/resources/host/views/settings/securityProfile/editExceptionUsersView.html"}}}function o(){var e=[];return e.push(l.page),i.isHostAccessManagerAvailable&&e.push(d.page),e}function a(){return l.model||(l.model={lockdownMode:i.lockdownMode,hostAccessManagerAvailable:i.isHostAccessManagerAvailable}),l.model}function s(){return d.model||(d.model={exceptionUsers:i.exceptionUsers}),d.model}function c(){var e={};l.model&&l.model.lockdownMode!==i.lockdownMode&&(e.lockdownMode=l.model.lockdownMode,u=!0);var n=r.actionDetails.availableTargets[0];return i.isHostAccessManagerAvailable&&d.model&&d.model.exceptionUsers!==i.exceptionUsers&&(e.exceptionUsers=d.model.exceptionUsers,u=!0),u&&t.apply(n,"com.vmware.vsphere.client.host.config.HostLockdownModeUpdateSpec",e),!0}var l,d,u=!1;return n(),{getPageDefinitions:o,getLockdownModePageModel:a,getExceptionUsersPageModel:s,submit:c}}}angular.module("com.vmware.vsphere.client.host").factory("SecurityProfileDialogManager",e),e.$inject=["i18nService","mutationService"]}(),function(){"use strict";function e(e,t,i,r,n){function o(o,a){var s={},c=t.$new();c.dialogOptions={};var l=new n(s,c.dialogOptions);c.manager=l,_.extend(c.dialogOptions,{iconClass:a.action.icon,actionDetails:{actionEval:a,availableTargets:[o]},show:!0,loading:!0,loadingMessage:i.getString("CommonUi","wizard.loading"),confirmOptions:{onClick:l.submit},resizable:!0,draggable:!0,maximizable:!0,pages:l.getPageDefinitions(),title:i.getString("HostUi","securityProfile.lockdownMode","")});var d={scope:c,configObjectName:"dialogOptions"};r(d),e.getProperties(o,["lockdownMode","exceptionUsers","isHostAccessManagerAvailable","name"]).then(function(e){_.extend(s,e),c.dialogOptions.pages=l.getPageDefinitions(),c.dialogOptions.title=i.getString("HostUi","securityProfile.lockdownMode",s.name),c.dialogOptions.loading=!1})}return{show:o}}angular.module("com.vmware.vsphere.client.host").service("securityProfileDialogService",e),e.$inject=["dataService","$rootScope","i18nService","vxMultiPageDialogService","SecurityProfileDialogManager"]}(),function(){"use strict";function e(e,t){function i(e,t){s.loading=!1,s.hostName=e,s.inMaintenanceMode=t}function r(e,t,i,r){s.loading=r,s.hostsNames.push(e),t?s.hostsInMm.push(i):(s.inMaintenanceMode=t,s.hostsNotInMm.push(e))}function n(){return s.shutdownReason}function o(){return s.onlyMmHosts}function a(){return s.hostsInMm}var s=this,c=e.modalOptions.dialogData.availableTargets;e.modalOptions.onSubmit=t.onOKClicked.bind(this,n,o,"shutdown",e.modalOptions,c,a),s.loading=!0,s.inMaintenanceMode=!0,s.onlyMmHosts=!1,c.length>1?(s.multipleHosts=!0,s.onlyMmHosts=!0,s.hostsNotInMm=[],s.hostsInMm=[],s.hostsNames=[],t.fetchHostsNameAndMaintenanceModeStatus(c,r)):t.fetchHostNameAndMaintenanceModeStatus(c,i)}angular.module("com.vmware.vsphere.client.host").controller("ShutdownConfirmationController",e),e.$inject=["$scope","confirmationDialogWithReasonService"]}(),function(){"use strict";function e(e,t,i){var r=this,n=e._route.objectId,o={title:i.getString("HostUi","systemResource.reservation"),objectId:n};r.headerOptions=o,r.cpuAllocation=null,r.memoryAllocation=null,r.fetchViewData=function(){t.getProperties(e._route.objectId,["systemResourceReservations"]).then(function(e){r.cpuAllocation=e.systemResourceReservations.cpuAllocation,r.memoryAllocation=e.systemResourceReservations.memoryAllocation})},r.fetchViewData()}angular.module("com.vmware.vsphere.client.host").controller("SystemResourceReservationsController",e),e.$inject=["$scope","dataService","i18nService"]}(),function(){"use strict";function e(e,t,i,r){function n(){t.getProperties(u,["config.systemSwapConfiguration","availableDatastoreNames"]).then(function(e){d.datastoreNames=e.availableDatastoreNames,l(e["config.systemSwapConfiguration"])})}function o(){return r.apply(u,"com.vmware.vim.binding.vim.host.SystemSwapConfiguration",a()),!0}function a(){return{_type:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration",option:s()}}function s(){var e=[];if(d.systemSwapSettings.canUseDatastore){var t=c(i.systemSwapType.DATASTORE,e.length);t.datastore=d.systemSwapSettings.selectedDatastore,e.push(t)}return d.systemSwapSettings.canUseHostCache&&e.push(c(i.systemSwapType.HOST_CACHE,e.length)),d.systemSwapSettings.canUseHostSwapFile&&e.push(c(i.systemSwapType.HOST_SWAP_LOCATION,e.length)),0===e.length&&e.push(c(i.systemSwapType.DISABLED,e.length)),e}function c(e,t){return{_type:e,key:t}}function l(e){null!==e&&(_.each(e.option,function(e){switch(e._type){case i.systemSwapType.DATASTORE:d.systemSwapSettings.canUseDatastore=!0,d.systemSwapSettings.selectedDatastore=e.datastore;break;case i.systemSwapType.HOST_CACHE:d.systemSwapSettings.canUseHostCache=!0;break;case i.systemSwapType.HOST_SWAP_LOCATION:d.systemSwapSettings.canUseHostSwapFile=!0}}),d.systemSwapSettings.selectedDatastore||_.isEmpty(d.datastoreNames)||(d.systemSwapSettings.selectedDatastore=d.datastoreNames[0]))}var d=this,u=e.modalOptions.dialogData.availableTargets[0];d.systemSwapSettings={canUseDatastore:!1,canUseHostCache:!1,canUseHostSwapFile:!1,selectedDatastore:null},e.modalOptions.onSubmit=o,n()}angular.module("com.vmware.vsphere.client.host").controller("editSystemSwapSettingsController",e),e.$inject=["$scope","dataService","systemSwapConstants","mutationService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("systemSwapConstants",{systemSwapType:{DATASTORE:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$DatastoreOption",HOST_CACHE:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$HostCacheOption",HOST_SWAP_LOCATION:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$HostLocalSwapOption",DISABLED:"com.vmware.vim.binding.vim.host.SystemSwapConfiguration$DisabledOption"}})}(),function(){"use strict";function e(e,t,i,r,n){this.loading=!0;var o=e._route.objectId;this.headerOptions={title:i.getString("HostUi","userWorldSwap.header"),objectId:o,actions:[{actionUid:"vsphere.core.host.actions.editSystemSwap",customLabel:i.getString("Common","settingsView.defaultEditActionLabel")}]},this.watchForObjects=[o],this.systemSwapConfigurationMessages=[],this.liveRefreshProperties=["config.systemSwapConfiguration.option"],this.getViewData=function(){t.getProperties(o,["config.systemSwapConfiguration"]).then(function(e){this.processResponseData(e),this.loading=!1}.bind(this))["catch"](function(e){this.loading=!1,n.reject(e)}.bind(this))},this.processResponseData=function(e){var t=e["config.systemSwapConfiguration"];this.systemSwapConfigurationMessages=[],t&&_.each(t.option,function(e){switch(e._type){case r.systemSwapConfigurationOptionType.HOST_CACHE_OPTION_TYPE:this.systemSwapConfigurationMessages.push(i.getString("HostUi","userWorldSwap.hostCache"));break;case r.systemSwapConfigurationOptionType.HOST_LOCAL_SWAP_OPTION_TYPE:this.systemSwapConfigurationMessages.push(i.getString("HostUi","userWorldSwap.localDatastore"));break;case r.systemSwapConfigurationOptionType.DATASTORE_OPTION_TYPE:this.systemSwapConfigurationMessages.push(i.getString("HostUi","userWorldSwap.userSpecifiedDatastore",e.datastore));break;case r.systemSwapConfigurationOptionType.DISABLED_TYPE:this.systemSwapConfigurationMessages.push(i.getString("HostUi","userWorldSwap.disabled",e.datastore))}this.systemSwapConfigurationMessages=_.uniq(this.systemSwapConfigurationMessages)},this)},this.getViewData()}angular.module("com.vmware.vsphere.client.host").controller("SystemSwapSettingsController",e),e.$inject=["$rootScope","dataService","i18nService","systemSwapConfigurationConstants","$q"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(){e.modalOptions.alerts=[],e.modalOptions.isAlertClosed=!0,l.initDataObject.date=moment(l.initDataObject.dateObj).format("YYYY-MM-DD");var t=r.createTimeConfigSpec(e.modalOptions,l.initDataObject,l.startService);if(l.startService&&!l.initDataObject.ntpServers&&(e.modalOptions.alerts.push({type:o.validationBanner.type.ERROR,text:n.getString("HostUi","timeConfig.startWarning")}),e.modalOptions.isAlertClosed=!1),0===e.modalOptions.alerts.length)return i.apply(l.objectId,"com.vmware.vsphere.client.host.config.TimeConfigSpec",t),!0}function s(){t.getData(l.objectId,"com.vmware.vsphere.client.h5.host.model.TimeConfigData").then(function(e){l.data=e,l.data&&(l.initDataObject=r.initData(l.data),l.initDataObject.dateObj=moment(l.data.currentTimeInMillis).toDate()),c(!1)})}function c(t){e.modalOptions.submitDisabled=t,l.loading=t}var l=this;l.objectId=e.modalOptions.dialogData.availableTargets[0],l.startService=!1,c(!0),e.modalOptions.isAlertClosed=!0,e.modalOptions.defaultButton="submit",e.modalOptions.onSubmit=a,l.policyDropdownList=r.getPolicyDropdownList(),s()}angular.module("com.vmware.vsphere.client.host").controller("EditTimeConfigurationController",e),e.$inject=["$scope","dataService","mutationService","editTimeConfigurationService","i18nService","vuiConstants"]}(),function(){"use strict";function e(e,t,i){function r(e,t){v=e.ntpServiceId,m=e.dateTimeConfig,g=t,h={_type:"com.vmware.vsphere.client.host.config.TimeConfigSpec",dateTimeConfig:m}}function n(t){return{dateTimeConfig:t.dateTimeConfig,ntpServiceId:t.ntpServiceId,selectedPolicy:p(t.ntpServicePolicy),manuallySetTime:!t.ntpClientEnabled,ntpServers:t.dateTimeConfig.ntpConfig.server?t.dateTimeConfig.ntpConfig.server.join():"",isRunning:t.ntpServiceState,serviceStatus:t.ntpServiceState?e.getString("HostUi","timeConfig.ntpServiceStatusRunning"):e.getString("HostUi","timeConfig.ntpServiceStatusStopped"),date:moment(t.currentTimeInMillis).format("YYYY-MM-DD"),time:moment(t.currentTimeInMillis).format("HH:mm:ss")}}function o(e,t,i){return e.alerts=[],e.isAlertClosed=!0,t.manuallySetTime?s(t,e):c(t,i)}function a(){return[{key:"automatic",label:e.getString("HostUi","timeConfig.startupPolicyOpenPorts")},{key:"on",label:e.getString("HostUi","timeConfig.startupPolicyWithHost")},{key:"off",label:e.getString("HostUi","timeConfig.startupPolicyManually")}]}function s(t,r){var n=l(t,!1);try{n.targetTime=u(t.date,t.time)}catch(o){r.alerts.push({type:i.validationBanner.type.ERROR,text:e.getString("HostUi","timeConfig.dateTimeFormat.error")}),r.isAlertClosed=!1}return n}function c(e,i){var r=l(e,!0);return i&&(r.action=t.action.START),r.dateTimeConfig.ntpConfig={_type:"com.vmware.vim.binding.vim.host.NtpConfig",configFile:[],server:d(e.ntpServers)},r}function l(e,t){var i={};return i.enableNtpClient=t,i.dateTimeConfig=e.dateTimeConfig,i.serviceId=e.ntpServiceId,i.servicePolicy=e.selectedPolicy.key,i}function d(e){e=e?e:"";var t=e.split(",");return t=_.map(t,function(e){return e.trim()}),t=_.filter(t,function(e){return!!e})}function u(e,t){if("string"!=typeof e||!moment(e,"YYYY-MM-DD",!0).isValid())throw new Error("Invalid date");if("string"!=typeof t||!moment(t,"HH:mm:ss",!0).isValid())throw new Error("Invalid time");return moment(e+" "+t,"YYYY-MM-DD HH:mm:ss",!0).toDate()}function p(e){var t=a();return _.filter(t,function(t){return t.key===e})[0]}var v,m,g,h;return{getPolicyDropdownList:a,createTimeConfigSpec:o,initData:n,initService:r}}angular.module("com.vmware.vsphere.client.host").service("editTimeConfigurationService",e),e.$inject=["i18nService","hostServicesConstants","vuiConstants"]}(),function(){"use strict";function e(e,t,i,r){function n(){t.getData(a,"com.vmware.vsphere.client.h5.host.model.TimeConfigData").then(function(e){e&&r.formatDate(e.currentTimeInMillis).then(function(t){o.data=e,o.currentTime=t})})}var o=this,a=e._route.objectId,s={title:i.getString("HostUi","timeConfig.tabLabel"),objectId:a,actions:[{actionUid:"vsphere.core.host.actions.editTimeConfigurationSettings",customLabel:i.getString("HostUi","editTimeConfigurationButton.label")}]};o.headerOptions=s,o.watchForObjects=[a],o.getViewData=n,o.data={},o.liveRefreshProperties=["config.dateTimeInfo.ntpConfig.configFile","config.dateTimeInfo.ntpConfig.server","config.firewall.ruleset","config.service.service"],n()}angular.module("com.vmware.vsphere.client.host").controller("TimeConfigSettingsController",e),e.$inject=["$scope","dataService","i18nService","timeFormatterService"]}(),function(){"use strict";function e(e,t,i,r,n,o){function a(e,r,a,c){var l={title:t.getString("HostUi","editSingleVmStartupShutdownSettingsDialog.title"),subTitle:{text:e},contentTemplate:"host-ui/resources/host/views/settings/vmStartupShutdown/editSingleVmStartupShutdownSettingsDialog.html",defaultButton:"submit",alerts:[],dialogData:{vmPowerInfoSettings:s(r,a)},onSubmit:function(){var e=p(l.dialogData.vmPowerInfoSettings),t=n.validateStartStopDelay(e.startDelay,e.stopDelay,l.dialogData.vmPowerInfoSettings.startupSettings.startupType,l.dialogData.vmPowerInfoSettings.shutdownSettings.shutdownType);return t.length>0?(l.alerts=_.map(t,function(e){return{text:e,type:o.notifications.type.ERROR
}}),!1):(r=_.extend(r,e),c(r),!0)}};i.openOkCancelModal(l)}function s(e,t){var i={startupSettings:{startupType:u(e.startDelay),startDelay:l(e.startDelay,t.startDelay),heartbeat:d(e.waitForHeartbeat,t)},shutdownSettings:{shutdownType:u(e.stopDelay),stopDelay:l(e.stopDelay,t.stopDelay),stopAction:c(e.stopAction,t)}};return i}function c(t,i){return t===e.SYSTEM_DEFAULT?c(i.stopAction):_.find(n.getShutdownActionOptions(),function(e){return e.action===t})}function l(t,i){return t===e.SYSTEM_DEFAULT_DELAY?i:t}function d(t,i){return t===e.heartbeat.YES||t!==e.heartbeat.NO&&(t===e.heartbeat.SYSTEM_DEFAULT?i.waitForHeartbeat:void 0)}function u(t){return t===e.SYSTEM_DEFAULT_DELAY?e.SYSTEM_DEFAULT:e.USER_DEFINED}function p(t){var i={};return t.startupSettings.startupType===e.SYSTEM_DEFAULT?(i.startDelay=-1,i.waitForHeartbeat=e.heartbeat.SYSTEM_DEFAULT):(i.startDelay=t.startupSettings.startDelay,t.startupSettings.heartbeat?i.waitForHeartbeat=e.heartbeat.YES:i.waitForHeartbeat=e.heartbeat.NO),t.shutdownSettings.shutdownType===e.SYSTEM_DEFAULT?(i.stopDelay=-1,i.stopAction=e.SYSTEM_DEFAULT):(i.stopDelay=t.shutdownSettings.stopDelay,i.stopAction=t.shutdownSettings.stopAction.action),i}return{openSingleVmStartupShutdownSettingsDialog:a}}angular.module("com.vmware.vsphere.client.host").service("editSingleVmStartupShutdownService",e),e.$inject=["vmStartupShutdownConstants","i18nService","clarityModalService","$rootScope","editVmStartupShutdownService","clarityConstants"]}(),function(){"use strict";function e(e,t,i,r){var n=this;n.SYSTEM_DEFAULT=i.SYSTEM_DEFAULT,n.USER_DEFINED=i.USER_DEFINED,n.START_DELAY_MIN_VALUE=0,n.START_DELAY_MAX_VALUE=65535,n.STOP_DELAY_MIN_VALUE=0,n.STOP_DELAY_MAX_VALUE=65535,n.startupSettingHeader={title:r.getString("HostUi","editSingleVmStartupShutdownSettingsDialog.startupSetting.header")},n.shutdownSettingHeader={title:r.getString("HostUi","editSingleVmStartupShutdownSettingsDialog.shutdownSetting.header")},n.shutdownActionOptions=t.getShutdownActionOptions(),n.startupSettings=e.modalOptions.dialogData.vmPowerInfoSettings.startupSettings,n.shutdownSettings=e.modalOptions.dialogData.vmPowerInfoSettings.shutdownSettings,n.validateStartDelay=function(e){if("undefined"==typeof n.startupSettings.startDelay){var t=e.target.value;t>n.START_DELAY_MAX_VALUE?n.startupSettings.startDelay=n.START_DELAY_MAX_VALUE:n.startupSettings.startDelay=n.START_DELAY_MIN_VALUE}},n.validateStopDelay=function(e){if("undefined"==typeof n.shutdownSettings.stopDelay){var t=e.target.value;t>n.STOP_DELAY_MAX_VALUE?n.shutdownSettings.stopDelay=n.STOP_DELAY_MAX_VALUE:n.shutdownSettings.stopDelay=n.STOP_DELAY_MIN_VALUE}}}angular.module("com.vmware.vsphere.client.host").controller("editSingleVmStartupShutdownSettingsDialogController",e),e.$inject=["$scope","editVmStartupShutdownService","vmStartupShutdownConstants","i18nService"]}(),function(){"use strict";function e(e,t,i,r,n,o,a,s,c){function l(){if(P.loading)return!1;e.modalOptions.alerts=[];var t=i.validateStartStopDelay(e.dialogData.startupDelay,e.dialogData.shutdownDelay,null,null);return t.length>0?(e.modalOptions.alerts=_.map(t,function(e){return{text:e,type:c.validationBanner.type.ERROR}}),!1):(i.updateHostVmStartupShutdownData(C,e.dialogData,P.hostAutoStartConfig.powerInfo),!0)}function d(){e.$watchCollection(function(){return P.datagridOptions.selectedItems},u)}function u(){m()}function p(e){if(1===P.datagridOptions.selectedItems.length){var t=P.datagridOptions.selectedItems[0],r=f(t);e===o.state.UP&&(r=i.moveUpAction(r,P.hostAutoStartConfig.powerInfo,v)),e===o.state.DOWN&&(r=i.moveDownAction(r,P.hostAutoStartConfig.powerInfo,v)),P.oldSelection=angular.merge({},t),S(),a(function(){y()},0,!1)}}function v(e,t){P.hostAutoStartConfig.powerInfo[e]&&(P.hostAutoStartConfig.powerInfo[e].startOrder=t)}function m(){var e=P.datagridOptions.actionBarOptions.actions[0],t=P.datagridOptions.actionBarOptions.actions[1],i=P.datagridOptions.actionBarOptions.actions[2];if(_.isEmpty(P.datagridOptions.selectedItems))return e.enabled=!1,t.enabled=!1,void(i.enabled=!1);var r=P.datagridOptions.selectedItems[0];switch(r.category){case o.category.MANUAL:e.enabled=!0,t.enabled=!1,i.enabled=!1;break;case o.category.AUTOMATIC:e.enabled=!0,t.enabled=!0,i.enabled=!0;break;case o.category.AUTOMATIC_ORDERED:t.enabled=!0,i.enabled=!0,1===r.startOrder?e.enabled=!1:e.enabled=!0;break;default:e.enabled=!1,t.enabled=!1,i.enabled=!1}}function g(){if(1===P.datagridOptions.selectedItems.length){var e=P.datagridOptions.selectedItems[0],t=f(e),i=P.hostAutoStartConfig.defaults;s.openSingleVmStartupShutdownSettingsDialog(e.name,t,i,h)}}function h(e){var t=e.key.value,r=i.findPowerInfoIndex(P.hostAutoStartConfig.powerInfo,t);P.hostAutoStartConfig.powerInfo[r]=e,S()}function f(e){var t=i.findPowerInfoIndex(P.hostAutoStartConfig.powerInfo,e.powerInfoKey);return P.hostAutoStartConfig.powerInfo[t]}function S(){P.datagridOptions.data=n.populateDatagrid(P.hostAutoStartConfig,P.vmStartupData)}function y(){if(P.gridWidget){var e=P.gridWidget.virtualScrollable.verticalScrollbar.scrollTop();P.gridWidget.refresh(),P.gridWidget.virtualScrollable.verticalScrollbar.scrollTop(e);var t=P.gridWidget.items().filter(".k-state-selected");if(1===t.length&&(P.gridWidget.virtualScrollable.scrollIntoView(t),t.scrollParent)){var i=t[0].offsetTop,r=i+t.height(),n=t.scrollParent().scrollTop(),o=n+t.scrollParent().height();i<n?(e=i,P.gridWidget.virtualScrollable.verticalScrollbar.scrollTop(e)):o<r&&(e=n+(r-o),P.gridWidget.virtualScrollable.verticalScrollbar.scrollTop(e))}}}e.modalOptions.onSubmit=l;var P=this;P.loading=!0;var C=e._route.objectId;P.headerOptions={title:r.getString("HostUi","vmStartUp.VmStartupAndShutdown"),objectId:C,actions:[]},P.datagridOptions=n.createDatagridOptions(!0,p,g),e.dialogData={},d(),P.vmStartupData=[],P.hostAutoStartConfig=null,P.oldSelection=null,P.gridWidget=null,e.preselectComparator=function(e){return P.oldSelection&&e.powerInfoKey&&P.oldSelection.powerInfoKey.value===e.powerInfoKey.value},t.getData(C,"com.vmware.vsphere.client.h5.host.model.HostAutoStartData").then(function(t){P.hostAutoStartConfig=t.autoStartConfig,P.vmStartupData=t.vmStartupData,P.hostAutoStartConfig.powerInfo=i.setDefaultPowerInfoForVms(P.vmStartupData,P.hostAutoStartConfig),e.dialogData=i.createDialogOptions(P.hostAutoStartConfig,P.vmStartupData),P.datagridOptions.data=n.populateDatagrid(P.hostAutoStartConfig,P.vmStartupData),P.shutdownActionOptions=i.getShutdownActionOptions(),P.loading=!1}),e.$watch("dialogData",function(t){_.isEmpty(t)||P.loading||(P.hostAutoStartConfig.defaults=i.createSystemDefaultsSettings(e.dialogData),S())},!0),e.$on("kendoWidgetCreated",function(e,t){t&&t.constructor===kendo.ui.Grid&&(P.gridWidget=t)}),P.validateStartupDelay=function(){"undefined"==typeof e.dialogData.startupDelay&&(e.dialogData.startupDelay=0)},P.validateShutdownDelay=function(){"undefined"==typeof e.dialogData.shutdownDelay&&(e.dialogData.shutdownDelay=0)}}angular.module("com.vmware.vsphere.client.host").controller("EditVmStartupShutdownController",e),e.$inject=["$scope","dataService","editVmStartupShutdownService","i18nService","vmStartupShutdownService","vmStartupShutdownConstants","$timeout","editSingleVmStartupShutdownService","vuiConstants"]}(),function(){"use strict";function e(e,t,i){function r(){return P}function n(e,t){return{autoPowerVms:e.defaults.enabled,startupDelay:e.defaults.startDelay,shutdownDelay:e.defaults.stopDelay,shutdownAction:o(e.defaults),vmStartupData:t,waitForHeartbeat:e.defaults.waitForHeartbeat}}function o(e){return _.find(P,function(t){return e.stopAction.toLowerCase()===t.action})}function a(e){return{enabled:e.autoPowerVms,startDelay:e.startupDelay,stopDelay:e.shutdownDelay,waitForHeartbeat:e.waitForHeartbeat,stopAction:e.shutdownAction.action,_type:"com.vmware.vim.binding.vim.host.AutoStartManager$SystemDefaults"}}function s(e,t,r){var n={defaults:a(t),powerInfo:c(l(t.vmStartupData),r)},o=_.extend(n,{_type:"com.vmware.vim.binding.vim.host.AutoStartManager$Config"});i.apply(e,"com.vmware.vim.binding.vim.host.AutoStartManager$Config",o)}function c(e,t){return _.map(e,function(e){var i=_.find(t,function(t){return e.provider.value===t.key.value});return{_type:"com.vmware.vim.binding.vim.host.AutoStartManager$AutoPowerInfo",key:e.provider,startAction:i.startAction,startDelay:i.startDelay,startOrder:i.startOrder,stopAction:i.stopAction,stopDelay:i.stopDelay,waitForHeartbeat:i.waitForHeartbeat}})}function l(e){return _.filter(e,function(e){return e.isNormalVMOrPrimaryFTVM===!0})}function d(t,i,r){var n,o,a,s=v(i);return t.startAction===e.startAction.NONE?(t.startAction=e.startAction.POWER_ON_API_VALUE,t.startOrder=-1):t.startAction.toLowerCase()===e.startAction.POWER_ON_LOWERCASE&&t.startOrder===-1?t.startOrder=++s:(n=t.startOrder,o=--n,a=p(i,o),r(a,t.startOrder),t.startOrder=o),t}function u(t,i,r){var n,o,a,s=v(i);return t.startAction.toLowerCase()===e.startAction.POWER_ON_LOWERCASE&&t.startOrder===-1?t.startAction=e.startAction.NONE:t.startAction.toLowerCase()===e.startAction.POWER_ON_LOWERCASE&&t.startOrder!==-1&&(t.startOrder===s?t.startOrder=-1:(n=t.startOrder,o=++n,a=p(i,o),r(a,t.startOrder),t.startOrder=n)),t}function p(e,t){return _.findIndex(e,function(e){return e.startOrder===t})}function v(t){var i=0;return _.each(t,function(t){t.startAction.toLowerCase()===e.startAction.POWER_ON_LOWERCASE&&t.startOrder>i&&(i=t.startOrder)}),i}function m(e,t){return _.findIndex(e,function(e){return e.key.value===t.value})}function g(e,t){return _.map(e,function(e){var i=_.find(t.powerInfo,function(t){return e.provider.value===t.key.value});return i||(i=h(e)),i})}function h(t){return{_type:"com.vmware.vim.binding.vim.host.AutoStartManager$AutoPowerInfo",key:t.provider,startAction:e.startAction.NONE,startDelay:e.SYSTEM_DEFAULT_DELAY,startOrder:-1,stopAction:e.SYSTEM_DEFAULT,stopDelay:e.SYSTEM_DEFAULT_DELAY,waitForHeartbeat:e.heartbeat.SYSTEM_DEFAULT}}function f(i,r,n,o){var a=[];_.isNull(i)||_.isUndefined(i)?a.push(t.getString("HostUi","vmStartUp.validationError.fieldsRequired")):(_.isNull(r)||_.isUndefined(r))&&a.push(t.getString("HostUi","vmStartUp.validationError.fieldsRequired"));var s=Number.parseInt(i),c=Number.parseInt(r);return _.isNull(i)||_.isUndefined(i)||y(i.toString())&&S(s,n)?_.isNull(r)||_.isUndefined(r)||y(r.toString())&&S(c,o)||a.push(t.getString("HostUi","vmStartUp.validationError.fieldsMaxValue",e.MAX_ALLOWED_DELAY)):a.push(t.getString("HostUi","vmStartUp.validationError.fieldsMaxValue",e.MAX_ALLOWED_DELAY)),a}function S(t,i){return!(t<0&&e.SYSTEM_DEFAULT!==i||t>e.MAX_ALLOWED_DELAY)}function y(e){var t=Number.parseInt(e);return t<=Number.MIN_SAFE_INTEGER||t>=Number.MAX_SAFE_INTEGER||"NaN"!==e&&t.toString()===e}var P=[{name:t.getString("HostUi","vmStartUp.actionGuestShutdown"),action:"guestshutdown"},{name:t.getString("HostUi","vmStartUp.actionPowerOff"),action:"poweroff"},{name:t.getString("HostUi","vmStartUp.actionPowerSuspend"),action:"suspend"},{name:t.getString("HostUi","vmStartUp.actionNone"),action:"none"}];return{createDialogOptions:n,updateHostVmStartupShutdownData:s,getShutdownActionOptions:r,setDefaultPowerInfoForVms:g,moveUpAction:d,moveDownAction:u,findPowerInfoIndex:m,createSystemDefaultsSettings:a,validateStartStopDelay:f}}angular.module("com.vmware.vsphere.client.host").service("editVmStartupShutdownService",e),e.$inject=["vmStartupShutdownConstants","i18nService","mutationService"]}(),function(){"use strict";angular.module("com.vmware.vsphere.client.host").constant("vmStartupShutdownConstants",{category:{MANUAL:"Manual",AUTOMATIC:"Automatic",AUTOMATIC_ORDERED:"Automatic Ordered"},state:{UP:"up",DOWN:"down",EDIT:"edit"},startAction:{NONE:"none",POWER_ON_LOWERCASE:"poweron",POWER_ON_API_VALUE:"powerOn"},heartbeat:{YES:"yes",NO:"no",SYSTEM_DEFAULT:"systemDefault"},SYSTEM_DEFAULT:"systemDefault",USER_DEFINED:"userDefined",SYSTEM_DEFAULT_DELAY:-1,MAX_ALLOWED_DELAY:65535})}(),function(){"use strict";function e(e,t,i,r){function n(e,t){var i=_.filter(t,function(e){return e.isNormalVMOrPrimaryFTVM===!0}),r={automaticOrdered:[],automatic:[],manualStartup:[]};if(!e||!e.defaults)return[];_.forEach(i,function(t){s(t,e,r)}),r.automaticOrdered.sort(function(e,t){return e.startOrder-t.startOrder}),r.automaticOrdered.unshift(d("vmStartUp.categoryAutomaticOrdered")),r.automatic.unshift(d("vmStartUp.categoryAutomatic")),r.manualStartup.unshift(d("vmStartUp.categoryManual"));var n=[];return r.automaticOrdered.length>1&&(n=n.concat(r.automaticOrdered)),r.automatic.length>1&&(n=n.concat(r.automatic)),r.manualStartup.length>1&&(n=n.concat(r.manualStartup)),n}function o(i,n,o){return{selectionMode:t.grid.selectionMode.SINGLE,sortMode:t.grid.sortMode.SINGLE,searchable:!1,resizable:!0,selectedItems:[],actionBarOptions:i?a(n,o):null,columnDefs:[{field:"startOrderFormatted",template:r.getHtmlEscapingTemplateRenderFunction('<span class="{{startOrderColumnClasses}}">{{startOrderFormatted}}</span>'),sortable:!1,searchable:!1,displayName:e.getString("HostUi","vmStartUp.StartupOrder")},{field:"name",sortable:!1,searchable:!1,template:r.getHtmlEscapingTemplateRenderFunction('<span title="{{name}}">{{name}}</span>'),displayName:e.getString("HostUi","vmStartUp.VMColumn")},{field:"startUp",sortable:!1,searchable:!1,template:r.getHtmlEscapingTemplateRenderFunction("{{startUp}}"),displayName:e.getString("HostUi","vmStartUp.StartUpColumn")},{field:"startUpDelay",sortable:!1,searchable:!1,template:r.getHtmlEscapingTemplateRenderFunction("{{startUpDelay}}"),displayName:e.getString("HostUi","vmStartUp.StartUpDelayColumn")},{field:"vmwareTools",sortable:!1,searchable:!1,template:r.getHtmlEscapingTemplateRenderFunction("{{vmwareTools}}"),displayName:e.getString("HostUi","vmStartUp.vmWareToolsColumns"),visible:!!i},{field:"shutdown",sortable:!1,searchable:!1,template:r.getHtmlEscapingTemplateRenderFunction("{{shutdown}}"),displayName:e.getString("HostUi","vmStartUp.ShutdownBehaviorColumn")},{field:"shutdownDelay",sortable:!1,searchable:!1,template:r.getHtmlEscapingTemplateRenderFunction("{{shutdownDelay}}"),displayName:e.getString("HostUi","vmStartUp.ShutdownDelayColumn")}],data:[],height:"100%",pageConfig:{hidePager:!0}}}function a(e,t){return v.onClick=function(){e(i.state.UP)},m.onClick=function(){e(i.state.DOWN)},g.onClick=function(){t()},{actions:[v,m,g],updateActionBar:function(){}}}function s(e,t,r){var n=p(t,e.provider),o=t.defaults;n||(n=o);var a=c(e,n,o);switch(a.category){case i.category.MANUAL:r.manualStartup.push(a);break;case i.category.AUTOMATIC_ORDERED:r.automaticOrdered.push(a);break;default:r.automatic.push(a)}}function c(t,r,n){var o=r.startOrder||-1,a=o>-1?o:"",s={startOrder:o,startOrderFormatted:a,startOrderColumnClasses:"automatic-order",name:t.name,startUp:function(){return r.startAction&&r.startAction.toLowerCase()===i.startAction.POWER_ON_LOWERCASE?e.getString("HostUi","vmStartUp.vmStartupEnabled"):e.getString("HostUi","vmStartUp.vmStartupDisabled")}(),startUpDelay:r.startDelay!==i.SYSTEM_DEFAULT_DELAY?r.startDelay:n.startDelay,shutdown:u(r.stopAction,n),shutdownDelay:r.stopDelay!==i.SYSTEM_DEFAULT_DELAY?r.stopDelay:n.stopDelay,vmwareTools:l(r,n),powerInfoKey:r.key};return r.startAction&&r.startAction!==i.startAction.NONE?r.startOrder>-1?s.category=i.category.AUTOMATIC_ORDERED:s.category=i.category.AUTOMATIC:s.category=i.category.MANUAL,s}function l(t,r){return t===r||t.waitForHeartbeat===i.heartbeat.SYSTEM_DEFAULT?r.waitForHeartbeat?e.getString("HostUi","vmStartUp.toolsContinueLabel"):e.getString("HostUi","vmStartUp.toolsWaitStatupLabel"):t.waitForHeartbeat===i.heartbeat.YES?e.getString("HostUi","vmStartUp.toolsContinueLabel"):e.getString("HostUi","vmStartUp.toolsWaitStatupLabel")}function d(t){return{startOrder:-1,startOrderFormatted:e.getString("HostUi",t),startOrderColumnClasses:"vm-startup-category",name:"",startUp:"",startUpDelay:"",shutdown:"",shutdownDelay:""}}function u(t,i){switch(t.toLowerCase()){case"poweroff":return e.getString("HostUi","vmStartUp.actionPowerOff");case"suspend":return e.getString("HostUi","vmStartUp.actionPowerSuspend");case"none":return e.getString("HostUi","vmStartUp.actionNone");case"guestshutdown":return e.getString("HostUi","vmStartUp.actionGuestShutdown");case"systemdefault":return u(i.stopAction,null);default:return""}}function p(e,t){return _.find(e.powerInfo,function(e){return _.isEqual(t,e.key)})}var v={actionId:i.state.UP,tooltipText:e.getString("HostUi","vmStartUp.button.moveUp.description"),enabled:!1,label:e.getString("HostUi","vmStartUp.MoveUp"),iconClass:"vx-icon-moveUp"},m={actionId:i.state.DOWN,tooltipText:e.getString("HostUi","vmStartUp.button.moveDown.description"),enabled:!1,label:e.getString("HostUi","vmStartUp.MoveDown"),iconClass:"vx-icon-moveDown"},g={actionId:i.state.EDIT,tooltipText:e.getString("HostUi","vmStartUp.Edit"),enabled:!1,label:e.getString("HostUi","vmStartUp.Edit"),iconClass:"vx-icon-edit16x16"};return{populateDatagrid:n,createDatagridOptions:o,findPowerInfoForVm:p}}angular.module("com.vmware.vsphere.client.host").service("vmStartupShutdownService",e),e.$inject=["i18nService","vuiConstants","vmStartupShutdownConstants","templateHelperService"]}(),function(){"use strict";function e(e,t,i,r){function n(){i.getData(a,"com.vmware.vsphere.client.h5.host.model.HostAutoStartData").then(function(e){var t=e.autoStartConfig;o.datagridOptions.data=r.populateDatagrid(t,e.vmStartupData),o.loader=!0})}var o=this;o.loader=!0;var a=e._route.objectId;o.headerOptions={title:t.getString("HostUi","vmStartUp.VmStartupAndShutdown"),objectId:a,actions:[{actionUid:"vsphere.core.host.actions.editVmStartupShutdownAction",customLabel:t.getString("Common","settingsView.defaultEditActionLabel")}]},o.objectsToWatch=[a],o.liveRefreshProperties=["config.autoStart.powerInfo","config.autoStart.defaults.stopDelay","config.autoStart.defaults.enabled","config.autoStart.defaults.stopAction","config.autoStart.defaults.startDelay","vm"],o.datagridOptions=r.createDatagridOptions(),o.fetchViewData=n,n()}angular.module("com.vmware.vsphere.client.host").controller("VMStartupShutdownViewController",e),e.$inject=["$scope","i18nService","dataService","vmStartupShutdownService"]}(),function(){"use strict";function e(e,t,i,r){function n(){t.getData(d,"com.vmware.vsphere.client.h5.host.model.SwapfileLocationData").then(function(e){l.data=e,o()})}function o(){l.data&&(l.isStandalone=l.data.isStandalone,"vmDirectory"===l.data.vmSwapPlacement?(l.swapfileLocation=c("vmDir"),l.isDatastore=!1,l.clusterInfo=l.isStandalone?null:s("clusteredVmDirectory")):(l.clusterInfo=l.isStandalone?null:s("clusteredDatastore"),a()))}function a(){return l.data.localSwapDatastore?(l.swapfileLocation=l.data.datastoreName,l.isDatastore=!0,void(l.datastoreRef=r.getVsphereObjectId(l.data.localSwapDatastore))):(l.swapfileLocation=c("noDatastore"),void(l.isDatastore=!1))}function s(e){return{clusteredDatastore:i.getString("HostUi","swapfile.hostInCluster.dataStore"),clusteredVmDirectory:i.getString("HostUi","swapfile.hostInCluster.vmDirectory")}[e]}function c(e){return{vmDir:i.getString("HostUi","swapfile.vmDirectory"),noDatastore:i.getString("HostUi","swapfile.noDataStore")}[e]}var l=this,d=e._route.objectId;l.objectsToWatch=[d],l.headerOptions={title:i.getString("HostUi","settings.swapfileHeader"),objectId:d,actions:[{actionUid:"vsphere.core.host.actions.editSwapfileLocation",customLabel:i.getString("HostUi","settings.edit")}]},l.data={},l.isStandalone=!0,l.isDatastore=!1,l.swapfileLocation=null,l.clusterInfo=null,l.liveRefreshProperties=["config.localSwapDatastore","config.fileSystemVolume.mountInfo"],l.getViewData=n,n()}angular.module("com.vmware.vsphere.client.host").controller("SwapFileLocationController",e),e.$inject=["$scope","dataService","i18nService","defaultUriSchemeUtil"]}(),angular.module("com.vmware.vsphere.client.host").controller("HostConfigurationController",["$scope","$controller","$sce","i18nService","dataService",function(e,t,i,r,n){function o(){n.getProperties(e._route.objectId,["imageProfileName"]).then(function(t){e.imageProfile=t.imageProfileName?t.imageProfileName:r.getString("HostUi","config.imageProfileNotAvailable")})}function a(){if(!e.data||!e.data.haStateImage)return null;switch(e.data.haStateImage){case"statusGreen":return"vsphere-icon-status-ok";case"statusYellow":return"vsphere-icon-status-warning";case"statusRed":return"vsphere-icon-status-error";case"statusUnknown":return"vsphere-icon-status-unknown";default:return null}}function s(){if(!e.data||!e.data.haStateImage)return null;switch(e.data.haStateImage){case"statusYellow":return"Common:entityStatus.yellow";case"statusRed":return"Common:entityStatus.red";case"statusUnknown":return"Common:entityStatus.gray";default:return null}}function c(){return e.data&&e.data.haStateString?i.trustAsHtml(r.getString("HostUi",e.data.haStateString+".description")):null}function l(){return e.data&&!e.data.ftSupported&&Array.isArray(e.data.ftUnsupportedReasonRows)?e.data.ftUnsupportedReasonRows:[]}function d(){return e.data&&!e.data.cptFtSupported&&Array.isArray(e.data.cptUnsupportedReasonRows)?e.data.cptUnsupportedReasonRows:[]}angular.extend(this,t("GenericPortletController",{$scope:e})),this.getHaStateImage=a,this.getHaStateImageAriaLabel=s,this.getHaStateDescriptionHtml=c,this.getUpFtUnsupportedReasonsRows=l,this.getSmpFtUnsupportedReasonsRows=d,this.liveRefreshProperties=["runtime.dasHostState","summary.currentEVCModeKey","runtime.connectionState","config.virtualNicManagerInfo.netConfig"],e.imageProfile=r.getString("HostUi","config.imageProfileLoading"),o(),e.$watch("data.dasHostState && data.dasHostState.state",function(t){t||(e.haStackBlockExpanded=!1)}),e.$watch("ctrl.getUpFtUnsupportedReasonsRows().length > 0",function(t){t||(e.upFtStackBlockExpanded=!1)}),e.$watch("ctrl.getSmpFtUnsupportedReasonsRows().length > 0",function(t){t||(e.smpFtStackBlockExpanded=!1)})}]),angular.module("com.vmware.vsphere.client.host").controller("HostHardwareController",["$scope","$controller","featureFlagsService","dataService",function(e,t,i,r){function n(){a.enabled=!0,a.loading=!0,r.getData(e._route.objectId,"com.vmware.vsphere.client.host.model.HostPmemData").then(function(e){a.pmemSizeText=e.pmemSizeText,a.pmemUsageText=e.pmemUsageText,a.pmemUsagePercentage=e.pmemUsagePercentage,a.loading=!1},function(){a.loading=!1})}function o(){return"function"==typeof i.PMemEnabled&&i.PMemEnabled()}angular.extend(this,t("GenericPortletController",{$scope:e})),this.liveRefreshProperties=["runtime.connectionState","datastore"],e.navigateToDatastores=function(){e._navigate("vsphere.core.host.relatedDatastoresTab",e._route.objectId)},e.navigateToNetworks=function(){e._navigate("vsphere.core.host.relatedNetworksTab",e._route.objectId)};var a=this.pmemData={enabled:!1,loading:!1,pmemUsageText:void 0,pmemSizeText:void 0},s=e.$watch("data",function(e){e.hasOwnProperty("provider")&&o()&&e.hasPmemStorage&&n()});e.$on("$destroy",function(){s()})}]),angular.module("com.vmware.vsphere.client.host").constant("suppressWarningSettingConstants",{SUPPRESS_SHELL_WARNING_KEY:"UserVars.SuppressShellWarning",SUPPRESS_HYPERTHREAD_WARNING_KEY:"UserVars.SuppressHyperthreadWarning",WARNING_SUPPRESS_VALUE:{TRUE:1,FALSE:0}}),function(){"use strict";function e(e,t,i,r){function n(t,i){e.getResourceInfo(t,"advancedSettings").then(function(e){var r=e.properties,n=o(r,i);a(n,t)})}function o(e,t){var i=e.find(function(e){return e.key===t});return i}function a(e,n){e.value=r.WARNING_SUPPRESS_VALUE.TRUE;var o=s(e);t.apply(n,"com.vmware.vsphere.client.host.config.HostAdvancedSettingsSpec",o).then(function(e){e&&e.error||i.$broadcast("IssueChangeEvent")})}function s(e){var t=[{_type:"com.vmware.vim.binding.vim.option.OptionValue",key:e.key,value:[c(e.type),e.value]}];return{hostSettingsChangeset:t}}function c(e){var t;switch(e){case"int":t="java.lang.Integer";break;case"long":t="java.lang.Long";break;case"boolean":t="java.lang.Boolean";break;default:t="java.lang.String"}return t}return{suppressWarnings:n}}angular.module("com.vmware.vsphere.client.host").service("suppressWarningSettingService",e),e.$inject=["resourceService","mutationService","$rootScope","suppressWarningSettingConstants"]}();var h5_vapp;!function(e){function t(e){h5.actions["com.vmware.eam.actions.agencyIssue.resolve"]=function(t,i,r){e.resolveIssue(r.agencyId,r.issueKey)},h5.actions["com.vmware.eam.actions.agency.deleteAgency"]=function(t,i,r){e.deleteAgency(i,r)},h5.actions["com.vmware.eam.actions.agency.resolveAllIssues"]=function(t,i,r){e.resolveAllIssues(i,r)}}h5=h5||{},h5.vcextension={angularModule:angular.module("com.vmware.vsphere.client.vcextension",["com.vmware.platform.ui"])},angular.module("com.vmware.vsphere.client.vcextension").run(["agencyOperationManagerService",t])}(h5_vapp||(h5_vapp={}));var h5_vcextension;!function(e){var t=function(){function e(e){this.$scope=e,this.vcexstensionId=this.$scope._route.objectId}return e.$inject=["$scope"],e}();e.VcExtensionSummarySolutionsViewController=t,angular.module("com.vmware.vsphere.client.vcextension").controller("vcExtensionSummarySolutionsViewController",t)}(h5_vcextension||(h5_vcextension={})),h5=h5||{},h5.autodeploy={angularModule:angular.module("com.vmware.vsphere.client.autodeploy",[])},h5=h5||{},h5.codecapture={angularModule:angular.module("com.vmware.vsphere.client.codecapture",[])};var codecapture_ui;!function(e){var t=function(){function e(){}return e.prototype.$onInit=function(){this.onResize()},e.prototype.onResize=function(){var e=this;setTimeout(function(){e.resized=!e.resized},100)},e}();angular.module("com.vmware.vsphere.client.codecapture").controller("CodeCaptureViewController",t)}(codecapture_ui||(codecapture_ui={})),h5=h5||{},h5["dashboard-lite"]={angularModule:angular.module("com.vmware.vsphere.client.dashboard-lite",[])},h5=h5||{},h5.devcenter={angularModule:angular.module("com.vmware.vsphere.client.devcenter",[])},h5=h5||{},h5.licenseLib={angularModule:angular.module("com.vmware.vsphere.client.licenseLibUi",["com.vmware.platform.ui","com.vmware.vsphere.client.commonModule"])},function(){"use strict";function e(e,t,i,r,n,o,a,s){function c(e,t){return function(i){var r=i[e],n=i[t];if(!r&&!n)return"";var o=a.getColumnRenderer("object-link");return o([void 0,e,n],i)}}function l(){var e=h.treeListWidget.select();if(1===e.length&&e.scrollParent&&e.scrollParent()&&0!==e.scrollParent().length){var t=e.scrollParent(),i=e[0].offsetTop,r=i+e.height(),n=t.scrollTop(),o=n+t.height();i<n?t.scrollTop(i):o<r&&t.scrollTop(n+(r-o))}}function d(){if(h.treeListWidget&&h.treeListWidget.columns&&h.treeListWidget.dataSource&&h.treeListWidget.dataSource.options&&h.treeListWidget.dataSource.options.data&&h.treeListWidget.dataSource.options.data.length){var e=!1,t=h.treeListOptions.dataSource.options.data;if(e=t.some(function(e){return e&&"--"!==e.licenseKey}))for(var i=0;i<h.treeListWidget.columns.length;i++)v===h.treeListWidget.columns[i].field&&h.treeListWidget.autoFitColumn(i)}}function u(){h.licenseData&&(h.treeListOptions.dataSource=new kendo.data.TreeListDataSource({data:n.createLicenseTreeListItems(h.licenseData),schema:f}),h.treeListOptions.dataSource.read())}var p="name",v="licenseKey",m="product",g="capacity",h=this,f={model:{id:"id",expanded:!1}},S=!1;h.ValidationMessageType=r.ValidationMessageType,h.licenseValidationMessages=[],h.validationPanelTitle=i.getString("LicenseLibUi","assignLicense.validationTitle"),h.i18nService=i,h.treeListWidget=null,h.treeListColumns=[{title:i.getString("LicenseLibUi","list.licenses.column.name"),field:p,template:c("name","icon")},{title:i.getString("LicenseLibUi","list.licenses.column.serialKey"),field:v},{title:i.getString("LicenseLibUi","list.licenses.column.product"),field:m},{title:i.getString("LicenseLibUi","list.licenses.column.usage"),field:"",template:function(e){var t=e.usage.current.label,i="";e.usage.current.tooltip&&(i=e.usage.current.tooltip);var r=$("<div></div>").text(t).attr("title",i);return e.usage.current.indicateUsageChange&&r.addClass("changed-usage-highlight"),r[0].outerHTML}},{title:i.getString("LicenseLibUi","list.licenses.column.limit"),field:g,sortable:{compare:function(e,t){var i=parseInt(e.capacity.split(" ")[0]),r=parseInt(t.capacity.split(" ")[0]);return i-r}}}],h.handleTreeListChange=function(){var e=null;if(1===h.treeListWidget.select().length){var t=h.treeListWidget.dataItem(h.treeListWidget.select());e=t._license}else e=null;_.isEqual(h.selectedLicenseItem,e)||(h.selectedLicenseItem=e,h.onItemChange({item:e})),h.licenseValidationMessages=o.getValidationMessages(e,h.licenseData,h.isAddHostState),e?h.validationPanelTitle=i.getString("LicenseLibUi","assignLicense.validationTitle.license",e.name):h.validationPanelTitle=i.getString("LicenseLibUi","assignLicense.validationTitle"),_.each(h.treeListOptions.dataSource.data(),function(t){t._license.uri===r.getLicenseUri(e)?t.usage.current=t.usage.selected:t.usage.current=t.usage.deselected}),h.treeListWidget.refresh()},h.handleTreeListDataBound=function(){if(h.treeListWidget&&h.licenseData&&!S){d(),S=!0;var t=r.getLicenseUri(r.getPreSelectedLicense(h.licenseData,h.selectedLicenseItem));e.$evalAsync(function(){var e=_.filter(h.treeListOptions.dataSource.rootNodes(),function(e){var i=r.getLicenseUri(e._license);return t===i});if(1===e.length){var i=h.treeListWidget.itemFor(e[0]);h.treeListWidget.select(i),l()}else h.treeListWidget.select($([]))})}},h.showValidationMessageDetailsDialog=function(t){var r=e.$new(!0);r.dialogOptions={title:i.getString("LicenseLibUi","assignLicense.validationMessageDetails.dialog.title"),contentUrl:"license-lib-ui/resources/license/components/licenseSelector/licenceValidationMessageDetailsContent.html",show:!0,rejectOptions:{visible:!1},confirmOptions:{label:i.getString("LicenseLibUi","assignLicense.validationMessageDetails.dialog.okButtonLabel")},height:"auto",width:"450px"},r.contentModel={validationMessage:t};var n={scope:r,configObjectName:"dialogOptions"};s(n)},h.treeListOptions={columns:h.treeListColumns,sortable:!0,resizable:!0,selectable:!0,change:_.partial(t.safeApply,e,h.handleTreeListChange),dataBound:_.partial(t.safeApply,e,h.handleTreeListDataBound)},h.$onChanges=function(e){e.hasOwnProperty("licenseData")&&e.licenseData.previousValue!==e.licenseData.currentValue&&(h.licenseData=e.licenseData.currentValue,u())}}angular.module("com.vmware.vsphere.client.licenseLibUi").component("licenseSelector",{templateUrl:"license-lib-ui/resources/license/components/licenseSelector/licenseSelector.html",controller:e,bindings:{licenseData:"<?",selectedLicenseItem:"=?",onItemChange:"&",isAddHostState:"=?"}}),e.$inject=["$scope","vuiUtils","i18nService","licenseCommonUtil","licenseTreeListUtil","licenseValidationUtil","columnRenderersRegistry","vuiDialogService"]}(),angular.module("com.vmware.vsphere.client.licenseLibUi").constant("licenseConstants",{LICENSE_TYPE:"License",EVALUATION_LICENSE_ID:"EVALUATION_LICENSE_ID",LICENSE_EXPIRATION_MAX_WARNING_DAYS_REMAINING:60,LicenseAssignRestriction:{ExpiredLicense:"ExpiredLicense",EmbeddedOemLicense:"EmbeddedOemLicense"},LimitEnforcementType:{NOT_ENFORCED:"NOT_ENFORCED",SOFT_ENFORCED:"SOFT_ENFORCED",HARD_ENFORCED:"HARD_ENFORCED"},RESPONSE_FAULT:{LICENSING_METHOD_FAULT:"com.vmware.license.client.cis.util.LicensingMethodFault"}});var license_lib_ui;!function(e){var t=function(){function e(e,t,i,r,n){this.mutationService=e,this.licenseCommonUtil=t,this.i18nService=i,this.clarityModalService=r,this.defaultUriSchemeUtil=n,this.ASSET_TYPE="Asset"}return e.prototype.retrieveLicenses=function(e){var t=this;return this.mutationService.validateOnMultiEntity(e,"com.vmware.license.client.cis.management.ds.specs.AssetAssignLicenseValidateSpec",{}).then(function(e){if(_.isEmpty(e))return null;if(e[0].error)throw e[0].error;var i=e[0].result;return t.licenseCommonUtil.normalizeValidationResult(i),i})},e.prototype.assignLicense=function(e,t){return this.mutationService.applyOnMultiEntity(e,"com.vmware.license.client.cis.management.ds.specs.AssetAssignLicenseSpec",{licenseRef:t,_type:"com.vmware.license.client.cis.management.ds.specs.AssetAssignLicenseSpec"
},this.i18nService.getString("LicenseLibUi","action.assignLicense.operationName"))},e.prototype.assignNewLicense=function(e,t,i){return this.mutationService.applyOnMultiEntity(e,"com.vmware.license.client.cis.management.ds.specs.LicenseCreateSpec",{name:i,serialKeys:t,_type:"com.vmware.license.client.cis.management.ds.specs.LicenseCreateSpec"})},e.prototype.showAssignLicenseForm=function(e){var t={title:this.getTitle(e),contentTemplate:"license-lib-ui/resources/license/views/assignLicense/assignLicenseForm.html",size:"xl",defaultButton:"submit",modalClass:"assign-license-modal",dialogData:{availableTargets:e}};1===e.length&&this.defaultUriSchemeUtil.getEntityType(e[0])!==this.ASSET_TYPE&&(t.subTitle={objectId:e[0]}),this.clarityModalService.openOkCancelModal(t)},e.prototype.getTitle=function(e){var t=this.i18nService.getString("LicenseLibUi","assignLicense.title");return e&&e.length>1&&(t+=" - "+this.i18nService.getString("LicenseLibUi","dialogTitle.multipleObjectsPrefix",e.length)),t},e.$inject=["mutationService","licenseCommonUtil","i18nService","clarityModalService","defaultUriSchemeUtil"],e}();e.AssignLicenseService=t,angular.module("com.vmware.vsphere.client.licenseLibUi").service("assignLicenseService",t)}(license_lib_ui||(license_lib_ui={})),function(){"use strict";function e(e,t){function i(e,t,i,r){var n=null;r&&(n=r.licenseRefToLicenseUsages);var o=null;e&&n&&n[e]&&(o=n[e]);var a=null;t&&o&&o.productRefToProductUsages&&o.productRefToProductUsages[t]&&(a=o.productRefToProductUsages[t]);var s=null;return i&&a&&a.costUnitIdToCostUnitUsage&&a.costUnitIdToCostUnitUsage[i]&&(s=a.costUnitIdToCostUnitUsage[i]),s}function r(e,t,i){var r={unsupportedFeaturesInUse:[],unsupportedAvailableFeatures:[]};if(!i)return r;if(!i.licenseRefToUnsupportedFeatures)return r;var n=i.licenseRefToUnsupportedFeatures[e];if(!n)return r;var o={};_.isEmpty(n.assetRefToUnsupportedFeaturesInUse)||(o=n.assetRefToUnsupportedFeaturesInUse);var a={};return _.isEmpty(n.assetRefToUnsupportedAvailableFeatures)||(a=n.assetRefToUnsupportedAvailableFeatures),_.isEmpty(o[t])||(r.unsupportedFeaturesInUse=o[t]),_.isEmpty(a[t])||(r.unsupportedAvailableFeatures=a[t]),r}function n(e){return 0===e.limit}function o(e){return!!e.embeddedOem}function a(e){return!!e.isEvaluation}function s(e,t){return S(e,t)===Number.POSITIVE_INFINITY}function c(e,t){return S(e,t)<=0}function l(t,i){return S(t,i)<=e.LICENSE_EXPIRATION_MAX_WARNING_DAYS_REMAINING}function d(t,i){var r=f(t,i);return _.contains(r.assignRestrictions,e.LicenseAssignRestriction.EmbeddedOemLicense)}function u(e,t){return null!==t.licenseFromAnotherVcRef&&t.licenseFromAnotherVcRef===e.uri}function p(e){return e?_.map(e.licensesAssignInfos,function(e){return e.license}):[]}function v(e,t){var i=p(e);if(t=_.find(i,function(e){return e.uri===h(t)}))return t;if(e&&e.assets&&e.assets.length>1&&h(e.assets[0].license)!==h(e.assets[1].license))return null;var r=_.find(i,function(t){return t.uri===h(e.assets[0].license)});return r?r:i.length>0?i[0]:null}function m(e){var t=e.assets[0],i=p(e),r=_.filter(i,function(e){return a(e)}),n=null;1===r.length&&(n=r[0]),t.evaluationLicense&&!h(t.evaluationLicense)&&(h(n)?t.evaluationLicense.uri=n.uri:t.evaluationLicense.uri=g()),!h(t.license)&&a(t.license)&&(h(n)?t.license.uri=n.uri:t.license.uri=g())}function g(){return t.createUri(e.LICENSE_TYPE,e.EVALUATION_LICENSE_ID)}function h(e){return e?e.uri:null}function f(e,t){return _.find(t.licensesAssignInfos,function(t){return t.license.uri===e.uri})}function S(t,i){var r=f(t,i);if(_.contains(r.assignRestrictions,e.LicenseAssignRestriction.ExpiredLicense))return 0;var n=t.expirationTime,o=t.expirationDate;if(null===o){if(null===n)return Number.POSITIVE_INFINITY;if(0===n)return 0;throw new Error("Can't calculate remaining days")}var a=moment(),s=moment(o);if(s.diff(a,"milliseconds")<=0)return 0;var c=Math.round(s.diff(a,"days",!0));return 0===c&&(c=1),c}function y(e,t){this.product=e,this.costUnits=t}function P(e,t,i,r){this.id=e,this.type=t,this.message=i,this.details=r}function C(e){this.type=e}function D(e){C.call(this,I.TEXT),this.text=e}function w(e,t){C.call(this,I.TEXT_AND_LIST),this.text=e,this.list=t}var b={TEXT:"TEXT",OK:"OK",INFO:"INFO",WARNING:"WARNING",ALERT:"ALERT"},I={TEXT:"TEXT",TEXT_AND_LIST:"TEXT_AND_LIST"};return D.prototype=_.create(C.prototype),D.prototype.constructor=D,w.prototype=_.create(C.prototype),w.prototype.constructor=w,{getAggregatedCostUnitUsage:i,isUnlimitedCapacityCostUnit:n,isEoemLicense:o,isEvaluationLicense:a,isPermanentLicense:s,isExpiredLicense:c,isExpiringLicense:l,isUnassignableEoemLicense:d,isLicenseFromAnotherVc:u,getAssignableLicenses:p,getPreSelectedLicense:v,normalizeValidationResult:m,getDefaultEvaluationLicenseUri:g,getLicenseUri:h,getLicenseExpirationRemainingDays:S,getAssetUnsupportedFeatures:r,UsageValidationItem:y,ValidationMessage:P,ValidationMessageDetailsBase:C,ValidationMessageTextDetails:D,ValidationMessageTextAndListDetails:w,ValidationMessageType:b,ValidationMessageDetailsType:I}}angular.module("com.vmware.vsphere.client.licenseLibUi").service("licenseCommonUtil",e),e.$inject=["licenseConstants","defaultUriSchemeUtil"]}(),function(){"use strict";function e(e,t){function i(e){for(var i=t.getAssignableLicenses(e),n=_.flatten(_.map(i,function(t){return angular.extend(r(t,e),{parentId:null})})),o=[];n.length>0;){var a=n.shift();a._children&&(_.each(a._children,function(e){e.parentId=a.id}),Array.prototype.push.apply(n,a._children),delete a._children),o.push(a)}return o}function r(e,i){var r=t.getLicenseUri(i.assets[0].license),o=e.uri===r?"vx-icon-licenseAssigned":"vx-icon-license",s=e.isEvaluation||_.isEmpty(e.serialKeys)?"--":e.serialKeys[0],c={id:e.uri,_license:e,name:e.name,icon:o,licenseKey:s},l=_.map(e.productRestrictions,function(t){return n(e,t.product,i)});if(_.isEmpty(l)){var d=a(e,null,null,i.aggregatedUsages);l=[{id:e.uri,_license:e,product:"--",capacity:"--",usage:d}]}return c=angular.extend(c,l.shift()),c._children||(c._children=[]),c._children=c._children.concat(l),c}function n(e,t,i){var r={id:e.uri+" _ "+t.uri,_license:e,product:t.formattedName},n=_.map(t.costUnits,function(r){return o(e,t,r,i)});if(_.isEmpty(n)){var s=a(e,t,null,i.aggregatedUsages);n=[{id:e.uri+" _ "+t.uri,_license:e,capacity:"--",usage:s}]}return r=angular.extend(r,n.shift()),r._children=n,r}function o(e,t,i,r){var n=a(e,t,i,r.aggregatedUsages),o={id:e.uri+" _ "+t.uri+" _ "+i.id,_license:e,capacity:i.valueFormat.replace(/%s/g,i.limit),usage:n};return o}function a(e,i,r,n){var o={value:NaN,label:"--",indicateUsageChange:!1,tooltip:null},a=e.uri,c=null,l=null;i&&(c=i.uri,r&&(l=r.id,o.value=r.usage,o.label=r.valueFormat.replace(/%s/g,r.usage)));var d=t.getAggregatedCostUnitUsage(a,c,l,n),u={current:angular.merge({},o),selected:s(o,d,!0),deselected:s(o,d,!1)};return u.current=u.deselected,u}function s(t,i,r){if(!i)return angular.merge({},t);var n=i.aggregationComplete,o=null;r?o=i.usageWithAggregatedAssetUsage:(o=i.usageWithoutAggregatedAssetUsage,n=!0);var a=i.costUnit.valueFormat,s=a.replace(/%s/g,o),c=!0,l=null,d=o-t.value,u=a.replace(/%s/g,d);return d<0?l=e.getString("LicenseLibUi","assignLicense.usageRemoved",t.label):0!==d||n?d>0?l=n?e.getString("LicenseLibUi","assignLicense.usageAdded",u,t.label):e.getString("LicenseLibUi","assignLicense.unavailableUsageDataForSomeAssets",u,t.label):c=!1:l=e.getString("LicenseLibUi","assignLicense.unavailableUsageDataForAllAssets",t.label),{value:o,label:s,indicateUsageChange:c,tooltip:l}}return{createLicenseTreeListItems:i}}angular.module("com.vmware.vsphere.client.licenseLibUi").service("licenseTreeListUtil",e),e.$inject=["i18nService","licenseCommonUtil"]}(),function(){"use strict";function e(e,t,i){function r(){return P("noLicenseSelectedMessage",I.ALERT,w("assignLicense.noLicenseSelected"))}function n(){return P("validationSuccessMessage",I.OK,w("assignLicense.validationSuccess"))}function o(){return C("licenseFromAnotherVcValidationMessage",I.WARNING,w("assignLicense.licenseFromAnotherVcSelected.short"),w("assignLicense.licenseFromAnotherVcSelected.long"))}function a(){return P("embeddedOemUnassignableValidationMessage",I.ALERT,w("assignLicense.unassignableEoemLicense"))}function s(){return P("embeddedOemUnassignableValidationMessage",I.ALERT,w("assignLicense.unassignableEoemLicense.addHost"))}function c(){return P("embeddedOemAssignValidationMessage",I.WARNING,w("assignLicense.embeddedOemLicenseAssign"))}function l(){return P("embeddedOemUnassignValidationMessage",I.WARNING,w("assignLicense.embeddedOemLicenseUnassign"))}function d(){return C("assetDlfVersionValidationMessage",I.WARNING,w("assignLicense.unsupportedDlfVersion.short"),w("assignLicense.unsupportedDlfVersion.long"))}function u(e,t){return S("featuresInUseValidationMessage",I.ALERT,w("assignLicense.unsupportedFeaturesInUse.short"),e,t,w("assignLicense.unsupportedFeaturesInUse.long"))}function p(e,t){return S("availableFeaturesValidationMessage",I.WARNING,w("assignLicense.unsupportedAvailableFeatures.short"),e,t,w("assignLicense.unsupportedAvailableFeatures.long"))}function v(e){return y("insufficientCapacityValidationMessage",I.ALERT,w("assignLicense.insufficientCapacity.short"),w("assignLicense.insufficientCapacity.long"),e)}function m(e){return y("unavailableUsageDataValidationMessage",I.WARNING,w("assignLicense.unavailableUsageData.short"),w("assignLicense.unavailableUsageData.long"),e)}function g(e){return y("unavailableUsageDataValidationMessage",I.WARNING,w("assignLicense.unknownCapacitySufficiency.short"),w("assignLicense.unknownCapacitySufficiency.long"),e)}function h(e){return P("licenseExpiringValidationMessage",I.WARNING,w("assignLicense.licenseExpiring",e))}function f(){return P("licenseExpiredValidationMessage",I.ALERT,w("assignLicense.licenseExpired"))}function S(e,t,i,r,n,o){var a=_.map(r,function(e){return e.formattedId}),s=w("assignLicense.unsupportedFeatures.delim"),c=a.join(s),l=[w("assignLicense.unsupportedFeatures.format",n,c)];return D(e,t,i,o,l)}function y(e,t,i,r,n){var o=_.map(n,function(e){var t=e.costUnits,i=_.map(t,function(e){return e.formattedId}),r=w("assignLicense.usageValidation.delim"),n=i.join(r);return w("assignLicense.usageValidation.format",e.product.formattedName,n)});return D(e,t,i,r,o)}function P(e,t,r,n){return r=i.trustAsHtml(r),new b(e,t,r,n)}function C(e,t,r,n){n=i.trustAsHtml(n);var o=new T(n);return P(e,t,r,o)}function D(e,t,r,n,o){n=i.trustAsHtml(n),o=_.map(o,function(e){return i.trustAsHtml(e)});var a=new E(n,o);return P(e,t,r,a)}var w=_.partial(e.getString,"LicenseLibUi"),b=t.ValidationMessage,I=t.ValidationMessageType,T=t.ValidationMessageTextDetails,E=t.ValidationMessageTextAndListDetails;return{buildNoLicenseSelectedValidationMessage:r,buildSuccessValidationMessage:n,buildLicenseFromAnotherVcValidationMessage:o,buildEmbeddedOemLicenseUnassignableValidationMessage:a,buildEmbeddedOemLicenseAssignValidationMessage:c,buildEmbeddedOemLicenseUnassignValidationMessage:l,buildAddHostEmbeddedOemLicenseUnassignableValidationMessage:s,buildAssetDlfVersionValidationMessage:d,buildFeaturesInUseValidationMessage:u,buildAvailableFeaturesValidationMessage:p,buildInsufficientCapacityValidationMessage:v,buildUnavailableUsageDataValidationMessage:m,buildUnknownCapacitySufficiencyValidationMessage:g,buildLicenseExpiringValidationMessage:h,buildLicenseExpiredValidationMessage:f}}angular.module("com.vmware.vsphere.client.licenseLibUi").service("licenseValidationMessageBuilder",e),e.$inject=["i18nService","licenseCommonUtil","$sce"]}(),function(){"use strict";function e(e,t,i,r,n,o,a){function s(e,t,i){e||(e=null);var r=[p(e),v(e,t),m(e,t,i),g(e,t,i),h(e,t),D(e,t)];return r=_.filter(r,function(e){return null!==e}),_.isEmpty(r)&&(r=[u()]),r}function c(e,t,i){e||(e=null);var r=[w(e),b(e,t),I(e,t,i),T(e,t,i),E(e,t)];return r=_.filter(r,function(e){return null!==e})}function l(e,t){e||(e=null);var i=[V(e,t),M(e,t)];return i=_.filter(i,function(e){return null!==e})}function d(e){var t=n.defer(),i=t.promise,s=o.$new();s.dialogOptions={title:r.getString("LicenseLibUi","assignLicense.warning.confirmationDialog.title"),contentUrl:"license-lib-ui/resources/license/components/licenseSelector/licenseWarningsConfirmationDialogContent.html",show:!0,rejectOptions:{label:r.getString("LicenseLibUi","assignLicense.warning.confirmationDialog.cancelButtonLabel"),onClick:function(){return t.reject(!1),!0}},confirmOptions:{label:r.getString("LicenseLibUi","assignLicense.warning.confirmationDialog.okButtonLabel"),onClick:function(){return t.resolve(!0),!0}},width:"600px",height:"auto"},s.contentModel={warnings:e};var c={scope:s,configObjectName:"dialogOptions"};return a(c),i}function u(){return e.buildSuccessValidationMessage()}function p(t){return null===t?e.buildNoLicenseSelectedValidationMessage():null}function v(i,r){return null===i?null:t.isLicenseFromAnotherVc(i,r)?e.buildLicenseFromAnotherVcValidationMessage():null}function m(i,r,n){if(null===i)return null;var o=r.assets[0].license;return t.getLicenseUri(i)===t.getLicenseUri(o)?null:t.isUnassignableEoemLicense(i,r)?n?e.buildAddHostEmbeddedOemLicenseUnassignableValidationMessage():e.buildEmbeddedOemLicenseUnassignableValidationMessage():o&&t.isEoemLicense(o)?e.buildEmbeddedOemLicenseUnassignValidationMessage():t.isEoemLicense(i)?e.buildEmbeddedOemLicenseAssignValidationMessage():null}function g(i,r,n){if(null===i)return null;if(n&&i.isEvaluation)return null;if(!r.isAssetDlfVersionSupported)return e.buildAssetDlfVersionValidationMessage();var o=r.assets[0],a=t.getAssetUnsupportedFeatures(i.uri,o.uri,r.unsupportedFeatures);return _.isEmpty(a.unsupportedFeaturesInUse)?_.isEmpty(a.unsupportedAvailableFeatures)?null:e.buildAvailableFeaturesValidationMessage(a.unsupportedAvailableFeatures,o.name):e.buildFeaturesInUseValidationMessage(a.unsupportedFeaturesInUse,o.name)}function h(t,i){if(null===t)return null;var r=f(t,i.aggregatedUsages);if(!_.isEmpty(r))return e.buildInsufficientCapacityValidationMessage(r);var n=y(t,i.aggregatedUsages);return _.isEmpty(n)?null:C(n)?e.buildUnavailableUsageDataValidationMessage(n):e.buildUnknownCapacitySufficiencyValidationMessage(n)}function f(e,t){return null===e?[]:_.filter(_.map(e.productRestrictions,function(i){var r=i.product,n=S(e,r,t);return _.isEmpty(n)?null:new O(r,n)}),function(e){return!_.isNull(e)})}function S(e,i,r){return null===e||null===i?[]:_.filter(i.costUnits,function(n){if(t.isUnlimitedCapacityCostUnit(n))return!1;var o=t.getAggregatedCostUnitUsage(e.uri,i.uri,n.id,r);if(null===o)return!1;var a=t.isEoemLicense(e)?o.maxAssetUsage:o.usageWithAggregatedAssetUsage;return a>n.limit})}function y(e,t){return null===e?[]:_.filter(_.map(e.productRestrictions,function(i){var r=i.product,n=P(e,r,t);return _.isEmpty(n)?null:new O(r,n)}),function(e){return!_.isNull(e)})}function P(e,i,r){return null===e||null===i?[]:_.filter(i.costUnits,function(n){var o=t.getAggregatedCostUnitUsage(e.uri,i.uri,n.id,r);return null!==o&&!o.aggregationComplete})}function C(e){return _.every(e,function(e){return _.every(e.costUnits,function(e){return t.isUnlimitedCapacityCostUnit(e)})})}function D(i,r){if(null===i)return null;if(t.isPermanentLicense(i,r))return null;if(t.isExpiredLicense(i,r))return e.buildLicenseExpiredValidationMessage();if(t.isExpiringLicense(i,r)){var n=t.getLicenseExpirationRemainingDays(i,r);return e.buildLicenseExpiringValidationMessage(n)}return null}function w(e){return null===e?r.getString("LicenseLibUi","assignLicense.blockingError.noLicenseSelected"):null}function b(e,i){return null===e?null:t.isPermanentLicense(e,i)?null:t.isExpiredLicense(e,i)?r.getString("LicenseLibUi","assignLicense.blockingError.licenseExpired"):null}function I(e,i,n){if(null===e)return null;var o=i.assets[0].license;return t.getLicenseUri(e)===t.getLicenseUri(o)?null:t.isUnassignableEoemLicense(e,i)?r.getString("LicenseLibUi","assignLicense.blockingError.unassignableEoemLicense"+(n?".addHost":"")):null}function T(e,i,n){if(null===e)return null;if(n&&e.isEvaluation)return null;var o=i.assets[0],a=t.getAssetUnsupportedFeatures(e.uri,o.uri,i.unsupportedFeatures);return _.isEmpty(a.unsupportedFeaturesInUse)?null:r.getString("LicenseLibUi","assignLicense.blockingError.unsupportedFeaturesInUse")}function E(e,t){var n=f(e,t.aggregatedUsages),o=_.some(n,function(e){return _.some(e.costUnits,function(e){return i.LimitEnforcementType.HARD_ENFORCED===e.limitEnforcementType})});return o?r.getString("LicenseLibUi","assignLicense.blockingError.insufficientCapacity"):null}function V(e,i){return null===e?null:t.isLicenseFromAnotherVc(e,i)?r.getString("LicenseLibUi","assignLicense.warning.licenseFromAnotherVc"):null}function M(e,t){if(null===e)return null;var i=f(e,t.aggregatedUsages);return _.isEmpty(i)?null:r.getString("LicenseLibUi","assignLicense.warning.insufficientCapacity")}var O=t.UsageValidationItem;return{getValidationMessages:s,getValidationBlockingErrors:c,getValidationWarnings:l,showLicenseWarningsConfirmationDialog:d}}angular.module("com.vmware.vsphere.client.licenseLibUi").service("licenseValidationUtil",e),e.$inject=["licenseValidationMessageBuilder","licenseCommonUtil","licenseConstants","i18nService","$q","$rootScope","vuiDialogService"]}();var license_lib_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s){this.$scope=e,this.assignLicenseService=t,this.clarityConstants=i,this.licenseConstants=r,this.licenseValidationUtil=n,this.defaultUriSchemeUtil=o,this.managedEntityConstants=a,this.i18nService=s,this.NEW_LICENSE_URI="urn:vri:License:NEW_LICENSE_ID",this.TABS=[{label:this.i18nService.getString("LicenseLibUi","assignLicense.tab.existingLicenses"),id:"existing-licenses-btn",value:"existing-licenses",submitButtonDisabled:!0},{label:this.i18nService.getString("LicenseLibUi","assignLicense.tab.newLicense"),id:"new-license-btn",value:"new-license",submitButtonDisabled:!0}]}return e.prototype.$onInit=function(){var e=this;this.selectedTab=this.TABS[0].value,this.$scope.modalOptions.onSubmit=function(){if(e.dataRetrievalError)return!0;if(!e.selectedLicense)return!1;var t=e.selectedLicense.uri===e.NEW_LICENSE_URI?[]:e.licenseValidationUtil.getValidationBlockingErrors(e.selectedLicense,e.licenseData,!1);if(!_.isEmpty(t))return e.setModalErrors(t),!1;var i=e.licenseValidationUtil.getValidationWarnings(e.selectedLicense,e.licenseData,!1);return _.isEmpty(i)?(e.performLicenseAssignment(),!0):e.licenseValidationUtil.showLicenseWarningsConfirmationDialog(i).then(function(t){return e.performLicenseAssignment(),!0},function(e){return!1})},this.loading=!0,this.assetRefs=this.$scope.modalOptions.dialogData.availableTargets,this.assignLicenseService.retrieveLicenses(this.assetRefs).then(function(t){e.licenseData=t,e.loading=!1})["catch"](function(t){e.isClusterNotRegistered(t)?e.dataRetrievalError=e.i18nService.getString("LicenseLibUi","assets.clusterNotRegistered"):e.dataRetrievalError=t.localizedMessage,e.loading=!1})},e.prototype.onTabChanged=function(){var e=this,t=this.TABS.filter(function(t){return t.value===e.selectedTab});this.toggleSubmitButtonState(t[0].submitButtonDisabled)},e.prototype.toggleSubmitButtonState=function(e){this.$scope.modalOptions.submitDisabled=e},e.prototype.existingLicensesTabSubmitButtonDisabled=function(e){this.TABS[0].submitButtonDisabled=e,this.selectedTab===this.TABS[0].value&&this.toggleSubmitButtonState(e)},e.prototype.newLicenseTabSubmitButtonDisabled=function(e){this.TABS[1].submitButtonDisabled=!e,this.selectedTab===this.TABS[1].value&&this.toggleSubmitButtonState(!e)},Object.defineProperty(e.prototype,"showNewLicenseView",{get:function(){return this.selectedTab===this.TABS[1].value},enumerable:!0,configurable:!0}),e.prototype.onLicenseItemChanged=function(e){this.selectedLicense=e},e.prototype.isClusterNotRegistered=function(e){return e._type===this.licenseConstants.RESPONSE_FAULT.LICENSING_METHOD_FAULT&&this.areAllAssetsClusterServerObjects()},e.prototype.areAllAssetsClusterServerObjects=function(){var e=this;if(!this.assetRefs)return!1;var t=_.every(this.assetRefs,function(t){var i=e.defaultUriSchemeUtil.getEntityType(t);return i===e.managedEntityConstants.CLUSTER});return t},e.prototype.setModalErrors=function(e){var t=this,i=_.map(e,function(e){return{text:e,type:t.clarityConstants.notifications.type.ERROR}});this.$scope.modalOptions.alerts=i},e.prototype.performLicenseAssignment=function(){var e=this.selectedLicense.uri,t=_.map(this.licenseData.assets,function(e){return e.uri});e===this.NEW_LICENSE_URI?this.assignLicenseService.assignNewLicense(t,this.selectedLicense.serialKeys,this.selectedLicense.name):this.assignLicenseService.assignLicense(t,e)},e.$inject=["$scope","assignLicenseService","clarityConstants","licenseConstants","licenseValidationUtil","defaultUriSchemeUtil","managedEntityConstants","i18nService"],e}();e.AssignLicenseFormController=t,angular.module("com.vmware.vsphere.client.licenseLibUi").controller("AssignLicenseFormController",t)}(license_lib_ui||(license_lib_ui={})),h5=h5||{},h5.license={angularModule:angular.module("com.vmware.vsphere.client.licenseUi",["com.vmware.platform.ui","com.vmware.vsphere.client.commonModule","com.vmware.vsphere.client.licenseLibUi"])},angular.module("com.vmware.vsphere.client.licenseUi").run(["serialKeyLicenseActionsService",function(e){h5.actions["vsphere.core.administration.removeLicensesAction"]=function(t,i,r){i&&e.removeLicenseKey(i)},h5.actions["vsphere.core.administration.renameLicenseAction"]=function(t,i,r){i&&r&&e.renameSerialKeyLicense(r)},h5.actions["vsphere.core.administration.addLicenseAction"]=function(t,i,r){r&&e.addSerialKeyLicense(r)},h5.actions["vsphere.core.administration.syncFromPortalAction"]=function(t,i,r){r&&e.syncSerialKeyLicenses(r)}}]).run(["assetActionsService","assignLicenseService",function(e,t){h5.actions["vsphere.core.administration.removeSolutionsAction"]=function(t,i,r){i&&e.removeSolution(i)},h5.actions["vsphere.core.administration.assignLicenseKeyAction"]=function(e,i,r){i&&t.showAssignLicenseForm(i)}}]);var license_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcAssetActionsService",{get:function(){return this._vcAssetActionsService||(this._vcAssetActionsService=this.$injector.get("vcAssetActionsService")),this._vcAssetActionsService},enumerable:!0,configurable:!0}),e.prototype.removeSolution=function(e){this.vcAssetActionsService.removeSolution(e)},e.$inject=["$injector"],e}();e.AssetActionsService=t,angular.module("com.vmware.vsphere.client.licenseUi").service("assetActionsService",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e){this.$injector=e}return Object.defineProperty(e.prototype,"vcSerialKeyLicenseActionsService",{get:function(){return this._vcSerialKeyLicenseActionsService||(this._vcSerialKeyLicenseActionsService=this.$injector.get("vcSerialKeyLicenseActionsService")),this._vcSerialKeyLicenseActionsService},enumerable:!0,configurable:!0}),e.prototype.removeLicenseKey=function(e){this.vcSerialKeyLicenseActionsService.removeLicenseKey(e)},e.prototype.renameSerialKeyLicense=function(e){this.vcSerialKeyLicenseActionsService.renameSerialKeyLicense(e)},e.prototype.addSerialKeyLicense=function(e){this.vcSerialKeyLicenseActionsService.addSerialKeyLicense(e)},e.prototype.syncSerialKeyLicenses=function(e){this.vcSerialKeyLicenseActionsService.syncSerialKeyLicenses(e)},e.$inject=["$injector"],e}();e.SerialKeyLicenseActionsService=t,angular.module("com.vmware.vsphere.client.licenseUi").service("serialKeyLicenseActionsService",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(){this.ADMINISTRATION_LICENSES_VIEWS_EXTENSION_ID="vsphere.core.administration.licensesView",this.LICENSES_ADMINISTRATION_VIEW_TAB_ID="license.management.licensesList",this.PRODUCTS_ADMINISTRATION_VIEW_TAB_ID="license.management.productsList",this.ASSETS_ADMINISTRATION_VIEW_TAB_ID="license.management.assetsList",this.LICENSES_MANAGEMENT_NAVIGATION_REQUEST_EVENT="licensingManagementNavigationRequest",this.LICENSES_MANAGEMENT_NAVIGATION_PERFORMED_EVENT="licensingManagementNavigationPerformed",this.ASSETS_MANAGEMENT_NAVIGATION_PERFORMED_EVENT="assetsManagementNavigationRequest",this.LICENSES_MANAGEMENT_SELECTED_TAB_CHANGED_EVENT="licensingManagementSelectedTabChanged"}return e}();e.LicensesManagementConstants=t,angular.module("com.vmware.vsphere.client.licenseUi").constant("licensesManagementConstants",new t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t){this.navigation=e,this.licensesManagementConstants=t,this.TAB_IDS_DELIMITER=","}return e.prototype.navigateByProvidedLicensingRouteObject=function(e){if(e){var t={};e.tabPaths&&e.tabPaths.length&&(t.tabPaths=e.tabPaths.join(this.TAB_IDS_DELIMITER)),e.itemId&&(t.itemId=e.itemId),angular.extend(t,this.extractAdditionalParametersFromRoute()),this.navigation.navigate(e.extensionId,null,t)}},e.prototype.navigateToLicensesManagementTabByTabId=function(e){var t=this.navigation.getRouteFromUrl();if(t&&t.extensionId===this.licensesManagementConstants.ADMINISTRATION_LICENSES_VIEWS_EXTENSION_ID)if(t.tabPaths&&t.tabPaths.length){var i=t.tabPaths.split(this.TAB_IDS_DELIMITER);if(i[0]===e)return}else if(!e||!e.length)return;var r=e?[e]:[],n={extensionId:this.licensesManagementConstants.ADMINISTRATION_LICENSES_VIEWS_EXTENSION_ID,tabPaths:r};this.navigateByProvidedLicensingRouteObject(n)},e.prototype.extractLicensingRouteObjectFromUrl=function(e){var t=this.navigation.getRouteFromUrl();if(!t||!t.extensionId)return null;var i={extensionId:t.extensionId,tabPaths:[]};if(t.tabPaths&&t.tabPaths.length&&(i.tabPaths=t.tabPaths.split(this.TAB_IDS_DELIMITER),e)){var r=isNaN(e)?0:e;i.tabPaths.splice(0,r)}return t.itemId&&(i.itemId=t.itemId),i},e.prototype.canNavigationRequestInLicensingRouteBeHandled=function(e,t){if(!t||!t.tabPaths||!e)return!1;if(e.length>t.tabPaths.length)return!1;if(0===e.length&&t.tabPaths.length>0)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t.tabPaths[i])return!1;return!0},e.prototype.createLicensingRouteObjectForSubTabs=function(e,t){if(!(e&&e.length&&t&&t.tabPaths&&t.tabPaths.length))return null;if(e.length>t.tabPaths.length)return null;for(var i=[],r=0;r<t.tabPaths.length;r++){if(r<e.length&&t.tabPaths[r]!==e[r])return null;r>=e.length&&i.push(t.tabPaths[r])}return{extensionId:t.extensionId,tabPaths:i,itemId:t.itemId}},e.prototype.emitLicensesManagementNavigationRequestOnScope=function(e,t){t&&e.$emit(this.licensesManagementConstants.LICENSES_MANAGEMENT_NAVIGATION_REQUEST_EVENT,t)},e.prototype.emitAssetsManagementNavigationPerformedOnScope=function(e,t){t&&e.$emit(this.licensesManagementConstants.ASSETS_MANAGEMENT_NAVIGATION_PERFORMED_EVENT,t)},e.prototype.registerNavigationPerformedEventListener=function(e,t){e.$on(this.licensesManagementConstants.LICENSES_MANAGEMENT_NAVIGATION_PERFORMED_EVENT,function(e,i){t(i)})},e.prototype.registerAssetsNavigationPerformedEventListener=function(e,t){e.$on(this.licensesManagementConstants.ASSETS_MANAGEMENT_NAVIGATION_PERFORMED_EVENT,function(e,i){t(i)})},e.prototype.extractAdditionalParametersFromRoute=function(){var e={},t=this.navigation.getRouteFromUrl(),i=["itemId","tabPaths"],r=t.getAdditionalParams();for(var n in r)i.indexOf(n)!==-1||angular.isFunction(r[n])||(e[n]=r[n]);return e},e.prototype.appendAdditionalParametersToRoutingInfo=function(e){var t=this.navigation.getRouteFromUrl(),i=["itemId","tabPaths"],r=t.getAdditionalParams();for(var n in r)i.indexOf(n)!==-1||angular.isFunction(r[n]&&e[n])||(e[n]=r[n])},e.$inject=["navigation","licensesManagementConstants"],e}();e.LicensesManagementNavigationService=t,angular.module("com.vmware.vsphere.client.licenseUi").service("licensesManagementNavigationService",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e){this.licensesManagementConstants=e}return e.prototype.createProductsListLicensingRouteObject=function(e){return{extensionId:this.licensesManagementConstants.ADMINISTRATION_LICENSES_VIEWS_EXTENSION_ID,tabPaths:[this.licensesManagementConstants.PRODUCTS_ADMINISTRATION_VIEW_TAB_ID],itemId:e}},e.prototype.createLicensesListLicensingRouteObject=function(e){return{extensionId:this.licensesManagementConstants.ADMINISTRATION_LICENSES_VIEWS_EXTENSION_ID,tabPaths:[],itemId:e}},e.prototype.createAssetsListLicensingRouteObject=function(e,t){var i={extensionId:this.licensesManagementConstants.ADMINISTRATION_LICENSES_VIEWS_EXTENSION_ID,tabPaths:[this.licensesManagementConstants.ASSETS_ADMINISTRATION_VIEW_TAB_ID],itemId:t};return e&&e.length&&i.tabPaths.push(e),i},e.$inject=["licensesManagementConstants"],e}();e.LicensingRouteObjectsFactoryService=t,angular.module("com.vmware.vsphere.client.licenseUi").service("licensingRouteObjectsFactoryService",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.licensingRouteObjectsFactoryService=t,this.licensesManagementNavigationService=i,this.licensesManagementConstants=r}return e.prototype.$onInit=function(){var e=this;this.scopeProvider=this.$scope.scopeProvider,this.tabPaths=this.$scope.tabPaths,this.licensesManagementNavigationService.registerNavigationPerformedEventListener(this.$scope,function(t){e.handleNavigationRequest(t)}),this.registerSelectedTabChangedEventListener(),this.tryProcessNavigationRouteInfoInUrl()},e.prototype.onSelectedAssetTabIdChanged=function(e){e&&this.selectedAssetTabId!==e&&(this.selectedAssetTabId=e,this.focusedAssetItemUri=void 0,this.triggerNavigationRequestToSelectedAssetTab())},e.prototype.triggerNavigationRequestToSelectedAssetTab=function(){var e=this.licensingRouteObjectsFactoryService.createAssetsListLicensingRouteObject(this.selectedAssetTabId,this.focusedAssetItemUri);this.licensesManagementNavigationService.emitLicensesManagementNavigationRequestOnScope(this.$scope,e)},e.prototype.handleNavigationRequest=function(e){if(e&&this.licensesManagementNavigationService.canNavigationRequestInLicensingRouteBeHandled(this.tabPaths,e)){var t=this.licensesManagementNavigationService.createLicensingRouteObjectForSubTabs(this.tabPaths,e);t&&t.tabPaths.length>0&&(this.selectedAssetTabId===t.tabPaths[0]&&this.broadcastEventForAssetsManagementNavigationPerformed(t),this.selectedAssetTabId=t.tabPaths[0],this.focusedAssetItemUri=t.itemId)}},e.prototype.registerSelectedTabChangedEventListener=function(){var e=this;this.$scope.$on(this.licensesManagementConstants.LICENSES_MANAGEMENT_SELECTED_TAB_CHANGED_EVENT,function(t,i){e.selectedTab=i.selectedTab;var r=i.isDefault&&e.isCurrentTabDefaultTab();e.selectedAssetTabId&&(r||e.isCurrentTabSelected())&&e.triggerNavigationRequestToSelectedAssetTab()})},e.prototype.broadcastEventForLicensesManagementNavigationPerformed=function(e){this.$scope.$broadcast(this.licensesManagementConstants.LICENSES_MANAGEMENT_NAVIGATION_PERFORMED_EVENT,e)},e.prototype.broadcastEventForAssetsManagementNavigationPerformed=function(e){this.$scope.$broadcast(this.licensesManagementConstants.ASSETS_MANAGEMENT_NAVIGATION_PERFORMED_EVENT,e)},e.prototype.tryProcessNavigationRouteInfoInUrl=function(){var e=this.licensesManagementNavigationService.extractLicensingRouteObjectFromUrl();this.handleNavigationRequest(e)},e.prototype.isCurrentTabDefaultTab=function(){return!(this.tabPaths&&this.tabPaths.length)},e.prototype.isCurrentTabSelected=function(){return!!(this.tabPaths&&this.tabPaths.length>0&&this.selectedTab&&this.selectedTab.id===this.tabPaths[this.tabPaths.length-1])},e.$inject=["$scope","licensingRouteObjectsFactoryService","licensesManagementNavigationService","licensesManagementConstants"],e}();e.AssetsAdministrationViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("AssetsAdministrationViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.licensesManagementNavigationService=t,this.licensingRouteObjectsFactoryService=i,this.commonActionBarService=r,this.ACTION_BAR_ACTIONS="actions",
this.ASSIGN_LICENSE_KEY_ACTION_ID="vsphere.core.administration.assignLicenseKeyAction",this.REMOVE_SOLUTION_ACTION_ID="vsphere.core.administration.removeSolutionsAction",this.ASSET_TYPE_SOLUTION="SOLUTION",this.selectedAssets=[],this.selectedAssetsUris=[]}return e.prototype.$onInit=function(){var e=this;this.actionBarOptions={actions:[]},this.licensesManagementNavigationService.registerAssetsNavigationPerformedEventListener(this.$scope,function(t){e.handleNavigationRequest(t)}),this.focusedAssetUri=this.$scope.masterDetailsViewContext.getFocusedAssetItemUri(),this.focusedAssetUri&&this.triggerNavigationRequestToFocusedAssetItem(),this.updateActionBar()},e.prototype.onSelectedAssetsChanged=function(e){e&&e.length>0?this.selectedAssets=e:this.selectedAssets=[],this.selectedAssetsUris=this.extractAssetsUris(this.selectedAssets),this.updateActionBar()},e.prototype.onFocusedAssetChanged=function(e){this.focusedAsset!==e&&(this.focusedAsset=e,this.$scope.masterDetailsViewContext.selectedItems=[e]),this.focusedAssetUri=this.focusedAsset&&this.focusedAsset.uri,this.triggerNavigationRequestToFocusedAssetItem()},e.prototype.triggerNavigationRequestToFocusedAssetItem=function(){var e=this.$scope.masterDetailsViewContext.getSelectedAssetTabId(),t=this.licensingRouteObjectsFactoryService.createAssetsListLicensingRouteObject(e,this.focusedAssetUri);this.licensesManagementNavigationService.emitLicensesManagementNavigationRequestOnScope(this.$scope,t)},e.prototype.updateActionBar=function(){var e=this,t=[];this.actionBarOptions&&this.actionBarOptions.actions&&this.actionBarOptions.actions.length&&this.actionBarOptions.actions.forEach(function(e){e.actionId&&(e.enabled=!1)}),this.commonActionBarService.updateActionBar(t,this.ACTION_BAR_ACTIONS,this.selectedAssetsUris,this.getActions()).then(function(){e.actionBarOptions=t})},e.prototype.getActions=function(){var e=this,t=[];return t.push({actionId:this.ASSIGN_LICENSE_KEY_ACTION_ID,getActionInvocationContext:function(){return e.selectedAssetsUris},isActionVisible:function(t){return!!(e.selectedAssetsUris&&e.selectedAssetsUris.length>0&&t)}}),this.$scope.masterDetailsViewContext.assetType===this.ASSET_TYPE_SOLUTION&&t.push({actionId:this.REMOVE_SOLUTION_ACTION_ID,isActionVisible:function(t){return!!(e.selectedAssetsUris&&e.selectedAssetsUris.length>0&&t)}}),t},e.prototype.handleNavigationRequest=function(e){e&&this.licensesManagementNavigationService.canNavigationRequestInLicensingRouteBeHandled([this.$scope.masterDetailsViewContext.getSelectedAssetTabId()],e)&&e.itemId&&(this.focusedAssetUri=e.itemId)},e.prototype.extractAssetsUris=function(e){var t=[];return e&&e.length>0&&(t=e.map(function(e){return e&&e.uri})),t},e.$inject=["$scope","licensesManagementNavigationService","licensingRouteObjectsFactoryService","commonActionBarService"],e}();e.AssetsGridViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("AssetsGridViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.i18nService=t,this.$q=i}return e.prototype.$onInit=function(){var e=this;this.masterDetailsViewContext={assetType:this.assetType,getSelectedTab:function(){return e.selectedTab},scopeProvider:this.scopeProvider,getSelectedAssetTabId:function(){return e.selectedAssetTabId},getFocusedAssetItemUri:function(){return e.focusedAssetItemUri}},this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("LicenseLibUi","management.products.details.summary"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/assetsDetailsSummaryTabView.html",uid:"assets.summaryTab"},{name:this.i18nService.getString("LicenseLibUi","management.assets.details.featuresTab"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/assetsDetailsFeaturesTabView.html",uid:"assets.featuresTab"}])}},e.$inject=["$scope","i18nService","$q"],e}();e.AssetsMasterDetailsViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").component("assetsMasterDetailsViewWrapper",{controller:t,template:'<div class="fill-parent">\n                              <vx-master-details-component\n                                    master-view-template-url="license-ui/resources/license/views/management/licenses/assets/assetsGridView.html"\n                                    details-view-template-url="resources/ui/components/masterdetails/vxTabbedDetailsView.html"\n                                    details-view-data="$ctrl.detailsViewData"\n                                    master-details-view-context="$ctrl.masterDetailsViewContext"\n                                    is-resizable="true">\n                              </vx-master-details-component>\n                           </div>',bindings:{assetType:"<",selectedTab:"<",scopeProvider:"<",focusedAssetItemUri:"<"}})}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i,r,n,o){this.$scope=e,this.vcLicensingPrivilegesService=t,this.licensesManagementNavigationService=i,this.licensingRouteObjectsFactoryService=r,this.i18n=n,this.licensesManagementConstants=o,this.scopeProvider="licensing_service_version1",this.PORTAL_URL="https://my.vmware.com/",this.tabs=[],this.tabViewParams={},this.loading=!1,this.isGlobalLicensePrivilegeGranted=!1}return e.prototype.$onInit=function(){var e=this;this.tabViewParams={scopeProvider:this.scopeProvider},this.loading=!0,this.vcLicensingPrivilegesService.checkIfGlobalLicensePrivilegeIsGranted(this.scopeProvider).then(function(t){e.isGlobalLicensePrivilegeGranted=t,e.isGlobalLicensePrivilegeGranted&&(e.initializeTabs(),e.registerListenerForLicensesManagementNavigationRequest(),e.attachWatchOnSelectedTab(),e.tryHandleAdditionalNavigationalInformationInUrl(),e.$scope.$on("vxRouteChangeSuccess",function(){e.tryHandleAdditionalNavigationalInformationInUrl()}))})["finally"](function(){e.loading=!1})},e.prototype.initializeTabs=function(){this.tabs=[{name:this.i18n.getString("LicenseLibUi","management.name"),templateUrl:"license-ui/resources/license/views/management/licenses/serial-key-licenses/licensesAdministrationView.html",id:this.licensesManagementConstants.LICENSES_ADMINISTRATION_VIEW_TAB_ID,tabParams:this.createTabParamWithTabId()},{name:this.i18n.getString("LicenseLibUi","management.navigation.products"),templateUrl:"license-ui/resources/license/views/management/licenses/products/productsAdministrationView.html",id:this.licensesManagementConstants.PRODUCTS_ADMINISTRATION_VIEW_TAB_ID,tabParams:this.createTabParamWithTabId(this.licensesManagementConstants.PRODUCTS_ADMINISTRATION_VIEW_TAB_ID)},{name:this.i18n.getString("LicenseLibUi","management.navigation.assets"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/assetsAdministrationView.html",id:this.licensesManagementConstants.ASSETS_ADMINISTRATION_VIEW_TAB_ID,tabParams:this.createTabParamWithTabId(this.licensesManagementConstants.ASSETS_ADMINISTRATION_VIEW_TAB_ID)}],this.selectedTab=this.tabs[0]},e.prototype.tryHandleAdditionalNavigationalInformationInUrl=function(){var e=this.licensesManagementNavigationService.extractLicensingRouteObjectFromUrl();this.handleNavigationRequest(e)},e.prototype.registerListenerForLicensesManagementNavigationRequest=function(){var e=this;this.$scope.$on(this.licensesManagementConstants.LICENSES_MANAGEMENT_NAVIGATION_REQUEST_EVENT,function(t,i){t.stopPropagation(),e.handleNavigationRequest(i)})},e.prototype.handleNavigationRequest=function(e){e&&(e.tabPaths&&e.tabPaths.length?(this.selectedTab=this.findTabById(e.tabPaths[0]),this.licensingRouteObject=e,this.licensesManagementNavigationService.navigateByProvidedLicensingRouteObject(e),this.broadcastEventForLicensesManagementNavigationPerformed(e)):(this.selectedTab=this.tabs[0],this.navigateToDefaultLicensingTab(e.itemId),this.broadcastEventForLicensesManagementNavigationPerformed(e)))},e.prototype.navigateToDefaultLicensingTab=function(e){var t=this.licensingRouteObjectsFactoryService.createLicensesListLicensingRouteObject(e);this.licensesManagementNavigationService.navigateByProvidedLicensingRouteObject(t)},e.prototype.broadcastEventForLicensesManagementNavigationPerformed=function(e){this.$scope.$broadcast(this.licensesManagementConstants.LICENSES_MANAGEMENT_NAVIGATION_PERFORMED_EVENT,e)},e.prototype.broadcastEventForLicensesManagementSelectedTabChanged=function(e,t){void 0===t&&(t=!1);var i={selectedTab:e,isDefault:t};this.$scope.$broadcast(this.licensesManagementConstants.LICENSES_MANAGEMENT_SELECTED_TAB_CHANGED_EVENT,i)},e.prototype.attachWatchOnSelectedTab=function(){var e=this;this.$scope.$watch(function(){return e.selectedTab},function(t){if(t&&t.id){if(t.id===e.tabs[0].id)return e.licensesManagementNavigationService.navigateToLicensesManagementTabByTabId(),void e.broadcastEventForLicensesManagementSelectedTabChanged(t,!0);e.licensesManagementNavigationService.navigateToLicensesManagementTabByTabId(t.id),e.broadcastEventForLicensesManagementSelectedTabChanged(t)}})},e.prototype.findTabById=function(e){if(e)return this.tabs.find(function(t){return e===t.id})},e.prototype.createTabParamWithTabId=function(e){var t=e?[e]:[];return{tabPaths:t}},e.$inject=["$scope","vcLicensingPrivilegesService","licensesManagementNavigationService","licensingRouteObjectsFactoryService","i18nService","licensesManagementConstants"],e}();e.LicensesTabbedViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("LicensesTabbedViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.licensesManagementNavigationService=t,this.licensingRouteObjectsFactoryService=i}return e.prototype.onFocusedLicenseChanged=function(e){this.triggerNavigationRequestToSelectedLicenseItem()},e.prototype.triggerNavigationRequestToSelectedLicenseItem=function(){var e=this.$scope.masterDetailsViewContext.selectedItem.licenses;if(e&&e.length>0){var t=this.licensingRouteObjectsFactoryService.createLicensesListLicensingRouteObject(e[0].uri);this.licensesManagementNavigationService.emitLicensesManagementNavigationRequestOnScope(this.$scope,t)}},e.$inject=["$scope","licensesManagementNavigationService","licensingRouteObjectsFactoryService"],e}();e.ProductLicensesViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("ProductLicensesViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.$q=t,this.$scope=i}return e.prototype.$onInit=function(){this.masterDetailsViewContext={scopeProvider:this.$scope.scopeProvider,tabPaths:this.$scope.tabPaths},this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("LicenseLibUi","management.products.details.summary"),templateUrl:"license-ui/resources/license/views/management/licenses/products/productsDetailsView.html",uid:"product.generalTab"},{name:this.i18nService.getString("LicenseLibUi","management.license.summary.productFeatures.label"),templateUrl:"license-ui/resources/license/views/management/licenses/products/productFeaturesView.html",uid:"product.features"},{name:this.i18nService.getString("LicenseLibUi","products.tab.licenses.title"),templateUrl:"license-ui/resources/license/views/management/licenses/products/productLicensesView.html",uid:"product.licenses"},{name:this.i18nService.getString("LicenseLibUi","management.navigation.vcs"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/vcAssetsList.html",uid:"product.vcAssets",metadata:{relevantFor:"isAssignableToVcs"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.hosts"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/hostAssetsList.html",uid:"product.hostAssets",metadata:{relevantFor:"isAssignableToHosts"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.clusters"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/clusterAssetsList.html",uid:"product.clusterAssets",metadata:{relevantFor:"isAssignableToClusters"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.solutions"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/solutionAssetsList.html",uid:"product.solutionAssets",metadata:{relevantFor:"isAssignableToSolutions"}}])}},e.$inject=["i18nService","$q","$scope"],e}();angular.module("com.vmware.vsphere.client.licenseUi").controller("ProductsAdministrationViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i,r){this.$scope=e,this.licensesManagementNavigationService=t,this.licensingRouteObjectsFactoryService=i,this.licensesManagementConstants=r}return e.prototype.$onInit=function(){var e=this;this.scopeProvider=this.$scope.masterDetailsViewContext.scopeProvider,this.tabPaths=this.$scope.masterDetailsViewContext.tabPaths,this.licensesManagementNavigationService.registerNavigationPerformedEventListener(this.$scope,function(t){e.handleNavigationRequest(t)}),this.registerSelectedTabChangedEventListener(),this.tryProcessNavigationRouteInfoInUrl()},e.prototype.onSelectedProductChanged=function(e){this.selectedProduct!==e&&(this.selectedProduct=e,this.selectedProductUri=this.extractUriFromProductAggregationItem(this.selectedProduct),this.$scope.masterDetailsViewContext.selectedItems=[e],this.triggerNavigationRequestToSelectedProductItem())},e.prototype.handleNavigationRequest=function(e){e&&this.licensesManagementNavigationService.canNavigationRequestInLicensingRouteBeHandled(this.tabPaths,e)&&e.itemId&&(this.selectedProductUri=e.itemId)},e.prototype.extractUriFromProductAggregationItem=function(e){var t=void 0;return e&&e.product&&e.product.product&&e.product.product.uri&&(t=e.product.product.uri),t},e.prototype.triggerNavigationRequestToSelectedProductItem=function(){var e=this.licensingRouteObjectsFactoryService.createProductsListLicensingRouteObject(this.selectedProductUri);this.licensesManagementNavigationService.emitLicensesManagementNavigationRequestOnScope(this.$scope,e)},e.prototype.registerSelectedTabChangedEventListener=function(){var e=this;this.$scope.$on(this.licensesManagementConstants.LICENSES_MANAGEMENT_SELECTED_TAB_CHANGED_EVENT,function(t,i){e.selectedTab=i.selectedTab;var r=i.isDefault&&e.isCurrentTabDefaultTab();e.selectedProductUri&&(r||e.isCurrentTabSelected())&&e.triggerNavigationRequestToSelectedProductItem()})},e.prototype.tryProcessNavigationRouteInfoInUrl=function(){var e=this.licensesManagementNavigationService.extractLicensingRouteObjectFromUrl();this.handleNavigationRequest(e)},e.prototype.isCurrentTabDefaultTab=function(){return!(this.tabPaths&&this.tabPaths.length)},e.prototype.isCurrentTabSelected=function(){return!!(this.tabPaths&&this.tabPaths.length>0&&this.selectedTab&&this.selectedTab.id===this.tabPaths[this.tabPaths.length-1])},e.$inject=["$scope","licensesManagementNavigationService","licensingRouteObjectsFactoryService","licensesManagementConstants"],e}();e.ProductsListViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("ProductsListViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i){this.$scope=e,this.licensesManagementNavigationService=t,this.licensingRouteObjectsFactoryService=i}return e.prototype.onSelectedProductChanged=function(e){if(e&&e.product&&e.product.uri){var t=this.licensingRouteObjectsFactoryService.createProductsListLicensingRouteObject(e.product.uri);this.licensesManagementNavigationService.emitLicensesManagementNavigationRequestOnScope(this.$scope,t)}},e.$inject=["$scope","licensesManagementNavigationService","licensingRouteObjectsFactoryService"],e}();angular.module("com.vmware.vsphere.client.licenseUi").controller("LicenseDetailsProductsTabController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i){this.i18nService=e,this.$q=t,this.$scope=i}return e.prototype.$onInit=function(){this.masterDetailsViewContext={scopeProvider:this.$scope.scopeProvider,tabPaths:this.$scope.tabPaths},this.detailsViewData={tabsPromise:this.$q.when([{name:this.i18nService.getString("LicenseLibUi","management.license.summary.tabLabel"),templateUrl:"license-ui/resources/license/views/management/licenses/serial-key-licenses/details/licenseDetailsSummaryTab.html",uid:"license.summary"},{name:this.i18nService.getString("LicenseLibUi","management.license.summary.productFeatures.label"),templateUrl:"license-ui/resources/license/views/management/licenses/serial-key-licenses/details/productsFeatures.html",uid:"license.features",metadata:{relevantFor:"!isEvaluation"}},{name:this.i18nService.getString("LicenseLibUi","list.products"),templateUrl:"license-ui/resources/license/views/management/licenses/serial-key-licenses/details/licenseDetailsProductsTab.html",uid:"license.products",metadata:{relevantFor:"!isEvaluation"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.vcs"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/vcAssetsList.html",uid:"license.vcAssets",metadata:{relevantFor:"isAssignableToVcs"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.hosts"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/hostAssetsList.html",uid:"license.hostAssets",metadata:{relevantFor:"isAssignableToHosts"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.clusters"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/clusterAssetsList.html",uid:"license.clusterAssets",metadata:{relevantFor:"isAssignableToClusters"}},{name:this.i18nService.getString("LicenseLibUi","management.navigation.solutions"),templateUrl:"license-ui/resources/license/views/management/licenses/assets/solutionAssetsList.html",uid:"license.solutionAssets",metadata:{relevantFor:"isAssignableToSolutions"}},{name:this.i18nService.getString("LicenseLibUi","license.tab.myvmware.title"),templateUrl:"license-ui/resources/license/views/management/licenses/serial-key-licenses/details/myVmwareLicenseDetailsTab.html",uid:"myvmwarelicense.summary",metadata:{relevantFor:"isMyVmwareLicense"}}])}},e.$inject=["i18nService","$q","$scope"],e}();e.LicensesAdministrationViewController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("LicensesAdministrationViewController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t,i,r,n,o,a,s,c){this.$scope=e,this.$q=t,this.vcLicensingPrivilegesService=i,this.commonActionBarService=r,this.vuiConstants=n,this.licensesManagementNavigationService=o,this.licensingRouteObjectsFactoryService=a,this.licensesManagementConstants=s,this.licenseCommonUtil=c,this.ACTION_BAR_ACTIONS="actions",this.REMOVE_LICENSE_ACTION_ID="vsphere.core.administration.removeLicensesAction",this.RENAME_LICENSE_ACTION_ID="vsphere.core.administration.renameLicenseAction",this.ADD_LICENSE_ACTION_ID="vsphere.core.administration.addLicenseAction",this.SYNC_LICENSES_ACTION_ID="vsphere.core.administration.syncFromPortal",this.selectedLicenses=[],this.selectedLicensesUris=[],this.isVc65OrLater=!1}return e.prototype.$onInit=function(){var e=this;this.scopeProvider=this.$scope.masterDetailsViewContext.scopeProvider,this.tabPaths=this.$scope.masterDetailsViewContext.tabPaths,this.defaultEvaluationLicenseUri=this.licenseCommonUtil.getDefaultEvaluationLicenseUri(),this.actionBarOptions={actions:[]},this.updateActionBar(),this.vcLicensingPrivilegesService.checkIfVc65OrLaterIsPresent(this.scopeProvider).then(function(t){e.isVc65OrLater=t,e.updateActionBar()}),this.licensesManagementNavigationService.registerNavigationPerformedEventListener(this.$scope,function(t){e.handleNavigationRequest(t)}),this.registerSelectedTabChangedEventListener(),this.tryProcessNavigationRouteInfoInUrl()},e.prototype.onSelectedLicensesChanged=function(e){e&&e.length?this.selectedLicenses=e.map(function(e){return e&&e.license}):this.selectedLicenses=[],this.selectedLicensesUris=this.extractLicensesUris(this.selectedLicenses),this.updateActionBar()},e.prototype.onFocusedLicenseChanged=function(e){this.focusedLicense=e&&e.license,this.focusedLicenseUri=this.getFocusedLicenseUri(),e?this.$scope.masterDetailsViewContext.selectedItems=[e]:this.$scope.masterDetailsViewContext.selectedItems=[],this.triggerNavigationRequestToFocusedLicenseItem()},e.prototype.updateActionBar=function(){var e=this;this.actionBarOptions&&this.actionBarOptions.actions&&this.actionBarOptions.actions.length&&this.actionBarOptions.actions.forEach(function(t){t.actionId&&t.actionId!==e.ADD_LICENSE_ACTION_ID&&t.actionId!==e.SYNC_LICENSES_ACTION_ID&&(t.enabled=!1)});var t={actions:[]},i=this.commonActionBarService.updateActionBar(t,this.ACTION_BAR_ACTIONS,[],this.getActionsWithoutAvailabilityChecks()),r={actions:[]},n=this.commonActionBarService.updateActionBar(r,this.ACTION_BAR_ACTIONS,this.selectedLicensesUris,this.getActionsWithAvailabilityChecks());this.$q.all([i,n]).then(function(){e.actionBarOptions.actions=t.actions.concat(r.actions)})},e.prototype.getActionsWithoutAvailabilityChecks=function(){var e=this,t=[];return t.push({actionId:this.ADD_LICENSE_ACTION_ID,getActionInvocationContext:function(){return e.scopeProvider},isActionVisible:function(e){return!!e}},{actionId:this.SYNC_LICENSES_ACTION_ID,getActionInvocationContext:function(){return e.scopeProvider},isActionVisible:function(t){return!!t&&e.isVc65OrLater}}),t.push(this.vuiConstants.actions.SEPARATOR),t.push({actionId:this.RENAME_LICENSE_ACTION_ID,getActionInvocationContext:function(){return e.selectedLicenses[0]},isActionVisible:function(t){return!!(e.selectedLicensesUris.length>0&&t)},isActionAvailable:function(t){return!(1!==e.selectedLicensesUris.length||e.selectedLicensesUris[0]===e.defaultEvaluationLicenseUri||!t)}}),t},e.prototype.getActionsWithAvailabilityChecks=function(){var e=this,t=[];return t.push({actionId:this.REMOVE_LICENSE_ACTION_ID,isActionVisible:function(t){return!!(e.selectedLicensesUris.length>0&&t)},getActionInvocationContext:function(){return e.selectedLicensesUris}}),t},e.prototype.handleNavigationRequest=function(e){if(e&&this.licensesManagementNavigationService.canNavigationRequestInLicensingRouteBeHandled(this.tabPaths,e)){e.itemId&&(this.focusedLicenseUri=e.itemId);var t=this.licensesManagementNavigationService.extractAdditionalParametersFromRoute();t.sortColumn&&(this.sortColumn=t.sortColumn)}},e.prototype.getFocusedLicenseUri=function(){return this.focusedLicense&&this.focusedLicense.uri},e.prototype.extractLicensesUris=function(e){var t=[];return e&&e.length>0&&(t=e.map(function(e){return e&&e.uri})),t},e.prototype.triggerNavigationRequestToFocusedLicenseItem=function(){var e=this.licensingRouteObjectsFactoryService.createLicensesListLicensingRouteObject(this.focusedLicenseUri);this.licensesManagementNavigationService.emitLicensesManagementNavigationRequestOnScope(this.$scope,e)},e.prototype.registerSelectedTabChangedEventListener=function(){var e=this;this.$scope.$on(this.licensesManagementConstants.LICENSES_MANAGEMENT_SELECTED_TAB_CHANGED_EVENT,function(t,i){e.selectedTab=i.selectedTab;var r=i.isDefault&&e.isCurrentTabDefaultTab();e.focusedLicenseUri&&(r||e.isCurrentTabSelected())&&e.triggerNavigationRequestToFocusedLicenseItem()})},e.prototype.tryProcessNavigationRouteInfoInUrl=function(){var e=this.licensesManagementNavigationService.extractLicensingRouteObjectFromUrl();this.handleNavigationRequest(e)},e.prototype.isCurrentTabDefaultTab=function(){return!(this.tabPaths&&this.tabPaths.length)},e.prototype.isCurrentTabSelected=function(){return!!(this.tabPaths&&this.tabPaths.length>0&&this.selectedTab&&this.selectedTab.id===this.tabPaths[this.tabPaths.length-1])},e.$inject=["$scope","$q","vcLicensingPrivilegesService","commonActionBarService","vuiConstants","licensesManagementNavigationService","licensingRouteObjectsFactoryService","licensesManagementConstants","licenseCommonUtil"],e}();e.SerialKeyLicensesListController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("SerialKeyLicensesListController",t)}(license_ui||(license_ui={}));var license_ui;!function(e){var t=function(){function e(e,t){this.$scope=e,this.i18nService=t}return e.prototype.$onInit=function(){this.objectId=this.$scope._route.objectId||this.$scope._vxViewNodeData.node.contentSpec.metadata.objectId,this.shouldShowActions=!1,this.headerOptions={title:this.i18nService.getString("LicenseLibUi","management.assets.settings.title"),objectId:this.objectId,actions:[]}},e.prototype.refreshActionsVisible=function(e){if(e&&e.asset&&e.asset.managedObjectRef&&(this.shouldShowActions=!e.asset.notFound,this.shouldShowActions)){var t=this.$scope._vxViewNodeData.node.contentSpec.metadata;t&&t.actionId&&(this.headerOptions.actions=[{actionUid:t.actionId,customLabel:this.i18nService.getString("LicenseLibUi","action.assignLicense.operationName")}])}},e.$inject=["$scope","i18nService"],e}();e.AssetSettingsLicenseController=t,angular.module("com.vmware.vsphere.client.licenseUi").controller("AssetSettingsLicenseController",t)}(license_ui||(license_ui={}));
//# sourceMappingURL=vcm-modules.min.js.map
